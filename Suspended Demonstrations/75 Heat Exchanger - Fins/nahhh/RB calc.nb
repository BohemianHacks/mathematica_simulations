(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     52474,       1260]
NotebookOptionsPosition[     51843,       1242]
NotebookOutlinePosition[     52188,       1257]
CellTagsIndexPosition[     52145,       1254]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "do", ",", "di2", ",", "di1", ",", "h", ",", "t", ",", "L0", ",", "k", 
       ",", "Tci", ",", "\[Mu]c", ",", "kc", ",", "Cpc", ",", "Prc", ",", 
       "Thi", ",", "mh", ",", "\[Mu]h", ",", "kh", ",", "Cph", ",", "Prh", 
       ",", "Cc", ",", "Ch", ",", "Cmin", ",", "Cmax", ",", "Rec", ",", "Nuc",
        ",", "hc", ",", "Reh", ",", "Nuh", ",", "hh", ",", "Af", ",", "Ab", 
       ",", "At", ",", "Ai", ",", "Ao", ",", "\[Eta]f", ",", "\[Eta]0", ",", 
       "Ri", ",", "Ro", ",", "Rcond", ",", "Rfin", ",", "Rtot", ",", "NTU", 
       ",", "Cr", ",", "\[Epsilon]", ",", "q", ",", "Tco", ",", "Tho", ",", 
       "ro", ",", "ri", ",", "ra", ",", "Limg", ",", "wfin", ",", "box", ",", 
       "Larrowfront", ",", "Larrowback", ",", "heatexchanger", ",", "cold", 
       ",", "hot", ",", "parallel"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"do", "=", "0.06"}], ";", 
      RowBox[{"di2", "=", "0.03"}], ";", 
      RowBox[{"di1", "=", "0.024"}], ";", 
      RowBox[{"h", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"do", "-", "di2"}], ")"}], "/", "4"}]}], ";", 
      RowBox[{"t", "=", "0.003"}], ";", "\[IndentingNewLine]", 
      RowBox[{"L0", "=", "5"}], ";", 
      RowBox[{"(*", "m", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"k", "=", "50"}], ";", 
      RowBox[{"(*", 
       RowBox[{"fin", " ", "thermal", " ", "conductivity", " ", 
        RowBox[{
         RowBox[{"W", "/", "m"}], "/", "K"}]}], "*)"}], "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"COLD", " ", "FLUID"}], " ", "-", " ", "WATER"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Tci", "=", "300"}], ";", 
      RowBox[{"(*", "K", "*)"}], "\[IndentingNewLine]", " ", 
      RowBox[{"\[Mu]c", "=", "0.000855"}], ";", 
      RowBox[{"(*", 
       RowBox[{"N", " ", 
        RowBox[{"s", "/", "m2"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"kc", "=", "0.613"}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"W", "/", "m"}], "/", "K"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Cpc", "=", "4179"}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"J", "/", "kg"}], "/", "K"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Prc", "=", 
       FractionBox[
        RowBox[{"\[Mu]c", "*", "Cpc"}], "kc"]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"HOT", " ", "FLUID"}], " ", "-", " ", "CO2"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Thi", "=", "800"}], ";", 
      RowBox[{"(*", "K", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"mh", "=", "0.1"}], ";", 
      RowBox[{"(*", 
       RowBox[{"kg", "/", "s"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Mu]h", "=", "0.0000337"}], ";", 
      RowBox[{"(*", 
       RowBox[{"N", " ", 
        RowBox[{"s", "/", "m2"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"kh", "=", "0.0551"}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"W", "/", "m"}], "/", "K"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Cph", "=", "1170"}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"J", "/", "kg"}], "/", "K"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Prh", "=", 
       FractionBox[
        RowBox[{"\[Mu]h", "*", "Cph"}], "kh"]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Cc", "=", 
       RowBox[{"mc", "*", "Cpc"}]}], ";", 
      RowBox[{"Ch", "=", 
       RowBox[{"mh", "*", "Cph"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"J", "/", "s"}], "/", "K"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Cmin", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Cc", "<", "Ch"}], ",", "Cc", ",", "Ch"}], "]"}]}], ";", 
      RowBox[{"Cmax", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Cc", "<", "Ch"}], ",", "Ch", ",", "Cc"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"J", "/", "s"}], "/", "K"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"COLD", " ", "FLUID"}], " ", "-", " ", "WATER"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Rec", "=", 
       FractionBox[
        RowBox[{"4", "*", "mc"}], 
        RowBox[{"\[Pi]", "*", "di1", "*", "\[Mu]c"}]]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Nuc", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Rec", "\[GreaterEqual]", "2300"}], ",", 
         RowBox[{"0.023", "*", 
          SuperscriptBox["Rec", 
           RowBox[{"4", "/", "5"}]], "*", 
          SuperscriptBox["Prc", "0.4"]}], ",", "4.36"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"hc", "=", 
       FractionBox[
        RowBox[{"Nuc", "*", "kc"}], "di1"]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"HOT", " ", "FLUID"}], " ", "-", " ", "CO2"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Reh", "=", 
       FractionBox[
        RowBox[{"4", "*", "mh"}], 
        RowBox[{"\[Pi]", "*", 
         RowBox[{"(", 
          RowBox[{"do", "-", "di2"}], ")"}], "*", "\[Mu]h"}]]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Nuh", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Reh", "\[GreaterEqual]", "2300"}], ",", 
         RowBox[{"0.023", "*", 
          SuperscriptBox["Reh", 
           RowBox[{"4", "/", "5"}]], "*", 
          SuperscriptBox["Prh", "0.3"]}], ",", "4.36"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"hh", "=", 
       FractionBox[
        RowBox[{"Nuh", "*", "kh"}], 
        RowBox[{"do", "-", "di2"}]]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Af", "=", 
       RowBox[{"2", "*", "h", "*", "L"}]}], " ", ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"total", " ", "area", " ", "of", " ", "one", " ", "fin"}], 
        ",", " ", "m2"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Pi]", "*", "di2"}], "-", 
          RowBox[{"n", "*", "t"}]}], ")"}], "*", "L"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "total", " ", "area", " ", "of", " ", "exposed", " ", "base"}], ",", 
        " ", "m2"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"At", "=", 
       RowBox[{"Ab", "+", 
        RowBox[{"n", "*", "Af"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "total", " ", "area", " ", "hot", " ", "fluid", " ", "contacts"}], 
        ",", " ", "m2"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Ai", "=", 
       RowBox[{"\[Pi]", "*", "di1", "*", "L"}]}], ";", 
      RowBox[{"Ao", "=", 
       RowBox[{"\[Pi]", "*", "do", "*", "L"}]}], ";", 
      RowBox[{"(*", "m2", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]f", "=", 
       FractionBox[
        RowBox[{"Tanh", "[", 
         RowBox[{
          SqrtBox[
           FractionBox[
            RowBox[{"2", "*", "hh"}], 
            RowBox[{"k", "*", "t"}]]], "*", "h"}], "]"}], 
        RowBox[{
         SqrtBox[
          FractionBox[
           RowBox[{"2", "*", "hh"}], 
           RowBox[{"k", "*", "t"}]]], "*", "h"}]]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]0", "=", 
       RowBox[{"1", "-", 
        RowBox[{"n", "*", 
         FractionBox["Af", "At"], "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Eta]f"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Ri", "=", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"hc", "*", "Ai"}], ")"}], 
        RowBox[{"-", "1"}]]}], ";", 
      RowBox[{"Ro", "=", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"hh", "*", "Ao"}], ")"}], 
        RowBox[{"-", "1"}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Rcond", "=", 
       FractionBox[
        RowBox[{"Log", "[", 
         RowBox[{"do", "/", "di2"}], "]"}], 
        RowBox[{"2", "*", "\[Pi]", "*", "k", "*", "L"}]]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Rfin", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"fins", "\[Equal]", "1"}], ",", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"\[Eta]0", "*", "hh", "*", "At"}], ")"}], 
          RowBox[{"-", "1"}]], ",", "0"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Rtot", "=", 
       RowBox[{"Ri", "+", "Ro", "+", "Rcond", "+", "Rfin"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"NTU", "=", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Rtot", "*", "Cmin"}], ")"}], 
        RowBox[{"-", "1"}]]}], ";", 
      RowBox[{"Cr", "=", 
       RowBox[{"Cmin", "/", "Cmax"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Epsilon]", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"flow", "\[Equal]", "1"}], ",", 
         FractionBox[
          RowBox[{"1", "-", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "NTU"}], "*", 
             RowBox[{"(", 
              RowBox[{"1", "+", "Cr"}], ")"}]}], "]"}]}], 
          RowBox[{"1", "-", 
           RowBox[{"Cr", "*", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "NTU"}], "*", 
              RowBox[{"(", 
               RowBox[{"1", "+", "Cr"}], ")"}]}], "]"}]}]}]], ",", 
         FractionBox[
          RowBox[{"1", "-", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "NTU"}], "*", 
             RowBox[{"(", 
              RowBox[{"1", "+", "Cr"}], ")"}]}], "]"}]}], 
          RowBox[{"1", "+", "Cr"}]]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"q", "=", 
       RowBox[{"\[Epsilon]", "*", "Cmin", "*", 
        RowBox[{"(", 
         RowBox[{"Thi", "-", "Tci"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Tco", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"L", "\[LessEqual]", "0.0001"}], ",", "Tci", ",", 
         RowBox[{
          FractionBox["q", "Cc"], "+", "Tci"}]}], "]"}]}], ";", 
      RowBox[{"Tho", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"L", "\[LessEqual]", "0.0001"}], ",", "Thi", ",", 
         RowBox[{"Thi", "-", 
          FractionBox["q", "Ch"]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"properties", " ", "for", " ", "3", "D", " ", "graphic"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ro", "=", "1"}], ";", 
      RowBox[{"ri", "=", "0.4"}], ";", 
      RowBox[{"ra", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ro", "+", "ri", "+", "0.04"}], ")"}], "/", "2"}]}], ";", 
      RowBox[{"(*", "radius", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Limg", "=", "3"}], ";", 
      RowBox[{"(*", "length", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"wfin", "=", 
       RowBox[{"1", "/", "60"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"fin", " ", "thickness"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"box", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"fins", "\[Equal]", "1"}], ",", 
         RowBox[{"Cuboid", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "wfin"}], ",", 
             RowBox[{"0.01", "*", "Limg"}], ",", 
             RowBox[{"ri", "+", ".025"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"wfin", ",", "Limg", ",", 
             RowBox[{"ro", "-", ".01"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"Cuboid", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "wfin"}], ",", 
             RowBox[{"0.01", "*", "Limg"}], ",", "ri"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"wfin", ",", "Limg", ",", "ri"}], "}"}]}], "]"}]}], 
        "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"single", " ", "fin"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Larrowfront", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"flow", "\[Equal]", "1"}], ",", 
         RowBox[{"-", "0.5"}], ",", 
         RowBox[{"Limg", "+", "0.5"}]}], "]"}]}], ";", 
      RowBox[{"Larrowback", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"flow", "\[Equal]", "1"}], ",", 
         RowBox[{"Limg", "+", "0.5"}], ",", 
         RowBox[{"-", "0.5"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"heatexchanger", "=", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ParametricPlot3D", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ro", "*", 
                RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ",", "z", ",", 
               RowBox[{"ro", "*", 
                RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ri", "*", 
                RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ",", "z", ",", 
               RowBox[{"ri", "*", 
                RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}]}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]", ",", "0", ",", 
             RowBox[{"2", "*", "\[Pi]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"z", ",", "0", ",", "Limg"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Thickness", "@", "0.06"}], ",", 
                RowBox[{"GrayLevel", "@", "0.7"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Thickness", "@", "0.085"}], ",", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{"0", ",", "0.65", ",", "1"}], "]"}]}], 
               RowBox[{"(*", 
                RowBox[{"Specularity", "[", 
                 RowBox[{"1", ",", "20"}], "]"}], "*)"}], "}"}]}], "}"}]}], 
           ",", 
           RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
           RowBox[{"BoundaryStyle", "\[Rule]", "Black"}], ",", 
           RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Quality\>\""}]}], "]"}],
          ",", 
         RowBox[{"(*", "cylinders", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"MapAt", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Rotate", "[", 
               RowBox[{"#", ",", "k", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}], "&"}], 
             ",", 
             RowBox[{"Graphics3D", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"GrayLevel", "@", "0.7"}], ",", "box"}], "}"}], "]"}],
              ",", 
             RowBox[{"{", "1", "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "0", ",", 
             RowBox[{"2", "*", "\[Pi]"}], ",", 
             RowBox[{"2", "*", 
              RowBox[{"\[Pi]", "/", "n"}]}]}], "}"}]}], "]"}], ",", 
         RowBox[{"(*", 
          RowBox[{"place", " ", "fins"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "@", "0.015"}], ",", 
             RowBox[{"Arrowheads", "@", "0.055"}], ",", "\[IndentingNewLine]", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.8", ",", "0", ",", "0"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Arrow", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"ra", "*", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"#", "*", 
                    FractionBox[
                    RowBox[{"2", "*", "\[Pi]"}], 
                    RowBox[{"n", "+", "0.5"}]]}], "]"}]}], ",", "Larrowfront",
                     ",", 
                    RowBox[{"ra", "*", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"#", "*", 
                    FractionBox[
                    RowBox[{"2", "*", "\[Pi]"}], 
                    RowBox[{"n", "+", "0.5"}]]}], "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"ra", "*", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"#", "*", 
                    FractionBox[
                    RowBox[{"2", "*", "\[Pi]"}], 
                    RowBox[{"n", "+", "0.5"}]]}], "]"}]}], ",", "Larrowback", 
                    ",", 
                    RowBox[{"ra", "*", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"#", "*", 
                    FractionBox[
                    RowBox[{"2", "*", "\[Pi]"}], 
                    RowBox[{"n", "+", "0.5"}]]}], "]"}]}]}], "}"}]}], "}"}], 
                "]"}], "&"}], "/@", 
              RowBox[{"Range", "[", 
               RowBox[{"2", ",", 
                RowBox[{"n", "+", "1"}]}], "]"}]}], ",", 
             "\[IndentingNewLine]", "Blue", ",", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"Limg", "+", "0.5"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"-", "0.5"}], ",", "0"}], "}"}]}], "}"}], "]"}]}], 
            "}"}], "\[IndentingNewLine]", "}"}], "]"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"Axes", "\[Rule]", "False"}], ",", 
         RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
         RowBox[{"ViewPoint", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0.5", ",", "5", ",", "0.5"}], "}"}]}], 
         RowBox[{"(*", 
          RowBox[{",", 
           RowBox[{"Lighting", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", " ", "LightGray"}], "}"}], 
             "}"}]}]}], "*)"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"300", ",", "300"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"cold", "=", 
       RowBox[{
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"L", ",", "Tco"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"L", ",", "0.001", ",", "L0", ",", "0.01"}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Blue"}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "L0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"275", ",", "Thi"}], "}"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ScalingFunctions", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Reverse\>\"", ",", "None"}], "}"}]}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"17", ",", "Black"}], "}"}]}], ",", 
          RowBox[{"FrameTicks", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"None", ",", "All"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"275", ",", "400"}], "}"}]}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
          RowBox[{"ImagePadding", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"55", ",", "30"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}]}], "]"}], "/.", 
        RowBox[{
         RowBox[{"Line", "[", "x_", "]"}], "\[RuleDelayed]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Arrowheads", "[", 
            RowBox[{"Table", "[", 
             RowBox[{"0.1", ",", 
              RowBox[{"{", "5", "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"Arrow", "[", "x", "]"}]}], "}"}]}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"hot", "=", 
       RowBox[{
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"L", ",", "Tho"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"L", ",", "0.001", ",", "L0", ",", "0.01"}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.8", ",", "0", ",", "0"}], "]"}]}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "L0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"275", ",", "Thi"}], "}"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<length (m)\>\"", ",", "\"\<temperature (K)\>\""}], 
            "}"}]}], ",", 
          RowBox[{"FrameTicks", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"All", ",", "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"All", ",", "None"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"17", ",", "Black"}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"275", ",", "400"}], "}"}]}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
          RowBox[{"ImagePadding", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"55", ",", "30"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}]}], "]"}], "/.", 
        RowBox[{
         RowBox[{"Line", "[", "x_", "]"}], "\[RuleDelayed]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Arrowheads", "[", 
            RowBox[{"Table", "[", 
             RowBox[{"0.1", ",", 
              RowBox[{"{", "5", "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"Arrow", "[", "x", "]"}]}], "}"}]}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"parallel", "=", 
       RowBox[{
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"L", ",", "Tco"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"L", ",", "0.0001", ",", "L0", ",", "0.001"}], "}"}]}],
              "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"L", ",", "Tho"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"L", ",", "0.0001", ",", "L0", ",", "0.001"}], "}"}]}],
              "]"}]}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Thick", ",", 
               RowBox[{"RGBColor", "[", 
                RowBox[{"0.8", ",", "0", ",", "0"}], "]"}]}], "}"}]}], 
            "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "L0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"275", ",", "Thi"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<length (m)\>\"", ",", "\"\<temperature (K)\>\""}], 
            "}"}]}], ",", 
          RowBox[{"FrameTicks", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"All", ",", "All"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"All", ",", "None"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"17", ",", "Black"}], "}"}]}], ",", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"275", ",", "400"}], "}"}]}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
          RowBox[{"ImagePadding", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"55", ",", "30"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}]}], "]"}], "/.", 
        RowBox[{
         RowBox[{"Line", "[", "x_", "]"}], "\[RuleDelayed]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Arrowheads", "[", 
            RowBox[{"Table", "[", 
             RowBox[{"0.1", ",", 
              RowBox[{"{", "5", "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"Arrow", "[", "x", "]"}]}], "}"}]}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Grid", "@", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"flow", "\[Equal]", "1"}], ",", 
            RowBox[{"Overlay", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"cold", ",", "hot"}], "}"}], ",", " ", 
              RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}], ",", 
            "parallel"}], "]"}], ",", "heatexchanger"}], "}"}], "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Grid", "@", 
    RowBox[{"{", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"flow", ",", "1", ",", "\"\<heat exchanger flow\>\""}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "\[Rule]", "\"\< countercurrent \>\""}], ",", 
            RowBox[{"2", "\[Rule]", "\"\< co-current \>\""}]}], "}"}], ",", 
          "Setter"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "mc", ",", "0.16", ",", "\"\<coolant mass flow (kg/s)\>\""}], 
           "}"}], ",", "0.1", ",", "0.55", ",", "0.01", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"Grid", "@", 
    RowBox[{"{", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"fins", ",", "1", ",", "\"\<\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "\[Rule]", "\"\<fins\>\""}], ",", 
            RowBox[{"2", "\[Rule]", "\"\<no fins\>\""}]}], "}"}], ",", 
          "RadioButton"}], "}"}], "]"}], ",", 
       RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PaneSelector", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Control", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"n", ",", "8", ",", "\"\<number of fins\>\""}], "}"}], 
              ",", "5", ",", "11", ",", "2", ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"Dynamic", "@", "fins"}]}], "]"}]}], "\[IndentingNewLine]", 
      "}"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7179370545064683`*^9, 3.717937100546693*^9}, {
  3.7179381676701593`*^9, 3.7179381691375623`*^9}, {3.71793883979889*^9, 
  3.7179389430722017`*^9}, {3.717938989831028*^9, 3.7179390202517757`*^9}, {
  3.7179391366527586`*^9, 3.7179393218263197`*^9}, {3.7179395065786533`*^9, 
  3.7179396010257072`*^9}, {3.717939668024248*^9, 3.7179397871768446`*^9}, {
  3.7179398172219934`*^9, 3.7179398345842724`*^9}, {3.7179401177590895`*^9, 
  3.7179401379903893`*^9}, {3.717940717252837*^9, 3.7179409235504637`*^9}, {
  3.7179409963416195`*^9, 3.717941118538618*^9}, {3.717941173790493*^9, 
  3.7179413008543253`*^9}, {3.7179414194321175`*^9, 3.717941548382743*^9}, {
  3.71794164663463*^9, 3.7179418122332463`*^9}, {3.717941847965819*^9, 
  3.717942535610016*^9}, {3.717942581202655*^9, 
  3.7179429140450845`*^9}},ExpressionUUID->"fc71a9c4-8a9a-4bf6-bb7c-\
81dd0b6b7b6a"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`fins$$ = 1, $CellContext`flow$$ = 
    1, $CellContext`mc$$ = 0.16, $CellContext`n$$ = 8, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`flow$$], 1, "heat exchanger flow"}, {
      1 -> " countercurrent ", 2 -> " co-current "}}, {{
       Hold[$CellContext`mc$$], 0.16, "coolant mass flow (kg/s)"}, 0.1, 0.55, 
      0.01}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], 
          Manipulate`Place[2]}}]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`fins$$], 1, ""}, {1 -> "fins", 2 -> "no fins"}}, {{
       Hold[$CellContext`n$$], 8, "number of fins"}, 5, 11, 2}, {
      Hold[
       Grid[{{
          Manipulate`Place[3], 
          Spacer[10], 
          PaneSelector[{1 -> Manipulate`Place[4]}, 
           Dynamic[$CellContext`fins$$]]}}]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    584., {196.5, 203.5}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`flow$23077$$ = 
    False, $CellContext`mc$23078$$ = 0, $CellContext`fins$23079$$ = 
    False, $CellContext`n$23080$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`fins$$ = 1, $CellContext`flow$$ = 
        1, $CellContext`mc$$ = 0.16, $CellContext`n$$ = 8}, 
      "ControllerVariables" :> {
        Hold[$CellContext`flow$$, $CellContext`flow$23077$$, False], 
        Hold[$CellContext`mc$$, $CellContext`mc$23078$$, 0], 
        Hold[$CellContext`fins$$, $CellContext`fins$23079$$, False], 
        Hold[$CellContext`n$$, $CellContext`n$23080$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`do$, $CellContext`di2$, $CellContext`di1$, \
$CellContext`h$, $CellContext`t$, $CellContext`L0$, $CellContext`k$, \
$CellContext`Tci$, $CellContext`\[Mu]c$, $CellContext`kc$, $CellContext`Cpc$, \
$CellContext`Prc$, $CellContext`Thi$, $CellContext`mh$, $CellContext`\[Mu]h$, \
$CellContext`kh$, $CellContext`Cph$, $CellContext`Prh$, $CellContext`Cc$, \
$CellContext`Ch$, $CellContext`Cmin$, $CellContext`Cmax$, $CellContext`Rec$, \
$CellContext`Nuc$, $CellContext`hc$, $CellContext`Reh$, $CellContext`Nuh$, \
$CellContext`hh$, $CellContext`Af$, $CellContext`Ab$, $CellContext`At$, \
$CellContext`Ai$, $CellContext`Ao$, $CellContext`\[Eta]f$, \
$CellContext`\[Eta]0$, $CellContext`Ri$, $CellContext`Ro$, \
$CellContext`Rcond$, $CellContext`Rfin$, $CellContext`Rtot$, \
$CellContext`NTU$, $CellContext`Cr$, $CellContext`\[Epsilon]$, \
$CellContext`q$, $CellContext`Tco$, $CellContext`Tho$, $CellContext`ro$, \
$CellContext`ri$, $CellContext`ra$, $CellContext`Limg$, $CellContext`wfin$, \
$CellContext`box$, $CellContext`Larrowfront$, $CellContext`Larrowback$, \
$CellContext`heatexchanger$, $CellContext`cold$, $CellContext`hot$, \
$CellContext`parallel$}, $CellContext`do$ = 0.06; $CellContext`di2$ = 
         0.03; $CellContext`di1$ = 
         0.024; $CellContext`h$ = ($CellContext`do$ - $CellContext`di2$)/
          4; $CellContext`t$ = 0.003; $CellContext`L0$ = 5; $CellContext`k$ = 
         50; $CellContext`Tci$ = 300; $CellContext`\[Mu]c$ = 
         0.000855; $CellContext`kc$ = 0.613; $CellContext`Cpc$ = 
         4179; $CellContext`Prc$ = $CellContext`\[Mu]c$ \
$CellContext`Cpc$/$CellContext`kc$; $CellContext`Thi$ = 800; $CellContext`mh$ = 
         0.1; $CellContext`\[Mu]h$ = 0.0000337; $CellContext`kh$ = 
         0.0551; $CellContext`Cph$ = 
         1170; $CellContext`Prh$ = $CellContext`\[Mu]h$ \
$CellContext`Cph$/$CellContext`kh$; $CellContext`Cc$ = $CellContext`mc$$ \
$CellContext`Cpc$; $CellContext`Ch$ = $CellContext`mh$ $CellContext`Cph$; \
$CellContext`Cmin$ = 
         If[$CellContext`Cc$ < $CellContext`Ch$, $CellContext`Cc$, \
$CellContext`Ch$]; $CellContext`Cmax$ = 
         If[$CellContext`Cc$ < $CellContext`Ch$, $CellContext`Ch$, \
$CellContext`Cc$]; $CellContext`Rec$ = 
         4 $CellContext`mc$$/(
          Pi $CellContext`di1$ $CellContext`\[Mu]c$); $CellContext`Nuc$ = 
         If[$CellContext`Rec$ >= 2300, 
           0.023 $CellContext`Rec$^(4/5) $CellContext`Prc$^0.4, 
           4.36]; $CellContext`hc$ = $CellContext`Nuc$ \
$CellContext`kc$/$CellContext`di1$; $CellContext`Reh$ = 
         4 $CellContext`mh$/(
          Pi ($CellContext`do$ - $CellContext`di2$) $CellContext`\[Mu]h$); \
$CellContext`Nuh$ = 
         If[$CellContext`Reh$ >= 2300, 
           0.023 $CellContext`Reh$^(4/5) $CellContext`Prh$^0.3, 
           4.36]; $CellContext`hh$ = $CellContext`Nuh$ \
$CellContext`kh$/($CellContext`do$ - $CellContext`di2$); $CellContext`Af$ = 
         2 $CellContext`h$ $CellContext`L; $CellContext`Ab$ = (
           Pi $CellContext`di2$ - $CellContext`n$$ $CellContext`t$) \
$CellContext`L; $CellContext`At$ = $CellContext`Ab$ + $CellContext`n$$ \
$CellContext`Af$; $CellContext`Ai$ = 
         Pi $CellContext`di1$ $CellContext`L; $CellContext`Ao$ = 
         Pi $CellContext`do$ $CellContext`L; $CellContext`\[Eta]f$ = 
         Tanh[Sqrt[
             2 $CellContext`hh$/($CellContext`k$ $CellContext`t$)] \
$CellContext`h$]/(
          Sqrt[2 $CellContext`hh$/($CellContext`k$ $CellContext`t$)] \
$CellContext`h$); $CellContext`\[Eta]0$ = 
         1 - $CellContext`n$$ ($CellContext`Af$/$CellContext`At$) (
           1 - $CellContext`\[Eta]f$); $CellContext`Ri$ = ($CellContext`hc$ \
$CellContext`Ai$)^(-1); $CellContext`Ro$ = ($CellContext`hh$ \
$CellContext`Ao$)^(-1); $CellContext`Rcond$ = 
         Log[$CellContext`do$/$CellContext`di2$]/(2 
          Pi $CellContext`k$ $CellContext`L); $CellContext`Rfin$ = 
         If[$CellContext`fins$$ == 
           1, ($CellContext`\[Eta]0$ $CellContext`hh$ $CellContext`At$)^(-1), 
           0]; $CellContext`Rtot$ = $CellContext`Ri$ + $CellContext`Ro$ + \
$CellContext`Rcond$ + $CellContext`Rfin$; $CellContext`NTU$ = \
($CellContext`Rtot$ $CellContext`Cmin$)^(-1); $CellContext`Cr$ = \
$CellContext`Cmin$/$CellContext`Cmax$; $CellContext`\[Epsilon]$ = 
         If[$CellContext`flow$$ == 
           1, (1 - Exp[(-$CellContext`NTU$) (1 + $CellContext`Cr$)])/(
           1 - $CellContext`Cr$ 
           Exp[(-$CellContext`NTU$) (1 + $CellContext`Cr$)]), (1 - 
            Exp[(-$CellContext`NTU$) (1 + $CellContext`Cr$)])/(
           1 + $CellContext`Cr$)]; $CellContext`q$ = $CellContext`\[Epsilon]$ \
$CellContext`Cmin$ ($CellContext`Thi$ - $CellContext`Tci$); $CellContext`Tco$ = 
         If[$CellContext`L <= 
           0.0001, $CellContext`Tci$, $CellContext`q$/$CellContext`Cc$ + \
$CellContext`Tci$]; $CellContext`Tho$ = 
         If[$CellContext`L <= 
           0.0001, $CellContext`Thi$, $CellContext`Thi$ - \
$CellContext`q$/$CellContext`Ch$]; $CellContext`ro$ = 1; $CellContext`ri$ = 
         0.4; $CellContext`ra$ = ($CellContext`ro$ + $CellContext`ri$ + 0.04)/
          2; $CellContext`Limg$ = 3; $CellContext`wfin$ = 
         1/60; $CellContext`box$ = If[$CellContext`fins$$ == 1, 
           
           Cuboid[{-$CellContext`wfin$, 
             0.01 $CellContext`Limg$, $CellContext`ri$ + 
             0.025}, {$CellContext`wfin$, $CellContext`Limg$, \
$CellContext`ro$ - 0.01}], 
           
           Cuboid[{-$CellContext`wfin$, 
             0.01 $CellContext`Limg$, $CellContext`ri$}, {$CellContext`wfin$, \
$CellContext`Limg$, $CellContext`ri$}]]; $CellContext`Larrowfront$ = 
         If[$CellContext`flow$$ == 1, -0.5, $CellContext`Limg$ + 
           0.5]; $CellContext`Larrowback$ = 
         If[$CellContext`flow$$ == 1, $CellContext`Limg$ + 
           0.5, -0.5]; $CellContext`heatexchanger$ = Show[
           
           ParametricPlot3D[{{$CellContext`ro$ 
              Cos[$CellContext`\[Theta]], $CellContext`z, $CellContext`ro$ 
              Sin[$CellContext`\[Theta]]}, {$CellContext`ri$ 
              Cos[$CellContext`\[Theta]], $CellContext`z, $CellContext`ri$ 
              Sin[$CellContext`\[Theta]]}}, {$CellContext`\[Theta], 0, 2 
             Pi}, {$CellContext`z, 0, $CellContext`Limg$}, PlotStyle -> {{
               Thickness[0.06], 
               GrayLevel[0.7]}, {
               Thickness[0.085], 
               RGBColor[0, 0.65, 1]}}, Mesh -> None, BoundaryStyle -> Black, 
            PerformanceGoal -> "Quality"], 
           Table[
            MapAt[Rotate[#, $CellContext`k$, {0, 1, 0}, {0, 0, 0}]& , 
             Graphics3D[{
               GrayLevel[0.7], $CellContext`box$}], {1}], {$CellContext`k$, 0,
              2 Pi, 2 (Pi/$CellContext`n$$)}], 
           Graphics3D[{{
              Thickness[0.015], 
              Arrowheads[0.055], 
              RGBColor[0.8, 0, 0], 
              Map[
              Arrow[{{$CellContext`ra$ 
                  Sin[# (2 Pi/($CellContext`n$$ + 
                    0.5))], $CellContext`Larrowfront$, $CellContext`ra$ 
                  Cos[# (2 Pi/($CellContext`n$$ + 0.5))]}, {$CellContext`ra$ 
                  Sin[# (2 Pi/($CellContext`n$$ + 
                    0.5))], $CellContext`Larrowback$, $CellContext`ra$ 
                  Cos[# (2 Pi/($CellContext`n$$ + 0.5))]}}]& , 
               Range[2, $CellContext`n$$ + 1]], Blue, 
              Arrow[{{0, $CellContext`Limg$ + 0.5, 0}, {0, -0.5, 0}}]}}], 
           PlotRange -> All, Axes -> False, Boxed -> False, 
           ViewPoint -> {0.5, 5, 0.5}, 
           ImageSize -> {300, 300}]; $CellContext`cold$ = ReplaceAll[
           ListLinePlot[
            
            Table[{$CellContext`L, $CellContext`Tco$}, {$CellContext`L, 
              0.001, $CellContext`L0$, 0.01}], PlotStyle -> {Thick, Blue}, 
            PlotRange -> {{0, $CellContext`L0$}, {275, $CellContext`Thi$}}, 
            ScalingFunctions -> {"Reverse", None}, Frame -> True, 
            LabelStyle -> {17, Black}, 
            FrameTicks -> {{None, All}, {None, None}}, 
            ImageSize -> {275, 400}, AspectRatio -> Full, 
            ImagePadding -> {{55, 30}, {50, 10}}], Line[
             Pattern[$CellContext`x, 
              Blank[]]] :> {
             Arrowheads[
              Table[0.1, {5}]], 
             Arrow[$CellContext`x]}]; $CellContext`hot$ = ReplaceAll[
           ListLinePlot[
            
            Table[{$CellContext`L, $CellContext`Tho$}, {$CellContext`L, 
              0.001, $CellContext`L0$, 0.01}], PlotStyle -> {Thick, 
              RGBColor[0.8, 0, 0]}, 
            PlotRange -> {{0, $CellContext`L0$}, {275, $CellContext`Thi$}}, 
            Frame -> True, FrameLabel -> {"length (m)", "temperature (K)"}, 
            FrameTicks -> {{All, None}, {All, None}}, 
            LabelStyle -> {17, Black}, ImageSize -> {275, 400}, AspectRatio -> 
            Full, ImagePadding -> {{55, 30}, {50, 10}}], Line[
             Pattern[$CellContext`x, 
              Blank[]]] :> {
             Arrowheads[
              Table[0.1, {5}]], 
             Arrow[$CellContext`x]}]; $CellContext`parallel$ = ReplaceAll[
           ListLinePlot[{
             
             Table[{$CellContext`L, $CellContext`Tco$}, {$CellContext`L, 
               0.0001, $CellContext`L0$, 0.001}], 
             
             Table[{$CellContext`L, $CellContext`Tho$}, {$CellContext`L, 
               0.0001, $CellContext`L0$, 0.001}]}, 
            PlotStyle -> {{Thick, Blue}, {Thick, 
               RGBColor[0.8, 0, 0]}}, 
            PlotRange -> {{0, $CellContext`L0$}, {275, $CellContext`Thi$}}, 
            Frame -> True, FrameLabel -> {"length (m)", "temperature (K)"}, 
            FrameTicks -> {{All, All}, {All, None}}, 
            LabelStyle -> {17, Black}, ImageSize -> {275, 400}, AspectRatio -> 
            Full, ImagePadding -> {{55, 30}, {50, 10}}], Line[
             Pattern[$CellContext`x, 
              Blank[]]] :> {
             Arrowheads[
              Table[0.1, {5}]], 
             Arrow[$CellContext`x]}]; Grid[{{
            If[$CellContext`flow$$ == 1, 
             
             Overlay[{$CellContext`cold$, $CellContext`hot$}, Alignment -> 
              Center], $CellContext`parallel$], \
$CellContext`heatexchanger$}}]], 
      "Specifications" :> {{{$CellContext`flow$$, 1, "heat exchanger flow"}, {
         1 -> " countercurrent ", 2 -> " co-current "}, ControlType -> Setter,
          ControlPlacement -> 
         1}, {{$CellContext`mc$$, 0.16, "coolant mass flow (kg/s)"}, 0.1, 
         0.55, 0.01, Appearance -> "Labeled", ImageSize -> Small, 
         ControlPlacement -> 2}, 
        Grid[{{
           Manipulate`Place[1], 
           Manipulate`Place[2]}}], {{$CellContext`fins$$, 1, ""}, {
         1 -> "fins", 2 -> "no fins"}, ControlType -> RadioButton, 
         ControlPlacement -> 3}, {{$CellContext`n$$, 8, "number of fins"}, 5, 
         11, 2, Appearance -> "Labeled", ControlPlacement -> 4}, 
        Grid[{{
           Manipulate`Place[3], 
           Spacer[10], 
           PaneSelector[{1 -> Manipulate`Place[4]}, 
            Dynamic[$CellContext`fins$$]]}}]}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{635., {262., 269.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.7179419698836164`*^9, 3.717942027397103*^9}, {
   3.7179420596302557`*^9, 3.7179421761298437`*^9}, {3.717942282795168*^9, 
   3.717942299652646*^9}, {3.717942330679213*^9, 3.717942339341444*^9}, 
   3.717942434020115*^9, {3.71794246555287*^9, 3.717942536225232*^9}, {
   3.7179425885952835`*^9, 3.717942621308653*^9}, {3.7179426574064274`*^9, 
   3.717942685740556*^9}, {3.7179427670455675`*^9, 3.717942782708043*^9}, 
   3.7179429156880875`*^9},ExpressionUUID->"c75b7ca7-9c88-45a3-b3d3-\
60ac304959d9"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"L", ",", "Tco"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"L", ",", "0.001", ",", "L0", ",", "0.01"}], "}"}]}], "]"}], 
      ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"L", ",", "Tho"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"L", ",", "0.001", ",", "L0", ",", "0.01"}], "}"}]}], 
       "]"}]}], "}"}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.8", ",", "0", ",", "0"}], "]"}]}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "L0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"275", ",", "Thi"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"All", ",", "All"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"All", ",", "True"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"17", ",", "Black"}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"275", ",", "400"}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "Full"}]}], "]"}], "/.", 
  RowBox[{
   RowBox[{"Line", "[", "x_", "]"}], "\[RuleDelayed]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Arrowheads", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"-", "0.1"}], ",", 
         RowBox[{"{", "5", "}"}]}], "]"}], "]"}], ",", 
      RowBox[{"Arrow", "[", "x", "]"}]}], "}"}], 
    RowBox[{"(*", 
     RowBox[{",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Arrowheads", "[", 
         RowBox[{"Table", "[", 
          RowBox[{"0.1", ",", 
           RowBox[{"{", "5", "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"Arrow", "[", "x", "]"}]}], "}"}]}], "*)"}], 
    "}"}]}]}]], "Input",ExpressionUUID->"123da731-0385-43d7-a147-\
62059720ff4f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"cold", "=", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"L", ",", "Tco"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"L", ",", "0.001", ",", "L0", ",", "0.01"}], "}"}]}], "]"}],
        ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Blue"}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "L0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"275", ",", "Thi"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ScalingFunctions", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<Reverse\>\"", ",", "None"}], "}"}]}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", "None"}], 
       RowBox[{"(*", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"None", ",", "All"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"None", ",", "None"}], "}"}]}], "}"}], "*)"}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"17", ",", "Black"}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"275", ",", "500"}], "}"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"55", ",", "30"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"Line", "[", "x_", "]"}], "\[RuleDelayed]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Arrowheads", "[", 
         RowBox[{"Table", "[", 
          RowBox[{"0.1", ",", 
           RowBox[{"{", "5", "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"Arrow", "[", "x", "]"}]}], "}"}]}]}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"hot", "=", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"L", ",", "Tho"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"L", ",", "0.001", ",", "L0", ",", "0.01"}], "}"}]}], "]"}],
        ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.8", ",", "0", ",", "0"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "L0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"275", ",", "Thi"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<length (m)\>\"", ",", "\"\<temperature (K)\>\""}], 
         "}"}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"All", ",", "All"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"All", ",", "None"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"17", ",", "Black"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"275", ",", "400"}], "}"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"55", ",", "30"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"Line", "[", "x_", "]"}], "\[RuleDelayed]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Arrowheads", "[", 
         RowBox[{"Table", "[", 
          RowBox[{"0.1", ",", 
           RowBox[{"{", "5", "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"Arrow", "[", "x", "]"}]}], "}"}]}]}]}], ";"}], 
  "*)"}]], "Input",ExpressionUUID->"b3b1897e-9cb9-4d8d-8e0e-0c202dca7c46"]
},
WindowSize->{667, 670},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 30051, 750, 2999, "Input",ExpressionUUID->"fc71a9c4-8a9a-4bf6-bb7c-81dd0b6b7b6a"],
Cell[30634, 774, 14277, 266, 550, "Output",ExpressionUUID->"c75b7ca7-9c88-45a3-b3d3-60ac304959d9"]
}, Open  ]],
Cell[44926, 1043, 2435, 73, 162, "Input",ExpressionUUID->"123da731-0385-43d7-a147-62059720ff4f"],
Cell[47364, 1118, 4475, 122, 143, "Input",ExpressionUUID->"b3b1897e-9cb9-4d8d-8e0e-0c202dca7c46"]
}
]
*)

