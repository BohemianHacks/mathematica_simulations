(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     50653,       1181]
NotebookOptionsPosition[     49852,       1155]
NotebookOutlinePosition[     50193,       1170]
CellTagsIndexPosition[     50150,       1167]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"colL", "=", "Blue"}], ";", 
  RowBox[{"colV", "=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{"0", ",", "0.6", ",", "0"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7168230541855836`*^9, 
  3.716823062616228*^9}},ExpressionUUID->"ee34f1d0-61ee-4e06-9284-\
f8e3dff69545"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"text", "[", 
    RowBox[{"var_", ",", "sub_"}], "]"}], ":=", 
   RowBox[{"Framed", "[", 
    RowBox[{
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Subscript", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"var", ",", "Italic"}], "]"}], ",", "sub"}], "]"}], ",", 
       "17"}], "]"}], ",", 
     RowBox[{"Background", "\[Rule]", "White"}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", "None"}], ",", 
     RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.716823242244308*^9, 3.7168232788876996`*^9}, {
  3.716823652499773*^9, 
  3.716823684837143*^9}},ExpressionUUID->"97bc5f38-6394-425b-95e3-\
8167c80a658e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Ea", ",", "R", ",", "T0", ",", "H0", ",", "H", ",", "yeq", ",", "x0", 
       ",", "y1", ",", "V", ",", "yop", ",", "xmin1", ",", "xmin2", ",", 
       "ymin", ",", "xN", ",", "xop", ",", "check", ",", "X", ",", "Y", ",", 
       "n"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"HTS", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"yN1", "=", "1.8"}], ";", 
          RowBox[{"L", "=", "100"}], ";", 
          RowBox[{"T", "=", "13"}], ";", 
          RowBox[{"P", "=", "2.4"}], ";", 
          RowBox[{"LVmin", "=", "False"}], ";"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Ea", "=", "5000"}], ";", 
      RowBox[{"R", "=", "8.314"}], ";", 
      RowBox[{"T0", "=", "298"}], ";", 
      RowBox[{"H0", "=", "211.19"}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"atm", "/", "mole"}], " ", 
        RowBox[{"frac", "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"H", "=", 
       RowBox[{"H0", "*", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["Ea", "R"]}], "*", 
          RowBox[{"(", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"T", "+", "273"}]], "-", 
            FractionBox["1", "T0"]}], ")"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yeq", "[", "x_", "]"}], ":=", 
       RowBox[{
        FractionBox["H", "P"], "*", "x"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"x0", "=", "0.35"}], ";", 
      RowBox[{"y1", "=", "25"}], ";", 
      RowBox[{"V", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yop", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         FractionBox["L", "V"], "*", 
         RowBox[{"(", 
          RowBox[{"x", "-", "x0"}], ")"}]}], "+", "y1"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"xmin1", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yop", "[", "x", "]"}], "\[Equal]", "0"}], ",", "x"}], 
          "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xmin2", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"1.1", "*", "y1"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ymin", "[", "x_", "]"}], ":=", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"yeq", "[", "xmin2", "]"}], "-", "0"}], 
         RowBox[{"xmin2", "-", "xmin1"}]], "*", 
        RowBox[{"(", 
         RowBox[{"x", "-", "xmin1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"xN", "=", 
       RowBox[{"x0", "+", 
        FractionBox[
         RowBox[{"yN1", "-", "y1"}], 
         RowBox[{"L", "/", "V"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xop", "=", 
       RowBox[{"1.1", "*", "x0"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"check", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"yop", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"X", "[", "0", "]"}], "=", "x0"}], ";", 
      RowBox[{
       RowBox[{"Y", "[", "0", "]"}], "=", 
       RowBox[{"yop", "[", "x0", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"X", "[", "i", "]"}], "=", 
           RowBox[{"x", "/.", 
            RowBox[{
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", 
                RowBox[{"Y", "[", 
                 RowBox[{"i", "-", "1"}], "]"}]}], ",", "x", ",", "Reals"}], 
              "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"Y", "[", "i", "]"}], "=", 
           RowBox[{"yop", "[", 
            RowBox[{"X", "[", "i", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "75"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"X", "[", "#", "]"}], "<", "xN"}], ",", "0", ",", 
               "#"}], "]"}], "&"}], "/@", 
            RowBox[{"Range", "@", "50"}]}], ",", "0"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"yop", "[", "x", "]"}], ",", 
          RowBox[{"yeq", "[", "x", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", "xop"}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Thick", ",", 
             RowBox[{"If", "[", 
              RowBox[{"LVmin", ",", "Transparent", ",", "Magenta"}], "]"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"1", ",", "0.4", ",", "0"}], "]"}]}], "}"}]}], "}"}]}], 
        ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"1.1", "*", "y1"}]}], "}"}]}], ",", 
        RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
        RowBox[{"PlotRangeClipping", "\[Rule]", "False"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Row", "@", 
            RowBox[{"{", 
             RowBox[{"\"\<solute/(solute-free liquid) \>\"", ",", 
              RowBox[{"Style", "[", 
               RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", " ", 
              "\"\< (ppm)\>\""}], "}"}]}], ",", 
           RowBox[{"Row", "@", 
            RowBox[{"{", 
             RowBox[{"\"\<solute/(solute-free vapor) \>\"", ",", 
              RowBox[{"Style", "[", 
               RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
              "\"\< (ppm)\>\""}], "}"}]}]}], "}"}]}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"17", ",", "Black"}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"370", ",", "380"}], "}"}]}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", 
           RowBox[{"PointSize", "@", "0.022"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"LVmin", "\[Equal]", "False"}], "\[And]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"check", "<", "0"}], "\[Or]", 
                RowBox[{"check", ">", "xop"}]}], ")"}]}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{"(*", "STAGES", "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"check", "<", "0"}], "\[Or]", 
                  RowBox[{"check", ">", "xop"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"#", "-", "1"}], "]"}], ",", 
                    RowBox[{"Y", "[", 
                    RowBox[{"#", "-", "1"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "#", "]"}], ",", 
                    RowBox[{"Y", "[", 
                    RowBox[{"#", "-", "1"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "#", "]"}], ",", 
                    RowBox[{"Y", "[", "#", "]"}]}], "}"}]}], "}"}], "]"}], 
                    "&"}], "/@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"n", "-", "1"}], "]"}]}], ",", 
                   RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"n", "-", "1"}], "]"}], ",", 
                    RowBox[{"Y", "[", 
                    RowBox[{"n", "-", "1"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xN", ",", 
                    RowBox[{"Y", "[", 
                    RowBox[{"n", "-", "1"}], "]"}]}], "}"}]}], "}"}], "]"}]}],
                   "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"yN", "+", 
                 RowBox[{"1", " ", "LINE"}]}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"Dashed", ",", "colV", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "yN1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xN", ",", "yN1"}], "}"}]}], "}"}], "]"}], ",", 
                 RowBox[{"Point", "@", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "yN1"}], "}"}]}], ",", 
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"text", "[", 
                    RowBox[{"\"\<y\>\"", ",", 
                    RowBox[{"n", "+", "1"}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "yN1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1.2", ",", "0"}], "}"}]}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"x0", " ", "AND", " ", "y1", " ", "LINES"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"Dashed", ",", "colL", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x0", ",", 
                    RowBox[{"yop", "[", "x0", "]"}]}], "}"}]}], "}"}], "]"}], 
                 ",", 
                 RowBox[{"Point", "@", 
                  RowBox[{"{", 
                   RowBox[{"x0", ",", "0"}], "}"}]}], ",", 
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"text", "[", 
                    RowBox[{"\"\<x\>\"", ",", "0"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x0", ",", "2.5"}], "}"}]}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"Dashed", ",", "colV", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "y1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x0", ",", "y1"}], "}"}]}], "}"}], "]"}], ",", 
                 RowBox[{"Point", "@", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "y1"}], "}"}]}], ",", 
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"text", "[", 
                    RowBox[{"\"\<y\>\"", ",", "1"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.2", "*", "xop"}], ",", "y1"}], "}"}]}], 
                  "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"xN", " ", "LINE"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"Dashed", ",", "colL", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"xN", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xN", ",", 
                    RowBox[{"yeq", "[", "xN", "]"}]}], "}"}]}], "}"}], "]"}], 
                 ",", 
                 RowBox[{"Point", "@", 
                  RowBox[{"{", 
                   RowBox[{"xN", ",", "0"}], "}"}]}], ",", 
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"text", "[", 
                    RowBox[{"\"\<x\>\"", ",", "n"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"xN", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "1.2"}], "}"}]}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", "STAGES", "*)"}], "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"check", "<", "0"}], "\[Or]", 
                  RowBox[{"check", ">", "xop"}]}], ",", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"n", "\[LessEqual]", "12"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"#", ",", "17", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"#", "-", "1"}], "]"}], ",", 
                    RowBox[{"Y", "[", 
                    RowBox[{"#", "-", "1"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.2"}], ",", "1"}], "}"}]}], "]"}], "&"}], "/@", 
                    RowBox[{"Range", "@", "n"}]}], "}"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"n", ">", "12"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"n", ",", "17", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"n", "-", "1"}], "]"}], ",", 
                    RowBox[{"Y", "[", 
                    RowBox[{"n", "-", "1"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.2"}], ",", "1"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"1", ",", "17", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "0", "]"}], ",", 
                    RowBox[{"Y", "[", "0", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.2"}], ",", "1"}], "}"}]}], "]"}]}], 
                    "}"}]}], "]"}]}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"HTS", ",", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                   "INLET", " ", "AND", " ", "OUTLET", " ", "STAGE", " ", 
                    "BALANCES"}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<stage \>\"", ",", "tray", ",", 
                    "\"\< solute fluxes:\>\""}], "}"}]}], ",", 
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<in: \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"(*", 
                    RowBox[{"n", "+", "1", "-"}], "*)"}], "tray", "]"}], "*", 
                    "L"}], "+", 
                    RowBox[{
                    RowBox[{"yop", "[", 
                    RowBox[{"X", "[", 
                    RowBox[{"(*", 
                    RowBox[{"n", "+", "1", "-"}], "*)"}], 
                    RowBox[{"tray", "-", "1"}], "]"}], "]"}], "*", "V"}]}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "1"}], "}"}]}], "]"}], ",", 
                    "\"\< mol/h\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<out: \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"(*", 
                    RowBox[{"n", "+", "1", "-"}], "*)"}], 
                    RowBox[{"tray", "-", "1"}], "]"}], "*", "L"}], "+", 
                    RowBox[{
                    RowBox[{"yop", "[", 
                    RowBox[{"X", "[", 
                    RowBox[{"(*", 
                    RowBox[{"n", "+", "1", "-"}], "*)"}], "tray", "]"}], 
                    "]"}], "*", "V"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "1"}], "}"}]}], "]"}], ",", 
                    "\"\< mol/h\>\""}], "}"}]}]}], "\[IndentingNewLine]", 
                    "}"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", "\"\<:\>\""}]}], "]"}]}], 
                    "}"}], ",", "Center"}], "]"}], ",", "17"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.105", ",", "20"}], "}"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<top\>\"", ",", "17", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x0", ",", "26"}], "}"}]}], "]"}], ",", 
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<bottom\>\"", ",", "17", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.15", "*", "xop"}], ",", "2"}], "}"}]}], 
                    "]"}]}], "\[IndentingNewLine]", "}"}]}], "]"}]}], 
              "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"L", "/", "V"}], " ", "min"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"LVmin", ",", 
             RowBox[{"(*", 
              RowBox[{"L", "/", "Vmin"}], "*)"}], 
             RowBox[{"{", 
              RowBox[{"Magenta", ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"xmin1", ",", 
                    RowBox[{"ymin", "[", "xmin1", "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"xmin2", ",", 
                    RowBox[{"ymin", "[", "xmin2", "]"}]}], "}"}]}], "}"}], 
                "]"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "OPERATING", " ", "AND", " ", "EQUILIBRIUM", " ", "LINE", " ", 
             "LABELS"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"Mouseover", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Thickness", "@", "0.02"}], ",", "Transparent", ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"xop", ",", 
                    RowBox[{"yeq", "[", "xop", "]"}]}], "}"}]}], "}"}], 
                "]"}]}], "}"}], ",", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<equilibrium line\>\"", ",", "17", ",", 
                 RowBox[{"RGBColor", "[", 
                  RowBox[{"1", ",", "0.4", ",", "0"}], "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"0.3", "*", "xop"}], ",", 
                 RowBox[{"0.75", "*", "y1"}]}], "}"}]}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Mouseover", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Thickness", "@", "0.02"}], ",", "Transparent", ",", 
               RowBox[{"If", "[", 
                RowBox[{"LVmin", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"xmin1", ",", 
                    RowBox[{"ymin", "[", "xmin1", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xmin2", ",", 
                    RowBox[{"ymin", "[", "xmin2", "]"}]}], "}"}]}], "}"}], 
                  "]"}], ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"yop", "[", "0", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xop", ",", 
                    RowBox[{"yop", "[", "xop", "]"}]}], "}"}]}], "}"}], 
                  "]"}]}], "]"}]}], "}"}], ",", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"Column", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<operating line\>\"", ",", "\"\<(mass balance)\>\""}],
                     "}"}], ",", "Center"}], "]"}], ",", "17", ",", 
                 "Magenta"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"0.3", "*", "xop"}], ",", 
                 RowBox[{"0.75", "*", "y1"}]}], "}"}]}], "]"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Grid", "@", 
    RowBox[{"{", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"yN1", ",", "1", ",", 
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{"\"\<inlet vapor mole ratio \>\"", ",", 
               RowBox[{"Subscript", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<N\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<+1\>\""}], "}"}]}]}], "]"}]}], "}"}]}]}], "}"}], ",",
           "1", ",", "15", ",", "0.1", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
          RowBox[{"Enabled", "\[Rule]", 
           RowBox[{"If", "[", 
            RowBox[{"HTS", ",", "False", ",", "True"}], "]"}]}]}], "}"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "L", ",", "100", ",", "\"\<solvent flow rate (Mmol/h)\>\""}], 
           "}"}], ",", "1", ",", "100", ",", "0.1", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
          RowBox[{"Enabled", "\[Rule]", 
           RowBox[{"If", "[", 
            RowBox[{"HTS", ",", "False", ",", "True"}], "]"}]}]}], "}"}], 
        "]"}]}], "\[IndentingNewLine]", "}"}], "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Grid", "@", 
    RowBox[{"{", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"T", ",", "25", ",", "\"\<temperature (\[Degree]C)\>\""}], 
           "}"}], ",", "10", ",", "80", ",", "1", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
          RowBox[{"Enabled", "\[Rule]", 
           RowBox[{"If", "[", 
            RowBox[{"HTS", ",", "False", ",", "True"}], "]"}]}]}], "}"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"P", ",", "2.5", ",", "\"\<pressure (atm)\>\""}], "}"}], 
          ",", "1.5", ",", "3", ",", "0.1", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
          RowBox[{"Enabled", "\[Rule]", 
           RowBox[{"If", "[", 
            RowBox[{"HTS", ",", "False", ",", "True"}], "]"}]}]}], "}"}], 
        "]"}]}], "\[IndentingNewLine]", "}"}], "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Grid", "@", 
    RowBox[{"{", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"LVmin", ",", "False", ",", 
            RowBox[{"Subscript", "[", 
             RowBox[{
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{"\"\<(\>\"", ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<L\>\"", ",", "Italic"}], "]"}], ",", 
                 "\"\</\>\"", ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<V\>\"", ",", "Italic"}], "]"}], ",", 
                 "\"\<)\>\""}], "}"}]}], ",", "\"\<min\>\""}], "]"}]}], "}"}],
           ",", 
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}], ",", 
          RowBox[{"Enabled", "\[Rule]", 
           RowBox[{"If", "[", 
            RowBox[{"HTS", ",", "False", ",", "True"}], "]"}]}]}], "}"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "HTS", ",", "False", ",", "\"\<show diagram with 5 stages\>\""}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PaneSelector", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"True", "\[Rule]", 
           RowBox[{"Control", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"tray", ",", "1", ",", "\"\<stage\>\""}], "}"}], ",", 
              "1", ",", "5", ",", "1", ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"Dynamic", "@", "HTS"}]}], "]"}]}], "\[IndentingNewLine]", 
      "}"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7168226470505595`*^9, 3.71682281537859*^9}, {
   3.716822854583188*^9, 3.71682301156536*^9}, {3.7168230708508615`*^9, 
   3.7168232287486506`*^9}, {3.716823284534526*^9, 3.7168233449844255`*^9}, {
   3.7168233783979993`*^9, 3.7168234945827847`*^9}, {3.716823541655611*^9, 
   3.716823638665717*^9}, {3.7168237205717154`*^9, 3.716823757368292*^9}, {
   3.716823822133214*^9, 3.7168238388045096`*^9}, {3.716823911411668*^9, 
   3.7168240668456435`*^9}, 3.716824100075616*^9, {3.716824140843217*^9, 
   3.716824156404294*^9}, {3.7168241913224707`*^9, 3.7168242029135237`*^9}, {
   3.716824236029697*^9, 3.716824236827298*^9}, {3.7168243007664185`*^9, 
   3.716824381722027*^9}, {3.716824427729853*^9, 
   3.7168244746130915`*^9}},ExpressionUUID->"d0db1fa4-3d74-4856-a97b-\
b8e3b391f6f1"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`HTS$$ = False, $CellContext`L$$ = 
    100, $CellContext`LVmin$$ = False, $CellContext`P$$ = 
    2.5, $CellContext`T$$ = 25, $CellContext`tray$$ = 1, $CellContext`yN1$$ = 
    1, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`yN1$$], 1, 
       Row[{"inlet vapor mole ratio ", 
         Subscript[
          Style["y", Italic], 
          Row[{
            Style["N", Italic], "+1"}]]}]}, 1, 15, 0.1}, {{
       Hold[$CellContext`L$$], 100, "solvent flow rate (Mmol/h)"}, 1, 100, 
      0.1}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], 
          Manipulate`Place[2]}}]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`T$$], 25, "temperature (\[Degree]C)"}, 10, 80, 1}, {{
       Hold[$CellContext`P$$], 2.5, "pressure (atm)"}, 1.5, 3, 0.1}, {
      Hold[
       Grid[{{
          Manipulate`Place[3], 
          Manipulate`Place[4]}}]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`LVmin$$], False, 
       Subscript[
        Row[{"(", 
          Style["L", Italic], "/", 
          Style["V", Italic], ")"}], "min"]}, {True, False}}, {{
       Hold[$CellContext`HTS$$], False, "show diagram with 5 stages"}, {
      True, False}}, {{
       Hold[$CellContext`tray$$], 1, "stage"}, 1, 5, 1}, {
      Hold[
       Grid[{{
          Manipulate`Place[5], 
          Manipulate`Place[6], 
          PaneSelector[{True -> Manipulate`Place[7]}, 
           Dynamic[$CellContext`HTS$$]]}}]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    370., {187., 193.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`yN1$445136$$ = 
    0, $CellContext`L$445137$$ = 0, $CellContext`T$445138$$ = 
    0, $CellContext`P$445139$$ = 0, $CellContext`LVmin$445140$$ = 
    False, $CellContext`HTS$445141$$ = False, $CellContext`tray$445142$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`HTS$$ = False, $CellContext`L$$ = 
        100, $CellContext`LVmin$$ = False, $CellContext`P$$ = 
        2.5, $CellContext`T$$ = 25, $CellContext`tray$$ = 
        1, $CellContext`yN1$$ = 1}, "ControllerVariables" :> {
        Hold[$CellContext`yN1$$, $CellContext`yN1$445136$$, 0], 
        Hold[$CellContext`L$$, $CellContext`L$445137$$, 0], 
        Hold[$CellContext`T$$, $CellContext`T$445138$$, 0], 
        Hold[$CellContext`P$$, $CellContext`P$445139$$, 0], 
        Hold[$CellContext`LVmin$$, $CellContext`LVmin$445140$$, False], 
        Hold[$CellContext`HTS$$, $CellContext`HTS$445141$$, False], 
        Hold[$CellContext`tray$$, $CellContext`tray$445142$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`Ea$, $CellContext`R$, $CellContext`T0$, \
$CellContext`H0$, $CellContext`H$, $CellContext`yeq$, $CellContext`x0$, \
$CellContext`y1$, $CellContext`V$, $CellContext`yop$, $CellContext`xmin1$, \
$CellContext`xmin2$, $CellContext`ymin$, $CellContext`xN$, $CellContext`xop$, \
$CellContext`check$, $CellContext`X$, $CellContext`Y$, $CellContext`n$}, 
        If[$CellContext`HTS$$, {$CellContext`yN1$$ = 1.8; $CellContext`L$$ = 
            100; $CellContext`T$$ = 13; $CellContext`P$$ = 
            2.4; $CellContext`LVmin$$ = False; Null}]; $CellContext`Ea$ = 
         5000; $CellContext`R$ = 8.314; $CellContext`T0$ = 
         298; $CellContext`H0$ = 
         211.19; $CellContext`H$ = $CellContext`H0$ 
          Exp[(-($CellContext`Ea$/$CellContext`R$)) (
             1/($CellContext`T$$ + 273) - 
             1/$CellContext`T0$)]; $CellContext`yeq$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := ($CellContext`H$/$CellContext`P$$) $CellContext`x$; \
$CellContext`x0$ = 0.35; $CellContext`y1$ = 25; $CellContext`V$ = 
         1; $CellContext`yop$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := ($CellContext`L$$/$CellContext`V$) ($CellContext`x$ - \
$CellContext`x0$) + $CellContext`y1$; $CellContext`xmin1$ = 
         ReplaceAll[$CellContext`x, 
           Part[
            Solve[$CellContext`yop$[$CellContext`x] == 0, $CellContext`x], 
            1]]; $CellContext`xmin2$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yeq$[$CellContext`x] == 
             1.1 $CellContext`y1$, $CellContext`x], 1]]; $CellContext`ymin$[
           Pattern[$CellContext`x$, 
            Blank[]]] := (($CellContext`yeq$[$CellContext`xmin2$] + 
            0)/($CellContext`xmin2$ - $CellContext`xmin1$)) ($CellContext`x$ - \
$CellContext`xmin1$); $CellContext`xN$ = $CellContext`x0$ + \
($CellContext`yN1$$ - $CellContext`y1$)/($CellContext`L$$/$CellContext`V$); \
$CellContext`xop$ = 1.1 $CellContext`x0$; $CellContext`check$ = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yeq$[$CellContext`x] == \
$CellContext`yop$[$CellContext`x], $CellContext`x], 1]]; $CellContext`X$[
          0] = $CellContext`x0$; $CellContext`Y$[
          0] = $CellContext`yop$[$CellContext`x0$]; 
        Do[{$CellContext`X$[$CellContext`i] = ReplaceAll[$CellContext`x, 
             Part[
              
              Solve[$CellContext`yeq$[$CellContext`x] == \
$CellContext`Y$[$CellContext`i - 1], $CellContext`x, Reals], 
              1]], $CellContext`Y$[$CellContext`i] = $CellContext`yop$[
             $CellContext`X$[$CellContext`i]]}, {$CellContext`i, 1, 
           75}]; $CellContext`n$ = 1 + Part[
            DeleteCases[
             Map[If[$CellContext`X$[#] < $CellContext`xN$, 0, #]& , 
              Range[50]], 0], -1]; Plot[{
           $CellContext`yop$[$CellContext`x], 
           $CellContext`yeq$[$CellContext`x]}, {$CellContext`x, 
           0, $CellContext`xop$}, PlotStyle -> {{Thick, 
             If[$CellContext`LVmin$$, Transparent, Magenta]}, {Thick, 
             RGBColor[1, 0.4, 0]}}, PlotRange -> {0, 1.1 $CellContext`y1$}, 
          PlotRangePadding -> None, PlotRangeClipping -> False, Frame -> True,
           FrameLabel -> {
            Row[{"solute/(solute-free liquid) ", 
              Style["x", Italic], " (ppm)"}], 
            Row[{"solute/(solute-free vapor) ", 
              Style["y", Italic], " (ppm)"}]}, LabelStyle -> {17, Black}, 
          ImageSize -> {370, 380}, AspectRatio -> Full, Epilog -> {Thick, 
            PointSize[0.022], 
            If[
             And[$CellContext`LVmin$$ == False, 
              
              Or[$CellContext`check$ < 
               0, $CellContext`check$ > $CellContext`xop$]], {
              If[
               
               Or[$CellContext`check$ < 
                0, $CellContext`check$ > $CellContext`xop$], {
                Map[Line[{{
                    $CellContext`X$[# - 1], 
                    $CellContext`Y$[# - 1]}, {
                    $CellContext`X$[#], 
                    $CellContext`Y$[# - 1]}, {
                    $CellContext`X$[#], 
                    $CellContext`Y$[#]}}]& , 
                 Range[$CellContext`n$ - 1]], 
                Line[{{
                   $CellContext`X$[$CellContext`n$ - 1], 
                   $CellContext`Y$[$CellContext`n$ - 1]}, {$CellContext`xN$, 
                   $CellContext`Y$[$CellContext`n$ - 1]}}]}], {
              Dashed, $CellContext`colV, 
               
               Line[{{0, $CellContext`yN1$$}, {$CellContext`xN$, \
$CellContext`yN1$$}}], 
               Point[{0, $CellContext`yN1$$}], 
               Text[
                $CellContext`text["y", $CellContext`n$ + 1], {
                0, $CellContext`yN1$$}, {1.2, 0}]}, {
              Dashed, $CellContext`colL, 
               Line[{{$CellContext`x0$, 0}, {$CellContext`x0$, 
                  $CellContext`yop$[$CellContext`x0$]}}], 
               Point[{$CellContext`x0$, 0}], 
               Text[
                $CellContext`text["x", 0], {$CellContext`x0$, 2.5}]}, {
              Dashed, $CellContext`colV, 
               
               Line[{{0, $CellContext`y1$}, {$CellContext`x0$, \
$CellContext`y1$}}], 
               Point[{0, $CellContext`y1$}], 
               Text[
                $CellContext`text["y", 1], {
                0.2 $CellContext`xop$, $CellContext`y1$}]}, {
              Dashed, $CellContext`colL, 
               Line[{{$CellContext`xN$, 0}, {$CellContext`xN$, 
                  $CellContext`yeq$[$CellContext`xN$]}}], 
               Point[{$CellContext`xN$, 0}], 
               Text[
                $CellContext`text[
                "x", $CellContext`n$], {$CellContext`xN$, 0}, {0, 1.2}]}, 
              If[
               
               Or[$CellContext`check$ < 
                0, $CellContext`check$ > $CellContext`xop$], {
                If[$CellContext`n$ <= 12, {
                  Map[Text[
                    Style[#, 17, Background -> White], {
                    $CellContext`X$[# - 1], 
                    $CellContext`Y$[# - 1]}, {-1.2, 1}]& , 
                   Range[$CellContext`n$]]}], 
                If[$CellContext`n$ > 12, {
                  Text[
                   Style[$CellContext`n$, 17, Background -> White], {
                    $CellContext`X$[$CellContext`n$ - 1], 
                    $CellContext`Y$[$CellContext`n$ - 1]}, {-1.2, 1}], 
                  Text[
                   Style[1, 17, Background -> White], {
                    $CellContext`X$[0], 
                    $CellContext`Y$[0]}, {-1.2, 1}]}]}], 
              If[$CellContext`HTS$$, {
                Text[
                 Style[
                  Column[{
                    Row[{"stage ", $CellContext`tray$$, " solute fluxes:"}], 
                    Column[{
                    Row[{"in: ", 
                    
                    NumberForm[$CellContext`X$[$CellContext`tray$$] \
$CellContext`L$$ + $CellContext`yop$[
                    $CellContext`X$[$CellContext`tray$$ - 
                    1]] $CellContext`V$, {4, 1}], " mol/h"}], 
                    Row[{"out: ", 
                    
                    NumberForm[$CellContext`X$[$CellContext`tray$$ - 
                    1] $CellContext`L$$ + $CellContext`yop$[
                    $CellContext`X$[$CellContext`tray$$]] $CellContext`V$, {4,
                     1}], " mol/h"}]}, Alignment -> ":"]}, Center], 17], {
                 0.105, 20}], 
                Text[
                 Style[
                 "top", 17, Background -> White], {$CellContext`x0$, 26}], 
                Text[
                 Style["bottom", 17, Background -> White], {
                 0.15 $CellContext`xop$, 2}]}]}], 
            If[$CellContext`LVmin$$, {Magenta, 
              Line[{{$CellContext`xmin1$, 
                 $CellContext`ymin$[$CellContext`xmin1$]}, \
{$CellContext`xmin2$, 
                 $CellContext`ymin$[$CellContext`xmin2$]}}]}], 
            Mouseover[{
              Thickness[0.02], Transparent, 
              Line[{{0, 0}, {$CellContext`xop$, 
                 $CellContext`yeq$[$CellContext`xop$]}}]}, 
             Text[
              Style["equilibrium line", 17, 
               RGBColor[1, 0.4, 0]], {
              0.3 $CellContext`xop$, 0.75 $CellContext`y1$}]], 
            Mouseover[{
              Thickness[0.02], Transparent, 
              If[$CellContext`LVmin$$, 
               Line[{{$CellContext`xmin1$, 
                  $CellContext`ymin$[$CellContext`xmin1$]}, \
{$CellContext`xmin2$, 
                  $CellContext`ymin$[$CellContext`xmin2$]}}], 
               Line[{{0, 
                  $CellContext`yop$[0]}, {$CellContext`xop$, 
                  $CellContext`yop$[$CellContext`xop$]}}]]}, 
             Text[
              Style[
               Column[{"operating line", "(mass balance)"}, Center], 17, 
               Magenta], {0.3 $CellContext`xop$, 0.75 $CellContext`y1$}]]}]], 
      "Specifications" :> {{{$CellContext`yN1$$, 1, 
          Row[{"inlet vapor mole ratio ", 
            Subscript[
             Style["y", Italic], 
             Row[{
               Style["N", Italic], "+1"}]]}]}, 1, 15, 0.1, Appearance -> 
         "Labeled", ImageSize -> Small, Enabled -> Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 
         1}, {{$CellContext`L$$, 100, "solvent flow rate (Mmol/h)"}, 1, 100, 
         0.1, Appearance -> "Labeled", ImageSize -> Small, Enabled -> Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 2}, 
        Grid[{{
           Manipulate`Place[1], 
           Manipulate`Place[2]}}], {{$CellContext`T$$, 25, 
          "temperature (\[Degree]C)"}, 10, 80, 1, Appearance -> "Labeled", 
         ImageSize -> Small, Enabled -> Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 
         3}, {{$CellContext`P$$, 2.5, "pressure (atm)"}, 1.5, 3, 0.1, 
         Appearance -> "Labeled", ImageSize -> Small, Enabled -> Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 4}, 
        Grid[{{
           Manipulate`Place[3], 
           Manipulate`Place[4]}}], {{$CellContext`LVmin$$, False, 
          Subscript[
           Row[{"(", 
             Style["L", Italic], "/", 
             Style["V", Italic], ")"}], "min"]}, {True, False}, Enabled -> 
         Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 
         5}, {{$CellContext`HTS$$, False, "show diagram with 5 stages"}, {
         True, False}, ControlPlacement -> 
         6}, {{$CellContext`tray$$, 1, "stage"}, 1, 5, 1, Appearance -> 
         "Labeled", ControlPlacement -> 7}, 
        Grid[{{
           Manipulate`Place[5], 
           Manipulate`Place[6], 
           PaneSelector[{True -> Manipulate`Place[7]}, 
            Dynamic[$CellContext`HTS$$]]}}]}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{647., {256., 263.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.7168228188278127`*^9, 3.7168228805927143`*^9, {3.716823013654979*^9, 
   3.7168230419151125`*^9}, 3.7168230807989116`*^9, 3.716823118503704*^9, {
   3.716823160701507*^9, 3.71682318510283*^9}, {3.7168232183874006`*^9, 
   3.716823234003476*^9}, {3.7168232962353783`*^9, 3.716823404966528*^9}, {
   3.7168234519229593`*^9, 3.7168234953939857`*^9}, 3.7168235448372326`*^9, 
   3.7168235772165875`*^9, {3.7168236083767567`*^9, 3.716823639932319*^9}, 
   3.7168237280377445`*^9, {3.7168237602585135`*^9, 3.71682377325797*^9}, 
   3.716823847208541*^9, {3.7168239423910203`*^9, 3.7168239551186905`*^9}, {
   3.716823993058668*^9, 3.716824029478668*^9}, {3.7168240598566155`*^9, 
   3.7168240680156455`*^9}, 3.7168241017946196`*^9, 3.716824157936097*^9, 
   3.716824203929526*^9, 3.7168243371120005`*^9, 3.7168243940402813`*^9, {
   3.7168244317024765`*^9, 
   3.716824484468934*^9}},ExpressionUUID->"3949cbfb-b377-4f9c-b826-\
70d9f4daa203"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Grid", "@", 
    RowBox[{"{", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"\"\<concentrations (ppm)\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x0", ",", "0.35", ",", 
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{"\"\<inlet liquid \>\"", ",", 
               RowBox[{"Subscript", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", "0"}], 
                "]"}]}], "}"}]}]}], "}"}], ",", "0", ",", "1", ",", "0.01", 
          ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"y1", ",", "25", ",", 
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{"\"\<outlet vapor \>\"", ",", 
               RowBox[{"Subscript", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", "1"}], 
                "]"}]}], "}"}]}]}], "}"}], ",", "10", ",", "50", ",", "1", 
          ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], "}"}]}], ","}], "*)"}]], "Input",Expressio\
nUUID->"36025558-d132-483a-9113-948b19c2f5aa"]
},
WindowSize->{667, 670},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.1 for Microsoft Windows (64-bit) (March 13, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 337, 9, 38, "Input", "ExpressionUUID" -> \
"ee34f1d0-61ee-4e06-9284-f8e3dff69545",
 InitializationCell->True],
Cell[898, 31, 769, 21, 58, "Input", "ExpressionUUID" -> \
"97bc5f38-6394-425b-95e3-8167c80a658e",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1692, 56, 30865, 733, 2361, "Input", "ExpressionUUID" -> \
"d0db1fa4-3d74-4856-a97b-b8e3b391f6f1"],
Cell[32560, 791, 15573, 318, 536, "Output", "ExpressionUUID" -> \
"3949cbfb-b377-4f9c-b826-70d9f4daa203"]
}, Open  ]],
Cell[48148, 1112, 1700, 41, 107, "Input", "ExpressionUUID" -> \
"36025558-d132-483a-9113-948b19c2f5aa"]
}
]
*)

