(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    232784,       5484]
NotebookOptionsPosition[    226484,       5293]
NotebookOutlinePosition[    228107,       5344]
CellTagsIndexPosition[    227771,       5332]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["McCabe-Thiele Method for Methanol/Water Separation", "DemoTitle",
 CellChangeTimes->{3.696007433299176*^9}],

Cell["", "InitializationSection"],

Cell[CellGroupData[{

Cell["", "ManipulateSection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "P", ",", "Psat1", ",", "Psat2", ",", "A12", ",", "A21", ",", 
       "\[Gamma]1", ",", "\[Gamma]2", ",", "equilb", ",", "zf", ",", "q", ",",
        "feed", ",", "xpinch", ",", "ypinch", ",", "opertRect", ",", 
       "opertStrp", ",", "OpRect", ",", "xi", ",", "yi", ",", "cond1", ",", 
       "cond2", ",", "OpStrp", ",", "i", ",", "yR", ",", "xR", ",", "x1", ",",
        "y1", ",", "nR", ",", "yS", ",", "xS", ",", "nS", ",", "nT", ",", 
       "distflow", ",", "botflow", ",", "Ry", ",", "Rx", ",", "Sy", ",", "Sx",
        ",", "Sr", ",", "xybase", ",", "diagram", ",", "mouse"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"P", "=", "760"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Psat1", "[", "temp_", "]"}], ":=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"8.08097", "-", 
          FractionBox["1582.271", 
           RowBox[{"239.726", "+", "temp"}]]}], ")"}]}]}], ";", 
      RowBox[{"(*", "methanol", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Psat2", "[", "temp_", "]"}], ":=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"8.07131", "-", 
          FractionBox["1730.63", 
           RowBox[{"233.426", "+", "temp"}]]}], ")"}]}]}], ";", 
      RowBox[{"(*", "water", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"A12", "=", "0.7923"}], ";", 
      RowBox[{"A21", "=", "0.5434"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Gamma]1", "[", "x_", "]"}], ":=", 
       RowBox[{"Exp", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "x"}], ")"}], "2"], "*", 
         RowBox[{"(", 
          RowBox[{"A12", "+", 
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"A21", "-", "A12"}], ")"}], "*", "x"}]}], ")"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Gamma]2", "[", "x_", "]"}], ":=", 
       RowBox[{"Exp", "[", 
        RowBox[{
         SuperscriptBox["x", "2"], "*", 
         RowBox[{"(", 
          RowBox[{"A21", "+", 
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"A12", "-", "A21"}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", "x"}], ")"}]}]}], ")"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"equilb", "=", 
       RowBox[{"Quiet", "@", 
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", 
             RowBox[{"y", "/.", 
              RowBox[{"Quiet", "@", 
               RowBox[{"FindRoot", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"y", "\[Equal]", 
                    FractionBox[
                    RowBox[{"#", "*", 
                    RowBox[{"\[Gamma]1", "[", "#", "]"}], "*", 
                    RowBox[{"Psat1", "[", "temp", "]"}]}], "P"]}], ",", 
                   RowBox[{"P", "\[Equal]", 
                    RowBox[{
                    RowBox[{"#", "*", 
                    RowBox[{"\[Gamma]1", "[", "#", "]"}], "*", 
                    RowBox[{"Psat1", "[", "temp", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "#"}], ")"}], "*", 
                    RowBox[{"\[Gamma]2", "[", "#", "]"}], "*", 
                    RowBox[{"Psat2", "[", "temp", "]"}]}]}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"y", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"temp", ",", "60"}], "}"}]}], "}"}]}], 
                "]"}]}]}]}], "}"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "1", ",", "0.05"}], "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
         "**", "**", "**", "**", "**", "**"}], "*****)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"zf", "=", "0.5"}], ";", 
      RowBox[{"q", "=", "0.5"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"feed", "[", "x_", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"q", "\[NotEqual]", "1"}], ",", 
         RowBox[{
          RowBox[{
           FractionBox["q", 
            RowBox[{"q", "-", "1"}]], "*", "x"}], "-", 
          FractionBox["zf", 
           RowBox[{"q", "-", "1"}]]}], ",", 
         RowBox[{
          RowBox[{"1*^6", "*", 
           RowBox[{"(", 
            RowBox[{"x", "-", "zf"}], ")"}]}], "+", "zf"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"xpinch", "=", 
       RowBox[{"x", "/.", 
        RowBox[{"Quiet", "@", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"feed", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"equilb", "[", "x", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0.5"}], "}"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ypinch", "=", 
       RowBox[{"feed", "[", "xpinch", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"opertRect", "[", "x_", "]"}], ":=", 
       RowBox[{"ypinch", "+", 
        RowBox[{
         FractionBox[
          RowBox[{"x", "-", "xpinch"}], 
          RowBox[{"xd", "-", "xpinch"}]], "*", 
         RowBox[{"(", 
          RowBox[{"xd", "-", "ypinch"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"opertStrp", "[", "x_", "]"}], ":=", 
       RowBox[{"ypinch", "+", 
        RowBox[{
         FractionBox[
          RowBox[{"x", "-", "xpinch"}], 
          RowBox[{"xb", "-", "xpinch"}]], "*", 
         RowBox[{"(", 
          RowBox[{"xb", "-", "ypinch"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"OpRect", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         FractionBox["R", 
          RowBox[{"R", "+", "1"}]], "*", "x"}], "+", 
        FractionBox["xd", 
         RowBox[{"R", "+", "1"}]]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"xi", "=", 
       RowBox[{"x", "/.", 
        RowBox[{"Quiet", "@", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"feed", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"OpRect", "[", "x", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0.7"}], "}"}]}], "]"}]}]}]}], ";", 
      RowBox[{"yi", "=", 
       RowBox[{"OpRect", "[", "xi", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"cond1", "=", 
       RowBox[{"yi", "\[GreaterEqual]", 
        RowBox[{"equilb", "[", "xi", "]"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"true", " ", "for", " ", "pinch", " ", "point"}], " ", "-", 
        " ", 
        RowBox[{"infinite", " ", "stages"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"cond2", "=", 
       RowBox[{"yi", "<", 
        RowBox[{"equilb", "[", "xi", "]"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"true", " ", "for", " ", "normal", " ", "#", " ", "stages"}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"cond1", ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"OpStrp", "[", "x_", "]"}], ":=", 
           RowBox[{"opertStrp", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"i", "=", "0"}], ";", 
          RowBox[{
           RowBox[{"yR", "[", "0", "]"}], "=", "xd"}], ";", 
          RowBox[{
           RowBox[{"xR", "[", "0", "]"}], "=", "xd"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"i", "<", "25"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x1", "=", 
               RowBox[{"x", "/.", 
                RowBox[{"Quiet", "[", 
                 RowBox[{"FindRoot", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"yR", "[", "i", "]"}], "\[Equal]", 
                    RowBox[{"equilb", "[", "x", "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x", ",", "0.5"}], "}"}]}], "]"}], "]"}]}]}], ",", 
              RowBox[{"y1", "=", 
               RowBox[{"opertRect", "[", "x1", "]"}]}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"x1", ">", "xpinch"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"xR", "[", 
                    RowBox[{"i", "+", "1"}], "]"}], "=", "x1"}], ",", 
                  RowBox[{
                   RowBox[{"yR", "[", 
                    RowBox[{"i", "+", "1"}], "]"}], "=", "y1"}]}], "}"}]}], 
               "]"}], ",", 
              RowBox[{"i", "++"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nR", "=", 
           RowBox[{"i", "-", "1"}]}], ";", 
          RowBox[{"(*", 
           RowBox[{"rectifying", " ", "stages"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"i", "=", "0"}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"nR", "\[GreaterEqual]", "0"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"yS", "[", "0", "]"}], "=", 
               RowBox[{"yR", "[", "nR", "]"}]}], ";", 
              RowBox[{
               RowBox[{"xS", "[", "0", "]"}], "=", 
               RowBox[{"xR", "[", "nR", "]"}]}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"i", "<", "20"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x1", "=", 
               RowBox[{"x", "/.", 
                RowBox[{"Quiet", "@", 
                 RowBox[{"FindRoot", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"yS", "[", "i", "]"}], "\[Equal]", 
                    RowBox[{"equilb", "[", "x", "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x", ",", "0.5"}], "}"}]}], "]"}]}]}]}], ",", 
              RowBox[{"y1", "=", 
               RowBox[{"opertStrp", "[", "x1", "]"}]}], ",", 
              RowBox[{
               RowBox[{"xS", "[", 
                RowBox[{"i", "+", "1"}], "]"}], "=", "x1"}], ",", 
              RowBox[{
               RowBox[{"yS", "[", 
                RowBox[{"i", "+", "1"}], "]"}], "=", "y1"}], ",", 
              RowBox[{"i", "++"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nS", "=", 
           RowBox[{"i", "-", "1"}]}], ";"}], "}"}], ",", 
        RowBox[{"(*", 
         RowBox[{"stripping", " ", "stages"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"OpStrp", "[", "x_", "]"}], ":=", 
           RowBox[{"yi", "+", 
            RowBox[{
             FractionBox[
              RowBox[{"x", "-", "xi"}], 
              RowBox[{"xb", "-", "xi"}]], "*", 
             RowBox[{"(", 
              RowBox[{"xb", "-", "yi"}], ")"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"i", "=", "0"}], ";", 
          RowBox[{
           RowBox[{"yR", "[", "0", "]"}], "=", "xd"}], ";", 
          RowBox[{
           RowBox[{"xR", "[", "0", "]"}], "=", "xd"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"xR", "[", "i", "]"}], ">", "xi"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x1", "=", 
               RowBox[{"x", "/.", 
                RowBox[{"Quiet", "@", 
                 RowBox[{"FindRoot", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"yR", "[", "i", "]"}], "\[Equal]", 
                    RowBox[{"equilb", "[", "x", "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x", ",", "0.7"}], "}"}]}], "]"}]}]}]}], ",", 
              RowBox[{"y1", "=", 
               RowBox[{"OpRect", "[", "x1", "]"}]}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"x1", ">", "xi"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"xR", "[", 
                    RowBox[{"i", "+", "1"}], "]"}], "=", "x1"}], ",", 
                  RowBox[{
                   RowBox[{"yR", "[", 
                    RowBox[{"i", "+", "1"}], "]"}], "=", "y1"}]}], "}"}]}], 
               "]"}], ",", 
              RowBox[{"i", "++"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nR", "=", 
           RowBox[{"i", "-", "1"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"i", "=", "0"}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"nR", "\[GreaterEqual]", "0"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"yS", "[", "0", "]"}], "=", 
              RowBox[{"yR", "[", "nR", "]"}]}], ";", 
             RowBox[{
              RowBox[{"xS", "[", "0", "]"}], "=", 
              RowBox[{"xR", "[", "nR", "]"}]}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"xS", "[", "i", "]"}], ">", "xb"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x1", "=", 
               RowBox[{"x", "/.", 
                RowBox[{"Quiet", "@", 
                 RowBox[{"FindRoot", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"yS", "[", "i", "]"}], "\[Equal]", 
                    RowBox[{"equilb", "[", "x", "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x", ",", "0.5"}], "}"}]}], "]"}]}]}]}], ",", 
              RowBox[{"y1", "=", 
               RowBox[{"OpStrp", "[", "x1", "]"}]}], ",", 
              RowBox[{
               RowBox[{"xS", "[", 
                RowBox[{"i", "+", "1"}], "]"}], "=", "x1"}], ",", 
              RowBox[{
               RowBox[{"yS", "[", 
                RowBox[{"i", "+", "1"}], "]"}], "=", "y1"}], ",", 
              RowBox[{"i", "++"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nS", "=", 
           RowBox[{"i", "-", "1"}]}], ";"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nT", "=", 
       RowBox[{"nR", "+", "nS", "+", "1"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"total", " ", "stages"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"distflow", "=", 
       FractionBox[
        RowBox[{"zf", "-", 
         RowBox[{"xS", "[", 
          RowBox[{"nS", "+", "1"}], "]"}]}], "xd"]}], ";", 
      RowBox[{"botflow", "=", 
       RowBox[{"1", "-", "distflow"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"R", " ", "STAGES"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Ry", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xR", "[", "#", "]"}], ",", 
              RowBox[{"yR", "[", 
               RowBox[{"#", "-", "1"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xR", "[", "#", "]"}], ",", 
              RowBox[{"yR", "[", "#", "]"}]}], "}"}]}], "}"}], "]"}], "&"}], "/@", 
        RowBox[{"Range", "@", "nR"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Rx", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xR", "[", "#", "]"}], ",", 
              RowBox[{"yR", "[", "#", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xR", "[", 
               RowBox[{"#", "+", "1"}], "]"}], ",", 
              RowBox[{"yR", "[", "#", "]"}]}], "}"}]}], "}"}], "]"}], "&"}], "/@", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nR", "\[GreaterEqual]", "1"}], ",", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{"nR", "-", "1"}]}], "]"}], ",", 
          RowBox[{"{", "0", "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"S", " ", "STAGES"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Sy", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xS", "[", 
               RowBox[{"#", "+", "1"}], "]"}], ",", 
              RowBox[{"yS", "[", "#", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xS", "[", 
               RowBox[{"#", "+", "1"}], "]"}], ",", 
              RowBox[{"yS", "[", 
               RowBox[{"#", "+", "1"}], "]"}]}], "}"}]}], "}"}], "]"}], "&"}],
         "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", 
          RowBox[{"nS", "-", "1"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Sx", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xS", "[", 
               RowBox[{"#", "-", "1"}], "]"}], ",", 
              RowBox[{"yS", "[", 
               RowBox[{"#", "-", "1"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xS", "[", "#", "]"}], ",", 
              RowBox[{"yS", "[", 
               RowBox[{"#", "-", "1"}], "]"}]}], "}"}]}], "}"}], "]"}], "&"}],
         "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"nS", "+", "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Sr", "=", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xS", "[", 
             RowBox[{"nS", "+", "1"}], "]"}], ",", 
            RowBox[{"yS", "[", "nS", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xS", "[", 
             RowBox[{"nS", "+", "1"}], "]"}], ",", "0"}], "}"}]}], "}"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
         "**", "**", "**", "**", "**", "**"}], "*****)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"xybase", "=", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"equilb", "[", "x", "]"}], ",", "x"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Thick", ",", "Red"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Thick", ",", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{"0", ",", "0.6", ",", "0"}], "]"}]}], "}"}]}], 
             "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"cond1", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"feed", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "xpinch", ",", "zf"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", "Blue"}], "}"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"opertRect", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "xpinch", ",", "xd"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", 
                  RowBox[{"RGBColor", "[", 
                   RowBox[{"1", ",", "0.4", ",", "0"}], "]"}]}], "}"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"opertStrp", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "xb", ",", "xpinch"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", 
                  RowBox[{"Hue", "@", "0.9"}]}], "}"}]}]}], "]"}]}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"feed", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "xi", ",", "zf"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", "Blue"}], "}"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"OpRect", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "xi", ",", "xd"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", 
                  RowBox[{"RGBColor", "[", 
                   RowBox[{"1", ",", "0.4", ",", "0"}], "]"}]}], "}"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"OpStrp", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "xb", ",", "xi"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", 
                  RowBox[{"Hue", "@", "0.9"}]}], "}"}]}]}], "]"}]}], "}"}]}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics", "@", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Ry", ",", "Rx", ",", 
              RowBox[{"If", "[", 
               RowBox[{"cond2", ",", 
                RowBox[{"{", 
                 RowBox[{"Sy", ",", "Sx"}], "}"}], ",", 
                RowBox[{"{", "}"}]}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"cond2", ",", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"dir", "\[Equal]", "1"}], ",", "#", ",", 
                    RowBox[{"nR", "+", "nS", "+", "1", "-", "#"}]}], "]"}], 
                    ",", "18"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xR", "[", "#", "]"}], ",", 
                    RowBox[{"yR", "[", 
                    RowBox[{"#", "-", "1"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], "&"}], "/@", 
                 RowBox[{"Range", "@", "nR"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"dir", "\[Equal]", "1"}], ",", 
                    RowBox[{"nR", "+", "#"}], ",", 
                    RowBox[{"nS", "+", "1", "-", "#"}]}], "]"}], ",", "18"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xS", "[", "#", "]"}], ",", 
                    RowBox[{"yS", "[", 
                    RowBox[{"#", "-", "1"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], "&"}], "/@", 
                 RowBox[{"Range", "@", "nS"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"Text", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<R\>\"", ",", "18"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"xS", "[", 
                    RowBox[{"nS", "+", "1"}], "]"}], ",", 
                    RowBox[{"yS", "[", "nS", "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"Dashed", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", "#"}], "}"}]}], "}"}], "]"}], "&"}], "/@", 
                   RowBox[{"{", 
                    RowBox[{"zf", ",", "xd"}], "}"}]}], ",", "Sr"}], "}"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<B\>\""}], "]"}], ",", "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"xS", "[", 
                    RowBox[{"nS", "+", "1"}], "]"}], ",", "2"}], "]"}]}], 
                    "}"}]}], ",", "17", ",", 
                    RowBox[{"Hue", "@", "0.9"}], ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#", "<", "test"}], ",", "0", ",", "#"}], "]"}], 
                    ",", "0.05"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#", "<", "test"}], ",", 
                    RowBox[{"-", "1"}], ",", "0"}], "]"}], ",", "0"}], 
                    "}"}]}], "]"}], "/.", 
                   RowBox[{"test", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{"window", ",", "0.15", ",", "0.06"}], "]"}]}]}], 
                  "&"}], "@", 
                 RowBox[{"xS", "[", 
                  RowBox[{"nS", "+", "1"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<D\>\""}], "]"}], ",", "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"xR", "[", "0", "]"}], ",", "2"}], "]"}]}], 
                    "}"}]}], ",", "17", ",", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"1", ",", "0.4", ",", "0"}], "]"}], ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#", ">", "test"}], ",", "1", ",", "#"}], "]"}], 
                    ",", "0.05"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#", ">", "test"}], ",", "1", ",", "0"}], "]"}], 
                    ",", "0"}], "}"}]}], "]"}], "/.", 
                   RowBox[{"test", "\[Rule]", 
                    RowBox[{"If", "[", 
                    RowBox[{"window", ",", "0.86", ",", "0.94"}], "]"}]}]}], 
                  "&"}], "@", 
                 RowBox[{"xR", "[", "0", "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"Text", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<z\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<F\>\""}], "]"}], ",", "\"\< = \>\"", ",", "zf"}], 
                    "}"}]}], ",", "17", ",", "Blue", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"zf", ",", "0.15"}], "}"}]}], "]"}]}], 
               "\[IndentingNewLine]", "}"}]}], "]"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{"\"\<liquid mole fraction \>\"", ",", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}]}], "}"}]}], ",", 
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{"\"\<vapor mole fraction \>\"", ",", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}]}], "}"}]}]}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"17", ",", "Black"}], "}"}]}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
         RowBox[{"PlotRangePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0.02", ",", 
            RowBox[{"{", 
             RowBox[{"None", ",", "0.05"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"55", ",", "10"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"diagram", "=", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Thick", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"#", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"#", ",", "3"}], "}"}]}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], ",", 
             RowBox[{"Circle", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0.5", ",", "3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.5", ",", "0.15"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}], ",", 
             RowBox[{"Circle", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0.5", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.5", ",", "0.15"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Pi]", ",", 
                 RowBox[{"2", "*", "\[Pi]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", 
             RowBox[{"Arrowheads", "@", "0.07"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0.5", ",", 
                  RowBox[{"-", "0.15"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0.5", ",", 
                  RowBox[{"-", "0.5"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1.25", ",", 
                  RowBox[{"-", "0.5"}]}], "}"}]}], "}"}], "]"}], ",", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1.5", ",", 
                  RowBox[{"-", "0.35"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1.5", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Hue", "@", "0.9"}], ",", 
               RowBox[{"Arrow", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1.75", ",", 
                    RowBox[{"-", "0.5"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"3", ",", 
                    RowBox[{"-", "0.5"}]}], "}"}]}], "}"}], "]"}]}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0.5", ",", "3.15"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0.5", ",", "3.5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1.6", ",", "3.5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1.6", ",", "3.15"}], "}"}]}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"RGBColor", "[", 
                RowBox[{"1", ",", "0.4", ",", "0"}], "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1.6", ",", "2.85"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"1.6", ",", "2.7"}], "}"}]}], "}"}], "]"}], ",", 
               RowBox[{"Arrowheads", "@", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "0.07"}], ",", "0.07"}], "}"}]}], ",", 
               RowBox[{"Arrow", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1", ",", "2.7"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"3", ",", "2.7"}], "}"}]}], "}"}], "]"}]}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"yi", "<", 
                RowBox[{"equilb", "[", "xi", "]"}]}], ",", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Blue", ",", 
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.5"}], ",", 
                    FractionBox[
                    RowBox[{"3", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "nS"}], "+", "1"}], ")"}]}], 
                    RowBox[{"2", "*", "nT"}]]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    FractionBox[
                    RowBox[{"3", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "nS"}], "+", "1"}], ")"}]}], 
                    RowBox[{"2", "*", "nT"}]]}], "}"}]}], "}"}], "]"}]}], 
                  "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"dir", "\[Equal]", "1"}], ",", 
                    RowBox[{"nT", "-", "#"}], ",", "#"}], "]"}], ",", "17"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", 
                    RowBox[{"3", "*", 
                    RowBox[{"#", "/", "nT"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1.1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"3", "*", 
                    RowBox[{"#", "/", "nT"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"3", "*", 
                    RowBox[{"#", "/", "nT"}]}]}], "}"}]}], "}"}], "]"}]}], 
                    "}"}], "&"}], "/@", 
                  RowBox[{"Range", "@", 
                   RowBox[{"(", 
                    RowBox[{"nT", "-", "1"}], ")"}]}]}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"Blue", ",", 
                 RowBox[{"Arrow", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.5"}], ",", "1.5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1.5"}], "}"}]}], "}"}], "]"}]}], 
                "}"}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Arrowheads", "@", "0.05"}], ",", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1.1", ",", 
                  RowBox[{"-", "0.75"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1.9", ",", 
                  RowBox[{"-", "0.25"}]}], "}"}]}], "}"}], "]"}], ",", 
             RowBox[{"Arrow", "@", 
              RowBox[{"BezierCurve", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1.9", ",", "3.25"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1.6", ",", "2.9"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1.3", ",", "3.25"}], "}"}]}], "}"}]}]}]}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"EdgeForm", "@", "Thick"}], ",", 
               RowBox[{"FaceForm", "@", "None"}], ",", 
               RowBox[{"Disk", "[", 
                RowBox[{"#2", ",", 
                 RowBox[{"{", 
                  RowBox[{"0.26", ",", "0.15"}], "}"}]}], "]"}], ",", 
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"#1", ",", "17", ",", 
                   RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                 "#2"}], "]"}]}], "}"}], "&"}], "@@@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<R\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"1.5", ",", 
                  RowBox[{"-", "0.5"}]}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<C\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"1.6", ",", "3"}], "}"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Column", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<feed rate\>\"", ",", "\"\<1.00 kmol/h\>\"", ",", 
                   RowBox[{"Spacer", "@", "1"}], ",", 
                   RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<z\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<F\>\""}], "]"}], ",", "\"\< = \>\"", ",", "zf"}], 
                    "}"}]}], ",", 
                   RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<quality = \>\"", ",", "q"}], "}"}]}]}], 
                  "}"}], ",", "Center"}], "]"}], ",", "17", ",", "Blue"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.85"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"yi", "<", 
                  RowBox[{"equilb", "[", "xi", "]"}]}], ",", 
                 FractionBox[
                  RowBox[{"3", "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "nS"}], "+", "1"}], ")"}]}], 
                  RowBox[{"2", "*", "nT"}]], ",", "1.5"}], "]"}]}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.05"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Column", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<reflux ratio\>\"", ",", 
                   RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<L\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\</\>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<D\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"R", ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "2"}], "}"}]}], "]"}]}], "}"}]}]}], 
                  "}"}], ",", "Center"}], "]"}], ",", "17"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "2.05"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Column", "[", 
                RowBox[{
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<distillate flow\>\"", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"yi", "<", 
                    RowBox[{"equilb", "[", "xi", "]"}]}], ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"distflow", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}]}], "]"}], ",", 
                    "\"\< kmol/h\>\""}], "}"}]}], ",", "\"\<N/A\>\""}], 
                    "]"}]}], "}"}], ",", "Center"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<D\>\""}], "]"}], ",", "\"\< = \>\"", ",", 
                    RowBox[{"xR", "[", "0", "]"}]}], "}"}]}]}], 
                  "\[IndentingNewLine]", "}"}], ",", "Center", ",", 
                 RowBox[{"Spacings", "\[Rule]", "1"}]}], "]"}], ",", "17", 
               ",", 
               RowBox[{"RGBColor", "[", 
                RowBox[{"1", ",", "0.4", ",", "0"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"2.8", ",", "2.81"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Column", "[", 
                RowBox[{
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<bottoms flow\>\"", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"yi", "<", 
                    RowBox[{"equilb", "[", "xi", "]"}]}], ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"botflow", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}]}], "]"}], ",", 
                    "\"\< kmol/h\>\""}], "}"}]}], ",", "\"\<N/A\>\""}], 
                    "]"}]}], "}"}], ",", "Center"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<B\>\""}], "]"}], ",", "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"xS", "[", 
                    RowBox[{"nS", "+", "1"}], "]"}], ",", "2"}], "]"}]}], 
                    "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", "Center", 
                 ",", 
                 RowBox[{"Spacings", "\[Rule]", "1"}]}], "]"}], ",", "17", 
               ",", 
               RowBox[{"Hue", "@", "0.9"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"2.8", ",", 
               RowBox[{"-", "0.39"}]}], "}"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"285", ",", "400"}], "}"}]}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", "Full"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"mouse", "=", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Mouseover", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Thickness", "@", "0.02"}], ",", "Transparent", ",", 
                RowBox[{"Line", "@", 
                 RowBox[{"Table", "[", 
                  RowBox[{"#1", ",", 
                   RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"First", "@", "#2"}], ",", 
                    RowBox[{"Last", "@", "#2"}], ",", "0.05"}], "}"}]}], 
                  "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Framed", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{"#3", ",", "18", ",", "#4"}], "]"}], ",", 
                  RowBox[{"Background", "\[Rule]", "LightYellow"}]}], "]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"0.15", ",", "0.9"}], "}"}]}], "]"}]}], "]"}], "&"}],
            "@@@", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "x"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], ",", 
               RowBox[{"Row", "@", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                  "\"\< = \>\"", ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
                  "\"\< line\>\""}], "}"}]}], ",", 
               RowBox[{"RGBColor", "[", 
                RowBox[{"0", ",", "0.6", ",", "0"}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"equilb", "[", "x", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], ",", 
               "\"\<equilibrium curve\>\"", ",", "Red"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"feed", "[", "x", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{"cond1", ",", "xpinch", ",", "xi"}], "]"}], ",", 
                 "zf"}], "}"}], ",", 
               RowBox[{"Row", "@", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<q\>\"", ",", "Italic"}], "]"}], ",", 
                  "\"\<\[Hyphen]line\>\""}], "}"}]}], ",", "Blue"}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{"cond1", ",", 
                   RowBox[{"opertRect", "[", "x", "]"}], ",", 
                   RowBox[{"OpRect", "[", "x", "]"}]}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{"cond1", ",", "xpinch", ",", "xi"}], "]"}], ",", 
                 "xd"}], "}"}], ",", "\"\<rectifying section\>\"", ",", 
               RowBox[{"RGBColor", "[", 
                RowBox[{"1", ",", "0.4", ",", "0"}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{"cond1", ",", 
                   RowBox[{"opertStrp", "[", "x", "]"}], ",", 
                   RowBox[{"OpStrp", "[", "x", "]"}]}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"xb", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{"cond1", ",", "xpinch", ",", "xi"}], "]"}]}], "}"}],
                ",", "\"\<stripping section\>\"", ",", 
               RowBox[{"Hue", "@", "0.9"}]}], "}"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Mouseover", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Thickness", "@", "0.02"}], ",", "Transparent", ",", 
                "#1"}], "}"}], ",", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Framed", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{"#2", ",", "18"}], "]"}], ",", 
                  RowBox[{"Background", "\[Rule]", "LightYellow"}]}], "]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"0.15", ",", "0.9"}], "}"}]}], "]"}]}], "]"}], "&"}],
            "@@@", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Ry", ",", "Rx", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{"cond2", ",", 
                   RowBox[{"{", 
                    RowBox[{"Sy", ",", "Sx"}], "}"}], ",", 
                   RowBox[{"{", "}"}]}], "]"}]}], "}"}], ",", 
               "\"\<equilibrium stages\>\""}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"xS", "[", 
                    RowBox[{"nS", "+", "1"}], "]"}], ",", 
                    RowBox[{"yS", "[", "nS", "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"xS", "[", 
                    RowBox[{"nS", "+", "1"}], "]"}], ",", "0"}], "}"}]}], 
                 "}"}], "]"}], ",", "\"\<bottoms\>\""}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"xR", "[", "0", "]"}], ",", 
                    RowBox[{"yR", "[", "0", "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"xR", "[", "0", "]"}], ",", "0"}], "}"}]}], "}"}],
                 "]"}], ",", "\"\<distillate\>\""}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0.5", ",", "0.5"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0.5", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
               "\"\<feed\>\""}], "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
         "}"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
         "**", "**", "**", "**", "**", "**"}], "*****)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Grid", "@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Text", "@", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"yi", "<", 
                 RowBox[{"equilb", "[", "xi", "]"}]}], ",", 
                RowBox[{"Row", "@", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<equilibrium stages needed = \>\"", ",", "nT", ",", 
                   " ", "\"\< (including reboiler)\>\""}], "}"}]}], ",", 
                "\"\<equilibrium stages needed = infinite (pinch \
point)\>\""}], "]"}], ",", "17"}], "]"}]}], ",", "SpanFromLeft"}], "}"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", 
            RowBox[{"xybase", ",", 
             RowBox[{"If", "[", 
              RowBox[{"window", ",", 
               RowBox[{"{", "}"}], ",", "mouse"}], "]"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{"window", ",", "310", ",", "591"}], "]"}], ",", 
                "400"}], "}"}]}]}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{"window", ",", "diagram", ",", "Nothing"}], "]"}]}], 
          "}"}]}], "}"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "window", ",", "True", ",", 
              "\"\<view process flow diagram\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}], ",", 
         "SpanFromLeft", ",", "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"dir", ",", "1", ",", "\"\<    number stages\>\""}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "\[Rule]", "\"\< top to bottom \>\""}], ",", 
              RowBox[{"2", "\[Rule]", "\"\< bottom to top \>\""}]}], "}"}], 
            ",", "Setter"}], "}"}], "]"}], ",", "SpanFromLeft"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"R", ",", "3", ",", 
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{"\"\<external reflux ratio \>\"", ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<L\>\"", ",", "Italic"}], "]"}], ",", 
                 "\"\</\>\"", ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<D\>\"", ",", "Italic"}], "]"}]}], "}"}]}]}], 
             "}"}], ",", "0.25", ",", "10", ",", "0.25", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
          "]"}], ",", "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<mole fractions:\>\"", ",", "Bold"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xd", ",", "0.85", ",", 
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{"\"\<distillate \>\"", ",", 
                 RowBox[{"Subscript", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                   "\"\<D\>\""}], "]"}]}], "}"}]}]}], "}"}], ",", "0.8", ",", 
            "0.98", ",", "0.01", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}], ",", 
         "SpanFromLeft", ",", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xb", ",", "0.15", ",", 
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{"\"\<desired bottoms \>\"", ",", 
                 RowBox[{"Subscript", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                   "\"\<B\>\""}], "]"}]}], "}"}]}]}], "}"}], ",", "0.05", ",",
             "0.2", ",", "0.01", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}]}], 
        "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.696007435874181*^9, 3.696007526494836*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`dir$$ = 1, $CellContext`R$$ = 
    3, $CellContext`window$$ = True, $CellContext`xb$$ = 
    0.15, $CellContext`xd$$ = 0.85, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`window$$], True, "view process flow diagram"}, {
      True, False}}, {{
       Hold[$CellContext`dir$$], 1, "    number stages"}, {
      1 -> " top to bottom ", 2 -> " bottom to top "}}, {{
       Hold[$CellContext`R$$], 3, 
       Row[{"external reflux ratio ", 
         Style["L", Italic], "/", 
         Style["D", Italic]}]}, 0.25, 10, 0.25}, {{
       Hold[$CellContext`xd$$], 0.85, 
       Row[{"distillate ", 
         Subscript[
          Style["x", Italic], "D"]}]}, 0.8, 0.98, 0.01}, {{
       Hold[$CellContext`xb$$], 0.15, 
       Row[{"desired bottoms ", 
         Subscript[
          Style["x", Italic], "B"]}]}, 0.05, 0.2, 0.01}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], SpanFromLeft, 
          Manipulate`Place[2], SpanFromLeft}, {
          Manipulate`Place[3], SpanFromLeft}, {
          Style["mole fractions:", Bold], 
          Manipulate`Place[4], SpanFromLeft, 
          Manipulate`Place[5]}}, Alignment -> Left]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    603., {208.3544921875, 213.6455078125}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`window$330121$$ = False, $CellContext`dir$330122$$ = 
    False, $CellContext`R$330123$$ = 0, $CellContext`xd$330124$$ = 
    0, $CellContext`xb$330125$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`dir$$ = 1, $CellContext`R$$ = 
        3, $CellContext`window$$ = True, $CellContext`xb$$ = 
        0.15, $CellContext`xd$$ = 0.85}, "ControllerVariables" :> {
        Hold[$CellContext`window$$, $CellContext`window$330121$$, False], 
        Hold[$CellContext`dir$$, $CellContext`dir$330122$$, False], 
        Hold[$CellContext`R$$, $CellContext`R$330123$$, 0], 
        Hold[$CellContext`xd$$, $CellContext`xd$330124$$, 0], 
        Hold[$CellContext`xb$$, $CellContext`xb$330125$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`P$, $CellContext`Psat1$, $CellContext`Psat2$, \
$CellContext`A12$, $CellContext`A21$, $CellContext`\[Gamma]1$, $CellContext`\
\[Gamma]2$, $CellContext`equilb$, $CellContext`zf$, $CellContext`q$, \
$CellContext`feed$, $CellContext`xpinch$, $CellContext`ypinch$, \
$CellContext`opertRect$, $CellContext`opertStrp$, $CellContext`OpRect$, \
$CellContext`xi$, $CellContext`yi$, $CellContext`cond1$, $CellContext`cond2$, \
$CellContext`OpStrp$, $CellContext`i$, $CellContext`yR$, $CellContext`xR$, \
$CellContext`x1$, $CellContext`y1$, $CellContext`nR$, $CellContext`yS$, \
$CellContext`xS$, $CellContext`nS$, $CellContext`nT$, $CellContext`distflow$, \
$CellContext`botflow$, $CellContext`Ry$, $CellContext`Rx$, $CellContext`Sy$, \
$CellContext`Sx$, $CellContext`Sr$, $CellContext`xybase$, \
$CellContext`diagram$, $CellContext`mouse$}, $CellContext`P$ = 
         760; $CellContext`Psat1$[
           Pattern[$CellContext`temp, 
            Blank[]]] := 
         10^(8.08097 - 1582.271/(
           239.726 + $CellContext`temp)); $CellContext`Psat2$[
           Pattern[$CellContext`temp, 
            Blank[]]] := 
         10^(8.07131 - 1730.63/(
           233.426 + $CellContext`temp)); $CellContext`A12$ = 
         0.7923; $CellContext`A21$ = 0.5434; $CellContext`\[Gamma]1$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Exp[(1 - $CellContext`x$)^2 ($CellContext`A12$ + 
            2 ($CellContext`A21$ - $CellContext`A12$) $CellContext`x$)]; \
$CellContext`\[Gamma]2$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Exp[$CellContext`x$^2 ($CellContext`A21$ + 
            2 ($CellContext`A12$ - $CellContext`A21$) (
              1 - $CellContext`x$))]; $CellContext`equilb$ = Quiet[
           Interpolation[
            Map[{#, 
              ReplaceAll[$CellContext`y, 
               Quiet[
                
                FindRoot[{$CellContext`y == # $CellContext`\[Gamma]1$[#] \
$CellContext`Psat1$[$CellContext`temp]/$CellContext`P$, $CellContext`P$ == # \
$CellContext`\[Gamma]1$[#] $CellContext`Psat1$[$CellContext`temp] + (
                    1 - #) $CellContext`\[Gamma]2$[#] \
$CellContext`Psat2$[$CellContext`temp]}, {{$CellContext`y, 
                   0}, {$CellContext`temp, 60}}]]]}& , 
             Range[0, 1, 0.05]]]]; $CellContext`zf$ = 0.5; $CellContext`q$ = 
         0.5; $CellContext`feed$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         If[$CellContext`q$ != 
           1, ($CellContext`q$/($CellContext`q$ - 
             1)) $CellContext`x$ - $CellContext`zf$/($CellContext`q$ - 1), 
           1000000 ($CellContext`x$ - $CellContext`zf$) + $CellContext`zf$]; \
$CellContext`xpinch$ = ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`feed$[$CellContext`x] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
              0.5}]]]; $CellContext`ypinch$ = \
$CellContext`feed$[$CellContext`xpinch$]; $CellContext`opertRect$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`ypinch$ + (($CellContext`x$ - \
$CellContext`xpinch$)/($CellContext`xd$$ - $CellContext`xpinch$)) \
($CellContext`xd$$ - $CellContext`ypinch$); $CellContext`opertStrp$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`ypinch$ + (($CellContext`x$ - \
$CellContext`xpinch$)/($CellContext`xb$$ - $CellContext`xpinch$)) \
($CellContext`xb$$ - $CellContext`ypinch$); $CellContext`OpRect$[
           Pattern[$CellContext`x$, 
            Blank[]]] := ($CellContext`R$$/($CellContext`R$$ + 
            1)) $CellContext`x$ + $CellContext`xd$$/($CellContext`R$$ + 
           1); $CellContext`xi$ = ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`feed$[$CellContext`x] == \
$CellContext`OpRect$[$CellContext`x], {$CellContext`x, 
              0.7}]]]; $CellContext`yi$ = \
$CellContext`OpRect$[$CellContext`xi$]; $CellContext`cond1$ = \
$CellContext`yi$ >= $CellContext`equilb$[$CellContext`xi$]; \
$CellContext`cond2$ = $CellContext`yi$ < \
$CellContext`equilb$[$CellContext`xi$]; 
        If[$CellContext`cond1$, {$CellContext`OpStrp$[
              Pattern[$CellContext`x$, 
               
               Blank[]]] := $CellContext`opertStrp$[$CellContext`x$]; \
$CellContext`i$ = 
            0; $CellContext`yR$[0] = $CellContext`xd$$; $CellContext`xR$[
             0] = $CellContext`xd$$; 
           While[$CellContext`i$ < 
             25, {$CellContext`x1$ = ReplaceAll[$CellContext`x, 
                Quiet[
                 
                 FindRoot[$CellContext`yR$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
                   0.5}]]], $CellContext`y1$ = \
$CellContext`opertRect$[$CellContext`x1$], 
              
              If[$CellContext`x1$ > $CellContext`xpinch$, \
{$CellContext`xR$[$CellContext`i$ + 
                  1] = $CellContext`x1$, $CellContext`yR$[$CellContext`i$ + 
                  1] = $CellContext`y1$}], 
              
              Increment[$CellContext`i$]}]; $CellContext`nR$ = \
$CellContext`i$ - 1; $CellContext`i$ = 0; 
           If[$CellContext`nR$ >= 
             0, {$CellContext`yS$[
                0] = $CellContext`yR$[$CellContext`nR$]; $CellContext`xS$[
                0] = $CellContext`xR$[$CellContext`nR$]}]; 
           While[$CellContext`i$ < 
             20, {$CellContext`x1$ = ReplaceAll[$CellContext`x, 
                Quiet[
                 
                 FindRoot[$CellContext`yS$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
                   0.5}]]], $CellContext`y1$ = \
$CellContext`opertStrp$[$CellContext`x1$], $CellContext`xS$[$CellContext`i$ + 
                1] = $CellContext`x1$, $CellContext`yS$[$CellContext`i$ + 
                1] = $CellContext`y1$, 
              
              Increment[$CellContext`i$]}]; $CellContext`nS$ = \
$CellContext`i$ - 1; Null}, {$CellContext`OpStrp$[
              Pattern[$CellContext`x$, 
               
               Blank[]]] := $CellContext`yi$ + (($CellContext`x$ - \
$CellContext`xi$)/($CellContext`xb$$ - $CellContext`xi$)) ($CellContext`xb$$ - \
$CellContext`yi$); $CellContext`i$ = 
            0; $CellContext`yR$[0] = $CellContext`xd$$; $CellContext`xR$[
             0] = $CellContext`xd$$; 
           While[$CellContext`xR$[$CellContext`i$] > $CellContext`xi$, \
{$CellContext`x1$ = ReplaceAll[$CellContext`x, 
                Quiet[
                 
                 FindRoot[$CellContext`yR$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
                   0.7}]]], $CellContext`y1$ = \
$CellContext`OpRect$[$CellContext`x1$], 
              
              If[$CellContext`x1$ > $CellContext`xi$, \
{$CellContext`xR$[$CellContext`i$ + 
                  1] = $CellContext`x1$, $CellContext`yR$[$CellContext`i$ + 
                  1] = $CellContext`y1$}], 
              
              Increment[$CellContext`i$]}]; $CellContext`nR$ = \
$CellContext`i$ - 1; $CellContext`i$ = 0; 
           If[$CellContext`nR$ >= 
             0, $CellContext`yS$[
               0] = $CellContext`yR$[$CellContext`nR$]; $CellContext`xS$[
               0] = $CellContext`xR$[$CellContext`nR$]]; 
           While[$CellContext`xS$[$CellContext`i$] > $CellContext`xb$$, \
{$CellContext`x1$ = ReplaceAll[$CellContext`x, 
                Quiet[
                 
                 FindRoot[$CellContext`yS$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
                   0.5}]]], $CellContext`y1$ = \
$CellContext`OpStrp$[$CellContext`x1$], $CellContext`xS$[$CellContext`i$ + 
                1] = $CellContext`x1$, $CellContext`yS$[$CellContext`i$ + 
                1] = $CellContext`y1$, 
              
              Increment[$CellContext`i$]}]; $CellContext`nS$ = \
$CellContext`i$ - 1; 
           Null}]; $CellContext`nT$ = $CellContext`nR$ + $CellContext`nS$ + 
          1; $CellContext`distflow$ = ($CellContext`zf$ - \
$CellContext`xS$[$CellContext`nS$ + 
            1])/$CellContext`xd$$; $CellContext`botflow$ = 
         1 - $CellContext`distflow$; $CellContext`Ry$ = Map[Line[{{
              $CellContext`xR$[#], 
              $CellContext`yR$[# - 1]}, {
              $CellContext`xR$[#], 
              $CellContext`yR$[#]}}]& , 
           Range[$CellContext`nR$]]; $CellContext`Rx$ = Map[Line[{{
              $CellContext`xR$[#], 
              $CellContext`yR$[#]}, {
              $CellContext`xR$[# + 1], 
              $CellContext`yR$[#]}}]& , 
           If[$CellContext`nR$ >= 1, 
            Range[0, $CellContext`nR$ - 1], {0}]]; $CellContext`Sy$ = 
         Map[Line[{{
              $CellContext`xS$[# + 1], 
              $CellContext`yS$[#]}, {
              $CellContext`xS$[# + 1], 
              $CellContext`yS$[# + 1]}}]& , 
           Range[0, $CellContext`nS$ - 1]]; $CellContext`Sx$ = Map[Line[{{
              $CellContext`xS$[# - 1], 
              $CellContext`yS$[# - 1]}, {
              $CellContext`xS$[#], 
              $CellContext`yS$[# - 1]}}]& , 
           Range[$CellContext`nS$ + 1]]; $CellContext`Sr$ = Line[{{
             $CellContext`xS$[$CellContext`nS$ + 1], 
             $CellContext`yS$[$CellContext`nS$]}, {
             $CellContext`xS$[$CellContext`nS$ + 1], 
             0}}]; $CellContext`xybase$ = Show[
           Plot[{
             $CellContext`equilb$[$CellContext`x], $CellContext`x}, \
{$CellContext`x, 0, 1}, PlotStyle -> {{Thick, Red}, {Thick, 
               RGBColor[0, 0.6, 0]}}, PlotRange -> {{0, 1}, {0, 1}}], 
           If[$CellContext`cond1$, {
             Plot[
              $CellContext`feed$[$CellContext`x], {$CellContext`x, \
$CellContext`xpinch$, $CellContext`zf$}, PlotStyle -> {Thick, Blue}], 
             Plot[
              $CellContext`opertRect$[$CellContext`x], {$CellContext`x, \
$CellContext`xpinch$, $CellContext`xd$$}, PlotStyle -> {Thick, 
                RGBColor[1, 0.4, 0]}], 
             Plot[
              $CellContext`opertStrp$[$CellContext`x], {$CellContext`x, \
$CellContext`xb$$, $CellContext`xpinch$}, PlotStyle -> {Thick, 
                Hue[0.9]}]}, {
             Plot[
              $CellContext`feed$[$CellContext`x], {$CellContext`x, \
$CellContext`xi$, $CellContext`zf$}, PlotStyle -> {Thick, Blue}], 
             Plot[
              $CellContext`OpRect$[$CellContext`x], {$CellContext`x, \
$CellContext`xi$, $CellContext`xd$$}, PlotStyle -> {Thick, 
                RGBColor[1, 0.4, 0]}], 
             Plot[
              $CellContext`OpStrp$[$CellContext`x], {$CellContext`x, \
$CellContext`xb$$, $CellContext`xi$}, PlotStyle -> {Thick, 
                Hue[0.9]}]}], 
           Graphics[{{Thick, $CellContext`Ry$, $CellContext`Rx$, 
              
              If[$CellContext`cond2$, {$CellContext`Sy$, $CellContext`Sx$}, \
{}]}, 
             If[$CellContext`cond2$, {
               Map[Text[
                 Style[
                  
                  If[$CellContext`dir$$ == 
                   1, #, $CellContext`nR$ + $CellContext`nS$ + 1 - #], 18], {
                  $CellContext`xR$[#], 
                  $CellContext`yR$[# - 1]}, {1, -1}]& , 
                Range[$CellContext`nR$]], 
               Map[Text[
                 Style[
                  
                  If[$CellContext`dir$$ == 
                   1, $CellContext`nR$ + #, $CellContext`nS$ + 1 - #], 18], {
                  $CellContext`xS$[#], 
                  $CellContext`yS$[# - 1]}, {1, -1}]& , 
                Range[$CellContext`nS$]], 
               Text[
                Style["R", 18], {
                 $CellContext`xS$[$CellContext`nS$ + 1], 
                 $CellContext`yS$[$CellContext`nS$]}, {1, -1}], {Dashed, 
                Map[
                Line[{{#, 
                    0}, {#, #}}]& , {$CellContext`zf$, $CellContext`xd$$}], \
$CellContext`Sr$}, 
               (ReplaceAll[
                Text[
                 Style[
                  Row[{
                    Subscript[
                    Style["x", Italic], "B"], " = ", 
                    NumberForm[
                    $CellContext`xS$[$CellContext`nS$ + 1], 2]}], 17, 
                  Hue[0.9], Background -> White], {
                  If[# < $CellContext`test, 0, #], 0.05}, {
                  If[# < $CellContext`test, -1, 0], 0}], $CellContext`test -> 
                If[$CellContext`window$$, 0.15, 0.06]]& )[
                $CellContext`xS$[$CellContext`nS$ + 1]], 
               (ReplaceAll[
                Text[
                 Style[
                  Row[{
                    Subscript[
                    Style["x", Italic], "D"], " = ", 
                    NumberForm[
                    $CellContext`xR$[0], 2]}], 17, 
                  RGBColor[1, 0.4, 0], Background -> White], {
                  If[# > $CellContext`test, 1, #], 0.05}, {
                  If[# > $CellContext`test, 1, 0], 0}], $CellContext`test -> 
                If[$CellContext`window$$, 0.86, 0.94]]& )[
                $CellContext`xR$[0]], 
               Text[
                Style[
                 Row[{
                   Subscript[
                    Style["z", Italic], "F"], " = ", $CellContext`zf$}], 17, 
                 Blue, Background -> White], {$CellContext`zf$, 0.15}]}]}], 
           Frame -> True, FrameLabel -> {
             Row[{"liquid mole fraction ", 
               Style["x", Italic]}], 
             Row[{"vapor mole fraction ", 
               Style["y", Italic]}]}, LabelStyle -> {17, Black}, AspectRatio -> 
           Full, PlotRangePadding -> {0.02, {None, 0.05}}, 
           ImagePadding -> {{55, 10}, {50, 10}}]; $CellContext`diagram$ = 
         Graphics[{{Thick, 
             Map[Line[{{#, 0}, {#, 3}}]& , {0, 1}], 
             Circle[{0.5, 3}, {0.5, 0.15}, {0, Pi}], 
             Circle[{0.5, 0}, {0.5, 0.15}, {Pi, 2 Pi}]}, {Thick, 
             Arrowheads[0.07], 
             Arrow[{{0.5, -0.15}, {0.5, -0.5}, {1.25, -0.5}}], 
             Arrow[{{1.5, -0.35}, {1.5, 0}, {1, 0}}], {
              Hue[0.9], 
              Arrow[{{1.75, -0.5}, {3, -0.5}}]}, 
             Arrow[{{0.5, 3.15}, {0.5, 3.5}, {1.6, 3.5}, {1.6, 3.15}}], {
              RGBColor[1, 0.4, 0], 
              Line[{{1.6, 2.85}, {1.6, 2.7}}], 
              Arrowheads[{-0.07, 0.07}], 
              Arrow[{{1, 2.7}, {3, 2.7}}]}, 
             
             If[$CellContext`yi$ < $CellContext`equilb$[$CellContext`xi$], {{
               Blue, 
                
                Arrow[{{-1.5, 3 (2 $CellContext`nS$ + 1)/(
                   2 $CellContext`nT$)}, {
                  0, 3 (2 $CellContext`nS$ + 1)/(2 $CellContext`nT$)}}]}, 
               Map[{
                 Text[
                  Style[
                   If[$CellContext`dir$$ == 1, $CellContext`nT$ - #, #], 
                   17], {0.5, 3 (#/$CellContext`nT$)}, {0, -1.1}], 
                 
                 Line[{{0, 3 (#/$CellContext`nT$)}, {
                   1, 3 (#/$CellContext`nT$)}}]}& , 
                Range[$CellContext`nT$ - 1]]}, {Blue, 
               Arrow[{{-1.5, 1.5}, {0, 1.5}}]}]}, {
             Arrowheads[0.05], 
             Arrow[{{1.1, -0.75}, {1.9, -0.25}}], 
             Arrow[
              BezierCurve[{{1.9, 3.25}, {1.6, 2.9}, {1.3, 3.25}}]]}, 
            Apply[{
              EdgeForm[Thick], 
              FaceForm[None], 
              Disk[#2, {0.26, 0.15}], 
              Text[
               Style[#, 17, Background -> White], #2]}& , {{
              "R", {1.5, -0.5}}, {"C", {1.6, 3}}}, {1}], 
            Text[
             Style[
              Column[{"feed rate", "1.00 kmol/h", 
                Spacer[1], 
                Row[{
                  Subscript[
                   Style["z", Italic], "F"], " = ", $CellContext`zf$}], 
                Row[{"quality = ", $CellContext`q$}]}, Center], 17, 
              Blue], {-0.85, 
              
              If[$CellContext`yi$ < $CellContext`equilb$[$CellContext`xi$], 
               3 (2 $CellContext`nS$ + 1)/(2 $CellContext`nT$), 1.5]}, {
             0, 0.05}], 
            Text[
             Style[
              Column[{"reflux ratio", 
                Row[{
                  Style["L", Italic], "/", 
                  Style["D", Italic], " = ", 
                  NumberForm[$CellContext`R$$, {3, 2}]}]}, Center], 17], {
             2, 2.05}], 
            Text[
             Style[
              Column[{
                Column[{"distillate flow", 
                  
                  If[$CellContext`yi$ < \
$CellContext`equilb$[$CellContext`xi$], 
                   Row[{
                    NumberForm[$CellContext`distflow$, {2, 2}], " kmol/h"}], 
                   "N/A"]}, Center], 
                Row[{
                  Subscript[
                   Style["x", Italic], "D"], " = ", 
                  $CellContext`xR$[0]}]}, Center, Spacings -> 1], 17, 
              RGBColor[1, 0.4, 0]], {2.8, 2.81}], 
            Text[
             Style[
              Column[{
                Column[{"bottoms flow", 
                  
                  If[$CellContext`yi$ < \
$CellContext`equilb$[$CellContext`xi$], 
                   Row[{
                    NumberForm[$CellContext`botflow$, {2, 2}], " kmol/h"}], 
                   "N/A"]}, Center], 
                Row[{
                  Subscript[
                   Style["x", Italic], "B"], " = ", 
                  NumberForm[
                   $CellContext`xS$[$CellContext`nS$ + 1], 2]}]}, Center, 
               Spacings -> 1], 17, 
              Hue[0.9]], {2.8, -0.39}]}, ImageSize -> {285, 400}, AspectRatio -> 
           Full]; $CellContext`mouse$ = Graphics[{
            Apply[Mouseover[{
               Thickness[0.02], Transparent, 
               Line[
                Table[#, {$CellContext`x, 
                  First[#2], 
                  Last[#2], 0.05}]]}, 
              Text[
               Framed[
                Style[#3, 18, #4], Background -> LightYellow], {0.15, 
               0.9}]]& , {{{$CellContext`x, $CellContext`x}, {0, 1}, 
               Row[{
                 Style["x", Italic], " = ", 
                 Style["y", Italic], " line"}], 
               RGBColor[0, 0.6, 0]}, {{$CellContext`x, 
                $CellContext`equilb$[$CellContext`x]}, {0, 1}, 
               "equilibrium curve", Red}, {{$CellContext`x, 
                $CellContext`feed$[$CellContext`x]}, {
                
                If[$CellContext`cond1$, $CellContext`xpinch$, \
$CellContext`xi$], $CellContext`zf$}, 
               Row[{
                 Style["q", Italic], "\[Hyphen]line"}], 
               Blue}, {{$CellContext`x, 
                If[$CellContext`cond1$, 
                 $CellContext`opertRect$[$CellContext`x], 
                 $CellContext`OpRect$[$CellContext`x]]}, {
                
                If[$CellContext`cond1$, $CellContext`xpinch$, \
$CellContext`xi$], $CellContext`xd$$}, "rectifying section", 
               RGBColor[1, 0.4, 0]}, {{$CellContext`x, 
                If[$CellContext`cond1$, 
                 $CellContext`opertStrp$[$CellContext`x], 
                 $CellContext`OpStrp$[$CellContext`x]]}, {$CellContext`xb$$, 
                
                If[$CellContext`cond1$, $CellContext`xpinch$, \
$CellContext`xi$]}, "stripping section", 
               Hue[0.9]}}, {1}], 
            Apply[Mouseover[{
               Thickness[0.02], Transparent, #}, 
              Text[
               Framed[
                Style[#2, 18], Background -> LightYellow], {0.15, 
               0.9}]]& , {{{$CellContext`Ry$, $CellContext`Rx$, 
                
                If[$CellContext`cond2$, {$CellContext`Sy$, $CellContext`Sx$}, \
{}]}, "equilibrium stages"}, {
               Line[{{
                  $CellContext`xS$[$CellContext`nS$ + 1], 
                  $CellContext`yS$[$CellContext`nS$]}, {
                  $CellContext`xS$[$CellContext`nS$ + 1], 0}}], "bottoms"}, {
               Line[{{
                  $CellContext`xR$[0], 
                  $CellContext`yR$[0]}, {
                  $CellContext`xR$[0], 0}}], "distillate"}, {
               Line[{{0.5, 0.5}, {0.5, 0}}], "feed"}}, {1}]}]; Grid[{{
            Text[
             Style[
              If[$CellContext`yi$ < $CellContext`equilb$[$CellContext`xi$], 
               
               Row[{"equilibrium stages needed = ", $CellContext`nT$, 
                 " (including reboiler)"}], 
               "equilibrium stages needed = infinite (pinch point)"], 17]], 
            SpanFromLeft}, {
            Show[$CellContext`xybase$, 
             If[$CellContext`window$$, {}, $CellContext`mouse$], ImageSize -> {
               If[$CellContext`window$$, 310, 591], 400}], 
            If[$CellContext`window$$, $CellContext`diagram$, Nothing]}}]], 
      "Specifications" :> {{{$CellContext`window$$, True, 
          "view process flow diagram"}, {True, False}, ControlPlacement -> 
         1}, {{$CellContext`dir$$, 1, "    number stages"}, {
         1 -> " top to bottom ", 2 -> " bottom to top "}, ControlType -> 
         Setter, ControlPlacement -> 2}, {{$CellContext`R$$, 3, 
          Row[{"external reflux ratio ", 
            Style["L", Italic], "/", 
            Style["D", Italic]}]}, 0.25, 10, 0.25, Appearance -> "Labeled", 
         ControlPlacement -> 3}, {{$CellContext`xd$$, 0.85, 
          Row[{"distillate ", 
            Subscript[
             Style["x", Italic], "D"]}]}, 0.8, 0.98, 0.01, Appearance -> 
         "Labeled", ImageSize -> Small, ControlPlacement -> 
         4}, {{$CellContext`xb$$, 0.15, 
          Row[{"desired bottoms ", 
            Subscript[
             Style["x", Italic], "B"]}]}, 0.05, 0.2, 0.01, Appearance -> 
         "Labeled", ImageSize -> Small, ControlPlacement -> 5}, 
        Grid[{{
           Manipulate`Place[1], SpanFromLeft, 
           Manipulate`Place[2], SpanFromLeft}, {
           Manipulate`Place[3], SpanFromLeft}, {
           Style["mole fractions:", Bold], 
           Manipulate`Place[4], SpanFromLeft, 
           Manipulate`Place[5]}}, Alignment -> Left]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{646., {277., 282.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->1688993734]
}, {2}]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ManipulateCaptionSection"],

Cell[TextData[{
 "This Demonstration shows how to determine the number of equilibrium stages \
needed for a two-component (methanol/water) separation in a counter-current \
distillation column. It also shows the optimal location to feed the binary \
mixture into the column. Check \"view process flow diagram\" to show the ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]], "InlineMath"],
 "-",
 Cell[BoxData[
  FormBox["y", TraditionalForm]], "InlineMath"],
 " diagram on the left and the process flow diagram on the right. When that \
box is not checked, a larger ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]], "InlineMath"],
 "-",
 Cell[BoxData[
  FormBox["y", TraditionalForm]], "InlineMath"],
 " diagram is shown and you can move the cursor over the curves to see \
labels. The column feed has a methanol mole fraction of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["z", 
     StyleBox["F",
      FontSlant->"Plain"]], "=", "0.5"}], TraditionalForm]], "InlineMath"],
 " and a quality of 0.5. The condenser is a total condenser, so it is not \
considered an equilibrium stage. Set the external reflux ratio ",
 Cell[BoxData[
  FormBox[
   RowBox[{"L", "/", "D"}], TraditionalForm]], "InlineMath"],
 ", as well as the methanol mole fractions in the distillate ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    StyleBox["D",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " and bottoms ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    StyleBox["B",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " streams, with sliders. The number of stages is determined by stepping off \
stages starting at ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    StyleBox["D",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 "; the partial reboiler is an equilibrium stage. The number of equilibrium \
stages depends on the compositions of the exiting streams and the reflux \
ratio. The stages can be numbered with the first stage above the reboiler \
(bottom to top) or with the first stage at the condenser, use buttons to \
switch between these numbering options. Note that the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    StyleBox["B",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " determined by stepping off stages is often lower than the desired ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    StyleBox["B",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " because reaching the exact value of the desired ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    StyleBox["B",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " would require a partial stage, which is not possible."
}], "ManipulateCaption",
 CellChangeTimes->{3.696007538896509*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ThumbnailSection"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`dir$$ = 1, $CellContext`R$$ = 
    3, $CellContext`window$$ = True, $CellContext`xb$$ = 
    0.15, $CellContext`xd$$ = 0.85, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`window$$], True, "view process flow diagram"}, {
      True, False}}, {{
       Hold[$CellContext`dir$$], 1, "    number stages"}, {
      1 -> " top to bottom ", 2 -> " bottom to top "}}, {{
       Hold[$CellContext`R$$], 3, 
       Row[{"external reflux ratio ", 
         Style["L", Italic], "/", 
         Style["D", Italic]}]}, 0.25, 10, 0.25}, {{
       Hold[$CellContext`xd$$], 0.85, 
       Row[{"distillate ", 
         Subscript[
          Style["x", Italic], "D"]}]}, 0.8, 0.98, 0.01}, {{
       Hold[$CellContext`xb$$], 0.15, 
       Row[{"desired bottoms ", 
         Subscript[
          Style["x", Italic], "B"]}]}, 0.05, 0.2, 0.01}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], SpanFromLeft, 
          Manipulate`Place[2], SpanFromLeft}, {
          Manipulate`Place[3], SpanFromLeft}, {
          Style["mole fractions:", Bold], 
          Manipulate`Place[4], SpanFromLeft, 
          Manipulate`Place[5]}}, Alignment -> Left]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    603., {208.3544921875, 213.6455078125}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`window$330199$$ = False, $CellContext`dir$330200$$ = 
    False, $CellContext`R$330201$$ = 0, $CellContext`xd$330202$$ = 
    0, $CellContext`xb$330203$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`dir$$ = 1, $CellContext`R$$ = 
        3, $CellContext`window$$ = True, $CellContext`xb$$ = 
        0.15, $CellContext`xd$$ = 0.85}, "ControllerVariables" :> {
        Hold[$CellContext`window$$, $CellContext`window$330199$$, False], 
        Hold[$CellContext`dir$$, $CellContext`dir$330200$$, False], 
        Hold[$CellContext`R$$, $CellContext`R$330201$$, 0], 
        Hold[$CellContext`xd$$, $CellContext`xd$330202$$, 0], 
        Hold[$CellContext`xb$$, $CellContext`xb$330203$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`P$, $CellContext`Psat1$, $CellContext`Psat2$, \
$CellContext`A12$, $CellContext`A21$, $CellContext`\[Gamma]1$, $CellContext`\
\[Gamma]2$, $CellContext`equilb$, $CellContext`zf$, $CellContext`q$, \
$CellContext`feed$, $CellContext`xpinch$, $CellContext`ypinch$, \
$CellContext`opertRect$, $CellContext`opertStrp$, $CellContext`OpRect$, \
$CellContext`xi$, $CellContext`yi$, $CellContext`cond1$, $CellContext`cond2$, \
$CellContext`OpStrp$, $CellContext`i$, $CellContext`yR$, $CellContext`xR$, \
$CellContext`x1$, $CellContext`y1$, $CellContext`nR$, $CellContext`yS$, \
$CellContext`xS$, $CellContext`nS$, $CellContext`nT$, $CellContext`distflow$, \
$CellContext`botflow$, $CellContext`Ry$, $CellContext`Rx$, $CellContext`Sy$, \
$CellContext`Sx$, $CellContext`Sr$, $CellContext`xybase$, \
$CellContext`diagram$, $CellContext`mouse$}, $CellContext`P$ = 
         760; $CellContext`Psat1$[
           Pattern[$CellContext`temp, 
            Blank[]]] := 
         10^(8.08097 - 1582.271/(
           239.726 + $CellContext`temp)); $CellContext`Psat2$[
           Pattern[$CellContext`temp, 
            Blank[]]] := 
         10^(8.07131 - 1730.63/(
           233.426 + $CellContext`temp)); $CellContext`A12$ = 
         0.7923; $CellContext`A21$ = 0.5434; $CellContext`\[Gamma]1$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Exp[(1 - $CellContext`x$)^2 ($CellContext`A12$ + 
            2 ($CellContext`A21$ - $CellContext`A12$) $CellContext`x$)]; \
$CellContext`\[Gamma]2$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Exp[$CellContext`x$^2 ($CellContext`A21$ + 
            2 ($CellContext`A12$ - $CellContext`A21$) (
              1 - $CellContext`x$))]; $CellContext`equilb$ = Quiet[
           Interpolation[
            Map[{#, 
              ReplaceAll[$CellContext`y, 
               Quiet[
                
                FindRoot[{$CellContext`y == # $CellContext`\[Gamma]1$[#] \
$CellContext`Psat1$[$CellContext`temp]/$CellContext`P$, $CellContext`P$ == # \
$CellContext`\[Gamma]1$[#] $CellContext`Psat1$[$CellContext`temp] + (
                    1 - #) $CellContext`\[Gamma]2$[#] \
$CellContext`Psat2$[$CellContext`temp]}, {{$CellContext`y, 
                   0}, {$CellContext`temp, 60}}]]]}& , 
             Range[0, 1, 0.05]]]]; $CellContext`zf$ = 0.5; $CellContext`q$ = 
         0.5; $CellContext`feed$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         If[$CellContext`q$ != 
           1, ($CellContext`q$/($CellContext`q$ - 
             1)) $CellContext`x$ - $CellContext`zf$/($CellContext`q$ - 1), 
           1000000 ($CellContext`x$ - $CellContext`zf$) + $CellContext`zf$]; \
$CellContext`xpinch$ = ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`feed$[$CellContext`x] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
              0.5}]]]; $CellContext`ypinch$ = \
$CellContext`feed$[$CellContext`xpinch$]; $CellContext`opertRect$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`ypinch$ + (($CellContext`x$ - \
$CellContext`xpinch$)/($CellContext`xd$$ - $CellContext`xpinch$)) \
($CellContext`xd$$ - $CellContext`ypinch$); $CellContext`opertStrp$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`ypinch$ + (($CellContext`x$ - \
$CellContext`xpinch$)/($CellContext`xb$$ - $CellContext`xpinch$)) \
($CellContext`xb$$ - $CellContext`ypinch$); $CellContext`OpRect$[
           Pattern[$CellContext`x$, 
            Blank[]]] := ($CellContext`R$$/($CellContext`R$$ + 
            1)) $CellContext`x$ + $CellContext`xd$$/($CellContext`R$$ + 
           1); $CellContext`xi$ = ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`feed$[$CellContext`x] == \
$CellContext`OpRect$[$CellContext`x], {$CellContext`x, 
              0.7}]]]; $CellContext`yi$ = \
$CellContext`OpRect$[$CellContext`xi$]; $CellContext`cond1$ = \
$CellContext`yi$ >= $CellContext`equilb$[$CellContext`xi$]; \
$CellContext`cond2$ = $CellContext`yi$ < \
$CellContext`equilb$[$CellContext`xi$]; 
        If[$CellContext`cond1$, {$CellContext`OpStrp$[
              Pattern[$CellContext`x$, 
               
               Blank[]]] := $CellContext`opertStrp$[$CellContext`x$]; \
$CellContext`i$ = 
            0; $CellContext`yR$[0] = $CellContext`xd$$; $CellContext`xR$[
             0] = $CellContext`xd$$; 
           While[$CellContext`i$ < 
             25, {$CellContext`x1$ = ReplaceAll[$CellContext`x, 
                Quiet[
                 
                 FindRoot[$CellContext`yR$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
                   0.5}]]], $CellContext`y1$ = \
$CellContext`opertRect$[$CellContext`x1$], 
              
              If[$CellContext`x1$ > $CellContext`xpinch$, \
{$CellContext`xR$[$CellContext`i$ + 
                  1] = $CellContext`x1$, $CellContext`yR$[$CellContext`i$ + 
                  1] = $CellContext`y1$}], 
              
              Increment[$CellContext`i$]}]; $CellContext`nR$ = \
$CellContext`i$ - 1; $CellContext`i$ = 0; 
           If[$CellContext`nR$ >= 
             0, {$CellContext`yS$[
                0] = $CellContext`yR$[$CellContext`nR$]; $CellContext`xS$[
                0] = $CellContext`xR$[$CellContext`nR$]}]; 
           While[$CellContext`i$ < 
             20, {$CellContext`x1$ = ReplaceAll[$CellContext`x, 
                Quiet[
                 
                 FindRoot[$CellContext`yS$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
                   0.5}]]], $CellContext`y1$ = \
$CellContext`opertStrp$[$CellContext`x1$], $CellContext`xS$[$CellContext`i$ + 
                1] = $CellContext`x1$, $CellContext`yS$[$CellContext`i$ + 
                1] = $CellContext`y1$, 
              
              Increment[$CellContext`i$]}]; $CellContext`nS$ = \
$CellContext`i$ - 1; Null}, {$CellContext`OpStrp$[
              Pattern[$CellContext`x$, 
               
               Blank[]]] := $CellContext`yi$ + (($CellContext`x$ - \
$CellContext`xi$)/($CellContext`xb$$ - $CellContext`xi$)) ($CellContext`xb$$ - \
$CellContext`yi$); $CellContext`i$ = 
            0; $CellContext`yR$[0] = $CellContext`xd$$; $CellContext`xR$[
             0] = $CellContext`xd$$; 
           While[$CellContext`xR$[$CellContext`i$] > $CellContext`xi$, \
{$CellContext`x1$ = ReplaceAll[$CellContext`x, 
                Quiet[
                 
                 FindRoot[$CellContext`yR$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
                   0.7}]]], $CellContext`y1$ = \
$CellContext`OpRect$[$CellContext`x1$], 
              
              If[$CellContext`x1$ > $CellContext`xi$, \
{$CellContext`xR$[$CellContext`i$ + 
                  1] = $CellContext`x1$, $CellContext`yR$[$CellContext`i$ + 
                  1] = $CellContext`y1$}], 
              
              Increment[$CellContext`i$]}]; $CellContext`nR$ = \
$CellContext`i$ - 1; $CellContext`i$ = 0; 
           If[$CellContext`nR$ >= 
             0, $CellContext`yS$[
               0] = $CellContext`yR$[$CellContext`nR$]; $CellContext`xS$[
               0] = $CellContext`xR$[$CellContext`nR$]]; 
           While[$CellContext`xS$[$CellContext`i$] > $CellContext`xb$$, \
{$CellContext`x1$ = ReplaceAll[$CellContext`x, 
                Quiet[
                 
                 FindRoot[$CellContext`yS$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
                   0.5}]]], $CellContext`y1$ = \
$CellContext`OpStrp$[$CellContext`x1$], $CellContext`xS$[$CellContext`i$ + 
                1] = $CellContext`x1$, $CellContext`yS$[$CellContext`i$ + 
                1] = $CellContext`y1$, 
              
              Increment[$CellContext`i$]}]; $CellContext`nS$ = \
$CellContext`i$ - 1; 
           Null}]; $CellContext`nT$ = $CellContext`nR$ + $CellContext`nS$ + 
          1; $CellContext`distflow$ = ($CellContext`zf$ - \
$CellContext`xS$[$CellContext`nS$ + 
            1])/$CellContext`xd$$; $CellContext`botflow$ = 
         1 - $CellContext`distflow$; $CellContext`Ry$ = Map[Line[{{
              $CellContext`xR$[#], 
              $CellContext`yR$[# - 1]}, {
              $CellContext`xR$[#], 
              $CellContext`yR$[#]}}]& , 
           Range[$CellContext`nR$]]; $CellContext`Rx$ = Map[Line[{{
              $CellContext`xR$[#], 
              $CellContext`yR$[#]}, {
              $CellContext`xR$[# + 1], 
              $CellContext`yR$[#]}}]& , 
           If[$CellContext`nR$ >= 1, 
            Range[0, $CellContext`nR$ - 1], {0}]]; $CellContext`Sy$ = 
         Map[Line[{{
              $CellContext`xS$[# + 1], 
              $CellContext`yS$[#]}, {
              $CellContext`xS$[# + 1], 
              $CellContext`yS$[# + 1]}}]& , 
           Range[0, $CellContext`nS$ - 1]]; $CellContext`Sx$ = Map[Line[{{
              $CellContext`xS$[# - 1], 
              $CellContext`yS$[# - 1]}, {
              $CellContext`xS$[#], 
              $CellContext`yS$[# - 1]}}]& , 
           Range[$CellContext`nS$ + 1]]; $CellContext`Sr$ = Line[{{
             $CellContext`xS$[$CellContext`nS$ + 1], 
             $CellContext`yS$[$CellContext`nS$]}, {
             $CellContext`xS$[$CellContext`nS$ + 1], 
             0}}]; $CellContext`xybase$ = Show[
           Plot[{
             $CellContext`equilb$[$CellContext`x], $CellContext`x}, \
{$CellContext`x, 0, 1}, PlotStyle -> {{Thick, Red}, {Thick, 
               RGBColor[0, 0.6, 0]}}, PlotRange -> {{0, 1}, {0, 1}}], 
           If[$CellContext`cond1$, {
             Plot[
              $CellContext`feed$[$CellContext`x], {$CellContext`x, \
$CellContext`xpinch$, $CellContext`zf$}, PlotStyle -> {Thick, Blue}], 
             Plot[
              $CellContext`opertRect$[$CellContext`x], {$CellContext`x, \
$CellContext`xpinch$, $CellContext`xd$$}, PlotStyle -> {Thick, 
                RGBColor[1, 0.4, 0]}], 
             Plot[
              $CellContext`opertStrp$[$CellContext`x], {$CellContext`x, \
$CellContext`xb$$, $CellContext`xpinch$}, PlotStyle -> {Thick, 
                Hue[0.9]}]}, {
             Plot[
              $CellContext`feed$[$CellContext`x], {$CellContext`x, \
$CellContext`xi$, $CellContext`zf$}, PlotStyle -> {Thick, Blue}], 
             Plot[
              $CellContext`OpRect$[$CellContext`x], {$CellContext`x, \
$CellContext`xi$, $CellContext`xd$$}, PlotStyle -> {Thick, 
                RGBColor[1, 0.4, 0]}], 
             Plot[
              $CellContext`OpStrp$[$CellContext`x], {$CellContext`x, \
$CellContext`xb$$, $CellContext`xi$}, PlotStyle -> {Thick, 
                Hue[0.9]}]}], 
           Graphics[{{Thick, $CellContext`Ry$, $CellContext`Rx$, 
              
              If[$CellContext`cond2$, {$CellContext`Sy$, $CellContext`Sx$}, \
{}]}, 
             If[$CellContext`cond2$, {
               Map[Text[
                 Style[
                  
                  If[$CellContext`dir$$ == 
                   1, #, $CellContext`nR$ + $CellContext`nS$ + 1 - #], 18], {
                  $CellContext`xR$[#], 
                  $CellContext`yR$[# - 1]}, {1, -1}]& , 
                Range[$CellContext`nR$]], 
               Map[Text[
                 Style[
                  
                  If[$CellContext`dir$$ == 
                   1, $CellContext`nR$ + #, $CellContext`nS$ + 1 - #], 18], {
                  $CellContext`xS$[#], 
                  $CellContext`yS$[# - 1]}, {1, -1}]& , 
                Range[$CellContext`nS$]], 
               Text[
                Style["R", 18], {
                 $CellContext`xS$[$CellContext`nS$ + 1], 
                 $CellContext`yS$[$CellContext`nS$]}, {1, -1}], {Dashed, 
                Map[
                Line[{{#, 
                    0}, {#, #}}]& , {$CellContext`zf$, $CellContext`xd$$}], \
$CellContext`Sr$}, 
               (ReplaceAll[
                Text[
                 Style[
                  Row[{
                    Subscript[
                    Style["x", Italic], "B"], " = ", 
                    NumberForm[
                    $CellContext`xS$[$CellContext`nS$ + 1], 2]}], 17, 
                  Hue[0.9], Background -> White], {
                  If[# < $CellContext`test, 0, #], 0.05}, {
                  If[# < $CellContext`test, -1, 0], 0}], $CellContext`test -> 
                If[$CellContext`window$$, 0.15, 0.06]]& )[
                $CellContext`xS$[$CellContext`nS$ + 1]], 
               (ReplaceAll[
                Text[
                 Style[
                  Row[{
                    Subscript[
                    Style["x", Italic], "D"], " = ", 
                    NumberForm[
                    $CellContext`xR$[0], 2]}], 17, 
                  RGBColor[1, 0.4, 0], Background -> White], {
                  If[# > $CellContext`test, 1, #], 0.05}, {
                  If[# > $CellContext`test, 1, 0], 0}], $CellContext`test -> 
                If[$CellContext`window$$, 0.86, 0.94]]& )[
                $CellContext`xR$[0]], 
               Text[
                Style[
                 Row[{
                   Subscript[
                    Style["z", Italic], "F"], " = ", $CellContext`zf$}], 17, 
                 Blue, Background -> White], {$CellContext`zf$, 0.15}]}]}], 
           Frame -> True, FrameLabel -> {
             Row[{"liquid mole fraction ", 
               Style["x", Italic]}], 
             Row[{"vapor mole fraction ", 
               Style["y", Italic]}]}, LabelStyle -> {17, Black}, AspectRatio -> 
           Full, PlotRangePadding -> {0.02, {None, 0.05}}, 
           ImagePadding -> {{55, 10}, {50, 10}}]; $CellContext`diagram$ = 
         Graphics[{{Thick, 
             Map[Line[{{#, 0}, {#, 3}}]& , {0, 1}], 
             Circle[{0.5, 3}, {0.5, 0.15}, {0, Pi}], 
             Circle[{0.5, 0}, {0.5, 0.15}, {Pi, 2 Pi}]}, {Thick, 
             Arrowheads[0.07], 
             Arrow[{{0.5, -0.15}, {0.5, -0.5}, {1.25, -0.5}}], 
             Arrow[{{1.5, -0.35}, {1.5, 0}, {1, 0}}], {
              Hue[0.9], 
              Arrow[{{1.75, -0.5}, {3, -0.5}}]}, 
             Arrow[{{0.5, 3.15}, {0.5, 3.5}, {1.6, 3.5}, {1.6, 3.15}}], {
              RGBColor[1, 0.4, 0], 
              Line[{{1.6, 2.85}, {1.6, 2.7}}], 
              Arrowheads[{-0.07, 0.07}], 
              Arrow[{{1, 2.7}, {3, 2.7}}]}, 
             
             If[$CellContext`yi$ < $CellContext`equilb$[$CellContext`xi$], {{
               Blue, 
                
                Arrow[{{-1.5, 3 (2 $CellContext`nS$ + 1)/(
                   2 $CellContext`nT$)}, {
                  0, 3 (2 $CellContext`nS$ + 1)/(2 $CellContext`nT$)}}]}, 
               Map[{
                 Text[
                  Style[
                   If[$CellContext`dir$$ == 1, $CellContext`nT$ - #, #], 
                   17], {0.5, 3 (#/$CellContext`nT$)}, {0, -1.1}], 
                 
                 Line[{{0, 3 (#/$CellContext`nT$)}, {
                   1, 3 (#/$CellContext`nT$)}}]}& , 
                Range[$CellContext`nT$ - 1]]}, {Blue, 
               Arrow[{{-1.5, 1.5}, {0, 1.5}}]}]}, {
             Arrowheads[0.05], 
             Arrow[{{1.1, -0.75}, {1.9, -0.25}}], 
             Arrow[
              BezierCurve[{{1.9, 3.25}, {1.6, 2.9}, {1.3, 3.25}}]]}, 
            Apply[{
              EdgeForm[Thick], 
              FaceForm[None], 
              Disk[#2, {0.26, 0.15}], 
              Text[
               Style[#, 17, Background -> White], #2]}& , {{
              "R", {1.5, -0.5}}, {"C", {1.6, 3}}}, {1}], 
            Text[
             Style[
              Column[{"feed rate", "1.00 kmol/h", 
                Spacer[1], 
                Row[{
                  Subscript[
                   Style["z", Italic], "F"], " = ", $CellContext`zf$}], 
                Row[{"quality = ", $CellContext`q$}]}, Center], 17, 
              Blue], {-0.85, 
              
              If[$CellContext`yi$ < $CellContext`equilb$[$CellContext`xi$], 
               3 (2 $CellContext`nS$ + 1)/(2 $CellContext`nT$), 1.5]}, {
             0, 0.05}], 
            Text[
             Style[
              Column[{"reflux ratio", 
                Row[{
                  Style["L", Italic], "/", 
                  Style["D", Italic], " = ", 
                  NumberForm[$CellContext`R$$, {3, 2}]}]}, Center], 17], {
             2, 2.05}], 
            Text[
             Style[
              Column[{
                Column[{"distillate flow", 
                  
                  If[$CellContext`yi$ < \
$CellContext`equilb$[$CellContext`xi$], 
                   Row[{
                    NumberForm[$CellContext`distflow$, {2, 2}], " kmol/h"}], 
                   "N/A"]}, Center], 
                Row[{
                  Subscript[
                   Style["x", Italic], "D"], " = ", 
                  $CellContext`xR$[0]}]}, Center, Spacings -> 1], 17, 
              RGBColor[1, 0.4, 0]], {2.8, 2.81}], 
            Text[
             Style[
              Column[{
                Column[{"bottoms flow", 
                  
                  If[$CellContext`yi$ < \
$CellContext`equilb$[$CellContext`xi$], 
                   Row[{
                    NumberForm[$CellContext`botflow$, {2, 2}], " kmol/h"}], 
                   "N/A"]}, Center], 
                Row[{
                  Subscript[
                   Style["x", Italic], "B"], " = ", 
                  NumberForm[
                   $CellContext`xS$[$CellContext`nS$ + 1], 2]}]}, Center, 
               Spacings -> 1], 17, 
              Hue[0.9]], {2.8, -0.39}]}, ImageSize -> {285, 400}, AspectRatio -> 
           Full]; $CellContext`mouse$ = Graphics[{
            Apply[Mouseover[{
               Thickness[0.02], Transparent, 
               Line[
                Table[#, {$CellContext`x, 
                  First[#2], 
                  Last[#2], 0.05}]]}, 
              Text[
               Framed[
                Style[#3, 18, #4], Background -> LightYellow], {0.15, 
               0.9}]]& , {{{$CellContext`x, $CellContext`x}, {0, 1}, 
               Row[{
                 Style["x", Italic], " = ", 
                 Style["y", Italic], " line"}], 
               RGBColor[0, 0.6, 0]}, {{$CellContext`x, 
                $CellContext`equilb$[$CellContext`x]}, {0, 1}, 
               "equilibrium curve", Red}, {{$CellContext`x, 
                $CellContext`feed$[$CellContext`x]}, {
                
                If[$CellContext`cond1$, $CellContext`xpinch$, \
$CellContext`xi$], $CellContext`zf$}, 
               Row[{
                 Style["q", Italic], "\[Hyphen]line"}], 
               Blue}, {{$CellContext`x, 
                If[$CellContext`cond1$, 
                 $CellContext`opertRect$[$CellContext`x], 
                 $CellContext`OpRect$[$CellContext`x]]}, {
                
                If[$CellContext`cond1$, $CellContext`xpinch$, \
$CellContext`xi$], $CellContext`xd$$}, "rectifying section", 
               RGBColor[1, 0.4, 0]}, {{$CellContext`x, 
                If[$CellContext`cond1$, 
                 $CellContext`opertStrp$[$CellContext`x], 
                 $CellContext`OpStrp$[$CellContext`x]]}, {$CellContext`xb$$, 
                
                If[$CellContext`cond1$, $CellContext`xpinch$, \
$CellContext`xi$]}, "stripping section", 
               Hue[0.9]}}, {1}], 
            Apply[Mouseover[{
               Thickness[0.02], Transparent, #}, 
              Text[
               Framed[
                Style[#2, 18], Background -> LightYellow], {0.15, 
               0.9}]]& , {{{$CellContext`Ry$, $CellContext`Rx$, 
                
                If[$CellContext`cond2$, {$CellContext`Sy$, $CellContext`Sx$}, \
{}]}, "equilibrium stages"}, {
               Line[{{
                  $CellContext`xS$[$CellContext`nS$ + 1], 
                  $CellContext`yS$[$CellContext`nS$]}, {
                  $CellContext`xS$[$CellContext`nS$ + 1], 0}}], "bottoms"}, {
               Line[{{
                  $CellContext`xR$[0], 
                  $CellContext`yR$[0]}, {
                  $CellContext`xR$[0], 0}}], "distillate"}, {
               Line[{{0.5, 0.5}, {0.5, 0}}], "feed"}}, {1}]}]; Grid[{{
            Text[
             Style[
              If[$CellContext`yi$ < $CellContext`equilb$[$CellContext`xi$], 
               
               Row[{"equilibrium stages needed = ", $CellContext`nT$, 
                 " (including reboiler)"}], 
               "equilibrium stages needed = infinite (pinch point)"], 17]], 
            SpanFromLeft}, {
            Show[$CellContext`xybase$, 
             If[$CellContext`window$$, {}, $CellContext`mouse$], ImageSize -> {
               If[$CellContext`window$$, 310, 591], 400}], 
            If[$CellContext`window$$, $CellContext`diagram$, Nothing]}}]], 
      "Specifications" :> {{{$CellContext`window$$, True, 
          "view process flow diagram"}, {True, False}, ControlPlacement -> 
         1}, {{$CellContext`dir$$, 1, "    number stages"}, {
         1 -> " top to bottom ", 2 -> " bottom to top "}, ControlType -> 
         Setter, ControlPlacement -> 2}, {{$CellContext`R$$, 3, 
          Row[{"external reflux ratio ", 
            Style["L", Italic], "/", 
            Style["D", Italic]}]}, 0.25, 10, 0.25, Appearance -> "Labeled", 
         ControlPlacement -> 3}, {{$CellContext`xd$$, 0.85, 
          Row[{"distillate ", 
            Subscript[
             Style["x", Italic], "D"]}]}, 0.8, 0.98, 0.01, Appearance -> 
         "Labeled", ImageSize -> Small, ControlPlacement -> 
         4}, {{$CellContext`xb$$, 0.15, 
          Row[{"desired bottoms ", 
            Subscript[
             Style["x", Italic], "B"]}]}, 0.05, 0.2, 0.01, Appearance -> 
         "Labeled", ImageSize -> Small, ControlPlacement -> 5}, 
        Grid[{{
           Manipulate`Place[1], SpanFromLeft, 
           Manipulate`Place[2], SpanFromLeft}, {
           Manipulate`Place[3], SpanFromLeft}, {
           Style["mole fractions:", Bold], 
           Manipulate`Place[4], SpanFromLeft, 
           Manipulate`Place[5]}}, Alignment -> Left]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{646., {277., 282.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->1478841292]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SnapshotsSection"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`dir$$ = 2, $CellContext`R$$ = 
    3, $CellContext`window$$ = False, $CellContext`xb$$ = 
    0.07, $CellContext`xd$$ = 0.9400000000000001, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`window$$], False, "view process flow diagram"}, {
      True, False}}, {{
       Hold[$CellContext`dir$$], 2, "    number stages"}, {
      1 -> " top to bottom ", 2 -> " bottom to top "}}, {{
       Hold[$CellContext`R$$], 3, 
       Row[{"external reflux ratio ", 
         Style["L", Italic], "/", 
         Style["D", Italic]}]}, 0.25, 10, 0.25}, {{
       Hold[$CellContext`xd$$], 0.9400000000000001, 
       Row[{"distillate ", 
         Subscript[
          Style["x", Italic], "D"]}]}, 0.8, 0.98, 0.01}, {{
       Hold[$CellContext`xb$$], 0.07, 
       Row[{"desired bottoms ", 
         Subscript[
          Style["x", Italic], "B"]}]}, 0.05, 0.2, 0.01}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], SpanFromLeft, 
          Manipulate`Place[2], SpanFromLeft}, {
          Manipulate`Place[3], SpanFromLeft}, {
          Style["mole fractions:", Bold], 
          Manipulate`Place[4], SpanFromLeft, 
          Manipulate`Place[5]}}, Alignment -> Left]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    603., {208.3544921875, 213.6455078125}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`window$330275$$ = False, $CellContext`dir$330276$$ = 
    False, $CellContext`R$330277$$ = 0, $CellContext`xd$330278$$ = 
    0, $CellContext`xb$330279$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`dir$$ = 2, $CellContext`R$$ = 
        3, $CellContext`window$$ = False, $CellContext`xb$$ = 
        0.07, $CellContext`xd$$ = 0.9400000000000001}, "ControllerVariables" :> {
        Hold[$CellContext`window$$, $CellContext`window$330275$$, False], 
        Hold[$CellContext`dir$$, $CellContext`dir$330276$$, False], 
        Hold[$CellContext`R$$, $CellContext`R$330277$$, 0], 
        Hold[$CellContext`xd$$, $CellContext`xd$330278$$, 0], 
        Hold[$CellContext`xb$$, $CellContext`xb$330279$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`P$, $CellContext`Psat1$, $CellContext`Psat2$, \
$CellContext`A12$, $CellContext`A21$, $CellContext`\[Gamma]1$, $CellContext`\
\[Gamma]2$, $CellContext`equilb$, $CellContext`zf$, $CellContext`q$, \
$CellContext`feed$, $CellContext`xpinch$, $CellContext`ypinch$, \
$CellContext`opertRect$, $CellContext`opertStrp$, $CellContext`OpRect$, \
$CellContext`xi$, $CellContext`yi$, $CellContext`cond1$, $CellContext`cond2$, \
$CellContext`OpStrp$, $CellContext`i$, $CellContext`yR$, $CellContext`xR$, \
$CellContext`x1$, $CellContext`y1$, $CellContext`nR$, $CellContext`yS$, \
$CellContext`xS$, $CellContext`nS$, $CellContext`nT$, $CellContext`distflow$, \
$CellContext`botflow$, $CellContext`Ry$, $CellContext`Rx$, $CellContext`Sy$, \
$CellContext`Sx$, $CellContext`Sr$, $CellContext`xybase$, \
$CellContext`diagram$, $CellContext`mouse$}, $CellContext`P$ = 
         760; $CellContext`Psat1$[
           Pattern[$CellContext`temp, 
            Blank[]]] := 
         10^(8.08097 - 1582.271/(
           239.726 + $CellContext`temp)); $CellContext`Psat2$[
           Pattern[$CellContext`temp, 
            Blank[]]] := 
         10^(8.07131 - 1730.63/(
           233.426 + $CellContext`temp)); $CellContext`A12$ = 
         0.7923; $CellContext`A21$ = 0.5434; $CellContext`\[Gamma]1$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Exp[(1 - $CellContext`x$)^2 ($CellContext`A12$ + 
            2 ($CellContext`A21$ - $CellContext`A12$) $CellContext`x$)]; \
$CellContext`\[Gamma]2$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Exp[$CellContext`x$^2 ($CellContext`A21$ + 
            2 ($CellContext`A12$ - $CellContext`A21$) (
              1 - $CellContext`x$))]; $CellContext`equilb$ = Quiet[
           Interpolation[
            Map[{#, 
              ReplaceAll[$CellContext`y, 
               Quiet[
                
                FindRoot[{$CellContext`y == # $CellContext`\[Gamma]1$[#] \
$CellContext`Psat1$[$CellContext`temp]/$CellContext`P$, $CellContext`P$ == # \
$CellContext`\[Gamma]1$[#] $CellContext`Psat1$[$CellContext`temp] + (
                    1 - #) $CellContext`\[Gamma]2$[#] \
$CellContext`Psat2$[$CellContext`temp]}, {{$CellContext`y, 
                   0}, {$CellContext`temp, 60}}]]]}& , 
             Range[0, 1, 0.05]]]]; $CellContext`zf$ = 0.5; $CellContext`q$ = 
         0.5; $CellContext`feed$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         If[$CellContext`q$ != 
           1, ($CellContext`q$/($CellContext`q$ - 
             1)) $CellContext`x$ - $CellContext`zf$/($CellContext`q$ - 1), 
           1000000 ($CellContext`x$ - $CellContext`zf$) + $CellContext`zf$]; \
$CellContext`xpinch$ = ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`feed$[$CellContext`x] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
              0.5}]]]; $CellContext`ypinch$ = \
$CellContext`feed$[$CellContext`xpinch$]; $CellContext`opertRect$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`ypinch$ + (($CellContext`x$ - \
$CellContext`xpinch$)/($CellContext`xd$$ - $CellContext`xpinch$)) \
($CellContext`xd$$ - $CellContext`ypinch$); $CellContext`opertStrp$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`ypinch$ + (($CellContext`x$ - \
$CellContext`xpinch$)/($CellContext`xb$$ - $CellContext`xpinch$)) \
($CellContext`xb$$ - $CellContext`ypinch$); $CellContext`OpRect$[
           Pattern[$CellContext`x$, 
            Blank[]]] := ($CellContext`R$$/($CellContext`R$$ + 
            1)) $CellContext`x$ + $CellContext`xd$$/($CellContext`R$$ + 
           1); $CellContext`xi$ = ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`feed$[$CellContext`x] == \
$CellContext`OpRect$[$CellContext`x], {$CellContext`x, 
              0.7}]]]; $CellContext`yi$ = \
$CellContext`OpRect$[$CellContext`xi$]; $CellContext`cond1$ = \
$CellContext`yi$ >= $CellContext`equilb$[$CellContext`xi$]; \
$CellContext`cond2$ = $CellContext`yi$ < \
$CellContext`equilb$[$CellContext`xi$]; 
        If[$CellContext`cond1$, {$CellContext`OpStrp$[
              Pattern[$CellContext`x$, 
               
               Blank[]]] := $CellContext`opertStrp$[$CellContext`x$]; \
$CellContext`i$ = 
            0; $CellContext`yR$[0] = $CellContext`xd$$; $CellContext`xR$[
             0] = $CellContext`xd$$; 
           While[$CellContext`i$ < 
             25, {$CellContext`x1$ = ReplaceAll[$CellContext`x, 
                Quiet[
                 
                 FindRoot[$CellContext`yR$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
                   0.5}]]], $CellContext`y1$ = \
$CellContext`opertRect$[$CellContext`x1$], 
              
              If[$CellContext`x1$ > $CellContext`xpinch$, \
{$CellContext`xR$[$CellContext`i$ + 
                  1] = $CellContext`x1$, $CellContext`yR$[$CellContext`i$ + 
                  1] = $CellContext`y1$}], 
              
              Increment[$CellContext`i$]}]; $CellContext`nR$ = \
$CellContext`i$ - 1; $CellContext`i$ = 0; 
           If[$CellContext`nR$ >= 
             0, {$CellContext`yS$[
                0] = $CellContext`yR$[$CellContext`nR$]; $CellContext`xS$[
                0] = $CellContext`xR$[$CellContext`nR$]}]; 
           While[$CellContext`i$ < 
             20, {$CellContext`x1$ = ReplaceAll[$CellContext`x, 
                Quiet[
                 
                 FindRoot[$CellContext`yS$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
                   0.5}]]], $CellContext`y1$ = \
$CellContext`opertStrp$[$CellContext`x1$], $CellContext`xS$[$CellContext`i$ + 
                1] = $CellContext`x1$, $CellContext`yS$[$CellContext`i$ + 
                1] = $CellContext`y1$, 
              
              Increment[$CellContext`i$]}]; $CellContext`nS$ = \
$CellContext`i$ - 1; Null}, {$CellContext`OpStrp$[
              Pattern[$CellContext`x$, 
               
               Blank[]]] := $CellContext`yi$ + (($CellContext`x$ - \
$CellContext`xi$)/($CellContext`xb$$ - $CellContext`xi$)) ($CellContext`xb$$ - \
$CellContext`yi$); $CellContext`i$ = 
            0; $CellContext`yR$[0] = $CellContext`xd$$; $CellContext`xR$[
             0] = $CellContext`xd$$; 
           While[$CellContext`xR$[$CellContext`i$] > $CellContext`xi$, \
{$CellContext`x1$ = ReplaceAll[$CellContext`x, 
                Quiet[
                 
                 FindRoot[$CellContext`yR$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
                   0.7}]]], $CellContext`y1$ = \
$CellContext`OpRect$[$CellContext`x1$], 
              
              If[$CellContext`x1$ > $CellContext`xi$, \
{$CellContext`xR$[$CellContext`i$ + 
                  1] = $CellContext`x1$, $CellContext`yR$[$CellContext`i$ + 
                  1] = $CellContext`y1$}], 
              
              Increment[$CellContext`i$]}]; $CellContext`nR$ = \
$CellContext`i$ - 1; $CellContext`i$ = 0; 
           If[$CellContext`nR$ >= 
             0, $CellContext`yS$[
               0] = $CellContext`yR$[$CellContext`nR$]; $CellContext`xS$[
               0] = $CellContext`xR$[$CellContext`nR$]]; 
           While[$CellContext`xS$[$CellContext`i$] > $CellContext`xb$$, \
{$CellContext`x1$ = ReplaceAll[$CellContext`x, 
                Quiet[
                 
                 FindRoot[$CellContext`yS$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
                   0.5}]]], $CellContext`y1$ = \
$CellContext`OpStrp$[$CellContext`x1$], $CellContext`xS$[$CellContext`i$ + 
                1] = $CellContext`x1$, $CellContext`yS$[$CellContext`i$ + 
                1] = $CellContext`y1$, 
              
              Increment[$CellContext`i$]}]; $CellContext`nS$ = \
$CellContext`i$ - 1; 
           Null}]; $CellContext`nT$ = $CellContext`nR$ + $CellContext`nS$ + 
          1; $CellContext`distflow$ = ($CellContext`zf$ - \
$CellContext`xS$[$CellContext`nS$ + 
            1])/$CellContext`xd$$; $CellContext`botflow$ = 
         1 - $CellContext`distflow$; $CellContext`Ry$ = Map[Line[{{
              $CellContext`xR$[#], 
              $CellContext`yR$[# - 1]}, {
              $CellContext`xR$[#], 
              $CellContext`yR$[#]}}]& , 
           Range[$CellContext`nR$]]; $CellContext`Rx$ = Map[Line[{{
              $CellContext`xR$[#], 
              $CellContext`yR$[#]}, {
              $CellContext`xR$[# + 1], 
              $CellContext`yR$[#]}}]& , 
           If[$CellContext`nR$ >= 1, 
            Range[0, $CellContext`nR$ - 1], {0}]]; $CellContext`Sy$ = 
         Map[Line[{{
              $CellContext`xS$[# + 1], 
              $CellContext`yS$[#]}, {
              $CellContext`xS$[# + 1], 
              $CellContext`yS$[# + 1]}}]& , 
           Range[0, $CellContext`nS$ - 1]]; $CellContext`Sx$ = Map[Line[{{
              $CellContext`xS$[# - 1], 
              $CellContext`yS$[# - 1]}, {
              $CellContext`xS$[#], 
              $CellContext`yS$[# - 1]}}]& , 
           Range[$CellContext`nS$ + 1]]; $CellContext`Sr$ = Line[{{
             $CellContext`xS$[$CellContext`nS$ + 1], 
             $CellContext`yS$[$CellContext`nS$]}, {
             $CellContext`xS$[$CellContext`nS$ + 1], 
             0}}]; $CellContext`xybase$ = Show[
           Plot[{
             $CellContext`equilb$[$CellContext`x], $CellContext`x}, \
{$CellContext`x, 0, 1}, PlotStyle -> {{Thick, Red}, {Thick, 
               RGBColor[0, 0.6, 0]}}, PlotRange -> {{0, 1}, {0, 1}}], 
           If[$CellContext`cond1$, {
             Plot[
              $CellContext`feed$[$CellContext`x], {$CellContext`x, \
$CellContext`xpinch$, $CellContext`zf$}, PlotStyle -> {Thick, Blue}], 
             Plot[
              $CellContext`opertRect$[$CellContext`x], {$CellContext`x, \
$CellContext`xpinch$, $CellContext`xd$$}, PlotStyle -> {Thick, 
                RGBColor[1, 0.4, 0]}], 
             Plot[
              $CellContext`opertStrp$[$CellContext`x], {$CellContext`x, \
$CellContext`xb$$, $CellContext`xpinch$}, PlotStyle -> {Thick, 
                Hue[0.9]}]}, {
             Plot[
              $CellContext`feed$[$CellContext`x], {$CellContext`x, \
$CellContext`xi$, $CellContext`zf$}, PlotStyle -> {Thick, Blue}], 
             Plot[
              $CellContext`OpRect$[$CellContext`x], {$CellContext`x, \
$CellContext`xi$, $CellContext`xd$$}, PlotStyle -> {Thick, 
                RGBColor[1, 0.4, 0]}], 
             Plot[
              $CellContext`OpStrp$[$CellContext`x], {$CellContext`x, \
$CellContext`xb$$, $CellContext`xi$}, PlotStyle -> {Thick, 
                Hue[0.9]}]}], 
           Graphics[{{Thick, $CellContext`Ry$, $CellContext`Rx$, 
              
              If[$CellContext`cond2$, {$CellContext`Sy$, $CellContext`Sx$}, \
{}]}, 
             If[$CellContext`cond2$, {
               Map[Text[
                 Style[
                  
                  If[$CellContext`dir$$ == 
                   1, #, $CellContext`nR$ + $CellContext`nS$ + 1 - #], 18], {
                  $CellContext`xR$[#], 
                  $CellContext`yR$[# - 1]}, {1, -1}]& , 
                Range[$CellContext`nR$]], 
               Map[Text[
                 Style[
                  
                  If[$CellContext`dir$$ == 
                   1, $CellContext`nR$ + #, $CellContext`nS$ + 1 - #], 18], {
                  $CellContext`xS$[#], 
                  $CellContext`yS$[# - 1]}, {1, -1}]& , 
                Range[$CellContext`nS$]], 
               Text[
                Style["R", 18], {
                 $CellContext`xS$[$CellContext`nS$ + 1], 
                 $CellContext`yS$[$CellContext`nS$]}, {1, -1}], {Dashed, 
                Map[
                Line[{{#, 
                    0}, {#, #}}]& , {$CellContext`zf$, $CellContext`xd$$}], \
$CellContext`Sr$}, 
               (ReplaceAll[
                Text[
                 Style[
                  Row[{
                    Subscript[
                    Style["x", Italic], "B"], " = ", 
                    NumberForm[
                    $CellContext`xS$[$CellContext`nS$ + 1], 2]}], 17, 
                  Hue[0.9], Background -> White], {
                  If[# < $CellContext`test, 0, #], 0.05}, {
                  If[# < $CellContext`test, -1, 0], 0}], $CellContext`test -> 
                If[$CellContext`window$$, 0.15, 0.06]]& )[
                $CellContext`xS$[$CellContext`nS$ + 1]], 
               (ReplaceAll[
                Text[
                 Style[
                  Row[{
                    Subscript[
                    Style["x", Italic], "D"], " = ", 
                    NumberForm[
                    $CellContext`xR$[0], 2]}], 17, 
                  RGBColor[1, 0.4, 0], Background -> White], {
                  If[# > $CellContext`test, 1, #], 0.05}, {
                  If[# > $CellContext`test, 1, 0], 0}], $CellContext`test -> 
                If[$CellContext`window$$, 0.86, 0.94]]& )[
                $CellContext`xR$[0]], 
               Text[
                Style[
                 Row[{
                   Subscript[
                    Style["z", Italic], "F"], " = ", $CellContext`zf$}], 17, 
                 Blue, Background -> White], {$CellContext`zf$, 0.15}]}]}], 
           Frame -> True, FrameLabel -> {
             Row[{"liquid mole fraction ", 
               Style["x", Italic]}], 
             Row[{"vapor mole fraction ", 
               Style["y", Italic]}]}, LabelStyle -> {17, Black}, AspectRatio -> 
           Full, PlotRangePadding -> {0.02, {None, 0.05}}, 
           ImagePadding -> {{55, 10}, {50, 10}}]; $CellContext`diagram$ = 
         Graphics[{{Thick, 
             Map[Line[{{#, 0}, {#, 3}}]& , {0, 1}], 
             Circle[{0.5, 3}, {0.5, 0.15}, {0, Pi}], 
             Circle[{0.5, 0}, {0.5, 0.15}, {Pi, 2 Pi}]}, {Thick, 
             Arrowheads[0.07], 
             Arrow[{{0.5, -0.15}, {0.5, -0.5}, {1.25, -0.5}}], 
             Arrow[{{1.5, -0.35}, {1.5, 0}, {1, 0}}], {
              Hue[0.9], 
              Arrow[{{1.75, -0.5}, {3, -0.5}}]}, 
             Arrow[{{0.5, 3.15}, {0.5, 3.5}, {1.6, 3.5}, {1.6, 3.15}}], {
              RGBColor[1, 0.4, 0], 
              Line[{{1.6, 2.85}, {1.6, 2.7}}], 
              Arrowheads[{-0.07, 0.07}], 
              Arrow[{{1, 2.7}, {3, 2.7}}]}, 
             
             If[$CellContext`yi$ < $CellContext`equilb$[$CellContext`xi$], {{
               Blue, 
                
                Arrow[{{-1.5, 3 (2 $CellContext`nS$ + 1)/(
                   2 $CellContext`nT$)}, {
                  0, 3 (2 $CellContext`nS$ + 1)/(2 $CellContext`nT$)}}]}, 
               Map[{
                 Text[
                  Style[
                   If[$CellContext`dir$$ == 1, $CellContext`nT$ - #, #], 
                   17], {0.5, 3 (#/$CellContext`nT$)}, {0, -1.1}], 
                 
                 Line[{{0, 3 (#/$CellContext`nT$)}, {
                   1, 3 (#/$CellContext`nT$)}}]}& , 
                Range[$CellContext`nT$ - 1]]}, {Blue, 
               Arrow[{{-1.5, 1.5}, {0, 1.5}}]}]}, {
             Arrowheads[0.05], 
             Arrow[{{1.1, -0.75}, {1.9, -0.25}}], 
             Arrow[
              BezierCurve[{{1.9, 3.25}, {1.6, 2.9}, {1.3, 3.25}}]]}, 
            Apply[{
              EdgeForm[Thick], 
              FaceForm[None], 
              Disk[#2, {0.26, 0.15}], 
              Text[
               Style[#, 17, Background -> White], #2]}& , {{
              "R", {1.5, -0.5}}, {"C", {1.6, 3}}}, {1}], 
            Text[
             Style[
              Column[{"feed rate", "1.00 kmol/h", 
                Spacer[1], 
                Row[{
                  Subscript[
                   Style["z", Italic], "F"], " = ", $CellContext`zf$}], 
                Row[{"quality = ", $CellContext`q$}]}, Center], 17, 
              Blue], {-0.85, 
              
              If[$CellContext`yi$ < $CellContext`equilb$[$CellContext`xi$], 
               3 (2 $CellContext`nS$ + 1)/(2 $CellContext`nT$), 1.5]}, {
             0, 0.05}], 
            Text[
             Style[
              Column[{"reflux ratio", 
                Row[{
                  Style["L", Italic], "/", 
                  Style["D", Italic], " = ", 
                  NumberForm[$CellContext`R$$, {3, 2}]}]}, Center], 17], {
             2, 2.05}], 
            Text[
             Style[
              Column[{
                Column[{"distillate flow", 
                  
                  If[$CellContext`yi$ < \
$CellContext`equilb$[$CellContext`xi$], 
                   Row[{
                    NumberForm[$CellContext`distflow$, {2, 2}], " kmol/h"}], 
                   "N/A"]}, Center], 
                Row[{
                  Subscript[
                   Style["x", Italic], "D"], " = ", 
                  $CellContext`xR$[0]}]}, Center, Spacings -> 1], 17, 
              RGBColor[1, 0.4, 0]], {2.8, 2.81}], 
            Text[
             Style[
              Column[{
                Column[{"bottoms flow", 
                  
                  If[$CellContext`yi$ < \
$CellContext`equilb$[$CellContext`xi$], 
                   Row[{
                    NumberForm[$CellContext`botflow$, {2, 2}], " kmol/h"}], 
                   "N/A"]}, Center], 
                Row[{
                  Subscript[
                   Style["x", Italic], "B"], " = ", 
                  NumberForm[
                   $CellContext`xS$[$CellContext`nS$ + 1], 2]}]}, Center, 
               Spacings -> 1], 17, 
              Hue[0.9]], {2.8, -0.39}]}, ImageSize -> {285, 400}, AspectRatio -> 
           Full]; $CellContext`mouse$ = Graphics[{
            Apply[Mouseover[{
               Thickness[0.02], Transparent, 
               Line[
                Table[#, {$CellContext`x, 
                  First[#2], 
                  Last[#2], 0.05}]]}, 
              Text[
               Framed[
                Style[#3, 18, #4], Background -> LightYellow], {0.15, 
               0.9}]]& , {{{$CellContext`x, $CellContext`x}, {0, 1}, 
               Row[{
                 Style["x", Italic], " = ", 
                 Style["y", Italic], " line"}], 
               RGBColor[0, 0.6, 0]}, {{$CellContext`x, 
                $CellContext`equilb$[$CellContext`x]}, {0, 1}, 
               "equilibrium curve", Red}, {{$CellContext`x, 
                $CellContext`feed$[$CellContext`x]}, {
                
                If[$CellContext`cond1$, $CellContext`xpinch$, \
$CellContext`xi$], $CellContext`zf$}, 
               Row[{
                 Style["q", Italic], "\[Hyphen]line"}], 
               Blue}, {{$CellContext`x, 
                If[$CellContext`cond1$, 
                 $CellContext`opertRect$[$CellContext`x], 
                 $CellContext`OpRect$[$CellContext`x]]}, {
                
                If[$CellContext`cond1$, $CellContext`xpinch$, \
$CellContext`xi$], $CellContext`xd$$}, "rectifying section", 
               RGBColor[1, 0.4, 0]}, {{$CellContext`x, 
                If[$CellContext`cond1$, 
                 $CellContext`opertStrp$[$CellContext`x], 
                 $CellContext`OpStrp$[$CellContext`x]]}, {$CellContext`xb$$, 
                
                If[$CellContext`cond1$, $CellContext`xpinch$, \
$CellContext`xi$]}, "stripping section", 
               Hue[0.9]}}, {1}], 
            Apply[Mouseover[{
               Thickness[0.02], Transparent, #}, 
              Text[
               Framed[
                Style[#2, 18], Background -> LightYellow], {0.15, 
               0.9}]]& , {{{$CellContext`Ry$, $CellContext`Rx$, 
                
                If[$CellContext`cond2$, {$CellContext`Sy$, $CellContext`Sx$}, \
{}]}, "equilibrium stages"}, {
               Line[{{
                  $CellContext`xS$[$CellContext`nS$ + 1], 
                  $CellContext`yS$[$CellContext`nS$]}, {
                  $CellContext`xS$[$CellContext`nS$ + 1], 0}}], "bottoms"}, {
               Line[{{
                  $CellContext`xR$[0], 
                  $CellContext`yR$[0]}, {
                  $CellContext`xR$[0], 0}}], "distillate"}, {
               Line[{{0.5, 0.5}, {0.5, 0}}], "feed"}}, {1}]}]; Grid[{{
            Text[
             Style[
              If[$CellContext`yi$ < $CellContext`equilb$[$CellContext`xi$], 
               
               Row[{"equilibrium stages needed = ", $CellContext`nT$, 
                 " (including reboiler)"}], 
               "equilibrium stages needed = infinite (pinch point)"], 17]], 
            SpanFromLeft}, {
            Show[$CellContext`xybase$, 
             If[$CellContext`window$$, {}, $CellContext`mouse$], ImageSize -> {
               If[$CellContext`window$$, 310, 591], 400}], 
            If[$CellContext`window$$, $CellContext`diagram$, Nothing]}}]], 
      "Specifications" :> {{{$CellContext`window$$, False, 
          "view process flow diagram"}, {True, False}, ControlPlacement -> 
         1}, {{$CellContext`dir$$, 2, "    number stages"}, {
         1 -> " top to bottom ", 2 -> " bottom to top "}, ControlType -> 
         Setter, ControlPlacement -> 2}, {{$CellContext`R$$, 3, 
          Row[{"external reflux ratio ", 
            Style["L", Italic], "/", 
            Style["D", Italic]}]}, 0.25, 10, 0.25, Appearance -> "Labeled", 
         ControlPlacement -> 3}, {{$CellContext`xd$$, 0.9400000000000001, 
          Row[{"distillate ", 
            Subscript[
             Style["x", Italic], "D"]}]}, 0.8, 0.98, 0.01, Appearance -> 
         "Labeled", ImageSize -> Small, ControlPlacement -> 
         4}, {{$CellContext`xb$$, 0.07, 
          Row[{"desired bottoms ", 
            Subscript[
             Style["x", Italic], "B"]}]}, 0.05, 0.2, 0.01, Appearance -> 
         "Labeled", ImageSize -> Small, ControlPlacement -> 5}, 
        Grid[{{
           Manipulate`Place[1], SpanFromLeft, 
           Manipulate`Place[2], SpanFromLeft}, {
           Manipulate`Place[3], SpanFromLeft}, {
           Style["mole fractions:", Bold], 
           Manipulate`Place[4], SpanFromLeft, 
           Manipulate`Place[5]}}, Alignment -> Left]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{646., {277., 282.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->2057347913],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`dir$$ = 2, $CellContext`R$$ = 
    2., $CellContext`window$$ = True, $CellContext`xb$$ = 
    0.14, $CellContext`xd$$ = 0.88, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`window$$], True, "view process flow diagram"}, {
      True, False}}, {{
       Hold[$CellContext`dir$$], 2, "    number stages"}, {
      1 -> " top to bottom ", 2 -> " bottom to top "}}, {{
       Hold[$CellContext`R$$], 2., 
       Row[{"external reflux ratio ", 
         Style["L", Italic], "/", 
         Style["D", Italic]}]}, 0.25, 10, 0.25}, {{
       Hold[$CellContext`xd$$], 0.88, 
       Row[{"distillate ", 
         Subscript[
          Style["x", Italic], "D"]}]}, 0.8, 0.98, 0.01}, {{
       Hold[$CellContext`xb$$], 0.14, 
       Row[{"desired bottoms ", 
         Subscript[
          Style["x", Italic], "B"]}]}, 0.05, 0.2, 0.01}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], SpanFromLeft, 
          Manipulate`Place[2], SpanFromLeft}, {
          Manipulate`Place[3], SpanFromLeft}, {
          Style["mole fractions:", Bold], 
          Manipulate`Place[4], SpanFromLeft, 
          Manipulate`Place[5]}}, Alignment -> Left]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    603., {208.3544921875, 213.6455078125}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`window$330351$$ = False, $CellContext`dir$330352$$ = 
    False, $CellContext`R$330353$$ = 0, $CellContext`xd$330354$$ = 
    0, $CellContext`xb$330355$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`dir$$ = 2, $CellContext`R$$ = 
        2., $CellContext`window$$ = True, $CellContext`xb$$ = 
        0.14, $CellContext`xd$$ = 0.88}, "ControllerVariables" :> {
        Hold[$CellContext`window$$, $CellContext`window$330351$$, False], 
        Hold[$CellContext`dir$$, $CellContext`dir$330352$$, False], 
        Hold[$CellContext`R$$, $CellContext`R$330353$$, 0], 
        Hold[$CellContext`xd$$, $CellContext`xd$330354$$, 0], 
        Hold[$CellContext`xb$$, $CellContext`xb$330355$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`P$, $CellContext`Psat1$, $CellContext`Psat2$, \
$CellContext`A12$, $CellContext`A21$, $CellContext`\[Gamma]1$, $CellContext`\
\[Gamma]2$, $CellContext`equilb$, $CellContext`zf$, $CellContext`q$, \
$CellContext`feed$, $CellContext`xpinch$, $CellContext`ypinch$, \
$CellContext`opertRect$, $CellContext`opertStrp$, $CellContext`OpRect$, \
$CellContext`xi$, $CellContext`yi$, $CellContext`cond1$, $CellContext`cond2$, \
$CellContext`OpStrp$, $CellContext`i$, $CellContext`yR$, $CellContext`xR$, \
$CellContext`x1$, $CellContext`y1$, $CellContext`nR$, $CellContext`yS$, \
$CellContext`xS$, $CellContext`nS$, $CellContext`nT$, $CellContext`distflow$, \
$CellContext`botflow$, $CellContext`Ry$, $CellContext`Rx$, $CellContext`Sy$, \
$CellContext`Sx$, $CellContext`Sr$, $CellContext`xybase$, \
$CellContext`diagram$, $CellContext`mouse$}, $CellContext`P$ = 
         760; $CellContext`Psat1$[
           Pattern[$CellContext`temp, 
            Blank[]]] := 
         10^(8.08097 - 1582.271/(
           239.726 + $CellContext`temp)); $CellContext`Psat2$[
           Pattern[$CellContext`temp, 
            Blank[]]] := 
         10^(8.07131 - 1730.63/(
           233.426 + $CellContext`temp)); $CellContext`A12$ = 
         0.7923; $CellContext`A21$ = 0.5434; $CellContext`\[Gamma]1$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Exp[(1 - $CellContext`x$)^2 ($CellContext`A12$ + 
            2 ($CellContext`A21$ - $CellContext`A12$) $CellContext`x$)]; \
$CellContext`\[Gamma]2$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Exp[$CellContext`x$^2 ($CellContext`A21$ + 
            2 ($CellContext`A12$ - $CellContext`A21$) (
              1 - $CellContext`x$))]; $CellContext`equilb$ = Quiet[
           Interpolation[
            Map[{#, 
              ReplaceAll[$CellContext`y, 
               Quiet[
                
                FindRoot[{$CellContext`y == # $CellContext`\[Gamma]1$[#] \
$CellContext`Psat1$[$CellContext`temp]/$CellContext`P$, $CellContext`P$ == # \
$CellContext`\[Gamma]1$[#] $CellContext`Psat1$[$CellContext`temp] + (
                    1 - #) $CellContext`\[Gamma]2$[#] \
$CellContext`Psat2$[$CellContext`temp]}, {{$CellContext`y, 
                   0}, {$CellContext`temp, 60}}]]]}& , 
             Range[0, 1, 0.05]]]]; $CellContext`zf$ = 0.5; $CellContext`q$ = 
         0.5; $CellContext`feed$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         If[$CellContext`q$ != 
           1, ($CellContext`q$/($CellContext`q$ - 
             1)) $CellContext`x$ - $CellContext`zf$/($CellContext`q$ - 1), 
           1000000 ($CellContext`x$ - $CellContext`zf$) + $CellContext`zf$]; \
$CellContext`xpinch$ = ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`feed$[$CellContext`x] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
              0.5}]]]; $CellContext`ypinch$ = \
$CellContext`feed$[$CellContext`xpinch$]; $CellContext`opertRect$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`ypinch$ + (($CellContext`x$ - \
$CellContext`xpinch$)/($CellContext`xd$$ - $CellContext`xpinch$)) \
($CellContext`xd$$ - $CellContext`ypinch$); $CellContext`opertStrp$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`ypinch$ + (($CellContext`x$ - \
$CellContext`xpinch$)/($CellContext`xb$$ - $CellContext`xpinch$)) \
($CellContext`xb$$ - $CellContext`ypinch$); $CellContext`OpRect$[
           Pattern[$CellContext`x$, 
            Blank[]]] := ($CellContext`R$$/($CellContext`R$$ + 
            1)) $CellContext`x$ + $CellContext`xd$$/($CellContext`R$$ + 
           1); $CellContext`xi$ = ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`feed$[$CellContext`x] == \
$CellContext`OpRect$[$CellContext`x], {$CellContext`x, 
              0.7}]]]; $CellContext`yi$ = \
$CellContext`OpRect$[$CellContext`xi$]; $CellContext`cond1$ = \
$CellContext`yi$ >= $CellContext`equilb$[$CellContext`xi$]; \
$CellContext`cond2$ = $CellContext`yi$ < \
$CellContext`equilb$[$CellContext`xi$]; 
        If[$CellContext`cond1$, {$CellContext`OpStrp$[
              Pattern[$CellContext`x$, 
               
               Blank[]]] := $CellContext`opertStrp$[$CellContext`x$]; \
$CellContext`i$ = 
            0; $CellContext`yR$[0] = $CellContext`xd$$; $CellContext`xR$[
             0] = $CellContext`xd$$; 
           While[$CellContext`i$ < 
             25, {$CellContext`x1$ = ReplaceAll[$CellContext`x, 
                Quiet[
                 
                 FindRoot[$CellContext`yR$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
                   0.5}]]], $CellContext`y1$ = \
$CellContext`opertRect$[$CellContext`x1$], 
              
              If[$CellContext`x1$ > $CellContext`xpinch$, \
{$CellContext`xR$[$CellContext`i$ + 
                  1] = $CellContext`x1$, $CellContext`yR$[$CellContext`i$ + 
                  1] = $CellContext`y1$}], 
              
              Increment[$CellContext`i$]}]; $CellContext`nR$ = \
$CellContext`i$ - 1; $CellContext`i$ = 0; 
           If[$CellContext`nR$ >= 
             0, {$CellContext`yS$[
                0] = $CellContext`yR$[$CellContext`nR$]; $CellContext`xS$[
                0] = $CellContext`xR$[$CellContext`nR$]}]; 
           While[$CellContext`i$ < 
             20, {$CellContext`x1$ = ReplaceAll[$CellContext`x, 
                Quiet[
                 
                 FindRoot[$CellContext`yS$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
                   0.5}]]], $CellContext`y1$ = \
$CellContext`opertStrp$[$CellContext`x1$], $CellContext`xS$[$CellContext`i$ + 
                1] = $CellContext`x1$, $CellContext`yS$[$CellContext`i$ + 
                1] = $CellContext`y1$, 
              
              Increment[$CellContext`i$]}]; $CellContext`nS$ = \
$CellContext`i$ - 1; Null}, {$CellContext`OpStrp$[
              Pattern[$CellContext`x$, 
               
               Blank[]]] := $CellContext`yi$ + (($CellContext`x$ - \
$CellContext`xi$)/($CellContext`xb$$ - $CellContext`xi$)) ($CellContext`xb$$ - \
$CellContext`yi$); $CellContext`i$ = 
            0; $CellContext`yR$[0] = $CellContext`xd$$; $CellContext`xR$[
             0] = $CellContext`xd$$; 
           While[$CellContext`xR$[$CellContext`i$] > $CellContext`xi$, \
{$CellContext`x1$ = ReplaceAll[$CellContext`x, 
                Quiet[
                 
                 FindRoot[$CellContext`yR$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
                   0.7}]]], $CellContext`y1$ = \
$CellContext`OpRect$[$CellContext`x1$], 
              
              If[$CellContext`x1$ > $CellContext`xi$, \
{$CellContext`xR$[$CellContext`i$ + 
                  1] = $CellContext`x1$, $CellContext`yR$[$CellContext`i$ + 
                  1] = $CellContext`y1$}], 
              
              Increment[$CellContext`i$]}]; $CellContext`nR$ = \
$CellContext`i$ - 1; $CellContext`i$ = 0; 
           If[$CellContext`nR$ >= 
             0, $CellContext`yS$[
               0] = $CellContext`yR$[$CellContext`nR$]; $CellContext`xS$[
               0] = $CellContext`xR$[$CellContext`nR$]]; 
           While[$CellContext`xS$[$CellContext`i$] > $CellContext`xb$$, \
{$CellContext`x1$ = ReplaceAll[$CellContext`x, 
                Quiet[
                 
                 FindRoot[$CellContext`yS$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
                   0.5}]]], $CellContext`y1$ = \
$CellContext`OpStrp$[$CellContext`x1$], $CellContext`xS$[$CellContext`i$ + 
                1] = $CellContext`x1$, $CellContext`yS$[$CellContext`i$ + 
                1] = $CellContext`y1$, 
              
              Increment[$CellContext`i$]}]; $CellContext`nS$ = \
$CellContext`i$ - 1; 
           Null}]; $CellContext`nT$ = $CellContext`nR$ + $CellContext`nS$ + 
          1; $CellContext`distflow$ = ($CellContext`zf$ - \
$CellContext`xS$[$CellContext`nS$ + 
            1])/$CellContext`xd$$; $CellContext`botflow$ = 
         1 - $CellContext`distflow$; $CellContext`Ry$ = Map[Line[{{
              $CellContext`xR$[#], 
              $CellContext`yR$[# - 1]}, {
              $CellContext`xR$[#], 
              $CellContext`yR$[#]}}]& , 
           Range[$CellContext`nR$]]; $CellContext`Rx$ = Map[Line[{{
              $CellContext`xR$[#], 
              $CellContext`yR$[#]}, {
              $CellContext`xR$[# + 1], 
              $CellContext`yR$[#]}}]& , 
           If[$CellContext`nR$ >= 1, 
            Range[0, $CellContext`nR$ - 1], {0}]]; $CellContext`Sy$ = 
         Map[Line[{{
              $CellContext`xS$[# + 1], 
              $CellContext`yS$[#]}, {
              $CellContext`xS$[# + 1], 
              $CellContext`yS$[# + 1]}}]& , 
           Range[0, $CellContext`nS$ - 1]]; $CellContext`Sx$ = Map[Line[{{
              $CellContext`xS$[# - 1], 
              $CellContext`yS$[# - 1]}, {
              $CellContext`xS$[#], 
              $CellContext`yS$[# - 1]}}]& , 
           Range[$CellContext`nS$ + 1]]; $CellContext`Sr$ = Line[{{
             $CellContext`xS$[$CellContext`nS$ + 1], 
             $CellContext`yS$[$CellContext`nS$]}, {
             $CellContext`xS$[$CellContext`nS$ + 1], 
             0}}]; $CellContext`xybase$ = Show[
           Plot[{
             $CellContext`equilb$[$CellContext`x], $CellContext`x}, \
{$CellContext`x, 0, 1}, PlotStyle -> {{Thick, Red}, {Thick, 
               RGBColor[0, 0.6, 0]}}, PlotRange -> {{0, 1}, {0, 1}}], 
           If[$CellContext`cond1$, {
             Plot[
              $CellContext`feed$[$CellContext`x], {$CellContext`x, \
$CellContext`xpinch$, $CellContext`zf$}, PlotStyle -> {Thick, Blue}], 
             Plot[
              $CellContext`opertRect$[$CellContext`x], {$CellContext`x, \
$CellContext`xpinch$, $CellContext`xd$$}, PlotStyle -> {Thick, 
                RGBColor[1, 0.4, 0]}], 
             Plot[
              $CellContext`opertStrp$[$CellContext`x], {$CellContext`x, \
$CellContext`xb$$, $CellContext`xpinch$}, PlotStyle -> {Thick, 
                Hue[0.9]}]}, {
             Plot[
              $CellContext`feed$[$CellContext`x], {$CellContext`x, \
$CellContext`xi$, $CellContext`zf$}, PlotStyle -> {Thick, Blue}], 
             Plot[
              $CellContext`OpRect$[$CellContext`x], {$CellContext`x, \
$CellContext`xi$, $CellContext`xd$$}, PlotStyle -> {Thick, 
                RGBColor[1, 0.4, 0]}], 
             Plot[
              $CellContext`OpStrp$[$CellContext`x], {$CellContext`x, \
$CellContext`xb$$, $CellContext`xi$}, PlotStyle -> {Thick, 
                Hue[0.9]}]}], 
           Graphics[{{Thick, $CellContext`Ry$, $CellContext`Rx$, 
              
              If[$CellContext`cond2$, {$CellContext`Sy$, $CellContext`Sx$}, \
{}]}, 
             If[$CellContext`cond2$, {
               Map[Text[
                 Style[
                  
                  If[$CellContext`dir$$ == 
                   1, #, $CellContext`nR$ + $CellContext`nS$ + 1 - #], 18], {
                  $CellContext`xR$[#], 
                  $CellContext`yR$[# - 1]}, {1, -1}]& , 
                Range[$CellContext`nR$]], 
               Map[Text[
                 Style[
                  
                  If[$CellContext`dir$$ == 
                   1, $CellContext`nR$ + #, $CellContext`nS$ + 1 - #], 18], {
                  $CellContext`xS$[#], 
                  $CellContext`yS$[# - 1]}, {1, -1}]& , 
                Range[$CellContext`nS$]], 
               Text[
                Style["R", 18], {
                 $CellContext`xS$[$CellContext`nS$ + 1], 
                 $CellContext`yS$[$CellContext`nS$]}, {1, -1}], {Dashed, 
                Map[
                Line[{{#, 
                    0}, {#, #}}]& , {$CellContext`zf$, $CellContext`xd$$}], \
$CellContext`Sr$}, 
               (ReplaceAll[
                Text[
                 Style[
                  Row[{
                    Subscript[
                    Style["x", Italic], "B"], " = ", 
                    NumberForm[
                    $CellContext`xS$[$CellContext`nS$ + 1], 2]}], 17, 
                  Hue[0.9], Background -> White], {
                  If[# < $CellContext`test, 0, #], 0.05}, {
                  If[# < $CellContext`test, -1, 0], 0}], $CellContext`test -> 
                If[$CellContext`window$$, 0.15, 0.06]]& )[
                $CellContext`xS$[$CellContext`nS$ + 1]], 
               (ReplaceAll[
                Text[
                 Style[
                  Row[{
                    Subscript[
                    Style["x", Italic], "D"], " = ", 
                    NumberForm[
                    $CellContext`xR$[0], 2]}], 17, 
                  RGBColor[1, 0.4, 0], Background -> White], {
                  If[# > $CellContext`test, 1, #], 0.05}, {
                  If[# > $CellContext`test, 1, 0], 0}], $CellContext`test -> 
                If[$CellContext`window$$, 0.86, 0.94]]& )[
                $CellContext`xR$[0]], 
               Text[
                Style[
                 Row[{
                   Subscript[
                    Style["z", Italic], "F"], " = ", $CellContext`zf$}], 17, 
                 Blue, Background -> White], {$CellContext`zf$, 0.15}]}]}], 
           Frame -> True, FrameLabel -> {
             Row[{"liquid mole fraction ", 
               Style["x", Italic]}], 
             Row[{"vapor mole fraction ", 
               Style["y", Italic]}]}, LabelStyle -> {17, Black}, AspectRatio -> 
           Full, PlotRangePadding -> {0.02, {None, 0.05}}, 
           ImagePadding -> {{55, 10}, {50, 10}}]; $CellContext`diagram$ = 
         Graphics[{{Thick, 
             Map[Line[{{#, 0}, {#, 3}}]& , {0, 1}], 
             Circle[{0.5, 3}, {0.5, 0.15}, {0, Pi}], 
             Circle[{0.5, 0}, {0.5, 0.15}, {Pi, 2 Pi}]}, {Thick, 
             Arrowheads[0.07], 
             Arrow[{{0.5, -0.15}, {0.5, -0.5}, {1.25, -0.5}}], 
             Arrow[{{1.5, -0.35}, {1.5, 0}, {1, 0}}], {
              Hue[0.9], 
              Arrow[{{1.75, -0.5}, {3, -0.5}}]}, 
             Arrow[{{0.5, 3.15}, {0.5, 3.5}, {1.6, 3.5}, {1.6, 3.15}}], {
              RGBColor[1, 0.4, 0], 
              Line[{{1.6, 2.85}, {1.6, 2.7}}], 
              Arrowheads[{-0.07, 0.07}], 
              Arrow[{{1, 2.7}, {3, 2.7}}]}, 
             
             If[$CellContext`yi$ < $CellContext`equilb$[$CellContext`xi$], {{
               Blue, 
                
                Arrow[{{-1.5, 3 (2 $CellContext`nS$ + 1)/(
                   2 $CellContext`nT$)}, {
                  0, 3 (2 $CellContext`nS$ + 1)/(2 $CellContext`nT$)}}]}, 
               Map[{
                 Text[
                  Style[
                   If[$CellContext`dir$$ == 1, $CellContext`nT$ - #, #], 
                   17], {0.5, 3 (#/$CellContext`nT$)}, {0, -1.1}], 
                 
                 Line[{{0, 3 (#/$CellContext`nT$)}, {
                   1, 3 (#/$CellContext`nT$)}}]}& , 
                Range[$CellContext`nT$ - 1]]}, {Blue, 
               Arrow[{{-1.5, 1.5}, {0, 1.5}}]}]}, {
             Arrowheads[0.05], 
             Arrow[{{1.1, -0.75}, {1.9, -0.25}}], 
             Arrow[
              BezierCurve[{{1.9, 3.25}, {1.6, 2.9}, {1.3, 3.25}}]]}, 
            Apply[{
              EdgeForm[Thick], 
              FaceForm[None], 
              Disk[#2, {0.26, 0.15}], 
              Text[
               Style[#, 17, Background -> White], #2]}& , {{
              "R", {1.5, -0.5}}, {"C", {1.6, 3}}}, {1}], 
            Text[
             Style[
              Column[{"feed rate", "1.00 kmol/h", 
                Spacer[1], 
                Row[{
                  Subscript[
                   Style["z", Italic], "F"], " = ", $CellContext`zf$}], 
                Row[{"quality = ", $CellContext`q$}]}, Center], 17, 
              Blue], {-0.85, 
              
              If[$CellContext`yi$ < $CellContext`equilb$[$CellContext`xi$], 
               3 (2 $CellContext`nS$ + 1)/(2 $CellContext`nT$), 1.5]}, {
             0, 0.05}], 
            Text[
             Style[
              Column[{"reflux ratio", 
                Row[{
                  Style["L", Italic], "/", 
                  Style["D", Italic], " = ", 
                  NumberForm[$CellContext`R$$, {3, 2}]}]}, Center], 17], {
             2, 2.05}], 
            Text[
             Style[
              Column[{
                Column[{"distillate flow", 
                  
                  If[$CellContext`yi$ < \
$CellContext`equilb$[$CellContext`xi$], 
                   Row[{
                    NumberForm[$CellContext`distflow$, {2, 2}], " kmol/h"}], 
                   "N/A"]}, Center], 
                Row[{
                  Subscript[
                   Style["x", Italic], "D"], " = ", 
                  $CellContext`xR$[0]}]}, Center, Spacings -> 1], 17, 
              RGBColor[1, 0.4, 0]], {2.8, 2.81}], 
            Text[
             Style[
              Column[{
                Column[{"bottoms flow", 
                  
                  If[$CellContext`yi$ < \
$CellContext`equilb$[$CellContext`xi$], 
                   Row[{
                    NumberForm[$CellContext`botflow$, {2, 2}], " kmol/h"}], 
                   "N/A"]}, Center], 
                Row[{
                  Subscript[
                   Style["x", Italic], "B"], " = ", 
                  NumberForm[
                   $CellContext`xS$[$CellContext`nS$ + 1], 2]}]}, Center, 
               Spacings -> 1], 17, 
              Hue[0.9]], {2.8, -0.39}]}, ImageSize -> {285, 400}, AspectRatio -> 
           Full]; $CellContext`mouse$ = Graphics[{
            Apply[Mouseover[{
               Thickness[0.02], Transparent, 
               Line[
                Table[#, {$CellContext`x, 
                  First[#2], 
                  Last[#2], 0.05}]]}, 
              Text[
               Framed[
                Style[#3, 18, #4], Background -> LightYellow], {0.15, 
               0.9}]]& , {{{$CellContext`x, $CellContext`x}, {0, 1}, 
               Row[{
                 Style["x", Italic], " = ", 
                 Style["y", Italic], " line"}], 
               RGBColor[0, 0.6, 0]}, {{$CellContext`x, 
                $CellContext`equilb$[$CellContext`x]}, {0, 1}, 
               "equilibrium curve", Red}, {{$CellContext`x, 
                $CellContext`feed$[$CellContext`x]}, {
                
                If[$CellContext`cond1$, $CellContext`xpinch$, \
$CellContext`xi$], $CellContext`zf$}, 
               Row[{
                 Style["q", Italic], "\[Hyphen]line"}], 
               Blue}, {{$CellContext`x, 
                If[$CellContext`cond1$, 
                 $CellContext`opertRect$[$CellContext`x], 
                 $CellContext`OpRect$[$CellContext`x]]}, {
                
                If[$CellContext`cond1$, $CellContext`xpinch$, \
$CellContext`xi$], $CellContext`xd$$}, "rectifying section", 
               RGBColor[1, 0.4, 0]}, {{$CellContext`x, 
                If[$CellContext`cond1$, 
                 $CellContext`opertStrp$[$CellContext`x], 
                 $CellContext`OpStrp$[$CellContext`x]]}, {$CellContext`xb$$, 
                
                If[$CellContext`cond1$, $CellContext`xpinch$, \
$CellContext`xi$]}, "stripping section", 
               Hue[0.9]}}, {1}], 
            Apply[Mouseover[{
               Thickness[0.02], Transparent, #}, 
              Text[
               Framed[
                Style[#2, 18], Background -> LightYellow], {0.15, 
               0.9}]]& , {{{$CellContext`Ry$, $CellContext`Rx$, 
                
                If[$CellContext`cond2$, {$CellContext`Sy$, $CellContext`Sx$}, \
{}]}, "equilibrium stages"}, {
               Line[{{
                  $CellContext`xS$[$CellContext`nS$ + 1], 
                  $CellContext`yS$[$CellContext`nS$]}, {
                  $CellContext`xS$[$CellContext`nS$ + 1], 0}}], "bottoms"}, {
               Line[{{
                  $CellContext`xR$[0], 
                  $CellContext`yR$[0]}, {
                  $CellContext`xR$[0], 0}}], "distillate"}, {
               Line[{{0.5, 0.5}, {0.5, 0}}], "feed"}}, {1}]}]; Grid[{{
            Text[
             Style[
              If[$CellContext`yi$ < $CellContext`equilb$[$CellContext`xi$], 
               
               Row[{"equilibrium stages needed = ", $CellContext`nT$, 
                 " (including reboiler)"}], 
               "equilibrium stages needed = infinite (pinch point)"], 17]], 
            SpanFromLeft}, {
            Show[$CellContext`xybase$, 
             If[$CellContext`window$$, {}, $CellContext`mouse$], ImageSize -> {
               If[$CellContext`window$$, 310, 591], 400}], 
            If[$CellContext`window$$, $CellContext`diagram$, Nothing]}}]], 
      "Specifications" :> {{{$CellContext`window$$, True, 
          "view process flow diagram"}, {True, False}, ControlPlacement -> 
         1}, {{$CellContext`dir$$, 2, "    number stages"}, {
         1 -> " top to bottom ", 2 -> " bottom to top "}, ControlType -> 
         Setter, ControlPlacement -> 2}, {{$CellContext`R$$, 2., 
          Row[{"external reflux ratio ", 
            Style["L", Italic], "/", 
            Style["D", Italic]}]}, 0.25, 10, 0.25, Appearance -> "Labeled", 
         ControlPlacement -> 3}, {{$CellContext`xd$$, 0.88, 
          Row[{"distillate ", 
            Subscript[
             Style["x", Italic], "D"]}]}, 0.8, 0.98, 0.01, Appearance -> 
         "Labeled", ImageSize -> Small, ControlPlacement -> 
         4}, {{$CellContext`xb$$, 0.14, 
          Row[{"desired bottoms ", 
            Subscript[
             Style["x", Italic], "B"]}]}, 0.05, 0.2, 0.01, Appearance -> 
         "Labeled", ImageSize -> Small, ControlPlacement -> 5}, 
        Grid[{{
           Manipulate`Place[1], SpanFromLeft, 
           Manipulate`Place[2], SpanFromLeft}, {
           Manipulate`Place[3], SpanFromLeft}, {
           Style["mole fractions:", Bold], 
           Manipulate`Place[4], SpanFromLeft, 
           Manipulate`Place[5]}}, Alignment -> Left]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{646., {277., 282.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->1212173444],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`dir$$ = 1, $CellContext`R$$ = 
    0.25, $CellContext`window$$ = False, $CellContext`xb$$ = 
    0.1, $CellContext`xd$$ = 0.8500000000000001, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`window$$], False, "view process flow diagram"}, {
      True, False}}, {{
       Hold[$CellContext`dir$$], 1, "    number stages"}, {
      1 -> " top to bottom ", 2 -> " bottom to top "}}, {{
       Hold[$CellContext`R$$], 0.25, 
       Row[{"external reflux ratio ", 
         Style["L", Italic], "/", 
         Style["D", Italic]}]}, 0.25, 10, 0.25}, {{
       Hold[$CellContext`xd$$], 0.8500000000000001, 
       Row[{"distillate ", 
         Subscript[
          Style["x", Italic], "D"]}]}, 0.8, 0.98, 0.01}, {{
       Hold[$CellContext`xb$$], 0.1, 
       Row[{"desired bottoms ", 
         Subscript[
          Style["x", Italic], "B"]}]}, 0.05, 0.2, 0.01}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], SpanFromLeft, 
          Manipulate`Place[2], SpanFromLeft}, {
          Manipulate`Place[3], SpanFromLeft}, {
          Style["mole fractions:", Bold], 
          Manipulate`Place[4], SpanFromLeft, 
          Manipulate`Place[5]}}, Alignment -> Left]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    603., {208.3544921875, 213.6455078125}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`window$330427$$ = False, $CellContext`dir$330428$$ = 
    False, $CellContext`R$330429$$ = 0, $CellContext`xd$330430$$ = 
    0, $CellContext`xb$330431$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`dir$$ = 1, $CellContext`R$$ = 
        0.25, $CellContext`window$$ = False, $CellContext`xb$$ = 
        0.1, $CellContext`xd$$ = 0.8500000000000001}, "ControllerVariables" :> {
        Hold[$CellContext`window$$, $CellContext`window$330427$$, False], 
        Hold[$CellContext`dir$$, $CellContext`dir$330428$$, False], 
        Hold[$CellContext`R$$, $CellContext`R$330429$$, 0], 
        Hold[$CellContext`xd$$, $CellContext`xd$330430$$, 0], 
        Hold[$CellContext`xb$$, $CellContext`xb$330431$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`P$, $CellContext`Psat1$, $CellContext`Psat2$, \
$CellContext`A12$, $CellContext`A21$, $CellContext`\[Gamma]1$, $CellContext`\
\[Gamma]2$, $CellContext`equilb$, $CellContext`zf$, $CellContext`q$, \
$CellContext`feed$, $CellContext`xpinch$, $CellContext`ypinch$, \
$CellContext`opertRect$, $CellContext`opertStrp$, $CellContext`OpRect$, \
$CellContext`xi$, $CellContext`yi$, $CellContext`cond1$, $CellContext`cond2$, \
$CellContext`OpStrp$, $CellContext`i$, $CellContext`yR$, $CellContext`xR$, \
$CellContext`x1$, $CellContext`y1$, $CellContext`nR$, $CellContext`yS$, \
$CellContext`xS$, $CellContext`nS$, $CellContext`nT$, $CellContext`distflow$, \
$CellContext`botflow$, $CellContext`Ry$, $CellContext`Rx$, $CellContext`Sy$, \
$CellContext`Sx$, $CellContext`Sr$, $CellContext`xybase$, \
$CellContext`diagram$, $CellContext`mouse$}, $CellContext`P$ = 
         760; $CellContext`Psat1$[
           Pattern[$CellContext`temp, 
            Blank[]]] := 
         10^(8.08097 - 1582.271/(
           239.726 + $CellContext`temp)); $CellContext`Psat2$[
           Pattern[$CellContext`temp, 
            Blank[]]] := 
         10^(8.07131 - 1730.63/(
           233.426 + $CellContext`temp)); $CellContext`A12$ = 
         0.7923; $CellContext`A21$ = 0.5434; $CellContext`\[Gamma]1$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Exp[(1 - $CellContext`x$)^2 ($CellContext`A12$ + 
            2 ($CellContext`A21$ - $CellContext`A12$) $CellContext`x$)]; \
$CellContext`\[Gamma]2$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Exp[$CellContext`x$^2 ($CellContext`A21$ + 
            2 ($CellContext`A12$ - $CellContext`A21$) (
              1 - $CellContext`x$))]; $CellContext`equilb$ = Quiet[
           Interpolation[
            Map[{#, 
              ReplaceAll[$CellContext`y, 
               Quiet[
                
                FindRoot[{$CellContext`y == # $CellContext`\[Gamma]1$[#] \
$CellContext`Psat1$[$CellContext`temp]/$CellContext`P$, $CellContext`P$ == # \
$CellContext`\[Gamma]1$[#] $CellContext`Psat1$[$CellContext`temp] + (
                    1 - #) $CellContext`\[Gamma]2$[#] \
$CellContext`Psat2$[$CellContext`temp]}, {{$CellContext`y, 
                   0}, {$CellContext`temp, 60}}]]]}& , 
             Range[0, 1, 0.05]]]]; $CellContext`zf$ = 0.5; $CellContext`q$ = 
         0.5; $CellContext`feed$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         If[$CellContext`q$ != 
           1, ($CellContext`q$/($CellContext`q$ - 
             1)) $CellContext`x$ - $CellContext`zf$/($CellContext`q$ - 1), 
           1000000 ($CellContext`x$ - $CellContext`zf$) + $CellContext`zf$]; \
$CellContext`xpinch$ = ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`feed$[$CellContext`x] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
              0.5}]]]; $CellContext`ypinch$ = \
$CellContext`feed$[$CellContext`xpinch$]; $CellContext`opertRect$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`ypinch$ + (($CellContext`x$ - \
$CellContext`xpinch$)/($CellContext`xd$$ - $CellContext`xpinch$)) \
($CellContext`xd$$ - $CellContext`ypinch$); $CellContext`opertStrp$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`ypinch$ + (($CellContext`x$ - \
$CellContext`xpinch$)/($CellContext`xb$$ - $CellContext`xpinch$)) \
($CellContext`xb$$ - $CellContext`ypinch$); $CellContext`OpRect$[
           Pattern[$CellContext`x$, 
            Blank[]]] := ($CellContext`R$$/($CellContext`R$$ + 
            1)) $CellContext`x$ + $CellContext`xd$$/($CellContext`R$$ + 
           1); $CellContext`xi$ = ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`feed$[$CellContext`x] == \
$CellContext`OpRect$[$CellContext`x], {$CellContext`x, 
              0.7}]]]; $CellContext`yi$ = \
$CellContext`OpRect$[$CellContext`xi$]; $CellContext`cond1$ = \
$CellContext`yi$ >= $CellContext`equilb$[$CellContext`xi$]; \
$CellContext`cond2$ = $CellContext`yi$ < \
$CellContext`equilb$[$CellContext`xi$]; 
        If[$CellContext`cond1$, {$CellContext`OpStrp$[
              Pattern[$CellContext`x$, 
               
               Blank[]]] := $CellContext`opertStrp$[$CellContext`x$]; \
$CellContext`i$ = 
            0; $CellContext`yR$[0] = $CellContext`xd$$; $CellContext`xR$[
             0] = $CellContext`xd$$; 
           While[$CellContext`i$ < 
             25, {$CellContext`x1$ = ReplaceAll[$CellContext`x, 
                Quiet[
                 
                 FindRoot[$CellContext`yR$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
                   0.5}]]], $CellContext`y1$ = \
$CellContext`opertRect$[$CellContext`x1$], 
              
              If[$CellContext`x1$ > $CellContext`xpinch$, \
{$CellContext`xR$[$CellContext`i$ + 
                  1] = $CellContext`x1$, $CellContext`yR$[$CellContext`i$ + 
                  1] = $CellContext`y1$}], 
              
              Increment[$CellContext`i$]}]; $CellContext`nR$ = \
$CellContext`i$ - 1; $CellContext`i$ = 0; 
           If[$CellContext`nR$ >= 
             0, {$CellContext`yS$[
                0] = $CellContext`yR$[$CellContext`nR$]; $CellContext`xS$[
                0] = $CellContext`xR$[$CellContext`nR$]}]; 
           While[$CellContext`i$ < 
             20, {$CellContext`x1$ = ReplaceAll[$CellContext`x, 
                Quiet[
                 
                 FindRoot[$CellContext`yS$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
                   0.5}]]], $CellContext`y1$ = \
$CellContext`opertStrp$[$CellContext`x1$], $CellContext`xS$[$CellContext`i$ + 
                1] = $CellContext`x1$, $CellContext`yS$[$CellContext`i$ + 
                1] = $CellContext`y1$, 
              
              Increment[$CellContext`i$]}]; $CellContext`nS$ = \
$CellContext`i$ - 1; Null}, {$CellContext`OpStrp$[
              Pattern[$CellContext`x$, 
               
               Blank[]]] := $CellContext`yi$ + (($CellContext`x$ - \
$CellContext`xi$)/($CellContext`xb$$ - $CellContext`xi$)) ($CellContext`xb$$ - \
$CellContext`yi$); $CellContext`i$ = 
            0; $CellContext`yR$[0] = $CellContext`xd$$; $CellContext`xR$[
             0] = $CellContext`xd$$; 
           While[$CellContext`xR$[$CellContext`i$] > $CellContext`xi$, \
{$CellContext`x1$ = ReplaceAll[$CellContext`x, 
                Quiet[
                 
                 FindRoot[$CellContext`yR$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
                   0.7}]]], $CellContext`y1$ = \
$CellContext`OpRect$[$CellContext`x1$], 
              
              If[$CellContext`x1$ > $CellContext`xi$, \
{$CellContext`xR$[$CellContext`i$ + 
                  1] = $CellContext`x1$, $CellContext`yR$[$CellContext`i$ + 
                  1] = $CellContext`y1$}], 
              
              Increment[$CellContext`i$]}]; $CellContext`nR$ = \
$CellContext`i$ - 1; $CellContext`i$ = 0; 
           If[$CellContext`nR$ >= 
             0, $CellContext`yS$[
               0] = $CellContext`yR$[$CellContext`nR$]; $CellContext`xS$[
               0] = $CellContext`xR$[$CellContext`nR$]]; 
           While[$CellContext`xS$[$CellContext`i$] > $CellContext`xb$$, \
{$CellContext`x1$ = ReplaceAll[$CellContext`x, 
                Quiet[
                 
                 FindRoot[$CellContext`yS$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
                   0.5}]]], $CellContext`y1$ = \
$CellContext`OpStrp$[$CellContext`x1$], $CellContext`xS$[$CellContext`i$ + 
                1] = $CellContext`x1$, $CellContext`yS$[$CellContext`i$ + 
                1] = $CellContext`y1$, 
              
              Increment[$CellContext`i$]}]; $CellContext`nS$ = \
$CellContext`i$ - 1; 
           Null}]; $CellContext`nT$ = $CellContext`nR$ + $CellContext`nS$ + 
          1; $CellContext`distflow$ = ($CellContext`zf$ - \
$CellContext`xS$[$CellContext`nS$ + 
            1])/$CellContext`xd$$; $CellContext`botflow$ = 
         1 - $CellContext`distflow$; $CellContext`Ry$ = Map[Line[{{
              $CellContext`xR$[#], 
              $CellContext`yR$[# - 1]}, {
              $CellContext`xR$[#], 
              $CellContext`yR$[#]}}]& , 
           Range[$CellContext`nR$]]; $CellContext`Rx$ = Map[Line[{{
              $CellContext`xR$[#], 
              $CellContext`yR$[#]}, {
              $CellContext`xR$[# + 1], 
              $CellContext`yR$[#]}}]& , 
           If[$CellContext`nR$ >= 1, 
            Range[0, $CellContext`nR$ - 1], {0}]]; $CellContext`Sy$ = 
         Map[Line[{{
              $CellContext`xS$[# + 1], 
              $CellContext`yS$[#]}, {
              $CellContext`xS$[# + 1], 
              $CellContext`yS$[# + 1]}}]& , 
           Range[0, $CellContext`nS$ - 1]]; $CellContext`Sx$ = Map[Line[{{
              $CellContext`xS$[# - 1], 
              $CellContext`yS$[# - 1]}, {
              $CellContext`xS$[#], 
              $CellContext`yS$[# - 1]}}]& , 
           Range[$CellContext`nS$ + 1]]; $CellContext`Sr$ = Line[{{
             $CellContext`xS$[$CellContext`nS$ + 1], 
             $CellContext`yS$[$CellContext`nS$]}, {
             $CellContext`xS$[$CellContext`nS$ + 1], 
             0}}]; $CellContext`xybase$ = Show[
           Plot[{
             $CellContext`equilb$[$CellContext`x], $CellContext`x}, \
{$CellContext`x, 0, 1}, PlotStyle -> {{Thick, Red}, {Thick, 
               RGBColor[0, 0.6, 0]}}, PlotRange -> {{0, 1}, {0, 1}}], 
           If[$CellContext`cond1$, {
             Plot[
              $CellContext`feed$[$CellContext`x], {$CellContext`x, \
$CellContext`xpinch$, $CellContext`zf$}, PlotStyle -> {Thick, Blue}], 
             Plot[
              $CellContext`opertRect$[$CellContext`x], {$CellContext`x, \
$CellContext`xpinch$, $CellContext`xd$$}, PlotStyle -> {Thick, 
                RGBColor[1, 0.4, 0]}], 
             Plot[
              $CellContext`opertStrp$[$CellContext`x], {$CellContext`x, \
$CellContext`xb$$, $CellContext`xpinch$}, PlotStyle -> {Thick, 
                Hue[0.9]}]}, {
             Plot[
              $CellContext`feed$[$CellContext`x], {$CellContext`x, \
$CellContext`xi$, $CellContext`zf$}, PlotStyle -> {Thick, Blue}], 
             Plot[
              $CellContext`OpRect$[$CellContext`x], {$CellContext`x, \
$CellContext`xi$, $CellContext`xd$$}, PlotStyle -> {Thick, 
                RGBColor[1, 0.4, 0]}], 
             Plot[
              $CellContext`OpStrp$[$CellContext`x], {$CellContext`x, \
$CellContext`xb$$, $CellContext`xi$}, PlotStyle -> {Thick, 
                Hue[0.9]}]}], 
           Graphics[{{Thick, $CellContext`Ry$, $CellContext`Rx$, 
              
              If[$CellContext`cond2$, {$CellContext`Sy$, $CellContext`Sx$}, \
{}]}, 
             If[$CellContext`cond2$, {
               Map[Text[
                 Style[
                  
                  If[$CellContext`dir$$ == 
                   1, #, $CellContext`nR$ + $CellContext`nS$ + 1 - #], 18], {
                  $CellContext`xR$[#], 
                  $CellContext`yR$[# - 1]}, {1, -1}]& , 
                Range[$CellContext`nR$]], 
               Map[Text[
                 Style[
                  
                  If[$CellContext`dir$$ == 
                   1, $CellContext`nR$ + #, $CellContext`nS$ + 1 - #], 18], {
                  $CellContext`xS$[#], 
                  $CellContext`yS$[# - 1]}, {1, -1}]& , 
                Range[$CellContext`nS$]], 
               Text[
                Style["R", 18], {
                 $CellContext`xS$[$CellContext`nS$ + 1], 
                 $CellContext`yS$[$CellContext`nS$]}, {1, -1}], {Dashed, 
                Map[
                Line[{{#, 
                    0}, {#, #}}]& , {$CellContext`zf$, $CellContext`xd$$}], \
$CellContext`Sr$}, 
               (ReplaceAll[
                Text[
                 Style[
                  Row[{
                    Subscript[
                    Style["x", Italic], "B"], " = ", 
                    NumberForm[
                    $CellContext`xS$[$CellContext`nS$ + 1], 2]}], 17, 
                  Hue[0.9], Background -> White], {
                  If[# < $CellContext`test, 0, #], 0.05}, {
                  If[# < $CellContext`test, -1, 0], 0}], $CellContext`test -> 
                If[$CellContext`window$$, 0.15, 0.06]]& )[
                $CellContext`xS$[$CellContext`nS$ + 1]], 
               (ReplaceAll[
                Text[
                 Style[
                  Row[{
                    Subscript[
                    Style["x", Italic], "D"], " = ", 
                    NumberForm[
                    $CellContext`xR$[0], 2]}], 17, 
                  RGBColor[1, 0.4, 0], Background -> White], {
                  If[# > $CellContext`test, 1, #], 0.05}, {
                  If[# > $CellContext`test, 1, 0], 0}], $CellContext`test -> 
                If[$CellContext`window$$, 0.86, 0.94]]& )[
                $CellContext`xR$[0]], 
               Text[
                Style[
                 Row[{
                   Subscript[
                    Style["z", Italic], "F"], " = ", $CellContext`zf$}], 17, 
                 Blue, Background -> White], {$CellContext`zf$, 0.15}]}]}], 
           Frame -> True, FrameLabel -> {
             Row[{"liquid mole fraction ", 
               Style["x", Italic]}], 
             Row[{"vapor mole fraction ", 
               Style["y", Italic]}]}, LabelStyle -> {17, Black}, AspectRatio -> 
           Full, PlotRangePadding -> {0.02, {None, 0.05}}, 
           ImagePadding -> {{55, 10}, {50, 10}}]; $CellContext`diagram$ = 
         Graphics[{{Thick, 
             Map[Line[{{#, 0}, {#, 3}}]& , {0, 1}], 
             Circle[{0.5, 3}, {0.5, 0.15}, {0, Pi}], 
             Circle[{0.5, 0}, {0.5, 0.15}, {Pi, 2 Pi}]}, {Thick, 
             Arrowheads[0.07], 
             Arrow[{{0.5, -0.15}, {0.5, -0.5}, {1.25, -0.5}}], 
             Arrow[{{1.5, -0.35}, {1.5, 0}, {1, 0}}], {
              Hue[0.9], 
              Arrow[{{1.75, -0.5}, {3, -0.5}}]}, 
             Arrow[{{0.5, 3.15}, {0.5, 3.5}, {1.6, 3.5}, {1.6, 3.15}}], {
              RGBColor[1, 0.4, 0], 
              Line[{{1.6, 2.85}, {1.6, 2.7}}], 
              Arrowheads[{-0.07, 0.07}], 
              Arrow[{{1, 2.7}, {3, 2.7}}]}, 
             
             If[$CellContext`yi$ < $CellContext`equilb$[$CellContext`xi$], {{
               Blue, 
                
                Arrow[{{-1.5, 3 (2 $CellContext`nS$ + 1)/(
                   2 $CellContext`nT$)}, {
                  0, 3 (2 $CellContext`nS$ + 1)/(2 $CellContext`nT$)}}]}, 
               Map[{
                 Text[
                  Style[
                   If[$CellContext`dir$$ == 1, $CellContext`nT$ - #, #], 
                   17], {0.5, 3 (#/$CellContext`nT$)}, {0, -1.1}], 
                 
                 Line[{{0, 3 (#/$CellContext`nT$)}, {
                   1, 3 (#/$CellContext`nT$)}}]}& , 
                Range[$CellContext`nT$ - 1]]}, {Blue, 
               Arrow[{{-1.5, 1.5}, {0, 1.5}}]}]}, {
             Arrowheads[0.05], 
             Arrow[{{1.1, -0.75}, {1.9, -0.25}}], 
             Arrow[
              BezierCurve[{{1.9, 3.25}, {1.6, 2.9}, {1.3, 3.25}}]]}, 
            Apply[{
              EdgeForm[Thick], 
              FaceForm[None], 
              Disk[#2, {0.26, 0.15}], 
              Text[
               Style[#, 17, Background -> White], #2]}& , {{
              "R", {1.5, -0.5}}, {"C", {1.6, 3}}}, {1}], 
            Text[
             Style[
              Column[{"feed rate", "1.00 kmol/h", 
                Spacer[1], 
                Row[{
                  Subscript[
                   Style["z", Italic], "F"], " = ", $CellContext`zf$}], 
                Row[{"quality = ", $CellContext`q$}]}, Center], 17, 
              Blue], {-0.85, 
              
              If[$CellContext`yi$ < $CellContext`equilb$[$CellContext`xi$], 
               3 (2 $CellContext`nS$ + 1)/(2 $CellContext`nT$), 1.5]}, {
             0, 0.05}], 
            Text[
             Style[
              Column[{"reflux ratio", 
                Row[{
                  Style["L", Italic], "/", 
                  Style["D", Italic], " = ", 
                  NumberForm[$CellContext`R$$, {3, 2}]}]}, Center], 17], {
             2, 2.05}], 
            Text[
             Style[
              Column[{
                Column[{"distillate flow", 
                  
                  If[$CellContext`yi$ < \
$CellContext`equilb$[$CellContext`xi$], 
                   Row[{
                    NumberForm[$CellContext`distflow$, {2, 2}], " kmol/h"}], 
                   "N/A"]}, Center], 
                Row[{
                  Subscript[
                   Style["x", Italic], "D"], " = ", 
                  $CellContext`xR$[0]}]}, Center, Spacings -> 1], 17, 
              RGBColor[1, 0.4, 0]], {2.8, 2.81}], 
            Text[
             Style[
              Column[{
                Column[{"bottoms flow", 
                  
                  If[$CellContext`yi$ < \
$CellContext`equilb$[$CellContext`xi$], 
                   Row[{
                    NumberForm[$CellContext`botflow$, {2, 2}], " kmol/h"}], 
                   "N/A"]}, Center], 
                Row[{
                  Subscript[
                   Style["x", Italic], "B"], " = ", 
                  NumberForm[
                   $CellContext`xS$[$CellContext`nS$ + 1], 2]}]}, Center, 
               Spacings -> 1], 17, 
              Hue[0.9]], {2.8, -0.39}]}, ImageSize -> {285, 400}, AspectRatio -> 
           Full]; $CellContext`mouse$ = Graphics[{
            Apply[Mouseover[{
               Thickness[0.02], Transparent, 
               Line[
                Table[#, {$CellContext`x, 
                  First[#2], 
                  Last[#2], 0.05}]]}, 
              Text[
               Framed[
                Style[#3, 18, #4], Background -> LightYellow], {0.15, 
               0.9}]]& , {{{$CellContext`x, $CellContext`x}, {0, 1}, 
               Row[{
                 Style["x", Italic], " = ", 
                 Style["y", Italic], " line"}], 
               RGBColor[0, 0.6, 0]}, {{$CellContext`x, 
                $CellContext`equilb$[$CellContext`x]}, {0, 1}, 
               "equilibrium curve", Red}, {{$CellContext`x, 
                $CellContext`feed$[$CellContext`x]}, {
                
                If[$CellContext`cond1$, $CellContext`xpinch$, \
$CellContext`xi$], $CellContext`zf$}, 
               Row[{
                 Style["q", Italic], "\[Hyphen]line"}], 
               Blue}, {{$CellContext`x, 
                If[$CellContext`cond1$, 
                 $CellContext`opertRect$[$CellContext`x], 
                 $CellContext`OpRect$[$CellContext`x]]}, {
                
                If[$CellContext`cond1$, $CellContext`xpinch$, \
$CellContext`xi$], $CellContext`xd$$}, "rectifying section", 
               RGBColor[1, 0.4, 0]}, {{$CellContext`x, 
                If[$CellContext`cond1$, 
                 $CellContext`opertStrp$[$CellContext`x], 
                 $CellContext`OpStrp$[$CellContext`x]]}, {$CellContext`xb$$, 
                
                If[$CellContext`cond1$, $CellContext`xpinch$, \
$CellContext`xi$]}, "stripping section", 
               Hue[0.9]}}, {1}], 
            Apply[Mouseover[{
               Thickness[0.02], Transparent, #}, 
              Text[
               Framed[
                Style[#2, 18], Background -> LightYellow], {0.15, 
               0.9}]]& , {{{$CellContext`Ry$, $CellContext`Rx$, 
                
                If[$CellContext`cond2$, {$CellContext`Sy$, $CellContext`Sx$}, \
{}]}, "equilibrium stages"}, {
               Line[{{
                  $CellContext`xS$[$CellContext`nS$ + 1], 
                  $CellContext`yS$[$CellContext`nS$]}, {
                  $CellContext`xS$[$CellContext`nS$ + 1], 0}}], "bottoms"}, {
               Line[{{
                  $CellContext`xR$[0], 
                  $CellContext`yR$[0]}, {
                  $CellContext`xR$[0], 0}}], "distillate"}, {
               Line[{{0.5, 0.5}, {0.5, 0}}], "feed"}}, {1}]}]; Grid[{{
            Text[
             Style[
              If[$CellContext`yi$ < $CellContext`equilb$[$CellContext`xi$], 
               
               Row[{"equilibrium stages needed = ", $CellContext`nT$, 
                 " (including reboiler)"}], 
               "equilibrium stages needed = infinite (pinch point)"], 17]], 
            SpanFromLeft}, {
            Show[$CellContext`xybase$, 
             If[$CellContext`window$$, {}, $CellContext`mouse$], ImageSize -> {
               If[$CellContext`window$$, 310, 591], 400}], 
            If[$CellContext`window$$, $CellContext`diagram$, Nothing]}}]], 
      "Specifications" :> {{{$CellContext`window$$, False, 
          "view process flow diagram"}, {True, False}, ControlPlacement -> 
         1}, {{$CellContext`dir$$, 1, "    number stages"}, {
         1 -> " top to bottom ", 2 -> " bottom to top "}, ControlType -> 
         Setter, ControlPlacement -> 2}, {{$CellContext`R$$, 0.25, 
          Row[{"external reflux ratio ", 
            Style["L", Italic], "/", 
            Style["D", Italic]}]}, 0.25, 10, 0.25, Appearance -> "Labeled", 
         ControlPlacement -> 3}, {{$CellContext`xd$$, 0.8500000000000001, 
          Row[{"distillate ", 
            Subscript[
             Style["x", Italic], "D"]}]}, 0.8, 0.98, 0.01, Appearance -> 
         "Labeled", ImageSize -> Small, ControlPlacement -> 
         4}, {{$CellContext`xb$$, 0.1, 
          Row[{"desired bottoms ", 
            Subscript[
             Style["x", Italic], "B"]}]}, 0.05, 0.2, 0.01, Appearance -> 
         "Labeled", ImageSize -> Small, ControlPlacement -> 5}, 
        Grid[{{
           Manipulate`Place[1], SpanFromLeft, 
           Manipulate`Place[2], SpanFromLeft}, {
           Manipulate`Place[3], SpanFromLeft}, {
           Style["mole fractions:", Bold], 
           Manipulate`Place[4], SpanFromLeft, 
           Manipulate`Place[5]}}, Alignment -> Left]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{646., {277., 282.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->1969197866]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "DetailsSection"],

Cell["\<\
The McCabe\[Dash]Thiele graphical solution method for binary distillation is \
used to determine the number of equilibrium stages needed to achieve a \
specified separation in a distillation column. This method assumes: \
\>", "DetailNotes",
 CellChangeTimes->{{3.6764836855195093`*^9, 3.676483686241996*^9}, {
   3.6764837229709883`*^9, 3.676483801144796*^9}, {3.676484208985889*^9, 
   3.676484292825663*^9}, {3.6764843498604507`*^9, 3.6764843504218388`*^9}, {
   3.679176590575749*^9, 3.679176597007991*^9}, {3.6796555622816963`*^9, 
   3.6796556032297564`*^9}, 3.6796556425293694`*^9, {3.6816551956197796`*^9, 
   3.6816552069514*^9}, {3.6826933175814285`*^9, 3.682693339472233*^9}, 
   3.684240336671339*^9, {3.684240375978819*^9, 3.684240377204012*^9}},
 CellID->1224384310],

Cell["1. The distillation column is adiabatic.", "DetailNotes",
 CellChangeTimes->{{3.6764836855195093`*^9, 3.676483686241996*^9}, {
  3.6764837229709883`*^9, 3.676483801144796*^9}, {3.676484208985889*^9, 
  3.676484295403784*^9}, {3.676484422381997*^9, 3.6764844523721724`*^9}, {
  3.679655607719017*^9, 3.6796556264626265`*^9}, {3.6826933476120467`*^9, 
  3.6826933483763857`*^9}, {3.684071917791325*^9, 3.684071922239135*^9}},
 CellID->2068001857],

Cell["\<\
2. Constant molar overflow (CMO), which means that for every mole of vapor \
condensed, one mole of liquid is vaporized. This results in constant liquid \
and vapor flow rates between stages (the exception being the flow rates of \
the stages above and below the feed stream, which are not equal). This \
assumption requires that:\
\>", "DetailNotes",
 CellChangeTimes->{{3.6764836855195093`*^9, 3.676483686241996*^9}, {
   3.6764837229709883`*^9, 3.676483801144796*^9}, {3.676484208985889*^9, 
   3.676484295403784*^9}, {3.676484422381997*^9, 3.676484456276331*^9}, {
   3.676484503206237*^9, 3.67648451246283*^9}, {3.676484550067234*^9, 
   3.676484732401277*^9}, {3.676484794407113*^9, 3.676484958034377*^9}, {
   3.676485023568264*^9, 3.676485111254067*^9}, {3.676485187148814*^9, 
   3.6764852239547787`*^9}, {3.676485264176264*^9, 3.676485264181322*^9}, 
   3.6791767043551984`*^9, {3.6791768909036303`*^9, 3.67917690897907*^9}, 
   3.679655705263569*^9, {3.6796557543353004`*^9, 3.679655790623124*^9}, {
   3.681583750678505*^9, 3.6815837531629095`*^9}, {3.6816552433509064`*^9, 
   3.681655269890976*^9}, {3.6842403952605953`*^9, 3.6842404203259363`*^9}},
 CellID->1246656247],

Cell[TextData[{
 "2a. Specific heat changes are small compared to latent heat changes between \
stages ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[LeftBracketingBar]", 
     RowBox[{
      SubscriptBox["H", 
       RowBox[{"i", "+", "1"}]], "-", 
      SubscriptBox["H", "i"]}], "\[RightBracketingBar]"}], "\[LessLess]", 
    SubscriptBox["\[Lambda]", "vap"]}], TraditionalForm]], "InlineMath"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[LeftBracketingBar]", 
     RowBox[{
      SubscriptBox["h", 
       RowBox[{"i", "+", "1"}]], "-", 
      SubscriptBox["h", "i"]}], "\[RightBracketingBar]"}], "\[LessLess]", 
    SubscriptBox["\[Lambda]", "vap"]}], TraditionalForm]], "InlineMath"],
 "."
}], "DetailNotes",
 CellChangeTimes->{{3.6764836855195093`*^9, 3.676483686241996*^9}, {
   3.6764837229709883`*^9, 3.676483801144796*^9}, {3.676484208985889*^9, 
   3.676484295403784*^9}, {3.676484422381997*^9, 3.676484456276331*^9}, {
   3.676484503206237*^9, 3.67648451246283*^9}, {3.676484550067234*^9, 
   3.676484732401277*^9}, {3.676484794407113*^9, 3.676484958034377*^9}, {
   3.676485023568264*^9, 3.676485111254067*^9}, {3.676485187148814*^9, 
   3.6764852239547787`*^9}, {3.676485264176264*^9, 3.676485264181322*^9}, 
   3.6791767043551984`*^9, {3.6791768909036303`*^9, 3.67917690897907*^9}, 
   3.679655705263569*^9, {3.6796557543353004`*^9, 3.679655790623124*^9}, {
   3.681583750678505*^9, 3.6815837531629095`*^9}, {3.6816552433509064`*^9, 
   3.681655269890976*^9}, {3.6842403952605953`*^9, 3.684240469275427*^9}, 
   3.684240947696431*^9},
 CellID->1894578964],

Cell[TextData[{
 "2b. Heat of vaporization ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Lambda]", "vap"], TraditionalForm]], "InlineMath"],
 " is the same for both components and thus independent of concentration."
}], "DetailNotes",
 CellChangeTimes->{{3.6764836855195093`*^9, 3.676483686241996*^9}, {
   3.6764837229709883`*^9, 3.676483801144796*^9}, {3.676484208985889*^9, 
   3.676484295403784*^9}, {3.676484422381997*^9, 3.676484456276331*^9}, {
   3.676484503206237*^9, 3.67648451246283*^9}, {3.676484550067234*^9, 
   3.676484732401277*^9}, {3.676484794407113*^9, 3.676484958034377*^9}, {
   3.676485023568264*^9, 3.676485111254067*^9}, {3.676485187148814*^9, 
   3.6764852239547787`*^9}, {3.676485264176264*^9, 3.676485264181322*^9}, 
   3.6791767043551984`*^9, {3.6791768909036303`*^9, 3.67917690897907*^9}, 
   3.679655705263569*^9, {3.6796557543353004`*^9, 3.679655790623124*^9}, {
   3.681583750678505*^9, 3.6815837531629095`*^9}, {3.6816552433509064`*^9, 
   3.681655269890976*^9}, {3.6842403952605953`*^9, 3.684240427582086*^9}, 
   3.684240475990819*^9, 3.684240949731552*^9},
 CellID->1110576016],

Cell["3. Heat of mixing is negligible.", "DetailNotes",
 CellChangeTimes->{{3.6828001348411045`*^9, 3.6828001351687055`*^9}, 
   3.682800215259367*^9},
 CellID->372290207],

Cell["\<\
The equilibrium curve was calculated using the modified Raoult's law:\
\>", "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
  3.681583821108074*^9, 3.681583838668726*^9}},
 CellID->613959288],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"P", "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      SubscriptBox["\[Gamma]", "1"], " ", 
      SubsuperscriptBox["P", "1", "sat"]}], "+", 
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["\[Gamma]", "2"], " ", 
      SubsuperscriptBox["P", "2", "sat"]}]}]}], TraditionalForm]], 
  "InlineMath"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
  3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
  3.6815839032701855`*^9}, {3.6815840680532017`*^9, 3.6815840722496095`*^9}, {
  3.681655317914464*^9, 3.6816553192716665`*^9}},
 CellID->182840712],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["y", "i"], " ", "P"}], "=", 
    RowBox[{
     SubscriptBox["x", "i"], " ", 
     SubscriptBox["\[Gamma]", "i"], " ", 
     SubsuperscriptBox["P", "i", "sat"]}]}], TraditionalForm]], "InlineMath"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
  3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
  3.681583930637638*^9}, {3.6815840748276143`*^9, 3.6815840778570194`*^9}, {
  3.6816554094474764`*^9, 3.681655415703087*^9}, {3.6816557436751423`*^9, 
  3.6816557458299465`*^9}},
 CellID->171734077],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "i"], TraditionalForm]], "InlineMath"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", "i"], TraditionalForm]], "InlineMath"],
 " are the liquid and vapor mole fractions (",
 Cell[BoxData[
  FormBox[
   RowBox[{"i", "=", "1"}], TraditionalForm]], "InlineMath"],
 " for methanol, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"i", "=", "2"}], TraditionalForm]], "InlineMath"],
 " for water), ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["x", "1"], "+", 
     SubscriptBox["x", "2"]}], "=", "1"}], TraditionalForm]], "InlineMath"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["y", "1"], "+", 
     SubscriptBox["y", "2"]}], "=", "1"}], TraditionalForm]], "InlineMath"],
 ", ",
 Cell[BoxData[
  FormBox["P", TraditionalForm]], "InlineMath"],
 " is total pressure and ",
 Cell[BoxData[
  FormBox[Cell[TextData[Cell[BoxData[
    FormBox[
     SubsuperscriptBox["P", "i", "sat"], TraditionalForm]], "InlineMath"]], 
    "InlineMath"], TraditionalForm]], "InlineMath"],
 " is the saturation pressure, which is calculated using the Antoine equation:"
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
   3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
   3.6815839580785046`*^9}, {3.681655335263298*^9, 3.681655470192815*^9}, {
   3.681655757198767*^9, 3.6816557706083937`*^9}, {3.682693436044643*^9, 
   3.6826934831779604`*^9}, 3.684240507255883*^9},
 CellID->417910946],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["P", "i", "sat"], "=", 
    SuperscriptBox["10", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["A", "i"], "-", 
       FractionBox[
        SubscriptBox["B", "i"], 
        RowBox[{"T", "+", 
         SubscriptBox["C", "i"]}]]}], ")"}]]}], TraditionalForm]], 
  "InlineMath"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
  3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
  3.6815839823271804`*^9}, {3.684514154179325*^9, 3.68451416745365*^9}},
 CellID->142476940],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]], "InlineMath"],
 " is temperature, and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["A", "i"], TraditionalForm]], "InlineMath"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["B", "i"], TraditionalForm]], "InlineMath"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["C", "i"], TraditionalForm]], "InlineMath"],
 " are Antoine constants."
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
   3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
   3.681584029688101*^9}, {3.6816554767358475`*^9, 3.681655495344495*^9}, 
   3.6842405324548597`*^9},
 CellID->174539008],

Cell[TextData[{
 "The activity coefficients ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Gamma]", "i"], TraditionalForm]], "InlineMath"],
 " are calculated using the two-parameter Margules model:"
}], "DetailNotes",
 CellChangeTimes->{{3.6840720617602453`*^9, 3.684072069829464*^9}},
 CellID->421570329],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"ln", " ", 
     SubscriptBox["\[Gamma]", "1"]}], "=", 
    RowBox[{
     SubsuperscriptBox["x", "2", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["A", "12"], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["A", "21"], "-", 
          SubscriptBox["A", "12"]}], ")"}], " ", 
        SubscriptBox["x", "1"]}]}], ")"}]}]}], TraditionalForm]], 
  "InlineMath"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
  3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
  3.681584029688101*^9}, {3.6815840851456337`*^9, 3.6815841678462195`*^9}, {
  3.6816555125553427`*^9, 3.681655514162145*^9}, {3.6816556476592155`*^9, 
  3.681655653125225*^9}, {3.6925566729241257`*^9, 3.6925566729241257`*^9}},
 CellID->678020050],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"ln", " ", 
     SubscriptBox["\[Gamma]", "2"]}], "=", 
    RowBox[{
     SubsuperscriptBox["x", "1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["A", "21"], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["A", "12"], "-", 
          SubscriptBox["A", "21"]}], ")"}], " ", 
        SubscriptBox["x", "2"]}]}], ")"}]}]}], TraditionalForm]], 
  "InlineMath"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
  3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
  3.681584029688101*^9}, {3.6815840851456337`*^9, 3.681584207665309*^9}, {
  3.6816555193137627`*^9, 3.6816555220265675`*^9}, {3.6816555919459515`*^9, 
  3.681655608015385*^9}, {3.6816556987927303`*^9, 3.6816557031083384`*^9}, {
  3.6925566764649477`*^9, 3.6925566764649477`*^9}},
 CellID->1041801],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["A", "12"], "=", "0.7923"}], TraditionalForm]], "InlineMath"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["A", "21"], "=", "0.5434"}], TraditionalForm]], "InlineMath"],
 " are the Margules parameters for a methanol/water mixture."
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
   3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
   3.681584029688101*^9}, {3.6815840851456337`*^9, 3.681584244382209*^9}, {
   3.68165556187547*^9, 3.6816555810349073`*^9}, {3.6827990733635483`*^9, 
   3.6827990733635483`*^9}, {3.6828001676766496`*^9, 3.6828001687842517`*^9}, 
   3.6828002144325657`*^9, {3.684072081997102*^9, 3.684072105127761*^9}},
 CellID->248628401],

Cell["\<\
The operating lines for the rectifying and stripping sections are used to \
determine the number of stages. First the feed and rectifying operating lines \
are calculated:\
\>", "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
   3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
   3.681584029688101*^9}, {3.6815840851456337`*^9, 3.681584244382209*^9}, {
   3.68165556187547*^9, 3.6816555810349073`*^9}, 3.6827990733635483`*^9, {
   3.682799568245634*^9, 3.682799632861493*^9}},
 CellID->214837423],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", 
     StyleBox["F",
      FontSlant->"Plain"]], "=", 
    RowBox[{
     RowBox[{
      FractionBox["q", 
       RowBox[{"q", "-", "1"}]], " ", "x"}], "-", 
     FractionBox[
      SubscriptBox["z", 
       StyleBox["F",
        FontSlant->"Plain"]], 
      RowBox[{"q", "-", "1"}]]}]}], TraditionalForm]], "InlineMath"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
   3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
   3.681584029688101*^9}, {3.6815840851456337`*^9, 3.681584244382209*^9}, {
   3.68165556187547*^9, 3.6816555810349073`*^9}, 3.6827990733635483`*^9, {
   3.682799568245634*^9, 3.682799633360694*^9}, {3.6827996977626524`*^9, 
   3.6827997503852453`*^9}, {3.692556682680975*^9, 3.692556706283097*^9}},
 CellID->62774028],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", 
     StyleBox["R",
      FontSlant->"Plain"]], "=", 
    RowBox[{
     RowBox[{
      FractionBox["R", 
       RowBox[{"R", "+", "1"}]], " ", "x"}], "+", 
     FractionBox[
      SubscriptBox["x", 
       StyleBox["D",
        FontSlant->"Plain"]], 
      RowBox[{"R", "+", "1"}]]}]}], TraditionalForm]], "InlineMath"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
   3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
   3.681584029688101*^9}, {3.6815840851456337`*^9, 3.681584244382209*^9}, {
   3.68165556187547*^9, 3.6816555810349073`*^9}, 3.6827990733635483`*^9, {
   3.682799568245634*^9, 3.682799633360694*^9}, {3.6827996977626524`*^9, 
   3.682799789102975*^9}, {3.692556690210021*^9, 3.6925567162655454`*^9}},
 CellID->489852983],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox["q", TraditionalForm]], "InlineMath"],
 " is the vapor quality of the feed, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", 
    StyleBox["F",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " is the mole fraction of methanol in the feed, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    StyleBox["D",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " is the liquid mole fraction of methanol in the distillate and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"R", "=", 
    RowBox[{"L", "/", "D"}]}], TraditionalForm]], "InlineMath"],
 " is the reflux ratio."
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
   3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
   3.681584029688101*^9}, {3.6815840851456337`*^9, 3.681584244382209*^9}, {
   3.68165556187547*^9, 3.6816555810349073`*^9}, 3.6827990733635483`*^9, {
   3.682799568245634*^9, 3.682799633360694*^9}, {3.6827996977626524`*^9, 
   3.682799871664054*^9}, 3.684240588751419*^9, {3.6925567203667707`*^9, 
   3.6925567263563967`*^9}, {3.6939278990168557`*^9, 3.693927900297058*^9}},
 CellID->338672037],

Cell[TextData[{
 "The operating line for the stripping section ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", 
    StyleBox["S",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " is found by drawing a line through the bottoms composition ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    StyleBox["B",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " on the ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]], "InlineMath"],
 "\[Dash]",
 Cell[BoxData[
  FormBox["y", TraditionalForm]], "InlineMath"],
 " line and the intersection of the feed line (also called the ",
 Cell[BoxData[
  FormBox["q", TraditionalForm]], "InlineMath"],
 " line) ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", 
    StyleBox["F",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " and rectifying line ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", 
    StyleBox["R",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 ". The feed line intersects the rectifying line at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["x", "int"], ",", 
     SubscriptBox["y", "int"]}], ")"}], TraditionalForm]], "InlineMath"],
 ":"
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
   3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
   3.681584029688101*^9}, {3.6815840851456337`*^9, 3.681584244382209*^9}, {
   3.68165556187547*^9, 3.6816555810349073`*^9}, 3.6827990733635483`*^9, {
   3.682799568245634*^9, 3.682799633360694*^9}, {3.6827996977626524`*^9, 
   3.6828000315514946`*^9}, {3.6840723035832105`*^9, 3.68407231916284*^9}, {
   3.6840731130768075`*^9, 3.6840731893141804`*^9}, {3.68407341784453*^9, 
   3.684073419375333*^9}, {3.684240598889564*^9, 3.684240605639069*^9}, 
   3.6842666604852467`*^9, {3.6844964772022753`*^9, 3.684496477314076*^9}, {
   3.6925567352462444`*^9, 3.6925567598685665`*^9}},
 CellID->579065947],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "int"], "=", 
    FractionBox[
     RowBox[{
      RowBox[{
       SubscriptBox["x", 
        StyleBox["D",
         FontSlant->"Plain"]], " ", 
       RowBox[{"(", 
        RowBox[{"q", "-", "1"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["z", 
        StyleBox["F",
         FontSlant->"Plain"]], " ", 
       RowBox[{"(", 
        RowBox[{"R", "+", "1"}], ")"}]}]}], 
     RowBox[{"q", "+", "R"}]]}], TraditionalForm]], "InlineMath"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
   3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
   3.681584029688101*^9}, {3.6815840851456337`*^9, 3.681584244382209*^9}, {
   3.68165556187547*^9, 3.6816555810349073`*^9}, 3.6827990733635483`*^9, {
   3.682799568245634*^9, 3.682799633360694*^9}, {3.6827996977626524`*^9, 
   3.6828000315514946`*^9}, {3.6840723035832105`*^9, 3.68407231916284*^9}, {
   3.6840731130768075`*^9, 3.684073229331272*^9}, {3.692556767355196*^9, 
   3.6925567676359963`*^9}, {3.694456020639531*^9, 3.694456020639531*^9}},
 CellID->17178618],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "int"], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["y", 
       StyleBox["F",
        FontSlant->"Plain"]], "(", 
      SubscriptBox["x", "int"], ")"}], "=", 
     RowBox[{
      SubscriptBox["y", 
       StyleBox["R",
        FontSlant->"Plain"]], "(", 
      SubscriptBox["x", "int"], ")"}]}]}], TraditionalForm]], "InlineMath"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
   3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
   3.681584029688101*^9}, {3.6815840851456337`*^9, 3.681584244382209*^9}, {
   3.68165556187547*^9, 3.6816555810349073`*^9}, 3.6827990733635483`*^9, {
   3.682799568245634*^9, 3.682799633360694*^9}, {3.6827996977626524`*^9, 
   3.6828000315514946`*^9}, {3.6840723035832105`*^9, 3.68407231916284*^9}, {
   3.6840731130768075`*^9, 3.6840732856888266`*^9}, {3.6925567719544196`*^9, 
   3.6925567780084457`*^9}},
 CellID->109690074],

Cell[TextData[{
 "the slope of the stripping line is calculated from ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["x", "int"], ",", 
     SubscriptBox["y", "int"]}], ")"}], TraditionalForm]], "InlineMath"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["x", 
      StyleBox["B",
       FontSlant->"Plain"]], ",", 
     SubscriptBox["x", 
      StyleBox["B",
       FontSlant->"Plain"]]}], ")"}], TraditionalForm]], "InlineMath"],
 " and the ",
 Cell[BoxData[
  FormBox["y", TraditionalForm]], "InlineMath"],
 " intercept is found:"
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
   3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
   3.681584029688101*^9}, {3.6815840851456337`*^9, 3.681584244382209*^9}, {
   3.68165556187547*^9, 3.6816555810349073`*^9}, 3.6827990733635483`*^9, {
   3.682799568245634*^9, 3.682799633360694*^9}, {3.6827996977626524`*^9, 
   3.6828000315514946`*^9}, {3.6840723035832105`*^9, 3.68407231916284*^9}, {
   3.6840731130768075`*^9, 3.6840733817924614`*^9}, {3.684266680057167*^9, 
   3.6842666801670637`*^9}, {3.6925567831752706`*^9, 3.692556787088494*^9}},
 CellID->26165156],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", 
     StyleBox["S",
      FontSlant->"Plain"]], "=", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        SubscriptBox["y", "int"], "-", 
        SubscriptBox["x", 
         StyleBox["B",
          FontSlant->"Plain"]]}], 
       RowBox[{
        SubscriptBox["x", "int"], "-", 
        SubscriptBox["x", 
         StyleBox["B",
          FontSlant->"Plain"]]}]], " ", 
      RowBox[{"(", 
       RowBox[{"x", "-", 
        SubscriptBox["x", 
         StyleBox["B",
          FontSlant->"Plain"]]}], ")"}]}], "+", 
     SubscriptBox["x", 
      StyleBox["B",
       FontSlant->"Plain"]]}]}], TraditionalForm]], "InlineMath"],
 "."
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
   3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
   3.681584029688101*^9}, {3.6815840851456337`*^9, 3.681584244382209*^9}, {
   3.68165556187547*^9, 3.6816555810349073`*^9}, 3.6827990733635483`*^9, {
   3.682799568245634*^9, 3.682799633360694*^9}, {3.6827996977626524`*^9, 
   3.6828000315514946`*^9}, {3.6840723035832105`*^9, 3.68407231916284*^9}, {
   3.6840731130768075`*^9, 3.6840734255891438`*^9}, {3.692556790956917*^9, 
   3.6925568108134155`*^9}},
 CellID->106093502],

Cell["\<\
View the screencast videos at [1] and [2] for a step-by-step explanation of \
the McCabe\[Dash]Thiele method.\
\>", "DetailNotes",
 CellChangeTimes->{{3.6815848382518215`*^9, 3.6815849073777747`*^9}, {
  3.681655831996743*^9, 3.681655831996743*^9}, {3.684240647646414*^9, 
  3.684240647824456*^9}},
 CellID->566652879],

Cell["References", "DetailNotes",
 CellChangeTimes->{{3.6815848382518215`*^9, 3.6815849073777747`*^9}, {
  3.681655831996743*^9, 3.681655834169548*^9}},
 CellID->122990324],

Cell[TextData[{
 "[1] ",
 StyleBox["McCabe\[Dash]Thiele Graphical Method Example Part 1",
  FontSlant->"Italic"],
 " [Video]. (Mar 6, 2014) ",
 ButtonBox["www.youtube.com/watch?v=Cv4KjY2BJTA",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://www.youtube.com/watch?v=Cv4KjY2BJTA"], None},
  ButtonNote->"https://www.youtube.com/watch?v=Cv4KjY2BJTA"],
 "."
}], "DetailNotes",
 CellChangeTimes->{{3.681584915459237*^9, 3.6815849172683406`*^9}, {
  3.681584978673853*^9, 3.6815850242984624`*^9}, {3.68424066059481*^9, 
  3.684240660796167*^9}},
 CellID->91303191],

Cell[TextData[{
 "[2] ",
 StyleBox["McCabe-Thiele Graphical Method Example Part 2",
  FontSlant->"Italic"],
 " [Video]. (Mar 6, 2014) ",
 ButtonBox["www.youtube.com/watch?v=eIJk5uXmBRc",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://www.youtube.com/watch?v=eIJk5uXmBRc"], None},
  ButtonNote->"https://www.youtube.com/watch?v=eIJk5uXmBRc"],
 "."
}], "DetailNotes",
 CellChangeTimes->{{3.6815850442426033`*^9, 3.6815850813847275`*^9}},
 CellID->882520694]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ControlSuggestionsSection"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[" Resize Images"]}],
  "\"Click inside an image to reveal its orange resize frame.\\nDrag any of \
the orange resize handles to resize the image.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.696007553341781*^9},
 FontFamily->"Verdana",
 CellTags->"ResizeImages"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Rotate and Zoom in 3D"]}],
  RowBox[{
   "\"Drag a 3D graphic to rotate it. Starting the drag near the center \
tumbles\\nthe graphic; starting near a corner turns it parallel to the plane \
of the screen.\\nHold down \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" (or \"", 
    FrameBox[
    "Cmd", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" on Mac) and drag up and down to zoom.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"RotateAndZoomIn3D"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Drag Locators"]}],
  RowBox[{"\"Drag any locator (\"", 
    GraphicsBox[
     LocatorBox[
      Scaled[{0.5, 0.5}]], ImageSize -> 20], 
    "\", etc.) to move it around.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"DragLocators"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Create and Delete Locators"]}],
  RowBox[{"\"Insert a new locator in the graphic by holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key\\nand clicking where you want it to be. Delete a locator by \
clicking it\\nwhile holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" key.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"CreateAndDeleteLocators"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[" Slider Zoom"]}],
  RowBox[{"\"Hold down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key while moving a slider to make fine adjustments in the slider \
value.\\nHold \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" and/or \"", 
    FrameBox[
    "Shift", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" at the same time as \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" to make ever finer adjustments.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.6960075546843834`*^9},
 FontFamily->"Verdana",
 CellTags->"SliderZoom"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[" Gamepad Controls"]}],
  "\"Control this Demonstration with a gamepad or other\\nhuman interface \
device connected to your computer.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.35696210375764*^9, 3.3895522232313623`*^9, 
  3.6960075551095843`*^9},
 FontFamily->"Verdana",
 CellTags->"GamepadControls"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[" Automatic Animation"]}],
  RowBox[{"\"Animate a slider in this Demonstration by clicking the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJzzTSzJSM1NLMlMTlRwL0osyMhMLlZwyy8CCjEzMjAwcIKwAgOI/R/IhBKc\n\
/4EAyGAG0f+nTZsGwgysIJIRKsWKLAXGIHFmEpUgLADxWUAkI24jZs+eTaEt\n\
IG+wQKRmzJgBlYf5lhEA30OqWA=="], "Graphics", ImageSize -> {9, 9}, ImageMargins -> 
      0, CellBaseline -> Baseline], BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"button\\nnext to the slider, and then clicking the play button that \
appears.\\nAnimate all controls by selecting \"", 
    StyleBox["Autorun", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.696007555530785*^9},
 FontFamily->"Verdana",
 CellTags->"AutomaticAnimation"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Bookmark Animation"]}],
  RowBox[{
   "\"See a prepared animation of this Demonstration by selecting\\n\"", 
    StyleBox["Animate Bookmarks", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"BookmarkAnimation"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SearchTermsSection"],

Cell["distillation", "SearchTerms",
 CellChangeTimes->{{3.6764858546888638`*^9, 3.676485855389348*^9}, {
   3.679655477543532*^9, 3.679655478133607*^9}, 3.682693293771456*^9},
 CellID->881704250],

Cell["separations", "SearchTerms",
 CellChangeTimes->{{3.676485858442082*^9, 3.6764858593483553`*^9}, {
   3.6796554571590257`*^9, 3.6796554813905163`*^9}, 3.6816558439969664`*^9, 
   3.6826932767378488`*^9},
 CellID->1806955628],

Cell["chemical engineering", "SearchTerms",
 CellChangeTimes->{{3.676485858442082*^9, 3.6764858593483553`*^9}, {
  3.6796554571590257`*^9, 3.679655488168081*^9}},
 CellID->274039471],

Cell["phase equilibrium", "SearchTerms",
 CellChangeTimes->{{3.676485858442082*^9, 3.6764858593483553`*^9}, {
  3.6796554571590257`*^9, 3.679655492205284*^9}},
 CellID->256725449],

Cell["distillation column", "SearchTerms",
 CellChangeTimes->{{3.681655846446171*^9, 3.6816558515191793`*^9}},
 CellID->219566529],

Cell["thermodynamics", "SearchTerms",
 CellChangeTimes->{{3.681655846446171*^9, 3.681655856263588*^9}},
 CellID->654425661],

Cell["equilibrium", "SearchTerms",
 CellChangeTimes->{{3.681655846446171*^9, 3.6816558684154105`*^9}},
 CellID->106196522],

Cell["binary mixture", "SearchTerms",
 CellChangeTimes->{{3.681655846446171*^9, 3.6816558721708183`*^9}},
 CellID->237275068]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "RelatedLinksSection"],

Cell[TextData[ButtonBox["McCabe & Thiele Graphical Method",
 BaseStyle->"Hyperlink",
 ButtonData->{
   URL["http://demonstrations.wolfram.com/McCabeThieleGraphicalMethod/"], 
   None},
 ButtonNote->
  "http://demonstrations.wolfram.com/McCabeThieleGraphicalMethod/"]], \
"RelatedLinks",
 CellChangeTimes->{{3.6791769453657017`*^9, 3.679176967385561*^9}},
 CellID->70716352]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "AuthorSection"],

Cell[TextData[{
 "Contributed by: ",
 ButtonBox["Neil Hendren",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=Neil+Hendren"], 
    None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=Neil+Hendren"],
 " and ",
 ButtonBox["Rachael L. Baumann",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=Rachael+L.+\
Baumann"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=Rachael+L.+Baumann"]
}], "Author",
 CellChangeTimes->{
  3.6791736512483034`*^9, 3.6791769778452263`*^9, {3.693927465948988*^9, 
   3.693927535684687*^9}},
 CellID->310068220],

Cell[TextData[{
 "Additional contributions by: ",
 ButtonBox["John L. Falconer",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=John+L.+\
Falconer"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=John+L.+Falconer"],
 " and ",
 ButtonBox["Thomas Belval",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=Thomas+Belval"],
     None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=Thomas+Belval"]
}], "Author",
 CellChangeTimes->{{3.6791736529049067`*^9, 3.679173698861251*^9}, {
   3.679173744864237*^9, 3.6791737586000977`*^9}, {3.6841676499960833`*^9, 
   3.684167649997083*^9}, 3.6939275455387363`*^9},
 CellID->377872580],

Cell["\<\
(University of Colorado Boulder, Department of Chemical and Biological \
Engineering)\
\>", "Author",
 CellID->362019610]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1366, 686},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 6, \
2015)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "Demonstration.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "ResizeImages"->{
  Cell[217207, 5024, 353, 9, 29, "ControlSuggestions",
   CellTags->"ResizeImages"]},
 "RotateAndZoomIn3D"->{
  Cell[217563, 5035, 678, 16, 29, "ControlSuggestions",
   CellTags->"RotateAndZoomIn3D"]},
 "DragLocators"->{
  Cell[218244, 5053, 340, 11, 29, "ControlSuggestions",
   CellTags->"DragLocators"]},
 "CreateAndDeleteLocators"->{
  Cell[218587, 5066, 637, 15, 29, "ControlSuggestions",
   CellTags->"CreateAndDeleteLocators"]},
 "SliderZoom"->{
  Cell[219227, 5083, 887, 22, 29, "ControlSuggestions",
   CellTags->"SliderZoom"]},
 "GamepadControls"->{
  Cell[220117, 5107, 395, 10, 29, "ControlSuggestions",
   CellTags->"GamepadControls"]},
 "AutomaticAnimation"->{
  Cell[220515, 5119, 1505, 32, 29, "ControlSuggestions",
   CellTags->"AutomaticAnimation"]},
 "BookmarkAnimation"->{
  Cell[222023, 5153, 908, 21, 29, "ControlSuggestions",
   CellTags->"BookmarkAnimation"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"ResizeImages", 226863, 5305},
 {"RotateAndZoomIn3D", 226973, 5308},
 {"DragLocators", 227084, 5311},
 {"CreateAndDeleteLocators", 227201, 5314},
 {"SliderZoom", 227316, 5317},
 {"GamepadControls", 227423, 5320},
 {"AutomaticAnimation", 227538, 5323},
 {"BookmarkAnimation", 227656, 5326}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 113, 1, 76, "DemoTitle"],
Cell[696, 25, 33, 0, 275, "InitializationSection"],
Cell[CellGroupData[{
Cell[754, 29, 29, 0, 201, "ManipulateSection"],
Cell[CellGroupData[{
Cell[808, 33, 62107, 1508, 2648, "Input"],
Cell[62918, 1543, 25286, 541, 571, "Output",
 CellID->1688993734]
}, {2}]]
}, Open  ]],
Cell[CellGroupData[{
Cell[88250, 2090, 36, 0, 181, "ManipulateCaptionSection"],
Cell[88289, 2092, 2778, 73, 119, "ManipulateCaption"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91104, 2170, 28, 0, 179, "ThumbnailSection"],
Cell[91135, 2172, 25286, 541, 571, "Output",
 CellID->1478841292]
}, Open  ]],
Cell[CellGroupData[{
Cell[116458, 2718, 28, 0, 149, "SnapshotsSection"],
Cell[116489, 2720, 25346, 541, 571, "Output",
 CellID->2057347913],
Cell[141838, 3263, 25290, 541, 571, "Output",
 CellID->1212173444],
Cell[167131, 3806, 25354, 541, 571, "Output",
 CellID->1969197866]
}, Open  ]],
Cell[CellGroupData[{
Cell[192522, 4352, 26, 0, 357, "DetailsSection"],
Cell[192551, 4354, 790, 12, 23, "DetailNotes",
 CellID->1224384310],
Cell[193344, 4368, 450, 6, 23, "DetailNotes",
 CellID->2068001857],
Cell[193797, 4376, 1194, 18, 39, "DetailNotes",
 CellID->1246656247],
Cell[194994, 4396, 1600, 36, 27, "DetailNotes",
 CellID->1894578964],
Cell[196597, 4434, 1115, 19, 27, "DetailNotes",
 CellID->1110576016],
Cell[197715, 4455, 171, 3, 23, "DetailNotes",
 CellID->372290207],
Cell[197889, 4460, 237, 5, 23, "DetailNotes",
 CellID->613959288],
Cell[198129, 4467, 710, 20, 25, "DetailNotes",
 CellID->182840712],
Cell[198842, 4489, 646, 17, 24, "DetailNotes",
 CellID->171734077],
Cell[199491, 4508, 1560, 47, 44, "DetailNotes",
 CellID->417910946],
Cell[201054, 4557, 618, 19, 36, "DetailNotes",
 CellID->142476940],
Cell[201675, 4578, 704, 22, 23, "DetailNotes",
 CellID->174539008],
Cell[202382, 4602, 306, 8, 23, "DetailNotes",
 CellID->421570329],
Cell[202691, 4612, 904, 25, 25, "DetailNotes",
 CellID->678020050],
Cell[203598, 4639, 955, 26, 25, "DetailNotes",
 CellID->1041801],
Cell[204556, 4667, 818, 19, 23, "DetailNotes",
 CellID->248628401],
Cell[205377, 4688, 563, 10, 23, "DetailNotes",
 CellID->214837423],
Cell[205943, 4700, 880, 24, 31, "DetailNotes",
 CellID->62774028],
Cell[206826, 4726, 881, 24, 30, "DetailNotes",
 CellID->489852983],
Cell[207710, 4752, 1198, 30, 23, "DetailNotes",
 CellID->338672037],
Cell[208911, 4784, 1946, 53, 39, "DetailNotes",
 CellID->579065947],
Cell[210860, 4839, 1157, 30, 33, "DetailNotes",
 CellID->17178618],
Cell[212020, 4871, 1010, 26, 23, "DetailNotes",
 CellID->109690074],
Cell[213033, 4899, 1235, 32, 23, "DetailNotes",
 CellID->26165156],
Cell[214271, 4933, 1311, 38, 32, "DetailNotes",
 CellID->106093502],
Cell[215585, 4973, 328, 7, 23, "DetailNotes",
 CellID->566652879],
Cell[215916, 4982, 172, 3, 23, "DetailNotes",
 CellID->122990324],
Cell[216091, 4987, 569, 15, 23, "DetailNotes",
 CellID->91303191],
Cell[216663, 5004, 467, 13, 23, "DetailNotes",
 CellID->882520694]
}, Open  ]],
Cell[CellGroupData[{
Cell[217167, 5022, 37, 0, 131, "ControlSuggestionsSection"],
Cell[217207, 5024, 353, 9, 29, "ControlSuggestions",
 CellTags->"ResizeImages"],
Cell[217563, 5035, 678, 16, 29, "ControlSuggestions",
 CellTags->"RotateAndZoomIn3D"],
Cell[218244, 5053, 340, 11, 29, "ControlSuggestions",
 CellTags->"DragLocators"],
Cell[218587, 5066, 637, 15, 29, "ControlSuggestions",
 CellTags->"CreateAndDeleteLocators"],
Cell[219227, 5083, 887, 22, 29, "ControlSuggestions",
 CellTags->"SliderZoom"],
Cell[220117, 5107, 395, 10, 29, "ControlSuggestions",
 CellTags->"GamepadControls"],
Cell[220515, 5119, 1505, 32, 29, "ControlSuggestions",
 CellTags->"AutomaticAnimation"],
Cell[222023, 5153, 908, 21, 29, "ControlSuggestions",
 CellTags->"BookmarkAnimation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[222968, 5179, 30, 0, 165, "SearchTermsSection"],
Cell[223001, 5181, 195, 3, 23, "SearchTerms",
 CellID->881704250],
Cell[223199, 5186, 229, 4, 23, "SearchTerms",
 CellID->1806955628],
Cell[223431, 5192, 182, 3, 23, "SearchTerms",
 CellID->274039471],
Cell[223616, 5197, 179, 3, 23, "SearchTerms",
 CellID->256725449],
Cell[223798, 5202, 130, 2, 23, "SearchTerms",
 CellID->219566529],
Cell[223931, 5206, 123, 2, 23, "SearchTerms",
 CellID->654425661],
Cell[224057, 5210, 122, 2, 23, "SearchTerms",
 CellID->106196522],
Cell[224182, 5214, 125, 2, 23, "SearchTerms",
 CellID->237275068]
}, Open  ]],
Cell[CellGroupData[{
Cell[224344, 5221, 31, 0, 149, "RelatedLinksSection"],
Cell[224378, 5223, 373, 9, 23, "RelatedLinks",
 CellID->70716352]
}, Open  ]],
Cell[CellGroupData[{
Cell[224788, 5237, 25, 0, 149, "AuthorSection"],
Cell[224816, 5239, 709, 21, 23, "Author",
 CellID->310068220],
Cell[225528, 5262, 794, 21, 23, "Author",
 CellID->377872580],
Cell[226325, 5285, 131, 4, 23, "Author",
 CellID->362019610]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
