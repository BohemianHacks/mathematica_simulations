(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    152402,       3566]
NotebookOptionsPosition[    142877,       3384]
NotebookOutlinePosition[    144936,       3434]
CellTagsIndexPosition[    144600,       3422]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 "Construct a ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]], "InlineMath",ExpressionUUID->
  "fa662063-1892-4dd1-9b49-95b0e81aaa60"],
 "-",
 Cell[BoxData[
  FormBox["y", TraditionalForm]], "InlineMath",ExpressionUUID->
  "e90bf39f-1d9d-475f-9c7d-f926a25afde8"],
 " Diagram for an Absorption Column"
}], "DemoTitle",
 CellChangeTimes->{
  3.7244269498449855`*^9, {3.7256147790318356`*^9, 
   3.725614787654004*^9}},ExpressionUUID->"7b4f29ec-f519-4f27-a894-\
62c4e616d19c"],

Cell[CellGroupData[{

Cell["", "InitializationSection",ExpressionUUID->"ea63a9a9-ba07-49c8-a17b-f2673dc817ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"colL", "=", "Blue"}], ";", 
  RowBox[{"colV", "=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{"0", ",", "0.6", ",", "0"}], "]"}]}], ";", 
  RowBox[{"colOP", "=", "Magenta"}], ";", 
  RowBox[{"colEQ", "=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{"1", ",", "0.4", ",", "0"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.722351924642107*^9, 3.722351934327661*^9}, {
  3.722353918292137*^9, 3.7223539318519125`*^9}},
 CellID->448483865,ExpressionUUID->"98477edd-3900-46d2-967d-71ae2cc42787"],

Cell[BoxData[
 RowBox[{
  RowBox[{"textyN1", "=", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"Subscript", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
       RowBox[{"Row", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<N\>\"", ",", "Italic"}], "]"}], ",", "\"\<+1\>\""}], 
         "}"}]}]}], "]"}], ",", "17", ",", "colV", ",", 
     RowBox[{"Background", "\[Rule]", "White"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.724075877350924*^9, 3.724075880919031*^9}},
 CellID->493747658,ExpressionUUID->"8ddc521c-892b-496d-ab9b-865666bb3444"],

Cell[BoxData[
 RowBox[{
  RowBox[{"textxN", "=", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"Subscript", "[", 
      RowBox[{"\"\<x\>\"", ",", "\"\<N\>\""}], "]"}], ",", "Italic", ",", 
     "17", ",", "colL", ",", 
     RowBox[{"Background", "\[Rule]", "White"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7240759286771746`*^9, 3.7240759317310805`*^9}},
 CellID->241618003,ExpressionUUID->"5fb63a4c-5ce6-40ce-939b-81c387124a2e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"texty1", "=", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"Subscript", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", "1"}], "]"}], ",", 
     "17", ",", "colV", ",", 
     RowBox[{"Background", "\[Rule]", "White"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.724076016343301*^9, 3.7240760192203217`*^9}},
 CellID->905169336,ExpressionUUID->"ee026fca-2e58-4069-8f70-7dd9122a4ae4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"textx0", "=", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"Subscript", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", "0"}], "]"}], ",", 
     "17", ",", "colL", ",", 
     RowBox[{"Background", "\[Rule]", "White"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.724076067768366*^9, 3.724076070775471*^9}},
 CellID->462033904,ExpressionUUID->"53ffabdd-f512-44fa-833c-cee45d78dcd0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ManipulateSection",ExpressionUUID->"bb778bc8-5c59-49dd-aded-efc25d490996"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "P", ",", "T", ",", "L0", ",", "Ea", ",", "R", ",", "H0", ",", "HB", 
       ",", "L", ",", "V", ",", "x0", ",", "y1", ",", "yn1", ",", "yN1", ",", 
       "yeq", ",", "xp1", ",", "xp2", ",", "intersect", ",", "check1", ",", 
       "check2", ",", "stage", ",", "test", ",", "n", ",", "steps", ",", 
       "stepping", ",", "xN", ",", "X", ",", "xeq", ",", "xop", ",", 
       "plotlabel", ",", "h", ",", "w", ",", "ry", ",", "column", ",", "opt", 
       ",", "pt1", ",", "pt2", ",", "diagram"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SeedRandom", "[", "reset", "]"}], ";", 
      RowBox[{"P", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"2.5", ",", "3"}], "}"}], "]"}]}], ";", 
      RowBox[{"T", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "25"}], "}"}], "]"}]}], ";", 
      RowBox[{"L0", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"115", ",", "200"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Ea", "=", "5000"}], ";", 
      RowBox[{"R", "=", "8.314"}], ";", "\[IndentingNewLine]", 
      RowBox[{"H0", "=", 
       RowBox[{"Hi", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{"211.19", "\[Equal]", 
            RowBox[{"Hi", "*", 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               FractionBox["5000", 
                RowBox[{"R", "*", "298"}]]}], "]"}]}]}], ",", "Hi"}], "]"}], 
         "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"HB", "=", 
       RowBox[{"H0", "*", 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          FractionBox["Ea", 
           RowBox[{"R", "*", 
            RowBox[{"(", 
             RowBox[{"T", "+", "273"}], ")"}]}]]}], "]"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"atm", "/", "mole"}], " ", 
        RowBox[{"frac", "."}]}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"L", "=", 
       RowBox[{"1000", "*", "L0"}]}], ";", 
      RowBox[{"V", "=", "1000"}], ";", "\[IndentingNewLine]", 
      RowBox[{"x0", "=", "0.05"}], ";", 
      RowBox[{"y1", "=", "10"}], ";", 
      RowBox[{"yn1", "=", "100"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yN1", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         FractionBox["L", "V"], "*", 
         RowBox[{"(", 
          RowBox[{"x", "-", "x0"}], ")"}]}], "+", "y1"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yeq", "[", "x_", "]"}], ":=", 
       RowBox[{
        FractionBox["HB", "P"], "*", "x"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"xp1", "=", "1.35"}], ";", 
      RowBox[{"xp2", "=", 
       RowBox[{"x", "/.", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"yN1", "[", "x", "]"}], "\[Equal]", 
           RowBox[{"1.1", "*", "yn1"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"intersect", "=", 
       RowBox[{"x", "/.", 
        RowBox[{"Quiet", "@", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"yN1", "[", "x", "]"}], "\[Equal]", 
             RowBox[{"yeq", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"check1", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yN1", "[", "x", "]"}], "\[Equal]", "yn1"}], ",", "x"}], 
          "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"check2", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"yN1", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"stage", "[", "1", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", "y1"}], ",", "x"}], 
          "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"stage", "[", "i", "]"}], "=", 
         RowBox[{"x", "/.", 
          RowBox[{
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", 
              RowBox[{"yN1", "[", 
               RowBox[{"stage", "[", 
                RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ",", "x"}], "]"}], 
           "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", "100"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"test", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"stage", "[", "n", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", "50"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", "1"}], ";", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"test", "[", 
           RowBox[{"[", "n", "]"}], "]"}], "<", "check1"}], "\[And]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"check2", ">", "0"}], ",", 
           RowBox[{
            RowBox[{"yeq", "[", "check2", "]"}], ">", "yn1"}], ",", "True"}], 
          "]"}]}], ",", 
        RowBox[{"n", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"test", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"yeq", "[", 
                RowBox[{"test", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"test", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"yN1", "[", 
                RowBox[{"test", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "1"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"stepping", "=", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"x0", ",", "y1"}], "}"}], "}"}], ",", "steps"}], "]"}], 
         ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"2", "*", "n"}], "+", "1"}], ",", "2"}], "}"}], 
          "\[Rule]", "yn1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"xN", "=", 
       RowBox[{"stepping", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"-", "2"}], ",", "1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"X", "[", "i_", "]"}], ":=", 
       RowBox[{"stepping", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"2", "*", "i"}], ",", "1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xeq", "[", "y_", "]"}], ":=", 
       RowBox[{"x", "/.", 
        RowBox[{"Quiet", "@", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"y", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0"}], "}"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xop", "[", "y_", "]"}], ":=", 
       RowBox[{"x", "/.", 
        RowBox[{"Quiet", "@", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yN1", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"y", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0"}], "}"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"plotlabel", "=", 
       RowBox[{"Switch", "[", 
        RowBox[{"NPR", ",", "\[IndentingNewLine]", "2", ",", 
         RowBox[{"If", "[", 
          RowBox[{
          "hint", ",", "\"\<hint: use the mass balance from step 1\>\"", ",", 
           "\"\<step 2: click and drag the points to create the operating \
line, then check solution\>\""}], "]"}], ",", "\[IndentingNewLine]", "3", ",", 
         RowBox[{"If", "[", 
          RowBox[{"hint", ",", "\"\<hint: use Henry's law\>\"", ",", 
           RowBox[{"Column", "[", 
            RowBox[{"{", 
             RowBox[{
             "\"\<step 3: click and drag the points to create the equilibrium \
line, then check solution\>\"", ",", 
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<P\>\"", ",", "Italic"}], "]"}], ",", 
                 "\"\< = \>\"", ",", 
                 RowBox[{"NumberForm", "[", 
                  RowBox[{"P", ",", 
                   RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}]}], "]"}], ",", 
                 "\"\< atm and \>\"", ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<H\>\"", ",", "Italic"}], "]"}], ",", 
                 "\"\< = \>\"", ",", 
                 RowBox[{"NumberForm", "[", 
                  RowBox[{"HB", ",", 
                   RowBox[{"{", 
                    RowBox[{"4", ",", "1"}], "}"}]}], "]"}], ",", 
                 "\"\< atm/mole fraction\>\""}], "}"}]}]}], "}"}], "]"}]}], 
          "]"}], ",", "\[IndentingNewLine]", "4", ",", 
         RowBox[{"If", "[", 
          RowBox[{"hint", ",", 
           RowBox[{"Row", "@", 
            RowBox[{"{", 
             RowBox[{"\"\<hint: start at \>\"", ",", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"\"\<x\>\"", ",", "\"\<N\>\""}], "]"}], ",", 
                "Italic"}], "]"}]}], "}"}]}], ",", 
           RowBox[{"(*", 
            RowBox[{"Column", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<step 4: drag the black point to move the dotted lines and \
use the slider to show\>\"", ",", 
               "\"\<the next step, then check solution\>\""}], "}"}], "]"}], 
            "*)"}], "\[IndentingNewLine]", 
           "\"\<step 4: determine the mole fractions leaving stage 1, then \
check solution\>\""}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", "5", ",", 
         RowBox[{"Row", "@", 
          RowBox[{"{", 
           RowBox[{"\"\<solved \>\"", ",", 
            RowBox[{"Style", "[", 
             RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", "\"\<-\>\"", 
            ",", 
            RowBox[{"Style", "[", 
             RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
            "\"\< diagram\>\""}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"h", "=", "13"}], ";", 
      RowBox[{"w", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"NPR", "\[Equal]", "1"}], ",", "6", ",", "12"}], "]"}]}], 
      ";", 
      RowBox[{"ry", "=", "2"}], ";", "\[IndentingNewLine]", 
      RowBox[{"column", "=", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Thick", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"#", ",", "ry"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"#", ",", 
                  RowBox[{"h", "-", "ry"}]}], "}"}]}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"{", 
             RowBox[{"0", ",", "w"}], "}"}]}], ",", 
           RowBox[{"Circle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"w", "/", "2"}], ",", "ry"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"w", "/", "2"}], ",", "ry"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Pi]", ",", 
               RowBox[{"2", "*", "\[Pi]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Circle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"w", "/", "2"}], ",", 
               RowBox[{"h", "-", "ry"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"w", "/", "2"}], ",", "ry"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Arrowheads", "@", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"NPR", "\[Equal]", "1"}], ",", "0.065", ",", "0.09"}],
                "]"}]}], ",", "\[IndentingNewLine]", "colV", ",", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "w"}], ",", 
                  RowBox[{
                   RowBox[{"-", "h"}], "/", "4"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.25", "*", "w"}], ",", 
                  RowBox[{
                   RowBox[{"-", "h"}], "/", "4"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.25", "*", "w"}], ",", 
                  RowBox[{"ry", "/", "10"}]}], "}"}]}], "}"}], "]"}], ",", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.25", "*", "w"}], ",", 
                  RowBox[{"h", "-", 
                   RowBox[{"ry", "/", "10"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.25", "*", "w"}], ",", 
                  RowBox[{"h", "+", 
                   RowBox[{"h", "/", "4"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "w"}], ",", 
                  RowBox[{"h", "+", 
                   RowBox[{"h", "/", "4"}]}]}], "}"}]}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", "colL", ",", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.75", "*", "w"}], ",", 
                  RowBox[{"ry", "/", "10"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.75", "*", "w"}], ",", 
                  RowBox[{
                   RowBox[{"-", "h"}], "/", "4"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"2", "*", "w"}], ",", 
                  RowBox[{
                   RowBox[{"-", "h"}], "/", "4"}]}], "}"}]}], "}"}], "]"}], 
             ",", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"2", "*", "w"}], ",", 
                  RowBox[{"h", "+", 
                   RowBox[{"h", "/", "4"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.75", "*", "w"}], ",", 
                  RowBox[{"h", "+", 
                   RowBox[{"h", "/", "4"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.75", "*", "w"}], ",", 
                  RowBox[{"h", "-", 
                   RowBox[{"ry", "/", "10"}]}]}], "}"}]}], "}"}], "]"}]}], 
            "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Column", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"P", ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}]}], "]"}], ",", 
                    "\"\< atm\>\""}], "}"}]}], ",", 
                   RowBox[{"Spacer", "@", "0"}], ",", 
                   RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"T", ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "0"}], "}"}]}], "]"}], ",", 
                    "\"\< \[Degree]C\>\""}], "}"}]}]}], "}"}], ",", 
                 "Center"}], "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"NPR", "\[Equal]", "1"}], ",", "17", ",", "16"}], 
                "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"0.5", "*", "w"}], ",", 
               RowBox[{"0.5", "*", "h"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"NPR", ">", "1"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<L\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"L", "/", "1000"}], ",", "\"\< Mmol/h\>\""}], 
                   "}"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Column", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"\"\<liquid solvent feed\>\"", ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<L\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"L", "/", "1000"}], ",", "\"\< Mmol/h\>\""}], 
                    "}"}]}]}], "}"}], ",", "Right"}], "]"}]}], 
                "\[IndentingNewLine]", "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"NPR", "\[Equal]", "1"}], ",", "17", ",", "16"}], 
                "]"}], ",", "colL"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"w", ",", 
               RowBox[{"h", "+", 
                RowBox[{"h", "/", "4"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.5"}], ",", 
               RowBox[{"-", "1.2"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"NPR", ">", "1"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<V\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"V", "/", "1000"}], ",", "\"\< Mmol/h\>\""}], 
                   "}"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Column", "[", 
                  RowBox[{"{", 
                   RowBox[{"\"\<vapor feed\>\"", ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<V\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", "vapor", ",", "\"\< Mmol/h\>\"", ",", 
                    RowBox[{"Spacer", "@", "35"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"NPR", "\[Equal]", "1"}], "\[And]", "solution"}], 
                    ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<actual \>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<V\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"V", "/", "1000"}], ",", "\"\< Mmol/h\>\""}], 
                    "}"}]}]}], "]"}]}], "}"}]}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"NPR", "\[Equal]", "1"}], ",", "17", ",", "16"}], 
                "]"}], ",", "colV"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{
                RowBox[{"-", "h"}], "/", "4"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"NPR", "\[Equal]", "1"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{"solution", ",", 
                   RowBox[{"-", "0.2"}], ",", "0.5"}], "]"}], ",", "0.5"}], 
                "]"}], ",", "1.4"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"solution", "\[And]", 
                RowBox[{"NPR", "\[Equal]", "1"}]}], ",", 
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<actual \>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<V\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"V", "/", "1000"}], ",", "\"\< Mmol/h\>\""}], 
                    "}"}]}], ",", "17", ",", "colV"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{
                    RowBox[{"-", "h"}], "/", "2"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "2"}], ",", "0"}], "}"}]}], "]"}]}], "]"}], 
             ","}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", "#2"}], 
                    "]"}], ",", "\"\< = \>\"", ",", "#1", ",", 
                    "\"\< ppm\>\""}], "}"}]}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"NPR", "\[Equal]", "1"}], ",", "17", ",", "16"}], 
                  "]"}], ",", "colV", ",", 
                 RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "#3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.5", ",", "0"}], "}"}]}], "]"}], "&"}], "@@@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"y1", ",", "1", ",", 
                RowBox[{"h", "+", "2"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"yn1", ",", 
                RowBox[{"Row", "@", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<N\>\"", ",", "Italic"}], "]"}], ",", 
                   "\"\<+1\>\""}], "}"}]}], ",", 
                RowBox[{"-", "2"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", "#2"}], 
                    "]"}], ",", "\"\< = \>\"", ",", "#1", ",", 
                    "\"\< ppm\>\""}], "}"}]}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"NPR", "\[Equal]", "1"}], ",", "17", ",", "16"}], 
                  "]"}], ",", "colL", ",", 
                 RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"w", ",", "#3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "0.5"}], ",", "0"}], "}"}]}], "]"}], "&"}], "@@@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x0", ",", "0", ",", 
                RowBox[{"h", "+", "2"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"NumberForm", "[", 
                 RowBox[{"xN", ",", "2"}], "]"}], ",", 
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<N\>\"", ",", "Italic"}], "]"}], ",", 
                RowBox[{"-", "2"}]}], "}"}]}], "}"}]}]}], 
          "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"NPR", "\[Equal]", "1"}], ",", "600", ",", "250"}], 
             "]"}], ",", "390"}], "}"}]}], ",", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"10", ",", "10"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"45", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"NPR", "\[Equal]", "1"}], ",", "50", ",", "25"}], 
               "]"}]}], "}"}]}], "}"}]}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"NPR", "\[Equal]", "1"}], ",", "0.75", ",", "Full"}], 
           "]"}]}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"NPR", "\[Equal]", "1"}], ",", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
               "hint", ",", "\"\<hint: use mass balance on solute\>\"", ",", 
                "\"\<step 1: calculate the vapor flow rate, then check \
solution\>\""}], "]"}], ",", "17", ",", "Black"}], "]"}], ",", "None"}], 
           "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"opt", "=", 
       RowBox[{"Sequence", "[", 
        RowBox[{
         RowBox[{"Thickness", "@", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"graphic", "\[And]", 
             RowBox[{"NPR", "<", "4"}]}], ",", "0.011", ",", "0.008"}], 
           "]"}]}], ",", "Dotted"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pt1", "[", 
        RowBox[{"pt_", ",", "col_"}], "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{"col", ",", 
         RowBox[{"PointSize", "@", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"graphic", "\[And]", 
             RowBox[{"NPR", "<", "4"}]}], ",", "0.04", ",", "0.025"}], 
           "]"}]}], ",", 
         RowBox[{"Point", "@", "pt"}], ",", "White", ",", 
         RowBox[{"PointSize", "@", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"graphic", "\[And]", 
             RowBox[{"NPR", "<", "4"}]}], ",", "0.025", ",", "0.015"}], 
           "]"}]}], ",", 
         RowBox[{"Point", "@", "pt"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pt2", "[", 
        RowBox[{"pt_", ",", "col_"}], "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{"col", ",", 
         RowBox[{"PointSize", "@", 
          RowBox[{"If", "[", 
           RowBox[{"graphic", ",", "0.035", ",", "0.02"}], "]"}]}], ",", 
         RowBox[{"Point", "@", "pt"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"diagram", "=", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Thick", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"DRAW", " ", "OPERATING", " ", "LINE"}], ",", " ", 
             RowBox[{"NPR", "=", "2"}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NPR", "\[Equal]", "2"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Evaluate", "@", "opt"}], ",", "colOP", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{"op1", ",", "op2"}], "}"}], "]"}]}], "}"}], ",", 
               RowBox[{"pt1", "[", 
                RowBox[{"op1", ",", "colOP"}], "]"}], ",", 
               RowBox[{"pt1", "[", 
                RowBox[{"op2", ",", "colOP"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"solution", "\[Equal]", "False"}], ",", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"op1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "2"}], "}"}]}], "]"}], ",", 
                    "\"\< ppm\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"op1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "0"}], "}"}]}], "]"}], ",", 
                    "\"\< ppm\>\""}], "}"}]}]}], "\[IndentingNewLine]", "}"}],
                     ",", 
                    RowBox[{"Alignment", "\[Rule]", "\"\<=\>\""}]}], "]"}], 
                    ",", "17", ",", "colOP", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    "op1", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1.3"}]}], "}"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"op2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "2"}], "}"}]}], "]"}], ",", 
                    "\"\< ppm\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"op2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "0"}], "}"}]}], "]"}], ",", 
                    "\"\< ppm\>\""}], "}"}]}]}], "\[IndentingNewLine]", "}"}],
                     ",", 
                    RowBox[{"Alignment", "\[Rule]", "\"\<=\>\""}]}], "]"}], 
                    ",", "17", ",", "colOP", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    "op2", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1.5"}], "}"}]}], "]"}]}], 
                  "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{"{", 
                  RowBox[{"colOP", ",", 
                   RowBox[{"Line", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"yN1", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", "xp2", ",", "0.01"}], "]"}]}], "]"}]}], 
                  "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NPR", ">", "2"}], ",", 
             RowBox[{"{", 
              RowBox[{"colOP", ",", 
               RowBox[{"Line", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"#", ",", 
                    RowBox[{"yN1", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
                 RowBox[{"Range", "[", 
                  RowBox[{"0", ",", "xp2", ",", "0.01"}], "]"}]}], "]"}]}], 
              "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"DRAW", " ", "EQUILIBRIUM", " ", "LINE"}], ",", " ", 
             RowBox[{"NPR", "=", "3"}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NPR", "\[Equal]", "3"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Evaluate", "@", "opt"}], ",", "colEQ", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{"eq1", ",", "eq2"}], "}"}], "]"}]}], "}"}], ",", 
               RowBox[{"pt1", "[", 
                RowBox[{"eq1", ",", "colEQ"}], "]"}], ",", 
               RowBox[{"pt1", "[", 
                RowBox[{"eq2", ",", "colEQ"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"solution", "\[Equal]", "False"}], ",", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"eq1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "2"}], "}"}]}], "]"}], ",", 
                    "\"\< ppm\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"eq1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "0"}], "}"}]}], "]"}], ",", 
                    "\"\< ppm\>\""}], "}"}]}]}], "\[IndentingNewLine]", "}"}],
                     ",", 
                    RowBox[{"Alignment", "\[Rule]", "\"\<=\>\""}]}], "]"}], 
                    ",", "17", ",", "colEQ", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    "eq1", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1.3"}]}], "}"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"eq2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "2"}], "}"}]}], "]"}], ",", 
                    "\"\< ppm\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"eq2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "0"}], "}"}]}], "]"}], ",", 
                    "\"\< ppm\>\""}], "}"}]}]}], "\[IndentingNewLine]", "}"}],
                     ",", 
                    RowBox[{"Alignment", "\[Rule]", "\"\<=\>\""}]}], "]"}], 
                    ",", "17", ",", "colEQ", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    "eq2", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1.5"}], "}"}]}], "]"}]}], 
                  "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{"{", 
                  RowBox[{"colEQ", ",", 
                   RowBox[{"Line", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"yeq", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", "xp1", ",", "0.01"}], "]"}]}], "]"}]}], 
                  "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NPR", ">", "3"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{"colEQ", ",", 
               RowBox[{"Line", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"#", ",", 
                    RowBox[{"yeq", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
                 RowBox[{"Range", "[", 
                  RowBox[{"0", ",", "xp1", ",", "0.01"}], "]"}]}], "]"}], ",",
                "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"Dashed", ",", "colV", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "yn1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xp1", ",", "yn1"}], "}"}]}], "}"}], "]"}], ",", 
                 RowBox[{"Text", "[", 
                  RowBox[{"textyN1", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.2", "*", "xp1"}], ",", "yn1"}], "}"}]}], "]"}],
                  ",", 
                 RowBox[{"pt2", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "y1"}], "}"}], ",", "colV"}], "]"}], 
                 ",", 
                 RowBox[{"Text", "[", 
                  RowBox[{"texty1", ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "y1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1.5", ",", "0"}], "}"}]}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"Dashed", ",", "colL", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"xN", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xN", ",", "yn1"}], "}"}]}], "}"}], "]"}], ",", 
                 RowBox[{"Text", "[", 
                  RowBox[{"textxN", ",", 
                   RowBox[{"{", 
                    RowBox[{"xN", ",", 
                    RowBox[{"0.2", "*", "yn1"}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"pt2", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"x0", ",", "0"}], "}"}], ",", "colL"}], "]"}], 
                 ",", 
                 RowBox[{"Text", "[", 
                  RowBox[{"textx0", ",", 
                   RowBox[{"{", 
                    RowBox[{"x0", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "2"}], ",", 
                    RowBox[{"-", "0.75"}]}], "}"}]}], "]"}]}], "}"}]}], 
              "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"STEP", " ", "OF", " ", "STAGES"}], ",", " ", 
             RowBox[{"NPR", "=", "8"}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"NPR", "\[Equal]", "4"}], ",", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Evaluate", "@", "opt"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xeq", "[", "step1", "]"}], ",", "yn1"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xeq", "[", "step1", "]"}], ",", 
                    RowBox[{"step1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xop", "[", "step1", "]"}], ",", 
                    RowBox[{"step1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xop", "[", "step1", "]"}], ",", 
                    RowBox[{"yeq", "[", 
                    RowBox[{"xop", "[", "step1", "]"}], "]"}]}], "}"}]}], 
                    "}"}], "]"}], ",", 
                   RowBox[{"pt1", "[", 
                    RowBox[{"step1", ",", "Black"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"showstep", "\[GreaterEqual]", "2"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xeq", "[", "step2", "]"}], ",", 
                    RowBox[{"step2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xop", "[", "step2", "]"}], ",", 
                    RowBox[{"step2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xop", "[", "step2", "]"}], ",", 
                    RowBox[{"yeq", "[", 
                    RowBox[{"xop", "[", "step2", "]"}], "]"}]}], "}"}]}], 
                    "}"}], "]"}], ",", 
                    RowBox[{"pt1", "[", 
                    RowBox[{"step2", ",", "Black"}], "]"}]}], "}"}]}], "]"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"showstep", "\[GreaterEqual]", "3"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xeq", "[", "step3", "]"}], ",", 
                    RowBox[{"step3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xop", "[", "step3", "]"}], ",", 
                    RowBox[{"step3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xop", "[", "step3", "]"}], ",", 
                    RowBox[{"yeq", "[", 
                    RowBox[{"xop", "[", "step3", "]"}], "]"}]}], "}"}]}], 
                    "}"}], "]"}], ",", 
                    RowBox[{"pt1", "[", 
                    RowBox[{"step3", ",", "Black"}], "]"}]}], "}"}]}], "]"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"showstep", "\[GreaterEqual]", "4"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xeq", "[", "step4", "]"}], ",", 
                    RowBox[{"step4", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xop", "[", "step4", "]"}], ",", 
                    RowBox[{"step4", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xop", "[", "step4", "]"}], ",", 
                    RowBox[{"yeq", "[", 
                    RowBox[{"xop", "[", "step4", "]"}], "]"}]}], "}"}]}], 
                    "}"}], "]"}], ",", 
                    RowBox[{"pt1", "[", 
                    RowBox[{"step4", ",", "Black"}], "]"}]}], "}"}]}], "]"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"showstep", "\[GreaterEqual]", "5"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xeq", "[", "step5", "]"}], ",", 
                    RowBox[{"step5", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xop", "[", "step5", "]"}], ",", 
                    RowBox[{"step5", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xop", "[", "step5", "]"}], ",", 
                    RowBox[{"yeq", "[", 
                    RowBox[{"xop", "[", "step5", "]"}], "]"}]}], "}"}]}], 
                    "}"}], "]"}], ",", 
                    RowBox[{"pt1", "[", 
                    RowBox[{"step5", ",", "Black"}], "]"}]}], "}"}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{"solution", ",", 
                   RowBox[{"Line", "@", "stepping"}]}], "]"}]}], 
                "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"NPR", ">", "4"}], ",", 
               RowBox[{"Line", "@", "stepping"}]}], "]"}], ","}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"STEP", " ", "1", " ", "MOLE", " ", "FRACTIONS"}], "*)"}],
            "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NPR", "\[Equal]", "4"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Evaluate", "@", "opt"}], ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xeq", "[", "step1", "]"}], ",", 
                    RowBox[{"step1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xop", "[", "step1", "]"}], ",", 
                    RowBox[{"step1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], "]"}]}],
                 "}"}], ",", 
               RowBox[{"pt1", "[", 
                RowBox[{"step1", ",", "Black"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{"{", 
                  RowBox[{"Dashed", ",", 
                   RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "n", "]"}], ",", 
                    RowBox[{"yeq", "[", 
                    RowBox[{"X", "[", "n", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"n", "-", "1"}], "]"}], ",", 
                    RowBox[{"yN1", "[", 
                    RowBox[{"X", "[", 
                    RowBox[{"n", "-", "1"}], "]"}], "]"}]}], "}"}]}], "}"}], 
                    "]"}], ",", 
                   RowBox[{"pt2", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "n", "]"}], ",", 
                    RowBox[{"yeq", "[", 
                    RowBox[{"X", "[", "n", "]"}], "]"}]}], "}"}], ",", 
                    "Black"}], "]"}], ",", 
                   RowBox[{"pt2", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"n", "-", "1"}], "]"}], ",", 
                    RowBox[{"yN1", "[", 
                    RowBox[{"X", "[", 
                    RowBox[{"n", "-", "1"}], "]"}], "]"}]}], "}"}], ",", 
                    "Black"}], "]"}]}], "}"}]}], "]"}]}], 
              "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NPR", ">", "4"}], ",", 
             RowBox[{"{", 
              RowBox[{"Dashed", ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"X", "[", "n", "]"}], ",", 
                    RowBox[{"yeq", "[", 
                    RowBox[{"X", "[", "n", "]"}], "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"n", "-", "1"}], "]"}], ",", 
                    RowBox[{"yN1", "[", 
                    RowBox[{"X", "[", 
                    RowBox[{"n", "-", "1"}], "]"}], "]"}]}], "}"}]}], "}"}], 
                "]"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"STAGE", " ", "2", " ", "MOLE", " ", "FRACTION"}], "*)"}],
            "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NPR", "\[Equal]", "5"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Evaluate", "@", "opt"}], ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xeq", "[", "step2", "]"}], ",", 
                    RowBox[{"step2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xop", "[", "step2", "]"}], ",", 
                    RowBox[{"step2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], "]"}]}],
                 "}"}], ",", 
               RowBox[{"pt1", "[", 
                RowBox[{"step2", ",", "Black"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{"{", 
                  RowBox[{"Dashed", ",", 
                   RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"n", "-", "2"}], "]"}], ",", 
                    RowBox[{"yeq", "[", 
                    RowBox[{"X", "[", 
                    RowBox[{"n", "-", "2"}], "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"n", "-", "3"}], "]"}], ",", 
                    RowBox[{"yN1", "[", 
                    RowBox[{"X", "[", 
                    RowBox[{"n", "-", "3"}], "]"}], "]"}]}], "}"}]}], "}"}], 
                    "]"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}],
             "]"}], ","}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"(*", 
            RowBox[{"SOLUTION", ",", " ", 
             RowBox[{"NPR", "=", "9"}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NPR", "\[Equal]", "5"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{"textyN1", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"0.2", "*", "xp1"}], ",", "yn1"}], "}"}]}], "]"}], 
               ",", 
               RowBox[{"Text", "[", 
                RowBox[{"textxN", ",", 
                 RowBox[{"{", 
                  RowBox[{"xN", ",", 
                   RowBox[{"0.2", "*", "yn1"}]}], "}"}]}], "]"}], ",", 
               RowBox[{"Text", "[", 
                RowBox[{"texty1", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "y1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1.5", ",", "0"}], "}"}]}], "]"}], ",", 
               RowBox[{"Text", "[", 
                RowBox[{"textx0", ",", 
                 RowBox[{"{", 
                  RowBox[{"x0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "2"}], ",", 
                   RowBox[{"-", "0.75"}]}], "}"}]}], "]"}]}], "}"}]}], "]"}], 
           "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "xp1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"1.1", "*", "yn1"}]}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotRangeClipping", "\[Rule]", "False"}], ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{"\"\<solute/(solute-free liquid) \>\"", ",", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
               "\"\< (ppm)\>\""}], "}"}]}], ",", 
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{"\"\<solute/(solute-free vapor) \>\"", ",", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
               "\"\< (ppm)\>\""}], "}"}]}]}], "}"}]}], ",", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"17", ",", "Black"}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"graphic", "\[And]", 
               RowBox[{"NPR", "<", "8"}]}], ",", "350", ",", "600"}], "]"}], 
            ",", "390"}], "}"}]}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
         RowBox[{"GridLines", "\[Rule]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"NPR", "\[Equal]", "5"}], ",", "None", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{"0", ",", "xp1", ",", "0.05"}], "]"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{"0", ",", 
                RowBox[{"1.1", "*", "yn1"}], ",", "5"}], "]"}]}], "}"}]}], 
           "]"}]}], ",", 
         RowBox[{"GridLinesStyle", "\[Rule]", 
          RowBox[{"GrayLevel", "@", "0.8"}]}], ",", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"55", ",", "10"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"50", ",", 
              RowBox[{"If", "[", 
               RowBox[{"graphic", ",", "5", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"3", "\[LessEqual]", "NPR", "\[LessEqual]", "4"}],
                     ")"}], "\[And]", 
                   RowBox[{"hint", "\[Equal]", "False"}]}], ",", "5", ",", 
                  "27"}], "]"}]}], "]"}]}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"If", "[", 
           RowBox[{"graphic", ",", "None", ",", 
            RowBox[{"Style", "[", 
             RowBox[{"plotlabel", ",", "17"}], "]"}]}], "]"}]}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"NPR", "\[Equal]", "1"}], ",", "column", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"4", "\[LessEqual]", "NPR", "\[LessEqual]", "5"}], ",", 
             "diagram", ",", 
             RowBox[{"If", "[", 
              RowBox[{"graphic", ",", 
               RowBox[{"Grid", "@", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{"diagram", ",", "column"}], "}"}], "}"}]}], ",", 
               "diagram"}], "]"}]}], "]"}]}], "]"}], ",", "stepping"}], "}"}],
        "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Grid", "@", 
    RowBox[{"{", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{"\"\< new problem \>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"reset", "<", "1000"}], ",", 
             RowBox[{"reset", "=", 
              RowBox[{"reset", "+", "1"}]}], ",", 
             RowBox[{"reset", "=", 
              RowBox[{"reset", "-", "1"}]}]}], "]"}], ",", 
           RowBox[{"NPR", "=", "1"}], ",", 
           RowBox[{"solution", "=", "False"}], ",", 
           RowBox[{"hint", "=", "False"}]}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"reset", ",", "1"}], "}"}], ",", "1", ",", "1000", ",", 
          "1", ",", "None"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Button", "[", 
        RowBox[{
         RowBox[{"Dynamic", "@", 
          RowBox[{"Switch", "[", 
           RowBox[{
           "NPR", ",", "1", ",", "\"\<(1) vapor flow rate\>\"", ",", "2", 
            ",", "\"\<(2) draw operating line\>\"", ",", "3", ",", 
            "\"\<(3) draw equilibrium line\>\"", ",", "4", ",", 
            "\"\<(4) step off stages\>\"", ",", "5", ",", 
            "\"\<(5) solution\>\""}], "]"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "200"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PaneSelector", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"##", "&"}], "@@", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], "\[Rule]", 
             RowBox[{"Button", "[", 
              RowBox[{"\"\< next \>\"", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"1", "\[LessEqual]", "NPR", "<", "5"}], ",", 
                   RowBox[{"NPR", "=", 
                    RowBox[{"NPR", "+", "1"}]}], ",", 
                   RowBox[{"NPR", "=", "5"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"solution", "=", "False"}], ";", 
                  RowBox[{"hint", "=", "False"}], ";"}]}], "}"}]}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"Dynamic", "@", "NPR"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"NPR", ",", "4", ",", "\"\<\>\""}], "}"}], ",", 
          RowBox[{"Range", "@", "5"}], ",", "None"}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PaneSelector", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"##", "&"}], "@@", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}],
               "}"}], "\[Rule]", 
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"solution", ",", "False", ",", "\"\<solution\>\""}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}], ",", 
                RowBox[{"Enabled", "\[Rule]", 
                 RowBox[{"If", "[", 
                  RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}], 
               "}"}], "]"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"Dynamic", "@", "NPR"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PaneSelector", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"##", "&"}], "@@", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}],
               "}"}], "\[Rule]", 
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"hint", ",", "False", ",", "\"\<hint\>\""}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"Dynamic", "@", "NPR"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PaneSelector", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"##", "&"}], "@@", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", "3"}], "}"}], "\[Rule]", 
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"graphic", ",", "False", ",", "\"\<column\>\""}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"Dynamic", "@", "NPR"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PaneSelector", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"2", "\[Rule]", 
            RowBox[{"Row", "@", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Control", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"op1", ",", 
                    RowBox[{"{", 
                    RowBox[{"0.2", ",", "80"}], "}"}]}], "}"}], ",", 
                  "Locator", ",", 
                  RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
                  RowBox[{"Enabled", "\[Rule]", 
                   RowBox[{"If", "[", 
                    RowBox[{"solution", ",", "False", ",", "True"}], 
                    "]"}]}]}], "}"}], "]"}], ",", 
               RowBox[{"Control", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"op2", ",", 
                    RowBox[{"{", 
                    RowBox[{"1.15", ",", "80"}], "}"}]}], "}"}], ",", 
                  "Locator", ",", 
                  RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
                  RowBox[{"Enabled", "\[Rule]", 
                   RowBox[{"If", "[", 
                    RowBox[{"solution", ",", "False", ",", "True"}], 
                    "]"}]}]}], "}"}], "]"}]}], "}"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"3", "\[Rule]", 
            RowBox[{"Row", "@", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Control", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"eq1", ",", 
                    RowBox[{"{", 
                    RowBox[{"0.2", ",", "80"}], "}"}]}], "}"}], ",", 
                  "Locator", ",", 
                  RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
                  RowBox[{"Enabled", "\[Rule]", 
                   RowBox[{"If", "[", 
                    RowBox[{"solution", ",", "False", ",", "True"}], 
                    "]"}]}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Control", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"eq2", ",", 
                    RowBox[{"{", 
                    RowBox[{"1.15", ",", "80"}], "}"}]}], "}"}], ",", 
                  "Locator", ",", 
                  RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
                  RowBox[{"Enabled", "\[Rule]", 
                   RowBox[{"If", "[", 
                    RowBox[{"solution", ",", "False", ",", "True"}], 
                    "]"}]}]}], "}"}], "]"}]}], "}"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"4", "\[Rule]", 
            RowBox[{"Control", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"step1", ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "80"}], "}"}]}], "}"}], ",", "Locator", 
               ",", 
               RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
               RowBox[{"Enabled", "\[Rule]", 
                RowBox[{"If", "[", 
                 RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}], 
              "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"5", "\[Rule]", 
            RowBox[{"Control", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"step2", ",", 
                 RowBox[{"{", 
                  RowBox[{"0.8", ",", "60"}], "}"}]}], "}"}], ",", "Locator", 
               ",", 
               RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
               RowBox[{"Enabled", "\[Rule]", 
                RowBox[{"If", "[", 
                 RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}], 
              "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"6", "\[Rule]", 
            RowBox[{"Control", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"step3", ",", 
                 RowBox[{"{", 
                  RowBox[{"0.4", ",", "40"}], "}"}]}], "}"}], ",", "Locator", 
               ",", 
               RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
               RowBox[{"Enabled", "\[Rule]", 
                RowBox[{"If", "[", 
                 RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}], 
              "}"}], "]"}]}]}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Control", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"step4", ",", 
                 RowBox[{"{", 
                  RowBox[{"0.2", ",", "30"}], "}"}]}], "}"}], ",", "Locator", 
               ",", 
               RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
               RowBox[{"Enabled", "\[Rule]", 
                RowBox[{"If", "[", 
                 RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}], 
              "}"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Control", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"step5", ",", 
                 RowBox[{"{", 
                  RowBox[{"0.2", ",", "20"}], "}"}]}], "}"}], ",", "Locator", 
               ",", 
               RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
               RowBox[{"Enabled", "\[Rule]", 
                RowBox[{"If", "[", 
                 RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}], 
              "}"}], "]"}]}], "*)"}], "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"Dynamic", "@", "NPR"}]}], "]"}]}], "\[IndentingNewLine]", 
      "}"}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"PaneSelector", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"1", "\[Rule]", 
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "vapor", ",", "1.2", ",", 
             "\"\<select correct vapor molar flow rate (Mmol/h)\>\""}], "}"}],
            ",", "0.5", ",", "1.5", ",", "0.1", ",", 
           RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"4", "\[Rule]", 
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "showstep", ",", "1", ",", "\"\<show step 1 through\>\""}], "}"}],
            ",", "1", ",", "5", ",", "1", ",", 
           RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
         "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"Dynamic", "@", "NPR"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"SaveDefinitions", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7244269591774397`*^9, 3.724427248922201*^9}, {
   3.7244272816151686`*^9, 3.724427533726758*^9}, {3.724427612938788*^9, 
   3.724427619516219*^9}, {3.7244276861769733`*^9, 3.7244280527479563`*^9}, {
   3.7244281580748053`*^9, 3.7244281718760757`*^9}, {3.7244283259595137`*^9, 
   3.724428336865571*^9}, {3.7256337843857336`*^9, 3.725633902836152*^9}, {
   3.725633986923793*^9, 3.7256340024038734`*^9}, {3.725634049319312*^9, 
   3.7256340930287533`*^9}, {3.7256341902276497`*^9, 
   3.7256343955567083`*^9}, {3.7256347366249657`*^9, 3.725634748907222*^9}, {
   3.725635649765316*^9, 3.7256356650381956`*^9}, {3.725635736722159*^9, 
   3.725635753316256*^9}, {3.725635808287141*^9, 3.725635810507345*^9}, {
   3.7256358462379255`*^9, 3.725635878335907*^9}, {3.725635926273141*^9, 
   3.7256359412290196`*^9}, {3.7256359775355988`*^9, 
   3.7256360922323985`*^9}, {3.7256361268367815`*^9, 
   3.7256361536309347`*^9}, {3.7256361954605484`*^9, 
   3.7256362826751947`*^9}, {3.7256368280430284`*^9, 
   3.7256368631728077`*^9}, {3.7256369060084305`*^9, 3.725636954772487*^9}, {
   3.725636996879095*^9, 3.7256370521723824`*^9}, {3.7256371258289623`*^9, 
   3.7256372583020296`*^9}, {3.7256372904888005`*^9, 3.725637394959732*^9}, {
   3.725637433500331*^9, 3.7256375223677826`*^9}, {3.725637742361493*^9, 
   3.725637782528098*^9}, {3.725637875866581*^9, 3.725637896068082*^9}, 
   3.725638041776223*^9, {3.725638142343937*^9, 3.725638285106061*^9}, {
   3.7256383265982847`*^9, 3.725638331560512*^9}, {3.725638393658019*^9, 
   3.725638401273255*^9}, {3.72563895608533*^9, 3.725639129495629*^9}, {
   3.7256392519659495`*^9, 3.725639297908798*^9}, {3.7256395530324306`*^9, 
   3.725639616394742*^9}, {3.725639815384353*^9, 3.725639855020756*^9}, 
   3.725648164219879*^9},ExpressionUUID->"6c1dcaca-23c6-48e7-89bc-\
450f4fd8554f"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`eq1$$ = {0.2, 80}, $CellContext`eq2$$ = {
    1.15, 80}, $CellContext`graphic$$ = False, $CellContext`hint$$ = 
    False, $CellContext`NPR$$ = 4, $CellContext`op1$$ = {
    0.2, 80}, $CellContext`op2$$ = {1.15, 80}, $CellContext`reset$$ = 
    1, $CellContext`showstep$$ = 1, $CellContext`solution$$ = 
    False, $CellContext`step1$$ = {1, 80}, $CellContext`step2$$ = {
    0.8, 60}, $CellContext`step3$$ = {0.4, 40}, $CellContext`vapor$$ = 1.2, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`reset$$], 1}, 1, 1000, 1}, {{
       Hold[$CellContext`NPR$$], 4, ""}, {1, 2, 3, 4, 5}}, {{
       Hold[$CellContext`solution$$], False, "solution"}, {True, False}}, {{
       Hold[$CellContext`hint$$], False, "hint"}, {True, False}}, {{
       Hold[$CellContext`graphic$$], False, "column"}, {True, False}}, {{
       Hold[$CellContext`op1$$], {0.2, 80}}, Automatic}, {{
       Hold[$CellContext`op2$$], {1.15, 80}}, Automatic}, {{
       Hold[$CellContext`eq1$$], {0.2, 80}}, Automatic}, {{
       Hold[$CellContext`eq2$$], {1.15, 80}}, Automatic}, {{
       Hold[$CellContext`step1$$], {1, 80}}, Automatic}, {{
       Hold[$CellContext`step2$$], {0.8, 60}}, Automatic}, {{
       Hold[$CellContext`step3$$], {0.4, 40}}, Automatic}, {
      Hold[
       Grid[{{
          Button[" new problem ", {
            
            If[$CellContext`reset$$ < 
             1000, $CellContext`reset$$ = $CellContext`reset$$ + 
              1, $CellContext`reset$$ = $CellContext`reset$$ - 
              1], $CellContext`NPR$$ = 1, $CellContext`solution$$ = 
            False, $CellContext`hint$$ = False}], 
          Manipulate`Place[1], 
          Button[
           Dynamic[
            
            Switch[$CellContext`NPR$$, 1, "(1) vapor flow rate", 2, 
             "(2) draw operating line", 3, "(3) draw equilibrium line", 4, 
             "(4) step off stages", 5, "(5) solution"]], ImageSize -> 200], 
          PaneSelector[{1 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 5], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 5], $CellContext`solution$$ = 
                False; $CellContext`hint$$ = False; Null}], 2 -> 
            Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 5], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 5], $CellContext`solution$$ = 
                False; $CellContext`hint$$ = False; Null}], 3 -> 
            Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 5], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 5], $CellContext`solution$$ = 
                False; $CellContext`hint$$ = False; Null}], 4 -> 
            Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 5], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 5], $CellContext`solution$$ = 
                False; $CellContext`hint$$ = False; Null}]}, 
           Dynamic[$CellContext`NPR$$]], 
          Manipulate`Place[2], 
          
          PaneSelector[{
           1 -> Manipulate`Place[3], 2 -> Manipulate`Place[3], 3 -> 
            Manipulate`Place[3], 4 -> Manipulate`Place[3], 5 -> 
            Manipulate`Place[3], 6 -> Manipulate`Place[3]}, 
           Dynamic[$CellContext`NPR$$]], 
          
          PaneSelector[{
           1 -> Manipulate`Place[4], 2 -> Manipulate`Place[4], 3 -> 
            Manipulate`Place[4], 4 -> Manipulate`Place[4], 5 -> 
            Manipulate`Place[4], 6 -> Manipulate`Place[4]}, 
           Dynamic[$CellContext`NPR$$]], 
          PaneSelector[{2 -> Manipulate`Place[5], 3 -> Manipulate`Place[5]}, 
           Dynamic[$CellContext`NPR$$]], 
          PaneSelector[{2 -> Row[{
               Manipulate`Place[6], 
               Manipulate`Place[7]}], 3 -> Row[{
               Manipulate`Place[8], 
               Manipulate`Place[9]}], 4 -> Manipulate`Place[10], 5 -> 
            Manipulate`Place[11], 6 -> Manipulate`Place[12]}, 
           Dynamic[$CellContext`NPR$$]]}}]], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`vapor$$], 1.2, 
       "select correct vapor molar flow rate (Mmol/h)"}, 0.5, 1.5, 0.1}, {{
       Hold[$CellContext`showstep$$], 1, "show step 1 through"}, 1, 5, 1}, {
      Hold[
       PaneSelector[{1 -> Manipulate`Place[13], 4 -> Manipulate`Place[14]}, 
        Dynamic[$CellContext`NPR$$]]], Manipulate`Dump`ThisIsNotAControl}}, 
    Typeset`size$$ = {731., {199., 206.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    False, $CellContext`reset$2952$$ = 0, $CellContext`NPR$2957$$ = 
    0, $CellContext`solution$2958$$ = False, $CellContext`hint$2959$$ = 
    False, $CellContext`graphic$2960$$ = False, $CellContext`vapor$2961$$ = 
    0, $CellContext`showstep$2962$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`eq1$$ = {0.2, 80}, $CellContext`eq2$$ = {
         1.15, 80}, $CellContext`graphic$$ = False, $CellContext`hint$$ = 
        False, $CellContext`NPR$$ = 
        4, $CellContext`op1$$ = {0.2, 80}, $CellContext`op2$$ = {
         1.15, 80}, $CellContext`reset$$ = 1, $CellContext`showstep$$ = 
        1, $CellContext`solution$$ = 
        False, $CellContext`step1$$ = {1, 80}, $CellContext`step2$$ = {
         0.8, 60}, $CellContext`step3$$ = {0.4, 40}, $CellContext`vapor$$ = 
        1.2}, "ControllerVariables" :> {
        Hold[$CellContext`reset$$, $CellContext`reset$2952$$, 0], 
        Hold[$CellContext`NPR$$, $CellContext`NPR$2957$$, 0], 
        Hold[$CellContext`solution$$, $CellContext`solution$2958$$, False], 
        Hold[$CellContext`hint$$, $CellContext`hint$2959$$, False], 
        Hold[$CellContext`graphic$$, $CellContext`graphic$2960$$, False], 
        Hold[$CellContext`vapor$$, $CellContext`vapor$2961$$, 0], 
        Hold[$CellContext`showstep$$, $CellContext`showstep$2962$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`P$, $CellContext`T$, $CellContext`L0$, \
$CellContext`Ea$, $CellContext`R$, $CellContext`H0$, $CellContext`HB$, \
$CellContext`L$, $CellContext`V$, $CellContext`x0$, $CellContext`y1$, \
$CellContext`yn1$, $CellContext`yN1$, $CellContext`yeq$, $CellContext`xp1$, \
$CellContext`xp2$, $CellContext`intersect$, $CellContext`check1$, \
$CellContext`check2$, $CellContext`stage$, $CellContext`test$, \
$CellContext`n$, $CellContext`steps$, $CellContext`stepping$, \
$CellContext`xN$, $CellContext`X$, $CellContext`xeq$, $CellContext`xop$, \
$CellContext`plotlabel$, $CellContext`h$, $CellContext`w$, $CellContext`ry$, \
$CellContext`column$, $CellContext`opt$, $CellContext`pt1$, \
$CellContext`pt2$, $CellContext`diagram$}, 
        SeedRandom[$CellContext`reset$$]; $CellContext`P$ = 
         RandomReal[{2.5, 3}]; $CellContext`T$ = 
         RandomInteger[{10, 25}]; $CellContext`L0$ = 
         RandomInteger[{115, 200}]; $CellContext`Ea$ = 5000; $CellContext`R$ = 
         8.314; $CellContext`H0$ = ReplaceAll[$CellContext`Hi, 
           Part[
            Solve[
            211.19 == $CellContext`Hi 
              Exp[-(5000/($CellContext`R$ 298))], $CellContext`Hi], 
            1]]; $CellContext`HB$ = $CellContext`H0$ 
          Exp[-($CellContext`Ea$/($CellContext`R$ ($CellContext`T$ + 
              273)))]; $CellContext`L$ = 
         1000 $CellContext`L0$; $CellContext`V$ = 1000; $CellContext`x0$ = 
         0.05; $CellContext`y1$ = 10; $CellContext`yn1$ = 
         100; $CellContext`yN1$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := ($CellContext`L$/$CellContext`V$) ($CellContext`x$ - \
$CellContext`x0$) + $CellContext`y1$; $CellContext`yeq$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := ($CellContext`HB$/$CellContext`P$) $CellContext`x$; \
$CellContext`xp1$ = 1.35; $CellContext`xp2$ = ReplaceAll[$CellContext`x, 
           
           FindRoot[$CellContext`yN1$[$CellContext`x] == 
            1.1 $CellContext`yn1$, {$CellContext`x, 
             0}]]; $CellContext`intersect$ = ReplaceAll[$CellContext`x, 
           Quiet[
            Part[
             
             Solve[$CellContext`yN1$[$CellContext`x] == \
$CellContext`yeq$[$CellContext`x], $CellContext`x], 
             1]]]; $CellContext`check1$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yN1$[$CellContext`x] == $CellContext`yn1$, \
$CellContext`x], 1]]; $CellContext`check2$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yeq$[$CellContext`x] == \
$CellContext`yN1$[$CellContext`x], $CellContext`x], 1]]; $CellContext`stage$[
          1] = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yeq$[$CellContext`x] == $CellContext`y1$, \
$CellContext`x], 1]]; 
        Do[$CellContext`stage$[$CellContext`i] = ReplaceAll[$CellContext`x, 
            Part[
             Solve[$CellContext`yeq$[$CellContext`x] == $CellContext`yN1$[
                $CellContext`stage$[$CellContext`i - 1]], $CellContext`x], 
             1]], {$CellContext`i, 2, 100}]; $CellContext`test$ = Table[
           $CellContext`stage$[$CellContext`n$], {$CellContext`n$, 1, 
            50}]; $CellContext`n$ = 1; While[
          And[
          Part[$CellContext`test$, $CellContext`n$] < $CellContext`check1$, 
           
           If[$CellContext`check2$ > 
            0, $CellContext`yeq$[$CellContext`check2$] > $CellContext`yn1$, 
            True]], 
          Increment[$CellContext`n$]]; $CellContext`steps$ = Flatten[
           Table[{{
              Part[$CellContext`test$, $CellContext`i], 
              $CellContext`yeq$[
               Part[$CellContext`test$, $CellContext`i]]}, {
              Part[$CellContext`test$, $CellContext`i], 
              $CellContext`yN1$[
               Part[$CellContext`test$, $CellContext`i]]}}, {$CellContext`i, 
             1, $CellContext`n$}], 1]; $CellContext`stepping$ = ReplacePart[
           
           Join[{{$CellContext`x0$, $CellContext`y1$}}, $CellContext`steps$], \
{2 $CellContext`n$ + 1, 2} -> $CellContext`yn1$]; $CellContext`xN$ = 
         Part[$CellContext`stepping$, -2, 1]; $CellContext`X$[
           Pattern[$CellContext`i$, 
            Blank[]]] := 
         Part[$CellContext`stepping$, 2 $CellContext`i$, 1]; $CellContext`xeq$[
           Pattern[$CellContext`y$, 
            Blank[]]] := ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`yeq$[$CellContext`x] == 
             Part[$CellContext`y$, 2], {$CellContext`x, 
              0}]]]; $CellContext`xop$[
           Pattern[$CellContext`y$, 
            Blank[]]] := ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`yN1$[$CellContext`x] == 
             Part[$CellContext`y$, 2], {$CellContext`x, 
              0}]]]; $CellContext`plotlabel$ = Switch[$CellContext`NPR$$, 2, 
           
           If[$CellContext`hint$$, "hint: use the mass balance from step 1", 
            "step 2: click and drag the points to create the operating line, \
then check solution"], 3, 
           If[$CellContext`hint$$, "hint: use Henry's law", 
            
            Column[{"step 3: click and drag the points to create the \
equilibrium line, then check solution", 
              Row[{
                Style["P", Italic], " = ", 
                NumberForm[$CellContext`P$, {3, 1}], " atm and ", 
                Style["H", Italic], " = ", 
                NumberForm[$CellContext`HB$, {4, 1}], 
                " atm/mole fraction"}]}]], 4, 
           If[$CellContext`hint$$, 
            Row[{"hint: start at ", 
              Style[
               Subscript["x", "N"], Italic]}], 
            "step 4: determine the mole fractions leaving stage 1, then check \
solution"], 5, 
           Row[{"solved ", 
             Style["x", Italic], "-", 
             Style["y", Italic], " diagram"}]]; $CellContext`h$ = 
         13; $CellContext`w$ = 
         If[$CellContext`NPR$$ == 1, 6, 12]; $CellContext`ry$ = 
         2; $CellContext`column$ = Graphics[{Thick, 
            Map[
            Line[{{#, $CellContext`ry$}, {#, $CellContext`h$ - \
$CellContext`ry$}}]& , {0, $CellContext`w$}], 
            
            Circle[{$CellContext`w$/2, $CellContext`ry$}, {$CellContext`w$/
              2, $CellContext`ry$}, {Pi, 2 Pi}], 
            
            Circle[{$CellContext`w$/
              2, $CellContext`h$ - $CellContext`ry$}, {$CellContext`w$/
              2, $CellContext`ry$}, {0, Pi}], {
             Arrowheads[
              If[$CellContext`NPR$$ == 1, 0.065, 0.09]], $CellContext`colV, 
             
             Arrow[{{-$CellContext`w$, (-$CellContext`h$)/4}, {
               0.25 $CellContext`w$, (-$CellContext`h$)/4}, {
               0.25 $CellContext`w$, $CellContext`ry$/10}}], 
             
             Arrow[{{0.25 $CellContext`w$, $CellContext`h$ - $CellContext`ry$/
                10}, {0.25 $CellContext`w$, $CellContext`h$ + $CellContext`h$/
                 4}, {-$CellContext`w$, $CellContext`h$ + $CellContext`h$/
                 4}}], $CellContext`colL, 
             
             Arrow[{{0.75 $CellContext`w$, $CellContext`ry$/10}, {
               0.75 $CellContext`w$, (-$CellContext`h$)/4}, {
               2 $CellContext`w$, (-$CellContext`h$)/4}}], 
             
             Arrow[{{2 $CellContext`w$, $CellContext`h$ + $CellContext`h$/
                 4}, {0.75 $CellContext`w$, $CellContext`h$ + $CellContext`h$/
                 4}, {0.75 $CellContext`w$, $CellContext`h$ - \
$CellContext`ry$/10}}]}, 
            Text[
             Style[
              Column[{
                Row[{
                  NumberForm[$CellContext`P$, {3, 1}], " atm"}], 
                Spacer[0], 
                Row[{
                  NumberForm[$CellContext`T$, {4, 0}], " \[Degree]C"}]}, 
               Center], 
              If[$CellContext`NPR$$ == 1, 17, 16]], {
             0.5 $CellContext`w$, 0.5 $CellContext`h$}], 
            Text[
             Style[
              If[$CellContext`NPR$$ > 1, 
               Row[{
                 Style["L", Italic], " = ", $CellContext`L$/1000, " Mmol/h"}], 
               Column[{"liquid solvent feed", 
                 Row[{
                   Style["L", Italic], " = ", $CellContext`L$/1000, 
                   " Mmol/h"}]}, Right]], 
              
              If[$CellContext`NPR$$ == 1, 17, 
               16], $CellContext`colL], {$CellContext`w$, $CellContext`h$ + \
$CellContext`h$/4}, {-0.5, -1.2}], 
            Text[
             Style[
              If[$CellContext`NPR$$ > 1, 
               Row[{
                 Style["V", Italic], " = ", $CellContext`V$/1000, " Mmol/h"}], 
               Column[{"vapor feed", 
                 Row[{
                   Style["V", Italic], " = ", $CellContext`vapor$$, " Mmol/h", 
                   Spacer[35], 
                   If[
                    And[$CellContext`NPR$$ == 1, $CellContext`solution$$], 
                    Row[{"actual ", 
                    Style["V", Italic], " = ", $CellContext`V$/1000, 
                    " Mmol/h"}]]}]}]], 
              If[$CellContext`NPR$$ == 1, 17, 16], $CellContext`colV], {
             0, (-$CellContext`h$)/4}, {
              If[$CellContext`NPR$$ == 1, 
               If[$CellContext`solution$$, -0.2, 0.5], 0.5], 1.4}], 
            Apply[Text[
              Style[
               Row[{
                 Subscript[
                  Style["y", Italic], #2], " = ", #, " ppm"}], 
               If[$CellContext`NPR$$ == 1, 17, 16], $CellContext`colV, 
               Background -> White], {0, #3}, {
              0.5, 0}]& , {{$CellContext`y1$, 1, $CellContext`h$ + 
               2}, {$CellContext`yn1$, 
               Row[{
                 Style["N", Italic], "+1"}], -2}}, {1}], 
            Apply[Text[
              Style[
               Row[{
                 Subscript[
                  Style["x", Italic], #2], " = ", #, " ppm"}], 
               If[$CellContext`NPR$$ == 1, 17, 16], $CellContext`colL, 
               Background -> White], {$CellContext`w$, #3}, {-0.5, 
               0}]& , {{$CellContext`x0$, 0, $CellContext`h$ + 2}, {
               NumberForm[$CellContext`xN$, 2], 
               Style["N", Italic], -2}}, {1}]}, ImageSize -> {
             If[$CellContext`NPR$$ == 1, 600, 250], 390}, 
           ImagePadding -> {{10, 10}, {45, 
              If[$CellContext`NPR$$ == 1, 50, 25]}}, AspectRatio -> 
           If[$CellContext`NPR$$ == 1, 0.75, Full], PlotLabel -> 
           If[$CellContext`NPR$$ == 1, 
             Style[
              
              If[$CellContext`hint$$, "hint: use mass balance on solute", 
               "step 1: calculate the vapor flow rate, then check solution"], 
              17, Black], None]]; $CellContext`opt$ = Sequence[
           Thickness[
            If[
             And[$CellContext`graphic$$, $CellContext`NPR$$ < 4], 0.011, 
             0.008]], Dotted]; $CellContext`pt1$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`col$, 
            Blank[]]] := {$CellContext`col$, 
           PointSize[
            If[
             And[$CellContext`graphic$$, $CellContext`NPR$$ < 4], 0.04, 
             0.025]], 
           Point[$CellContext`pt$], White, 
           PointSize[
            If[
             And[$CellContext`graphic$$, $CellContext`NPR$$ < 4], 0.025, 
             0.015]], 
           Point[$CellContext`pt$]}; $CellContext`pt2$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`col$, 
            Blank[]]] := {$CellContext`col$, 
           PointSize[
            If[$CellContext`graphic$$, 0.035, 0.02]], 
           Point[$CellContext`pt$]}; $CellContext`diagram$ = Graphics[{Thick, 
            If[$CellContext`NPR$$ == 2, {{
               Evaluate[$CellContext`opt$], $CellContext`colOP, 
               Line[{$CellContext`op1$$, $CellContext`op2$$}]}, 
              $CellContext`pt1$[$CellContext`op1$$, $CellContext`colOP], 
              $CellContext`pt1$[$CellContext`op2$$, $CellContext`colOP], 
              If[$CellContext`solution$$ == False, {
                Text[
                 Style[
                  Column[{
                    Row[{
                    Style["x", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`op1$$, 1], {4, 2}], " ppm"}], 
                    Row[{
                    Style["y", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`op1$$, 2], {3, 0}], " ppm"}]}, 
                   Alignment -> "="], 17, $CellContext`colOP, Background -> 
                  White], $CellContext`op1$$, {-1, -1.3}], 
                Text[
                 Style[
                  Column[{
                    Row[{
                    Style["x", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`op2$$, 1], {4, 2}], " ppm"}], 
                    Row[{
                    Style["y", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`op2$$, 2], {3, 0}], " ppm"}]}, 
                   Alignment -> "="], 17, $CellContext`colOP, Background -> 
                  White], $CellContext`op2$$, {1, 1.5}]}], 
              If[$CellContext`solution$$, {$CellContext`colOP, 
                Line[
                 Map[{#, 
                   $CellContext`yN1$[#]}& , 
                  Range[0, $CellContext`xp2$, 0.01]]]}]}], 
            If[$CellContext`NPR$$ > 2, {$CellContext`colOP, 
              Line[
               Map[{#, 
                 $CellContext`yN1$[#]}& , 
                Range[0, $CellContext`xp2$, 0.01]]]}], 
            If[$CellContext`NPR$$ == 3, {{
               Evaluate[$CellContext`opt$], $CellContext`colEQ, 
               Line[{$CellContext`eq1$$, $CellContext`eq2$$}]}, 
              $CellContext`pt1$[$CellContext`eq1$$, $CellContext`colEQ], 
              $CellContext`pt1$[$CellContext`eq2$$, $CellContext`colEQ], 
              If[$CellContext`solution$$ == False, {
                Text[
                 Style[
                  Column[{
                    Row[{
                    Style["x", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`eq1$$, 1], {4, 2}], " ppm"}], 
                    Row[{
                    Style["y", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`eq1$$, 2], {3, 0}], " ppm"}]}, 
                   Alignment -> "="], 17, $CellContext`colEQ, Background -> 
                  White], $CellContext`eq1$$, {-1, -1.3}], 
                Text[
                 Style[
                  Column[{
                    Row[{
                    Style["x", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`eq2$$, 1], {4, 2}], " ppm"}], 
                    Row[{
                    Style["y", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`eq2$$, 2], {3, 0}], " ppm"}]}, 
                   Alignment -> "="], 17, $CellContext`colEQ, Background -> 
                  White], $CellContext`eq2$$, {1, 1.5}]}], 
              If[$CellContext`solution$$, {$CellContext`colEQ, 
                Line[
                 Map[{#, 
                   $CellContext`yeq$[#]}& , 
                  Range[0, $CellContext`xp1$, 0.01]]]}]}], 
            If[$CellContext`NPR$$ > 3, {$CellContext`colEQ, 
              Line[
               Map[{#, 
                 $CellContext`yeq$[#]}& , 
                Range[0, $CellContext`xp1$, 0.01]]], {
              Dashed, $CellContext`colV, 
               Line[{{
                 0, $CellContext`yn1$}, {$CellContext`xp1$, \
$CellContext`yn1$}}], 
               
               Text[$CellContext`textyN1, {
                0.2 $CellContext`xp1$, $CellContext`yn1$}], 
               $CellContext`pt2$[{0, $CellContext`y1$}, $CellContext`colV], 
               Text[$CellContext`texty1, {0, $CellContext`y1$}, {1.5, 0}]}, {
              Dashed, $CellContext`colL, 
               
               Line[{{$CellContext`xN$, 
                  0}, {$CellContext`xN$, $CellContext`yn1$}}], 
               
               Text[$CellContext`textxN, {$CellContext`xN$, 
                 0.2 $CellContext`yn1$}], 
               $CellContext`pt2$[{$CellContext`x0$, 0}, $CellContext`colL], 
               
               Text[$CellContext`textx0, {$CellContext`x0$, 
                 0}, {-2, -0.75}]}}], 
            If[$CellContext`NPR$$ == 4, {{
               Evaluate[$CellContext`opt$], 
               Line[{{
                  $CellContext`xeq$[$CellContext`step1$$], 
                  Part[$CellContext`step1$$, 2]}, {
                  $CellContext`xop$[$CellContext`step1$$], 
                  Part[$CellContext`step1$$, 2]}}]}, 
              $CellContext`pt1$[$CellContext`step1$$, Black], 
              If[$CellContext`solution$$, {Dashed, 
                Line[{{
                   $CellContext`X$[$CellContext`n$], 
                   $CellContext`yeq$[
                    $CellContext`X$[$CellContext`n$]]}, {
                   $CellContext`X$[$CellContext`n$ - 1], 
                   $CellContext`yN1$[
                    $CellContext`X$[$CellContext`n$ - 1]]}}], 
                $CellContext`pt2$[{
                  $CellContext`X$[$CellContext`n$], 
                  $CellContext`yeq$[
                   $CellContext`X$[$CellContext`n$]]}, Black], 
                $CellContext`pt2$[{
                  $CellContext`X$[$CellContext`n$ - 1], 
                  $CellContext`yN1$[
                   $CellContext`X$[$CellContext`n$ - 1]]}, Black]}]}], 
            If[$CellContext`NPR$$ > 4, {Dashed, 
              Line[{{
                 $CellContext`X$[$CellContext`n$], 
                 $CellContext`yeq$[
                  $CellContext`X$[$CellContext`n$]]}, {
                 $CellContext`X$[$CellContext`n$ - 1], 
                 $CellContext`yN1$[
                  $CellContext`X$[$CellContext`n$ - 1]]}}]}], 
            If[$CellContext`NPR$$ == 5, {{
               Evaluate[$CellContext`opt$], 
               Line[{{
                  $CellContext`xeq$[$CellContext`step2$$], 
                  Part[$CellContext`step2$$, 2]}, {
                  $CellContext`xop$[$CellContext`step2$$], 
                  Part[$CellContext`step2$$, 2]}}]}, 
              $CellContext`pt1$[$CellContext`step2$$, Black], 
              If[$CellContext`solution$$, {Dashed, 
                Line[{{
                   $CellContext`X$[$CellContext`n$ - 2], 
                   $CellContext`yeq$[
                    $CellContext`X$[$CellContext`n$ - 2]]}, {
                   $CellContext`X$[$CellContext`n$ - 3], 
                   $CellContext`yN1$[
                    $CellContext`X$[$CellContext`n$ - 3]]}}]}]}], Null}, 
           PlotRange -> {{0, $CellContext`xp1$}, {0, 1.1 $CellContext`yn1$}}, 
           PlotRangeClipping -> False, Frame -> True, FrameLabel -> {
             Row[{"solute/(solute-free liquid) ", 
               Style["x", Italic], " (ppm)"}], 
             Row[{"solute/(solute-free vapor) ", 
               Style["y", Italic], " (ppm)"}]}, LabelStyle -> {17, Black}, 
           ImageSize -> {
             If[
              And[$CellContext`graphic$$, $CellContext`NPR$$ < 8], 350, 600], 
             390}, AspectRatio -> Full, GridLines -> 
           If[$CellContext`NPR$$ == 5, None, {
              Range[0, $CellContext`xp1$, 0.05], 
              Range[0, 1.1 $CellContext`yn1$, 5]}], GridLinesStyle -> 
           GrayLevel[0.8], ImagePadding -> {{55, 10}, {50, 
              If[$CellContext`graphic$$, 5, 
               If[
                And[
                3 <= $CellContext`NPR$$ <= 4, $CellContext`hint$$ == False], 
                5, 27]]}}, PlotLabel -> If[$CellContext`graphic$$, None, 
             Style[$CellContext`plotlabel$, 17]]]; Column[{
           If[$CellContext`NPR$$ == 1, $CellContext`column$, 
            If[4 <= $CellContext`NPR$$ <= 5, $CellContext`diagram$, 
             If[$CellContext`graphic$$, 
              
              Grid[{{$CellContext`diagram$, $CellContext`column$}}], \
$CellContext`diagram$]]], $CellContext`stepping$}]], 
      "Specifications" :> {{{$CellContext`reset$$, 1}, 1, 1000, 1, 
         ControlType -> None, ControlPlacement -> 
         1}, {{$CellContext`NPR$$, 4, ""}, {1, 2, 3, 4, 5}, ControlType -> 
         None, ControlPlacement -> 
         2}, {{$CellContext`solution$$, False, "solution"}, {True, False}, 
         Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         3}, {{$CellContext`hint$$, False, "hint"}, {True, False}, 
         ControlPlacement -> 4}, {{$CellContext`graphic$$, False, "column"}, {
         True, False}, ControlPlacement -> 
         5}, {{$CellContext`op1$$, {0.2, 80}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         6}, {{$CellContext`op2$$, {1.15, 80}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         7}, {{$CellContext`eq1$$, {0.2, 80}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         8}, {{$CellContext`eq2$$, {1.15, 80}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         9}, {{$CellContext`step1$$, {1, 80}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         10}, {{$CellContext`step2$$, {0.8, 60}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         11}, {{$CellContext`step3$$, {0.4, 40}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 12}, 
        Grid[{{
           Button[" new problem ", {
             
             If[$CellContext`reset$$ < 
              1000, $CellContext`reset$$ = $CellContext`reset$$ + 
               1, $CellContext`reset$$ = $CellContext`reset$$ - 
               1], $CellContext`NPR$$ = 1, $CellContext`solution$$ = 
             False, $CellContext`hint$$ = False}], 
           Manipulate`Place[1], 
           Button[
            Dynamic[
             
             Switch[$CellContext`NPR$$, 1, "(1) vapor flow rate", 2, 
              "(2) draw operating line", 3, "(3) draw equilibrium line", 4, 
              "(4) step off stages", 5, "(5) solution"]], ImageSize -> 200], 
           PaneSelector[{1 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  5], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 5], $CellContext`solution$$ = 
                 False; $CellContext`hint$$ = False; Null}], 2 -> 
             Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  5], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 5], $CellContext`solution$$ = 
                 False; $CellContext`hint$$ = False; Null}], 3 -> 
             Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  5], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 5], $CellContext`solution$$ = 
                 False; $CellContext`hint$$ = False; Null}], 4 -> 
             Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  5], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 5], $CellContext`solution$$ = 
                 False; $CellContext`hint$$ = False; Null}]}, 
            Dynamic[$CellContext`NPR$$]], 
           Manipulate`Place[2], 
           
           PaneSelector[{
            1 -> Manipulate`Place[3], 2 -> Manipulate`Place[3], 3 -> 
             Manipulate`Place[3], 4 -> Manipulate`Place[3], 5 -> 
             Manipulate`Place[3], 6 -> Manipulate`Place[3]}, 
            Dynamic[$CellContext`NPR$$]], 
           
           PaneSelector[{
            1 -> Manipulate`Place[4], 2 -> Manipulate`Place[4], 3 -> 
             Manipulate`Place[4], 4 -> Manipulate`Place[4], 5 -> 
             Manipulate`Place[4], 6 -> Manipulate`Place[4]}, 
            Dynamic[$CellContext`NPR$$]], 
           PaneSelector[{2 -> Manipulate`Place[5], 3 -> Manipulate`Place[5]}, 
            Dynamic[$CellContext`NPR$$]], 
           PaneSelector[{2 -> Row[{
                Manipulate`Place[6], 
                Manipulate`Place[7]}], 3 -> Row[{
                Manipulate`Place[8], 
                Manipulate`Place[9]}], 4 -> Manipulate`Place[10], 5 -> 
             Manipulate`Place[11], 6 -> Manipulate`Place[12]}, 
            Dynamic[$CellContext`NPR$$]]}}], {{$CellContext`vapor$$, 1.2, 
          "select correct vapor molar flow rate (Mmol/h)"}, 0.5, 1.5, 0.1, 
         Appearance -> "Labeled", ControlPlacement -> 
         13}, {{$CellContext`showstep$$, 1, "show step 1 through"}, 1, 5, 1, 
         Appearance -> "Labeled", ControlPlacement -> 14}, 
        PaneSelector[{1 -> Manipulate`Place[13], 4 -> Manipulate`Place[14]}, 
         Dynamic[$CellContext`NPR$$]]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{786., {262., 269.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({
      Attributes[Subscript] = {NHoldRest}, $CellContext`colV = 
       RGBColor[0, 0.6, 0], $CellContext`colL = 
       RGBColor[0, 0, 1], $CellContext`colOP = 
       RGBColor[1, 0, 1], $CellContext`colEQ = 
       RGBColor[1, 0.4, 0], $CellContext`textyN1 = Style[
         Subscript[
          Style["y", Italic], 
          Row[{
            Style["N", Italic], "+1"}]], 17, 
         RGBColor[0, 0.6, 0], Background -> 
         GrayLevel[1]], $CellContext`texty1 = Style[
         Subscript[
          Style["y", Italic], 1], 17, 
         RGBColor[0, 0.6, 0], Background -> 
         GrayLevel[1]], $CellContext`textxN = Style[
         Subscript["x", "N"], Italic, 17, 
         RGBColor[0, 0, 1], Background -> GrayLevel[1]], $CellContext`textx0 = 
       Style[
         Subscript[
          Style["x", Italic], 0], 17, 
         RGBColor[0, 0, 1], Background -> GrayLevel[1]]}; 
     Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.7256481848557973`*^9, 3.7257164929935875`*^9},
 CellID->578107179,ExpressionUUID->"3ed31c51-268e-42d1-9ae9-a42c3c6afdab"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"xN1", "=", 
   RowBox[{"stepping", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"-", "3"}], ",", "1"}], "]"}], "]"}]}], ";", 
  RowBox[{"xN2", "=", 
   RowBox[{"stepping", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"-", "5"}], ",", "1"}], "]"}], "]"}]}], ";", 
  RowBox[{"xN3", "=", 
   RowBox[{"stepping", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"-", "7"}], ",", "1"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.725638532051329*^9, 3.7256386426300964`*^9}},
 CellID->100765946,ExpressionUUID->"dbde175a-1e41-40e8-b965-1e6efc8cfc37"],

Cell[BoxData[
 RowBox[{
  RowBox[{"x1", "=", 
   RowBox[{"stepping", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", 
  RowBox[{"x2", "=", 
   RowBox[{"stepping", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "1"}], "]"}], "]"}]}], ";", 
  RowBox[{"x3", "=", 
   RowBox[{"stepping", "[", 
    RowBox[{"[", 
     RowBox[{"6", ",", "1"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7256387610974903`*^9, 3.725638811450944*^9}},
 CellID->9751210,ExpressionUUID->"237ee353-d65b-46fe-aff0-c4fc358f5a30"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"X", "[", "i_", "]"}], ":=", 
   RowBox[{"stepping", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"2", "*", "i"}], ",", "1"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7256388748328857`*^9, 3.725638884119174*^9}},
 CellID->367643921,ExpressionUUID->"847a7b5e-374a-47f9-bf7c-f8d271c608f5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "5", ",", "7"}], "}"}]], "Input",
 CellChangeTimes->{{3.7256386456699038`*^9, 3.7256386483683243`*^9}},
 CellID->726117222,ExpressionUUID->"038380ad-d738-4992-9eb0-7088ce1490ab"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2", "+", "#"}], ")"}], "&"}], "/@", 
  RowBox[{"Range", "@", "3"}]}]], "Input",
 CellChangeTimes->{{3.725638659056378*^9, 3.725638670472831*^9}},
 CellID->393932400,ExpressionUUID->"a67ec127-007c-454a-ad83-2d39851b3a57"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "4", ",", "5"}], "}"}]], "Output",
 CellChangeTimes->{3.725638670925232*^9},
 CellID->38448888,ExpressionUUID->"56953111-20d2-4db8-af3e-8eec717f04d1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ManipulateCaptionSection",ExpressionUUID->"20302b80-7d90-4ffa-8061-088de661eb2e"],

Cell[TextData[{
 "This Demonstration leads the user through a step-by-step procedure to \
construct a x-y diagram for a trayed absorption column that is used to remove \
an impurity from a gas feed by absorbing the impurity in a liquid solvent. \
The number of trays/stages needed to obtain an outlet concentration of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", "1"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "dc47ccd3-8767-410c-b0b9-b825cd963418"],
 " ppm in the gas stream  is calculated. Click the \"new problem\" button to \
create a different set of conditions and reset the Demonstration. Click \
\"next\" to go to the next step. Check \"hint\" for a hint, and check \
\"solution\" to see the solution before selecting next step. Once \
\"solution\" is checked, your answer cannot be changed, and once \"next\" is \
selected, you cannot go back. To restart, press \"new problem\". For steps 2 \
and 3, check \"column\" to display a diagram of the absorption column."
}], "ManipulateCaption",
 CellChangeTimes->{{3.72442818407975*^9, 3.7244282226355433`*^9}, 
   3.725614843055814*^9, {3.725615434654318*^9, 3.72561543549463*^9}, {
   3.7256162329841375`*^9, 3.725616265671691*^9}, {3.725616296541393*^9, 
   3.725616417043337*^9}},
 CellID->566805683,ExpressionUUID->"71d3c3b6-bb25-4a03-9689-684e182e6cff"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ThumbnailSection",ExpressionUUID->"7556f77c-9105-4005-87b0-0df91e4dc72c"],

Cell[BoxData[
 GraphicsBox[
  {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], RectangleBox[{0, 0}], 
   InsetBox[
    StyleBox["\<\"Thumbnail Placeholder\"\>",
     StripOnInput->False,
     FontFamily->"Verdana",
     FontSize->14], {0.5, 0.6}], InsetBox[
    StyleBox["\<\"Replace this with your\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.45}], InsetBox[
    StyleBox["\<\"Manipulate at a particular setting.\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.39}], InsetBox[
    StyleBox["\<\"(Do not use a bitmap.)\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.315}]},
  ImageMargins->0.,
  ImageSize->220]], "Output",
 CellEditDuplicate->
  False,ExpressionUUID->"445a118a-b9e0-452e-afac-c0902d7d79b5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SnapshotsSection",ExpressionUUID->"7552e8ba-d584-4948-b92e-8b841d4b5de2"],

Cell[BoxData[
 GraphicsBox[
  {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], RectangleBox[{0, 0}], 
   InsetBox[
    StyleBox["\<\"Snapshot Placeholder\"\>",
     StripOnInput->False,
     FontFamily->"Verdana",
     FontSize->14], {0.5, 0.6}], InsetBox[
    StyleBox["\<\"Replace this with your\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.45}], InsetBox[
    StyleBox["\<\"Manipulate at a particular setting.\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.39}], InsetBox[
    StyleBox["\<\"(Do not use a bitmap.)\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.315}]},
  ImageMargins->0.,
  ImageSize->220]], "Output",
 CellEditDuplicate->
  False,ExpressionUUID->"0c9f28f0-919e-4e0b-b36e-9fe148e5e98f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "DetailsSection",ExpressionUUID->"9d973a26-2fd0-48c8-934c-da58f1c13e92"],

Cell["\<\
The operating line (magenta) is plotted using the mass balance:\
\>", "DetailNotes",
 CellChangeTimes->{{3.723993868002286*^9, 3.7239938822117863`*^9}},
 CellID->682340474,ExpressionUUID->"efccdbeb-e7a9-488a-83a9-5cf3c978a63f"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["x", "0"], " ", "L"}], "+", 
     RowBox[{"y", " ", "V"}]}], "=", 
    RowBox[{
     RowBox[{"x", " ", "L"}], "+", 
     RowBox[{
      SubscriptBox["y", "1"], " ", "V"}]}]}], TraditionalForm]], "InlineMath",
  ExpressionUUID->"27f442c7-0287-4657-8421-4ae97112ceb5"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.723993868002286*^9, 3.723993881804785*^9}, {
  3.723993913068585*^9, 3.7239939315991163`*^9}, {3.725058308832178*^9, 
  3.725058323032404*^9}},
 CellID->349609537,ExpressionUUID->"97911051-f00a-4208-8083-28c2520288ff"],

Cell[TextData[{
 "rearranging the mass balance to solve for ",
 Cell[BoxData[
  FormBox["y", TraditionalForm]], "InlineMath",ExpressionUUID->
  "fefa91cd-4db4-4cb0-9172-e1b6d4a70c5f"],
 ":"
}], "DetailNotes",
 CellChangeTimes->{{3.723993868002286*^9, 3.723993881804785*^9}, {
  3.723993913068585*^9, 3.723993945914014*^9}, {3.725058328405917*^9, 
  3.725058329950077*^9}},
 CellID->18730954,ExpressionUUID->"68f59c0e-eabd-45f8-8d70-0b5f8f16b39f"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "op"], "=", 
    RowBox[{
     RowBox[{
      FractionBox["L", "V"], " ", 
      RowBox[{"(", 
       RowBox[{"x", "-", 
        SubscriptBox["x", "0"]}], ")"}]}], "+", 
     SubscriptBox["y", "1"]}]}], TraditionalForm]], "InlineMath",
  ExpressionUUID->"0111c3e0-6a2d-458e-838e-e95257018f7a"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.723993868002286*^9, 3.723993881804785*^9}, {
  3.723993913068585*^9, 3.7239939715261903`*^9}, {3.72442671593931*^9, 
  3.7244267196899333`*^9}},
 CellID->34378748,ExpressionUUID->"d395766d-c6c6-4af0-93ad-5fceef9c17d1"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "0"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "a439d002-5e45-47b2-a2aa-6623d1471399"],
 " is the mole ratio of impurity in the inlet liquid stream (ppm), ",
 Cell[BoxData[
  FormBox["y", TraditionalForm]], "InlineMath",ExpressionUUID->
  "c539217b-d8b0-41a4-a540-c4f53f41990f"],
 " is the mole ratio of impurity (ppm) in the vapor stream that corresponds \
to ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]], "InlineMath",ExpressionUUID->
  "3c81bca8-ca8c-4961-8403-26382555d754"],
 ", which is the mole ratio of impurity in the liquid stream (ppm), ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", "1"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "4ca63144-ee73-451e-8d52-b33f1735fbec"],
 " is the mole ratio of impurity in the outlet vapor stream (ppm), ",
 Cell[BoxData[
  FormBox["L", TraditionalForm]], "InlineMath",ExpressionUUID->
  "bed75983-9652-4946-842f-86005df60532"],
 " is the liquid molar flow rate (Mmol/h), and ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]], "InlineMath",ExpressionUUID->
  "c21ab20a-ea31-474e-b2a9-a7b1972fc572"],
 " is the vapor molar flow rate (MMol/h)."
}], "DetailNotes",
 CellChangeTimes->{{3.723993868002286*^9, 3.723993881804785*^9}, {
  3.723993913068585*^9, 3.723993977241624*^9}, {3.7239940866465645`*^9, 
  3.7239940935798087`*^9}, {3.723994138994322*^9, 3.723994224591522*^9}, {
  3.725058345637597*^9, 3.725058347711622*^9}, {3.7250583784072495`*^9, 
  3.725058427378516*^9}},
 CellID->477098778,ExpressionUUID->"eb83ceac-663a-41e2-a30d-4cd2a39198b8"],

Cell["\<\
The equilibrium line (orange) is calculated using Henry's law:\
\>", "DetailNotes",
 CellChangeTimes->{{3.723993868002286*^9, 3.723993881804785*^9}, {
  3.723993913068585*^9, 3.723993977241624*^9}, {3.7239940866465645`*^9, 
  3.7239940935798087`*^9}, {3.723994138994322*^9, 3.72399425745816*^9}, {
  3.7239946102588825`*^9, 3.7239946131009073`*^9}},
 CellID->30253895,ExpressionUUID->"8bcfa724-10c8-4135-bbef-ccf61ea489e0"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "eq"], "=", 
    RowBox[{
     FractionBox["H", "P"], " ", "x"}]}], TraditionalForm]], "InlineMath",
  ExpressionUUID->"067ea966-7d0c-4946-b53b-3a0dc98e5d6a"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.723993868002286*^9, 3.723993881804785*^9}, {
  3.723993913068585*^9, 3.723993977241624*^9}, {3.7239940866465645`*^9, 
  3.7239940935798087`*^9}, {3.723994138994322*^9, 3.7239942688574305`*^9}, {
  3.72442680976082*^9, 3.7244268102328205`*^9}},
 CellID->717544022,ExpressionUUID->"e67f7a82-e7f5-4db6-8a72-045c36993857"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox["H", TraditionalForm]], "InlineMath",ExpressionUUID->
  "91baac27-0c61-4798-9497-719231b32ca8"],
 " is Henry's constant (atm/mole fraction), and ",
 Cell[BoxData[
  FormBox["P", TraditionalForm]], "InlineMath",ExpressionUUID->
  "226b4e4a-3534-42c7-bd61-6d82f5ae62c5"],
 " is pressure (atm)."
}], "DetailNotes",
 CellChangeTimes->{{3.723993868002286*^9, 3.723993881804785*^9}, {
  3.723993913068585*^9, 3.723993977241624*^9}, {3.7239940866465645`*^9, 
  3.7239940935798087`*^9}, {3.723994138994322*^9, 3.723994294561405*^9}},
 CellID->600555864,ExpressionUUID->"a14a8100-11af-45f3-a05e-fd128df0e9b9"],

Cell[TextData[{
 "Henry's constant is calculated from ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["H", "0"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "8188b9d6-a78a-4b06-9bba-6bd9aa186e1e"],
 ", Henry's constant at standard temperature ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "0"], "=", 
    RowBox[{"298", " ", 
     StyleBox["K",
      FontSlant->"Plain"]}]}], TraditionalForm]], "InlineMath",
  ExpressionUUID->"2bd82417-3043-47ba-b619-061a440b4319"],
 ":"
}], "DetailNotes",
 CellChangeTimes->{{3.723994297577836*^9, 3.7239943094379177`*^9}, {
  3.7239943526313925`*^9, 3.7239944551620803`*^9}, {3.724081119742519*^9, 
  3.72408112041432*^9}},
 CellID->455620700,ExpressionUUID->"49abfb96-1ee6-4140-a4f0-f7cb44ef2d2d"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"H", "=", 
    RowBox[{
     SuperscriptBox["H", "0"], " ", 
     SuperscriptBox["e", 
      RowBox[{"-", 
       FractionBox["E", 
        RowBox[{"R", " ", 
         SubscriptBox["T", "0"]}]]}]]}]}], TraditionalForm]], "InlineMath",
  ExpressionUUID->"a827f022-71df-4b93-a4b7-00e2bdcdbe19"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.723994297577836*^9, 3.7239943094379177`*^9}, {
  3.7239943526313925`*^9, 3.7239944737390194`*^9}, {3.7240811094850674`*^9, 
  3.7240811105084705`*^9}},
 CellID->60930568,ExpressionUUID->"d90b7164-61e7-4a64-b4bf-244a2a25fe08"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox["E", TraditionalForm]], "InlineMath",ExpressionUUID->
  "ea2ac076-96df-42fa-a556-78046e5f9775"],
 " is activation energy (J/mol), ",
 Cell[BoxData[
  FormBox["R", TraditionalForm]], "InlineMath",ExpressionUUID->
  "35a94416-f3a5-4321-8eea-2a59f6aeaf7b"],
 " is the gas constant (J/[mol K]), and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["H", "0"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "8ece44fd-180b-4ca9-8b65-1aa7d826839b"],
 " has units of atm/mole fraction."
}], "DetailNotes",
 CellChangeTimes->{{3.723994297577836*^9, 3.7239943094379177`*^9}, {
  3.7239943526313925`*^9, 3.7239945081702414`*^9}},
 CellID->139031394,ExpressionUUID->"118ba672-0357-4f9c-b941-f5c1e47d50d8"],

Cell["Reference", "DetailNotes",
 CellChangeTimes->{{3.700080616089089*^9, 3.700080620869473*^9}, {
  3.7002210497359147`*^9, 3.7002210499553156`*^9}},
 CellID->359414663,
 $CellContext`ExpressionUUID -> 
 "fb4d39f9-5bac-44ca-ab62-8780064af81e",ExpressionUUID->"2aeb7b58-e3b3-4861-\
a3f6-7e23af01c3fd"],

Cell[TextData[{
 "[1] P.C. Wankat,",
 StyleBox[" Separation Process Engineering: Includes Mass Transfer Analysis",
  FontSlant->"Italic"],
 ", 3rd ed., Upper Saddle River, NJ: Prentice Hall, 2012."
}], "DetailNotes",
 CellChangeTimes->{{3.7000806326022177`*^9, 3.700080658235621*^9}, {
  3.7000807420163927`*^9, 3.70008078191269*^9}, {3.7002210411464643`*^9, 
  3.7002210600179667`*^9}, {3.703523576809187*^9, 3.70352363025762*^9}},
 CellID->1027769137,
 $CellContext`ExpressionUUID -> 
 "51f3289b-98e7-4b7b-b134-a4a9bc9f8f2c",ExpressionUUID->"11a7bf10-6bf1-4fe1-\
a001-173a214c7c25"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ControlSuggestionsSection",ExpressionUUID->"c153a36f-9f05-45db-be15-5ef26f2749e1"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[
   " Resize Images",ExpressionUUID->"cb6627fd-6420-4cf2-92fb-6657996bd8dd"]}],
  "\"Click inside an image to reveal its orange resize frame.\\nDrag any of \
the orange resize handles to resize the image.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.724428238121832*^9},
 FontFamily->"Verdana",
 CellTags->
  "ResizeImages",ExpressionUUID->"b809bac4-b6a1-48d1-9d29-ed20f9aebc14"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Rotate and Zoom in 3D",ExpressionUUID->
    "68f5e2a8-3b96-482b-bd1e-b598be92a39c"]}],
  RowBox[{
   "\"Drag a 3D graphic to rotate it. Starting the drag near the center \
tumbles\\nthe graphic; starting near a corner turns it parallel to the plane \
of the screen.\\nHold down \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" (or \"", 
    FrameBox[
    "Cmd", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" on Mac) and drag up and down to zoom.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->
  "RotateAndZoomIn3D",ExpressionUUID->"27fffef5-69be-4a3f-97d9-738972c50b80"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[
   " Drag Locators",ExpressionUUID->"c8ed22bc-ca2b-4792-aa9f-13f7a2a24ced"]}],
  RowBox[{"\"Drag any locator (\"", 
    GraphicsBox[
     LocatorBox[
      Scaled[{0.5, 0.5}]], ImageSize -> 20], 
    "\", etc.) to move it around.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.724428238922843*^9},
 FontFamily->"Verdana",
 CellTags->
  "DragLocators",ExpressionUUID->"f7ce0e0c-9ea4-4bb2-917e-6c9976d05316"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Create and Delete Locators",ExpressionUUID->
    "50039a38-99f8-40ec-8a69-ae10cb7a6427"]}],
  RowBox[{"\"Insert a new locator in the graphic by holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key\\nand clicking where you want it to be. Delete a locator by \
clicking it\\nwhile holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" key.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->
  "CreateAndDeleteLocators",ExpressionUUID->"019ca934-760a-4242-b003-\
0613698a3570"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Slider Zoom",ExpressionUUID->"ac02a61f-a521-4d12-bbca-50025b4b232f"]}],
  RowBox[{"\"Hold down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key while moving a slider to make fine adjustments in the slider \
value.\\nHold \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" and/or \"", 
    FrameBox[
    "Shift", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" at the same time as \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" to make ever finer adjustments.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->
  "SliderZoom",ExpressionUUID->"0065f482-6d2e-4513-bab4-7e222906514f"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Gamepad Controls",ExpressionUUID->
    "24c9fb67-cdea-414b-af5d-5e58379095b3"]}],
  "\"Control this Demonstration with a gamepad or other\\nhuman interface \
device connected to your computer.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{
  3.35696210375764*^9, 3.3895522232313623`*^9, {3.7244282399352455`*^9, 
   3.7244282515519037`*^9}},
 FontFamily->"Verdana",
 CellTags->
  "GamepadControls",ExpressionUUID->"590687cc-e432-4eef-b0a4-910110946a99"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[
   " Automatic Animation",ExpressionUUID->
    "e3195054-57f5-4a21-8152-4f6f541f44a0"]}],
  RowBox[{"\"Animate a slider in this Demonstration by clicking the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJzzTSzJSM1NLMlMTlRwL0osyMhMLlZwyy8CCjEzMjAwcIKwAgOI/R/IhBKc\n\
/4EAyGAG0f+nTZsGwgysIJIRKsWKLAXGIHFmEpUgLADxWUAkI24jZs+eTaEt\n\
IG+wQKRmzJgBlYf5lhEA30OqWA=="], "Graphics", ImageSize -> {9, 9}, ImageMargins -> 
      0, CellBaseline -> Baseline], BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"button\\nnext to the slider, and then clicking the play button that \
appears.\\nAnimate all controls by selecting \"", 
    StyleBox["Autorun", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.7244282523473067`*^9},
 FontFamily->"Verdana",
 CellTags->
  "AutomaticAnimation",ExpressionUUID->"4d93e49e-f4ec-4295-9c90-3d9e0a3a5297"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[
   " Bookmark Animation",ExpressionUUID->
    "a3e867a0-c9f3-4b61-bb04-27470a7bdf08"]}],
  RowBox[{
   "\"See a prepared animation of this Demonstration by selecting\\n\"", 
    StyleBox["Animate Bookmarks", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.7244282533967247`*^9},
 FontFamily->"Verdana",
 CellTags->
  "BookmarkAnimation",ExpressionUUID->"26ed11fe-133d-434e-bbe9-e298feb33178"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SearchTermsSection",ExpressionUUID->"5db8db13-8ecc-4be9-aa52-459fbba417f0"],

Cell["absorber", "SearchTerms",
 CellChangeTimes->{{3.72399453584882*^9, 3.723994540490654*^9}, {
  3.7256149223855953`*^9, 3.72561492282337*^9}},
 CellID->202867889,ExpressionUUID->"4499625a-e9eb-4815-9c7d-bf53318c3c20"],

Cell["absorption column", "SearchTerms",
 CellChangeTimes->{{3.723995352497517*^9, 3.7239953558559284`*^9}},
 CellID->623494723,ExpressionUUID->"13033789-ec6d-451c-89e4-7b22caa181d7"],

Cell["separations", "SearchTerms",
 CellChangeTimes->{{3.72399453584882*^9, 3.7239945426310735`*^9}},
 CellID->668433127,ExpressionUUID->"cb8e44e4-5bd8-467e-a7fc-919a2b22e53f"],

Cell["chemical engineering", "SearchTerms",
 CellChangeTimes->{{3.72399453584882*^9, 3.7239945471893077`*^9}},
 CellID->282037916,ExpressionUUID->"4b50fdc6-8796-4443-b57a-08429f6964c3"],

Cell["equilibrium stages", "SearchTerms",
 CellChangeTimes->{{3.72399453584882*^9, 3.723994550521722*^9}, {
  3.7256149313827395`*^9, 3.7256149313827395`*^9}},
 CellID->275074345,ExpressionUUID->"7806cb43-988d-41ec-9649-ae9018e00446"],

Cell["phase equilibrium", "SearchTerms",
 CellChangeTimes->{{3.72399453584882*^9, 3.723994550521722*^9}, {
  3.725614937026804*^9, 3.725614940728026*^9}},
 CellID->40129904,ExpressionUUID->"04a87c0e-d32a-48d1-afa3-b661612c3013"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "RelatedLinksSection",ExpressionUUID->"85a5498c-dcb3-455f-90f6-c86a5766241f"],

Cell[TextData[ButtonBox["McCabe-Thiele Method for Methanol/Water Separation",
 BaseStyle->"Hyperlink",
 ButtonData->{
   URL["http://demonstrations.wolfram.com/\
McCabeThieleMethodForMethanolWaterSeparation/"], None},
 ButtonNote->
  "http://demonstrations.wolfram.com/\
McCabeThieleMethodForMethanolWaterSeparation/"]], "RelatedLinks",
 CellChangeTimes->{{3.699963664517885*^9, 3.6999636839361696`*^9}},
 CellID->42471128,
 $CellContext`ExpressionUUID -> 
 "cdb3e69b-81ad-4695-af41-15af7c7555b8",ExpressionUUID->"7e8ca890-5d1a-4bb3-\
8e5f-2abd471277cc"],

Cell[TextData[ButtonBox["Operation of an Absorption Column",
 BaseStyle->"Hyperlink",
 ButtonData->{
   URL["http://demonstrations.wolfram.com/OperationOfAnAbsorptionColumn/"], 
   None},
 ButtonNote->
  "http://demonstrations.wolfram.com/OperationOfAnAbsorptionColumn/"]], \
"RelatedLinks",
 CellChangeTimes->{{3.7240810757099905`*^9, 3.724081089721264*^9}},
 CellID->65783372,ExpressionUUID->"b0a9675f-9cbd-435b-843a-a6a806c06160"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "AuthorSection",ExpressionUUID->"c2f45322-b6ff-4045-9154-5df2e2070d97"],

Cell[TextData[{
 "Contributed by: ",
 ButtonBox["Rachael L. Baumann",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=Rachael%20L.%\
20Baumann"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=Rachael%20L.%\
20Baumann"]
}], "Author",
 CellChangeTimes->{{3.699712700400914*^9, 3.699712711250766*^9}, {
  3.699712766442687*^9, 3.699712785590452*^9}, {3.6999636023826447`*^9, 
  3.699963604458664*^9}, {3.723994575776873*^9, 3.7239945765318904`*^9}},
 CellID->347156356,
 $CellContext`ExpressionUUID -> 
 "ca47b61e-38b9-408d-afda-95466a86c7d6",ExpressionUUID->"c1ad9412-1a84-417d-\
bb84-e674b6a798c9"],

Cell[TextData[{
 "Additional contributions by: ",
 ButtonBox["John L. Falconer",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=John%20L.%\
20Falconer"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=John%20L.%\
20Falconer"],
 " and ",
 ButtonBox["Adam J. Johnston",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=Adam%20J.%\
20Johnston"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=Adam%20J.%20Johnston"]
}], "Author",
 CellChangeTimes->{{3.699712700400914*^9, 3.699712728131461*^9}, {
  3.6997128004249277`*^9, 3.6997128004249277`*^9}, {3.7239945792729*^9, 
  3.7239945950711937`*^9}},
 CellID->373235529,
 $CellContext`ExpressionUUID -> 
 "39baa6b7-bfbd-410e-bf32-1c17245b691c",ExpressionUUID->"a965c84f-cd80-4bd2-\
a7f0-c14330768299"],

Cell["\<\
(University of Colorado Boulder, Department of Chemical and Biological \
Engineering)\
\>", "Author",
 CellChangeTimes->{{3.699712700400914*^9, 3.699712739137374*^9}},
 CellID->77347031,
 $CellContext`ExpressionUUID -> 
 "b8d8f6e5-3037-4f01-8c69-0946d1ec77a0",ExpressionUUID->"1a768f2b-ff2a-4769-\
a3aa-50cced9fe5a8"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1366, 686},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "Demonstration.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "ResizeImages"->{
  Cell[131545, 3083, 470, 11, 22, "ControlSuggestions",ExpressionUUID->"b809bac4-b6a1-48d1-9d29-ed20f9aebc14",
   CellTags->"ResizeImages"]},
 "RotateAndZoomIn3D"->{
  Cell[132018, 3096, 800, 19, 22, "ControlSuggestions",ExpressionUUID->"27fffef5-69be-4a3f-97d9-738972c50b80",
   CellTags->"RotateAndZoomIn3D"]},
 "DragLocators"->{
  Cell[132821, 3117, 498, 14, 22, "ControlSuggestions",ExpressionUUID->"f7ce0e0c-9ea4-4bb2-917e-6c9976d05316",
   CellTags->"DragLocators"]},
 "CreateAndDeleteLocators"->{
  Cell[133322, 3133, 761, 19, 22, "ControlSuggestions",ExpressionUUID->"019ca934-760a-4242-b003-0613698a3570",
   CellTags->"CreateAndDeleteLocators"]},
 "SliderZoom"->{
  Cell[134086, 3154, 961, 23, 22, "ControlSuggestions",ExpressionUUID->"0065f482-6d2e-4513-bab4-7e222906514f",
   CellTags->"SliderZoom"]},
 "GamepadControls"->{
  Cell[135050, 3179, 548, 14, 22, "ControlSuggestions",ExpressionUUID->"1ea7c0ee-cf88-48ff-ad7b-5d9633848389",
   CellTags->"GamepadControls"]},
 "AutomaticAnimation"->{
  Cell[135601, 3195, 1629, 35, 22, "ControlSuggestions",ExpressionUUID->"ff0761e3-d547-47d5-b854-f6ba90dc8e56",
   CellTags->"AutomaticAnimation"]},
 "BookmarkAnimation"->{
  Cell[137233, 3232, 1073, 25, 22, "ControlSuggestions",ExpressionUUID->"ff57d976-7a5a-478a-bbe1-432d4e9a2e5d",
   CellTags->"BookmarkAnimation"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"ResizeImages", 143250, 3395},
 {"RotateAndZoomIn3D", 143416, 3398},
 {"DragLocators", 143582, 3401},
 {"CreateAndDeleteLocators", 143754, 3404},
 {"SliderZoom", 143924, 3407},
 {"GamepadControls", 144086, 3410},
 {"AutomaticAnimation", 144256, 3413},
 {"BookmarkAnimation", 144429, 3416}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 492, 14, 75, "DemoTitle",ExpressionUUID->"7b4f29ec-f519-4f27-a894-62c4e616d19c"],
Cell[CellGroupData[{
Cell[1097, 40, 88, 0, 275, "InitializationSection",ExpressionUUID->"ea63a9a9-ba07-49c8-a17b-f2673dc817ae"],
Cell[1188, 42, 554, 13, 33, "Input",ExpressionUUID->"98477edd-3900-46d2-967d-71ae2cc42787",
 InitializationCell->True,
 CellID->448483865],
Cell[1745, 57, 706, 18, 33, "Input",ExpressionUUID->"8ddc521c-892b-496d-ab9b-865666bb3444",
 InitializationCell->True,
 CellID->493747658],
Cell[2454, 77, 474, 11, 33, "Input",ExpressionUUID->"5fb63a4c-5ce6-40ce-939b-81c387124a2e",
 InitializationCell->True,
 CellID->241618003],
Cell[2931, 90, 520, 13, 33, "Input",ExpressionUUID->"ee026fca-2e58-4069-8f70-7dd9122a4ae4",
 InitializationCell->True,
 CellID->905169336],
Cell[3454, 105, 518, 13, 33, "Input",ExpressionUUID->"53ffabdd-f512-44fa-833c-cee45d78dcd0",
 InitializationCell->True,
 CellID->462033904]
}, Open  ]],
Cell[CellGroupData[{
Cell[4009, 123, 84, 0, 231, "ManipulateSection",ExpressionUUID->"bb778bc8-5c59-49dd-aded-efc25d490996"],
Cell[CellGroupData[{
Cell[4118, 127, 77941, 1839, 3361, "Input",ExpressionUUID->"6c1dcaca-23c6-48e7-89bc-450f4fd8554f"],
Cell[82062, 1968, 34369, 699, 543, "Output",ExpressionUUID->"3ed31c51-268e-42d1-9ae9-a42c3c6afdab",
 CellID->578107179]
}, Open  ]],
Cell[116446, 2670, 609, 18, 25, "Input",ExpressionUUID->"dbde175a-1e41-40e8-b965-1e6efc8cfc37",
 CellID->100765946],
Cell[117058, 2690, 538, 15, 25, "Input",ExpressionUUID->"237ee353-d65b-46fe-aff0-c4fc358f5a30",
 CellID->9751210],
Cell[117599, 2707, 355, 9, 25, "Input",ExpressionUUID->"847a7b5e-374a-47f9-bf7c-f8d271c608f5",
 CellID->367643921],
Cell[117957, 2718, 227, 4, 25, "Input",ExpressionUUID->"038380ad-d738-4992-9eb0-7088ce1490ab",
 CellID->726117222],
Cell[CellGroupData[{
Cell[118209, 2726, 285, 7, 25, "Input",ExpressionUUID->"a67ec127-007c-454a-ad83-2d39851b3a57",
 CellID->393932400],
Cell[118497, 2735, 199, 4, 24, "Output",ExpressionUUID->"56953111-20d2-4db8-af3e-8eec717f04d1",
 CellID->38448888]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[118745, 2745, 91, 0, 169, "ManipulateCaptionSection",ExpressionUUID->"20302b80-7d90-4ffa-8061-088de661eb2e"],
Cell[118839, 2747, 1328, 21, 83, "ManipulateCaption",ExpressionUUID->"71d3c3b6-bb25-4a03-9689-684e182e6cff",
 CellID->566805683]
}, Open  ]],
Cell[CellGroupData[{
Cell[120204, 2773, 83, 0, 172, "ThumbnailSection",ExpressionUUID->"7556f77c-9105-4005-87b0-0df91e4dc72c"],
Cell[120290, 2775, 1300, 35, 230, "Output",ExpressionUUID->"445a118a-b9e0-452e-afac-c0902d7d79b5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[121627, 2815, 83, 0, 142, "SnapshotsSection",ExpressionUUID->"7552e8ba-d584-4948-b92e-8b841d4b5de2"],
Cell[121713, 2817, 1299, 35, 230, "Output",ExpressionUUID->"0c9f28f0-919e-4e0b-b36e-9fe148e5e98f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123049, 2857, 81, 0, 335, "DetailsSection",ExpressionUUID->"9d973a26-2fd0-48c8-934c-da58f1c13e92"],
Cell[123133, 2859, 237, 4, 22, "DetailNotes",ExpressionUUID->"efccdbeb-e7a9-488a-83a9-5cf3c978a63f",
 CellID->682340474],
Cell[123373, 2865, 632, 18, 23, "DetailNotes",ExpressionUUID->"97911051-f00a-4208-8083-28c2520288ff",
 CellID->349609537],
Cell[124008, 2885, 446, 10, 23, "DetailNotes",ExpressionUUID->"68f59c0e-eabd-45f8-8d70-0b5f8f16b39f",
 CellID->18730954],
Cell[124457, 2897, 635, 18, 33, "DetailNotes",ExpressionUUID->"d395766d-c6c6-4af0-93ad-5fceef9c17d1",
 CellID->34378748],
Cell[125095, 2917, 1600, 35, 39, "DetailNotes",ExpressionUUID->"eb83ceac-663a-41e2-a30d-4cd2a39198b8",
 CellID->477098778],
Cell[126698, 2954, 433, 7, 22, "DetailNotes",ExpressionUUID->"8bcfa724-10c8-4135-bbef-ccf61ea489e0",
 CellID->30253895],
Cell[127134, 2963, 600, 14, 33, "DetailNotes",ExpressionUUID->"e67f7a82-e7f5-4db6-8a72-045c36993857",
 CellID->717544022],
Cell[127737, 2979, 652, 14, 23, "DetailNotes",ExpressionUUID->"a14a8100-11af-45f3-a05e-fd128df0e9b9",
 CellID->600555864],
Cell[128392, 2995, 758, 20, 23, "DetailNotes",ExpressionUUID->"49abfb96-1ee6-4140-a4f0-f7cb44ef2d2d",
 CellID->455620700],
Cell[129153, 3017, 618, 17, 36, "DetailNotes",ExpressionUUID->"d90b7164-61e7-4a64-b4bf-244a2a25fe08",
 CellID->60930568],
Cell[129774, 3036, 747, 18, 23, "DetailNotes",ExpressionUUID->"118ba672-0357-4f9c-b941-f5c1e47d50d8",
 CellID->139031394],
Cell[130524, 3056, 302, 6, 22, "DetailNotes",ExpressionUUID->"2aeb7b58-e3b3-4861-a3f6-7e23af01c3fd",
 CellID->359414663],
Cell[130829, 3064, 584, 12, 22, "DetailNotes",ExpressionUUID->"11a7bf10-6bf1-4fe1-a001-173a214c7c25",
 CellID->1027769137]
}, Open  ]],
Cell[CellGroupData[{
Cell[131450, 3081, 92, 0, 126, "ControlSuggestionsSection",ExpressionUUID->"c153a36f-9f05-45db-be15-5ef26f2749e1"],
Cell[131545, 3083, 470, 11, 22, "ControlSuggestions",ExpressionUUID->"b809bac4-b6a1-48d1-9d29-ed20f9aebc14",
 CellTags->"ResizeImages"],
Cell[132018, 3096, 800, 19, 22, "ControlSuggestions",ExpressionUUID->"27fffef5-69be-4a3f-97d9-738972c50b80",
 CellTags->"RotateAndZoomIn3D"],
Cell[132821, 3117, 498, 14, 22, "ControlSuggestions",ExpressionUUID->"f7ce0e0c-9ea4-4bb2-917e-6c9976d05316",
 CellTags->"DragLocators"],
Cell[133322, 3133, 761, 19, 22, "ControlSuggestions",ExpressionUUID->"019ca934-760a-4242-b003-0613698a3570",
 CellTags->"CreateAndDeleteLocators"],
Cell[134086, 3154, 961, 23, 22, "ControlSuggestions",ExpressionUUID->"0065f482-6d2e-4513-bab4-7e222906514f",
 CellTags->"SliderZoom"],
Cell[135050, 3179, 548, 14, 22, "ControlSuggestions",ExpressionUUID->"1ea7c0ee-cf88-48ff-ad7b-5d9633848389",
 CellTags->"GamepadControls"],
Cell[135601, 3195, 1629, 35, 22, "ControlSuggestions",ExpressionUUID->"ff0761e3-d547-47d5-b854-f6ba90dc8e56",
 CellTags->"AutomaticAnimation"],
Cell[137233, 3232, 1073, 25, 22, "ControlSuggestions",ExpressionUUID->"ff57d976-7a5a-478a-bbe1-432d4e9a2e5d",
 CellTags->"BookmarkAnimation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138343, 3262, 85, 0, 158, "SearchTermsSection",ExpressionUUID->"c4271834-5475-4ec5-be73-6b3117b45d45"],
Cell[138431, 3264, 221, 3, 22, "SearchTerms",ExpressionUUID->"dd9a050e-7ced-4d53-be8e-63067028127b",
 CellID->202867889],
Cell[138655, 3269, 183, 2, 22, "SearchTerms",ExpressionUUID->"1be8b39b-44ba-4e82-a67a-151c24ee5039",
 CellID->623494723],
Cell[138841, 3273, 176, 2, 22, "SearchTerms",ExpressionUUID->"0cd74510-7f9f-4eae-9e05-26496ccf8733",
 CellID->668433127],
Cell[139020, 3277, 185, 2, 22, "SearchTerms",ExpressionUUID->"7c65d863-d543-4950-8058-4d6332644f15",
 CellID->282037916],
Cell[139208, 3281, 234, 3, 22, "SearchTerms",ExpressionUUID->"29551a0c-04d4-495f-bbdf-525772301c7c",
 CellID->275074345],
Cell[139445, 3286, 228, 3, 22, "SearchTerms",ExpressionUUID->"472183ab-98db-4c6a-9f6c-5c23c32fa6b9",
 CellID->40129904]
}, Open  ]],
Cell[CellGroupData[{
Cell[139710, 3294, 86, 0, 143, "RelatedLinksSection",ExpressionUUID->"16174ee5-85dc-484c-88aa-9dcd6d57c009"],
Cell[139799, 3296, 554, 12, 22, "RelatedLinks",ExpressionUUID->"36778ef9-77ca-4018-9452-4718314f182c",
 CellID->42471128],
Cell[140356, 3310, 433, 9, 22, "RelatedLinks",ExpressionUUID->"827e1aea-6ec3-4c51-a58c-b29eb54f2387",
 CellID->65783372]
}, Open  ]],
Cell[CellGroupData[{
Cell[140826, 3324, 80, 0, 141, "AuthorSection",ExpressionUUID->"151facce-dea1-4ae9-92dd-e741967fdc98"],
Cell[140909, 3326, 686, 17, 22, "Author",ExpressionUUID->"a7e91d82-d70d-4584-97ee-88fac8463d61",
 CellID->347156356],
Cell[141598, 3345, 921, 25, 22, "Author",ExpressionUUID->"d3c40205-9cb7-44fd-8c2b-cb4adde0e39b",
 CellID->373235529],
Cell[142522, 3372, 327, 8, 22, "Author",ExpressionUUID->"7dc52735-59dc-4a11-8b4a-c7832baaadc0",
 CellID->77347031]
}, Open  ]]
}, Open  ]]
}
]
*)

