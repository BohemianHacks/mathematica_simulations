(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    310060,       6710]
NotebookOptionsPosition[    301493,       6549]
NotebookOutlinePosition[    303546,       6599]
CellTagsIndexPosition[    303210,       6587]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 "Construct an ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]], "InlineMath",ExpressionUUID->
  "fa662063-1892-4dd1-9b49-95b0e81aaa60"],
 "-",
 Cell[BoxData[
  FormBox["y", TraditionalForm]], "InlineMath",ExpressionUUID->
  "e90bf39f-1d9d-475f-9c7d-f926a25afde8"],
 " Diagram for an Absorption Column"
}], "DemoTitle",
 CellChangeTimes->{
  3.7244269498449855`*^9, {3.7256147790318356`*^9, 3.725614787654004*^9}, 
   3.729865437055232*^9},ExpressionUUID->"bb6eaa89-aebd-471e-b7f2-\
2ce1c1ee521b"],

Cell["", "InitializationSection",ExpressionUUID->"e8d33a45-8ee4-48c3-8409-c5b73abfc5ac"],

Cell[CellGroupData[{

Cell["", "ManipulateSection",ExpressionUUID->"5d229dd3-eda5-4f1b-8bd0-79bf0085890c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "colL", ",", "colV", ",", "colOP", ",", "colEQ", ",", "colS", ",", "P", 
       ",", "T", ",", "L0", ",", "V0", ",", "Ea", ",", "R", ",", "H0", ",", 
       "HB", ",", "L", ",", "V", ",", "x0", ",", "y1", ",", "yn1", ",", "yN1",
        ",", "yeq", ",", "xp1", ",", "xp2", ",", "intersect", ",", "check1", 
       ",", "check2", ",", "stage", ",", "test", ",", "n", ",", "steps", ",", 
       "stepping", ",", "xN", ",", "X", ",", "Y", ",", "xeq", ",", "xop", ",",
        "plotlabel", ",", "h", ",", "w", ",", "ry", ",", "column", ",", "opt",
        ",", "pt1", ",", "pt2", ",", "pt3", ",", "diagram"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"colL", "=", "Blue"}], ";", 
      RowBox[{"colV", "=", 
       RowBox[{"RGBColor", "[", 
        RowBox[{"0", ",", "0.6", ",", "0"}], "]"}]}], ";", 
      RowBox[{"colOP", "=", "Magenta"}], ";", 
      RowBox[{"colEQ", "=", 
       RowBox[{"RGBColor", "[", 
        RowBox[{"1", ",", "0.4", ",", "0"}], "]"}]}], ";", 
      RowBox[{"colS", "=", "Purple"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
         "**", "**"}], "*****)"}], "\[IndentingNewLine]", 
      RowBox[{"SeedRandom", "[", "reset", "]"}], ";", 
      RowBox[{"P", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"2.5", ",", "3"}], "}"}], "]"}]}], ";", 
      RowBox[{"T", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "25"}], "}"}], "]"}]}], ";", 
      RowBox[{"L0", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"115", ",", "200"}], "}"}], "]"}]}], ";", 
      RowBox[{"V0", "=", 
       RowBox[{
        RowBox[{"RandomInteger", "[", 
         RowBox[{"{", 
          RowBox[{"12", ",", "15"}], "}"}], "]"}], "/", "10"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Ea", "=", "5000"}], ";", 
      RowBox[{"R", "=", "8.314"}], ";", "\[IndentingNewLine]", 
      RowBox[{"H0", "=", 
       RowBox[{"Hi", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{"211.19", "\[Equal]", 
            RowBox[{"Hi", "*", 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               FractionBox["5000", 
                RowBox[{"R", "*", "298"}]]}], "]"}]}]}], ",", "Hi"}], "]"}], 
         "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"HB", "=", 
       RowBox[{"H0", "*", 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          FractionBox["Ea", 
           RowBox[{"R", "*", 
            RowBox[{"(", 
             RowBox[{"T", "+", "273"}], ")"}]}]]}], "]"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"atm", "/", "mole"}], " ", 
        RowBox[{"frac", "."}]}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"L", "=", 
       RowBox[{"1000", "*", "L0"}]}], ";", 
      RowBox[{"V", "=", 
       RowBox[{"1000", "*", "V0"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"x0", "=", "0.05"}], ";", 
      RowBox[{"y1", "=", "10"}], ";", 
      RowBox[{"yn1", "=", "100"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yN1", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         FractionBox["L", "V"], "*", 
         RowBox[{"(", 
          RowBox[{"x", "-", "x0"}], ")"}]}], "+", "y1"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yeq", "[", "x_", "]"}], ":=", 
       RowBox[{
        FractionBox["HB", "P"], "*", "x"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"xp1", "=", "1.35"}], ";", 
      RowBox[{"xp2", "=", 
       RowBox[{"x", "/.", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"yN1", "[", "x", "]"}], "\[Equal]", 
           RowBox[{"1.1", "*", "yn1"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"intersect", "=", 
       RowBox[{"x", "/.", 
        RowBox[{"Quiet", "@", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"yN1", "[", "x", "]"}], "\[Equal]", 
             RowBox[{"yeq", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"check1", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yN1", "[", "x", "]"}], "\[Equal]", "yn1"}], ",", "x"}], 
          "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"check2", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"yN1", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"xN", "=", 
         RowBox[{"stepping", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"-", "2"}], ",", "1"}], "]"}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"xN", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yN1", "[", "x", "]"}], "\[Equal]", "yn1"}], ",", "x"}], 
          "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"X", "[", "0", "]"}], "=", "xN"}], ";", 
      RowBox[{
       RowBox[{"Y", "[", "0", "]"}], "=", 
       RowBox[{"yeq", "[", "xN", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"X", "[", "i", "]"}], "=", 
           RowBox[{"x", "/.", 
            RowBox[{"Quiet", "@", 
             RowBox[{
              RowBox[{"Solve", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"yN1", "[", "x", "]"}], "\[Equal]", 
                 RowBox[{"Y", "[", 
                  RowBox[{"i", "-", "1"}], "]"}]}], ",", "x"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}]}], ",", 
          RowBox[{
           RowBox[{"Y", "[", "i", "]"}], "=", 
           RowBox[{"yeq", "[", 
            RowBox[{"X", "[", "i", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "50"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"X", "[", "#", "]"}], "<", "x0"}], ",", "0", ",", 
               "#"}], "]"}], "&"}], "/@", 
            RowBox[{"Range", "@", "10"}]}], ",", "0"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xeq", "[", "y_", "]"}], ":=", 
       RowBox[{"x", "/.", 
        RowBox[{"Quiet", "@", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"y", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0"}], "}"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xop", "[", "y_", "]"}], ":=", 
       RowBox[{"x", "/.", 
        RowBox[{"Quiet", "@", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yN1", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"y", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0"}], "}"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"plotlabel", "=", 
       RowBox[{"Switch", "[", 
        RowBox[{"NPR", ",", "\[IndentingNewLine]", "2", ",", 
         RowBox[{"If", "[", 
          RowBox[{
          "hint", ",", "\"\<hint: use the mass balance from step 1\>\"", ",", 
           "\"\<step 2: click and drag the points to create the operating \
line, then check solution\>\""}], "]"}], ",", "\[IndentingNewLine]", "3", ",", 
         RowBox[{"If", "[", 
          RowBox[{"hint", ",", "\"\<hint: use Henry's law\>\"", ",", 
           RowBox[{"Column", "[", 
            RowBox[{"{", 
             RowBox[{
             "\"\<step 3: click and drag circles to create the equilibrium \
line, then check solution\>\"", ",", 
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<P\>\"", ",", "Italic"}], "]"}], ",", 
                 "\"\< = \>\"", ",", 
                 RowBox[{"NumberForm", "[", 
                  RowBox[{"P", ",", 
                   RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}]}], "]"}], ",", 
                 "\"\< atm and \>\"", ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<H\>\"", ",", "Italic"}], "]"}], ",", 
                 "\"\< = \>\"", ",", 
                 RowBox[{"NumberForm", "[", 
                  RowBox[{"HB", ",", 
                   RowBox[{"{", 
                    RowBox[{"4", ",", "1"}], "}"}]}], "]"}], ",", 
                 "\"\< atm/mole fraction\>\""}], "}"}]}]}], "}"}], "]"}]}], 
          "]"}], ",", "\[IndentingNewLine]", "4", ",", 
         RowBox[{"If", "[", 
          RowBox[{
          "hint", ",", 
           "\"\<hint: start counting stages from the bottom of the \
column\>\"", ",", 
           RowBox[{"Column", "[", 
            RowBox[{"{", 
             RowBox[{
             "\"\<step 4: drag the black circle to move the dashed line to \
draw the first stage,\>\"", ",", "\"\<then check solution\>\""}], "}"}], 
            "]"}]}], "]"}], ",", "\[IndentingNewLine]", "5", ",", 
         RowBox[{"If", "[", 
          RowBox[{
          "hint", ",", 
           "\"\<hint: start drawing second stage where the first stage leaves \
off\>\"", ",", 
           RowBox[{"Column", "[", 
            RowBox[{"{", 
             RowBox[{
             "\"\<step 5: drag the black circle to move the dashed line to \
draw the second\>\"", ",", "\"\<stage, then check solution\>\""}], "}"}], 
            "]"}]}], "]"}], ",", "\[IndentingNewLine]", "6", ",", 
         RowBox[{"If", "[", 
          RowBox[{"hint", ",", 
           RowBox[{"Row", "@", 
            RowBox[{"{", 
             RowBox[{"\"\<hint: draw last stage until \>\"", ",", 
              RowBox[{"Subscript", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", "0"}], 
               "]"}], ",", "\"\< is reached or surpassed\>\""}], "}"}]}], ",", 
           RowBox[{"Column", "[", 
            RowBox[{"{", 
             RowBox[{
             "\"\<step 6: drag the black circle to move the dashed line to \
draw the last stage,\>\"", ",", "\"\<then check solution\>\""}], "}"}], 
            "]"}]}], "]"}], ",", "\[IndentingNewLine]", "7", ",", 
         RowBox[{"Row", "@", 
          RowBox[{"{", 
           RowBox[{"\"\<solved \>\"", ",", 
            RowBox[{"Style", "[", 
             RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", "\"\<-\>\"", 
            ",", 
            RowBox[{"Style", "[", 
             RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
            "\"\< diagram\>\""}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"h", "=", "13"}], ";", 
      RowBox[{"w", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"NPR", "\[Equal]", "1"}], ",", "6", ",", "12"}], "]"}]}], 
      ";", 
      RowBox[{"ry", "=", "2"}], ";", "\[IndentingNewLine]", 
      RowBox[{"column", "=", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Thick", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"#", ",", "ry"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"#", ",", 
                  RowBox[{"h", "-", "ry"}]}], "}"}]}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"{", 
             RowBox[{"0", ",", "w"}], "}"}]}], ",", 
           RowBox[{"Circle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"w", "/", "2"}], ",", "ry"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"w", "/", "2"}], ",", "ry"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Pi]", ",", 
               RowBox[{"2", "*", "\[Pi]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Circle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"w", "/", "2"}], ",", 
               RowBox[{"h", "-", "ry"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"w", "/", "2"}], ",", "ry"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Arrowheads", "@", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"NPR", "\[Equal]", "1"}], ",", "0.065", ",", "0.09"}],
                "]"}]}], ",", "\[IndentingNewLine]", "colV", ",", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "w"}], ",", 
                  RowBox[{
                   RowBox[{"-", "h"}], "/", "4"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.25", "*", "w"}], ",", 
                  RowBox[{
                   RowBox[{"-", "h"}], "/", "4"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.25", "*", "w"}], ",", 
                  RowBox[{"ry", "/", "10"}]}], "}"}]}], "}"}], "]"}], ",", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.25", "*", "w"}], ",", 
                  RowBox[{"h", "-", 
                   RowBox[{"ry", "/", "10"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.25", "*", "w"}], ",", 
                  RowBox[{"h", "+", 
                   RowBox[{"h", "/", "4"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "w"}], ",", 
                  RowBox[{"h", "+", 
                   RowBox[{"h", "/", "4"}]}]}], "}"}]}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", "colL", ",", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.75", "*", "w"}], ",", 
                  RowBox[{"ry", "/", "10"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.75", "*", "w"}], ",", 
                  RowBox[{
                   RowBox[{"-", "h"}], "/", "4"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"2", "*", "w"}], ",", 
                  RowBox[{
                   RowBox[{"-", "h"}], "/", "4"}]}], "}"}]}], "}"}], "]"}], 
             ",", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"2", "*", "w"}], ",", 
                  RowBox[{"h", "+", 
                   RowBox[{"h", "/", "4"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.75", "*", "w"}], ",", 
                  RowBox[{"h", "+", 
                   RowBox[{"h", "/", "4"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.75", "*", "w"}], ",", 
                  RowBox[{"h", "-", 
                   RowBox[{"ry", "/", "10"}]}]}], "}"}]}], "}"}], "]"}]}], 
            "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"4", "\[LessEqual]", "NPR"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Thick", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "#"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"w", ",", "#"}], "}"}]}], "}"}], "]"}], "&"}], "/@", 
                RowBox[{"{", 
                 RowBox[{"ry", ",", 
                  RowBox[{"0.5", "*", "h"}], ",", 
                  RowBox[{"h", "-", "ry"}]}], "}"}]}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"#1", ",", "17"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.5", "*", "w"}], ",", "#2"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], "&"}], "@@@", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1", ",", "ry"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], ",", 
                    RowBox[{"0.5", "*", "h"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<N\>\"", ",", "Italic"}], "]"}], ",", 
                    RowBox[{"h", "-", "ry"}]}], "}"}]}], "}"}]}]}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"Column", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"P", ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}]}], "]"}], ",", 
                    "\"\< atm\>\""}], "}"}]}], ",", 
                    RowBox[{"Spacer", "@", "0"}], ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"T", ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "0"}], "}"}]}], "]"}], ",", 
                    "\"\< \[Degree]C\>\""}], "}"}]}]}], "}"}], ",", 
                   "Center"}], "]"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"NPR", "\[Equal]", "1"}], ",", "17", ",", "16"}], 
                  "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"0.5", "*", "w"}], ",", 
                 RowBox[{"0.5", "*", "h"}]}], "}"}]}], "]"}]}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"NPR", ">", "1"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<L\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{
                    RowBox[{"N", "@", "L"}], "/", "1000"}], ",", 
                    "\"\< Mmol/h\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Column", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"\"\<liquid solvent feed\>\"", ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<L\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{
                    RowBox[{"N", "@", "L"}], "/", "1000"}], ",", 
                    "\"\< Mmol/h\>\""}], "}"}]}]}], "}"}], ",", "Right"}], 
                  "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"NPR", "\[Equal]", "1"}], ",", "17", ",", "16"}], 
                "]"}], ",", "colL"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"w", ",", 
               RowBox[{"h", "+", 
                RowBox[{"h", "/", "4"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.5"}], ",", 
               RowBox[{"-", "1.2"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"NPR", ">", "1"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<V\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "@", "V"}], "/", "1000"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}]}], "]"}], ",", 
                    "\"\< Mmol/h\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Column", "[", 
                  RowBox[{"{", 
                   RowBox[{"\"\<gas feed\>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<V\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", "gas", ",", "\"\< Mmol/h\>\""}], 
                    "}"}]}], ",", "colS"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"NPR", "\[Equal]", "1"}], "\[And]", "solution"}], 
                    ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<correct \>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<V\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"N", "@", "V"}], "/", "1000"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}]}], "]"}], ",", 
                    "\"\< Mmol/h\>\""}], "}"}]}]}], "]"}]}], 
                   "\[IndentingNewLine]", "}"}], "]"}]}], 
                "\[IndentingNewLine]", "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"NPR", "\[Equal]", "1"}], ",", "17", ",", "16"}], 
                "]"}], ",", "colV"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{
                RowBox[{"-", "h"}], "/", "4"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"NPR", "\[Equal]", "1"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{"solution", ",", "0.35", ",", "1"}], "]"}], ",", 
                 "0.5"}], "]"}], ",", "1.4"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", "#2"}], 
                    "]"}], ",", "\"\< = \>\"", ",", "#1", ",", 
                    "\"\< ppm\>\""}], "}"}]}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"NPR", "\[Equal]", "1"}], ",", "17", ",", "16"}], 
                  "]"}], ",", "colV", ",", 
                 RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "#3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{"graphic", ",", "0.5", ",", "1"}], "]"}], ",", 
                 "0"}], "}"}]}], "]"}], "&"}], "@@@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"y1", ",", "1", ",", 
                RowBox[{"h", "+", "2"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"yn1", ",", 
                RowBox[{"Row", "@", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<N\>\"", ",", "Italic"}], "]"}], ",", 
                   "\"\<+1\>\""}], "}"}]}], ",", 
                RowBox[{"-", "2"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", "#2"}], 
                    "]"}], ",", "\"\< = \>\"", ",", "#1", ",", 
                    "\"\< ppm\>\""}], "}"}]}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"NPR", "\[Equal]", "1"}], ",", "17", ",", "16"}], 
                  "]"}], ",", "colL", ",", 
                 RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"w", ",", "#3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{"graphic", ",", 
                   RowBox[{"-", "0.5"}], ",", 
                   RowBox[{"-", "1"}]}], "]"}], ",", "0"}], "}"}]}], "]"}], 
             "&"}], "@@@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x0", ",", "0", ",", 
                RowBox[{"h", "+", "2"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"NumberForm", "[", 
                 RowBox[{"xN", ",", "2"}], "]"}], ",", 
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<N\>\"", ",", "Italic"}], "]"}], ",", 
                RowBox[{"-", "2"}]}], "}"}]}], "}"}]}]}], 
          "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"NPR", "\[Equal]", "1"}], ",", "600", ",", "250"}], 
             "]"}], ",", "390"}], "}"}]}], ",", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"20", ",", "20"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"65", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"NPR", "\[Equal]", "1"}], ",", "50", ",", "25"}], 
               "]"}]}], "}"}]}], "}"}]}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"NPR", "\[Equal]", "1"}], ",", "0.75", ",", "Full"}], 
           "]"}]}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"NPR", "\[Equal]", "1"}], ",", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
               "hint", ",", "\"\<hint: use mass balance on solute\>\"", ",", 
                "\"\<step 1: calculate the gas flow rate, then check solution\
\>\""}], "]"}], ",", "17", ",", "Black"}], "]"}], ",", "None"}], "]"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"opt", "=", 
       RowBox[{"Sequence", "[", 
        RowBox[{
         RowBox[{"Thickness", "@", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"graphic", "\[And]", 
             RowBox[{"NPR", "<", "4"}]}], ",", "0.011", ",", "0.008"}], 
           "]"}]}], ",", "Dotted"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pt1", "[", 
        RowBox[{"pt_", ",", "col_"}], "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{"col", ",", 
         RowBox[{"PointSize", "@", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"graphic", "\[And]", 
             RowBox[{"NPR", "<", "4"}]}], ",", "0.04", ",", "0.025"}], 
           "]"}]}], ",", 
         RowBox[{"Point", "@", "pt"}], ",", "White", ",", 
         RowBox[{"PointSize", "@", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"graphic", "\[And]", 
             RowBox[{"NPR", "<", "4"}]}], ",", "0.025", ",", "0.015"}], 
           "]"}]}], ",", 
         RowBox[{"Point", "@", "pt"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pt2", "[", 
        RowBox[{"pt_", ",", "col_"}], "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{"col", ",", 
         RowBox[{"PointSize", "@", 
          RowBox[{"If", "[", 
           RowBox[{"graphic", ",", "0.035", ",", "0.02"}], "]"}]}], ",", 
         RowBox[{"Point", "@", "pt"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pt3", "[", 
        RowBox[{"pt_", ",", "col_"}], "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{"col", ",", 
         RowBox[{"PointSize", "@", 
          RowBox[{"If", "[", 
           RowBox[{"graphic", ",", "0.035", ",", "0.02"}], "]"}]}], ",", 
         RowBox[{"Point", "@", "pt"}], ",", "White", ",", 
         RowBox[{"PointSize", "@", 
          RowBox[{"If", "[", 
           RowBox[{"graphic", ",", "0.02", ",", "0.01"}], "]"}]}], ",", 
         RowBox[{"Point", "@", "pt"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", "\[Equal]", 
           RowBox[{"NPR", "-", "4"}]}], ",", 
          RowBox[{"NPR", "=", 
           RowBox[{"n", "+", "4"}]}]}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"testing", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"n", "\[Equal]", 
            RowBox[{"NPR", "-", "4"}]}], ",", 
           RowBox[{"n", "+", "4"}], ",", "0"}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"n", "\[Equal]", "2"}], "\[And]", 
         RowBox[{"NPR", "\[Equal]", "6"}]}], ",", 
        RowBox[{"NPR", "=", "7"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"diagram", "=", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Thick", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"DRAW", " ", "OPERATING", " ", "LINE"}], ",", " ", 
             RowBox[{"NPR", "=", "2"}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NPR", "\[Equal]", "2"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Evaluate", "@", "opt"}], ",", "colOP", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{"op1", ",", "op2"}], "}"}], "]"}]}], "}"}], ",", 
               RowBox[{"pt1", "[", 
                RowBox[{"op1", ",", "colOP"}], "]"}], ",", 
               RowBox[{"pt1", "[", 
                RowBox[{"op2", ",", "colOP"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"solution", "\[Equal]", "False"}], ",", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"op1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "2"}], "}"}]}], "]"}], ",", 
                    "\"\< ppm\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"op1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "0"}], "}"}]}], "]"}], ",", 
                    "\"\< ppm\>\""}], "}"}]}]}], "\[IndentingNewLine]", "}"}],
                     ",", 
                    RowBox[{"Alignment", "\[Rule]", "\"\<=\>\""}]}], "]"}], 
                    ",", "17", ",", "colOP", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    "op1", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1.3"}]}], "}"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"op2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "2"}], "}"}]}], "]"}], ",", 
                    "\"\< ppm\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"op2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "0"}], "}"}]}], "]"}], ",", 
                    "\"\< ppm\>\""}], "}"}]}]}], "\[IndentingNewLine]", "}"}],
                     ",", 
                    RowBox[{"Alignment", "\[Rule]", "\"\<=\>\""}]}], "]"}], 
                    ",", "17", ",", "colOP", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    "op2", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1.5"}], "}"}]}], "]"}]}], 
                  "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{"{", 
                  RowBox[{"colOP", ",", 
                   RowBox[{"Line", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"yN1", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", "xp2", ",", "0.01"}], "]"}]}], "]"}]}], 
                  "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NPR", ">", "2"}], ",", 
             RowBox[{"{", 
              RowBox[{"colOP", ",", 
               RowBox[{"Line", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"#", ",", 
                    RowBox[{"yN1", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
                 RowBox[{"Range", "[", 
                  RowBox[{"0", ",", "xp2", ",", "0.01"}], "]"}]}], "]"}]}], 
              "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"DRAW", " ", "EQUILIBRIUM", " ", "LINE"}], ",", " ", 
             RowBox[{"NPR", "=", "3"}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NPR", "\[Equal]", "3"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Evaluate", "@", "opt"}], ",", "colEQ", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{"eq1", ",", "eq2"}], "}"}], "]"}]}], "}"}], ",", 
               RowBox[{"pt1", "[", 
                RowBox[{"eq1", ",", "colEQ"}], "]"}], ",", 
               RowBox[{"pt1", "[", 
                RowBox[{"eq2", ",", "colEQ"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"solution", "\[Equal]", "False"}], ",", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"eq1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "2"}], "}"}]}], "]"}], ",", 
                    "\"\< ppm\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"eq1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "0"}], "}"}]}], "]"}], ",", 
                    "\"\< ppm\>\""}], "}"}]}]}], "\[IndentingNewLine]", "}"}],
                     ",", 
                    RowBox[{"Alignment", "\[Rule]", "\"\<=\>\""}]}], "]"}], 
                    ",", "17", ",", "colEQ", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    "eq1", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1.3"}]}], "}"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"eq2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "2"}], "}"}]}], "]"}], ",", 
                    "\"\< ppm\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"eq2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "0"}], "}"}]}], "]"}], ",", 
                    "\"\< ppm\>\""}], "}"}]}]}], "\[IndentingNewLine]", "}"}],
                     ",", 
                    RowBox[{"Alignment", "\[Rule]", "\"\<=\>\""}]}], "]"}], 
                    ",", "17", ",", "colEQ", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    "eq2", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1.5"}], "}"}]}], "]"}]}], 
                  "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{"{", 
                  RowBox[{"colEQ", ",", 
                   RowBox[{"Line", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"yeq", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", "xp1", ",", "0.01"}], "]"}]}], "]"}]}], 
                  "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NPR", ">", "3"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"colEQ", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"yeq", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{"0", ",", "xp1", ",", "0.01"}], "]"}]}], "]"}]}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"pt2", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"xN", ",", 
                   RowBox[{"yeq", "[", "xN", "]"}]}], "}"}], ",", "Black"}], 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<x\>\"", ",", "\"\<N\>\""}], "]"}], ",", 
                    "colL", ",", "Italic"}], "]"}], ",", "\"\<, \>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<y\>\"", ",", "\"\<N\>\""}], "]"}], ",", 
                    "colV", ",", "Italic"}], "]"}], ",", "\"\<)\>\""}], 
                    "}"}]}], ",", "17", ",", 
                   RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"xN", ",", 
                   RowBox[{"yeq", "[", "xN", "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1.25"}], ",", "0.5"}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"pt2", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x0", ",", "y1"}], "}"}], ",", "Black"}], "]"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", "0"}], 
                    "]"}], ",", "colL"}], "]"}], ",", "\"\<, \>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", "1"}], 
                    "]"}], ",", "colV"}], "]"}], ",", "\"\<)\>\""}], "}"}]}], 
                   ",", "17", ",", 
                   RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x0", ",", "y1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "0.5"}], ",", 
                   RowBox[{"-", "3.5"}]}], "}"}]}], "]"}]}], 
              "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"STAGE", " ", "1"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NPR", "\[Equal]", "4"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Dashed", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"step1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"yeq", "[", 
                    RowBox[{"step1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"step1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"yN1", "[", 
                    RowBox[{"step1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "}"}], 
                  "]"}]}], "}"}], ",", 
               RowBox[{"pt3", "[", 
                RowBox[{"step1", ",", "Black"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "0", "]"}], ",", "yn1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "0", "]"}], ",", 
                    RowBox[{"Y", "[", "0", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "1", "]"}], ",", 
                    RowBox[{"Y", "[", "0", "]"}]}], "}"}]}], "}"}], "]"}]}], 
                "]"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NPR", ">", "4"}], ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"X", "[", "0", "]"}], ",", "yn1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"X", "[", "0", "]"}], ",", 
                  RowBox[{"Y", "[", "0", "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"X", "[", "1", "]"}], ",", 
                  RowBox[{"Y", "[", "0", "]"}]}], "}"}]}], "}"}], "]"}]}], 
            "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"STAGE", " ", "2"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NPR", "\[Equal]", "5"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Dashed", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"step2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"yeq", "[", 
                    RowBox[{"step2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"step2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"yN1", "[", 
                    RowBox[{"step2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "}"}], 
                  "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"pt3", "[", 
                RowBox[{"step2", ",", "Black"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "1", "]"}], ",", 
                    RowBox[{"Y", "[", "0", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "1", "]"}], ",", 
                    RowBox[{"Y", "[", "1", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "2", "]"}], ",", 
                    RowBox[{"Y", "[", "1", "]"}]}], "}"}]}], "}"}], "]"}]}], 
                "]"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"LAST", " ", "STAGE"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NPR", "\[Equal]", "6"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Dashed", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"step3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"yeq", "[", 
                    RowBox[{"step3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"step3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"yN1", "[", 
                    RowBox[{"step3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "}"}], 
                  "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"pt3", "[", 
                RowBox[{"step3", ",", "Black"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "#", "]"}], ",", 
                    RowBox[{"Y", "[", "#", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"#", "+", "1"}], "]"}], ",", 
                    RowBox[{"Y", "[", "#", "]"}]}], "}"}]}], "}"}], "]"}], 
                 "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"0", ",", 
                  RowBox[{"n", "-", "2"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"#", "+", "1"}], "]"}], ",", 
                    RowBox[{"Y", "[", "#", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"#", "+", "1"}], "]"}], ",", 
                    RowBox[{"Y", "[", 
                    RowBox[{"#", "+", "1"}], "]"}]}], "}"}]}], "}"}], "]"}], 
                 "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"0", ",", 
                  RowBox[{"n", "-", "3"}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"#", "+", "1"}], "]"}], ",", 
                    RowBox[{"Y", "[", "#", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"#", "+", "1"}], "]"}], ",", 
                    RowBox[{"Y", "[", 
                    RowBox[{"#", "+", "1"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"#", "+", "2"}], "]"}], ",", 
                    RowBox[{"Y", "[", 
                    RowBox[{"#", "+", "1"}], "]"}]}], "}"}]}], "}"}], "]"}], 
                   "&"}], "@", 
                  RowBox[{"(", 
                   RowBox[{"n", "-", "2"}], ")"}]}]}], "]"}]}], 
              "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", "SOLUTION", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NPR", "\[Equal]", "7"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"#", "-", "1"}], "]"}], ",", 
                    RowBox[{"Y", "[", 
                    RowBox[{"#", "-", "1"}], "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "#", "]"}], ",", 
                    RowBox[{"Y", "[", 
                    RowBox[{"#", "-", "1"}], "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "#", "]"}], ",", 
                    RowBox[{"Y", "[", "#", "]"}]}], "}"}]}], "}"}], "]"}], 
                "&"}], "/@", 
               RowBox[{"Range", "@", "n"}]}], "}"}]}], "]"}]}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "xp1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"1.1", "*", "yn1"}]}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotRangeClipping", "\[Rule]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"NPR", "\[Equal]", "2"}], ",", "True", ",", "False"}], 
           "]"}]}], ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{"\"\<solute/(solute-free liquid) \>\"", ",", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
               "\"\< (ppm)\>\""}], "}"}]}], ",", 
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{"\"\<solute/(solute-free gas) \>\"", ",", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
               "\"\< (ppm)\>\""}], "}"}]}]}], "}"}]}], ",", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"17", ",", "Black"}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"graphic", "\[And]", 
               RowBox[{"NPR", "<", "8"}]}], ",", "350", ",", "600"}], "]"}], 
            ",", "390"}], "}"}]}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
         RowBox[{"GridLines", "\[Rule]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"NPR", "\[Equal]", "7"}], ",", "None", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{"0", ",", "xp1", ",", "0.05"}], "]"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{"0", ",", 
                RowBox[{"1.1", "*", "yn1"}], ",", "5"}], "]"}]}], "}"}]}], 
           "]"}]}], ",", 
         RowBox[{"GridLinesStyle", "\[Rule]", 
          RowBox[{"GrayLevel", "@", "0.8"}]}], ",", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"55", ",", "10"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"50", ",", 
              RowBox[{"If", "[", 
               RowBox[{"graphic", ",", "5", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"3", "\[LessEqual]", "NPR", "\[LessEqual]", "6"}],
                     ")"}], "\[And]", 
                   RowBox[{"hint", "\[Equal]", "False"}]}], ",", "5", ",", 
                  "27"}], "]"}]}], "]"}]}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"If", "[", 
           RowBox[{"graphic", ",", "None", ",", 
            RowBox[{"Style", "[", 
             RowBox[{"plotlabel", ",", "17"}], "]"}]}], "]"}]}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NPR", "\[Equal]", "1"}], ",", "column", ",", 
        RowBox[{"If", "[", 
         RowBox[{"graphic", ",", 
          RowBox[{"Grid", "@", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"diagram", ",", "column"}], "}"}], "}"}]}], ",", 
          "diagram"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Grid", "@", 
    RowBox[{"{", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{"\"\< new problem \>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"reset", "<", "1000"}], ",", 
             RowBox[{"reset", "=", 
              RowBox[{"reset", "+", "1"}]}], ",", 
             RowBox[{"reset", "=", 
              RowBox[{"reset", "-", "1"}]}]}], "]"}], ",", 
           RowBox[{"NPR", "=", "1"}], ",", 
           RowBox[{"solution", "=", "False"}], ",", 
           RowBox[{"hint", "=", "False"}], ",", 
           RowBox[{"op1", "=", 
            RowBox[{"{", 
             RowBox[{"0.2", ",", "80"}], "}"}]}], ",", 
           RowBox[{"op2", "=", 
            RowBox[{"{", 
             RowBox[{"1.15", ",", "80"}], "}"}]}], ",", 
           RowBox[{"eq1", "=", 
            RowBox[{"{", 
             RowBox[{"0.2", ",", "80"}], "}"}]}], ",", 
           RowBox[{"eq2", "=", 
            RowBox[{"{", 
             RowBox[{"1.15", ",", "80"}], "}"}]}], ",", 
           RowBox[{"step1", "=", 
            RowBox[{"{", 
             RowBox[{"0.8", ",", "60"}], "}"}]}], ",", 
           RowBox[{"step2", "=", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "40"}], "}"}]}], ",", 
           RowBox[{"step3", "=", 
            RowBox[{"{", 
             RowBox[{"0.2", ",", "20"}], "}"}]}]}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"reset", ",", "1"}], "}"}], ",", "1", ",", "1000", ",", 
          "1", ",", "None"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PaneSelector", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "\"\<(1) gas flow rate\>\""}], ",", 
           RowBox[{"2", "\[Rule]", "\"\<(2) draw operating line\>\""}], ",", 
           RowBox[{"3", "\[Rule]", "\"\<(3) draw equilibrium line\>\""}], ",", 
           RowBox[{"4", "\[Rule]", "\"\<(4) draw stage 1\>\""}], ",", 
           RowBox[{"5", "\[Rule]", "\"\<(5) draw stage 2\>\""}], ",", 
           RowBox[{"6", "\[Rule]", "\"\<(6) draw last stage\>\""}], ",", 
           RowBox[{"7", "\[Rule]", "\"\<(7) solution\>\""}]}], "}"}], ",", 
         RowBox[{"Dynamic", "@", "NPR"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PaneSelector", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"##", "&"}], "@@", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "5", ",", 
               "6"}], "}"}], "\[Rule]", 
             RowBox[{"Button", "[", 
              RowBox[{"\"\< next \>\"", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"1", "\[LessEqual]", "NPR", "<", "7"}], ",", 
                   RowBox[{"NPR", "=", 
                    RowBox[{"NPR", "+", "1"}]}], ",", 
                   RowBox[{"NPR", "=", "7"}]}], "]"}], ",", 
                 RowBox[{"solution", "=", "False"}], ",", 
                 RowBox[{"hint", "=", "False"}], ",", 
                 RowBox[{"graphic", "=", "False"}]}], "}"}]}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"Dynamic", "@", "NPR"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"NPR", ",", "1", ",", "\"\<\>\""}], "}"}], ",", 
          RowBox[{"Range", "@", "7"}], ",", "None"}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PaneSelector", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"##", "&"}], "@@", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}],
               "}"}], "\[Rule]", 
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"solution", ",", "False", ",", "\"\<solution\>\""}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}], ",", 
                RowBox[{"Enabled", "\[Rule]", 
                 RowBox[{"If", "[", 
                  RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}], 
               "}"}], "]"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"Dynamic", "@", "NPR"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PaneSelector", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"##", "&"}], "@@", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}],
               "}"}], "\[Rule]", 
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"hint", ",", "False", ",", "\"\<hint\>\""}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"Dynamic", "@", "NPR"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PaneSelector", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"##", "&"}], "@@", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", "3", ",", "4", ",", "5", ",", "6"}], "}"}], 
             "\[Rule]", 
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"graphic", ",", "False", ",", "\"\<column\>\""}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"Dynamic", "@", "NPR"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PaneSelector", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"2", "\[Rule]", 
            RowBox[{"Row", "@", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Control", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"op1", ",", 
                    RowBox[{"{", 
                    RowBox[{"0.2", ",", "80"}], "}"}]}], "}"}], ",", 
                  "Locator", ",", 
                  RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
                  RowBox[{"Enabled", "\[Rule]", 
                   RowBox[{"If", "[", 
                    RowBox[{"solution", ",", "False", ",", "True"}], 
                    "]"}]}]}], "}"}], "]"}], ",", 
               RowBox[{"Control", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"op2", ",", 
                    RowBox[{"{", 
                    RowBox[{"1.15", ",", "80"}], "}"}]}], "}"}], ",", 
                  "Locator", ",", 
                  RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
                  RowBox[{"Enabled", "\[Rule]", 
                   RowBox[{"If", "[", 
                    RowBox[{"solution", ",", "False", ",", "True"}], 
                    "]"}]}]}], "}"}], "]"}]}], "}"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"3", "\[Rule]", 
            RowBox[{"Row", "@", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Control", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"eq1", ",", 
                    RowBox[{"{", 
                    RowBox[{"0.2", ",", "80"}], "}"}]}], "}"}], ",", 
                  "Locator", ",", 
                  RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
                  RowBox[{"Enabled", "\[Rule]", 
                   RowBox[{"If", "[", 
                    RowBox[{"solution", ",", "False", ",", "True"}], 
                    "]"}]}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Control", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"eq2", ",", 
                    RowBox[{"{", 
                    RowBox[{"1.15", ",", "80"}], "}"}]}], "}"}], ",", 
                  "Locator", ",", 
                  RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
                  RowBox[{"Enabled", "\[Rule]", 
                   RowBox[{"If", "[", 
                    RowBox[{"solution", ",", "False", ",", "True"}], 
                    "]"}]}]}], "}"}], "]"}]}], "}"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"4", "\[Rule]", 
            RowBox[{"Control", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"step1", ",", 
                 RowBox[{"{", 
                  RowBox[{"0.8", ",", "60"}], "}"}]}], "}"}], ",", "Locator", 
               ",", 
               RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
               RowBox[{"Enabled", "\[Rule]", 
                RowBox[{"If", "[", 
                 RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}], 
              "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"5", "\[Rule]", 
            RowBox[{"Control", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"step2", ",", 
                 RowBox[{"{", 
                  RowBox[{"0.5", ",", "40"}], "}"}]}], "}"}], ",", "Locator", 
               ",", 
               RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
               RowBox[{"Enabled", "\[Rule]", 
                RowBox[{"If", "[", 
                 RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}], 
              "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"6", "\[Rule]", 
            RowBox[{"Control", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"step3", ",", 
                 RowBox[{"{", 
                  RowBox[{"0.2", ",", "20"}], "}"}]}], "}"}], ",", "Locator", 
               ",", 
               RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
               RowBox[{"Enabled", "\[Rule]", 
                RowBox[{"If", "[", 
                 RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}], 
              "}"}], "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"Dynamic", "@", "NPR"}]}], "]"}]}], "\[IndentingNewLine]", 
      "}"}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"PaneSelector", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", "\[Rule]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "gas", ",", "1.2", ",", 
            "\"\<select correct gas molar flow rate (Mmol/h)\>\""}], "}"}], 
          ",", "0.5", ",", "1.5", ",", "0.1", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
        "]"}]}], "}"}], ",", 
     RowBox[{"Dynamic", "@", "NPR"}]}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.7244269591774397`*^9, 3.724427248922201*^9}, {
   3.7244272816151686`*^9, 3.724427533726758*^9}, {3.724427612938788*^9, 
   3.724427619516219*^9}, {3.7244276861769733`*^9, 3.7244280527479563`*^9}, {
   3.7244281580748053`*^9, 3.7244281718760757`*^9}, {3.7244283259595137`*^9, 
   3.724428336865571*^9}, {3.7256337843857336`*^9, 3.725633902836152*^9}, {
   3.725633986923793*^9, 3.7256340024038734`*^9}, {3.725634049319312*^9, 
   3.7256340930287533`*^9}, {3.7256341902276497`*^9, 
   3.7256343955567083`*^9}, {3.7256347366249657`*^9, 3.725634748907222*^9}, {
   3.725635649765316*^9, 3.7256356650381956`*^9}, {3.725635736722159*^9, 
   3.725635753316256*^9}, {3.725635808287141*^9, 3.725635810507345*^9}, {
   3.7256358462379255`*^9, 3.725635878335907*^9}, {3.725635926273141*^9, 
   3.7256359412290196`*^9}, {3.7256359775355988`*^9, 
   3.7256360922323985`*^9}, {3.7256361268367815`*^9, 
   3.7256361536309347`*^9}, {3.7256361954605484`*^9, 
   3.7256362826751947`*^9}, {3.7256368280430284`*^9, 
   3.7256368631728077`*^9}, {3.7256369060084305`*^9, 3.725636954772487*^9}, {
   3.725636996879095*^9, 3.7256370521723824`*^9}, {3.7256371258289623`*^9, 
   3.7256372583020296`*^9}, {3.7256372904888005`*^9, 3.725637394959732*^9}, {
   3.725637433500331*^9, 3.7256375223677826`*^9}, {3.725637742361493*^9, 
   3.725637782528098*^9}, {3.725637875866581*^9, 3.725637896068082*^9}, 
   3.725638041776223*^9, {3.725638142343937*^9, 3.725638285106061*^9}, {
   3.7256383265982847`*^9, 3.725638331560512*^9}, {3.725638393658019*^9, 
   3.725638401273255*^9}, {3.72563895608533*^9, 3.725639129495629*^9}, {
   3.7256392519659495`*^9, 3.725639297908798*^9}, {3.7256395530324306`*^9, 
   3.725639616394742*^9}, {3.725639815384353*^9, 3.725639855020756*^9}, 
   3.725648164219879*^9, {3.7257221056094904`*^9, 3.7257225259894595`*^9}, {
   3.7257225765311174`*^9, 3.72572257760892*^9}, {3.7257226126667*^9, 
   3.7257226582227373`*^9}, {3.7257227583696556`*^9, 3.725722758588056*^9}, {
   3.725722830372637*^9, 3.72572285035394*^9}, {3.7258059660670967`*^9, 
   3.7258060020010567`*^9}, {3.72580743266108*^9, 3.7258075688875685`*^9}, {
   3.7258076000055237`*^9, 3.725807934598234*^9}, {3.725808011107434*^9, 
   3.7258080475346107`*^9}, {3.7258080797997737`*^9, 
   3.7258080927840443`*^9}, {3.72580914237937*^9, 3.725809345596588*^9}, {
   3.725809391031813*^9, 3.725809394183036*^9}, {3.7258094396594615`*^9, 
   3.725809504647586*^9}, {3.725809561140066*^9, 3.7258095638636866`*^9}, {
   3.7258095964358463`*^9, 3.7258097975550566`*^9}, {3.72580986773361*^9, 
   3.7258098808914814`*^9}, 3.725814128687817*^9, {3.72581447404523*^9, 
   3.725814496503134*^9}, {3.7258869761760693`*^9, 3.725886990216843*^9}, {
   3.725887031378849*^9, 3.7258870317114496`*^9}, {3.725892369299144*^9, 
   3.7258923828450193`*^9}, {3.725892674069313*^9, 3.72589282004265*^9}, {
   3.7258928655766783`*^9, 3.7258929542789345`*^9}, {3.725893005043192*^9, 
   3.725893489578647*^9}, {3.7258935264882264`*^9, 3.7258936334411745`*^9}, {
   3.7258936660971317`*^9, 3.7258937527309732`*^9}, {3.725893787517155*^9, 
   3.725893822505931*^9}, {3.725893857280306*^9, 3.725894082906061*^9}, {
   3.725894130803913*^9, 3.7258943041067877`*^9}, {3.725894360094666*^9, 
   3.7258944715468235`*^9}, {3.7258945132452273`*^9, 
   3.7258945773757553`*^9}, {3.7258946095553274`*^9, 
   3.7258946903495383`*^9}, {3.7259793663856244`*^9, 
   3.7259793751178417`*^9}, {3.725979418814937*^9, 3.7259794821690664`*^9}, {
   3.725979561784037*^9, 3.725979594382107*^9}, {3.7259797213559723`*^9, 
   3.725979999367341*^9}, {3.7259800762486987`*^9, 3.725980091105731*^9}, {
   3.725980676844728*^9, 3.7259807385500655`*^9}, {3.7259807778225503`*^9, 
   3.7259808091750193`*^9}, {3.7259808393314843`*^9, 
   3.7259808859851832`*^9}, {3.725980919232251*^9, 3.725981056684136*^9}, {
   3.725981092016405*^9, 3.7259812665577664`*^9}, {3.7259813976592417`*^9, 
   3.7259814225578938`*^9}, {3.725981536618531*^9, 3.7259816190565157`*^9}, {
   3.725981656355996*^9, 3.725981767444421*^9}, {3.725981856455199*^9, 
   3.7259818600710087`*^9}, {3.7259819015666933`*^9, 
   3.7259820662268276`*^9}, {3.7259821027967057`*^9, 
   3.7259821364081783`*^9}, {3.72598220646172*^9, 3.7259822744702663`*^9}, {
   3.7259823059467287`*^9, 3.7259823637228465`*^9}, {3.7259824031457233`*^9, 
   3.7259825914887123`*^9}, {3.725982639405811*^9, 3.7259826699328747`*^9}, {
   3.725982727404795*^9, 3.725982747606236*^9}, {3.725982833586811*^9, 
   3.7259828506142426`*^9}, 3.725982905008952*^9, {3.7259829362214217`*^9, 
   3.725982937017023*^9}, {3.726326714442871*^9, 3.72632672279452*^9}, {
   3.7264215006284*^9, 3.72642153345098*^9}, {3.7268433177018127`*^9, 
   3.7268433430032597`*^9}, {3.7268434184115725`*^9, 
   3.7268435252806854`*^9}, {3.7268435759195814`*^9, 
   3.7268437021007986`*^9}, {3.726843744977251*^9, 3.726843745815299*^9}, {
   3.7268437868056436`*^9, 3.726843798944338*^9}, {3.7268438360944624`*^9, 
   3.726843956896372*^9}, {3.7268440394170923`*^9, 3.726844064349518*^9}, {
   3.7268442511282015`*^9, 3.726844329991712*^9}, {3.726844363302617*^9, 
   3.726844404016946*^9}, {3.726844463785364*^9, 3.7268444966452436`*^9}, {
   3.7268445469391203`*^9, 3.7268447328977566`*^9}, {3.727016860453264*^9, 
   3.7270168702138224`*^9}, {3.7277089257297487`*^9, 3.727708931493078*^9}, {
   3.728053015863624*^9, 3.728053042591153*^9}, {3.7280574784178677`*^9, 
   3.728057493955756*^9}, {3.7280575618626404`*^9, 3.728057569108055*^9}, {
   3.7280576347768106`*^9, 3.728057640115116*^9}, {3.7282338365175467`*^9, 
   3.7282338366175485`*^9}, {3.7282338947220955`*^9, 
   3.7282338997336855`*^9}, {3.7282339967284193`*^9, 
   3.7282340275039835`*^9}, {3.7282341143935347`*^9, 
   3.7282341181086044`*^9}, {3.728234215005836*^9, 3.728234218709406*^9}, {
   3.7282344345842714`*^9, 3.7282344456144667`*^9}, 3.7282345262464085`*^9, {
   3.7283932093085856`*^9, 3.728393235355075*^9}, {3.7296042431428127`*^9, 
   3.729604302866228*^9}, {3.729608160442869*^9, 3.7296082684290457`*^9}, {
   3.7296082984647636`*^9, 3.729608396958397*^9}, {3.7296084412379293`*^9, 
   3.7296084482953334`*^9}, {3.729608481784249*^9, 3.7296086391692505`*^9}, {
   3.7296086979806147`*^9, 3.7296087181517687`*^9}, {3.7296087500055904`*^9, 
   3.7296087952271767`*^9}, {3.7296088465061097`*^9, 3.7296089241025476`*^9}, 
   3.729608965463914*^9, {3.7298653365704846`*^9, 3.7298653590047674`*^9}, {
   3.730469947465439*^9, 3.7304700407187724`*^9}, {3.730470090049594*^9, 
   3.730470106305524*^9}, {3.7304702825136023`*^9, 3.7304703170465775`*^9}, {
   3.730470360783079*^9, 3.7304703789211164`*^9}, {3.7304704194574347`*^9, 
   3.7304704434788094`*^9}, {3.7304705600654774`*^9, 
   3.7304705925173335`*^9}, {3.7304707882765303`*^9, 3.730470795532945*^9}, {
   3.730470891810452*^9, 3.7304708961346993`*^9}, 3.7304710437091403`*^9, {
   3.730471076424011*^9, 3.730471124509762*^9}, {3.7304712122037773`*^9, 
   3.730471213833871*^9}, 3.7304712730502577`*^9, {3.7304713949752316`*^9, 
   3.7304713958342805`*^9}, {3.730472567445051*^9, 3.7304726221751814`*^9}, {
   3.7304736647908163`*^9, 3.730473703981057*^9}, {3.730473806440918*^9, 
   3.730473848524325*^9}, {3.730473916195195*^9, 3.730473920069417*^9}, {
   3.730474835365769*^9, 3.7304748375798955`*^9}, {3.730476132566553*^9, 
   3.7304763299718437`*^9}, {3.7304770709022226`*^9, 
   3.7304771172178717`*^9}, {3.731943659607065*^9, 3.7319436608281355`*^9}, {
   3.7319455774485416`*^9, 3.731945644141356*^9}, {3.7319456797813945`*^9, 
   3.7319457660963316`*^9}, {3.732372558581745*^9, 3.732372577615588*^9}, {
   3.73237262601396*^9, 3.7323726655906696`*^9}, {3.7329686772043037`*^9, 
   3.732968687478626*^9}, {3.7329714787415285`*^9, 3.732971486904443*^9}, {
   3.7329750436646385`*^9, 3.7329750557704782`*^9}, {3.732975102020323*^9, 
   3.7329751357449923`*^9}, {3.7329753377957106`*^9, 3.732975400346545*^9}, {
   3.733578767862769*^9, 3.7335787734213285`*^9}, {3.7335789158248887`*^9, 
   3.733578928853837*^9}, {3.733578958961813*^9, 3.7335790217180257`*^9}, {
   3.7335790659150743`*^9, 3.733579172720894*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"9e904ded-52c8-4477-b0f4-f78dbe239336"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`eq1$$ = {0.2, 80}, $CellContext`eq2$$ = {
    1.15, 80}, $CellContext`gas$$ = 1.2, $CellContext`graphic$$ = 
    False, $CellContext`hint$$ = False, $CellContext`NPR$$ = 
    1, $CellContext`op1$$ = {0.2, 80}, $CellContext`op2$$ = {
    1.15, 80}, $CellContext`reset$$ = 4, $CellContext`solution$$ = 
    False, $CellContext`step1$$ = {0.8, 60}, $CellContext`step2$$ = {
    0.5, 40}, $CellContext`step3$$ = {0.2, 20}, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`reset$$], 4}, 1, 1000, 1}, {{
       Hold[$CellContext`NPR$$], 1, ""}, {1, 2, 3, 4, 5, 6, 7}}, {{
       Hold[$CellContext`solution$$], False, "solution"}, {True, False}}, {{
       Hold[$CellContext`hint$$], False, "hint"}, {True, False}}, {{
       Hold[$CellContext`graphic$$], False, "column"}, {True, False}}, {{
       Hold[$CellContext`op1$$], {0.2, 80}}, Automatic}, {{
       Hold[$CellContext`op2$$], {1.15, 80}}, Automatic}, {{
       Hold[$CellContext`eq1$$], {0.2, 80}}, Automatic}, {{
       Hold[$CellContext`eq2$$], {1.15, 80}}, Automatic}, {{
       Hold[$CellContext`step1$$], {0.8, 60}}, Automatic}, {{
       Hold[$CellContext`step2$$], {0.5, 40}}, Automatic}, {{
       Hold[$CellContext`step3$$], {0.2, 20}}, Automatic}, {
      Hold[
       Grid[{{
          Button[" new problem ", {
            
            If[$CellContext`reset$$ < 
             1000, $CellContext`reset$$ = $CellContext`reset$$ + 
              1, $CellContext`reset$$ = $CellContext`reset$$ - 
              1], $CellContext`NPR$$ = 1, $CellContext`solution$$ = 
            False, $CellContext`hint$$ = 
            False, $CellContext`op1$$ = {0.2, 80}, $CellContext`op2$$ = {
             1.15, 80}, $CellContext`eq1$$ = {0.2, 80}, $CellContext`eq2$$ = {
             1.15, 80}, $CellContext`step1$$ = {
             0.8, 60}, $CellContext`step2$$ = {
             0.5, 40}, $CellContext`step3$$ = {0.2, 20}}], 
          Manipulate`Place[1], 
          
          PaneSelector[{
           1 -> "(1) gas flow rate", 2 -> "(2) draw operating line", 3 -> 
            "(3) draw equilibrium line", 4 -> "(4) draw stage 1", 5 -> 
            "(5) draw stage 2", 6 -> "(6) draw last stage", 7 -> 
            "(7) solution"}, 
           Dynamic[$CellContext`NPR$$]], 
          PaneSelector[{1 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 2 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 3 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 4 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 5 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 5 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 6 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}]}, 
           Dynamic[$CellContext`NPR$$]], 
          Manipulate`Place[2], 
          
          PaneSelector[{
           1 -> Manipulate`Place[3], 2 -> Manipulate`Place[3], 3 -> 
            Manipulate`Place[3], 4 -> Manipulate`Place[3], 5 -> 
            Manipulate`Place[3], 6 -> Manipulate`Place[3]}, 
           Dynamic[$CellContext`NPR$$]], 
          
          PaneSelector[{
           1 -> Manipulate`Place[4], 2 -> Manipulate`Place[4], 3 -> 
            Manipulate`Place[4], 4 -> Manipulate`Place[4], 5 -> 
            Manipulate`Place[4], 6 -> Manipulate`Place[4]}, 
           Dynamic[$CellContext`NPR$$]], 
          
          PaneSelector[{
           2 -> Manipulate`Place[5], 3 -> Manipulate`Place[5], 4 -> 
            Manipulate`Place[5], 5 -> Manipulate`Place[5], 6 -> 
            Manipulate`Place[5]}, 
           Dynamic[$CellContext`NPR$$]], 
          PaneSelector[{2 -> Row[{
               Manipulate`Place[6], 
               Manipulate`Place[7]}], 3 -> Row[{
               Manipulate`Place[8], 
               Manipulate`Place[9]}], 4 -> Manipulate`Place[10], 5 -> 
            Manipulate`Place[11], 6 -> Manipulate`Place[12]}, 
           Dynamic[$CellContext`NPR$$]]}}]], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`gas$$], 1.2, 
       "select correct gas molar flow rate (Mmol/h)"}, 0.5, 1.5, 0.1}, {
      Hold[
       PaneSelector[{1 -> Manipulate`Place[13]}, 
        Dynamic[$CellContext`NPR$$]]], Manipulate`Dump`ThisIsNotAControl}}, 
    Typeset`size$$ = Automatic, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`reset$71329$$ = 
    0, $CellContext`NPR$71330$$ = 0, $CellContext`solution$71331$$ = 
    False, $CellContext`hint$71332$$ = False, $CellContext`graphic$71333$$ = 
    False, $CellContext`gas$71334$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`eq1$$ = {0.2, 80}, $CellContext`eq2$$ = {
         1.15, 80}, $CellContext`gas$$ = 1.2, $CellContext`graphic$$ = 
        False, $CellContext`hint$$ = False, $CellContext`NPR$$ = 
        1, $CellContext`op1$$ = {0.2, 80}, $CellContext`op2$$ = {
         1.15, 80}, $CellContext`reset$$ = 4, $CellContext`solution$$ = 
        False, $CellContext`step1$$ = {0.8, 60}, $CellContext`step2$$ = {
         0.5, 40}, $CellContext`step3$$ = {0.2, 20}}, "ControllerVariables" :> {
        Hold[$CellContext`reset$$, $CellContext`reset$71329$$, 0], 
        Hold[$CellContext`NPR$$, $CellContext`NPR$71330$$, 0], 
        Hold[$CellContext`solution$$, $CellContext`solution$71331$$, False], 
        Hold[$CellContext`hint$$, $CellContext`hint$71332$$, False], 
        Hold[$CellContext`graphic$$, $CellContext`graphic$71333$$, False], 
        Hold[$CellContext`gas$$, $CellContext`gas$71334$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`colL$, $CellContext`colV$, $CellContext`colOP$, \
$CellContext`colEQ$, $CellContext`colS$, $CellContext`P$, $CellContext`T$, \
$CellContext`L0$, $CellContext`V0$, $CellContext`Ea$, $CellContext`R$, \
$CellContext`H0$, $CellContext`HB$, $CellContext`L$, $CellContext`V$, \
$CellContext`x0$, $CellContext`y1$, $CellContext`yn1$, $CellContext`yN1$, \
$CellContext`yeq$, $CellContext`xp1$, $CellContext`xp2$, \
$CellContext`intersect$, $CellContext`check1$, $CellContext`check2$, \
$CellContext`stage$, $CellContext`test$, $CellContext`n$, \
$CellContext`steps$, $CellContext`stepping$, $CellContext`xN$, \
$CellContext`X$, $CellContext`Y$, $CellContext`xeq$, $CellContext`xop$, \
$CellContext`plotlabel$, $CellContext`h$, $CellContext`w$, $CellContext`ry$, \
$CellContext`column$, $CellContext`opt$, $CellContext`pt1$, \
$CellContext`pt2$, $CellContext`pt3$, $CellContext`diagram$}, \
$CellContext`colL$ = Blue; $CellContext`colV$ = 
         RGBColor[0, 0.6, 0]; $CellContext`colOP$ = 
         Magenta; $CellContext`colEQ$ = 
         RGBColor[1, 0.4, 0]; $CellContext`colS$ = Purple; 
        SeedRandom[$CellContext`reset$$]; $CellContext`P$ = 
         RandomReal[{2.5, 3}]; $CellContext`T$ = 
         RandomInteger[{10, 25}]; $CellContext`L0$ = 
         RandomInteger[{115, 200}]; $CellContext`V0$ = 
         RandomInteger[{12, 15}]/10; $CellContext`Ea$ = 5000; $CellContext`R$ = 
         8.314; $CellContext`H0$ = ReplaceAll[$CellContext`Hi, 
           Part[
            Solve[
            211.19 == $CellContext`Hi 
              Exp[-(5000/($CellContext`R$ 298))], $CellContext`Hi], 
            1]]; $CellContext`HB$ = $CellContext`H0$ 
          Exp[-($CellContext`Ea$/($CellContext`R$ ($CellContext`T$ + 
              273)))]; $CellContext`L$ = 
         1000 $CellContext`L0$; $CellContext`V$ = 
         1000 $CellContext`V0$; $CellContext`x0$ = 0.05; $CellContext`y1$ = 
         10; $CellContext`yn1$ = 100; $CellContext`yN1$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := ($CellContext`L$/$CellContext`V$) ($CellContext`x$ - \
$CellContext`x0$) + $CellContext`y1$; $CellContext`yeq$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := ($CellContext`HB$/$CellContext`P$) $CellContext`x$; \
$CellContext`xp1$ = 1.35; $CellContext`xp2$ = ReplaceAll[$CellContext`x, 
           
           FindRoot[$CellContext`yN1$[$CellContext`x] == 
            1.1 $CellContext`yn1$, {$CellContext`x, 
             0}]]; $CellContext`intersect$ = ReplaceAll[$CellContext`x, 
           Quiet[
            Part[
             
             Solve[$CellContext`yN1$[$CellContext`x] == \
$CellContext`yeq$[$CellContext`x], $CellContext`x], 
             1]]]; $CellContext`check1$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yN1$[$CellContext`x] == $CellContext`yn1$, \
$CellContext`x], 1]]; $CellContext`check2$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yeq$[$CellContext`x] == \
$CellContext`yN1$[$CellContext`x], $CellContext`x], 1]]; $CellContext`xN$ = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yN1$[$CellContext`x] == $CellContext`yn1$, \
$CellContext`x], 1]]; $CellContext`X$[0] = $CellContext`xN$; $CellContext`Y$[
          0] = $CellContext`yeq$[$CellContext`xN$]; 
        Do[{$CellContext`X$[$CellContext`i] = ReplaceAll[$CellContext`x, 
             Quiet[
              Part[
               
               Solve[$CellContext`yN1$[$CellContext`x] == \
$CellContext`Y$[$CellContext`i - 1], $CellContext`x], 
               1]]], $CellContext`Y$[$CellContext`i] = $CellContext`yeq$[
             $CellContext`X$[$CellContext`i]]}, {$CellContext`i, 1, 
           50}]; $CellContext`n$ = 1 + Part[
            DeleteCases[
             Map[If[$CellContext`X$[#] < $CellContext`x0$, 0, #]& , 
              Range[10]], 0], -1]; $CellContext`xeq$[
           Pattern[$CellContext`y$, 
            Blank[]]] := ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`yeq$[$CellContext`x] == 
             Part[$CellContext`y$, 2], {$CellContext`x, 
              0}]]]; $CellContext`xop$[
           Pattern[$CellContext`y$, 
            Blank[]]] := ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`yN1$[$CellContext`x] == 
             Part[$CellContext`y$, 2], {$CellContext`x, 
              0}]]]; $CellContext`plotlabel$ = Switch[$CellContext`NPR$$, 2, 
           
           If[$CellContext`hint$$, "hint: use the mass balance from step 1", 
            
            "step 2: click and drag the points to create the operating line, \
then check solution"], 3, 
           If[$CellContext`hint$$, "hint: use Henry's law", 
            
            Column[{"step 3: click and drag circles to create the equilibrium \
line, then check solution", 
              Row[{
                Style["P", Italic], " = ", 
                NumberForm[$CellContext`P$, {3, 1}], " atm and ", 
                Style["H", Italic], " = ", 
                NumberForm[$CellContext`HB$, {4, 1}], 
                " atm/mole fraction"}]}]], 4, 
           
           If[$CellContext`hint$$, 
            "hint: start counting stages from the bottom of the column", 
            
            Column[{"step 4: drag the black circle to move the dashed line to \
draw the first stage,", "then check solution"}]], 5, 
           
           If[$CellContext`hint$$, 
            "hint: start drawing second stage where the first stage leaves \
off", 
            
            Column[{"step 5: drag the black circle to move the dashed line to \
draw the second", "stage, then check solution"}]], 6, 
           If[$CellContext`hint$$, 
            Row[{"hint: draw last stage until ", 
              Subscript[
               Style["x", Italic], 0], " is reached or surpassed"}], 
            
            Column[{"step 6: drag the black circle to move the dashed line to \
draw the last stage,", "then check solution"}]], 7, 
           Row[{"solved ", 
             Style["x", Italic], "-", 
             Style["y", Italic], " diagram"}]]; $CellContext`h$ = 
         13; $CellContext`w$ = 
         If[$CellContext`NPR$$ == 1, 6, 12]; $CellContext`ry$ = 
         2; $CellContext`column$ = Graphics[{Thick, 
            Map[
            Line[{{#, $CellContext`ry$}, {#, $CellContext`h$ - \
$CellContext`ry$}}]& , {0, $CellContext`w$}], 
            
            Circle[{$CellContext`w$/2, $CellContext`ry$}, {$CellContext`w$/
              2, $CellContext`ry$}, {Pi, 2 Pi}], 
            
            Circle[{$CellContext`w$/
              2, $CellContext`h$ - $CellContext`ry$}, {$CellContext`w$/
              2, $CellContext`ry$}, {0, Pi}], {
             Arrowheads[
              If[$CellContext`NPR$$ == 1, 0.065, 0.09]], $CellContext`colV$, 
             
             Arrow[{{-$CellContext`w$, (-$CellContext`h$)/4}, {
               0.25 $CellContext`w$, (-$CellContext`h$)/4}, {
               0.25 $CellContext`w$, $CellContext`ry$/10}}], 
             
             Arrow[{{0.25 $CellContext`w$, $CellContext`h$ - $CellContext`ry$/
                10}, {0.25 $CellContext`w$, $CellContext`h$ + $CellContext`h$/
                 4}, {-$CellContext`w$, $CellContext`h$ + $CellContext`h$/
                 4}}], $CellContext`colL$, 
             
             Arrow[{{0.75 $CellContext`w$, $CellContext`ry$/10}, {
               0.75 $CellContext`w$, (-$CellContext`h$)/4}, {
               2 $CellContext`w$, (-$CellContext`h$)/4}}], 
             
             Arrow[{{2 $CellContext`w$, $CellContext`h$ + $CellContext`h$/
                 4}, {0.75 $CellContext`w$, $CellContext`h$ + $CellContext`h$/
                 4}, {0.75 $CellContext`w$, $CellContext`h$ - \
$CellContext`ry$/10}}]}, 
            If[4 <= $CellContext`NPR$$, {Thick, 
              Map[
              Line[{{0, #}, {$CellContext`w$, #}}]& , {$CellContext`ry$, 
                0.5 $CellContext`h$, $CellContext`h$ - $CellContext`ry$}], 
              Apply[Text[
                Style[#, 17], {0.5 $CellContext`w$, #2}, {0, -1}]& , {{
                1, $CellContext`ry$}, {
                 Style["n", Italic], 0.5 $CellContext`h$}, {
                 Style["N", Italic], $CellContext`h$ - $CellContext`ry$}}, {
               1}]}, 
             Text[
              Style[
               Column[{
                 Row[{
                   NumberForm[$CellContext`P$, {3, 1}], " atm"}], 
                 Spacer[0], 
                 Row[{
                   NumberForm[$CellContext`T$, {4, 0}], " \[Degree]C"}]}, 
                Center], 
               If[$CellContext`NPR$$ == 1, 17, 16]], {
              0.5 $CellContext`w$, 0.5 $CellContext`h$}]], 
            Text[
             Style[
              If[$CellContext`NPR$$ > 1, 
               Row[{
                 Style["L", Italic], " = ", N[$CellContext`L$]/1000, 
                 " Mmol/h"}], 
               Column[{"liquid solvent feed", 
                 Row[{
                   Style["L", Italic], " = ", N[$CellContext`L$]/1000, 
                   " Mmol/h"}]}, Right]], 
              
              If[$CellContext`NPR$$ == 1, 17, 
               16], $CellContext`colL$], {$CellContext`w$, $CellContext`h$ + \
$CellContext`h$/4}, {-0.5, -1.2}], 
            Text[
             Style[
              If[$CellContext`NPR$$ > 1, 
               Row[{
                 Style["V", Italic], " = ", 
                 NumberForm[N[$CellContext`V$]/1000, {3, 1}], " Mmol/h"}], 
               Column[{"gas feed", 
                 Style[
                  Row[{
                    Style["V", Italic], " = ", $CellContext`gas$$, 
                    " Mmol/h"}], $CellContext`colS$], 
                 If[
                  And[$CellContext`NPR$$ == 1, $CellContext`solution$$], 
                  Row[{"correct ", 
                    Style["V", Italic], " = ", 
                    NumberForm[N[$CellContext`V$]/1000, {3, 1}], 
                    " Mmol/h"}]]}]], 
              If[$CellContext`NPR$$ == 1, 17, 16], $CellContext`colV$], {
             0, (-$CellContext`h$)/4}, {
              If[$CellContext`NPR$$ == 1, 
               If[$CellContext`solution$$, 0.35, 1], 0.5], 1.4}], 
            Apply[Text[
              Style[
               Row[{
                 Subscript[
                  Style["y", Italic], #2], " = ", #, " ppm"}], 
               If[$CellContext`NPR$$ == 1, 17, 16], $CellContext`colV$, 
               Background -> White], {0, #3}, {
               If[$CellContext`graphic$$, 0.5, 1], 0}]& , {{$CellContext`y1$, 
               1, $CellContext`h$ + 2}, {$CellContext`yn1$, 
               Row[{
                 Style["N", Italic], "+1"}], -2}}, {1}], 
            Apply[Text[
              Style[
               Row[{
                 Subscript[
                  Style["x", Italic], #2], " = ", #, " ppm"}], 
               If[$CellContext`NPR$$ == 1, 17, 16], $CellContext`colL$, 
               Background -> White], {$CellContext`w$, #3}, {
               If[$CellContext`graphic$$, -0.5, -1], 
               0}]& , {{$CellContext`x0$, 0, $CellContext`h$ + 2}, {
               NumberForm[$CellContext`xN$, 2], 
               Style["N", Italic], -2}}, {1}]}, ImageSize -> {
             If[$CellContext`NPR$$ == 1, 600, 250], 390}, 
           ImagePadding -> {{20, 20}, {65, 
              If[$CellContext`NPR$$ == 1, 50, 25]}}, AspectRatio -> 
           If[$CellContext`NPR$$ == 1, 0.75, Full], PlotLabel -> 
           If[$CellContext`NPR$$ == 1, 
             Style[
              
              If[$CellContext`hint$$, "hint: use mass balance on solute", 
               "step 1: calculate the gas flow rate, then check solution"], 
              17, Black], None]]; $CellContext`opt$ = Sequence[
           Thickness[
            If[
             And[$CellContext`graphic$$, $CellContext`NPR$$ < 4], 0.011, 
             0.008]], Dotted]; $CellContext`pt1$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`col$, 
            Blank[]]] := {$CellContext`col$, 
           PointSize[
            If[
             And[$CellContext`graphic$$, $CellContext`NPR$$ < 4], 0.04, 
             0.025]], 
           Point[$CellContext`pt$], White, 
           PointSize[
            If[
             And[$CellContext`graphic$$, $CellContext`NPR$$ < 4], 0.025, 
             0.015]], 
           Point[$CellContext`pt$]}; $CellContext`pt2$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`col$, 
            Blank[]]] := {$CellContext`col$, 
           PointSize[
            If[$CellContext`graphic$$, 0.035, 0.02]], 
           Point[$CellContext`pt$]}; $CellContext`pt3$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`col$, 
            Blank[]]] := {$CellContext`col$, 
           PointSize[
            If[$CellContext`graphic$$, 0.035, 0.02]], 
           Point[$CellContext`pt$], White, 
           PointSize[
            If[$CellContext`graphic$$, 0.02, 0.01]], 
           Point[$CellContext`pt$]}; If[
          
          And[$CellContext`n$ == 2, $CellContext`NPR$$ == 
           6], $CellContext`NPR$$ = 7]; $CellContext`diagram$ = 
         Graphics[{Thick, 
            If[$CellContext`NPR$$ == 2, {{
               Evaluate[$CellContext`opt$], $CellContext`colOP$, 
               Line[{$CellContext`op1$$, $CellContext`op2$$}]}, 
              $CellContext`pt1$[$CellContext`op1$$, $CellContext`colOP$], 
              $CellContext`pt1$[$CellContext`op2$$, $CellContext`colOP$], 
              If[$CellContext`solution$$ == False, {
                Text[
                 Style[
                  Column[{
                    Row[{
                    Style["x", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`op1$$, 1], {4, 2}], " ppm"}], 
                    Row[{
                    Style["y", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`op1$$, 2], {3, 0}], " ppm"}]}, 
                   Alignment -> "="], 17, $CellContext`colOP$, Background -> 
                  White], $CellContext`op1$$, {-1, -1.3}], 
                Text[
                 Style[
                  Column[{
                    Row[{
                    Style["x", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`op2$$, 1], {4, 2}], " ppm"}], 
                    Row[{
                    Style["y", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`op2$$, 2], {3, 0}], " ppm"}]}, 
                   Alignment -> "="], 17, $CellContext`colOP$, Background -> 
                  White], $CellContext`op2$$, {1, 1.5}]}], 
              If[$CellContext`solution$$, {$CellContext`colOP$, 
                Line[
                 Map[{#, 
                   $CellContext`yN1$[#]}& , 
                  Range[0, $CellContext`xp2$, 0.01]]]}]}], 
            If[$CellContext`NPR$$ > 2, {$CellContext`colOP$, 
              Line[
               Map[{#, 
                 $CellContext`yN1$[#]}& , 
                Range[0, $CellContext`xp2$, 0.01]]]}], 
            If[$CellContext`NPR$$ == 3, {{
               Evaluate[$CellContext`opt$], $CellContext`colEQ$, 
               Line[{$CellContext`eq1$$, $CellContext`eq2$$}]}, 
              $CellContext`pt1$[$CellContext`eq1$$, $CellContext`colEQ$], 
              $CellContext`pt1$[$CellContext`eq2$$, $CellContext`colEQ$], 
              If[$CellContext`solution$$ == False, {
                Text[
                 Style[
                  Column[{
                    Row[{
                    Style["x", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`eq1$$, 1], {4, 2}], " ppm"}], 
                    Row[{
                    Style["y", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`eq1$$, 2], {3, 0}], " ppm"}]}, 
                   Alignment -> "="], 17, $CellContext`colEQ$, Background -> 
                  White], $CellContext`eq1$$, {-1, -1.3}], 
                Text[
                 Style[
                  Column[{
                    Row[{
                    Style["x", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`eq2$$, 1], {4, 2}], " ppm"}], 
                    Row[{
                    Style["y", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`eq2$$, 2], {3, 0}], " ppm"}]}, 
                   Alignment -> "="], 17, $CellContext`colEQ$, Background -> 
                  White], $CellContext`eq2$$, {1, 1.5}]}], 
              If[$CellContext`solution$$, {$CellContext`colEQ$, 
                Line[
                 Map[{#, 
                   $CellContext`yeq$[#]}& , 
                  Range[0, $CellContext`xp1$, 0.01]]]}]}], 
            If[$CellContext`NPR$$ > 3, {{$CellContext`colEQ$, 
               Line[
                Map[{#, 
                  $CellContext`yeq$[#]}& , 
                 Range[0, $CellContext`xp1$, 0.01]]]}, 
              $CellContext`pt2$[{$CellContext`xN$, 
                $CellContext`yeq$[$CellContext`xN$]}, Black], 
              Text[
               Style[
                Row[{"(", 
                  Style[
                   Subscript["x", "N"], $CellContext`colL$, Italic], ", ", 
                  Style[
                   Subscript["y", "N"], $CellContext`colV$, Italic], ")"}], 
                17, Background -> White], {$CellContext`xN$, 
                $CellContext`yeq$[$CellContext`xN$]}, {-1.25, 0.5}], 
              $CellContext`pt2$[{$CellContext`x0$, $CellContext`y1$}, Black], 
              Text[
               Style[
                Row[{"(", 
                  Style[
                   Subscript[
                    Style["x", Italic], 0], $CellContext`colL$], ", ", 
                  Style[
                   Subscript[
                    Style["y", Italic], 1], $CellContext`colV$], ")"}], 17, 
                Background -> 
                White], {$CellContext`x0$, $CellContext`y1$}, {-0.5, -3.5}]}], 
            If[$CellContext`NPR$$ == 4, {{Dashed, 
               Line[{{
                  Part[$CellContext`step1$$, 1], 
                  $CellContext`yeq$[
                   Part[$CellContext`step1$$, 1]]}, {
                  Part[$CellContext`step1$$, 1], 
                  $CellContext`yN1$[
                   Part[$CellContext`step1$$, 1]]}}]}, 
              $CellContext`pt3$[$CellContext`step1$$, Black], 
              If[$CellContext`solution$$, 
               Line[{{
                  $CellContext`X$[0], $CellContext`yn1$}, {
                  $CellContext`X$[0], 
                  $CellContext`Y$[0]}, {
                  $CellContext`X$[1], 
                  $CellContext`Y$[0]}}]]}], 
            If[$CellContext`NPR$$ > 4, 
             Line[{{
                $CellContext`X$[0], $CellContext`yn1$}, {
                $CellContext`X$[0], 
                $CellContext`Y$[0]}, {
                $CellContext`X$[1], 
                $CellContext`Y$[0]}}]], 
            If[$CellContext`NPR$$ == 5, {{Dashed, 
               Line[{{
                  Part[$CellContext`step2$$, 1], 
                  $CellContext`yeq$[
                   Part[$CellContext`step2$$, 1]]}, {
                  Part[$CellContext`step2$$, 1], 
                  $CellContext`yN1$[
                   Part[$CellContext`step2$$, 1]]}}]}, 
              $CellContext`pt3$[$CellContext`step2$$, Black], 
              If[$CellContext`solution$$, 
               Line[{{
                  $CellContext`X$[1], 
                  $CellContext`Y$[0]}, {
                  $CellContext`X$[1], 
                  $CellContext`Y$[1]}, {
                  $CellContext`X$[2], 
                  $CellContext`Y$[1]}}]]}], 
            If[$CellContext`NPR$$ == 6, {{Dashed, 
               Line[{{
                  Part[$CellContext`step3$$, 1], 
                  $CellContext`yeq$[
                   Part[$CellContext`step3$$, 1]]}, {
                  Part[$CellContext`step3$$, 1], 
                  $CellContext`yN1$[
                   Part[$CellContext`step3$$, 1]]}}]}, 
              $CellContext`pt3$[$CellContext`step3$$, Black], 
              Map[Line[{{
                  $CellContext`X$[#], 
                  $CellContext`Y$[#]}, {
                  $CellContext`X$[# + 1], 
                  $CellContext`Y$[#]}}]& , 
               Range[0, $CellContext`n$ - 2]], 
              Map[Line[{{
                  $CellContext`X$[# + 1], 
                  $CellContext`Y$[#]}, {
                  $CellContext`X$[# + 1], 
                  $CellContext`Y$[# + 1]}}]& , 
               Range[0, $CellContext`n$ - 3]], 
              If[$CellContext`solution$$, 
               (Line[{{
                  $CellContext`X$[# + 1], 
                  $CellContext`Y$[#]}, {
                  $CellContext`X$[# + 1], 
                  $CellContext`Y$[# + 1]}, {
                  $CellContext`X$[# + 2], 
                  $CellContext`Y$[# + 1]}}]& )[$CellContext`n$ - 2]]}], 
            If[$CellContext`NPR$$ == 7, {
              Map[Line[{{
                  $CellContext`X$[# - 1], 
                  $CellContext`Y$[# - 1]}, {
                  $CellContext`X$[#], 
                  $CellContext`Y$[# - 1]}, {
                  $CellContext`X$[#], 
                  $CellContext`Y$[#]}}]& , 
               Range[$CellContext`n$]]}]}, 
           PlotRange -> {{0, $CellContext`xp1$}, {0, 1.1 $CellContext`yn1$}}, 
           PlotRangeClipping -> If[$CellContext`NPR$$ == 2, True, False], 
           Frame -> True, FrameLabel -> {
             Row[{"solute/(solute-free liquid) ", 
               Style["x", Italic], " (ppm)"}], 
             Row[{"solute/(solute-free gas) ", 
               Style["y", Italic], " (ppm)"}]}, LabelStyle -> {17, Black}, 
           ImageSize -> {
             If[
              And[$CellContext`graphic$$, $CellContext`NPR$$ < 8], 350, 600], 
             390}, AspectRatio -> Full, GridLines -> 
           If[$CellContext`NPR$$ == 7, None, {
              Range[0, $CellContext`xp1$, 0.05], 
              Range[0, 1.1 $CellContext`yn1$, 5]}], GridLinesStyle -> 
           GrayLevel[0.8], ImagePadding -> {{55, 10}, {50, 
              If[$CellContext`graphic$$, 5, 
               If[
                And[
                3 <= $CellContext`NPR$$ <= 6, $CellContext`hint$$ == False], 
                5, 27]]}}, PlotLabel -> If[$CellContext`graphic$$, None, 
             Style[$CellContext`plotlabel$, 17]]]; 
        If[$CellContext`NPR$$ == 1, $CellContext`column$, 
          If[$CellContext`graphic$$, 
           
           Grid[{{$CellContext`diagram$, $CellContext`column$}}], \
$CellContext`diagram$]]], 
      "Specifications" :> {{{$CellContext`reset$$, 4}, 1, 1000, 1, 
         ControlType -> None, ControlPlacement -> 
         1}, {{$CellContext`NPR$$, 1, ""}, {1, 2, 3, 4, 5, 6, 7}, ControlType -> 
         None, ControlPlacement -> 
         2}, {{$CellContext`solution$$, False, "solution"}, {True, False}, 
         Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         3}, {{$CellContext`hint$$, False, "hint"}, {True, False}, 
         ControlPlacement -> 4}, {{$CellContext`graphic$$, False, "column"}, {
         True, False}, ControlPlacement -> 
         5}, {{$CellContext`op1$$, {0.2, 80}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         6}, {{$CellContext`op2$$, {1.15, 80}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         7}, {{$CellContext`eq1$$, {0.2, 80}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         8}, {{$CellContext`eq2$$, {1.15, 80}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         9}, {{$CellContext`step1$$, {0.8, 60}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         10}, {{$CellContext`step2$$, {0.5, 40}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         11}, {{$CellContext`step3$$, {0.2, 20}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 12}, 
        Grid[{{
           Button[" new problem ", {
             
             If[$CellContext`reset$$ < 
              1000, $CellContext`reset$$ = $CellContext`reset$$ + 
               1, $CellContext`reset$$ = $CellContext`reset$$ - 
               1], $CellContext`NPR$$ = 1, $CellContext`solution$$ = 
             False, $CellContext`hint$$ = 
             False, $CellContext`op1$$ = {0.2, 80}, $CellContext`op2$$ = {
              1.15, 80}, $CellContext`eq1$$ = {
              0.2, 80}, $CellContext`eq2$$ = {
              1.15, 80}, $CellContext`step1$$ = {
              0.8, 60}, $CellContext`step2$$ = {
              0.5, 40}, $CellContext`step3$$ = {0.2, 20}}], 
           Manipulate`Place[1], 
           
           PaneSelector[{
            1 -> "(1) gas flow rate", 2 -> "(2) draw operating line", 3 -> 
             "(3) draw equilibrium line", 4 -> "(4) draw stage 1", 5 -> 
             "(5) draw stage 2", 6 -> "(6) draw last stage", 7 -> 
             "(7) solution"}, 
            Dynamic[$CellContext`NPR$$]], 
           PaneSelector[{1 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 2 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 3 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 4 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 5 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 5 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 6 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}]}, 
            Dynamic[$CellContext`NPR$$]], 
           Manipulate`Place[2], 
           
           PaneSelector[{
            1 -> Manipulate`Place[3], 2 -> Manipulate`Place[3], 3 -> 
             Manipulate`Place[3], 4 -> Manipulate`Place[3], 5 -> 
             Manipulate`Place[3], 6 -> Manipulate`Place[3]}, 
            Dynamic[$CellContext`NPR$$]], 
           
           PaneSelector[{
            1 -> Manipulate`Place[4], 2 -> Manipulate`Place[4], 3 -> 
             Manipulate`Place[4], 4 -> Manipulate`Place[4], 5 -> 
             Manipulate`Place[4], 6 -> Manipulate`Place[4]}, 
            Dynamic[$CellContext`NPR$$]], 
           
           PaneSelector[{
            2 -> Manipulate`Place[5], 3 -> Manipulate`Place[5], 4 -> 
             Manipulate`Place[5], 5 -> Manipulate`Place[5], 6 -> 
             Manipulate`Place[5]}, 
            Dynamic[$CellContext`NPR$$]], 
           PaneSelector[{2 -> Row[{
                Manipulate`Place[6], 
                Manipulate`Place[7]}], 3 -> Row[{
                Manipulate`Place[8], 
                Manipulate`Place[9]}], 4 -> Manipulate`Place[10], 5 -> 
             Manipulate`Place[11], 6 -> Manipulate`Place[12]}, 
            Dynamic[$CellContext`NPR$$]]}}], {{$CellContext`gas$$, 1.2, 
          "select correct gas molar flow rate (Mmol/h)"}, 0.5, 1.5, 0.1, 
         Appearance -> "Labeled", ControlPlacement -> 13}, 
        PaneSelector[{1 -> Manipulate`Place[13]}, 
         Dynamic[$CellContext`NPR$$]]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->75320064,ExpressionUUID->"ff4acde9-0126-488d-bd69-6c72afd0b9c5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ManipulateCaptionSection",ExpressionUUID->"54996798-4af4-4f93-a67e-2e1f5693a36c"],

Cell[TextData[{
 "This Demonstration leads the user through a step-by-step procedure to \
construct an ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "-", "y"}], TraditionalForm]], "InlineMath",ExpressionUUID->
  "83917374-7d4a-4613-9c44-d9a1345a9a78"],
 " diagram for a trayed absorption column that is used to remove an impurity \
from a gas feed by absorbing the impurity in a liquid solvent. The number of \
trays/stages needed to obtain an outlet concentration of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", "1"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "dc47ccd3-8767-410c-b0b9-b825cd963418"],
 " ppm in the gas stream is calculated. Click the \"new problem\" button to \
create a different set of conditions and reset the Demonstration. Click \
\"next\" to go to the next step. Check \"hint\" for a hint, and check \
\"solution\" to see the solution before selecting next step. Once \
\"solution\" is checked, your answer cannot be changed, and once \"next\" is \
selected, you cannot go back. To restart, press \"new problem\". For steps 2 \
and 3, check \"column\" to display a diagram of the absorption column."
}], "ManipulateCaption",
 CellChangeTimes->{{3.72442818407975*^9, 3.7244282226355433`*^9}, 
   3.725614843055814*^9, {3.725615434654318*^9, 3.72561543549463*^9}, {
   3.7256162329841375`*^9, 3.725616265671691*^9}, {3.725616296541393*^9, 
   3.725616417043337*^9}, {3.725809921533683*^9, 3.7258099336967516`*^9}},
 CellID->566805683,ExpressionUUID->"8b57fc84-d51e-4c4e-8dd1-035a39f9d8d8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ThumbnailSection",ExpressionUUID->"7ab96e1c-d347-4da8-a1fc-a2eaedfafc1e"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`eq1$$ = {0.2, 80}, $CellContext`eq2$$ = {
    1.15, 80}, $CellContext`gas$$ = 1.2, $CellContext`graphic$$ = 
    False, $CellContext`hint$$ = False, $CellContext`NPR$$ = 
    1, $CellContext`op1$$ = {0.2, 80}, $CellContext`op2$$ = {
    1.15, 80}, $CellContext`reset$$ = 3, $CellContext`solution$$ = 
    False, $CellContext`step1$$ = {0.8, 60}, $CellContext`step2$$ = {
    0.5, 40}, $CellContext`step3$$ = {0.2, 20}, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`reset$$], 3}, 1, 1000, 1}, {{
       Hold[$CellContext`NPR$$], 1, ""}, {1, 2, 3, 4, 5, 6, 7}}, {{
       Hold[$CellContext`solution$$], False, "solution"}, {True, False}}, {{
       Hold[$CellContext`hint$$], False, "hint"}, {True, False}}, {{
       Hold[$CellContext`graphic$$], False, "column"}, {True, False}}, {{
       Hold[$CellContext`op1$$], {0.2, 80}}, Automatic}, {{
       Hold[$CellContext`op2$$], {1.15, 80}}, Automatic}, {{
       Hold[$CellContext`eq1$$], {0.2, 80}}, Automatic}, {{
       Hold[$CellContext`eq2$$], {1.15, 80}}, Automatic}, {{
       Hold[$CellContext`step1$$], {0.8, 60}}, Automatic}, {{
       Hold[$CellContext`step2$$], {0.5, 40}}, Automatic}, {{
       Hold[$CellContext`step3$$], {0.2, 20}}, Automatic}, {
      Hold[
       Grid[{{
          Button[" new problem ", {
            
            If[$CellContext`reset$$ < 
             1000, $CellContext`reset$$ = $CellContext`reset$$ + 
              1, $CellContext`reset$$ = $CellContext`reset$$ - 
              1], $CellContext`NPR$$ = 1, $CellContext`solution$$ = 
            False, $CellContext`hint$$ = 
            False, $CellContext`op1$$ = {0.2, 80}, $CellContext`op2$$ = {
             1.15, 80}, $CellContext`eq1$$ = {0.2, 80}, $CellContext`eq2$$ = {
             1.15, 80}, $CellContext`step1$$ = {
             0.8, 60}, $CellContext`step2$$ = {
             0.5, 40}, $CellContext`step3$$ = {0.2, 20}}], 
          Manipulate`Place[1], 
          
          PaneSelector[{
           1 -> "(1) gas flow rate", 2 -> "(2) draw operating line", 3 -> 
            "(3) draw equilibrium line", 4 -> "(4) draw stage 1", 5 -> 
            "(5) draw stage 2", 6 -> "(6) draw last stage", 7 -> 
            "(7) solution"}, 
           Dynamic[$CellContext`NPR$$]], 
          PaneSelector[{1 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 2 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 3 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 4 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 5 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 5 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 6 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}]}, 
           Dynamic[$CellContext`NPR$$]], 
          Manipulate`Place[2], 
          
          PaneSelector[{
           1 -> Manipulate`Place[3], 2 -> Manipulate`Place[3], 3 -> 
            Manipulate`Place[3], 4 -> Manipulate`Place[3], 5 -> 
            Manipulate`Place[3], 6 -> Manipulate`Place[3]}, 
           Dynamic[$CellContext`NPR$$]], 
          
          PaneSelector[{
           1 -> Manipulate`Place[4], 2 -> Manipulate`Place[4], 3 -> 
            Manipulate`Place[4], 4 -> Manipulate`Place[4], 5 -> 
            Manipulate`Place[4], 6 -> Manipulate`Place[4]}, 
           Dynamic[$CellContext`NPR$$]], 
          
          PaneSelector[{
           2 -> Manipulate`Place[5], 3 -> Manipulate`Place[5], 4 -> 
            Manipulate`Place[5], 5 -> Manipulate`Place[5], 6 -> 
            Manipulate`Place[5]}, 
           Dynamic[$CellContext`NPR$$]], 
          PaneSelector[{2 -> Row[{
               Manipulate`Place[6], 
               Manipulate`Place[7]}], 3 -> Row[{
               Manipulate`Place[8], 
               Manipulate`Place[9]}], 4 -> Manipulate`Place[10], 5 -> 
            Manipulate`Place[11], 6 -> Manipulate`Place[12]}, 
           Dynamic[$CellContext`NPR$$]]}}]], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`gas$$], 1.2, 
       "select correct gas molar flow rate (Mmol/h)"}, 0.5, 1.5, 0.1}, {
      Hold[
       PaneSelector[{1 -> Manipulate`Place[13]}, 
        Dynamic[$CellContext`NPR$$]]], Manipulate`Dump`ThisIsNotAControl}}, 
    Typeset`size$$ = Automatic, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`reset$71433$$ = 
    0, $CellContext`NPR$71434$$ = 0, $CellContext`solution$71435$$ = 
    False, $CellContext`hint$71436$$ = False, $CellContext`graphic$71437$$ = 
    False, $CellContext`gas$71438$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`eq1$$ = {0.2, 80}, $CellContext`eq2$$ = {
         1.15, 80}, $CellContext`gas$$ = 1.2, $CellContext`graphic$$ = 
        False, $CellContext`hint$$ = False, $CellContext`NPR$$ = 
        1, $CellContext`op1$$ = {0.2, 80}, $CellContext`op2$$ = {
         1.15, 80}, $CellContext`reset$$ = 3, $CellContext`solution$$ = 
        False, $CellContext`step1$$ = {0.8, 60}, $CellContext`step2$$ = {
         0.5, 40}, $CellContext`step3$$ = {0.2, 20}}, "ControllerVariables" :> {
        Hold[$CellContext`reset$$, $CellContext`reset$71433$$, 0], 
        Hold[$CellContext`NPR$$, $CellContext`NPR$71434$$, 0], 
        Hold[$CellContext`solution$$, $CellContext`solution$71435$$, False], 
        Hold[$CellContext`hint$$, $CellContext`hint$71436$$, False], 
        Hold[$CellContext`graphic$$, $CellContext`graphic$71437$$, False], 
        Hold[$CellContext`gas$$, $CellContext`gas$71438$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`colL$, $CellContext`colV$, $CellContext`colOP$, \
$CellContext`colEQ$, $CellContext`colS$, $CellContext`P$, $CellContext`T$, \
$CellContext`L0$, $CellContext`V0$, $CellContext`Ea$, $CellContext`R$, \
$CellContext`H0$, $CellContext`HB$, $CellContext`L$, $CellContext`V$, \
$CellContext`x0$, $CellContext`y1$, $CellContext`yn1$, $CellContext`yN1$, \
$CellContext`yeq$, $CellContext`xp1$, $CellContext`xp2$, \
$CellContext`intersect$, $CellContext`check1$, $CellContext`check2$, \
$CellContext`stage$, $CellContext`test$, $CellContext`n$, \
$CellContext`steps$, $CellContext`stepping$, $CellContext`xN$, \
$CellContext`X$, $CellContext`Y$, $CellContext`xeq$, $CellContext`xop$, \
$CellContext`plotlabel$, $CellContext`h$, $CellContext`w$, $CellContext`ry$, \
$CellContext`column$, $CellContext`opt$, $CellContext`pt1$, \
$CellContext`pt2$, $CellContext`pt3$, $CellContext`diagram$}, \
$CellContext`colL$ = Blue; $CellContext`colV$ = 
         RGBColor[0, 0.6, 0]; $CellContext`colOP$ = 
         Magenta; $CellContext`colEQ$ = 
         RGBColor[1, 0.4, 0]; $CellContext`colS$ = Purple; 
        SeedRandom[$CellContext`reset$$]; $CellContext`P$ = 
         RandomReal[{2.5, 3}]; $CellContext`T$ = 
         RandomInteger[{10, 25}]; $CellContext`L0$ = 
         RandomInteger[{115, 200}]; $CellContext`V0$ = 
         RandomInteger[{12, 15}]/10; $CellContext`Ea$ = 5000; $CellContext`R$ = 
         8.314; $CellContext`H0$ = ReplaceAll[$CellContext`Hi, 
           Part[
            Solve[
            211.19 == $CellContext`Hi 
              Exp[-(5000/($CellContext`R$ 298))], $CellContext`Hi], 
            1]]; $CellContext`HB$ = $CellContext`H0$ 
          Exp[-($CellContext`Ea$/($CellContext`R$ ($CellContext`T$ + 
              273)))]; $CellContext`L$ = 
         1000 $CellContext`L0$; $CellContext`V$ = 
         1000 $CellContext`V0$; $CellContext`x0$ = 0.05; $CellContext`y1$ = 
         10; $CellContext`yn1$ = 100; $CellContext`yN1$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := ($CellContext`L$/$CellContext`V$) ($CellContext`x$ - \
$CellContext`x0$) + $CellContext`y1$; $CellContext`yeq$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := ($CellContext`HB$/$CellContext`P$) $CellContext`x$; \
$CellContext`xp1$ = 1.35; $CellContext`xp2$ = ReplaceAll[$CellContext`x, 
           
           FindRoot[$CellContext`yN1$[$CellContext`x] == 
            1.1 $CellContext`yn1$, {$CellContext`x, 
             0}]]; $CellContext`intersect$ = ReplaceAll[$CellContext`x, 
           Quiet[
            Part[
             
             Solve[$CellContext`yN1$[$CellContext`x] == \
$CellContext`yeq$[$CellContext`x], $CellContext`x], 
             1]]]; $CellContext`check1$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yN1$[$CellContext`x] == $CellContext`yn1$, \
$CellContext`x], 1]]; $CellContext`check2$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yeq$[$CellContext`x] == \
$CellContext`yN1$[$CellContext`x], $CellContext`x], 1]]; $CellContext`xN$ = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yN1$[$CellContext`x] == $CellContext`yn1$, \
$CellContext`x], 1]]; $CellContext`X$[0] = $CellContext`xN$; $CellContext`Y$[
          0] = $CellContext`yeq$[$CellContext`xN$]; 
        Do[{$CellContext`X$[$CellContext`i] = ReplaceAll[$CellContext`x, 
             Quiet[
              Part[
               
               Solve[$CellContext`yN1$[$CellContext`x] == \
$CellContext`Y$[$CellContext`i - 1], $CellContext`x], 
               1]]], $CellContext`Y$[$CellContext`i] = $CellContext`yeq$[
             $CellContext`X$[$CellContext`i]]}, {$CellContext`i, 1, 
           50}]; $CellContext`n$ = 1 + Part[
            DeleteCases[
             Map[If[$CellContext`X$[#] < $CellContext`x0$, 0, #]& , 
              Range[10]], 0], -1]; $CellContext`xeq$[
           Pattern[$CellContext`y$, 
            Blank[]]] := ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`yeq$[$CellContext`x] == 
             Part[$CellContext`y$, 2], {$CellContext`x, 
              0}]]]; $CellContext`xop$[
           Pattern[$CellContext`y$, 
            Blank[]]] := ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`yN1$[$CellContext`x] == 
             Part[$CellContext`y$, 2], {$CellContext`x, 
              0}]]]; $CellContext`plotlabel$ = Switch[$CellContext`NPR$$, 2, 
           
           If[$CellContext`hint$$, "hint: use the mass balance from step 1", 
            
            "step 2: click and drag the points to create the operating line, \
then check solution"], 3, 
           If[$CellContext`hint$$, "hint: use Henry's law", 
            
            Column[{"step 3: click and drag circles to create the equilibrium \
line, then check solution", 
              Row[{
                Style["P", Italic], " = ", 
                NumberForm[$CellContext`P$, {3, 1}], " atm and ", 
                Style["H", Italic], " = ", 
                NumberForm[$CellContext`HB$, {4, 1}], 
                " atm/mole fraction"}]}]], 4, 
           
           If[$CellContext`hint$$, 
            "hint: start counting stages from the bottom of the column", 
            
            Column[{"step 4: drag the black circle to move the dashed line to \
draw the first stage,", "then check solution"}]], 5, 
           
           If[$CellContext`hint$$, 
            "hint: start drawing second stage where the first stage leaves \
off", 
            
            Column[{"step 5: drag the black circle to move the dashed line to \
draw the second", "stage, then check solution"}]], 6, 
           If[$CellContext`hint$$, 
            Row[{"hint: draw last stage until ", 
              Subscript[
               Style["x", Italic], 0], " is reached or surpassed"}], 
            
            Column[{"step 6: drag the black circle to move the dashed line to \
draw the last stage,", "then check solution"}]], 7, 
           Row[{"solved ", 
             Style["x", Italic], "-", 
             Style["y", Italic], " diagram"}]]; $CellContext`h$ = 
         13; $CellContext`w$ = 
         If[$CellContext`NPR$$ == 1, 6, 12]; $CellContext`ry$ = 
         2; $CellContext`column$ = Graphics[{Thick, 
            Map[
            Line[{{#, $CellContext`ry$}, {#, $CellContext`h$ - \
$CellContext`ry$}}]& , {0, $CellContext`w$}], 
            
            Circle[{$CellContext`w$/2, $CellContext`ry$}, {$CellContext`w$/
              2, $CellContext`ry$}, {Pi, 2 Pi}], 
            
            Circle[{$CellContext`w$/
              2, $CellContext`h$ - $CellContext`ry$}, {$CellContext`w$/
              2, $CellContext`ry$}, {0, Pi}], {
             Arrowheads[
              If[$CellContext`NPR$$ == 1, 0.065, 0.09]], $CellContext`colV$, 
             
             Arrow[{{-$CellContext`w$, (-$CellContext`h$)/4}, {
               0.25 $CellContext`w$, (-$CellContext`h$)/4}, {
               0.25 $CellContext`w$, $CellContext`ry$/10}}], 
             
             Arrow[{{0.25 $CellContext`w$, $CellContext`h$ - $CellContext`ry$/
                10}, {0.25 $CellContext`w$, $CellContext`h$ + $CellContext`h$/
                 4}, {-$CellContext`w$, $CellContext`h$ + $CellContext`h$/
                 4}}], $CellContext`colL$, 
             
             Arrow[{{0.75 $CellContext`w$, $CellContext`ry$/10}, {
               0.75 $CellContext`w$, (-$CellContext`h$)/4}, {
               2 $CellContext`w$, (-$CellContext`h$)/4}}], 
             
             Arrow[{{2 $CellContext`w$, $CellContext`h$ + $CellContext`h$/
                 4}, {0.75 $CellContext`w$, $CellContext`h$ + $CellContext`h$/
                 4}, {0.75 $CellContext`w$, $CellContext`h$ - \
$CellContext`ry$/10}}]}, 
            If[4 <= $CellContext`NPR$$, {Thick, 
              Map[
              Line[{{0, #}, {$CellContext`w$, #}}]& , {$CellContext`ry$, 
                0.5 $CellContext`h$, $CellContext`h$ - $CellContext`ry$}], 
              Apply[Text[
                Style[#, 17], {0.5 $CellContext`w$, #2}, {0, -1}]& , {{
                1, $CellContext`ry$}, {
                 Style["n", Italic], 0.5 $CellContext`h$}, {
                 Style["N", Italic], $CellContext`h$ - $CellContext`ry$}}, {
               1}]}, 
             Text[
              Style[
               Column[{
                 Row[{
                   NumberForm[$CellContext`P$, {3, 1}], " atm"}], 
                 Spacer[0], 
                 Row[{
                   NumberForm[$CellContext`T$, {4, 0}], " \[Degree]C"}]}, 
                Center], 
               If[$CellContext`NPR$$ == 1, 17, 16]], {
              0.5 $CellContext`w$, 0.5 $CellContext`h$}]], 
            Text[
             Style[
              If[$CellContext`NPR$$ > 1, 
               Row[{
                 Style["L", Italic], " = ", N[$CellContext`L$]/1000, 
                 " Mmol/h"}], 
               Column[{"liquid solvent feed", 
                 Row[{
                   Style["L", Italic], " = ", N[$CellContext`L$]/1000, 
                   " Mmol/h"}]}, Right]], 
              
              If[$CellContext`NPR$$ == 1, 17, 
               16], $CellContext`colL$], {$CellContext`w$, $CellContext`h$ + \
$CellContext`h$/4}, {-0.5, -1.2}], 
            Text[
             Style[
              If[$CellContext`NPR$$ > 1, 
               Row[{
                 Style["V", Italic], " = ", 
                 NumberForm[N[$CellContext`V$]/1000, {3, 1}], " Mmol/h"}], 
               Column[{"gas feed", 
                 Style[
                  Row[{
                    Style["V", Italic], " = ", $CellContext`gas$$, 
                    " Mmol/h"}], $CellContext`colS$], 
                 If[
                  And[$CellContext`NPR$$ == 1, $CellContext`solution$$], 
                  Row[{"correct ", 
                    Style["V", Italic], " = ", 
                    NumberForm[N[$CellContext`V$]/1000, {3, 1}], 
                    " Mmol/h"}]]}]], 
              If[$CellContext`NPR$$ == 1, 17, 16], $CellContext`colV$], {
             0, (-$CellContext`h$)/4}, {
              If[$CellContext`NPR$$ == 1, 
               If[$CellContext`solution$$, 0.35, 1], 0.5], 1.4}], 
            Apply[Text[
              Style[
               Row[{
                 Subscript[
                  Style["y", Italic], #2], " = ", #, " ppm"}], 
               If[$CellContext`NPR$$ == 1, 17, 16], $CellContext`colV$, 
               Background -> White], {0, #3}, {
               If[$CellContext`graphic$$, 0.5, 1], 0}]& , {{$CellContext`y1$, 
               1, $CellContext`h$ + 2}, {$CellContext`yn1$, 
               Row[{
                 Style["N", Italic], "+1"}], -2}}, {1}], 
            Apply[Text[
              Style[
               Row[{
                 Subscript[
                  Style["x", Italic], #2], " = ", #, " ppm"}], 
               If[$CellContext`NPR$$ == 1, 17, 16], $CellContext`colL$, 
               Background -> White], {$CellContext`w$, #3}, {
               If[$CellContext`graphic$$, -0.5, -1], 
               0}]& , {{$CellContext`x0$, 0, $CellContext`h$ + 2}, {
               NumberForm[$CellContext`xN$, 2], 
               Style["N", Italic], -2}}, {1}]}, ImageSize -> {
             If[$CellContext`NPR$$ == 1, 600, 250], 390}, 
           ImagePadding -> {{20, 20}, {65, 
              If[$CellContext`NPR$$ == 1, 50, 25]}}, AspectRatio -> 
           If[$CellContext`NPR$$ == 1, 0.75, Full], PlotLabel -> 
           If[$CellContext`NPR$$ == 1, 
             Style[
              
              If[$CellContext`hint$$, "hint: use mass balance on solute", 
               "step 1: calculate the gas flow rate, then check solution"], 
              17, Black], None]]; $CellContext`opt$ = Sequence[
           Thickness[
            If[
             And[$CellContext`graphic$$, $CellContext`NPR$$ < 4], 0.011, 
             0.008]], Dotted]; $CellContext`pt1$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`col$, 
            Blank[]]] := {$CellContext`col$, 
           PointSize[
            If[
             And[$CellContext`graphic$$, $CellContext`NPR$$ < 4], 0.04, 
             0.025]], 
           Point[$CellContext`pt$], White, 
           PointSize[
            If[
             And[$CellContext`graphic$$, $CellContext`NPR$$ < 4], 0.025, 
             0.015]], 
           Point[$CellContext`pt$]}; $CellContext`pt2$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`col$, 
            Blank[]]] := {$CellContext`col$, 
           PointSize[
            If[$CellContext`graphic$$, 0.035, 0.02]], 
           Point[$CellContext`pt$]}; $CellContext`pt3$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`col$, 
            Blank[]]] := {$CellContext`col$, 
           PointSize[
            If[$CellContext`graphic$$, 0.035, 0.02]], 
           Point[$CellContext`pt$], White, 
           PointSize[
            If[$CellContext`graphic$$, 0.02, 0.01]], 
           Point[$CellContext`pt$]}; If[
          
          And[$CellContext`n$ == 2, $CellContext`NPR$$ == 
           6], $CellContext`NPR$$ = 7]; $CellContext`diagram$ = 
         Graphics[{Thick, 
            If[$CellContext`NPR$$ == 2, {{
               Evaluate[$CellContext`opt$], $CellContext`colOP$, 
               Line[{$CellContext`op1$$, $CellContext`op2$$}]}, 
              $CellContext`pt1$[$CellContext`op1$$, $CellContext`colOP$], 
              $CellContext`pt1$[$CellContext`op2$$, $CellContext`colOP$], 
              If[$CellContext`solution$$ == False, {
                Text[
                 Style[
                  Column[{
                    Row[{
                    Style["x", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`op1$$, 1], {4, 2}], " ppm"}], 
                    Row[{
                    Style["y", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`op1$$, 2], {3, 0}], " ppm"}]}, 
                   Alignment -> "="], 17, $CellContext`colOP$, Background -> 
                  White], $CellContext`op1$$, {-1, -1.3}], 
                Text[
                 Style[
                  Column[{
                    Row[{
                    Style["x", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`op2$$, 1], {4, 2}], " ppm"}], 
                    Row[{
                    Style["y", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`op2$$, 2], {3, 0}], " ppm"}]}, 
                   Alignment -> "="], 17, $CellContext`colOP$, Background -> 
                  White], $CellContext`op2$$, {1, 1.5}]}], 
              If[$CellContext`solution$$, {$CellContext`colOP$, 
                Line[
                 Map[{#, 
                   $CellContext`yN1$[#]}& , 
                  Range[0, $CellContext`xp2$, 0.01]]]}]}], 
            If[$CellContext`NPR$$ > 2, {$CellContext`colOP$, 
              Line[
               Map[{#, 
                 $CellContext`yN1$[#]}& , 
                Range[0, $CellContext`xp2$, 0.01]]]}], 
            If[$CellContext`NPR$$ == 3, {{
               Evaluate[$CellContext`opt$], $CellContext`colEQ$, 
               Line[{$CellContext`eq1$$, $CellContext`eq2$$}]}, 
              $CellContext`pt1$[$CellContext`eq1$$, $CellContext`colEQ$], 
              $CellContext`pt1$[$CellContext`eq2$$, $CellContext`colEQ$], 
              If[$CellContext`solution$$ == False, {
                Text[
                 Style[
                  Column[{
                    Row[{
                    Style["x", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`eq1$$, 1], {4, 2}], " ppm"}], 
                    Row[{
                    Style["y", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`eq1$$, 2], {3, 0}], " ppm"}]}, 
                   Alignment -> "="], 17, $CellContext`colEQ$, Background -> 
                  White], $CellContext`eq1$$, {-1, -1.3}], 
                Text[
                 Style[
                  Column[{
                    Row[{
                    Style["x", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`eq2$$, 1], {4, 2}], " ppm"}], 
                    Row[{
                    Style["y", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`eq2$$, 2], {3, 0}], " ppm"}]}, 
                   Alignment -> "="], 17, $CellContext`colEQ$, Background -> 
                  White], $CellContext`eq2$$, {1, 1.5}]}], 
              If[$CellContext`solution$$, {$CellContext`colEQ$, 
                Line[
                 Map[{#, 
                   $CellContext`yeq$[#]}& , 
                  Range[0, $CellContext`xp1$, 0.01]]]}]}], 
            If[$CellContext`NPR$$ > 3, {{$CellContext`colEQ$, 
               Line[
                Map[{#, 
                  $CellContext`yeq$[#]}& , 
                 Range[0, $CellContext`xp1$, 0.01]]]}, 
              $CellContext`pt2$[{$CellContext`xN$, 
                $CellContext`yeq$[$CellContext`xN$]}, Black], 
              Text[
               Style[
                Row[{"(", 
                  Style[
                   Subscript["x", "N"], $CellContext`colL$, Italic], ", ", 
                  Style[
                   Subscript["y", "N"], $CellContext`colV$, Italic], ")"}], 
                17, Background -> White], {$CellContext`xN$, 
                $CellContext`yeq$[$CellContext`xN$]}, {-1.25, 0.5}], 
              $CellContext`pt2$[{$CellContext`x0$, $CellContext`y1$}, Black], 
              Text[
               Style[
                Row[{"(", 
                  Style[
                   Subscript[
                    Style["x", Italic], 0], $CellContext`colL$], ", ", 
                  Style[
                   Subscript[
                    Style["y", Italic], 1], $CellContext`colV$], ")"}], 17, 
                Background -> 
                White], {$CellContext`x0$, $CellContext`y1$}, {-0.5, -3.5}]}], 
            If[$CellContext`NPR$$ == 4, {{Dashed, 
               Line[{{
                  Part[$CellContext`step1$$, 1], 
                  $CellContext`yeq$[
                   Part[$CellContext`step1$$, 1]]}, {
                  Part[$CellContext`step1$$, 1], 
                  $CellContext`yN1$[
                   Part[$CellContext`step1$$, 1]]}}]}, 
              $CellContext`pt3$[$CellContext`step1$$, Black], 
              If[$CellContext`solution$$, 
               Line[{{
                  $CellContext`X$[0], $CellContext`yn1$}, {
                  $CellContext`X$[0], 
                  $CellContext`Y$[0]}, {
                  $CellContext`X$[1], 
                  $CellContext`Y$[0]}}]]}], 
            If[$CellContext`NPR$$ > 4, 
             Line[{{
                $CellContext`X$[0], $CellContext`yn1$}, {
                $CellContext`X$[0], 
                $CellContext`Y$[0]}, {
                $CellContext`X$[1], 
                $CellContext`Y$[0]}}]], 
            If[$CellContext`NPR$$ == 5, {{Dashed, 
               Line[{{
                  Part[$CellContext`step2$$, 1], 
                  $CellContext`yeq$[
                   Part[$CellContext`step2$$, 1]]}, {
                  Part[$CellContext`step2$$, 1], 
                  $CellContext`yN1$[
                   Part[$CellContext`step2$$, 1]]}}]}, 
              $CellContext`pt3$[$CellContext`step2$$, Black], 
              If[$CellContext`solution$$, 
               Line[{{
                  $CellContext`X$[1], 
                  $CellContext`Y$[0]}, {
                  $CellContext`X$[1], 
                  $CellContext`Y$[1]}, {
                  $CellContext`X$[2], 
                  $CellContext`Y$[1]}}]]}], 
            If[$CellContext`NPR$$ == 6, {{Dashed, 
               Line[{{
                  Part[$CellContext`step3$$, 1], 
                  $CellContext`yeq$[
                   Part[$CellContext`step3$$, 1]]}, {
                  Part[$CellContext`step3$$, 1], 
                  $CellContext`yN1$[
                   Part[$CellContext`step3$$, 1]]}}]}, 
              $CellContext`pt3$[$CellContext`step3$$, Black], 
              Map[Line[{{
                  $CellContext`X$[#], 
                  $CellContext`Y$[#]}, {
                  $CellContext`X$[# + 1], 
                  $CellContext`Y$[#]}}]& , 
               Range[0, $CellContext`n$ - 2]], 
              Map[Line[{{
                  $CellContext`X$[# + 1], 
                  $CellContext`Y$[#]}, {
                  $CellContext`X$[# + 1], 
                  $CellContext`Y$[# + 1]}}]& , 
               Range[0, $CellContext`n$ - 3]], 
              If[$CellContext`solution$$, 
               (Line[{{
                  $CellContext`X$[# + 1], 
                  $CellContext`Y$[#]}, {
                  $CellContext`X$[# + 1], 
                  $CellContext`Y$[# + 1]}, {
                  $CellContext`X$[# + 2], 
                  $CellContext`Y$[# + 1]}}]& )[$CellContext`n$ - 2]]}], 
            If[$CellContext`NPR$$ == 7, {
              Map[Line[{{
                  $CellContext`X$[# - 1], 
                  $CellContext`Y$[# - 1]}, {
                  $CellContext`X$[#], 
                  $CellContext`Y$[# - 1]}, {
                  $CellContext`X$[#], 
                  $CellContext`Y$[#]}}]& , 
               Range[$CellContext`n$]]}]}, 
           PlotRange -> {{0, $CellContext`xp1$}, {0, 1.1 $CellContext`yn1$}}, 
           PlotRangeClipping -> If[$CellContext`NPR$$ == 2, True, False], 
           Frame -> True, FrameLabel -> {
             Row[{"solute/(solute-free liquid) ", 
               Style["x", Italic], " (ppm)"}], 
             Row[{"solute/(solute-free gas) ", 
               Style["y", Italic], " (ppm)"}]}, LabelStyle -> {17, Black}, 
           ImageSize -> {
             If[
              And[$CellContext`graphic$$, $CellContext`NPR$$ < 8], 350, 600], 
             390}, AspectRatio -> Full, GridLines -> 
           If[$CellContext`NPR$$ == 7, None, {
              Range[0, $CellContext`xp1$, 0.05], 
              Range[0, 1.1 $CellContext`yn1$, 5]}], GridLinesStyle -> 
           GrayLevel[0.8], ImagePadding -> {{55, 10}, {50, 
              If[$CellContext`graphic$$, 5, 
               If[
                And[
                3 <= $CellContext`NPR$$ <= 6, $CellContext`hint$$ == False], 
                5, 27]]}}, PlotLabel -> If[$CellContext`graphic$$, None, 
             Style[$CellContext`plotlabel$, 17]]]; 
        If[$CellContext`NPR$$ == 1, $CellContext`column$, 
          If[$CellContext`graphic$$, 
           
           Grid[{{$CellContext`diagram$, $CellContext`column$}}], \
$CellContext`diagram$]]], 
      "Specifications" :> {{{$CellContext`reset$$, 3}, 1, 1000, 1, 
         ControlType -> None, ControlPlacement -> 
         1}, {{$CellContext`NPR$$, 1, ""}, {1, 2, 3, 4, 5, 6, 7}, ControlType -> 
         None, ControlPlacement -> 
         2}, {{$CellContext`solution$$, False, "solution"}, {True, False}, 
         Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         3}, {{$CellContext`hint$$, False, "hint"}, {True, False}, 
         ControlPlacement -> 4}, {{$CellContext`graphic$$, False, "column"}, {
         True, False}, ControlPlacement -> 
         5}, {{$CellContext`op1$$, {0.2, 80}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         6}, {{$CellContext`op2$$, {1.15, 80}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         7}, {{$CellContext`eq1$$, {0.2, 80}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         8}, {{$CellContext`eq2$$, {1.15, 80}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         9}, {{$CellContext`step1$$, {0.8, 60}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         10}, {{$CellContext`step2$$, {0.5, 40}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         11}, {{$CellContext`step3$$, {0.2, 20}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 12}, 
        Grid[{{
           Button[" new problem ", {
             
             If[$CellContext`reset$$ < 
              1000, $CellContext`reset$$ = $CellContext`reset$$ + 
               1, $CellContext`reset$$ = $CellContext`reset$$ - 
               1], $CellContext`NPR$$ = 1, $CellContext`solution$$ = 
             False, $CellContext`hint$$ = 
             False, $CellContext`op1$$ = {0.2, 80}, $CellContext`op2$$ = {
              1.15, 80}, $CellContext`eq1$$ = {
              0.2, 80}, $CellContext`eq2$$ = {
              1.15, 80}, $CellContext`step1$$ = {
              0.8, 60}, $CellContext`step2$$ = {
              0.5, 40}, $CellContext`step3$$ = {0.2, 20}}], 
           Manipulate`Place[1], 
           
           PaneSelector[{
            1 -> "(1) gas flow rate", 2 -> "(2) draw operating line", 3 -> 
             "(3) draw equilibrium line", 4 -> "(4) draw stage 1", 5 -> 
             "(5) draw stage 2", 6 -> "(6) draw last stage", 7 -> 
             "(7) solution"}, 
            Dynamic[$CellContext`NPR$$]], 
           PaneSelector[{1 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 2 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 3 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 4 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 5 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 5 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 6 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}]}, 
            Dynamic[$CellContext`NPR$$]], 
           Manipulate`Place[2], 
           
           PaneSelector[{
            1 -> Manipulate`Place[3], 2 -> Manipulate`Place[3], 3 -> 
             Manipulate`Place[3], 4 -> Manipulate`Place[3], 5 -> 
             Manipulate`Place[3], 6 -> Manipulate`Place[3]}, 
            Dynamic[$CellContext`NPR$$]], 
           
           PaneSelector[{
            1 -> Manipulate`Place[4], 2 -> Manipulate`Place[4], 3 -> 
             Manipulate`Place[4], 4 -> Manipulate`Place[4], 5 -> 
             Manipulate`Place[4], 6 -> Manipulate`Place[4]}, 
            Dynamic[$CellContext`NPR$$]], 
           
           PaneSelector[{
            2 -> Manipulate`Place[5], 3 -> Manipulate`Place[5], 4 -> 
             Manipulate`Place[5], 5 -> Manipulate`Place[5], 6 -> 
             Manipulate`Place[5]}, 
            Dynamic[$CellContext`NPR$$]], 
           PaneSelector[{2 -> Row[{
                Manipulate`Place[6], 
                Manipulate`Place[7]}], 3 -> Row[{
                Manipulate`Place[8], 
                Manipulate`Place[9]}], 4 -> Manipulate`Place[10], 5 -> 
             Manipulate`Place[11], 6 -> Manipulate`Place[12]}, 
            Dynamic[$CellContext`NPR$$]]}}], {{$CellContext`gas$$, 1.2, 
          "select correct gas molar flow rate (Mmol/h)"}, 0.5, 1.5, 0.1, 
         Appearance -> "Labeled", ControlPlacement -> 13}, 
        PaneSelector[{1 -> Manipulate`Place[13]}, 
         Dynamic[$CellContext`NPR$$]]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->19252057,ExpressionUUID->"c7e46944-cc17-4d66-ac05-f3c7f9b9c520"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SnapshotsSection",ExpressionUUID->"dddd4106-55f0-4bea-b4c1-cea8b6face0c"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`eq1$$ = {0.2, 80}, $CellContext`eq2$$ = {
    1.15, 80}, $CellContext`gas$$ = 1.2, $CellContext`graphic$$ = 
    False, $CellContext`hint$$ = False, $CellContext`NPR$$ = 
    2, $CellContext`op1$$ = {0.2, 80}, $CellContext`op2$$ = {
    1.15, 80}, $CellContext`reset$$ = 3, $CellContext`solution$$ = 
    False, $CellContext`step1$$ = {0.8, 60}, $CellContext`step2$$ = {
    0.5, 40}, $CellContext`step3$$ = {0.2, 20}, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`reset$$], 3}, 1, 1000, 1}, {{
       Hold[$CellContext`NPR$$], 2, ""}, {1, 2, 3, 4, 5, 6, 7}}, {{
       Hold[$CellContext`solution$$], False, "solution"}, {True, False}}, {{
       Hold[$CellContext`hint$$], False, "hint"}, {True, False}}, {{
       Hold[$CellContext`graphic$$], False, "column"}, {True, False}}, {{
       Hold[$CellContext`op1$$], {0.2, 80}}, Automatic}, {{
       Hold[$CellContext`op2$$], {1.15, 80}}, Automatic}, {{
       Hold[$CellContext`eq1$$], {0.2, 80}}, Automatic}, {{
       Hold[$CellContext`eq2$$], {1.15, 80}}, Automatic}, {{
       Hold[$CellContext`step1$$], {0.8, 60}}, Automatic}, {{
       Hold[$CellContext`step2$$], {0.5, 40}}, Automatic}, {{
       Hold[$CellContext`step3$$], {0.2, 20}}, Automatic}, {
      Hold[
       Grid[{{
          Button[" new problem ", {
            
            If[$CellContext`reset$$ < 
             1000, $CellContext`reset$$ = $CellContext`reset$$ + 
              1, $CellContext`reset$$ = $CellContext`reset$$ - 
              1], $CellContext`NPR$$ = 1, $CellContext`solution$$ = 
            False, $CellContext`hint$$ = 
            False, $CellContext`op1$$ = {0.2, 80}, $CellContext`op2$$ = {
             1.15, 80}, $CellContext`eq1$$ = {0.2, 80}, $CellContext`eq2$$ = {
             1.15, 80}, $CellContext`step1$$ = {
             0.8, 60}, $CellContext`step2$$ = {
             0.5, 40}, $CellContext`step3$$ = {0.2, 20}}], 
          Manipulate`Place[1], 
          
          PaneSelector[{
           1 -> "(1) gas flow rate", 2 -> "(2) draw operating line", 3 -> 
            "(3) draw equilibrium line", 4 -> "(4) draw stage 1", 5 -> 
            "(5) draw stage 2", 6 -> "(6) draw last stage", 7 -> 
            "(7) solution"}, 
           Dynamic[$CellContext`NPR$$]], 
          PaneSelector[{1 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 2 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 3 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 4 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 5 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 5 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 6 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}]}, 
           Dynamic[$CellContext`NPR$$]], 
          Manipulate`Place[2], 
          
          PaneSelector[{
           1 -> Manipulate`Place[3], 2 -> Manipulate`Place[3], 3 -> 
            Manipulate`Place[3], 4 -> Manipulate`Place[3], 5 -> 
            Manipulate`Place[3], 6 -> Manipulate`Place[3]}, 
           Dynamic[$CellContext`NPR$$]], 
          
          PaneSelector[{
           1 -> Manipulate`Place[4], 2 -> Manipulate`Place[4], 3 -> 
            Manipulate`Place[4], 4 -> Manipulate`Place[4], 5 -> 
            Manipulate`Place[4], 6 -> Manipulate`Place[4]}, 
           Dynamic[$CellContext`NPR$$]], 
          
          PaneSelector[{
           2 -> Manipulate`Place[5], 3 -> Manipulate`Place[5], 4 -> 
            Manipulate`Place[5], 5 -> Manipulate`Place[5], 6 -> 
            Manipulate`Place[5]}, 
           Dynamic[$CellContext`NPR$$]], 
          PaneSelector[{2 -> Row[{
               Manipulate`Place[6], 
               Manipulate`Place[7]}], 3 -> Row[{
               Manipulate`Place[8], 
               Manipulate`Place[9]}], 4 -> Manipulate`Place[10], 5 -> 
            Manipulate`Place[11], 6 -> Manipulate`Place[12]}, 
           Dynamic[$CellContext`NPR$$]]}}]], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`gas$$], 1.2, 
       "select correct gas molar flow rate (Mmol/h)"}, 0.5, 1.5, 0.1}, {
      Hold[
       PaneSelector[{1 -> Manipulate`Place[13]}, 
        Dynamic[$CellContext`NPR$$]]], Manipulate`Dump`ThisIsNotAControl}}, 
    Typeset`size$$ = Automatic, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`reset$71537$$ = 
    0, $CellContext`NPR$71538$$ = 0, $CellContext`solution$71539$$ = 
    False, $CellContext`hint$71540$$ = False, $CellContext`graphic$71541$$ = 
    False, $CellContext`gas$71542$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`eq1$$ = {0.2, 80}, $CellContext`eq2$$ = {
         1.15, 80}, $CellContext`gas$$ = 1.2, $CellContext`graphic$$ = 
        False, $CellContext`hint$$ = False, $CellContext`NPR$$ = 
        2, $CellContext`op1$$ = {0.2, 80}, $CellContext`op2$$ = {
         1.15, 80}, $CellContext`reset$$ = 3, $CellContext`solution$$ = 
        False, $CellContext`step1$$ = {0.8, 60}, $CellContext`step2$$ = {
         0.5, 40}, $CellContext`step3$$ = {0.2, 20}}, "ControllerVariables" :> {
        Hold[$CellContext`reset$$, $CellContext`reset$71537$$, 0], 
        Hold[$CellContext`NPR$$, $CellContext`NPR$71538$$, 0], 
        Hold[$CellContext`solution$$, $CellContext`solution$71539$$, False], 
        Hold[$CellContext`hint$$, $CellContext`hint$71540$$, False], 
        Hold[$CellContext`graphic$$, $CellContext`graphic$71541$$, False], 
        Hold[$CellContext`gas$$, $CellContext`gas$71542$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`colL$, $CellContext`colV$, $CellContext`colOP$, \
$CellContext`colEQ$, $CellContext`colS$, $CellContext`P$, $CellContext`T$, \
$CellContext`L0$, $CellContext`V0$, $CellContext`Ea$, $CellContext`R$, \
$CellContext`H0$, $CellContext`HB$, $CellContext`L$, $CellContext`V$, \
$CellContext`x0$, $CellContext`y1$, $CellContext`yn1$, $CellContext`yN1$, \
$CellContext`yeq$, $CellContext`xp1$, $CellContext`xp2$, \
$CellContext`intersect$, $CellContext`check1$, $CellContext`check2$, \
$CellContext`stage$, $CellContext`test$, $CellContext`n$, \
$CellContext`steps$, $CellContext`stepping$, $CellContext`xN$, \
$CellContext`X$, $CellContext`Y$, $CellContext`xeq$, $CellContext`xop$, \
$CellContext`plotlabel$, $CellContext`h$, $CellContext`w$, $CellContext`ry$, \
$CellContext`column$, $CellContext`opt$, $CellContext`pt1$, \
$CellContext`pt2$, $CellContext`pt3$, $CellContext`diagram$}, \
$CellContext`colL$ = Blue; $CellContext`colV$ = 
         RGBColor[0, 0.6, 0]; $CellContext`colOP$ = 
         Magenta; $CellContext`colEQ$ = 
         RGBColor[1, 0.4, 0]; $CellContext`colS$ = Purple; 
        SeedRandom[$CellContext`reset$$]; $CellContext`P$ = 
         RandomReal[{2.5, 3}]; $CellContext`T$ = 
         RandomInteger[{10, 25}]; $CellContext`L0$ = 
         RandomInteger[{115, 200}]; $CellContext`V0$ = 
         RandomInteger[{12, 15}]/10; $CellContext`Ea$ = 5000; $CellContext`R$ = 
         8.314; $CellContext`H0$ = ReplaceAll[$CellContext`Hi, 
           Part[
            Solve[
            211.19 == $CellContext`Hi 
              Exp[-(5000/($CellContext`R$ 298))], $CellContext`Hi], 
            1]]; $CellContext`HB$ = $CellContext`H0$ 
          Exp[-($CellContext`Ea$/($CellContext`R$ ($CellContext`T$ + 
              273)))]; $CellContext`L$ = 
         1000 $CellContext`L0$; $CellContext`V$ = 
         1000 $CellContext`V0$; $CellContext`x0$ = 0.05; $CellContext`y1$ = 
         10; $CellContext`yn1$ = 100; $CellContext`yN1$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := ($CellContext`L$/$CellContext`V$) ($CellContext`x$ - \
$CellContext`x0$) + $CellContext`y1$; $CellContext`yeq$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := ($CellContext`HB$/$CellContext`P$) $CellContext`x$; \
$CellContext`xp1$ = 1.35; $CellContext`xp2$ = ReplaceAll[$CellContext`x, 
           
           FindRoot[$CellContext`yN1$[$CellContext`x] == 
            1.1 $CellContext`yn1$, {$CellContext`x, 
             0}]]; $CellContext`intersect$ = ReplaceAll[$CellContext`x, 
           Quiet[
            Part[
             
             Solve[$CellContext`yN1$[$CellContext`x] == \
$CellContext`yeq$[$CellContext`x], $CellContext`x], 
             1]]]; $CellContext`check1$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yN1$[$CellContext`x] == $CellContext`yn1$, \
$CellContext`x], 1]]; $CellContext`check2$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yeq$[$CellContext`x] == \
$CellContext`yN1$[$CellContext`x], $CellContext`x], 1]]; $CellContext`xN$ = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yN1$[$CellContext`x] == $CellContext`yn1$, \
$CellContext`x], 1]]; $CellContext`X$[0] = $CellContext`xN$; $CellContext`Y$[
          0] = $CellContext`yeq$[$CellContext`xN$]; 
        Do[{$CellContext`X$[$CellContext`i] = ReplaceAll[$CellContext`x, 
             Quiet[
              Part[
               
               Solve[$CellContext`yN1$[$CellContext`x] == \
$CellContext`Y$[$CellContext`i - 1], $CellContext`x], 
               1]]], $CellContext`Y$[$CellContext`i] = $CellContext`yeq$[
             $CellContext`X$[$CellContext`i]]}, {$CellContext`i, 1, 
           50}]; $CellContext`n$ = 1 + Part[
            DeleteCases[
             Map[If[$CellContext`X$[#] < $CellContext`x0$, 0, #]& , 
              Range[10]], 0], -1]; $CellContext`xeq$[
           Pattern[$CellContext`y$, 
            Blank[]]] := ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`yeq$[$CellContext`x] == 
             Part[$CellContext`y$, 2], {$CellContext`x, 
              0}]]]; $CellContext`xop$[
           Pattern[$CellContext`y$, 
            Blank[]]] := ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`yN1$[$CellContext`x] == 
             Part[$CellContext`y$, 2], {$CellContext`x, 
              0}]]]; $CellContext`plotlabel$ = Switch[$CellContext`NPR$$, 2, 
           
           If[$CellContext`hint$$, "hint: use the mass balance from step 1", 
            
            "step 2: click and drag the points to create the operating line, \
then check solution"], 3, 
           If[$CellContext`hint$$, "hint: use Henry's law", 
            
            Column[{"step 3: click and drag circles to create the equilibrium \
line, then check solution", 
              Row[{
                Style["P", Italic], " = ", 
                NumberForm[$CellContext`P$, {3, 1}], " atm and ", 
                Style["H", Italic], " = ", 
                NumberForm[$CellContext`HB$, {4, 1}], 
                " atm/mole fraction"}]}]], 4, 
           
           If[$CellContext`hint$$, 
            "hint: start counting stages from the bottom of the column", 
            
            Column[{"step 4: drag the black circle to move the dashed line to \
draw the first stage,", "then check solution"}]], 5, 
           
           If[$CellContext`hint$$, 
            "hint: start drawing second stage where the first stage leaves \
off", 
            
            Column[{"step 5: drag the black circle to move the dashed line to \
draw the second", "stage, then check solution"}]], 6, 
           If[$CellContext`hint$$, 
            Row[{"hint: draw last stage until ", 
              Subscript[
               Style["x", Italic], 0], " is reached or surpassed"}], 
            
            Column[{"step 6: drag the black circle to move the dashed line to \
draw the last stage,", "then check solution"}]], 7, 
           Row[{"solved ", 
             Style["x", Italic], "-", 
             Style["y", Italic], " diagram"}]]; $CellContext`h$ = 
         13; $CellContext`w$ = 
         If[$CellContext`NPR$$ == 1, 6, 12]; $CellContext`ry$ = 
         2; $CellContext`column$ = Graphics[{Thick, 
            Map[
            Line[{{#, $CellContext`ry$}, {#, $CellContext`h$ - \
$CellContext`ry$}}]& , {0, $CellContext`w$}], 
            
            Circle[{$CellContext`w$/2, $CellContext`ry$}, {$CellContext`w$/
              2, $CellContext`ry$}, {Pi, 2 Pi}], 
            
            Circle[{$CellContext`w$/
              2, $CellContext`h$ - $CellContext`ry$}, {$CellContext`w$/
              2, $CellContext`ry$}, {0, Pi}], {
             Arrowheads[
              If[$CellContext`NPR$$ == 1, 0.065, 0.09]], $CellContext`colV$, 
             
             Arrow[{{-$CellContext`w$, (-$CellContext`h$)/4}, {
               0.25 $CellContext`w$, (-$CellContext`h$)/4}, {
               0.25 $CellContext`w$, $CellContext`ry$/10}}], 
             
             Arrow[{{0.25 $CellContext`w$, $CellContext`h$ - $CellContext`ry$/
                10}, {0.25 $CellContext`w$, $CellContext`h$ + $CellContext`h$/
                 4}, {-$CellContext`w$, $CellContext`h$ + $CellContext`h$/
                 4}}], $CellContext`colL$, 
             
             Arrow[{{0.75 $CellContext`w$, $CellContext`ry$/10}, {
               0.75 $CellContext`w$, (-$CellContext`h$)/4}, {
               2 $CellContext`w$, (-$CellContext`h$)/4}}], 
             
             Arrow[{{2 $CellContext`w$, $CellContext`h$ + $CellContext`h$/
                 4}, {0.75 $CellContext`w$, $CellContext`h$ + $CellContext`h$/
                 4}, {0.75 $CellContext`w$, $CellContext`h$ - \
$CellContext`ry$/10}}]}, 
            If[4 <= $CellContext`NPR$$, {Thick, 
              Map[
              Line[{{0, #}, {$CellContext`w$, #}}]& , {$CellContext`ry$, 
                0.5 $CellContext`h$, $CellContext`h$ - $CellContext`ry$}], 
              Apply[Text[
                Style[#, 17], {0.5 $CellContext`w$, #2}, {0, -1}]& , {{
                1, $CellContext`ry$}, {
                 Style["n", Italic], 0.5 $CellContext`h$}, {
                 Style["N", Italic], $CellContext`h$ - $CellContext`ry$}}, {
               1}]}, 
             Text[
              Style[
               Column[{
                 Row[{
                   NumberForm[$CellContext`P$, {3, 1}], " atm"}], 
                 Spacer[0], 
                 Row[{
                   NumberForm[$CellContext`T$, {4, 0}], " \[Degree]C"}]}, 
                Center], 
               If[$CellContext`NPR$$ == 1, 17, 16]], {
              0.5 $CellContext`w$, 0.5 $CellContext`h$}]], 
            Text[
             Style[
              If[$CellContext`NPR$$ > 1, 
               Row[{
                 Style["L", Italic], " = ", N[$CellContext`L$]/1000, 
                 " Mmol/h"}], 
               Column[{"liquid solvent feed", 
                 Row[{
                   Style["L", Italic], " = ", N[$CellContext`L$]/1000, 
                   " Mmol/h"}]}, Right]], 
              
              If[$CellContext`NPR$$ == 1, 17, 
               16], $CellContext`colL$], {$CellContext`w$, $CellContext`h$ + \
$CellContext`h$/4}, {-0.5, -1.2}], 
            Text[
             Style[
              If[$CellContext`NPR$$ > 1, 
               Row[{
                 Style["V", Italic], " = ", 
                 NumberForm[N[$CellContext`V$]/1000, {3, 1}], " Mmol/h"}], 
               Column[{"gas feed", 
                 Style[
                  Row[{
                    Style["V", Italic], " = ", $CellContext`gas$$, 
                    " Mmol/h"}], $CellContext`colS$], 
                 If[
                  And[$CellContext`NPR$$ == 1, $CellContext`solution$$], 
                  Row[{"correct ", 
                    Style["V", Italic], " = ", 
                    NumberForm[N[$CellContext`V$]/1000, {3, 1}], 
                    " Mmol/h"}]]}]], 
              If[$CellContext`NPR$$ == 1, 17, 16], $CellContext`colV$], {
             0, (-$CellContext`h$)/4}, {
              If[$CellContext`NPR$$ == 1, 
               If[$CellContext`solution$$, 0.35, 1], 0.5], 1.4}], 
            Apply[Text[
              Style[
               Row[{
                 Subscript[
                  Style["y", Italic], #2], " = ", #, " ppm"}], 
               If[$CellContext`NPR$$ == 1, 17, 16], $CellContext`colV$, 
               Background -> White], {0, #3}, {
               If[$CellContext`graphic$$, 0.5, 1], 0}]& , {{$CellContext`y1$, 
               1, $CellContext`h$ + 2}, {$CellContext`yn1$, 
               Row[{
                 Style["N", Italic], "+1"}], -2}}, {1}], 
            Apply[Text[
              Style[
               Row[{
                 Subscript[
                  Style["x", Italic], #2], " = ", #, " ppm"}], 
               If[$CellContext`NPR$$ == 1, 17, 16], $CellContext`colL$, 
               Background -> White], {$CellContext`w$, #3}, {
               If[$CellContext`graphic$$, -0.5, -1], 
               0}]& , {{$CellContext`x0$, 0, $CellContext`h$ + 2}, {
               NumberForm[$CellContext`xN$, 2], 
               Style["N", Italic], -2}}, {1}]}, ImageSize -> {
             If[$CellContext`NPR$$ == 1, 600, 250], 390}, 
           ImagePadding -> {{20, 20}, {65, 
              If[$CellContext`NPR$$ == 1, 50, 25]}}, AspectRatio -> 
           If[$CellContext`NPR$$ == 1, 0.75, Full], PlotLabel -> 
           If[$CellContext`NPR$$ == 1, 
             Style[
              
              If[$CellContext`hint$$, "hint: use mass balance on solute", 
               "step 1: calculate the gas flow rate, then check solution"], 
              17, Black], None]]; $CellContext`opt$ = Sequence[
           Thickness[
            If[
             And[$CellContext`graphic$$, $CellContext`NPR$$ < 4], 0.011, 
             0.008]], Dotted]; $CellContext`pt1$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`col$, 
            Blank[]]] := {$CellContext`col$, 
           PointSize[
            If[
             And[$CellContext`graphic$$, $CellContext`NPR$$ < 4], 0.04, 
             0.025]], 
           Point[$CellContext`pt$], White, 
           PointSize[
            If[
             And[$CellContext`graphic$$, $CellContext`NPR$$ < 4], 0.025, 
             0.015]], 
           Point[$CellContext`pt$]}; $CellContext`pt2$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`col$, 
            Blank[]]] := {$CellContext`col$, 
           PointSize[
            If[$CellContext`graphic$$, 0.035, 0.02]], 
           Point[$CellContext`pt$]}; $CellContext`pt3$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`col$, 
            Blank[]]] := {$CellContext`col$, 
           PointSize[
            If[$CellContext`graphic$$, 0.035, 0.02]], 
           Point[$CellContext`pt$], White, 
           PointSize[
            If[$CellContext`graphic$$, 0.02, 0.01]], 
           Point[$CellContext`pt$]}; If[
          
          And[$CellContext`n$ == 2, $CellContext`NPR$$ == 
           6], $CellContext`NPR$$ = 7]; $CellContext`diagram$ = 
         Graphics[{Thick, 
            If[$CellContext`NPR$$ == 2, {{
               Evaluate[$CellContext`opt$], $CellContext`colOP$, 
               Line[{$CellContext`op1$$, $CellContext`op2$$}]}, 
              $CellContext`pt1$[$CellContext`op1$$, $CellContext`colOP$], 
              $CellContext`pt1$[$CellContext`op2$$, $CellContext`colOP$], 
              If[$CellContext`solution$$ == False, {
                Text[
                 Style[
                  Column[{
                    Row[{
                    Style["x", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`op1$$, 1], {4, 2}], " ppm"}], 
                    Row[{
                    Style["y", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`op1$$, 2], {3, 0}], " ppm"}]}, 
                   Alignment -> "="], 17, $CellContext`colOP$, Background -> 
                  White], $CellContext`op1$$, {-1, -1.3}], 
                Text[
                 Style[
                  Column[{
                    Row[{
                    Style["x", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`op2$$, 1], {4, 2}], " ppm"}], 
                    Row[{
                    Style["y", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`op2$$, 2], {3, 0}], " ppm"}]}, 
                   Alignment -> "="], 17, $CellContext`colOP$, Background -> 
                  White], $CellContext`op2$$, {1, 1.5}]}], 
              If[$CellContext`solution$$, {$CellContext`colOP$, 
                Line[
                 Map[{#, 
                   $CellContext`yN1$[#]}& , 
                  Range[0, $CellContext`xp2$, 0.01]]]}]}], 
            If[$CellContext`NPR$$ > 2, {$CellContext`colOP$, 
              Line[
               Map[{#, 
                 $CellContext`yN1$[#]}& , 
                Range[0, $CellContext`xp2$, 0.01]]]}], 
            If[$CellContext`NPR$$ == 3, {{
               Evaluate[$CellContext`opt$], $CellContext`colEQ$, 
               Line[{$CellContext`eq1$$, $CellContext`eq2$$}]}, 
              $CellContext`pt1$[$CellContext`eq1$$, $CellContext`colEQ$], 
              $CellContext`pt1$[$CellContext`eq2$$, $CellContext`colEQ$], 
              If[$CellContext`solution$$ == False, {
                Text[
                 Style[
                  Column[{
                    Row[{
                    Style["x", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`eq1$$, 1], {4, 2}], " ppm"}], 
                    Row[{
                    Style["y", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`eq1$$, 2], {3, 0}], " ppm"}]}, 
                   Alignment -> "="], 17, $CellContext`colEQ$, Background -> 
                  White], $CellContext`eq1$$, {-1, -1.3}], 
                Text[
                 Style[
                  Column[{
                    Row[{
                    Style["x", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`eq2$$, 1], {4, 2}], " ppm"}], 
                    Row[{
                    Style["y", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`eq2$$, 2], {3, 0}], " ppm"}]}, 
                   Alignment -> "="], 17, $CellContext`colEQ$, Background -> 
                  White], $CellContext`eq2$$, {1, 1.5}]}], 
              If[$CellContext`solution$$, {$CellContext`colEQ$, 
                Line[
                 Map[{#, 
                   $CellContext`yeq$[#]}& , 
                  Range[0, $CellContext`xp1$, 0.01]]]}]}], 
            If[$CellContext`NPR$$ > 3, {{$CellContext`colEQ$, 
               Line[
                Map[{#, 
                  $CellContext`yeq$[#]}& , 
                 Range[0, $CellContext`xp1$, 0.01]]]}, 
              $CellContext`pt2$[{$CellContext`xN$, 
                $CellContext`yeq$[$CellContext`xN$]}, Black], 
              Text[
               Style[
                Row[{"(", 
                  Style[
                   Subscript["x", "N"], $CellContext`colL$, Italic], ", ", 
                  Style[
                   Subscript["y", "N"], $CellContext`colV$, Italic], ")"}], 
                17, Background -> White], {$CellContext`xN$, 
                $CellContext`yeq$[$CellContext`xN$]}, {-1.25, 0.5}], 
              $CellContext`pt2$[{$CellContext`x0$, $CellContext`y1$}, Black], 
              Text[
               Style[
                Row[{"(", 
                  Style[
                   Subscript[
                    Style["x", Italic], 0], $CellContext`colL$], ", ", 
                  Style[
                   Subscript[
                    Style["y", Italic], 1], $CellContext`colV$], ")"}], 17, 
                Background -> 
                White], {$CellContext`x0$, $CellContext`y1$}, {-0.5, -3.5}]}], 
            If[$CellContext`NPR$$ == 4, {{Dashed, 
               Line[{{
                  Part[$CellContext`step1$$, 1], 
                  $CellContext`yeq$[
                   Part[$CellContext`step1$$, 1]]}, {
                  Part[$CellContext`step1$$, 1], 
                  $CellContext`yN1$[
                   Part[$CellContext`step1$$, 1]]}}]}, 
              $CellContext`pt3$[$CellContext`step1$$, Black], 
              If[$CellContext`solution$$, 
               Line[{{
                  $CellContext`X$[0], $CellContext`yn1$}, {
                  $CellContext`X$[0], 
                  $CellContext`Y$[0]}, {
                  $CellContext`X$[1], 
                  $CellContext`Y$[0]}}]]}], 
            If[$CellContext`NPR$$ > 4, 
             Line[{{
                $CellContext`X$[0], $CellContext`yn1$}, {
                $CellContext`X$[0], 
                $CellContext`Y$[0]}, {
                $CellContext`X$[1], 
                $CellContext`Y$[0]}}]], 
            If[$CellContext`NPR$$ == 5, {{Dashed, 
               Line[{{
                  Part[$CellContext`step2$$, 1], 
                  $CellContext`yeq$[
                   Part[$CellContext`step2$$, 1]]}, {
                  Part[$CellContext`step2$$, 1], 
                  $CellContext`yN1$[
                   Part[$CellContext`step2$$, 1]]}}]}, 
              $CellContext`pt3$[$CellContext`step2$$, Black], 
              If[$CellContext`solution$$, 
               Line[{{
                  $CellContext`X$[1], 
                  $CellContext`Y$[0]}, {
                  $CellContext`X$[1], 
                  $CellContext`Y$[1]}, {
                  $CellContext`X$[2], 
                  $CellContext`Y$[1]}}]]}], 
            If[$CellContext`NPR$$ == 6, {{Dashed, 
               Line[{{
                  Part[$CellContext`step3$$, 1], 
                  $CellContext`yeq$[
                   Part[$CellContext`step3$$, 1]]}, {
                  Part[$CellContext`step3$$, 1], 
                  $CellContext`yN1$[
                   Part[$CellContext`step3$$, 1]]}}]}, 
              $CellContext`pt3$[$CellContext`step3$$, Black], 
              Map[Line[{{
                  $CellContext`X$[#], 
                  $CellContext`Y$[#]}, {
                  $CellContext`X$[# + 1], 
                  $CellContext`Y$[#]}}]& , 
               Range[0, $CellContext`n$ - 2]], 
              Map[Line[{{
                  $CellContext`X$[# + 1], 
                  $CellContext`Y$[#]}, {
                  $CellContext`X$[# + 1], 
                  $CellContext`Y$[# + 1]}}]& , 
               Range[0, $CellContext`n$ - 3]], 
              If[$CellContext`solution$$, 
               (Line[{{
                  $CellContext`X$[# + 1], 
                  $CellContext`Y$[#]}, {
                  $CellContext`X$[# + 1], 
                  $CellContext`Y$[# + 1]}, {
                  $CellContext`X$[# + 2], 
                  $CellContext`Y$[# + 1]}}]& )[$CellContext`n$ - 2]]}], 
            If[$CellContext`NPR$$ == 7, {
              Map[Line[{{
                  $CellContext`X$[# - 1], 
                  $CellContext`Y$[# - 1]}, {
                  $CellContext`X$[#], 
                  $CellContext`Y$[# - 1]}, {
                  $CellContext`X$[#], 
                  $CellContext`Y$[#]}}]& , 
               Range[$CellContext`n$]]}]}, 
           PlotRange -> {{0, $CellContext`xp1$}, {0, 1.1 $CellContext`yn1$}}, 
           PlotRangeClipping -> If[$CellContext`NPR$$ == 2, True, False], 
           Frame -> True, FrameLabel -> {
             Row[{"solute/(solute-free liquid) ", 
               Style["x", Italic], " (ppm)"}], 
             Row[{"solute/(solute-free gas) ", 
               Style["y", Italic], " (ppm)"}]}, LabelStyle -> {17, Black}, 
           ImageSize -> {
             If[
              And[$CellContext`graphic$$, $CellContext`NPR$$ < 8], 350, 600], 
             390}, AspectRatio -> Full, GridLines -> 
           If[$CellContext`NPR$$ == 7, None, {
              Range[0, $CellContext`xp1$, 0.05], 
              Range[0, 1.1 $CellContext`yn1$, 5]}], GridLinesStyle -> 
           GrayLevel[0.8], ImagePadding -> {{55, 10}, {50, 
              If[$CellContext`graphic$$, 5, 
               If[
                And[
                3 <= $CellContext`NPR$$ <= 6, $CellContext`hint$$ == False], 
                5, 27]]}}, PlotLabel -> If[$CellContext`graphic$$, None, 
             Style[$CellContext`plotlabel$, 17]]]; 
        If[$CellContext`NPR$$ == 1, $CellContext`column$, 
          If[$CellContext`graphic$$, 
           
           Grid[{{$CellContext`diagram$, $CellContext`column$}}], \
$CellContext`diagram$]]], 
      "Specifications" :> {{{$CellContext`reset$$, 3}, 1, 1000, 1, 
         ControlType -> None, ControlPlacement -> 
         1}, {{$CellContext`NPR$$, 2, ""}, {1, 2, 3, 4, 5, 6, 7}, ControlType -> 
         None, ControlPlacement -> 
         2}, {{$CellContext`solution$$, False, "solution"}, {True, False}, 
         Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         3}, {{$CellContext`hint$$, False, "hint"}, {True, False}, 
         ControlPlacement -> 4}, {{$CellContext`graphic$$, False, "column"}, {
         True, False}, ControlPlacement -> 
         5}, {{$CellContext`op1$$, {0.2, 80}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         6}, {{$CellContext`op2$$, {1.15, 80}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         7}, {{$CellContext`eq1$$, {0.2, 80}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         8}, {{$CellContext`eq2$$, {1.15, 80}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         9}, {{$CellContext`step1$$, {0.8, 60}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         10}, {{$CellContext`step2$$, {0.5, 40}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         11}, {{$CellContext`step3$$, {0.2, 20}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 12}, 
        Grid[{{
           Button[" new problem ", {
             
             If[$CellContext`reset$$ < 
              1000, $CellContext`reset$$ = $CellContext`reset$$ + 
               1, $CellContext`reset$$ = $CellContext`reset$$ - 
               1], $CellContext`NPR$$ = 1, $CellContext`solution$$ = 
             False, $CellContext`hint$$ = 
             False, $CellContext`op1$$ = {0.2, 80}, $CellContext`op2$$ = {
              1.15, 80}, $CellContext`eq1$$ = {
              0.2, 80}, $CellContext`eq2$$ = {
              1.15, 80}, $CellContext`step1$$ = {
              0.8, 60}, $CellContext`step2$$ = {
              0.5, 40}, $CellContext`step3$$ = {0.2, 20}}], 
           Manipulate`Place[1], 
           
           PaneSelector[{
            1 -> "(1) gas flow rate", 2 -> "(2) draw operating line", 3 -> 
             "(3) draw equilibrium line", 4 -> "(4) draw stage 1", 5 -> 
             "(5) draw stage 2", 6 -> "(6) draw last stage", 7 -> 
             "(7) solution"}, 
            Dynamic[$CellContext`NPR$$]], 
           PaneSelector[{1 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 2 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 3 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 4 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 5 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 5 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 6 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}]}, 
            Dynamic[$CellContext`NPR$$]], 
           Manipulate`Place[2], 
           
           PaneSelector[{
            1 -> Manipulate`Place[3], 2 -> Manipulate`Place[3], 3 -> 
             Manipulate`Place[3], 4 -> Manipulate`Place[3], 5 -> 
             Manipulate`Place[3], 6 -> Manipulate`Place[3]}, 
            Dynamic[$CellContext`NPR$$]], 
           
           PaneSelector[{
            1 -> Manipulate`Place[4], 2 -> Manipulate`Place[4], 3 -> 
             Manipulate`Place[4], 4 -> Manipulate`Place[4], 5 -> 
             Manipulate`Place[4], 6 -> Manipulate`Place[4]}, 
            Dynamic[$CellContext`NPR$$]], 
           
           PaneSelector[{
            2 -> Manipulate`Place[5], 3 -> Manipulate`Place[5], 4 -> 
             Manipulate`Place[5], 5 -> Manipulate`Place[5], 6 -> 
             Manipulate`Place[5]}, 
            Dynamic[$CellContext`NPR$$]], 
           PaneSelector[{2 -> Row[{
                Manipulate`Place[6], 
                Manipulate`Place[7]}], 3 -> Row[{
                Manipulate`Place[8], 
                Manipulate`Place[9]}], 4 -> Manipulate`Place[10], 5 -> 
             Manipulate`Place[11], 6 -> Manipulate`Place[12]}, 
            Dynamic[$CellContext`NPR$$]]}}], {{$CellContext`gas$$, 1.2, 
          "select correct gas molar flow rate (Mmol/h)"}, 0.5, 1.5, 0.1, 
         Appearance -> "Labeled", ControlPlacement -> 13}, 
        PaneSelector[{1 -> Manipulate`Place[13]}, 
         Dynamic[$CellContext`NPR$$]]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->982163691,ExpressionUUID->"309911bc-0299-451c-826d-06f937ddaf21"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`eq1$$ = {0.2, 80}, $CellContext`eq2$$ = {
    1.15, 80}, $CellContext`gas$$ = 1.2, $CellContext`graphic$$ = 
    False, $CellContext`hint$$ = False, $CellContext`NPR$$ = 
    4, $CellContext`op1$$ = {0.2, 80}, $CellContext`op2$$ = {
    1.15, 80}, $CellContext`reset$$ = 3, $CellContext`solution$$ = 
    True, $CellContext`step1$$ = {1.068, 
    82.80000000000001}, $CellContext`step2$$ = {
    0.5, 40}, $CellContext`step3$$ = {0.2, 20}, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`reset$$], 3}, 1, 1000, 1}, {{
       Hold[$CellContext`NPR$$], 4, ""}, {1, 2, 3, 4, 5, 6, 7}}, {{
       Hold[$CellContext`solution$$], True, "solution"}, {True, False}}, {{
       Hold[$CellContext`hint$$], False, "hint"}, {True, False}}, {{
       Hold[$CellContext`graphic$$], False, "column"}, {True, False}}, {{
       Hold[$CellContext`op1$$], {0.2, 80}}, Automatic}, {{
       Hold[$CellContext`op2$$], {1.15, 80}}, Automatic}, {{
       Hold[$CellContext`eq1$$], {0.2, 80}}, Automatic}, {{
       Hold[$CellContext`eq2$$], {1.15, 80}}, Automatic}, {{
       Hold[$CellContext`step1$$], {1.068, 82.80000000000001}}, Automatic}, {{
       Hold[$CellContext`step2$$], {0.5, 40}}, Automatic}, {{
       Hold[$CellContext`step3$$], {0.2, 20}}, Automatic}, {
      Hold[
       Grid[{{
          Button[" new problem ", {
            
            If[$CellContext`reset$$ < 
             1000, $CellContext`reset$$ = $CellContext`reset$$ + 
              1, $CellContext`reset$$ = $CellContext`reset$$ - 
              1], $CellContext`NPR$$ = 1, $CellContext`solution$$ = 
            False, $CellContext`hint$$ = 
            False, $CellContext`op1$$ = {0.2, 80}, $CellContext`op2$$ = {
             1.15, 80}, $CellContext`eq1$$ = {0.2, 80}, $CellContext`eq2$$ = {
             1.15, 80}, $CellContext`step1$$ = {
             0.8, 60}, $CellContext`step2$$ = {
             0.5, 40}, $CellContext`step3$$ = {0.2, 20}}], 
          Manipulate`Place[1], 
          
          PaneSelector[{
           1 -> "(1) gas flow rate", 2 -> "(2) draw operating line", 3 -> 
            "(3) draw equilibrium line", 4 -> "(4) draw stage 1", 5 -> 
            "(5) draw stage 2", 6 -> "(6) draw last stage", 7 -> 
            "(7) solution"}, 
           Dynamic[$CellContext`NPR$$]], 
          PaneSelector[{1 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 2 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 3 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 4 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 5 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 5 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 6 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}]}, 
           Dynamic[$CellContext`NPR$$]], 
          Manipulate`Place[2], 
          
          PaneSelector[{
           1 -> Manipulate`Place[3], 2 -> Manipulate`Place[3], 3 -> 
            Manipulate`Place[3], 4 -> Manipulate`Place[3], 5 -> 
            Manipulate`Place[3], 6 -> Manipulate`Place[3]}, 
           Dynamic[$CellContext`NPR$$]], 
          
          PaneSelector[{
           1 -> Manipulate`Place[4], 2 -> Manipulate`Place[4], 3 -> 
            Manipulate`Place[4], 4 -> Manipulate`Place[4], 5 -> 
            Manipulate`Place[4], 6 -> Manipulate`Place[4]}, 
           Dynamic[$CellContext`NPR$$]], 
          
          PaneSelector[{
           2 -> Manipulate`Place[5], 3 -> Manipulate`Place[5], 4 -> 
            Manipulate`Place[5], 5 -> Manipulate`Place[5], 6 -> 
            Manipulate`Place[5]}, 
           Dynamic[$CellContext`NPR$$]], 
          PaneSelector[{2 -> Row[{
               Manipulate`Place[6], 
               Manipulate`Place[7]}], 3 -> Row[{
               Manipulate`Place[8], 
               Manipulate`Place[9]}], 4 -> Manipulate`Place[10], 5 -> 
            Manipulate`Place[11], 6 -> Manipulate`Place[12]}, 
           Dynamic[$CellContext`NPR$$]]}}]], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`gas$$], 1.2, 
       "select correct gas molar flow rate (Mmol/h)"}, 0.5, 1.5, 0.1}, {
      Hold[
       PaneSelector[{1 -> Manipulate`Place[13]}, 
        Dynamic[$CellContext`NPR$$]]], Manipulate`Dump`ThisIsNotAControl}}, 
    Typeset`size$$ = Automatic, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`reset$71641$$ = 
    0, $CellContext`NPR$71642$$ = 0, $CellContext`solution$71643$$ = 
    False, $CellContext`hint$71644$$ = False, $CellContext`graphic$71645$$ = 
    False, $CellContext`gas$71646$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`eq1$$ = {0.2, 80}, $CellContext`eq2$$ = {
         1.15, 80}, $CellContext`gas$$ = 1.2, $CellContext`graphic$$ = 
        False, $CellContext`hint$$ = False, $CellContext`NPR$$ = 
        4, $CellContext`op1$$ = {0.2, 80}, $CellContext`op2$$ = {
         1.15, 80}, $CellContext`reset$$ = 3, $CellContext`solution$$ = 
        True, $CellContext`step1$$ = {1.068, 
         82.80000000000001}, $CellContext`step2$$ = {
         0.5, 40}, $CellContext`step3$$ = {0.2, 20}}, "ControllerVariables" :> {
        Hold[$CellContext`reset$$, $CellContext`reset$71641$$, 0], 
        Hold[$CellContext`NPR$$, $CellContext`NPR$71642$$, 0], 
        Hold[$CellContext`solution$$, $CellContext`solution$71643$$, False], 
        Hold[$CellContext`hint$$, $CellContext`hint$71644$$, False], 
        Hold[$CellContext`graphic$$, $CellContext`graphic$71645$$, False], 
        Hold[$CellContext`gas$$, $CellContext`gas$71646$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`colL$, $CellContext`colV$, $CellContext`colOP$, \
$CellContext`colEQ$, $CellContext`colS$, $CellContext`P$, $CellContext`T$, \
$CellContext`L0$, $CellContext`V0$, $CellContext`Ea$, $CellContext`R$, \
$CellContext`H0$, $CellContext`HB$, $CellContext`L$, $CellContext`V$, \
$CellContext`x0$, $CellContext`y1$, $CellContext`yn1$, $CellContext`yN1$, \
$CellContext`yeq$, $CellContext`xp1$, $CellContext`xp2$, \
$CellContext`intersect$, $CellContext`check1$, $CellContext`check2$, \
$CellContext`stage$, $CellContext`test$, $CellContext`n$, \
$CellContext`steps$, $CellContext`stepping$, $CellContext`xN$, \
$CellContext`X$, $CellContext`Y$, $CellContext`xeq$, $CellContext`xop$, \
$CellContext`plotlabel$, $CellContext`h$, $CellContext`w$, $CellContext`ry$, \
$CellContext`column$, $CellContext`opt$, $CellContext`pt1$, \
$CellContext`pt2$, $CellContext`pt3$, $CellContext`diagram$}, \
$CellContext`colL$ = Blue; $CellContext`colV$ = 
         RGBColor[0, 0.6, 0]; $CellContext`colOP$ = 
         Magenta; $CellContext`colEQ$ = 
         RGBColor[1, 0.4, 0]; $CellContext`colS$ = Purple; 
        SeedRandom[$CellContext`reset$$]; $CellContext`P$ = 
         RandomReal[{2.5, 3}]; $CellContext`T$ = 
         RandomInteger[{10, 25}]; $CellContext`L0$ = 
         RandomInteger[{115, 200}]; $CellContext`V0$ = 
         RandomInteger[{12, 15}]/10; $CellContext`Ea$ = 5000; $CellContext`R$ = 
         8.314; $CellContext`H0$ = ReplaceAll[$CellContext`Hi, 
           Part[
            Solve[
            211.19 == $CellContext`Hi 
              Exp[-(5000/($CellContext`R$ 298))], $CellContext`Hi], 
            1]]; $CellContext`HB$ = $CellContext`H0$ 
          Exp[-($CellContext`Ea$/($CellContext`R$ ($CellContext`T$ + 
              273)))]; $CellContext`L$ = 
         1000 $CellContext`L0$; $CellContext`V$ = 
         1000 $CellContext`V0$; $CellContext`x0$ = 0.05; $CellContext`y1$ = 
         10; $CellContext`yn1$ = 100; $CellContext`yN1$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := ($CellContext`L$/$CellContext`V$) ($CellContext`x$ - \
$CellContext`x0$) + $CellContext`y1$; $CellContext`yeq$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := ($CellContext`HB$/$CellContext`P$) $CellContext`x$; \
$CellContext`xp1$ = 1.35; $CellContext`xp2$ = ReplaceAll[$CellContext`x, 
           
           FindRoot[$CellContext`yN1$[$CellContext`x] == 
            1.1 $CellContext`yn1$, {$CellContext`x, 
             0}]]; $CellContext`intersect$ = ReplaceAll[$CellContext`x, 
           Quiet[
            Part[
             
             Solve[$CellContext`yN1$[$CellContext`x] == \
$CellContext`yeq$[$CellContext`x], $CellContext`x], 
             1]]]; $CellContext`check1$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yN1$[$CellContext`x] == $CellContext`yn1$, \
$CellContext`x], 1]]; $CellContext`check2$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yeq$[$CellContext`x] == \
$CellContext`yN1$[$CellContext`x], $CellContext`x], 1]]; $CellContext`xN$ = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yN1$[$CellContext`x] == $CellContext`yn1$, \
$CellContext`x], 1]]; $CellContext`X$[0] = $CellContext`xN$; $CellContext`Y$[
          0] = $CellContext`yeq$[$CellContext`xN$]; 
        Do[{$CellContext`X$[$CellContext`i] = ReplaceAll[$CellContext`x, 
             Quiet[
              Part[
               
               Solve[$CellContext`yN1$[$CellContext`x] == \
$CellContext`Y$[$CellContext`i - 1], $CellContext`x], 
               1]]], $CellContext`Y$[$CellContext`i] = $CellContext`yeq$[
             $CellContext`X$[$CellContext`i]]}, {$CellContext`i, 1, 
           50}]; $CellContext`n$ = 1 + Part[
            DeleteCases[
             Map[If[$CellContext`X$[#] < $CellContext`x0$, 0, #]& , 
              Range[10]], 0], -1]; $CellContext`xeq$[
           Pattern[$CellContext`y$, 
            Blank[]]] := ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`yeq$[$CellContext`x] == 
             Part[$CellContext`y$, 2], {$CellContext`x, 
              0}]]]; $CellContext`xop$[
           Pattern[$CellContext`y$, 
            Blank[]]] := ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`yN1$[$CellContext`x] == 
             Part[$CellContext`y$, 2], {$CellContext`x, 
              0}]]]; $CellContext`plotlabel$ = Switch[$CellContext`NPR$$, 2, 
           
           If[$CellContext`hint$$, "hint: use the mass balance from step 1", 
            
            "step 2: click and drag the points to create the operating line, \
then check solution"], 3, 
           If[$CellContext`hint$$, "hint: use Henry's law", 
            
            Column[{"step 3: click and drag circles to create the equilibrium \
line, then check solution", 
              Row[{
                Style["P", Italic], " = ", 
                NumberForm[$CellContext`P$, {3, 1}], " atm and ", 
                Style["H", Italic], " = ", 
                NumberForm[$CellContext`HB$, {4, 1}], 
                " atm/mole fraction"}]}]], 4, 
           
           If[$CellContext`hint$$, 
            "hint: start counting stages from the bottom of the column", 
            
            Column[{"step 4: drag the black circle to move the dashed line to \
draw the first stage,", "then check solution"}]], 5, 
           
           If[$CellContext`hint$$, 
            "hint: start drawing second stage where the first stage leaves \
off", 
            
            Column[{"step 5: drag the black circle to move the dashed line to \
draw the second", "stage, then check solution"}]], 6, 
           If[$CellContext`hint$$, 
            Row[{"hint: draw last stage until ", 
              Subscript[
               Style["x", Italic], 0], " is reached or surpassed"}], 
            
            Column[{"step 6: drag the black circle to move the dashed line to \
draw the last stage,", "then check solution"}]], 7, 
           Row[{"solved ", 
             Style["x", Italic], "-", 
             Style["y", Italic], " diagram"}]]; $CellContext`h$ = 
         13; $CellContext`w$ = 
         If[$CellContext`NPR$$ == 1, 6, 12]; $CellContext`ry$ = 
         2; $CellContext`column$ = Graphics[{Thick, 
            Map[
            Line[{{#, $CellContext`ry$}, {#, $CellContext`h$ - \
$CellContext`ry$}}]& , {0, $CellContext`w$}], 
            
            Circle[{$CellContext`w$/2, $CellContext`ry$}, {$CellContext`w$/
              2, $CellContext`ry$}, {Pi, 2 Pi}], 
            
            Circle[{$CellContext`w$/
              2, $CellContext`h$ - $CellContext`ry$}, {$CellContext`w$/
              2, $CellContext`ry$}, {0, Pi}], {
             Arrowheads[
              If[$CellContext`NPR$$ == 1, 0.065, 0.09]], $CellContext`colV$, 
             
             Arrow[{{-$CellContext`w$, (-$CellContext`h$)/4}, {
               0.25 $CellContext`w$, (-$CellContext`h$)/4}, {
               0.25 $CellContext`w$, $CellContext`ry$/10}}], 
             
             Arrow[{{0.25 $CellContext`w$, $CellContext`h$ - $CellContext`ry$/
                10}, {0.25 $CellContext`w$, $CellContext`h$ + $CellContext`h$/
                 4}, {-$CellContext`w$, $CellContext`h$ + $CellContext`h$/
                 4}}], $CellContext`colL$, 
             
             Arrow[{{0.75 $CellContext`w$, $CellContext`ry$/10}, {
               0.75 $CellContext`w$, (-$CellContext`h$)/4}, {
               2 $CellContext`w$, (-$CellContext`h$)/4}}], 
             
             Arrow[{{2 $CellContext`w$, $CellContext`h$ + $CellContext`h$/
                 4}, {0.75 $CellContext`w$, $CellContext`h$ + $CellContext`h$/
                 4}, {0.75 $CellContext`w$, $CellContext`h$ - \
$CellContext`ry$/10}}]}, 
            If[4 <= $CellContext`NPR$$, {Thick, 
              Map[
              Line[{{0, #}, {$CellContext`w$, #}}]& , {$CellContext`ry$, 
                0.5 $CellContext`h$, $CellContext`h$ - $CellContext`ry$}], 
              Apply[Text[
                Style[#, 17], {0.5 $CellContext`w$, #2}, {0, -1}]& , {{
                1, $CellContext`ry$}, {
                 Style["n", Italic], 0.5 $CellContext`h$}, {
                 Style["N", Italic], $CellContext`h$ - $CellContext`ry$}}, {
               1}]}, 
             Text[
              Style[
               Column[{
                 Row[{
                   NumberForm[$CellContext`P$, {3, 1}], " atm"}], 
                 Spacer[0], 
                 Row[{
                   NumberForm[$CellContext`T$, {4, 0}], " \[Degree]C"}]}, 
                Center], 
               If[$CellContext`NPR$$ == 1, 17, 16]], {
              0.5 $CellContext`w$, 0.5 $CellContext`h$}]], 
            Text[
             Style[
              If[$CellContext`NPR$$ > 1, 
               Row[{
                 Style["L", Italic], " = ", N[$CellContext`L$]/1000, 
                 " Mmol/h"}], 
               Column[{"liquid solvent feed", 
                 Row[{
                   Style["L", Italic], " = ", N[$CellContext`L$]/1000, 
                   " Mmol/h"}]}, Right]], 
              
              If[$CellContext`NPR$$ == 1, 17, 
               16], $CellContext`colL$], {$CellContext`w$, $CellContext`h$ + \
$CellContext`h$/4}, {-0.5, -1.2}], 
            Text[
             Style[
              If[$CellContext`NPR$$ > 1, 
               Row[{
                 Style["V", Italic], " = ", 
                 NumberForm[N[$CellContext`V$]/1000, {3, 1}], " Mmol/h"}], 
               Column[{"gas feed", 
                 Style[
                  Row[{
                    Style["V", Italic], " = ", $CellContext`gas$$, 
                    " Mmol/h"}], $CellContext`colS$], 
                 If[
                  And[$CellContext`NPR$$ == 1, $CellContext`solution$$], 
                  Row[{"correct ", 
                    Style["V", Italic], " = ", 
                    NumberForm[N[$CellContext`V$]/1000, {3, 1}], 
                    " Mmol/h"}]]}]], 
              If[$CellContext`NPR$$ == 1, 17, 16], $CellContext`colV$], {
             0, (-$CellContext`h$)/4}, {
              If[$CellContext`NPR$$ == 1, 
               If[$CellContext`solution$$, 0.35, 1], 0.5], 1.4}], 
            Apply[Text[
              Style[
               Row[{
                 Subscript[
                  Style["y", Italic], #2], " = ", #, " ppm"}], 
               If[$CellContext`NPR$$ == 1, 17, 16], $CellContext`colV$, 
               Background -> White], {0, #3}, {
               If[$CellContext`graphic$$, 0.5, 1], 0}]& , {{$CellContext`y1$, 
               1, $CellContext`h$ + 2}, {$CellContext`yn1$, 
               Row[{
                 Style["N", Italic], "+1"}], -2}}, {1}], 
            Apply[Text[
              Style[
               Row[{
                 Subscript[
                  Style["x", Italic], #2], " = ", #, " ppm"}], 
               If[$CellContext`NPR$$ == 1, 17, 16], $CellContext`colL$, 
               Background -> White], {$CellContext`w$, #3}, {
               If[$CellContext`graphic$$, -0.5, -1], 
               0}]& , {{$CellContext`x0$, 0, $CellContext`h$ + 2}, {
               NumberForm[$CellContext`xN$, 2], 
               Style["N", Italic], -2}}, {1}]}, ImageSize -> {
             If[$CellContext`NPR$$ == 1, 600, 250], 390}, 
           ImagePadding -> {{20, 20}, {65, 
              If[$CellContext`NPR$$ == 1, 50, 25]}}, AspectRatio -> 
           If[$CellContext`NPR$$ == 1, 0.75, Full], PlotLabel -> 
           If[$CellContext`NPR$$ == 1, 
             Style[
              
              If[$CellContext`hint$$, "hint: use mass balance on solute", 
               "step 1: calculate the gas flow rate, then check solution"], 
              17, Black], None]]; $CellContext`opt$ = Sequence[
           Thickness[
            If[
             And[$CellContext`graphic$$, $CellContext`NPR$$ < 4], 0.011, 
             0.008]], Dotted]; $CellContext`pt1$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`col$, 
            Blank[]]] := {$CellContext`col$, 
           PointSize[
            If[
             And[$CellContext`graphic$$, $CellContext`NPR$$ < 4], 0.04, 
             0.025]], 
           Point[$CellContext`pt$], White, 
           PointSize[
            If[
             And[$CellContext`graphic$$, $CellContext`NPR$$ < 4], 0.025, 
             0.015]], 
           Point[$CellContext`pt$]}; $CellContext`pt2$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`col$, 
            Blank[]]] := {$CellContext`col$, 
           PointSize[
            If[$CellContext`graphic$$, 0.035, 0.02]], 
           Point[$CellContext`pt$]}; $CellContext`pt3$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`col$, 
            Blank[]]] := {$CellContext`col$, 
           PointSize[
            If[$CellContext`graphic$$, 0.035, 0.02]], 
           Point[$CellContext`pt$], White, 
           PointSize[
            If[$CellContext`graphic$$, 0.02, 0.01]], 
           Point[$CellContext`pt$]}; If[
          
          And[$CellContext`n$ == 2, $CellContext`NPR$$ == 
           6], $CellContext`NPR$$ = 7]; $CellContext`diagram$ = 
         Graphics[{Thick, 
            If[$CellContext`NPR$$ == 2, {{
               Evaluate[$CellContext`opt$], $CellContext`colOP$, 
               Line[{$CellContext`op1$$, $CellContext`op2$$}]}, 
              $CellContext`pt1$[$CellContext`op1$$, $CellContext`colOP$], 
              $CellContext`pt1$[$CellContext`op2$$, $CellContext`colOP$], 
              If[$CellContext`solution$$ == False, {
                Text[
                 Style[
                  Column[{
                    Row[{
                    Style["x", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`op1$$, 1], {4, 2}], " ppm"}], 
                    Row[{
                    Style["y", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`op1$$, 2], {3, 0}], " ppm"}]}, 
                   Alignment -> "="], 17, $CellContext`colOP$, Background -> 
                  White], $CellContext`op1$$, {-1, -1.3}], 
                Text[
                 Style[
                  Column[{
                    Row[{
                    Style["x", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`op2$$, 1], {4, 2}], " ppm"}], 
                    Row[{
                    Style["y", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`op2$$, 2], {3, 0}], " ppm"}]}, 
                   Alignment -> "="], 17, $CellContext`colOP$, Background -> 
                  White], $CellContext`op2$$, {1, 1.5}]}], 
              If[$CellContext`solution$$, {$CellContext`colOP$, 
                Line[
                 Map[{#, 
                   $CellContext`yN1$[#]}& , 
                  Range[0, $CellContext`xp2$, 0.01]]]}]}], 
            If[$CellContext`NPR$$ > 2, {$CellContext`colOP$, 
              Line[
               Map[{#, 
                 $CellContext`yN1$[#]}& , 
                Range[0, $CellContext`xp2$, 0.01]]]}], 
            If[$CellContext`NPR$$ == 3, {{
               Evaluate[$CellContext`opt$], $CellContext`colEQ$, 
               Line[{$CellContext`eq1$$, $CellContext`eq2$$}]}, 
              $CellContext`pt1$[$CellContext`eq1$$, $CellContext`colEQ$], 
              $CellContext`pt1$[$CellContext`eq2$$, $CellContext`colEQ$], 
              If[$CellContext`solution$$ == False, {
                Text[
                 Style[
                  Column[{
                    Row[{
                    Style["x", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`eq1$$, 1], {4, 2}], " ppm"}], 
                    Row[{
                    Style["y", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`eq1$$, 2], {3, 0}], " ppm"}]}, 
                   Alignment -> "="], 17, $CellContext`colEQ$, Background -> 
                  White], $CellContext`eq1$$, {-1, -1.3}], 
                Text[
                 Style[
                  Column[{
                    Row[{
                    Style["x", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`eq2$$, 1], {4, 2}], " ppm"}], 
                    Row[{
                    Style["y", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`eq2$$, 2], {3, 0}], " ppm"}]}, 
                   Alignment -> "="], 17, $CellContext`colEQ$, Background -> 
                  White], $CellContext`eq2$$, {1, 1.5}]}], 
              If[$CellContext`solution$$, {$CellContext`colEQ$, 
                Line[
                 Map[{#, 
                   $CellContext`yeq$[#]}& , 
                  Range[0, $CellContext`xp1$, 0.01]]]}]}], 
            If[$CellContext`NPR$$ > 3, {{$CellContext`colEQ$, 
               Line[
                Map[{#, 
                  $CellContext`yeq$[#]}& , 
                 Range[0, $CellContext`xp1$, 0.01]]]}, 
              $CellContext`pt2$[{$CellContext`xN$, 
                $CellContext`yeq$[$CellContext`xN$]}, Black], 
              Text[
               Style[
                Row[{"(", 
                  Style[
                   Subscript["x", "N"], $CellContext`colL$, Italic], ", ", 
                  Style[
                   Subscript["y", "N"], $CellContext`colV$, Italic], ")"}], 
                17, Background -> White], {$CellContext`xN$, 
                $CellContext`yeq$[$CellContext`xN$]}, {-1.25, 0.5}], 
              $CellContext`pt2$[{$CellContext`x0$, $CellContext`y1$}, Black], 
              Text[
               Style[
                Row[{"(", 
                  Style[
                   Subscript[
                    Style["x", Italic], 0], $CellContext`colL$], ", ", 
                  Style[
                   Subscript[
                    Style["y", Italic], 1], $CellContext`colV$], ")"}], 17, 
                Background -> 
                White], {$CellContext`x0$, $CellContext`y1$}, {-0.5, -3.5}]}], 
            If[$CellContext`NPR$$ == 4, {{Dashed, 
               Line[{{
                  Part[$CellContext`step1$$, 1], 
                  $CellContext`yeq$[
                   Part[$CellContext`step1$$, 1]]}, {
                  Part[$CellContext`step1$$, 1], 
                  $CellContext`yN1$[
                   Part[$CellContext`step1$$, 1]]}}]}, 
              $CellContext`pt3$[$CellContext`step1$$, Black], 
              If[$CellContext`solution$$, 
               Line[{{
                  $CellContext`X$[0], $CellContext`yn1$}, {
                  $CellContext`X$[0], 
                  $CellContext`Y$[0]}, {
                  $CellContext`X$[1], 
                  $CellContext`Y$[0]}}]]}], 
            If[$CellContext`NPR$$ > 4, 
             Line[{{
                $CellContext`X$[0], $CellContext`yn1$}, {
                $CellContext`X$[0], 
                $CellContext`Y$[0]}, {
                $CellContext`X$[1], 
                $CellContext`Y$[0]}}]], 
            If[$CellContext`NPR$$ == 5, {{Dashed, 
               Line[{{
                  Part[$CellContext`step2$$, 1], 
                  $CellContext`yeq$[
                   Part[$CellContext`step2$$, 1]]}, {
                  Part[$CellContext`step2$$, 1], 
                  $CellContext`yN1$[
                   Part[$CellContext`step2$$, 1]]}}]}, 
              $CellContext`pt3$[$CellContext`step2$$, Black], 
              If[$CellContext`solution$$, 
               Line[{{
                  $CellContext`X$[1], 
                  $CellContext`Y$[0]}, {
                  $CellContext`X$[1], 
                  $CellContext`Y$[1]}, {
                  $CellContext`X$[2], 
                  $CellContext`Y$[1]}}]]}], 
            If[$CellContext`NPR$$ == 6, {{Dashed, 
               Line[{{
                  Part[$CellContext`step3$$, 1], 
                  $CellContext`yeq$[
                   Part[$CellContext`step3$$, 1]]}, {
                  Part[$CellContext`step3$$, 1], 
                  $CellContext`yN1$[
                   Part[$CellContext`step3$$, 1]]}}]}, 
              $CellContext`pt3$[$CellContext`step3$$, Black], 
              Map[Line[{{
                  $CellContext`X$[#], 
                  $CellContext`Y$[#]}, {
                  $CellContext`X$[# + 1], 
                  $CellContext`Y$[#]}}]& , 
               Range[0, $CellContext`n$ - 2]], 
              Map[Line[{{
                  $CellContext`X$[# + 1], 
                  $CellContext`Y$[#]}, {
                  $CellContext`X$[# + 1], 
                  $CellContext`Y$[# + 1]}}]& , 
               Range[0, $CellContext`n$ - 3]], 
              If[$CellContext`solution$$, 
               (Line[{{
                  $CellContext`X$[# + 1], 
                  $CellContext`Y$[#]}, {
                  $CellContext`X$[# + 1], 
                  $CellContext`Y$[# + 1]}, {
                  $CellContext`X$[# + 2], 
                  $CellContext`Y$[# + 1]}}]& )[$CellContext`n$ - 2]]}], 
            If[$CellContext`NPR$$ == 7, {
              Map[Line[{{
                  $CellContext`X$[# - 1], 
                  $CellContext`Y$[# - 1]}, {
                  $CellContext`X$[#], 
                  $CellContext`Y$[# - 1]}, {
                  $CellContext`X$[#], 
                  $CellContext`Y$[#]}}]& , 
               Range[$CellContext`n$]]}]}, 
           PlotRange -> {{0, $CellContext`xp1$}, {0, 1.1 $CellContext`yn1$}}, 
           PlotRangeClipping -> If[$CellContext`NPR$$ == 2, True, False], 
           Frame -> True, FrameLabel -> {
             Row[{"solute/(solute-free liquid) ", 
               Style["x", Italic], " (ppm)"}], 
             Row[{"solute/(solute-free gas) ", 
               Style["y", Italic], " (ppm)"}]}, LabelStyle -> {17, Black}, 
           ImageSize -> {
             If[
              And[$CellContext`graphic$$, $CellContext`NPR$$ < 8], 350, 600], 
             390}, AspectRatio -> Full, GridLines -> 
           If[$CellContext`NPR$$ == 7, None, {
              Range[0, $CellContext`xp1$, 0.05], 
              Range[0, 1.1 $CellContext`yn1$, 5]}], GridLinesStyle -> 
           GrayLevel[0.8], ImagePadding -> {{55, 10}, {50, 
              If[$CellContext`graphic$$, 5, 
               If[
                And[
                3 <= $CellContext`NPR$$ <= 6, $CellContext`hint$$ == False], 
                5, 27]]}}, PlotLabel -> If[$CellContext`graphic$$, None, 
             Style[$CellContext`plotlabel$, 17]]]; 
        If[$CellContext`NPR$$ == 1, $CellContext`column$, 
          If[$CellContext`graphic$$, 
           
           Grid[{{$CellContext`diagram$, $CellContext`column$}}], \
$CellContext`diagram$]]], 
      "Specifications" :> {{{$CellContext`reset$$, 3}, 1, 1000, 1, 
         ControlType -> None, ControlPlacement -> 
         1}, {{$CellContext`NPR$$, 4, ""}, {1, 2, 3, 4, 5, 6, 7}, ControlType -> 
         None, ControlPlacement -> 
         2}, {{$CellContext`solution$$, True, "solution"}, {True, False}, 
         Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         3}, {{$CellContext`hint$$, False, "hint"}, {True, False}, 
         ControlPlacement -> 4}, {{$CellContext`graphic$$, False, "column"}, {
         True, False}, ControlPlacement -> 
         5}, {{$CellContext`op1$$, {0.2, 80}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         6}, {{$CellContext`op2$$, {1.15, 80}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         7}, {{$CellContext`eq1$$, {0.2, 80}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         8}, {{$CellContext`eq2$$, {1.15, 80}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         9}, {{$CellContext`step1$$, {1.068, 82.80000000000001}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         10}, {{$CellContext`step2$$, {0.5, 40}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         11}, {{$CellContext`step3$$, {0.2, 20}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 12}, 
        Grid[{{
           Button[" new problem ", {
             
             If[$CellContext`reset$$ < 
              1000, $CellContext`reset$$ = $CellContext`reset$$ + 
               1, $CellContext`reset$$ = $CellContext`reset$$ - 
               1], $CellContext`NPR$$ = 1, $CellContext`solution$$ = 
             False, $CellContext`hint$$ = 
             False, $CellContext`op1$$ = {0.2, 80}, $CellContext`op2$$ = {
              1.15, 80}, $CellContext`eq1$$ = {
              0.2, 80}, $CellContext`eq2$$ = {
              1.15, 80}, $CellContext`step1$$ = {
              0.8, 60}, $CellContext`step2$$ = {
              0.5, 40}, $CellContext`step3$$ = {0.2, 20}}], 
           Manipulate`Place[1], 
           
           PaneSelector[{
            1 -> "(1) gas flow rate", 2 -> "(2) draw operating line", 3 -> 
             "(3) draw equilibrium line", 4 -> "(4) draw stage 1", 5 -> 
             "(5) draw stage 2", 6 -> "(6) draw last stage", 7 -> 
             "(7) solution"}, 
            Dynamic[$CellContext`NPR$$]], 
           PaneSelector[{1 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 2 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 3 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 4 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 5 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 5 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 6 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}]}, 
            Dynamic[$CellContext`NPR$$]], 
           Manipulate`Place[2], 
           
           PaneSelector[{
            1 -> Manipulate`Place[3], 2 -> Manipulate`Place[3], 3 -> 
             Manipulate`Place[3], 4 -> Manipulate`Place[3], 5 -> 
             Manipulate`Place[3], 6 -> Manipulate`Place[3]}, 
            Dynamic[$CellContext`NPR$$]], 
           
           PaneSelector[{
            1 -> Manipulate`Place[4], 2 -> Manipulate`Place[4], 3 -> 
             Manipulate`Place[4], 4 -> Manipulate`Place[4], 5 -> 
             Manipulate`Place[4], 6 -> Manipulate`Place[4]}, 
            Dynamic[$CellContext`NPR$$]], 
           
           PaneSelector[{
            2 -> Manipulate`Place[5], 3 -> Manipulate`Place[5], 4 -> 
             Manipulate`Place[5], 5 -> Manipulate`Place[5], 6 -> 
             Manipulate`Place[5]}, 
            Dynamic[$CellContext`NPR$$]], 
           PaneSelector[{2 -> Row[{
                Manipulate`Place[6], 
                Manipulate`Place[7]}], 3 -> Row[{
                Manipulate`Place[8], 
                Manipulate`Place[9]}], 4 -> Manipulate`Place[10], 5 -> 
             Manipulate`Place[11], 6 -> Manipulate`Place[12]}, 
            Dynamic[$CellContext`NPR$$]]}}], {{$CellContext`gas$$, 1.2, 
          "select correct gas molar flow rate (Mmol/h)"}, 0.5, 1.5, 0.1, 
         Appearance -> "Labeled", ControlPlacement -> 13}, 
        PaneSelector[{1 -> Manipulate`Place[13]}, 
         Dynamic[$CellContext`NPR$$]]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->13481158,ExpressionUUID->"8cec2289-3b81-4356-88b3-fcb0b5cf4fca"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`eq1$$ = {0.2, 80}, $CellContext`eq2$$ = {
    1.15, 80}, $CellContext`gas$$ = 1.2, $CellContext`graphic$$ = 
    False, $CellContext`hint$$ = False, $CellContext`NPR$$ = 
    7, $CellContext`op1$$ = {0.2, 80}, $CellContext`op2$$ = {1.35, 
    91.2}, $CellContext`reset$$ = 3, $CellContext`solution$$ = 
    False, $CellContext`step1$$ = {1.068, 
    82.80000000000001}, $CellContext`step2$$ = {
    0.5, 40}, $CellContext`step3$$ = {0.2, 20}, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`reset$$], 3}, 1, 1000, 1}, {{
       Hold[$CellContext`NPR$$], 7, ""}, {1, 2, 3, 4, 5, 6, 7}}, {{
       Hold[$CellContext`solution$$], False, "solution"}, {True, False}}, {{
       Hold[$CellContext`hint$$], False, "hint"}, {True, False}}, {{
       Hold[$CellContext`graphic$$], False, "column"}, {True, False}}, {{
       Hold[$CellContext`op1$$], {0.2, 80}}, Automatic}, {{
       Hold[$CellContext`op2$$], {1.35, 91.2}}, Automatic}, {{
       Hold[$CellContext`eq1$$], {0.2, 80}}, Automatic}, {{
       Hold[$CellContext`eq2$$], {1.15, 80}}, Automatic}, {{
       Hold[$CellContext`step1$$], {1.068, 82.80000000000001}}, Automatic}, {{
       Hold[$CellContext`step2$$], {0.5, 40}}, Automatic}, {{
       Hold[$CellContext`step3$$], {0.2, 20}}, Automatic}, {
      Hold[
       Grid[{{
          Button[" new problem ", {
            
            If[$CellContext`reset$$ < 
             1000, $CellContext`reset$$ = $CellContext`reset$$ + 
              1, $CellContext`reset$$ = $CellContext`reset$$ - 
              1], $CellContext`NPR$$ = 1, $CellContext`solution$$ = 
            False, $CellContext`hint$$ = 
            False, $CellContext`op1$$ = {0.2, 80}, $CellContext`op2$$ = {
             1.15, 80}, $CellContext`eq1$$ = {0.2, 80}, $CellContext`eq2$$ = {
             1.15, 80}, $CellContext`step1$$ = {
             0.8, 60}, $CellContext`step2$$ = {
             0.5, 40}, $CellContext`step3$$ = {0.2, 20}}], 
          Manipulate`Place[1], 
          
          PaneSelector[{
           1 -> "(1) gas flow rate", 2 -> "(2) draw operating line", 3 -> 
            "(3) draw equilibrium line", 4 -> "(4) draw stage 1", 5 -> 
            "(5) draw stage 2", 6 -> "(6) draw last stage", 7 -> 
            "(7) solution"}, 
           Dynamic[$CellContext`NPR$$]], 
          PaneSelector[{1 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 2 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 3 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 4 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 5 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 5 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}], 6 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
               False}]}, 
           Dynamic[$CellContext`NPR$$]], 
          Manipulate`Place[2], 
          
          PaneSelector[{
           1 -> Manipulate`Place[3], 2 -> Manipulate`Place[3], 3 -> 
            Manipulate`Place[3], 4 -> Manipulate`Place[3], 5 -> 
            Manipulate`Place[3], 6 -> Manipulate`Place[3]}, 
           Dynamic[$CellContext`NPR$$]], 
          
          PaneSelector[{
           1 -> Manipulate`Place[4], 2 -> Manipulate`Place[4], 3 -> 
            Manipulate`Place[4], 4 -> Manipulate`Place[4], 5 -> 
            Manipulate`Place[4], 6 -> Manipulate`Place[4]}, 
           Dynamic[$CellContext`NPR$$]], 
          
          PaneSelector[{
           2 -> Manipulate`Place[5], 3 -> Manipulate`Place[5], 4 -> 
            Manipulate`Place[5], 5 -> Manipulate`Place[5], 6 -> 
            Manipulate`Place[5]}, 
           Dynamic[$CellContext`NPR$$]], 
          PaneSelector[{2 -> Row[{
               Manipulate`Place[6], 
               Manipulate`Place[7]}], 3 -> Row[{
               Manipulate`Place[8], 
               Manipulate`Place[9]}], 4 -> Manipulate`Place[10], 5 -> 
            Manipulate`Place[11], 6 -> Manipulate`Place[12]}, 
           Dynamic[$CellContext`NPR$$]]}}]], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`gas$$], 1.2, 
       "select correct gas molar flow rate (Mmol/h)"}, 0.5, 1.5, 0.1}, {
      Hold[
       PaneSelector[{1 -> Manipulate`Place[13]}, 
        Dynamic[$CellContext`NPR$$]]], Manipulate`Dump`ThisIsNotAControl}}, 
    Typeset`size$$ = Automatic, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`reset$71745$$ = 
    0, $CellContext`NPR$71746$$ = 0, $CellContext`solution$71747$$ = 
    False, $CellContext`hint$71748$$ = False, $CellContext`graphic$71749$$ = 
    False, $CellContext`gas$71750$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`eq1$$ = {0.2, 80}, $CellContext`eq2$$ = {
         1.15, 80}, $CellContext`gas$$ = 1.2, $CellContext`graphic$$ = 
        False, $CellContext`hint$$ = False, $CellContext`NPR$$ = 
        7, $CellContext`op1$$ = {0.2, 80}, $CellContext`op2$$ = {1.35, 
         91.2}, $CellContext`reset$$ = 3, $CellContext`solution$$ = 
        False, $CellContext`step1$$ = {1.068, 
         82.80000000000001}, $CellContext`step2$$ = {
         0.5, 40}, $CellContext`step3$$ = {0.2, 20}}, "ControllerVariables" :> {
        Hold[$CellContext`reset$$, $CellContext`reset$71745$$, 0], 
        Hold[$CellContext`NPR$$, $CellContext`NPR$71746$$, 0], 
        Hold[$CellContext`solution$$, $CellContext`solution$71747$$, False], 
        Hold[$CellContext`hint$$, $CellContext`hint$71748$$, False], 
        Hold[$CellContext`graphic$$, $CellContext`graphic$71749$$, False], 
        Hold[$CellContext`gas$$, $CellContext`gas$71750$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`colL$, $CellContext`colV$, $CellContext`colOP$, \
$CellContext`colEQ$, $CellContext`colS$, $CellContext`P$, $CellContext`T$, \
$CellContext`L0$, $CellContext`V0$, $CellContext`Ea$, $CellContext`R$, \
$CellContext`H0$, $CellContext`HB$, $CellContext`L$, $CellContext`V$, \
$CellContext`x0$, $CellContext`y1$, $CellContext`yn1$, $CellContext`yN1$, \
$CellContext`yeq$, $CellContext`xp1$, $CellContext`xp2$, \
$CellContext`intersect$, $CellContext`check1$, $CellContext`check2$, \
$CellContext`stage$, $CellContext`test$, $CellContext`n$, \
$CellContext`steps$, $CellContext`stepping$, $CellContext`xN$, \
$CellContext`X$, $CellContext`Y$, $CellContext`xeq$, $CellContext`xop$, \
$CellContext`plotlabel$, $CellContext`h$, $CellContext`w$, $CellContext`ry$, \
$CellContext`column$, $CellContext`opt$, $CellContext`pt1$, \
$CellContext`pt2$, $CellContext`pt3$, $CellContext`diagram$}, \
$CellContext`colL$ = Blue; $CellContext`colV$ = 
         RGBColor[0, 0.6, 0]; $CellContext`colOP$ = 
         Magenta; $CellContext`colEQ$ = 
         RGBColor[1, 0.4, 0]; $CellContext`colS$ = Purple; 
        SeedRandom[$CellContext`reset$$]; $CellContext`P$ = 
         RandomReal[{2.5, 3}]; $CellContext`T$ = 
         RandomInteger[{10, 25}]; $CellContext`L0$ = 
         RandomInteger[{115, 200}]; $CellContext`V0$ = 
         RandomInteger[{12, 15}]/10; $CellContext`Ea$ = 5000; $CellContext`R$ = 
         8.314; $CellContext`H0$ = ReplaceAll[$CellContext`Hi, 
           Part[
            Solve[
            211.19 == $CellContext`Hi 
              Exp[-(5000/($CellContext`R$ 298))], $CellContext`Hi], 
            1]]; $CellContext`HB$ = $CellContext`H0$ 
          Exp[-($CellContext`Ea$/($CellContext`R$ ($CellContext`T$ + 
              273)))]; $CellContext`L$ = 
         1000 $CellContext`L0$; $CellContext`V$ = 
         1000 $CellContext`V0$; $CellContext`x0$ = 0.05; $CellContext`y1$ = 
         10; $CellContext`yn1$ = 100; $CellContext`yN1$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := ($CellContext`L$/$CellContext`V$) ($CellContext`x$ - \
$CellContext`x0$) + $CellContext`y1$; $CellContext`yeq$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := ($CellContext`HB$/$CellContext`P$) $CellContext`x$; \
$CellContext`xp1$ = 1.35; $CellContext`xp2$ = ReplaceAll[$CellContext`x, 
           
           FindRoot[$CellContext`yN1$[$CellContext`x] == 
            1.1 $CellContext`yn1$, {$CellContext`x, 
             0}]]; $CellContext`intersect$ = ReplaceAll[$CellContext`x, 
           Quiet[
            Part[
             
             Solve[$CellContext`yN1$[$CellContext`x] == \
$CellContext`yeq$[$CellContext`x], $CellContext`x], 
             1]]]; $CellContext`check1$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yN1$[$CellContext`x] == $CellContext`yn1$, \
$CellContext`x], 1]]; $CellContext`check2$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yeq$[$CellContext`x] == \
$CellContext`yN1$[$CellContext`x], $CellContext`x], 1]]; $CellContext`xN$ = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yN1$[$CellContext`x] == $CellContext`yn1$, \
$CellContext`x], 1]]; $CellContext`X$[0] = $CellContext`xN$; $CellContext`Y$[
          0] = $CellContext`yeq$[$CellContext`xN$]; 
        Do[{$CellContext`X$[$CellContext`i] = ReplaceAll[$CellContext`x, 
             Quiet[
              Part[
               
               Solve[$CellContext`yN1$[$CellContext`x] == \
$CellContext`Y$[$CellContext`i - 1], $CellContext`x], 
               1]]], $CellContext`Y$[$CellContext`i] = $CellContext`yeq$[
             $CellContext`X$[$CellContext`i]]}, {$CellContext`i, 1, 
           50}]; $CellContext`n$ = 1 + Part[
            DeleteCases[
             Map[If[$CellContext`X$[#] < $CellContext`x0$, 0, #]& , 
              Range[10]], 0], -1]; $CellContext`xeq$[
           Pattern[$CellContext`y$, 
            Blank[]]] := ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`yeq$[$CellContext`x] == 
             Part[$CellContext`y$, 2], {$CellContext`x, 
              0}]]]; $CellContext`xop$[
           Pattern[$CellContext`y$, 
            Blank[]]] := ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`yN1$[$CellContext`x] == 
             Part[$CellContext`y$, 2], {$CellContext`x, 
              0}]]]; $CellContext`plotlabel$ = Switch[$CellContext`NPR$$, 2, 
           
           If[$CellContext`hint$$, "hint: use the mass balance from step 1", 
            
            "step 2: click and drag the points to create the operating line, \
then check solution"], 3, 
           If[$CellContext`hint$$, "hint: use Henry's law", 
            
            Column[{"step 3: click and drag circles to create the equilibrium \
line, then check solution", 
              Row[{
                Style["P", Italic], " = ", 
                NumberForm[$CellContext`P$, {3, 1}], " atm and ", 
                Style["H", Italic], " = ", 
                NumberForm[$CellContext`HB$, {4, 1}], 
                " atm/mole fraction"}]}]], 4, 
           
           If[$CellContext`hint$$, 
            "hint: start counting stages from the bottom of the column", 
            
            Column[{"step 4: drag the black circle to move the dashed line to \
draw the first stage,", "then check solution"}]], 5, 
           
           If[$CellContext`hint$$, 
            "hint: start drawing second stage where the first stage leaves \
off", 
            
            Column[{"step 5: drag the black circle to move the dashed line to \
draw the second", "stage, then check solution"}]], 6, 
           If[$CellContext`hint$$, 
            Row[{"hint: draw last stage until ", 
              Subscript[
               Style["x", Italic], 0], " is reached or surpassed"}], 
            
            Column[{"step 6: drag the black circle to move the dashed line to \
draw the last stage,", "then check solution"}]], 7, 
           Row[{"solved ", 
             Style["x", Italic], "-", 
             Style["y", Italic], " diagram"}]]; $CellContext`h$ = 
         13; $CellContext`w$ = 
         If[$CellContext`NPR$$ == 1, 6, 12]; $CellContext`ry$ = 
         2; $CellContext`column$ = Graphics[{Thick, 
            Map[
            Line[{{#, $CellContext`ry$}, {#, $CellContext`h$ - \
$CellContext`ry$}}]& , {0, $CellContext`w$}], 
            
            Circle[{$CellContext`w$/2, $CellContext`ry$}, {$CellContext`w$/
              2, $CellContext`ry$}, {Pi, 2 Pi}], 
            
            Circle[{$CellContext`w$/
              2, $CellContext`h$ - $CellContext`ry$}, {$CellContext`w$/
              2, $CellContext`ry$}, {0, Pi}], {
             Arrowheads[
              If[$CellContext`NPR$$ == 1, 0.065, 0.09]], $CellContext`colV$, 
             
             Arrow[{{-$CellContext`w$, (-$CellContext`h$)/4}, {
               0.25 $CellContext`w$, (-$CellContext`h$)/4}, {
               0.25 $CellContext`w$, $CellContext`ry$/10}}], 
             
             Arrow[{{0.25 $CellContext`w$, $CellContext`h$ - $CellContext`ry$/
                10}, {0.25 $CellContext`w$, $CellContext`h$ + $CellContext`h$/
                 4}, {-$CellContext`w$, $CellContext`h$ + $CellContext`h$/
                 4}}], $CellContext`colL$, 
             
             Arrow[{{0.75 $CellContext`w$, $CellContext`ry$/10}, {
               0.75 $CellContext`w$, (-$CellContext`h$)/4}, {
               2 $CellContext`w$, (-$CellContext`h$)/4}}], 
             
             Arrow[{{2 $CellContext`w$, $CellContext`h$ + $CellContext`h$/
                 4}, {0.75 $CellContext`w$, $CellContext`h$ + $CellContext`h$/
                 4}, {0.75 $CellContext`w$, $CellContext`h$ - \
$CellContext`ry$/10}}]}, 
            If[4 <= $CellContext`NPR$$, {Thick, 
              Map[
              Line[{{0, #}, {$CellContext`w$, #}}]& , {$CellContext`ry$, 
                0.5 $CellContext`h$, $CellContext`h$ - $CellContext`ry$}], 
              Apply[Text[
                Style[#, 17], {0.5 $CellContext`w$, #2}, {0, -1}]& , {{
                1, $CellContext`ry$}, {
                 Style["n", Italic], 0.5 $CellContext`h$}, {
                 Style["N", Italic], $CellContext`h$ - $CellContext`ry$}}, {
               1}]}, 
             Text[
              Style[
               Column[{
                 Row[{
                   NumberForm[$CellContext`P$, {3, 1}], " atm"}], 
                 Spacer[0], 
                 Row[{
                   NumberForm[$CellContext`T$, {4, 0}], " \[Degree]C"}]}, 
                Center], 
               If[$CellContext`NPR$$ == 1, 17, 16]], {
              0.5 $CellContext`w$, 0.5 $CellContext`h$}]], 
            Text[
             Style[
              If[$CellContext`NPR$$ > 1, 
               Row[{
                 Style["L", Italic], " = ", N[$CellContext`L$]/1000, 
                 " Mmol/h"}], 
               Column[{"liquid solvent feed", 
                 Row[{
                   Style["L", Italic], " = ", N[$CellContext`L$]/1000, 
                   " Mmol/h"}]}, Right]], 
              
              If[$CellContext`NPR$$ == 1, 17, 
               16], $CellContext`colL$], {$CellContext`w$, $CellContext`h$ + \
$CellContext`h$/4}, {-0.5, -1.2}], 
            Text[
             Style[
              If[$CellContext`NPR$$ > 1, 
               Row[{
                 Style["V", Italic], " = ", 
                 NumberForm[N[$CellContext`V$]/1000, {3, 1}], " Mmol/h"}], 
               Column[{"gas feed", 
                 Style[
                  Row[{
                    Style["V", Italic], " = ", $CellContext`gas$$, 
                    " Mmol/h"}], $CellContext`colS$], 
                 If[
                  And[$CellContext`NPR$$ == 1, $CellContext`solution$$], 
                  Row[{"correct ", 
                    Style["V", Italic], " = ", 
                    NumberForm[N[$CellContext`V$]/1000, {3, 1}], 
                    " Mmol/h"}]]}]], 
              If[$CellContext`NPR$$ == 1, 17, 16], $CellContext`colV$], {
             0, (-$CellContext`h$)/4}, {
              If[$CellContext`NPR$$ == 1, 
               If[$CellContext`solution$$, 0.35, 1], 0.5], 1.4}], 
            Apply[Text[
              Style[
               Row[{
                 Subscript[
                  Style["y", Italic], #2], " = ", #, " ppm"}], 
               If[$CellContext`NPR$$ == 1, 17, 16], $CellContext`colV$, 
               Background -> White], {0, #3}, {
               If[$CellContext`graphic$$, 0.5, 1], 0}]& , {{$CellContext`y1$, 
               1, $CellContext`h$ + 2}, {$CellContext`yn1$, 
               Row[{
                 Style["N", Italic], "+1"}], -2}}, {1}], 
            Apply[Text[
              Style[
               Row[{
                 Subscript[
                  Style["x", Italic], #2], " = ", #, " ppm"}], 
               If[$CellContext`NPR$$ == 1, 17, 16], $CellContext`colL$, 
               Background -> White], {$CellContext`w$, #3}, {
               If[$CellContext`graphic$$, -0.5, -1], 
               0}]& , {{$CellContext`x0$, 0, $CellContext`h$ + 2}, {
               NumberForm[$CellContext`xN$, 2], 
               Style["N", Italic], -2}}, {1}]}, ImageSize -> {
             If[$CellContext`NPR$$ == 1, 600, 250], 390}, 
           ImagePadding -> {{20, 20}, {65, 
              If[$CellContext`NPR$$ == 1, 50, 25]}}, AspectRatio -> 
           If[$CellContext`NPR$$ == 1, 0.75, Full], PlotLabel -> 
           If[$CellContext`NPR$$ == 1, 
             Style[
              
              If[$CellContext`hint$$, "hint: use mass balance on solute", 
               "step 1: calculate the gas flow rate, then check solution"], 
              17, Black], None]]; $CellContext`opt$ = Sequence[
           Thickness[
            If[
             And[$CellContext`graphic$$, $CellContext`NPR$$ < 4], 0.011, 
             0.008]], Dotted]; $CellContext`pt1$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`col$, 
            Blank[]]] := {$CellContext`col$, 
           PointSize[
            If[
             And[$CellContext`graphic$$, $CellContext`NPR$$ < 4], 0.04, 
             0.025]], 
           Point[$CellContext`pt$], White, 
           PointSize[
            If[
             And[$CellContext`graphic$$, $CellContext`NPR$$ < 4], 0.025, 
             0.015]], 
           Point[$CellContext`pt$]}; $CellContext`pt2$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`col$, 
            Blank[]]] := {$CellContext`col$, 
           PointSize[
            If[$CellContext`graphic$$, 0.035, 0.02]], 
           Point[$CellContext`pt$]}; $CellContext`pt3$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`col$, 
            Blank[]]] := {$CellContext`col$, 
           PointSize[
            If[$CellContext`graphic$$, 0.035, 0.02]], 
           Point[$CellContext`pt$], White, 
           PointSize[
            If[$CellContext`graphic$$, 0.02, 0.01]], 
           Point[$CellContext`pt$]}; If[
          
          And[$CellContext`n$ == 2, $CellContext`NPR$$ == 
           6], $CellContext`NPR$$ = 7]; $CellContext`diagram$ = 
         Graphics[{Thick, 
            If[$CellContext`NPR$$ == 2, {{
               Evaluate[$CellContext`opt$], $CellContext`colOP$, 
               Line[{$CellContext`op1$$, $CellContext`op2$$}]}, 
              $CellContext`pt1$[$CellContext`op1$$, $CellContext`colOP$], 
              $CellContext`pt1$[$CellContext`op2$$, $CellContext`colOP$], 
              If[$CellContext`solution$$ == False, {
                Text[
                 Style[
                  Column[{
                    Row[{
                    Style["x", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`op1$$, 1], {4, 2}], " ppm"}], 
                    Row[{
                    Style["y", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`op1$$, 2], {3, 0}], " ppm"}]}, 
                   Alignment -> "="], 17, $CellContext`colOP$, Background -> 
                  White], $CellContext`op1$$, {-1, -1.3}], 
                Text[
                 Style[
                  Column[{
                    Row[{
                    Style["x", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`op2$$, 1], {4, 2}], " ppm"}], 
                    Row[{
                    Style["y", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`op2$$, 2], {3, 0}], " ppm"}]}, 
                   Alignment -> "="], 17, $CellContext`colOP$, Background -> 
                  White], $CellContext`op2$$, {1, 1.5}]}], 
              If[$CellContext`solution$$, {$CellContext`colOP$, 
                Line[
                 Map[{#, 
                   $CellContext`yN1$[#]}& , 
                  Range[0, $CellContext`xp2$, 0.01]]]}]}], 
            If[$CellContext`NPR$$ > 2, {$CellContext`colOP$, 
              Line[
               Map[{#, 
                 $CellContext`yN1$[#]}& , 
                Range[0, $CellContext`xp2$, 0.01]]]}], 
            If[$CellContext`NPR$$ == 3, {{
               Evaluate[$CellContext`opt$], $CellContext`colEQ$, 
               Line[{$CellContext`eq1$$, $CellContext`eq2$$}]}, 
              $CellContext`pt1$[$CellContext`eq1$$, $CellContext`colEQ$], 
              $CellContext`pt1$[$CellContext`eq2$$, $CellContext`colEQ$], 
              If[$CellContext`solution$$ == False, {
                Text[
                 Style[
                  Column[{
                    Row[{
                    Style["x", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`eq1$$, 1], {4, 2}], " ppm"}], 
                    Row[{
                    Style["y", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`eq1$$, 2], {3, 0}], " ppm"}]}, 
                   Alignment -> "="], 17, $CellContext`colEQ$, Background -> 
                  White], $CellContext`eq1$$, {-1, -1.3}], 
                Text[
                 Style[
                  Column[{
                    Row[{
                    Style["x", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`eq2$$, 1], {4, 2}], " ppm"}], 
                    Row[{
                    Style["y", Italic], " = ", 
                    NumberForm[
                    Part[$CellContext`eq2$$, 2], {3, 0}], " ppm"}]}, 
                   Alignment -> "="], 17, $CellContext`colEQ$, Background -> 
                  White], $CellContext`eq2$$, {1, 1.5}]}], 
              If[$CellContext`solution$$, {$CellContext`colEQ$, 
                Line[
                 Map[{#, 
                   $CellContext`yeq$[#]}& , 
                  Range[0, $CellContext`xp1$, 0.01]]]}]}], 
            If[$CellContext`NPR$$ > 3, {{$CellContext`colEQ$, 
               Line[
                Map[{#, 
                  $CellContext`yeq$[#]}& , 
                 Range[0, $CellContext`xp1$, 0.01]]]}, 
              $CellContext`pt2$[{$CellContext`xN$, 
                $CellContext`yeq$[$CellContext`xN$]}, Black], 
              Text[
               Style[
                Row[{"(", 
                  Style[
                   Subscript["x", "N"], $CellContext`colL$, Italic], ", ", 
                  Style[
                   Subscript["y", "N"], $CellContext`colV$, Italic], ")"}], 
                17, Background -> White], {$CellContext`xN$, 
                $CellContext`yeq$[$CellContext`xN$]}, {-1.25, 0.5}], 
              $CellContext`pt2$[{$CellContext`x0$, $CellContext`y1$}, Black], 
              Text[
               Style[
                Row[{"(", 
                  Style[
                   Subscript[
                    Style["x", Italic], 0], $CellContext`colL$], ", ", 
                  Style[
                   Subscript[
                    Style["y", Italic], 1], $CellContext`colV$], ")"}], 17, 
                Background -> 
                White], {$CellContext`x0$, $CellContext`y1$}, {-0.5, -3.5}]}], 
            If[$CellContext`NPR$$ == 4, {{Dashed, 
               Line[{{
                  Part[$CellContext`step1$$, 1], 
                  $CellContext`yeq$[
                   Part[$CellContext`step1$$, 1]]}, {
                  Part[$CellContext`step1$$, 1], 
                  $CellContext`yN1$[
                   Part[$CellContext`step1$$, 1]]}}]}, 
              $CellContext`pt3$[$CellContext`step1$$, Black], 
              If[$CellContext`solution$$, 
               Line[{{
                  $CellContext`X$[0], $CellContext`yn1$}, {
                  $CellContext`X$[0], 
                  $CellContext`Y$[0]}, {
                  $CellContext`X$[1], 
                  $CellContext`Y$[0]}}]]}], 
            If[$CellContext`NPR$$ > 4, 
             Line[{{
                $CellContext`X$[0], $CellContext`yn1$}, {
                $CellContext`X$[0], 
                $CellContext`Y$[0]}, {
                $CellContext`X$[1], 
                $CellContext`Y$[0]}}]], 
            If[$CellContext`NPR$$ == 5, {{Dashed, 
               Line[{{
                  Part[$CellContext`step2$$, 1], 
                  $CellContext`yeq$[
                   Part[$CellContext`step2$$, 1]]}, {
                  Part[$CellContext`step2$$, 1], 
                  $CellContext`yN1$[
                   Part[$CellContext`step2$$, 1]]}}]}, 
              $CellContext`pt3$[$CellContext`step2$$, Black], 
              If[$CellContext`solution$$, 
               Line[{{
                  $CellContext`X$[1], 
                  $CellContext`Y$[0]}, {
                  $CellContext`X$[1], 
                  $CellContext`Y$[1]}, {
                  $CellContext`X$[2], 
                  $CellContext`Y$[1]}}]]}], 
            If[$CellContext`NPR$$ == 6, {{Dashed, 
               Line[{{
                  Part[$CellContext`step3$$, 1], 
                  $CellContext`yeq$[
                   Part[$CellContext`step3$$, 1]]}, {
                  Part[$CellContext`step3$$, 1], 
                  $CellContext`yN1$[
                   Part[$CellContext`step3$$, 1]]}}]}, 
              $CellContext`pt3$[$CellContext`step3$$, Black], 
              Map[Line[{{
                  $CellContext`X$[#], 
                  $CellContext`Y$[#]}, {
                  $CellContext`X$[# + 1], 
                  $CellContext`Y$[#]}}]& , 
               Range[0, $CellContext`n$ - 2]], 
              Map[Line[{{
                  $CellContext`X$[# + 1], 
                  $CellContext`Y$[#]}, {
                  $CellContext`X$[# + 1], 
                  $CellContext`Y$[# + 1]}}]& , 
               Range[0, $CellContext`n$ - 3]], 
              If[$CellContext`solution$$, 
               (Line[{{
                  $CellContext`X$[# + 1], 
                  $CellContext`Y$[#]}, {
                  $CellContext`X$[# + 1], 
                  $CellContext`Y$[# + 1]}, {
                  $CellContext`X$[# + 2], 
                  $CellContext`Y$[# + 1]}}]& )[$CellContext`n$ - 2]]}], 
            If[$CellContext`NPR$$ == 7, {
              Map[Line[{{
                  $CellContext`X$[# - 1], 
                  $CellContext`Y$[# - 1]}, {
                  $CellContext`X$[#], 
                  $CellContext`Y$[# - 1]}, {
                  $CellContext`X$[#], 
                  $CellContext`Y$[#]}}]& , 
               Range[$CellContext`n$]]}]}, 
           PlotRange -> {{0, $CellContext`xp1$}, {0, 1.1 $CellContext`yn1$}}, 
           PlotRangeClipping -> If[$CellContext`NPR$$ == 2, True, False], 
           Frame -> True, FrameLabel -> {
             Row[{"solute/(solute-free liquid) ", 
               Style["x", Italic], " (ppm)"}], 
             Row[{"solute/(solute-free gas) ", 
               Style["y", Italic], " (ppm)"}]}, LabelStyle -> {17, Black}, 
           ImageSize -> {
             If[
              And[$CellContext`graphic$$, $CellContext`NPR$$ < 8], 350, 600], 
             390}, AspectRatio -> Full, GridLines -> 
           If[$CellContext`NPR$$ == 7, None, {
              Range[0, $CellContext`xp1$, 0.05], 
              Range[0, 1.1 $CellContext`yn1$, 5]}], GridLinesStyle -> 
           GrayLevel[0.8], ImagePadding -> {{55, 10}, {50, 
              If[$CellContext`graphic$$, 5, 
               If[
                And[
                3 <= $CellContext`NPR$$ <= 6, $CellContext`hint$$ == False], 
                5, 27]]}}, PlotLabel -> If[$CellContext`graphic$$, None, 
             Style[$CellContext`plotlabel$, 17]]]; 
        If[$CellContext`NPR$$ == 1, $CellContext`column$, 
          If[$CellContext`graphic$$, 
           
           Grid[{{$CellContext`diagram$, $CellContext`column$}}], \
$CellContext`diagram$]]], 
      "Specifications" :> {{{$CellContext`reset$$, 3}, 1, 1000, 1, 
         ControlType -> None, ControlPlacement -> 
         1}, {{$CellContext`NPR$$, 7, ""}, {1, 2, 3, 4, 5, 6, 7}, ControlType -> 
         None, ControlPlacement -> 
         2}, {{$CellContext`solution$$, False, "solution"}, {True, False}, 
         Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         3}, {{$CellContext`hint$$, False, "hint"}, {True, False}, 
         ControlPlacement -> 4}, {{$CellContext`graphic$$, False, "column"}, {
         True, False}, ControlPlacement -> 
         5}, {{$CellContext`op1$$, {0.2, 80}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         6}, {{$CellContext`op2$$, {1.35, 91.2}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         7}, {{$CellContext`eq1$$, {0.2, 80}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         8}, {{$CellContext`eq2$$, {1.15, 80}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         9}, {{$CellContext`step1$$, {1.068, 82.80000000000001}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         10}, {{$CellContext`step2$$, {0.5, 40}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         11}, {{$CellContext`step3$$, {0.2, 20}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 12}, 
        Grid[{{
           Button[" new problem ", {
             
             If[$CellContext`reset$$ < 
              1000, $CellContext`reset$$ = $CellContext`reset$$ + 
               1, $CellContext`reset$$ = $CellContext`reset$$ - 
               1], $CellContext`NPR$$ = 1, $CellContext`solution$$ = 
             False, $CellContext`hint$$ = 
             False, $CellContext`op1$$ = {0.2, 80}, $CellContext`op2$$ = {
              1.15, 80}, $CellContext`eq1$$ = {
              0.2, 80}, $CellContext`eq2$$ = {
              1.15, 80}, $CellContext`step1$$ = {
              0.8, 60}, $CellContext`step2$$ = {
              0.5, 40}, $CellContext`step3$$ = {0.2, 20}}], 
           Manipulate`Place[1], 
           
           PaneSelector[{
            1 -> "(1) gas flow rate", 2 -> "(2) draw operating line", 3 -> 
             "(3) draw equilibrium line", 4 -> "(4) draw stage 1", 5 -> 
             "(5) draw stage 2", 6 -> "(6) draw last stage", 7 -> 
             "(7) solution"}, 
            Dynamic[$CellContext`NPR$$]], 
           PaneSelector[{1 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 2 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 3 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 4 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 5 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 5 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}], 6 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
                False}]}, 
            Dynamic[$CellContext`NPR$$]], 
           Manipulate`Place[2], 
           
           PaneSelector[{
            1 -> Manipulate`Place[3], 2 -> Manipulate`Place[3], 3 -> 
             Manipulate`Place[3], 4 -> Manipulate`Place[3], 5 -> 
             Manipulate`Place[3], 6 -> Manipulate`Place[3]}, 
            Dynamic[$CellContext`NPR$$]], 
           
           PaneSelector[{
            1 -> Manipulate`Place[4], 2 -> Manipulate`Place[4], 3 -> 
             Manipulate`Place[4], 4 -> Manipulate`Place[4], 5 -> 
             Manipulate`Place[4], 6 -> Manipulate`Place[4]}, 
            Dynamic[$CellContext`NPR$$]], 
           
           PaneSelector[{
            2 -> Manipulate`Place[5], 3 -> Manipulate`Place[5], 4 -> 
             Manipulate`Place[5], 5 -> Manipulate`Place[5], 6 -> 
             Manipulate`Place[5]}, 
            Dynamic[$CellContext`NPR$$]], 
           PaneSelector[{2 -> Row[{
                Manipulate`Place[6], 
                Manipulate`Place[7]}], 3 -> Row[{
                Manipulate`Place[8], 
                Manipulate`Place[9]}], 4 -> Manipulate`Place[10], 5 -> 
             Manipulate`Place[11], 6 -> Manipulate`Place[12]}, 
            Dynamic[$CellContext`NPR$$]]}}], {{$CellContext`gas$$, 1.2, 
          "select correct gas molar flow rate (Mmol/h)"}, 0.5, 1.5, 0.1, 
         Appearance -> "Labeled", ControlPlacement -> 13}, 
        PaneSelector[{1 -> Manipulate`Place[13]}, 
         Dynamic[$CellContext`NPR$$]]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->357189498,ExpressionUUID->"77822c65-0c60-41dd-8081-3f66a69e0b52"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "DetailsSection",ExpressionUUID->"cd38d565-dd81-4eae-b6cf-6cc7182565b4"],

Cell["\<\
The operating line (magenta) is plotted using the mass balance:\
\>", "DetailNotes",
 CellChangeTimes->{{3.723993868002286*^9, 3.7239938822117863`*^9}},
 CellID->682340474,ExpressionUUID->"ecf2ce27-c08a-4b7a-87b1-32caf42456be"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["x", "0"], " ", "L"}], "+", 
     RowBox[{"y", " ", "V"}]}], "=", 
    RowBox[{
     RowBox[{"x", " ", "L"}], "+", 
     RowBox[{
      SubscriptBox["y", "1"], " ", "V"}]}]}], TraditionalForm]], "InlineMath",
  ExpressionUUID->"27f442c7-0287-4657-8421-4ae97112ceb5"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.723993868002286*^9, 3.723993881804785*^9}, {
  3.723993913068585*^9, 3.7239939315991163`*^9}, {3.725058308832178*^9, 
  3.725058323032404*^9}},
 CellID->349609537,ExpressionUUID->"d0bc49d7-5cc0-4d6e-a2f0-17b3141b0126"],

Cell[TextData[{
 "rearranging the mass balance to solve for ",
 Cell[BoxData[
  FormBox["y", TraditionalForm]], "InlineMath",ExpressionUUID->
  "fefa91cd-4db4-4cb0-9172-e1b6d4a70c5f"],
 ":"
}], "DetailNotes",
 CellChangeTimes->{{3.723993868002286*^9, 3.723993881804785*^9}, {
  3.723993913068585*^9, 3.723993945914014*^9}, {3.725058328405917*^9, 
  3.725058329950077*^9}},
 CellID->18730954,ExpressionUUID->"cac5eae9-3f4b-4a33-956e-3767ef31bc55"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "op"], "=", 
    RowBox[{
     RowBox[{
      FractionBox["L", "V"], " ", 
      RowBox[{"(", 
       RowBox[{"x", "-", 
        SubscriptBox["x", "0"]}], ")"}]}], "+", 
     SubscriptBox["y", "1"]}]}], TraditionalForm]], "InlineMath",
  ExpressionUUID->"0111c3e0-6a2d-458e-838e-e95257018f7a"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.723993868002286*^9, 3.723993881804785*^9}, {
  3.723993913068585*^9, 3.7239939715261903`*^9}, {3.72442671593931*^9, 
  3.7244267196899333`*^9}},
 CellID->34378748,ExpressionUUID->"a9adf7a7-a51b-4e03-92b4-95d015325739"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "0"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "a439d002-5e45-47b2-a2aa-6623d1471399"],
 " is the mole ratio of impurity in the inlet liquid stream (ppm), ",
 Cell[BoxData[
  FormBox["y", TraditionalForm]], "InlineMath",ExpressionUUID->
  "c539217b-d8b0-41a4-a540-c4f53f41990f"],
 " is the mole ratio of impurity (ppm) in the gas stream that corresponds to ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]], "InlineMath",ExpressionUUID->
  "3c81bca8-ca8c-4961-8403-26382555d754"],
 ", which is the mole ratio of impurity in the liquid stream (ppm), ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", "1"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "4ca63144-ee73-451e-8d52-b33f1735fbec"],
 " is the mole ratio of impurity in the outlet gas stream (ppm), ",
 Cell[BoxData[
  FormBox["L", TraditionalForm]], "InlineMath",ExpressionUUID->
  "bed75983-9652-4946-842f-86005df60532"],
 " is the liquid molar flow rate (Mmol/h), and ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]], "InlineMath",ExpressionUUID->
  "c21ab20a-ea31-474e-b2a9-a7b1972fc572"],
 " is the gas molar flow rate (MMol/h)."
}], "DetailNotes",
 CellChangeTimes->{{3.723993868002286*^9, 3.723993881804785*^9}, {
  3.723993913068585*^9, 3.723993977241624*^9}, {3.7239940866465645`*^9, 
  3.7239940935798087`*^9}, {3.723994138994322*^9, 3.723994224591522*^9}, {
  3.725058345637597*^9, 3.725058347711622*^9}, {3.7250583784072495`*^9, 
  3.725058427378516*^9}, {3.725982628212789*^9, 3.7259826307127934`*^9}},
 CellID->477098778,ExpressionUUID->"86d74507-aac3-4f96-94e7-ed3364454ad6"],

Cell["\<\
The equilibrium line (orange) is calculated using Henry's law:\
\>", "DetailNotes",
 CellChangeTimes->{{3.723993868002286*^9, 3.723993881804785*^9}, {
  3.723993913068585*^9, 3.723993977241624*^9}, {3.7239940866465645`*^9, 
  3.7239940935798087`*^9}, {3.723994138994322*^9, 3.72399425745816*^9}, {
  3.7239946102588825`*^9, 3.7239946131009073`*^9}},
 CellID->30253895,ExpressionUUID->"06a4e717-a894-42ff-81ee-2a621fc2db37"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "eq"], "=", 
    RowBox[{
     FractionBox["H", "P"], " ", "x"}]}], TraditionalForm]], "InlineMath",
  ExpressionUUID->"067ea966-7d0c-4946-b53b-3a0dc98e5d6a"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.723993868002286*^9, 3.723993881804785*^9}, {
  3.723993913068585*^9, 3.723993977241624*^9}, {3.7239940866465645`*^9, 
  3.7239940935798087`*^9}, {3.723994138994322*^9, 3.7239942688574305`*^9}, {
  3.72442680976082*^9, 3.7244268102328205`*^9}},
 CellID->717544022,ExpressionUUID->"e7d5961d-0ada-4db1-8075-95e248ea7133"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox["H", TraditionalForm]], "InlineMath",ExpressionUUID->
  "91baac27-0c61-4798-9497-719231b32ca8"],
 " is Henry's constant (atm/mole fraction), and ",
 Cell[BoxData[
  FormBox["P", TraditionalForm]], "InlineMath",ExpressionUUID->
  "226b4e4a-3534-42c7-bd61-6d82f5ae62c5"],
 " is pressure (atm)."
}], "DetailNotes",
 CellChangeTimes->{{3.723993868002286*^9, 3.723993881804785*^9}, {
  3.723993913068585*^9, 3.723993977241624*^9}, {3.7239940866465645`*^9, 
  3.7239940935798087`*^9}, {3.723994138994322*^9, 3.723994294561405*^9}},
 CellID->600555864,ExpressionUUID->"32f9f2d0-dc53-41db-a65f-58fe092ad0e1"],

Cell[TextData[{
 "Henry's constant is calculated from ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["H", "0"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "8188b9d6-a78a-4b06-9bba-6bd9aa186e1e"],
 ", Henry's constant at standard temperature ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "0"], "=", 
    RowBox[{"298", " ", 
     StyleBox["K",
      FontSlant->"Plain"]}]}], TraditionalForm]], "InlineMath",
  ExpressionUUID->"2bd82417-3043-47ba-b619-061a440b4319"],
 ":"
}], "DetailNotes",
 CellChangeTimes->{{3.723994297577836*^9, 3.7239943094379177`*^9}, {
  3.7239943526313925`*^9, 3.7239944551620803`*^9}, {3.724081119742519*^9, 
  3.72408112041432*^9}},
 CellID->455620700,ExpressionUUID->"ae82753d-5aa8-4795-955b-d2293f17a029"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"H", "=", 
    RowBox[{
     SuperscriptBox["H", "0"], " ", 
     SuperscriptBox["e", 
      RowBox[{"-", 
       FractionBox["E", 
        RowBox[{"R", " ", 
         SubscriptBox["T", "0"]}]]}]]}]}], TraditionalForm]], "InlineMath",
  ExpressionUUID->"a827f022-71df-4b93-a4b7-00e2bdcdbe19"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.723994297577836*^9, 3.7239943094379177`*^9}, {
  3.7239943526313925`*^9, 3.7239944737390194`*^9}, {3.7240811094850674`*^9, 
  3.7240811105084705`*^9}},
 CellID->60930568,ExpressionUUID->"ef8f5282-c526-4a4f-9dc5-78e33ac586dd"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox["E", TraditionalForm]], "InlineMath",ExpressionUUID->
  "ea2ac076-96df-42fa-a556-78046e5f9775"],
 " is activation energy (J/mol), ",
 Cell[BoxData[
  FormBox["R", TraditionalForm]], "InlineMath",ExpressionUUID->
  "35a94416-f3a5-4321-8eea-2a59f6aeaf7b"],
 " is the gas constant (J/[mol K]), and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["H", "0"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "8ece44fd-180b-4ca9-8b65-1aa7d826839b"],
 " has units of atm/mole fraction."
}], "DetailNotes",
 CellChangeTimes->{{3.723994297577836*^9, 3.7239943094379177`*^9}, {
  3.7239943526313925`*^9, 3.7239945081702414`*^9}},
 CellID->139031394,ExpressionUUID->"4663b695-f50a-4a4b-8ab1-3c81a28e0c42"],

Cell["Reference", "DetailNotes",
 CellChangeTimes->{{3.700080616089089*^9, 3.700080620869473*^9}, {
  3.7002210497359147`*^9, 3.7002210499553156`*^9}},
 CellID->359414663,
 $CellContext`ExpressionUUID -> 
 "fb4d39f9-5bac-44ca-ab62-8780064af81e",ExpressionUUID->"79010445-5c28-4731-\
9ec7-3690f98b91d8"],

Cell[TextData[{
 "[1] P.C. Wankat,",
 StyleBox[" Separation Process Engineering: Includes Mass Transfer Analysis",
  FontSlant->"Italic"],
 ", 3rd ed., Upper Saddle River, NJ: Prentice Hall, 2012."
}], "DetailNotes",
 CellChangeTimes->{{3.7000806326022177`*^9, 3.700080658235621*^9}, {
  3.7000807420163927`*^9, 3.70008078191269*^9}, {3.7002210411464643`*^9, 
  3.7002210600179667`*^9}, {3.703523576809187*^9, 3.70352363025762*^9}},
 CellID->1027769137,
 $CellContext`ExpressionUUID -> 
 "51f3289b-98e7-4b7b-b134-a4a9bc9f8f2c",ExpressionUUID->"aab85a40-67ca-480e-\
bac8-4bcce4866a36"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ControlSuggestionsSection",ExpressionUUID->"3159b545-57b5-4ce7-9d9a-9c9af55ad15b"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[
   " Resize Images",ExpressionUUID->"cb6627fd-6420-4cf2-92fb-6657996bd8dd"]}],
  "\"Click inside an image to reveal its orange resize frame.\\nDrag any of \
the orange resize handles to resize the image.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.724428238121832*^9},
 FontFamily->"Verdana",
 CellTags->
  "ResizeImages",ExpressionUUID->"a50ac16e-e5a6-4a61-a3cd-dd6697560c0e"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Rotate and Zoom in 3D",ExpressionUUID->
    "68f5e2a8-3b96-482b-bd1e-b598be92a39c"]}],
  RowBox[{
   "\"Drag a 3D graphic to rotate it. Starting the drag near the center \
tumbles\\nthe graphic; starting near a corner turns it parallel to the plane \
of the screen.\\nHold down \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" (or \"", 
    FrameBox[
    "Cmd", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" on Mac) and drag up and down to zoom.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->
  "RotateAndZoomIn3D",ExpressionUUID->"2cf511e4-01b2-4f64-b60b-5408f9039a42"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[
   " Drag Locators",ExpressionUUID->"c8ed22bc-ca2b-4792-aa9f-13f7a2a24ced"]}],
  RowBox[{"\"Drag any locator (\"", 
    GraphicsBox[
     LocatorBox[
      Scaled[{0.5, 0.5}]], ImageSize -> 20], 
    "\", etc.) to move it around.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.724428238922843*^9},
 FontFamily->"Verdana",
 CellTags->
  "DragLocators",ExpressionUUID->"010607f6-8c79-4516-b8a8-7c450888fce7"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Create and Delete Locators",ExpressionUUID->
    "50039a38-99f8-40ec-8a69-ae10cb7a6427"]}],
  RowBox[{"\"Insert a new locator in the graphic by holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key\\nand clicking where you want it to be. Delete a locator by \
clicking it\\nwhile holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" key.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->
  "CreateAndDeleteLocators",ExpressionUUID->"1d147148-5098-4c57-a206-\
62324795a748"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Slider Zoom",ExpressionUUID->"ac02a61f-a521-4d12-bbca-50025b4b232f"]}],
  RowBox[{"\"Hold down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key while moving a slider to make fine adjustments in the slider \
value.\\nHold \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" and/or \"", 
    FrameBox[
    "Shift", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" at the same time as \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" to make ever finer adjustments.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->
  "SliderZoom",ExpressionUUID->"8ba59ac3-7d39-4a46-8d79-2a7c33288d1b"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Gamepad Controls",ExpressionUUID->
    "24c9fb67-cdea-414b-af5d-5e58379095b3"]}],
  "\"Control this Demonstration with a gamepad or other\\nhuman interface \
device connected to your computer.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{
  3.35696210375764*^9, 3.3895522232313623`*^9, {3.7244282399352455`*^9, 
   3.7244282515519037`*^9}},
 FontFamily->"Verdana",
 CellTags->
  "GamepadControls",ExpressionUUID->"a6c55180-b8c2-42c1-84b9-73e1ae58e715"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[
   " Automatic Animation",ExpressionUUID->
    "e3195054-57f5-4a21-8152-4f6f541f44a0"]}],
  RowBox[{"\"Animate a slider in this Demonstration by clicking the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJzzTSzJSM1NLMlMTlRwL0osyMhMLlZwyy8CCjEzMjAwcIKwAgOI/R/IhBKc\n\
/4EAyGAG0f+nTZsGwgysIJIRKsWKLAXGIHFmEpUgLADxWUAkI24jZs+eTaEt\n\
IG+wQKRmzJgBlYf5lhEA30OqWA=="], "Graphics", ImageSize -> {9, 9}, ImageMargins -> 
      0, CellBaseline -> Baseline], BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"button\\nnext to the slider, and then clicking the play button that \
appears.\\nAnimate all controls by selecting \"", 
    StyleBox["Autorun", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.7244282523473067`*^9},
 FontFamily->"Verdana",
 CellTags->
  "AutomaticAnimation",ExpressionUUID->"67b656e2-26fd-4c51-a917-a4bdf0589b2b"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[
   " Bookmark Animation",ExpressionUUID->
    "a3e867a0-c9f3-4b61-bb04-27470a7bdf08"]}],
  RowBox[{
   "\"See a prepared animation of this Demonstration by selecting\\n\"", 
    StyleBox["Animate Bookmarks", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.7244282533967247`*^9},
 FontFamily->"Verdana",
 CellTags->
  "BookmarkAnimation",ExpressionUUID->"75d82e5e-a7b3-455e-a461-62626496b0a3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SearchTermsSection",ExpressionUUID->"40bab27b-ab64-44ec-acac-b4b0159ccf64"],

Cell["absorber", "SearchTerms",
 CellChangeTimes->{{3.72399453584882*^9, 3.723994540490654*^9}, {
  3.7256149223855953`*^9, 3.72561492282337*^9}},
 CellID->202867889,ExpressionUUID->"99dcf27f-f6fd-478b-aeb4-a62bf199d55f"],

Cell["absorption column", "SearchTerms",
 CellChangeTimes->{{3.723995352497517*^9, 3.7239953558559284`*^9}},
 CellID->623494723,ExpressionUUID->"096e3757-2f5d-4cf0-b037-db016bceee8a"],

Cell["separations", "SearchTerms",
 CellChangeTimes->{{3.72399453584882*^9, 3.7239945426310735`*^9}},
 CellID->668433127,ExpressionUUID->"1d844d02-eeea-4462-8701-18f73e2cb727"],

Cell["chemical engineering", "SearchTerms",
 CellChangeTimes->{{3.72399453584882*^9, 3.7239945471893077`*^9}},
 CellID->282037916,ExpressionUUID->"a5bdd15f-a144-428e-a519-72f087d72850"],

Cell["equilibrium stages", "SearchTerms",
 CellChangeTimes->{{3.72399453584882*^9, 3.723994550521722*^9}, {
  3.7256149313827395`*^9, 3.7256149313827395`*^9}},
 CellID->275074345,ExpressionUUID->"5dad2030-9b00-486f-87fc-7e6cad32e643"],

Cell["phase equilibrium", "SearchTerms",
 CellChangeTimes->{{3.72399453584882*^9, 3.723994550521722*^9}, {
  3.725614937026804*^9, 3.725614940728026*^9}},
 CellID->40129904,ExpressionUUID->"40940c1b-bc03-4320-955e-3b188c431cb6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "RelatedLinksSection",ExpressionUUID->"58349a87-238d-4bfe-adac-26722058fbb6"],

Cell[TextData[ButtonBox["McCabe-Thiele Method for Methanol/Water Separation",
 BaseStyle->"Hyperlink",
 ButtonData->{
   URL["http://demonstrations.wolfram.com/\
McCabeThieleMethodForMethanolWaterSeparation/"], None},
 ButtonNote->
  "http://demonstrations.wolfram.com/\
McCabeThieleMethodForMethanolWaterSeparation/"]], "RelatedLinks",
 CellChangeTimes->{{3.699963664517885*^9, 3.6999636839361696`*^9}},
 CellID->42471128,
 $CellContext`ExpressionUUID -> 
 "cdb3e69b-81ad-4695-af41-15af7c7555b8",ExpressionUUID->"7f48909d-6f4d-4e80-\
b510-1b0479e2c9e6"],

Cell[TextData[ButtonBox["Operation of an Absorption Column",
 BaseStyle->"Hyperlink",
 ButtonData->{
   URL["http://demonstrations.wolfram.com/OperationOfAnAbsorptionColumn/"], 
   None},
 ButtonNote->
  "http://demonstrations.wolfram.com/OperationOfAnAbsorptionColumn/"]], \
"RelatedLinks",
 CellChangeTimes->{{3.7240810757099905`*^9, 3.724081089721264*^9}},
 CellID->65783372,ExpressionUUID->"32e43a6f-22fc-4baf-b2c5-9040cfde64ea"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "AuthorSection",ExpressionUUID->"678b3257-a081-493f-bc5f-db1a5dbc1420"],

Cell[TextData[{
 "Contributed by: ",
 ButtonBox["Rachael L. Baumann",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=Rachael%20L.%\
20Baumann"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=Rachael%20L.%\
20Baumann"]
}], "Author",
 CellChangeTimes->{{3.699712700400914*^9, 3.699712711250766*^9}, {
  3.699712766442687*^9, 3.699712785590452*^9}, {3.6999636023826447`*^9, 
  3.699963604458664*^9}, {3.723994575776873*^9, 3.7239945765318904`*^9}},
 CellID->347156356,
 $CellContext`ExpressionUUID -> 
 "ca47b61e-38b9-408d-afda-95466a86c7d6",ExpressionUUID->"90ffd8da-4260-4bc0-\
bbdd-7d52008a657b"],

Cell[TextData[{
 "Additional contributions by: ",
 ButtonBox["John L. Falconer",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=John%20L.%\
20Falconer"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=John%20L.%20Falconer"]
}], "Author",
 CellChangeTimes->{{3.699712700400914*^9, 3.699712728131461*^9}, {
   3.6997128004249277`*^9, 3.6997128004249277`*^9}, {3.7239945792729*^9, 
   3.7239945950711937`*^9}, 3.7258099750863533`*^9},
 CellID->373235529,
 $CellContext`ExpressionUUID -> 
 "39baa6b7-bfbd-410e-bf32-1c17245b691c",ExpressionUUID->"8b032074-ae9f-4710-\
9c5a-a04b8358c582"],

Cell["\<\
(University of Colorado Boulder, Department of Chemical and Biological \
Engineering)\
\>", "Author",
 CellChangeTimes->{{3.699712700400914*^9, 3.699712739137374*^9}},
 CellID->77347031,
 $CellContext`ExpressionUUID -> 
 "b8d8f6e5-3037-4f01-8c69-0946d1ec77a0",ExpressionUUID->"1acb1548-92b1-4c1d-\
bf15-54c135a00632"],

Cell[BoxData[
 TemplateBox[{
  "First","nofirst",
   "\"\\!\\(\\*RowBox[{\\\"{\\\", \\\"}\\\"}]\\) has zero length and no first \
element.\"",2,1,1488,29675937763348916520,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.734195013421502*^9},
 CellLabel->"",
 CellID->355894387,ExpressionUUID->"db9e215a-f2a7-49a0-aedc-1751e038735b"],

Cell[BoxData[
 TemplateBox[{
  "First","nofirst",
   "\"\\!\\(\\*RowBox[{\\\"{\\\", \\\"}\\\"}]\\) has zero length and no first \
element.\"",2,1,1489,29675937763348916520,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.734195013947506*^9},
 CellLabel->"",
 CellID->542402,ExpressionUUID->"610050f3-618e-41d6-aff6-de83bbca484c"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1366, 685},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "Demonstration.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "AutomaticAnimation"->{
  Cell[293754, 6349, 1629, 35, 22, "ControlSuggestions",ExpressionUUID->"67b656e2-26fd-4c51-a917-a4bdf0589b2b",
   CellTags->"AutomaticAnimation"]},
 "BookmarkAnimation"->{
  Cell[295386, 6386, 1073, 25, 22, "ControlSuggestions",ExpressionUUID->"75d82e5e-a7b3-455e-a461-62626496b0a3",
   CellTags->"BookmarkAnimation"]},
 "CreateAndDeleteLocators"->{
  Cell[291475, 6287, 761, 19, 22, "ControlSuggestions",ExpressionUUID->"1d147148-5098-4c57-a206-62324795a748",
   CellTags->"CreateAndDeleteLocators"]},
 "DragLocators"->{
  Cell[290974, 6271, 498, 14, 22, "ControlSuggestions",ExpressionUUID->"010607f6-8c79-4516-b8a8-7c450888fce7",
   CellTags->"DragLocators"]},
 "GamepadControls"->{
  Cell[293203, 6333, 548, 14, 22, "ControlSuggestions",ExpressionUUID->"a6c55180-b8c2-42c1-84b9-73e1ae58e715",
   CellTags->"GamepadControls"]},
 "ResizeImages"->{
  Cell[289698, 6237, 470, 11, 22, "ControlSuggestions",ExpressionUUID->"a50ac16e-e5a6-4a61-a3cd-dd6697560c0e",
   CellTags->"ResizeImages"]},
 "RotateAndZoomIn3D"->{
  Cell[290171, 6250, 800, 19, 22, "ControlSuggestions",ExpressionUUID->"2cf511e4-01b2-4f64-b60b-5408f9039a42",
   CellTags->"RotateAndZoomIn3D"]},
 "SliderZoom"->{
  Cell[292239, 6308, 961, 23, 22, "ControlSuggestions",ExpressionUUID->"8ba59ac3-7d39-4a46-8d79-2a7c33288d1b",
   CellTags->"SliderZoom"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"AutomaticAnimation", 301866, 6560},
 {"BookmarkAnimation", 302039, 6563},
 {"CreateAndDeleteLocators", 302217, 6566},
 {"DragLocators", 302389, 6569},
 {"GamepadControls", 302553, 6572},
 {"ResizeImages", 302717, 6575},
 {"RotateAndZoomIn3D", 302883, 6578},
 {"SliderZoom", 303047, 6581}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 515, 14, 75, "DemoTitle",ExpressionUUID->"bb6eaa89-aebd-471e-b7f2-2ce1c1ee521b"],
Cell[1098, 38, 88, 0, 275, "InitializationSection",ExpressionUUID->"e8d33a45-8ee4-48c3-8409-c5b73abfc5ac"],
Cell[CellGroupData[{
Cell[1211, 42, 84, 0, 189, "ManipulateSection",ExpressionUUID->"5d229dd3-eda5-4f1b-8bd0-79bf0085890c"],
Cell[CellGroupData[{
Cell[1320, 46, 83276, 1903, 3509, "Input",ExpressionUUID->"9e904ded-52c8-4477-b0f4-f78dbe239336"],
Cell[84599, 1951, 38887, 800, 38, "Output",ExpressionUUID->"ff4acde9-0126-488d-bd69-6c72afd0b9c5",
 CellID->75320064]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[123535, 2757, 91, 0, 169, "ManipulateCaptionSection",ExpressionUUID->"54996798-4af4-4f93-a67e-2e1f5693a36c"],
Cell[123629, 2759, 1524, 26, 84, "ManipulateCaption",ExpressionUUID->"8b57fc84-d51e-4c4e-8dd1-035a39f9d8d8",
 CellID->566805683]
}, Open  ]],
Cell[CellGroupData[{
Cell[125190, 2790, 83, 0, 172, "ThumbnailSection",ExpressionUUID->"7ab96e1c-d347-4da8-a1fc-a2eaedfafc1e"],
Cell[125276, 2792, 38887, 800, 38, "Output",ExpressionUUID->"c7e46944-cc17-4d66-ac05-f3c7f9b9c520",
 CellID->19252057]
}, Open  ]],
Cell[CellGroupData[{
Cell[164200, 3597, 83, 0, 142, "SnapshotsSection",ExpressionUUID->"dddd4106-55f0-4bea-b4c1-cea8b6face0c"],
Cell[164286, 3599, 38888, 800, 38, "Output",ExpressionUUID->"309911bc-0299-451c-826d-06f937ddaf21",
 CellID->982163691],
Cell[203177, 4401, 38966, 802, 38, "Output",ExpressionUUID->"8cec2289-3b81-4356-88b3-fcb0b5cf4fca",
 CellID->13481158],
Cell[242146, 5205, 38979, 802, 38, "Output",ExpressionUUID->"77822c65-0c60-41dd-8081-3f66a69e0b52",
 CellID->357189498]
}, Open  ]],
Cell[CellGroupData[{
Cell[281162, 6012, 81, 0, 339, "DetailsSection",ExpressionUUID->"cd38d565-dd81-4eae-b6cf-6cc7182565b4"],
Cell[281246, 6014, 237, 4, 22, "DetailNotes",ExpressionUUID->"ecf2ce27-c08a-4b7a-87b1-32caf42456be",
 CellID->682340474],
Cell[281486, 6020, 632, 18, 23, "DetailNotes",ExpressionUUID->"d0bc49d7-5cc0-4d6e-a2f0-17b3141b0126",
 CellID->349609537],
Cell[282121, 6040, 446, 10, 23, "DetailNotes",ExpressionUUID->"cac5eae9-3f4b-4a33-956e-3767ef31bc55",
 CellID->18730954],
Cell[282570, 6052, 635, 18, 36, "DetailNotes",ExpressionUUID->"a9adf7a7-a51b-4e03-92b4-95d015325739",
 CellID->34378748],
Cell[283208, 6072, 1640, 34, 39, "DetailNotes",ExpressionUUID->"86d74507-aac3-4f96-94e7-ed3364454ad6",
 CellID->477098778],
Cell[284851, 6108, 433, 7, 22, "DetailNotes",ExpressionUUID->"06a4e717-a894-42ff-81ee-2a621fc2db37",
 CellID->30253895],
Cell[285287, 6117, 600, 14, 36, "DetailNotes",ExpressionUUID->"e7d5961d-0ada-4db1-8075-95e248ea7133",
 CellID->717544022],
Cell[285890, 6133, 652, 14, 23, "DetailNotes",ExpressionUUID->"32f9f2d0-dc53-41db-a65f-58fe092ad0e1",
 CellID->600555864],
Cell[286545, 6149, 758, 20, 23, "DetailNotes",ExpressionUUID->"ae82753d-5aa8-4795-955b-d2293f17a029",
 CellID->455620700],
Cell[287306, 6171, 618, 17, 36, "DetailNotes",ExpressionUUID->"ef8f5282-c526-4a4f-9dc5-78e33ac586dd",
 CellID->60930568],
Cell[287927, 6190, 747, 18, 23, "DetailNotes",ExpressionUUID->"4663b695-f50a-4a4b-8ab1-3c81a28e0c42",
 CellID->139031394],
Cell[288677, 6210, 302, 6, 22, "DetailNotes",ExpressionUUID->"79010445-5c28-4731-9ec7-3690f98b91d8",
 CellID->359414663],
Cell[288982, 6218, 584, 12, 22, "DetailNotes",ExpressionUUID->"aab85a40-67ca-480e-bac8-4bcce4866a36",
 CellID->1027769137]
}, Open  ]],
Cell[CellGroupData[{
Cell[289603, 6235, 92, 0, 126, "ControlSuggestionsSection",ExpressionUUID->"3159b545-57b5-4ce7-9d9a-9c9af55ad15b"],
Cell[289698, 6237, 470, 11, 22, "ControlSuggestions",ExpressionUUID->"a50ac16e-e5a6-4a61-a3cd-dd6697560c0e",
 CellTags->"ResizeImages"],
Cell[290171, 6250, 800, 19, 22, "ControlSuggestions",ExpressionUUID->"2cf511e4-01b2-4f64-b60b-5408f9039a42",
 CellTags->"RotateAndZoomIn3D"],
Cell[290974, 6271, 498, 14, 22, "ControlSuggestions",ExpressionUUID->"010607f6-8c79-4516-b8a8-7c450888fce7",
 CellTags->"DragLocators"],
Cell[291475, 6287, 761, 19, 22, "ControlSuggestions",ExpressionUUID->"1d147148-5098-4c57-a206-62324795a748",
 CellTags->"CreateAndDeleteLocators"],
Cell[292239, 6308, 961, 23, 22, "ControlSuggestions",ExpressionUUID->"8ba59ac3-7d39-4a46-8d79-2a7c33288d1b",
 CellTags->"SliderZoom"],
Cell[293203, 6333, 548, 14, 22, "ControlSuggestions",ExpressionUUID->"a6c55180-b8c2-42c1-84b9-73e1ae58e715",
 CellTags->"GamepadControls"],
Cell[293754, 6349, 1629, 35, 22, "ControlSuggestions",ExpressionUUID->"67b656e2-26fd-4c51-a917-a4bdf0589b2b",
 CellTags->"AutomaticAnimation"],
Cell[295386, 6386, 1073, 25, 22, "ControlSuggestions",ExpressionUUID->"75d82e5e-a7b3-455e-a461-62626496b0a3",
 CellTags->"BookmarkAnimation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[296496, 6416, 85, 0, 158, "SearchTermsSection",ExpressionUUID->"40bab27b-ab64-44ec-acac-b4b0159ccf64"],
Cell[296584, 6418, 221, 3, 22, "SearchTerms",ExpressionUUID->"99dcf27f-f6fd-478b-aeb4-a62bf199d55f",
 CellID->202867889],
Cell[296808, 6423, 183, 2, 22, "SearchTerms",ExpressionUUID->"096e3757-2f5d-4cf0-b037-db016bceee8a",
 CellID->623494723],
Cell[296994, 6427, 176, 2, 22, "SearchTerms",ExpressionUUID->"1d844d02-eeea-4462-8701-18f73e2cb727",
 CellID->668433127],
Cell[297173, 6431, 185, 2, 22, "SearchTerms",ExpressionUUID->"a5bdd15f-a144-428e-a519-72f087d72850",
 CellID->282037916],
Cell[297361, 6435, 234, 3, 22, "SearchTerms",ExpressionUUID->"5dad2030-9b00-486f-87fc-7e6cad32e643",
 CellID->275074345],
Cell[297598, 6440, 228, 3, 22, "SearchTerms",ExpressionUUID->"40940c1b-bc03-4320-955e-3b188c431cb6",
 CellID->40129904]
}, Open  ]],
Cell[CellGroupData[{
Cell[297863, 6448, 86, 0, 143, "RelatedLinksSection",ExpressionUUID->"58349a87-238d-4bfe-adac-26722058fbb6"],
Cell[297952, 6450, 554, 12, 22, "RelatedLinks",ExpressionUUID->"7f48909d-6f4d-4e80-b510-1b0479e2c9e6",
 CellID->42471128],
Cell[298509, 6464, 433, 9, 22, "RelatedLinks",ExpressionUUID->"32e43a6f-22fc-4baf-b2c5-9040cfde64ea",
 CellID->65783372]
}, Open  ]],
Cell[CellGroupData[{
Cell[298979, 6478, 80, 0, 141, "AuthorSection",ExpressionUUID->"678b3257-a081-493f-bc5f-db1a5dbc1420"],
Cell[299062, 6480, 686, 17, 22, "Author",ExpressionUUID->"90ffd8da-4260-4bc0-bbdd-7d52008a657b",
 CellID->347156356],
Cell[299751, 6499, 671, 16, 22, "Author",ExpressionUUID->"8b032074-ae9f-4710-9c5a-a04b8358c582",
 CellID->373235529],
Cell[300425, 6517, 327, 8, 22, "Author",ExpressionUUID->"1acb1548-92b1-4c1d-bf15-54c135a00632",
 CellID->77347031],
Cell[300755, 6527, 355, 8, 21, "Message",ExpressionUUID->"db9e215a-f2a7-49a0-aedc-1751e038735b",
 CellID->355894387],
Cell[301113, 6537, 352, 8, 21, "Message",ExpressionUUID->"610050f3-618e-41d6-aff6-de83bbca484c",
 CellID->542402]
}, Open  ]]
}, Open  ]]
}
]
*)

