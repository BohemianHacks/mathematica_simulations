(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    333530,       7211]
NotebookOptionsPosition[    324093,       7023]
NotebookOutlinePosition[    326153,       7073]
CellTagsIndexPosition[    325817,       7061]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Construct Single-Stage Liquid-Liquid Extraction", "DemoTitle",
 CellChangeTimes->{{3.729269206413903*^9, 
  3.729269235647056*^9}},ExpressionUUID->"8390a831-09a9-44f6-b3ab-\
f50cb5fef49d"],

Cell[CellGroupData[{

Cell["", "InitializationSection",ExpressionUUID->"cbfc8ab4-ab26-4e83-ac2c-eb259901389a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Theta]", "=", 
   RowBox[{"60", "\[Degree]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.719930217434127*^9, 3.7199302209745483`*^9}},
 CellID->38764562,ExpressionUUID->"02e54106-e008-4b7d-a91d-533365de3502"],

Cell[BoxData[
 RowBox[{
  RowBox[{"colA", "=", "Blue"}], ";", 
  RowBox[{"colS", "=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{"0", ",", "0.6", ",", "0"}], "]"}]}], ";", 
  RowBox[{"colC", "=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{"0.8", ",", "0", ",", "0.01"}], "]"}]}], ";", 
  RowBox[{"colF", "=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{"1", ",", "0.4", ",", "0"}], "]"}]}], ";", 
  RowBox[{"colM", "=", "Purple"}], ";", 
  RowBox[{"colE", "=", "Red"}], ";", 
  RowBox[{"colR", "=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{"0", ",", "0.6", ",", "1"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.719929926527835*^9, 3.7199299571667852`*^9}, 
   3.7207973454594517`*^9, {3.7207977054333367`*^9, 3.7207977303473835`*^9}, {
   3.728918150452159*^9, 3.7289181731120806`*^9}, 3.7289186185361686`*^9},
 CellID->455768056,ExpressionUUID->"e90ad32b-8695-48e3-9b42-499f136f11d7"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"phase", " ", "boundaries"}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7210642355232587`*^9, 3.7210642395844913`*^9}},
 CellID->319363885,ExpressionUUID->"a04dcac1-c33c-47b2-a877-25b00e9db14c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"phase1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.09", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.17", ",", "0.13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.28", ",", "0.3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.41", ",", "0.44"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.55", ",", "0.47"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.7", ",", "0.42"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.83", ",", "0.26"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.98", ",", "0"}], "}"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.721062020603573*^9, 3.7210620356984363`*^9}, {
  3.7210623383377457`*^9, 3.721062340080846*^9}},
 CellID->23304445,ExpressionUUID->"ac8b1106-dbdd-472e-baef-2df5ecf35f40"],

Cell[BoxData[
 RowBox[{
  RowBox[{"phase2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.0545", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.136", ",", "0.134"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.226", ",", "0.267"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.3405", ",", "0.36"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.534", ",", "0.398"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.673", ",", "0.338"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.7925", ",", "0.232"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.956", ",", "0"}], "}"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellID->69121300,ExpressionUUID->"84b78838-19d7-4aab-88b1-8897b5f33db6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"phase3", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.098", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.172", ",", "0.126"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.2285", ",", "0.213"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.422", ",", "0.338"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.55", ",", "0.352"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.7055", ",", "0.284"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.7925", ",", "0.205"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.92", ",", "0"}], "}"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.7214013662416697`*^9},
 CellID->352699659,ExpressionUUID->"0bbd809e-cb42-4536-8ca5-b25f556579fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"phase4", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.07", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.14", ",", "0.14"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.26", ",", "0.35"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.42", ",", "0.56"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.56", ",", "0.59"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.7", ",", "0.42"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.82", ",", "0.24"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.95", ",", "0"}], "}"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellID->502598256,ExpressionUUID->"d6b06f4b-a323-4903-8dc7-ad17385922b6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"phase5", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.12", ",", "0.15"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.23", ",", "0.32"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.34", ",", "0.45"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.6", ",", "0.5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.69", ",", "0.42"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.77", ",", "0.3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.93", ",", "0"}], "}"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellID->427095650,ExpressionUUID->"1af09238-389a-4cce-8591-129390939512"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"tie", " ", "lines"}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.721064242255644*^9, 3.7210642449537983`*^9}},
 CellID->103515199,ExpressionUUID->"127898b7-0a12-489b-969a-9f748f3024a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tie1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.12", ",", "0.052"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.93", ",", "0.078"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.16", ",", "0.104"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.88", ",", "0.173"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.2", ",", "0.173"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.83", ",", "0.26"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.26", ",", "0.268"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.77", ",", "0.346"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.34", ",", "0.372"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.67", ",", "0.433"}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7199321167398252`*^9, 3.7199323740633235`*^9}, {
   3.719932404199275*^9, 3.7199324691731997`*^9}, {3.721062061408907*^9, 
   3.721062061684922*^9}, {3.721063383504526*^9, 3.7210634273750353`*^9}, 
   3.7210639273486323`*^9, 3.721064340463261*^9, {3.728919151469096*^9, 
   3.7289191768025455`*^9}, {3.7289192852770767`*^9, 3.728919285575477*^9}, {
   3.7290033710460033`*^9, 3.729003371484804*^9}},
 CellID->31799647,ExpressionUUID->"4eb78e18-d471-47e4-ba8a-2848f2b4aea5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tie2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.1", ",", "0.07"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.9", ",", "0.09"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.13", ",", "0.12"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.84", ",", "0.17"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.17", ",", "0.18"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.77", ",", "0.25"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.2", ",", "0.23"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.7", ",", "0.32"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.24", ",", "0.28"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.64", ",", "0.36"}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7210637411619835`*^9, 3.7210637711877003`*^9}, 
   3.721064337943117*^9, {3.721401269659955*^9, 3.7214012714091587`*^9}, {
   3.7289191809757843`*^9, 3.7289192027950325`*^9}, {3.728919288036682*^9, 
   3.7289192882550826`*^9}, {3.7290033735384083`*^9, 
   3.7290033736632085`*^9}, {3.7290039139914446`*^9, 3.7290039144282455`*^9}},
 CellID->174162914,ExpressionUUID->"176f52b8-d13c-43e9-9e76-1eb0e00018fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tie3", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.12", ",", "0.03"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.89", ",", "0.06"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.15", ",", "0.09"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.86", ",", "0.11"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.19", ",", "0.15"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.82", ",", "0.17"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.24", ",", "0.23"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.72", ",", "0.27"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.28", ",", "0.27"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.65", ",", "0.32"}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.721063868110244*^9, 3.721063917078045*^9}, 
   3.7210643366360426`*^9, {3.721401330234479*^9, 3.721401341546533*^9}, {
   3.728919207163471*^9, 3.7289192307207975`*^9}, {3.728919290003501*^9, 
   3.728919290143902*^9}, {3.7290033751952267`*^9, 3.729003375320027*^9}, 
   3.729003976442381*^9, {3.729004013498167*^9, 3.729004013982768*^9}, {
   3.729004064679034*^9, 3.729004064997035*^9}, {3.7290040958106112`*^9, 
   3.729004155805722*^9}},
 CellID->75987909,ExpressionUUID->"fa242265-00ae-4ba8-99f9-8d13e33ee096"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tie4", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.1", ",", "0.06"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.9", ",", "0.1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.15", ",", "0.15"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.84", ",", "0.21"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.21", ",", "0.26"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.75", ",", "0.35"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.28", ",", "0.37"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.67", ",", "0.46"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.37", ",", "0.51"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.59", ",", "0.56"}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7210639993347497`*^9, 3.721064073433988*^9}, 
   3.7210643349049435`*^9, {3.721401288249856*^9, 3.721401300079914*^9}, {
   3.728919233300802*^9, 3.7289192562163243`*^9}, {3.728919292324306*^9, 
   3.7289192925739064`*^9}, {3.7290033766988297`*^9, 3.72900337683923*^9}},
 CellID->183447444,ExpressionUUID->"f4b490ac-b5bb-4516-9ba8-7f46f178a2e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tie5", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.065", ",", "0.07"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.87", ",", "0.11"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.11", ",", "0.13"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.83", ",", "0.2"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.17", ",", "0.22"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.76", ",", "0.32"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.24", ",", "0.33"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.69", ",", "0.41"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.33", ",", "0.44"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.6", ",", "0.5"}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7210641562807264`*^9, 3.7210642215754614`*^9}, {
  3.7210643326058116`*^9, 3.7210643329728327`*^9}, {3.7214012230581164`*^9, 
  3.721401251533654*^9}, {3.728919258907935*^9, 3.7289192945105257`*^9}, {
  3.729003378263833*^9, 3.729003378388633*^9}},
 CellID->413693497,ExpressionUUID->"dc115fdb-59d5-4cd1-9958-72f3c792ee9d"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ternary", " ", "phase", " ", "diagram", " ", "base"}], 
  "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.721064248023974*^9, 3.721064253597293*^9}},
 CellID->227039591,ExpressionUUID->"a73c21bb-b9f2-4983-ae5b-3f195100d510"],

Cell[BoxData[
 RowBox[{
  RowBox[{"diagram", "=", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "@", "Thick"}], ",", 
        RowBox[{"FaceForm", "@", "None"}], ",", 
        RowBox[{"Polygon", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.5", ",", 
             RowBox[{
              SqrtBox["3"], "/", "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"(*", "A", "*)"}], 
         RowBox[{"colA", ",", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"100", "*", "#"}], ",", "16"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "-", 
               RowBox[{"#", "/", "2"}]}], ",", 
              RowBox[{"#", "*", 
               RowBox[{
                SqrtBox["3"], "/", "2"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "2"}], ",", "0"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", "B", "*)"}], "colS", ",", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Rotate", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"100", "*", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", "#"}], ")"}]}], ",", "16"}], "]"}], ",", 
              RowBox[{"-", "\[Theta]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "/", "2"}], ",", 
              RowBox[{"#", "*", 
               RowBox[{
                SqrtBox["3"], "/", "2"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", "C", "*)"}], "colC", ",", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Rotate", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"100", "*", "#"}], ",", "16"}], "]"}], ",", 
              "\[Theta]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"#", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1.2", ",", "1.5"}], "}"}]}], "]"}]}], "}"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"0.1", ",", "0.9", ",", "0.1"}], "]"}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Rotate", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<solute\>\"", ",", "17", ",", "colA"}], "]"}], ",", 
          RowBox[{"-", "\[Theta]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.75", ",", 
          RowBox[{
           SqrtBox["3"], "/", "4"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "3"}], ",", "0"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Rotate", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<solvent\>\"", ",", "17", ",", "colS"}], "]"}], ",", 
          "\[Theta]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.25", ",", 
          RowBox[{
           SqrtBox["3"], "/", "4"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "0"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<carrier\>\"", ",", "17", ",", "colC"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "5"}], "}"}]}], "]"}], ","}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<A\>\"", ",", "20", ",", "colA"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.5", ",", 
           RowBox[{
            SqrtBox["3"], "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "1.2"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<C\>\"", ",", "20", ",", "colC"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "0"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<S\>\"", ",", "20", ",", "colS"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "0"}], "}"}]}], "]"}]}], "*)"}], 
     "\[IndentingNewLine]", "}"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.719928535429177*^9, 3.719928576191984*^9}, {
   3.719928686377326*^9, 3.7199287185579023`*^9}, {3.719928989510062*^9, 
   3.7199291392248554`*^9}, {3.7199292277555246`*^9, 
   3.7199292825608006`*^9}, {3.71992932341101*^9, 3.7199293283208284`*^9}, {
   3.7199293643784194`*^9, 3.7199294266181283`*^9}, {3.7199294756477776`*^9, 
   3.7199294788388004`*^9}, {3.719929770091858*^9, 3.719929878890791*^9}, {
   3.7199299121933627`*^9, 3.719929914039166*^9}, {3.719929961613409*^9, 
   3.719929968245637*^9}, {3.7199299986057863`*^9, 3.719930325312684*^9}, {
   3.7199309868574247`*^9, 3.719931185681376*^9}, {3.719931217247944*^9, 
   3.7199312179513454`*^9}, {3.7199319028767633`*^9, 3.719931904651567*^9}, {
   3.719931988833596*^9, 3.719932072183406*^9}, {3.719932473400424*^9, 
   3.719932532762314*^9}, {3.720797234856645*^9, 3.720797367990693*^9}, {
   3.7207974019609547`*^9, 3.720797478904298*^9}, 3.7207981282965183`*^9, {
   3.7210613890804515`*^9, 3.721061392043621*^9}, {3.72106210481839*^9, 
   3.721062144718672*^9}, {3.7214820749769354`*^9, 3.721482076090538*^9}, {
   3.7217487750492744`*^9, 3.721748829208214*^9}, 3.721749058863179*^9, {
   3.7223501956362133`*^9, 3.722350213421231*^9}, {3.7223502471141577`*^9, 
   3.7223502567887115`*^9}, {3.7223502874534655`*^9, 3.722350308275656*^9}, 
   3.7223506512922754`*^9, {3.7223507267555923`*^9, 3.722350726927602*^9}},
 CellID->272414272,ExpressionUUID->"cf648427-aa92-4105-8c87-fb341e394a4a"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"drid", " ", "lines"}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7210642567414722`*^9, 3.7210642598536506`*^9}},
 CellID->249738370,ExpressionUUID->"abf9a5b5-8181-4a14-bc7e-b27b4bc75fd7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gridlines", "=", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"GrayLevel", "@", "0.65"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "/", "2"}], ",", 
               RowBox[{"#", "*", 
                RowBox[{
                 SqrtBox["3"], "/", "2"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "-", 
                RowBox[{"#", "/", "2"}]}], ",", 
               RowBox[{"#", "*", 
                RowBox[{
                 SqrtBox["3"], "/", "2"}]}]}], "}"}]}], "}"}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "/", "2"}], ",", 
               RowBox[{"#", "*", 
                RowBox[{
                 SqrtBox["3"], "/", "2"}]}]}], "}"}]}], "}"}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "-", "#"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "-", 
                RowBox[{"#", "/", "2"}]}], ",", 
               RowBox[{"#", "*", 
                RowBox[{
                 SqrtBox["3"], "/", "2"}]}]}], "}"}]}], "}"}], "]"}]}], "}"}],
         "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"0.05", ",", "0.95", ",", "0.1"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "/", "2"}], ",", 
               RowBox[{"#", "*", 
                RowBox[{
                 SqrtBox["3"], "/", "2"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1.02", "-", 
                RowBox[{"#", "/", "2"}]}], ",", 
               RowBox[{"#", "*", 
                RowBox[{
                 SqrtBox["3"], "/", "2"}]}]}], "}"}]}], "}"}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"0.97", "*", 
                RowBox[{"#", "/", "2"}]}], ",", 
               RowBox[{"1.03", "*", "#", "*", 
                RowBox[{
                 SqrtBox["3"], "/", "2"}]}]}], "}"}]}], "}"}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"0.98", "-", "#"}], ",", 
               RowBox[{"-", "0.02"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "-", 
                RowBox[{"#", "/", "2"}]}], ",", 
               RowBox[{"#", "*", 
                RowBox[{
                 SqrtBox["3"], "/", "2"}]}]}], "}"}]}], "}"}], "]"}]}], "}"}],
         "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"0.1", ",", "0.9", ",", "0.1"}], "]"}]}]}], 
     "\[IndentingNewLine]", "}"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.719929202233595*^9, 3.7199292654005203`*^9}, {
   3.7199293342244673`*^9, 3.719929346316122*^9}, {3.7199294352029753`*^9, 
   3.719929486467429*^9}, {3.7199298940120673`*^9, 3.719929904782134*^9}, {
   3.7199299823153095`*^9, 3.7199300102092543`*^9}, 3.720798131126523*^9, {
   3.7210633688666887`*^9, 3.7210633710778155`*^9}, {3.7223503105697875`*^9, 
   3.722350633415253*^9}, {3.7223506714774303`*^9, 3.722350700306079*^9}, {
   3.722350735794109*^9, 3.7223507360291224`*^9}},
 CellID->490870812,ExpressionUUID->"eb1087f1-30f0-40a5-9aa8-c3a81cbd30bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pt1", "[", 
    RowBox[{"pt_", ",", "col_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PointSize", "@", "0.03"}], ",", "col", ",", 
     RowBox[{"Point", "@", "pt"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7209755493587656`*^9, 3.720975569358264*^9}, 
   3.720975978400324*^9, {3.720977985259171*^9, 3.7209779853371716`*^9}, 
   3.721747672973381*^9},
 CellID->428591391,ExpressionUUID->"649e34a0-fff6-4d4e-951c-c53975d2511c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pt2", "[", 
    RowBox[{"pt_", ",", "col_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PointSize", "@", "0.03"}], ",", "col", ",", 
     RowBox[{"Point", "@", "pt"}], ",", 
     RowBox[{"PointSize", "@", "0.015"}], ",", "White", ",", 
     RowBox[{"Point", "@", "pt"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7209755730082865`*^9, 3.720975627458767*^9}, {
  3.720975963094847*^9, 3.720975972963298*^9}, {3.7209779834327607`*^9, 
  3.720977987811976*^9}, {3.72174767543841*^9, 3.721747677887442*^9}, {
  3.728760224534002*^9, 3.728760225801074*^9}},
 CellID->645136754,ExpressionUUID->"fc7b94ee-1fc5-4c40-95ba-4ae32d9151e2"]
}, Closed]],

Cell[CellGroupData[{

Cell["", "ManipulateSection",ExpressionUUID->"f4086e12-214d-4dde-91a3-21a04c1a772e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "part", ",", "phase", ",", "tie", ",", "feedA", ",", "feedC", ",", 
       "feedS", ",", "FtoS", ",", "mF", ",", "mS", ",", "mM", ",", "xM", ",", 
       "massA", ",", "massC", ",", "massS", ",", "func1", ",", "func2", ",", 
       "xmix", ",", "ymix", ",", "tieline", ",", "lower", ",", "upper", ",", 
       "lever", ",", "newtie", ",", "x1", ",", "x2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SeedRandom", "[", "reset", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"part", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "5"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phase", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "phase1", ",", "phase2", ",", "phase3", ",", "phase4", ",", 
          "phase5"}], "}"}], "[", 
        RowBox[{"[", "part", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tie", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"tie1", ",", "tie2", ",", "tie3", ",", "tie4", ",", "tie5"}],
          "}"}], "[", 
        RowBox[{"[", "part", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"feed", " ", "mass", " ", "percentages"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"feedA", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"25", ",", "55"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"feedC", "=", 
       RowBox[{"100", "-", "feedA"}]}], ";", 
      RowBox[{"feedS", "=", 
       RowBox[{"100", "-", "feedA", "-", "feedC"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "feed", " ", "and", " ", "solvent", " ", "mass", " ", "percentages"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"FtoS", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "5"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mF", "=", "50"}], ";", 
      RowBox[{"mS", "=", 
       RowBox[{"mF", "/", "FtoS"}]}], ";", 
      RowBox[{"mM", "=", 
       RowBox[{"mF", "+", "mS"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xM", "=", 
       FractionBox["mS", 
        RowBox[{"mF", "+", "mS"}]]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"A", ",", " ", "C", ",", " ", 
        RowBox[{
        "and", " ", "S", " ", "feed", " ", "mass", " ", "percentages"}]}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"massA", "=", 
       RowBox[{
        FractionBox["mF", 
         RowBox[{"mF", "+", "mS"}]], "*", 
        FractionBox["feedA", "100"]}]}], ";", 
      RowBox[{"massC", "=", 
       RowBox[{
        FractionBox["mF", 
         RowBox[{"mF", "+", "mS"}]], "*", 
        FractionBox["feedC", "100"]}]}], ";", 
      RowBox[{"massS", "=", 
       FractionBox["mS", 
        RowBox[{"mF", "+", "mS"}]]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"mixing", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"func1", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SqrtBox["3"]}], "*", 
         RowBox[{"(", 
          RowBox[{"x", "-", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "xM"}], ")"}], "*", 
             RowBox[{
              SqrtBox["3"], "/", "2"}]}], 
            RowBox[{"Tan", "[", "\[Theta]", "]"}]]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "xM"}], ")"}], "*", 
         RowBox[{
          SqrtBox["3"], "/", "2"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"func2", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox["feedA", "100"], "*", 
             RowBox[{
              SqrtBox["3"], "/", "2"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{
              FractionBox["feedA", "100"], "*", 
              RowBox[{
               RowBox[{
                SqrtBox["3"], "/", "2"}], "/", 
               RowBox[{"Tan", "[", "\[Theta]", "]"}]}]}]}], ")"}]}], ")"}], 
         "*", 
         RowBox[{"(", 
          RowBox[{"x", "-", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{
              FractionBox["feedA", "100"], "*", 
              RowBox[{
               RowBox[{
                SqrtBox["3"], "/", "2"}], "/", 
               RowBox[{"Tan", "[", "\[Theta]", "]"}]}]}]}], ")"}]}], ")"}]}], 
        "+", 
        RowBox[{
         FractionBox["feedA", "100"], "*", 
         RowBox[{
          SqrtBox["3"], "/", "2"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xmix", "=", 
       RowBox[{"x", "/.", 
        RowBox[{"Quiet", "@", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"func1", "[", "x", "]"}], "\[Equal]", 
             RowBox[{"func2", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}]}], ";", 
      RowBox[{"ymix", "=", 
       RowBox[{"func1", "[", "xmix", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tieline", "[", 
        RowBox[{"list_", ",", "line_", ",", "x_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Fit", "[", 
         RowBox[{
          RowBox[{"list", "[", 
           RowBox[{"[", "line", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "z"}], "}"}], ",", "z"}], "]"}], "/.", 
        RowBox[{"z", "\[Rule]", "x"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"lower", "[", "x_", "]"}], ":=", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ymix", "\[LessEqual]", 
          RowBox[{"tieline", "[", 
           RowBox[{"tie", ",", "1", ",", "xmix"}], "]"}]}], ",", "0", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tieline", "[", 
           RowBox[{"tie", ",", "1", ",", "xmix"}], "]"}], "<", "ymix", 
          "\[LessEqual]", 
          RowBox[{"tieline", "[", 
           RowBox[{"tie", ",", "2", ",", "xmix"}], "]"}]}], ",", 
         RowBox[{"tieline", "[", 
          RowBox[{"tie", ",", "1", ",", "x"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tieline", "[", 
           RowBox[{"tie", ",", "2", ",", "xmix"}], "]"}], "<", "ymix", 
          "\[LessEqual]", 
          RowBox[{"tieline", "[", 
           RowBox[{"tie", ",", "3", ",", "xmix"}], "]"}]}], ",", 
         RowBox[{"tieline", "[", 
          RowBox[{"tie", ",", "2", ",", "x"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tieline", "[", 
           RowBox[{"tie", ",", "3", ",", "xmix"}], "]"}], "<", "ymix", 
          "\[LessEqual]", 
          RowBox[{"tieline", "[", 
           RowBox[{"tie", ",", "4", ",", "xmix"}], "]"}]}], ",", 
         RowBox[{"tieline", "[", 
          RowBox[{"tie", ",", "3", ",", "x"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tieline", "[", 
           RowBox[{"tie", ",", "4", ",", "xmix"}], "]"}], "<", "ymix", 
          "\[LessEqual]", 
          RowBox[{"tieline", "[", 
           RowBox[{"tie", ",", "5", ",", "xmix"}], "]"}]}], ",", 
         RowBox[{"tieline", "[", 
          RowBox[{"tie", ",", "4", ",", "x"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tieline", "[", 
           RowBox[{"tie", ",", "5", ",", "xmix"}], "]"}], "<", "ymix"}], ",", 
         RowBox[{"tieline", "[", 
          RowBox[{"tie", ",", "5", ",", "x"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"upper", "[", "x_", "]"}], ":=", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ymix", "\[LessEqual]", 
          RowBox[{"tieline", "[", 
           RowBox[{"tie", ",", "1", ",", "xmix"}], "]"}]}], ",", 
         RowBox[{"tieline", "[", 
          RowBox[{"tie", ",", "1", ",", "x"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tieline", "[", 
           RowBox[{"tie", ",", "1", ",", "xmix"}], "]"}], "<", "ymix", 
          "\[LessEqual]", 
          RowBox[{"tieline", "[", 
           RowBox[{"tie", ",", "2", ",", "xmix"}], "]"}]}], ",", 
         RowBox[{"tieline", "[", 
          RowBox[{"tie", ",", "2", ",", "x"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tieline", "[", 
           RowBox[{"tie", ",", "2", ",", "xmix"}], "]"}], "<", "ymix", 
          "\[LessEqual]", 
          RowBox[{"tieline", "[", 
           RowBox[{"tie", ",", "3", ",", "xmix"}], "]"}]}], ",", 
         RowBox[{"tieline", "[", 
          RowBox[{"tie", ",", "3", ",", "x"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tieline", "[", 
           RowBox[{"tie", ",", "3", ",", "xmix"}], "]"}], "<", "ymix", 
          "\[LessEqual]", 
          RowBox[{"tieline", "[", 
           RowBox[{"tie", ",", "4", ",", "xmix"}], "]"}]}], ",", 
         RowBox[{"tieline", "[", 
          RowBox[{"tie", ",", "4", ",", "x"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tieline", "[", 
           RowBox[{"tie", ",", "4", ",", "xmix"}], "]"}], "<", "ymix", 
          "\[LessEqual]", 
          RowBox[{"tieline", "[", 
           RowBox[{"tie", ",", "5", ",", "xmix"}], "]"}]}], ",", 
         RowBox[{"tieline", "[", 
          RowBox[{"tie", ",", "5", ",", "x"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tieline", "[", 
           RowBox[{"tie", ",", "5", ",", "xmix"}], "]"}], "<", "ymix"}], ",", 
         RowBox[{"tieline", "[", 
          RowBox[{"tie", ",", "5", ",", "x"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"lever", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ymix", ">", 
          RowBox[{"tieline", "[", 
           RowBox[{"tie", ",", "5", ",", "xmix"}], "]"}]}], ",", "1", ",", 
         FractionBox[
          RowBox[{"ymix", "-", 
           RowBox[{"lower", "[", "xmix", "]"}]}], 
          RowBox[{
           RowBox[{"upper", "[", "xmix", "]"}], "-", 
           RowBox[{"lower", "[", "xmix", "]"}]}]]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newtie", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "lever"}], ")"}], "*", 
         RowBox[{"lower", "[", "x", "]"}]}], "+", 
        RowBox[{"lever", "*", 
         RowBox[{"upper", "[", "x", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"x1", "=", 
       RowBox[{"x", "/.", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"newtie", "[", "x", "]"}], "\[Equal]", 
           RowBox[{
            RowBox[{"Interpolation", "[", "phase", "]"}], "[", "x", "]"}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0.1"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"x2", "=", 
       RowBox[{"x", "/.", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"newtie", "[", "x", "]"}], "\[Equal]", 
           RowBox[{
            RowBox[{"Interpolation", "[", "phase", "]"}], "[", "x", "]"}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0.9"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ymix", ">", 
         RowBox[{"Quiet", "@", 
          RowBox[{
           RowBox[{"Interpolation", "[", "phase", "]"}], "[", "xmix", 
           "]"}]}]}], ",", 
        RowBox[{"reset", "=", 
         RowBox[{"reset", "+", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{"gridlines", ",", "diagram", ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.25"}], ",", "1.25"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.2"}], ",", "0.95"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"600", ",", "390"}], "}"}]}], ",", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"phase", " ", "and", " ", "tie", " ", "lines"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Thick", ",", 
             RowBox[{"Line", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"#", ",", 
                  RowBox[{
                   RowBox[{"Interpolation", "[", "phase", "]"}], "[", "#", 
                   "]"}]}], "}"}], "&"}], "/@", 
               RowBox[{"Range", "[", 
                RowBox[{
                 RowBox[{"phase", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"phase", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], ",", 
                 "0.01"}], "]"}]}], "]"}], ",", 
             RowBox[{"Line", "@", "tie"}]}], "}"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"place", " ", "feed", " ", "point"}], ",", " ", 
             RowBox[{"midland", "=", "2"}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"midland", "\[Equal]", "1"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<mass % in feed\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"Framed", "[", 
                    RowBox[{
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<solute = \>\"", ",", "feedA", ",", "\"\<%\>\""}], 
                    "}"}]}], ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<carrier = \>\"", ",", "feedC", ",", "\"\<%\>\""}], 
                    "}"}]}], ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<solvent = \>\"", ",", "feedS", ",", "\"\<%\>\""}], 
                    "}"}]}]}], "}"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", "\"\<=\>\""}]}], "]"}], 
                    ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], ",", "Center"}], "]"}], ",",
                    "17"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"0.9", "*", 
                    RowBox[{
                    SqrtBox["3"], "/", "2"}]}]}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"pt2", "[", 
                RowBox[{"feed", ",", "colF"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<feed\>\"", ",", "17", ",", "colF", ",", 
                   RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                 "feed", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"-", "1.75"}]}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{"pt1", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    FractionBox["feedA", "100"], "*", 
                    RowBox[{
                    SqrtBox["3"], "/", "2"}]}], 
                    RowBox[{"Tan", "[", "\[Theta]", "]"}]]}], ",", 
                    RowBox[{
                    FractionBox["feedA", "100"], "*", 
                    RowBox[{
                    SqrtBox["3"], "/", "2"}]}]}], "}"}], ",", "colF"}], 
                  "]"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"midland", ">", "1"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pt1", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    FractionBox["feedA", "100"], "*", 
                    RowBox[{
                    SqrtBox["3"], "/", "2"}]}], 
                    RowBox[{"Tan", "[", "\[Theta]", "]"}]]}], ",", 
                   RowBox[{
                    FractionBox["feedA", "100"], "*", 
                    RowBox[{
                    SqrtBox["3"], "/", "2"}]}]}], "}"}], ",", "colF"}], "]"}],
                ",", 
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\< F \>\"", ",", "17", ",", "colF", ",", 
                   RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    FractionBox["feedA", "100"], "*", 
                    RowBox[{
                    SqrtBox["3"], "/", "2"}]}], 
                    RowBox[{"Tan", "[", "\[Theta]", "]"}]]}], ",", 
                   RowBox[{
                    FractionBox["feedA", "100"], "*", 
                    RowBox[{
                    SqrtBox["3"], "/", "2"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], "}"}]}], "]"}], 
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"place", " ", "solvent", " ", "point"}], ",", " ", 
             RowBox[{"midland", "=", "3"}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"midland", "\[Equal]", "2"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<mass % in solvent\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"Framed", "[", 
                    RowBox[{
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<solute = \>\"", ",", "0", ",", "\"\<%\>\""}],
                     "}"}]}], ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<carrier = \>\"", ",", "0", ",", "\"\<%\>\""}], 
                    "}"}]}], ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<solvent = \>\"", ",", "100", ",", "\"\<%\>\""}], 
                    "}"}]}]}], "}"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", "\"\<=\>\""}]}], "]"}], 
                    ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], ",", "Center"}], "]"}], ",",
                    "17"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"0.9", "*", 
                    RowBox[{
                    SqrtBox["3"], "/", "2"}]}]}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"pt2", "[", 
                RowBox[{"solvent", ",", "colS"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<solvent\>\"", ",", "17", ",", "colS", ",", 
                   RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                 "solvent", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"-", "1.75"}]}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{"pt1", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "colS"}], "]"}]}], 
                "]"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"midland", ">", "2"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pt1", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}], ",", "colS"}], "]"}], ",", 
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<S\>\"", ",", "17", ",", "colS", ",", 
                   RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], "}"}]}], "]"}], 
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"draw", " ", "mass", " ", "balance", " ", "line"}], ",", 
             " ", 
             RowBox[{"midland", "=", "1"}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"midland", "\[Equal]", "3"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Thickness", "@", "0.007"}], ",", 
                 RowBox[{"CapForm", "@", "None"}], ",", "Dashed", ",", 
                 "Magenta", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{"line1", ",", "line2"}], "}"}], "]"}]}], "}"}], 
               ",", 
               RowBox[{"pt2", "[", 
                RowBox[{"line1", ",", "Magenta"}], "]"}], ",", 
               RowBox[{"pt2", "[", 
                RowBox[{"line2", ",", "Magenta"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Thickness", "@", "0.007"}], ",", 
                   RowBox[{"CapForm", "@", "None"}], ",", "Magenta", ",", 
                   RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{
                    FractionBox["feedA", "100"], "*", 
                    RowBox[{
                    RowBox[{
                    SqrtBox["3"], "/", "2"}], "/", 
                    RowBox[{"Tan", "[", "\[Theta]", "]"}]}]}]}], ",", 
                    RowBox[{
                    FractionBox["feedA", "100"], "*", 
                    RowBox[{
                    SqrtBox["3"], "/", "2"}]}]}], "}"}]}], "}"}], "]"}]}], 
                  "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"midland", ">", "3"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Thickness", "@", "0.007"}], ",", 
               RowBox[{"CapForm", "@", "None"}], ",", "Magenta", ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{
                    FractionBox["feedA", "100"], "*", 
                    RowBox[{
                    RowBox[{
                    SqrtBox["3"], "/", "2"}], "/", 
                    RowBox[{"Tan", "[", "\[Theta]", "]"}]}]}]}], ",", 
                    RowBox[{
                    FractionBox["feedA", "100"], "*", 
                    RowBox[{
                    SqrtBox["3"], "/", "2"}]}]}], "}"}]}], "}"}], "]"}]}], 
              "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"place", " ", "mixing", " ", "point"}], ",", " ", 
             RowBox[{"midland", "=", "4"}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"midland", "\[Equal]", "4"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"pt2", "[", 
                RowBox[{"mixing", ",", "colM"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<mixing\>\"", ",", "17", ",", "colM", ",", 
                   RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                 "mixing", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"-", "1.75"}]}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"solution", "\[Equal]", "False"}], ",", 
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<mass flow (kg/h)\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"Framed", "[", 
                    RowBox[{
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<feed = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"mF", ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "1"}], "}"}]}], "]"}]}], "}"}]}], ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<solvent = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"mS", ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "1"}], "}"}]}], "]"}]}], "}"}]}]}], 
                    "}"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", "\"\<=\>\""}]}], "]"}], 
                    ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<F\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\</\>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<S\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"FtoS", ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "1"}], "}"}]}], "]"}]}], "}"}]}]}], 
                    "\[IndentingNewLine]", "}"}], ",", "Center"}], "]"}], ",",
                     "17"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"0.9", "*", 
                    RowBox[{
                    SqrtBox["3"], "/", "2"}]}]}], "}"}]}], "]"}]}], "]"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{"pt1", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"xmix", ",", 
                    RowBox[{"func1", "[", "xmix", "]"}]}], "}"}], ",", 
                   "colM"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}],
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"midland", ">", "4"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pt1", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"xmix", ",", 
                   RowBox[{"func1", "[", "xmix", "]"}]}], "}"}], ",", 
                 "colM"}], "]"}], ",", 
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<M\>\"", ",", "17", ",", "colM", ",", 
                   RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"xmix", ",", 
                   RowBox[{"func1", "[", "xmix", "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], "}"}]}], "]"}], 
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"feed", " ", "mass", " ", "percentages"}], ",", " ", 
             RowBox[{"midland", "=", "5"}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"midland", "\[Equal]", "5"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"Framed", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<solute = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"massA", "*", "100"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "0"}], "}"}]}], "]"}], ",", 
                    "\"\<%\>\""}], "}"}]}], ",", "colA"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<carrier = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"massC", "*", "100"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "0"}], "}"}]}], "]"}], ",", 
                    "\"\<%\>\""}], "}"}]}], ",", "colC"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<solvent = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"massS", "*", "100"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "0"}], "}"}]}], "]"}], ",", 
                    "\"\<%\>\""}], "}"}]}], ",", "colS"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", "\"\<=\>\""}]}], "]"}], 
                    ",", "17"}], "]"}], ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"0.9", "*", 
                    RowBox[{
                    SqrtBox["3"], "/", "2"}]}]}], "}"}]}], "]"}]}], "]"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"solution", "\[Equal]", "False"}], ",", 
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<mass flow (kg/h)\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"Framed", "[", 
                    RowBox[{
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<feed = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"mF", ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "1"}], "}"}]}], "]"}]}], "}"}]}], ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<solvent = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"mS", ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "1"}], "}"}]}], "]"}]}], "}"}]}]}], 
                    "}"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", "\"\<=\>\""}]}], "]"}], 
                    ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<F\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\</\>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<S\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"FtoS", ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "1"}], "}"}]}], "]"}]}], "}"}]}]}], 
                    "\[IndentingNewLine]", "}"}], ",", "Center"}], "]"}], ",",
                     "17"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"0.9", "*", 
                    RowBox[{
                    SqrtBox["3"], "/", "2"}]}]}], "}"}]}], "]"}]}], "]"}]}], 
              "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"outlet", " ", "streams"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"midland", "\[Equal]", "6"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Thick", ",", "Dashed", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{"outletE", ",", "outletR"}], "}"}], "]"}]}], "}"}],
                ",", 
               RowBox[{"pt2", "[", 
                RowBox[{"outletE", ",", "colE"}], "]"}], ",", 
               RowBox[{"pt2", "[", 
                RowBox[{"outletR", ",", "colR"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"solution", "\[Equal]", "False"}], ",", 
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"#1", ",", "17", ",", "#2", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    "#3", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1.75"}]}], "}"}]}], "]"}]}], "]"}], "&"}], "@@@", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<extract\>\"", ",", "colE", ",", "outletE"}], 
                   "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<raffinate\>\"", ",", "colR", ",", "outletR"}],
                    "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Thickness", "@", "0.0075"}], ",", "Dashed", ",", 
                   "Orange", ",", 
                   RowBox[{"Line", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"newtie", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"x1", ",", "x2", ",", "0.01"}], "]"}]}], "]"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"pt1", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x1", ",", 
                    RowBox[{"newtie", "[", "x1", "]"}]}], "}"}], ",", 
                    "colE"}], "]"}], ",", 
                   RowBox[{"pt1", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x2", ",", 
                    RowBox[{"newtie", "[", "x2", "]"}]}], "}"}], ",", 
                    "colR"}], "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<E\>\"", ",", "17", ",", "colE", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x1", ",", 
                    RowBox[{"newtie", "[", "x1", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1.75"}]}], "}"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<R\>\"", ",", "17", ",", "colR", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x2", ",", 
                    RowBox[{"newtie", "[", "x2", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1.75"}]}], "}"}]}], "]"}]}], "}"}]}], 
                "]"}]}], "\[IndentingNewLine]", "}"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"PaneSelector", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "1", "\[Rule]", 
          "\"\<step 1: move the point to the correct feed composition\>\""}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
         "2", "\[Rule]", 
          "\"\<step 2: move the point to the correct solvent \
composition\>\""}], ",", "\[IndentingNewLine]", 
         RowBox[{
         "3", "\[Rule]", 
          "\"\<step 3: draw a line connecting feed and solvent compositions\>\
\""}], ",", "\[IndentingNewLine]", 
         RowBox[{
         "4", "\[Rule]", 
          "\"\<step 4: move the point to the correct mixing point \
location\>\""}], ",", "\[IndentingNewLine]", 
         RowBox[{
         "5", "\[Rule]", 
          "\"\<step 5: use sliders to set the correct mass percentages of the \
mixing point\>\""}], ",", "\[IndentingNewLine]", 
         RowBox[{
         "6", "\[Rule]", "\"\<step 6: determine outlet compositions\>\""}]}], 
        "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"Dynamic", "@", "midland"}]}], "]"}], ",", "Bold"}], "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"Grid", "@", 
    RowBox[{"{", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{"\"\< new problem \>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"reset", "<", "1000"}], ",", 
             RowBox[{"reset", "=", 
              RowBox[{"reset", "+", "1"}]}], ",", 
             RowBox[{"reset", "=", 
              RowBox[{"reset", "-", "1"}]}]}], "]"}], ",", 
           RowBox[{"midland", "=", "1"}], ",", 
           RowBox[{"feed", "=", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", 
              RowBox[{"0.7", "*", 
               RowBox[{
                SqrtBox["3"], "/", "2"}]}]}], "}"}]}], ",", 
           RowBox[{"solvent", "=", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", 
              RowBox[{"0.7", "*", 
               RowBox[{
                SqrtBox["3"], "/", "2"}]}]}], "}"}]}], ",", 
           RowBox[{"line1", "=", 
            RowBox[{"{", 
             RowBox[{"0.35", ",", 
              RowBox[{"0.6", "*", 
               RowBox[{
                SqrtBox["3"], "/", "2"}]}]}], "}"}]}], ",", 
           RowBox[{"line2", "=", 
            RowBox[{"{", 
             RowBox[{"0.65", ",", 
              RowBox[{"0.6", "*", 
               RowBox[{
                SqrtBox["3"], "/", "2"}]}]}], "}"}]}], ",", 
           RowBox[{"mixing", "=", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", 
              RowBox[{"0.7", "*", 
               RowBox[{
                SqrtBox["3"], "/", "2"}]}]}], "}"}]}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"midland", "\[Equal]", "midland"}], ",", 
             RowBox[{"solution", "=", "False"}]}], "]"}]}], "}"}]}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"PaneSelector", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", 
            RowBox[{"Style", "[", 
             RowBox[{"\"\<(1) feed composition\>\"", ",", "colF"}], "]"}]}], 
           ",", 
           RowBox[{"2", "\[Rule]", 
            RowBox[{"Style", "[", 
             RowBox[{"\"\<(2) solvent composition\>\"", ",", "colS"}], 
             "]"}]}], ",", 
           RowBox[{"3", "\[Rule]", "\"\<(3) draw mass balance line\>\""}], 
           ",", 
           RowBox[{"4", "\[Rule]", 
            RowBox[{"Style", "[", 
             RowBox[{"\"\<(4) mixing point composition\>\"", ",", "colM"}], 
             "]"}]}], ",", 
           RowBox[{"5", "\[Rule]", "\"\<(5) mixing point composition\>\""}], 
           ",", 
           RowBox[{"6", "\[Rule]", "\"\<(6) outlet streams\>\""}]}], 
          "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"Dynamic", "@", "midland"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PaneSelector", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"##", "&"}], "@@", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}], 
             "\[Rule]", 
             RowBox[{"Button", "[", 
              RowBox[{"\"\< next \>\"", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"1", "\[LessEqual]", "midland", "<", "6"}], ",", 
                   RowBox[{"midland", "=", 
                    RowBox[{"midland", "+", "1"}]}], ",", 
                   RowBox[{"midland", "=", "6"}]}], "]"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"midland", "\[Equal]", "midland"}], ",", 
                   RowBox[{"solution", "=", "False"}]}], "]"}]}], "}"}]}], 
              "]"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"Dynamic", "@", "midland"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"midland", ",", "1", ",", "\"\<\>\""}], "}"}], ",", 
          RowBox[{"Range", "@", "6"}], ",", "None"}], "}"}], "]"}], ",", 
       RowBox[{"Spacer", "@", "15"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"solution", ",", "False", ",", "\"\<solution\>\""}], "}"}],
           ",", 
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}], ",", 
          RowBox[{"Enabled", "\[Rule]", 
           RowBox[{"If", "[", 
            RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}], "}"}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"reset", ",", "1"}], "}"}], ",", "1", ",", "1000", ",", 
          "1", ",", "None"}], "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
     "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"Grid", "@", 
    RowBox[{"{", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PaneSelector", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"5", "\[Rule]", 
           RowBox[{"Row", "@", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"\"\<mass percent (%):\>\"", ",", 
              RowBox[{"Spacer", "@", "5"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Control", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"wtA", ",", "80", ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<solute\>\"", ",", "colA"}], "]"}]}], "}"}], 
                 ",", "0", ",", "100", ",", "1", ",", 
                 RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                 RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                 RowBox[{"Enabled", "\[Rule]", 
                  RowBox[{"If", "[", 
                   RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}],
                 "}"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Control", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"wtC", ",", "20", ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<carrier\>\"", ",", "colC"}], "]"}]}], "}"}], 
                 ",", "0", ",", "100", ",", "1", ",", 
                 RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                 RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                 RowBox[{"Enabled", "\[Rule]", 
                  RowBox[{"If", "[", 
                   RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}],
                 "}"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Control", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"wtS", ",", "0", ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<solvent\>\"", ",", "colS"}], "]"}]}], "}"}], 
                 ",", "0", ",", "100", ",", "1", ",", 
                 RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
                 RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
                 RowBox[{"Enabled", "\[Rule]", 
                  RowBox[{"If", "[", 
                   RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}],
                 "}"}], "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "}"}], ",", 
         RowBox[{"Dynamic", "@", "midland"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PaneSelector", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", 
            RowBox[{"Control", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"feed", ",", 
                 RowBox[{"{", 
                  RowBox[{"0.5", ",", 
                   RowBox[{"0.7", "*", 
                    RowBox[{
                    SqrtBox["3"], "/", "2"}]}]}], "}"}]}], "}"}], ",", 
               "Locator", ",", 
               RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
               RowBox[{"Enabled", "\[Rule]", 
                RowBox[{"If", "[", 
                 RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}], 
              "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"2", "\[Rule]", 
            RowBox[{"Control", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"solvent", ",", 
                 RowBox[{"{", 
                  RowBox[{"0.5", ",", 
                   RowBox[{"0.7", "*", 
                    RowBox[{
                    SqrtBox["3"], "/", "2"}]}]}], "}"}]}], "}"}], ",", 
               "Locator", ",", 
               RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
               RowBox[{"Enabled", "\[Rule]", 
                RowBox[{"If", "[", 
                 RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}], 
              "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"3", "\[Rule]", 
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Control", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"line1", ",", 
                    RowBox[{"{", 
                    RowBox[{"0.35", ",", 
                    RowBox[{"0.6", "*", 
                    RowBox[{
                    SqrtBox["3"], "/", "2"}]}]}], "}"}]}], "}"}], ",", 
                  "Locator", ",", 
                  RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
                  RowBox[{"Enabled", "\[Rule]", 
                   RowBox[{"If", "[", 
                    RowBox[{"solution", ",", "False", ",", "True"}], 
                    "]"}]}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Control", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"line2", ",", 
                    RowBox[{"{", 
                    RowBox[{"0.65", ",", 
                    RowBox[{"0.6", "*", 
                    RowBox[{
                    SqrtBox["3"], "/", "2"}]}]}], "}"}]}], "}"}], ",", 
                  "Locator", ",", 
                  RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
                  RowBox[{"Enabled", "\[Rule]", 
                   RowBox[{"If", "[", 
                    RowBox[{"solution", ",", "False", ",", "True"}], 
                    "]"}]}]}], "}"}], "]"}]}], "}"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"4", "\[Rule]", 
            RowBox[{"Control", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"mixing", ",", 
                 RowBox[{"{", 
                  RowBox[{"0.5", ",", 
                   RowBox[{"0.7", "*", 
                    RowBox[{
                    SqrtBox["3"], "/", "2"}]}]}], "}"}]}], "}"}], ",", 
               "Locator", ",", 
               RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
               RowBox[{"Enabled", "\[Rule]", 
                RowBox[{"If", "[", 
                 RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}], 
              "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"6", "\[Rule]", 
            RowBox[{"Row", "@", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Control", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"outletE", ",", 
                    RowBox[{"{", 
                    RowBox[{"0.2", ",", 
                    RowBox[{"0.1", "*", 
                    RowBox[{
                    SqrtBox["3"], "/", "2"}]}]}], "}"}]}], "}"}], ",", 
                  "Locator", ",", 
                  RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
                  RowBox[{"Enabled", "\[Rule]", 
                   RowBox[{"If", "[", 
                    RowBox[{"solution", ",", "False", ",", "True"}], 
                    "]"}]}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Control", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"outletR", ",", 
                    RowBox[{"{", 
                    RowBox[{"0.6", ",", 
                    RowBox[{"0.4", "*", 
                    RowBox[{
                    SqrtBox["3"], "/", "2"}]}]}], "}"}]}], "}"}], ",", 
                  "Locator", ",", 
                  RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
                  RowBox[{"Enabled", "\[Rule]", 
                   RowBox[{"If", "[", 
                    RowBox[{"solution", ",", "False", ",", "True"}], 
                    "]"}]}]}], "}"}], "]"}]}], "}"}]}]}]}], 
          "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"Dynamic", "@", "midland"}]}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"SaveDefinitions", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7210642778616805`*^9, 3.721064328182559*^9}, {
   3.721064399574642*^9, 3.721064402633817*^9}, {3.721401203775211*^9, 
   3.721401208381236*^9}, 3.7214013871977744`*^9, {3.7214014233937783`*^9, 
   3.721401909495569*^9}, {3.721401941840125*^9, 3.7214020151395073`*^9}, {
   3.7214021624186783`*^9, 3.721402199185676*^9}, {3.721494645253101*^9, 
   3.7214946512597275`*^9}, {3.7217474637460384`*^9, 
   3.7217475024493933`*^9}, {3.721747547635855*^9, 3.721747623868722*^9}, {
   3.721747690211033*^9, 3.721747859706359*^9}, {3.721747939690862*^9, 
   3.721748062905733*^9}, {3.7217481137072306`*^9, 3.7217481159106536`*^9}, {
   3.72174820333362*^9, 3.721748222015686*^9}, {3.7217483013447247`*^9, 
   3.7217483397320876`*^9}, {3.721748377604399*^9, 3.721748421907242*^9}, 
   3.721748465483857*^9, 3.721748503275962*^9, {3.7217487886106477`*^9, 
   3.721748790658885*^9}, {3.7217488365062943`*^9, 3.721748837954506*^9}, {
   3.721748884954175*^9, 3.7217489296304007`*^9}, {3.7217490641542616`*^9, 
   3.7217491093308864`*^9}, {3.7220997363650737`*^9, 
   3.7220997376386757`*^9}, {3.7221003268635807`*^9, 
   3.7221003376752305`*^9}, {3.722346810750189*^9, 3.722346972460581*^9}, {
   3.722347016976879*^9, 3.722347041183814*^9}, {3.722349878996103*^9, 
   3.722349893739946*^9}, {3.7223499483960724`*^9, 3.722349952137286*^9}, {
   3.7223499872622952`*^9, 3.7223499912055206`*^9}, {3.72235004031633*^9, 
   3.722350185732647*^9}, {3.7281387632600946`*^9, 3.728138768458392*^9}, {
   3.728138923519261*^9, 3.728138945638526*^9}, {3.728138980185502*^9, 
   3.728138986006835*^9}, {3.7287578094998693`*^9, 3.728757852079305*^9}, {
   3.728917901406088*^9, 3.7289179416923923`*^9}, {3.7289179821080933`*^9, 
   3.7289180080332394`*^9}, {3.728918040455593*^9, 3.728918135944685*^9}, {
   3.728918179092107*^9, 3.7289183010985217`*^9}, {3.7289183447447476`*^9, 
   3.728918368112671*^9}, {3.7289184012240376`*^9, 3.72891844014524*^9}, {
   3.7289184990052805`*^9, 3.728918558432655*^9}, {3.728918651143136*^9, 
   3.728918652641739*^9}, {3.7290057325061517`*^9, 3.72900573341457*^9}, {
   3.729005807688551*^9, 3.729005835151501*^9}, {3.729005866315662*^9, 
   3.7290059649597836`*^9}, {3.7290060269414988`*^9, 3.729006189516184*^9}, 
   3.729008671468998*^9, {3.729008709655404*^9, 3.729008725505683*^9}, {
   3.72901366756355*^9, 3.7290136824926343`*^9}, 3.7293431252478323`*^9, {
   3.7293482897493906`*^9, 3.7293483066098394`*^9}, 3.729348351424667*^9, 
   3.72934838659744*^9},
 CellID->429302332,ExpressionUUID->"ae3f0cb4-ab4b-475c-a08d-473f49a7ef24"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`feed$$ = {0.5, 
    0.606217782649107}, $CellContext`line1$$ = {0.35, 
    0.5196152422706631}, $CellContext`line2$$ = {0.65, 
    0.5196152422706631}, $CellContext`midland$$ = 1, $CellContext`mixing$$ = {
    0.5, 0.606217782649107}, $CellContext`outletE$$ = {0.2, 
    0.08660254037844387}, $CellContext`outletR$$ = {0.6, 
    0.34641016151377546`}, $CellContext`reset$$ = 1, $CellContext`solution$$ =
     False, $CellContext`solvent$$ = {0.5, 
    0.606217782649107}, $CellContext`wtA$$ = 80, $CellContext`wtC$$ = 
    20, $CellContext`wtS$$ = 0, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[
       Style[
        PaneSelector[{
         1 -> "step 1: move the point to the correct feed composition", 2 -> 
          "step 2: move the point to the correct solvent composition", 3 -> 
          "step 3: draw a line connecting feed and solvent compositions", 4 -> 
          "step 4: move the point to the correct mixing point location", 5 -> 
          "step 5: use sliders to set the correct mass percentages of the \
mixing point", 6 -> "step 6: determine outlet compositions"}, 
         Dynamic[$CellContext`midland$$]], Bold]], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`midland$$], 1, ""}, {1, 2, 3, 4, 5, 6}}, {{
       Hold[$CellContext`solution$$], False, "solution"}, {True, False}}, {{
       Hold[$CellContext`reset$$], 1}, 1, 1000, 1}, {
      Hold[
       Grid[{{
          Button[" new problem ", {
            
            If[$CellContext`reset$$ < 
             1000, $CellContext`reset$$ = $CellContext`reset$$ + 
              1, $CellContext`reset$$ = $CellContext`reset$$ - 
              1], $CellContext`midland$$ = 
            1, $CellContext`feed$$ = {
             0.5, 0.7 (Sqrt[3]/2)}, $CellContext`solvent$$ = {
             0.5, 0.7 (Sqrt[3]/2)}, $CellContext`line1$$ = {
             0.35, 0.6 (Sqrt[3]/2)}, $CellContext`line2$$ = {
             0.65, 0.6 (Sqrt[3]/2)}, $CellContext`mixing$$ = {
             0.5, 0.7 (Sqrt[3]/2)}, 
            
            If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 
          PaneSelector[{1 -> Style["(1) feed composition", 
              RGBColor[1, 0.4, 0]], 2 -> Style["(2) solvent composition", 
              RGBColor[0, 0.6, 0]], 3 -> "(3) draw mass balance line", 4 -> 
            Style["(4) mixing point composition", 
              RGBColor[0.5, 0, 0.5]], 5 -> "(5) mixing point composition", 6 -> 
            "(6) outlet streams"}, 
           Dynamic[$CellContext`midland$$]], 
          PaneSelector[{1 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`midland$$, Less, 
                 6], $CellContext`midland$$ = $CellContext`midland$$ + 
                 1, $CellContext`midland$$ = 6], 
               
               If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 2 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`midland$$, Less, 
                 6], $CellContext`midland$$ = $CellContext`midland$$ + 
                 1, $CellContext`midland$$ = 6], 
               
               If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 3 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`midland$$, Less, 
                 6], $CellContext`midland$$ = $CellContext`midland$$ + 
                 1, $CellContext`midland$$ = 6], 
               
               If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 4 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`midland$$, Less, 
                 6], $CellContext`midland$$ = $CellContext`midland$$ + 
                 1, $CellContext`midland$$ = 6], 
               
               If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 5 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`midland$$, Less, 
                 6], $CellContext`midland$$ = $CellContext`midland$$ + 
                 1, $CellContext`midland$$ = 6], 
               
               If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}]}, 
           Dynamic[$CellContext`midland$$]], 
          Manipulate`Place[1], 
          Spacer[15], 
          Manipulate`Place[2], 
          Manipulate`Place[3]}}]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`wtA$$], 80, 
       Style["solute", 
        RGBColor[0, 0, 1]]}, 0, 100, 1}, {{
       Hold[$CellContext`wtC$$], 20, 
       Style["carrier", 
        RGBColor[0.8, 0, 0.01]]}, 0, 100, 1}, {{
       Hold[$CellContext`wtS$$], 0, 
       Style["solvent", 
        RGBColor[0, 0.6, 0]]}, 0, 100, 1}, {{
       Hold[$CellContext`feed$$], {0.5, 0.606217782649107}}, Automatic}, {{
       Hold[$CellContext`solvent$$], {0.5, 0.606217782649107}}, Automatic}, {{
       Hold[$CellContext`line1$$], {0.35, 0.5196152422706631}}, Automatic}, {{
       Hold[$CellContext`line2$$], {0.65, 0.5196152422706631}}, Automatic}, {{
       Hold[$CellContext`mixing$$], {0.5, 0.606217782649107}}, Automatic}, {{
       Hold[$CellContext`outletE$$], {0.2, 0.08660254037844387}}, 
      Automatic}, {{
       Hold[$CellContext`outletR$$], {0.6, 0.34641016151377546`}}, 
      Automatic}, {
      Hold[
       Grid[{{
          PaneSelector[{5 -> Row[{"mass percent (%):", 
               Spacer[5], 
               Manipulate`Place[4], 
               Manipulate`Place[5], 
               Manipulate`Place[6]}]}, 
           Dynamic[$CellContext`midland$$]], 
          
          PaneSelector[{
           1 -> Manipulate`Place[7], 2 -> Manipulate`Place[8], 3 -> Row[{
               Manipulate`Place[9], 
               Manipulate`Place[10]}], 4 -> Manipulate`Place[11], 6 -> Row[{
               Manipulate`Place[12], 
               Manipulate`Place[13]}]}, 
           Dynamic[$CellContext`midland$$]]}}]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    600., {192., 198.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`midland$124421$$ = 
    0, $CellContext`solution$124422$$ = False, $CellContext`reset$124423$$ = 
    0, $CellContext`wtA$124424$$ = 0, $CellContext`wtC$124425$$ = 
    0, $CellContext`wtS$124426$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`feed$$ = {0.5, 
         0.606217782649107}, $CellContext`line1$$ = {0.35, 
         0.5196152422706631}, $CellContext`line2$$ = {0.65, 
         0.5196152422706631}, $CellContext`midland$$ = 
        1, $CellContext`mixing$$ = {0.5, 
         0.606217782649107}, $CellContext`outletE$$ = {0.2, 
         0.08660254037844387}, $CellContext`outletR$$ = {0.6, 
         0.34641016151377546`}, $CellContext`reset$$ = 
        1, $CellContext`solution$$ = 
        False, $CellContext`solvent$$ = {0.5, 
         0.606217782649107}, $CellContext`wtA$$ = 80, $CellContext`wtC$$ = 
        20, $CellContext`wtS$$ = 0}, "ControllerVariables" :> {
        Hold[$CellContext`midland$$, $CellContext`midland$124421$$, 0], 
        Hold[$CellContext`solution$$, $CellContext`solution$124422$$, False], 
        Hold[$CellContext`reset$$, $CellContext`reset$124423$$, 0], 
        Hold[$CellContext`wtA$$, $CellContext`wtA$124424$$, 0], 
        Hold[$CellContext`wtC$$, $CellContext`wtC$124425$$, 0], 
        Hold[$CellContext`wtS$$, $CellContext`wtS$124426$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`part$, $CellContext`phase$, $CellContext`tie$, \
$CellContext`feedA$, $CellContext`feedC$, $CellContext`feedS$, \
$CellContext`FtoS$, $CellContext`mF$, $CellContext`mS$, $CellContext`mM$, \
$CellContext`xM$, $CellContext`massA$, $CellContext`massC$, \
$CellContext`massS$, $CellContext`func1$, $CellContext`func2$, \
$CellContext`xmix$, $CellContext`ymix$, $CellContext`tieline$, \
$CellContext`lower$, $CellContext`upper$, $CellContext`lever$, \
$CellContext`newtie$, $CellContext`x1$, $CellContext`x2$}, 
        SeedRandom[$CellContext`reset$$]; $CellContext`part$ = 
         RandomInteger[{1, 5}]; $CellContext`phase$ = 
         Part[{$CellContext`phase1, $CellContext`phase2, $CellContext`phase3, \
$CellContext`phase4, $CellContext`phase5}, $CellContext`part$]; \
$CellContext`tie$ = 
         Part[{$CellContext`tie1, $CellContext`tie2, $CellContext`tie3, \
$CellContext`tie4, $CellContext`tie5}, $CellContext`part$]; \
$CellContext`feedA$ = RandomInteger[{25, 55}]; $CellContext`feedC$ = 
         100 - $CellContext`feedA$; $CellContext`feedS$ = 
         100 - $CellContext`feedA$ - $CellContext`feedC$; $CellContext`FtoS$ = 
         RandomReal[{0.1, 5}]; $CellContext`mF$ = 
         50; $CellContext`mS$ = $CellContext`mF$/$CellContext`FtoS$; \
$CellContext`mM$ = $CellContext`mF$ + $CellContext`mS$; $CellContext`xM$ = \
$CellContext`mS$/($CellContext`mF$ + $CellContext`mS$); $CellContext`massA$ = \
($CellContext`mF$/($CellContext`mF$ + $CellContext`mS$)) ($CellContext`feedA$/
           100); $CellContext`massC$ = ($CellContext`mF$/($CellContext`mF$ + \
$CellContext`mS$)) ($CellContext`feedC$/
           100); $CellContext`massS$ = $CellContext`mS$/($CellContext`mF$ + \
$CellContext`mS$); $CellContext`func1$[
           Pattern[$CellContext`x$, 
            Blank[]]] := (-
            Sqrt[3]) ($CellContext`x$ - (1 - $CellContext`xM$) (Sqrt[3]/2)/
            Tan[$CellContext`\[Theta]]) + (1 - $CellContext`xM$) (Sqrt[3]/
            2); $CellContext`func2$[
           Pattern[$CellContext`x$, 
            Blank[]]] := ((($CellContext`feedA$/100) (Sqrt[3]/2))/(
            1 - ($CellContext`feedA$/100) ((Sqrt[3]/2)/
             Tan[$CellContext`\[Theta]]))) ($CellContext`x$ - (
            1 - ($CellContext`feedA$/100) ((Sqrt[3]/2)/
             Tan[$CellContext`\[Theta]]))) + ($CellContext`feedA$/100) (
            Sqrt[3]/2); $CellContext`xmix$ = ReplaceAll[$CellContext`x, 
           Quiet[
            Part[
             
             Solve[$CellContext`func1$[$CellContext`x] == \
$CellContext`func2$[$CellContext`x], $CellContext`x], 
             1]]]; $CellContext`ymix$ = \
$CellContext`func1$[$CellContext`xmix$]; $CellContext`tieline$[
           Pattern[$CellContext`list, 
            Blank[]], 
           Pattern[$CellContext`line, 
            Blank[]], 
           Pattern[$CellContext`x, 
            Blank[]]] := ReplaceAll[
           Fit[
            Part[$CellContext`list, $CellContext`line], {
            1, $CellContext`z}, $CellContext`z], $CellContext`z -> \
$CellContext`x]; $CellContext`lower$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Which[$CellContext`ymix$ <= $CellContext`tieline$[$CellContext`tie$, 
             1, $CellContext`xmix$], 0, 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 1, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 1, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 4, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 4, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 5, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 
            4, $CellContext`x$], $CellContext`tieline$[$CellContext`tie$, 
             5, $CellContext`xmix$] < $CellContext`ymix$, 
           $CellContext`tieline$[$CellContext`tie$, 
            5, $CellContext`x$]]; $CellContext`upper$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Which[$CellContext`ymix$ <= $CellContext`tieline$[$CellContext`tie$, 
             1, $CellContext`xmix$], 
           $CellContext`tieline$[$CellContext`tie$, 1, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 1, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 4, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 4, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 4, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 5, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 
            5, $CellContext`x$], $CellContext`tieline$[$CellContext`tie$, 
             5, $CellContext`xmix$] < $CellContext`ymix$, 
           $CellContext`tieline$[$CellContext`tie$, 
            5, $CellContext`x$]]; $CellContext`lever$ = 
         If[$CellContext`ymix$ > $CellContext`tieline$[$CellContext`tie$, 
             5, $CellContext`xmix$], 
           1, ($CellContext`ymix$ - \
$CellContext`lower$[$CellContext`xmix$])/($CellContext`upper$[$CellContext`\
xmix$] - $CellContext`lower$[$CellContext`xmix$])]; $CellContext`newtie$[
           Pattern[$CellContext`x$, 
            Blank[]]] := (
            1 - $CellContext`lever$) $CellContext`lower$[$CellContext`x$] + \
$CellContext`lever$ $CellContext`upper$[$CellContext`x$]; $CellContext`x1$ = 
         ReplaceAll[$CellContext`x, 
           
           FindRoot[$CellContext`newtie$[$CellContext`x] == 
            Interpolation[$CellContext`phase$][$CellContext`x], \
{$CellContext`x, 0.1}]]; $CellContext`x2$ = ReplaceAll[$CellContext`x, 
           
           FindRoot[$CellContext`newtie$[$CellContext`x] == 
            Interpolation[$CellContext`phase$][$CellContext`x], \
{$CellContext`x, 0.9}]]; If[$CellContext`ymix$ > Quiet[
            
            Interpolation[$CellContext`phase$][$CellContext`xmix$]], \
$CellContext`reset$$ = $CellContext`reset$$ + 1]; 
        Show[$CellContext`gridlines, $CellContext`diagram, 
          PlotRange -> {{-0.25, 1.25}, {-0.2, 0.95}}, ImageSize -> {600, 390},
           Epilog -> {{Thick, 
             Line[
              Map[{#, 
                Interpolation[$CellContext`phase$][#]}& , 
               Range[
                Part[$CellContext`phase$, 1, 1], 
                Part[$CellContext`phase$, -1, 1], 0.01]]], 
             Line[$CellContext`tie$]}, 
            If[$CellContext`midland$$ == 1, {
              Text[
               Style[
                Column[{"mass % in feed", 
                  Framed[
                   Column[{
                    Row[{"solute = ", $CellContext`feedA$, "%"}], 
                    Row[{"carrier = ", $CellContext`feedC$, "%"}], 
                    Row[{"solvent = ", $CellContext`feedS$, "%"}]}, Alignment -> 
                    "="], Background -> White]}, Center], 17], {
               0, 0.9 (Sqrt[3]/2)}], 
              $CellContext`pt2[$CellContext`feed$$, $CellContext`colF], 
              Text[
               Style[
               "feed", 17, $CellContext`colF, Background -> 
                White], $CellContext`feed$$, {0, -1.75}], 
              If[$CellContext`solution$$, 
               $CellContext`pt1[{
                1 - ($CellContext`feedA$/100) (Sqrt[3]/2)/
                 Tan[$CellContext`\[Theta]], ($CellContext`feedA$/100) (
                  Sqrt[3]/2)}, $CellContext`colF]]}], 
            If[$CellContext`midland$$ > 1, {
              $CellContext`pt1[{
               1 - ($CellContext`feedA$/100) (Sqrt[3]/2)/
                Tan[$CellContext`\[Theta]], ($CellContext`feedA$/100) (
                 Sqrt[3]/2)}, $CellContext`colF], 
              Text[
               Style[" F ", 17, $CellContext`colF, Background -> White], {
               1 - ($CellContext`feedA$/100) (Sqrt[3]/2)/
                Tan[$CellContext`\[Theta]], ($CellContext`feedA$/100) (
                 Sqrt[3]/2)}, {0, -2}]}], 
            If[$CellContext`midland$$ == 2, {
              Text[
               Style[
                Column[{"mass % in solvent", 
                  Framed[
                   Column[{
                    Row[{"solute = ", 0, "%"}], 
                    Row[{"carrier = ", 0, "%"}], 
                    Row[{"solvent = ", 100, "%"}]}, Alignment -> "="], 
                   Background -> White]}, Center], 17], {0, 0.9 (Sqrt[3]/2)}], 
              $CellContext`pt2[$CellContext`solvent$$, $CellContext`colS], 
              Text[
               Style[
               "solvent", 17, $CellContext`colS, Background -> 
                White], $CellContext`solvent$$, {0, -1.75}], 
              If[$CellContext`solution$$, 
               $CellContext`pt1[{0, 0}, $CellContext`colS]]}], 
            If[$CellContext`midland$$ > 2, {
              $CellContext`pt1[{0, 0}, $CellContext`colS], 
              Text[
               Style["S", 17, $CellContext`colS, Background -> White], {0, 
               0}, {0, -2}]}], 
            If[$CellContext`midland$$ == 3, {{
               Thickness[0.007], 
               CapForm[None], Dashed, Magenta, 
               Line[{$CellContext`line1$$, $CellContext`line2$$}]}, 
              $CellContext`pt2[$CellContext`line1$$, Magenta], 
              $CellContext`pt2[$CellContext`line2$$, Magenta], 
              If[$CellContext`solution$$, {
                Thickness[0.007], 
                CapForm[None], Magenta, 
                
                Line[{{0, 0}, {
                  1 - ($CellContext`feedA$/100) ((Sqrt[3]/2)/
                    Tan[$CellContext`\[Theta]]), ($CellContext`feedA$/100) (
                    Sqrt[3]/2)}}]}]}], 
            If[$CellContext`midland$$ > 3, {
              Thickness[0.007], 
              CapForm[None], Magenta, 
              
              Line[{{0, 0}, {
                1 - ($CellContext`feedA$/100) ((Sqrt[3]/2)/
                  Tan[$CellContext`\[Theta]]), ($CellContext`feedA$/100) (
                  Sqrt[3]/2)}}]}], 
            If[$CellContext`midland$$ == 4, {
              $CellContext`pt2[$CellContext`mixing$$, $CellContext`colM], 
              Text[
               Style[
               "mixing", 17, $CellContext`colM, Background -> 
                White], $CellContext`mixing$$, {0, -1.75}], 
              If[$CellContext`solution$$ == False, 
               Text[
                Style[
                 Column[{"mass flow (kg/h)", 
                   Framed[
                    Column[{
                    Row[{"feed = ", 
                    NumberForm[$CellContext`mF$, {5, 1}]}], 
                    Row[{"solvent = ", 
                    NumberForm[$CellContext`mS$, {5, 1}]}]}, Alignment -> 
                    "="], Background -> White], 
                   Row[{
                    Style["F", Italic], "/", 
                    Style["S", Italic], " = ", 
                    NumberForm[$CellContext`FtoS$, {5, 1}]}]}, Center], 17], {
                1, 0.9 (Sqrt[3]/2)}]], 
              If[$CellContext`solution$$, 
               $CellContext`pt1[{$CellContext`xmix$, 
                 $CellContext`func1$[$CellContext`xmix$]}, \
$CellContext`colM]]}], 
            If[$CellContext`midland$$ > 4, {
              $CellContext`pt1[{$CellContext`xmix$, 
                $CellContext`func1$[$CellContext`xmix$]}, $CellContext`colM], 
              Text[
               Style[
               "M", 17, $CellContext`colM, Background -> 
                White], {$CellContext`xmix$, 
                $CellContext`func1$[$CellContext`xmix$]}, {0, -2}]}], 
            If[$CellContext`midland$$ == 5, {
              If[$CellContext`solution$$, 
               Text[
                Framed[
                 Style[
                  Column[{
                    Style[
                    Row[{"solute = ", 
                    NumberForm[$CellContext`massA$ 100, {4, 0}], 
                    "%"}], $CellContext`colA], 
                    Style[
                    Row[{"carrier = ", 
                    NumberForm[$CellContext`massC$ 100, {4, 0}], 
                    "%"}], $CellContext`colC], 
                    Style[
                    Row[{"solvent = ", 
                    NumberForm[$CellContext`massS$ 100, {4, 0}], 
                    "%"}], $CellContext`colS]}, Alignment -> "="], 17], 
                 Background -> White], {1, 0.9 (Sqrt[3]/2)}]], 
              If[$CellContext`solution$$ == False, 
               Text[
                Style[
                 Column[{"mass flow (kg/h)", 
                   Framed[
                    Column[{
                    Row[{"feed = ", 
                    NumberForm[$CellContext`mF$, {5, 1}]}], 
                    Row[{"solvent = ", 
                    NumberForm[$CellContext`mS$, {5, 1}]}]}, Alignment -> 
                    "="], Background -> White], 
                   Row[{
                    Style["F", Italic], "/", 
                    Style["S", Italic], " = ", 
                    NumberForm[$CellContext`FtoS$, {5, 1}]}]}, Center], 17], {
                1, 0.9 (Sqrt[3]/2)}]]}], 
            If[$CellContext`midland$$ == 6, {{Thick, Dashed, 
               Line[{$CellContext`outletE$$, $CellContext`outletR$$}]}, 
              $CellContext`pt2[$CellContext`outletE$$, $CellContext`colE], 
              $CellContext`pt2[$CellContext`outletR$$, $CellContext`colR], 
              Apply[If[$CellContext`solution$$ == False, 
                Text[
                 Style[#, 17, #2, Background -> White], #3, {0, -1.75}]]& , {{
                "extract", $CellContext`colE, $CellContext`outletE$$}, {
                "raffinate", $CellContext`colR, $CellContext`outletR$$}}, {
               1}], 
              If[$CellContext`solution$$, {
                Thickness[0.0075], Dashed, Orange, 
                Line[
                 Map[{#, 
                   $CellContext`newtie$[#]}& , 
                  Range[$CellContext`x1$, $CellContext`x2$, 0.01]]], 
                $CellContext`pt1[{$CellContext`x1$, 
                  $CellContext`newtie$[$CellContext`x1$]}, $CellContext`colE], 
                $CellContext`pt1[{$CellContext`x2$, 
                  $CellContext`newtie$[$CellContext`x2$]}, $CellContext`colR], 
                Text[
                 Style[
                 "E", 17, $CellContext`colE, Background -> 
                  White], {$CellContext`x1$, 
                  $CellContext`newtie$[$CellContext`x1$]}, {0, -1.75}], 
                Text[
                 Style[
                 "R", 17, $CellContext`colR, Background -> 
                  White], {$CellContext`x2$, 
                  $CellContext`newtie$[$CellContext`x2$]}, {0, -1.75}]}]}]}]],
       "Specifications" :> {
        Style[
         PaneSelector[{
          1 -> "step 1: move the point to the correct feed composition", 2 -> 
           "step 2: move the point to the correct solvent composition", 3 -> 
           "step 3: draw a line connecting feed and solvent compositions", 4 -> 
           "step 4: move the point to the correct mixing point location", 5 -> 
           "step 5: use sliders to set the correct mass percentages of the \
mixing point", 6 -> "step 6: determine outlet compositions"}, 
          Dynamic[$CellContext`midland$$]], 
         Bold], {{$CellContext`midland$$, 1, ""}, {1, 2, 3, 4, 5, 6}, 
         ControlType -> None, ControlPlacement -> 
         1}, {{$CellContext`solution$$, False, "solution"}, {True, False}, 
         Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         2}, {{$CellContext`reset$$, 1}, 1, 1000, 1, ControlType -> None, 
         ControlPlacement -> 3}, 
        Grid[{{
           Button[" new problem ", {
             
             If[$CellContext`reset$$ < 
              1000, $CellContext`reset$$ = $CellContext`reset$$ + 
               1, $CellContext`reset$$ = $CellContext`reset$$ - 
               1], $CellContext`midland$$ = 
             1, $CellContext`feed$$ = {
              0.5, 0.7 (Sqrt[3]/2)}, $CellContext`solvent$$ = {
              0.5, 0.7 (Sqrt[3]/2)}, $CellContext`line1$$ = {
              0.35, 0.6 (Sqrt[3]/2)}, $CellContext`line2$$ = {
              0.65, 0.6 (Sqrt[3]/2)}, $CellContext`mixing$$ = {
              0.5, 0.7 (Sqrt[3]/2)}, 
             
             If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 
           PaneSelector[{1 -> Style["(1) feed composition", 
               RGBColor[1, 0.4, 0]], 2 -> Style["(2) solvent composition", 
               RGBColor[0, 0.6, 0]], 3 -> "(3) draw mass balance line", 4 -> 
             Style["(4) mixing point composition", 
               RGBColor[0.5, 0, 0.5]], 5 -> "(5) mixing point composition", 6 -> 
             "(6) outlet streams"}, 
            Dynamic[$CellContext`midland$$]], 
           PaneSelector[{1 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`midland$$, Less, 
                  6], $CellContext`midland$$ = $CellContext`midland$$ + 
                  1, $CellContext`midland$$ = 6], 
                
                If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 2 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`midland$$, Less, 
                  6], $CellContext`midland$$ = $CellContext`midland$$ + 
                  1, $CellContext`midland$$ = 6], 
                
                If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 3 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`midland$$, Less, 
                  6], $CellContext`midland$$ = $CellContext`midland$$ + 
                  1, $CellContext`midland$$ = 6], 
                
                If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 4 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`midland$$, Less, 
                  6], $CellContext`midland$$ = $CellContext`midland$$ + 
                  1, $CellContext`midland$$ = 6], 
                
                If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 5 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`midland$$, Less, 
                  6], $CellContext`midland$$ = $CellContext`midland$$ + 
                  1, $CellContext`midland$$ = 6], 
                
                If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}]}, 
            Dynamic[$CellContext`midland$$]], 
           Manipulate`Place[1], 
           Spacer[15], 
           Manipulate`Place[2], 
           Manipulate`Place[3]}}], {{$CellContext`wtA$$, 80, 
          Style["solute", 
           RGBColor[0, 0, 1]]}, 0, 100, 1, Appearance -> "Labeled", ImageSize -> 
         Tiny, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         4}, {{$CellContext`wtC$$, 20, 
          Style["carrier", 
           RGBColor[0.8, 0, 0.01]]}, 0, 100, 1, Appearance -> "Labeled", 
         ImageSize -> Tiny, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         5}, {{$CellContext`wtS$$, 0, 
          Style["solvent", 
           RGBColor[0, 0.6, 0]]}, 0, 100, 1, Appearance -> "Labeled", 
         ImageSize -> Tiny, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         6}, {{$CellContext`feed$$, {0.5, 0.606217782649107}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         7}, {{$CellContext`solvent$$, {0.5, 0.606217782649107}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         8}, {{$CellContext`line1$$, {0.35, 0.5196152422706631}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         9}, {{$CellContext`line2$$, {0.65, 0.5196152422706631}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         10}, {{$CellContext`mixing$$, {0.5, 0.606217782649107}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         11}, {{$CellContext`outletE$$, {0.2, 0.08660254037844387}}, 
         Automatic, ControlType -> Locator, Appearance -> None, Enabled -> 
         Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         12}, {{$CellContext`outletR$$, {0.6, 0.34641016151377546`}}, 
         Automatic, ControlType -> Locator, Appearance -> None, Enabled -> 
         Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 13}, 
        Grid[{{
           PaneSelector[{5 -> Row[{"mass percent (%):", 
                Spacer[5], 
                Manipulate`Place[4], 
                Manipulate`Place[5], 
                Manipulate`Place[6]}]}, 
            Dynamic[$CellContext`midland$$]], 
           
           PaneSelector[{
            1 -> Manipulate`Place[7], 2 -> Manipulate`Place[8], 3 -> Row[{
                Manipulate`Place[9], 
                Manipulate`Place[10]}], 4 -> Manipulate`Place[11], 6 -> Row[{
                Manipulate`Place[12], 
                Manipulate`Place[13]}]}, 
            Dynamic[$CellContext`midland$$]]}}]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{655., {260., 267.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`phase = 
       InterpolatingFunction[{{0.08, 0.98}}, {
         5, 7, 0, {12}, {4}, 0, 0, 0, 0, Automatic, {}, {}, False}, {{0.08, 
         0.15, 0.19, 0.25, 0.33, 0.44, 0.61, 0.68, 0.77, 0.83, 0.88, 0.98}}, {
         Developer`PackedArrayForm, {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 
          12}, {0., 0.1, 0.17, 0.26, 0.37, 0.45, 0.46, 0.43, 0.35, 0.26, 0.17,
           0.}}, {Automatic}], $CellContext`phase1 = {{0.09, 0}, {0.17, 
         0.13}, {0.28, 0.3}, {0.41, 0.44}, {0.55, 0.47}, {0.7, 0.42}, {0.83, 
         0.26}, {0.98, 0}}, $CellContext`phase2 = {{0.0545, 0}, {0.136, 
         0.134}, {0.226, 0.267}, {0.3405, 0.36}, {0.534, 0.398}, {0.673, 
         0.338}, {0.7925, 0.232}, {0.956, 0}}, $CellContext`phase3 = {{
         0.098, 0}, {0.172, 0.126}, {0.2285, 0.213}, {0.422, 0.338}, {0.55, 
         0.352}, {0.7055, 0.284}, {0.7925, 0.205}, {
         0.92, 0}}, $CellContext`phase4 = {{0.07, 0}, {0.14, 0.14}, {0.26, 
         0.35}, {0.42, 0.56}, {0.56, 0.59}, {0.7, 0.42}, {0.82, 0.24}, {
         0.95, 0}}, $CellContext`phase5 = {{0, 0}, {0.12, 0.15}, {0.23, 
         0.32}, {0.34, 0.45}, {0.6, 0.5}, {0.69, 0.42}, {0.77, 0.3}, {
         0.93, 0}}, $CellContext`tie1 = {{{0.12, 0.052}, {0.93, 0.078}}, {{
        0.16, 0.104}, {0.88, 0.173}}, {{0.2, 0.173}, {0.83, 0.26}}, {{0.26, 
        0.268}, {0.77, 0.346}}, {{0.34, 0.372}, {0.67, 
        0.433}}}, $CellContext`tie2 = {{{0.1, 0.07}, {0.9, 0.09}}, {{0.13, 
        0.12}, {0.84, 0.17}}, {{0.17, 0.18}, {0.77, 0.25}}, {{0.2, 0.23}, {
        0.7, 0.32}}, {{0.24, 0.28}, {0.64, 0.36}}}, $CellContext`tie3 = {{{
        0.12, 0.03}, {0.89, 0.06}}, {{0.15, 0.09}, {0.86, 0.11}}, {{0.19, 
        0.15}, {0.82, 0.17}}, {{0.24, 0.23}, {0.72, 0.27}}, {{0.28, 0.27}, {
        0.65, 0.32}}}, $CellContext`tie4 = {{{0.1, 0.06}, {0.9, 0.1}}, {{0.15,
         0.15}, {0.84, 0.21}}, {{0.21, 0.26}, {0.75, 0.35}}, {{0.28, 0.37}, {
        0.67, 0.46}}, {{0.37, 0.51}, {0.59, 0.56}}}, $CellContext`tie5 = {{{
        0.065, 0.07}, {0.87, 0.11}}, {{0.11, 0.13}, {0.83, 0.2}}, {{0.17, 
        0.22}, {0.76, 0.32}}, {{0.24, 0.33}, {0.69, 0.41}}, {{0.33, 0.44}, {
        0.6, 0.5}}}, $CellContext`\[Theta] = 
       60 Degree, $CellContext`gridlines = Graphics[{
          GrayLevel[0.65], {{
            
            Line[{{0.025, 0.04330127018922193}, {0.975, 
             0.04330127018922193}}], 
            Line[{{0.05, 0}, {0.025, 0.04330127018922193}}], 
            Line[{{0.95, 0}, {0.975, 0.04330127018922193}}]}, {
            
            Line[{{0.07500000000000001, 0.1299038105676658}, {0.925, 
             0.1299038105676658}}], 
            
            Line[{{0.15000000000000002`, 0}, {0.07500000000000001, 
              0.1299038105676658}}], 
            Line[{{0.85, 0}, {0.925, 0.1299038105676658}}]}, {
            
            Line[{{0.125, 0.21650635094610965`}, {0.875, 
             0.21650635094610965`}}], 
            Line[{{0.25, 0}, {0.125, 0.21650635094610965`}}], 
            Line[{{0.75, 0}, {0.875, 0.21650635094610965`}}]}, {
            
            Line[{{0.17500000000000002`, 0.30310889132455354`}, {0.825, 
             0.30310889132455354`}}], 
            
            Line[{{0.35000000000000003`, 0}, {0.17500000000000002`, 
              0.30310889132455354`}}], 
            Line[{{0.6499999999999999, 0}, {0.825, 0.30310889132455354`}}]}, {
            Line[{{0.225, 0.3897114317029974}, {0.775, 0.3897114317029974}}], 
            Line[{{0.45, 0}, {0.225, 0.3897114317029974}}], 
            Line[{{0.55, 0}, {0.775, 0.3897114317029974}}]}, {
            Line[{{0.275, 0.4763139720814413}, {0.725, 0.4763139720814413}}], 
            Line[{{0.55, 0}, {0.275, 0.4763139720814413}}], 
            Line[{{0.44999999999999996`, 0}, {0.725, 0.4763139720814413}}]}, {
            
            Line[{{0.32500000000000007`, 0.5629165124598852}, {
             0.6749999999999999, 0.5629165124598852}}], 
            
            Line[{{0.6500000000000001, 0}, {0.32500000000000007`, 
              0.5629165124598852}}], 
            
            Line[{{0.34999999999999987`, 0}, {0.6749999999999999, 
              0.5629165124598852}}]}, {
            
            Line[{{0.37500000000000006`, 0.649519052838329}, {0.625, 
             0.649519052838329}}], 
            
            Line[{{0.7500000000000001, 0}, {0.37500000000000006`, 
              0.649519052838329}}], 
            Line[{{0.2499999999999999, 0}, {0.625, 0.649519052838329}}]}, {
            
            Line[{{0.42500000000000004`, 0.7361215932167728}, {0.575, 
             0.7361215932167728}}], 
            
            Line[{{0.8500000000000001, 0}, {0.42500000000000004`, 
              0.7361215932167728}}], 
            Line[{{0.1499999999999999, 0}, {0.575, 0.7361215932167728}}]}, {
            Line[{{0.475, 0.8227241335952167}, {0.525, 0.8227241335952167}}], 
            Line[{{0.95, 0}, {0.475, 0.8227241335952167}}], 
            
            Line[{{0.050000000000000044`, 0}, {0.525, 
              0.8227241335952167}}]}}, {{
            Line[{{0.05, 0.08660254037844387}, {0.97, 0.08660254037844387}}], 
            Line[{{0.1, 0}, {0.0485, 0.08920061658979718}}], 
            Line[{{0.88, -0.02}, {0.95, 0.08660254037844387}}]}, {
            Line[{{0.1, 0.17320508075688773`}, {0.92, 0.17320508075688773`}}], 
            Line[{{0.2, 0}, {0.097, 0.17840123317959436`}}], 
            Line[{{0.78, -0.02}, {0.9, 0.17320508075688773`}}]}, {
            
            Line[{{0.15000000000000002`, 0.2598076211353316}, {0.87, 
             0.2598076211353316}}], 
            
            Line[{{0.30000000000000004`, 0}, {0.14550000000000002`, 
              0.26760184976939155`}}], 
            Line[{{0.6799999999999999, -0.02}, {0.85, 0.2598076211353316}}]}, {
            
            Line[{{0.2, 0.34641016151377546`}, {0.8200000000000001, 
             0.34641016151377546`}}], 
            Line[{{0.4, 0}, {0.194, 0.3568024663591887}}], 
            Line[{{0.58, -0.02}, {0.8, 0.34641016151377546`}}]}, {
            Line[{{0.25, 0.4330127018922193}, {0.77, 0.4330127018922193}}], 
            Line[{{0.5, 0}, {0.2425, 0.4460030829489859}}], 
            Line[{{0.48, -0.02}, {0.75, 0.4330127018922193}}]}, {
            Line[{{0.3, 0.5196152422706631}, {0.72, 0.5196152422706631}}], 
            Line[{{0.6, 0}, {0.291, 0.535203699538783}}], 
            Line[{{0.38, -0.02}, {0.7, 0.5196152422706631}}]}, {
            
            Line[{{0.35000000000000003`, 0.6062177826491071}, {
             0.6699999999999999, 0.6062177826491071}}], 
            Line[{{0.7000000000000001, 0}, {0.3395, 0.6244043161285803}}], 
            
            Line[{{0.2799999999999999, -0.02}, {0.6499999999999999, 
             0.6062177826491071}}]}, {
            Line[{{0.4, 0.6928203230275509}, {0.62, 0.6928203230275509}}], 
            Line[{{0.8, 0}, {0.388, 0.7136049327183774}}], 
            
            Line[{{0.17999999999999994`, -0.02}, {0.6, 
             0.6928203230275509}}]}, {
            
            Line[{{0.45, 0.7794228634059948}, {0.5700000000000001, 
             0.7794228634059948}}], 
            Line[{{0.9, 0}, {0.4365, 0.8028055493081746}}], 
            
            Line[{{0.07999999999999996, -0.02}, {0.55, 
             0.7794228634059948}}]}}}], $CellContext`diagram = Graphics[{{
           EdgeForm[
            Thickness[Large]], 
           FaceForm[None], 
           Polygon[{{0, 0}, {0.5, Sqrt[3]/2}, {1, 0}}]}, {{
            RGBColor[0, 0, 1], 
            Text[
             Style[10., 16], {0.95, 0.08660254037844387}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[90., 16], (-60) Degree], {0.05, 0.08660254037844387}, {
             1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[10., 16], 60 Degree], {0.1, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[20., 16], {0.9, 0.17320508075688773`}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[80., 16], (-60) Degree], {0.1, 0.17320508075688773`}, {
             1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[20., 16], 60 Degree], {0.2, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[30.000000000000004`, 16], {0.85, 0.2598076211353316}, {-2, 
             0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[70., 16], (-60) Degree], {0.15000000000000002`, 
             0.2598076211353316}, {1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[30.000000000000004`, 16], 60 Degree], {
             0.30000000000000004`, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[40., 16], {0.8, 0.34641016151377546`}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[60., 16], (-60) Degree], {0.2, 0.34641016151377546`}, {
             1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[40., 16], 60 Degree], {0.4, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[50., 16], {0.75, 0.4330127018922193}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[50., 16], (-60) Degree], {0.25, 0.4330127018922193}, {
             1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[50., 16], 60 Degree], {0.5, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[60., 16], {0.7, 0.5196152422706631}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[40., 16], (-60) Degree], {0.3, 0.5196152422706631}, {
             1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[60., 16], 60 Degree], {0.6, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[70., 16], {0.6499999999999999, 0.6062177826491071}, {-2, 
             0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[29.999999999999993`, 16], (-60) Degree], {
             0.35000000000000003`, 0.6062177826491071}, {1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[70., 16], 60 Degree], {0.7000000000000001, 0}, {1.2, 
             1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[80., 16], {0.6, 0.6928203230275509}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[19.999999999999996`, 16], (-60) Degree], {0.4, 
             0.6928203230275509}, {1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[80., 16], 60 Degree], {0.8, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[90., 16], {0.55, 0.7794228634059948}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[9.999999999999998, 16], (-60) Degree], {0.45, 
             0.7794228634059948}, {1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[90., 16], 60 Degree], {0.9, 0}, {1.2, 1.5}]}}, 
          Text[
           Rotate[
            Style["solute", 17, 
             RGBColor[0, 0, 1]], (-60) Degree], {0.75, Sqrt[3]/4}, {-3, 0}], 
          Text[
           Rotate[
            Style["solvent", 17, 
             RGBColor[0, 0.6, 0]], 60 Degree], {0.25, Sqrt[3]/4}, {3, 0}], 
          Text[
           Style["carrier", 17, 
            RGBColor[0.8, 0, 0.01]], {0.5, 0}, {0, 5}], Null}], 
       Attributes[PlotRange] = {ReadProtected}, $CellContext`pt2[
         Pattern[$CellContext`pt, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]]] := {
         PointSize[0.03], $CellContext`col, 
         Point[$CellContext`pt], 
         PointSize[0.015], White, 
         Point[$CellContext`pt]}, $CellContext`colF = 
       RGBColor[1, 0.4, 0], $CellContext`pt1[
         Pattern[$CellContext`pt, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]]] := {
         PointSize[0.03], $CellContext`col, 
         Point[$CellContext`pt]}, $CellContext`colS = 
       RGBColor[0, 0.6, 0], $CellContext`colM = 
       RGBColor[0.5, 0, 0.5], $CellContext`colA = 
       RGBColor[0, 0, 1], $CellContext`colC = 
       RGBColor[0.8, 0, 0.01], $CellContext`colE = 
       RGBColor[1, 0, 0], $CellContext`colR = RGBColor[0, 0.6, 1]}; 
     Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->17607410,ExpressionUUID->"23bb51cd-a821-4adf-9676-91dc2d74bab1"]
}, {2}]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ManipulateCaptionSection",ExpressionUUID->"ab410455-fc48-411a-a81a-6275f3786887"],

Cell["\<\
In this Demonstration, the outlet compositions from a single-stage, \
liquid-liquid extraction are determined by following a step-by-step procedure \
on a ternary phase diagram. When the \"new problem\" is selected, a new phase \
envelope is shown and a new feed composition and feed flow rates are set.  In \
the steps, the feed and solvent compositions are located on the diagram and a \
line connecting them is drawn to determine the mixing point location. The \
mixing point composition from the phase diagram is indicated by moving the \
sliders in step 5. The compositions and the extract and raffinate \
compositions are located on a tie line in the last step.\
\>", "ManipulateCaption",
 CellChangeTimes->{
  3.7214022793554893`*^9, {3.7214023130766544`*^9, 3.7214023215643024`*^9}, {
   3.7217489564819627`*^9, 3.721749005291851*^9}, {3.7292693587386727`*^9, 
   3.729269535793697*^9}, {3.7292696010468135`*^9, 3.7292696447763996`*^9}, 
   3.7292697091496716`*^9, {3.7292699876751633`*^9, 3.7292699971781545`*^9}},
 CellID->107102252,ExpressionUUID->"f79280ad-eacb-44fb-b6ac-7fc85f450577"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ThumbnailSection",ExpressionUUID->"69349f49-4a02-482e-b6ad-b9f7cc6fe02a"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`feed$$ = {0.5, 
    0.606217782649107}, $CellContext`line1$$ = {0.35, 
    0.5196152422706631}, $CellContext`line2$$ = {0.65, 
    0.5196152422706631}, $CellContext`midland$$ = 1, $CellContext`mixing$$ = {
    0.5, 0.606217782649107}, $CellContext`outletE$$ = {0.2, 
    0.08660254037844387}, $CellContext`outletR$$ = {0.6, 
    0.34641016151377546`}, $CellContext`reset$$ = 1, $CellContext`solution$$ =
     False, $CellContext`solvent$$ = {0.5, 
    0.606217782649107}, $CellContext`wtA$$ = 80, $CellContext`wtC$$ = 
    20, $CellContext`wtS$$ = 0, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[
       Style[
        PaneSelector[{
         1 -> "step 1: move the point to the correct feed composition", 2 -> 
          "step 2: move the point to the correct solvent composition", 3 -> 
          "step 3: draw a line connecting feed and solvent compositions", 4 -> 
          "step 4: move the point to the correct mixing point location", 5 -> 
          "step 5: use sliders to set the correct mass percentages of the \
mixing point", 6 -> "step 6: determine outlet compositions"}, 
         Dynamic[$CellContext`midland$$]], Bold]], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`midland$$], 1, ""}, {1, 2, 3, 4, 5, 6}}, {{
       Hold[$CellContext`solution$$], False, "solution"}, {True, False}}, {{
       Hold[$CellContext`reset$$], 1}, 1, 1000, 1}, {
      Hold[
       Grid[{{
          Button[" new problem ", {
            
            If[$CellContext`reset$$ < 
             1000, $CellContext`reset$$ = $CellContext`reset$$ + 
              1, $CellContext`reset$$ = $CellContext`reset$$ - 
              1], $CellContext`midland$$ = 
            1, $CellContext`feed$$ = {
             0.5, 0.7 (Sqrt[3]/2)}, $CellContext`solvent$$ = {
             0.5, 0.7 (Sqrt[3]/2)}, $CellContext`line1$$ = {
             0.35, 0.6 (Sqrt[3]/2)}, $CellContext`line2$$ = {
             0.65, 0.6 (Sqrt[3]/2)}, $CellContext`mixing$$ = {
             0.5, 0.7 (Sqrt[3]/2)}, 
            
            If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 
          PaneSelector[{1 -> Style["(1) feed composition", 
              RGBColor[1, 0.4, 0]], 2 -> Style["(2) solvent composition", 
              RGBColor[0, 0.6, 0]], 3 -> "(3) draw mass balance line", 4 -> 
            Style["(4) mixing point composition", 
              RGBColor[0.5, 0, 0.5]], 5 -> "(5) mixing point composition", 6 -> 
            "(6) outlet streams"}, 
           Dynamic[$CellContext`midland$$]], 
          PaneSelector[{1 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`midland$$, Less, 
                 6], $CellContext`midland$$ = $CellContext`midland$$ + 
                 1, $CellContext`midland$$ = 6], 
               
               If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 2 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`midland$$, Less, 
                 6], $CellContext`midland$$ = $CellContext`midland$$ + 
                 1, $CellContext`midland$$ = 6], 
               
               If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 3 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`midland$$, Less, 
                 6], $CellContext`midland$$ = $CellContext`midland$$ + 
                 1, $CellContext`midland$$ = 6], 
               
               If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 4 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`midland$$, Less, 
                 6], $CellContext`midland$$ = $CellContext`midland$$ + 
                 1, $CellContext`midland$$ = 6], 
               
               If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 5 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`midland$$, Less, 
                 6], $CellContext`midland$$ = $CellContext`midland$$ + 
                 1, $CellContext`midland$$ = 6], 
               
               If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}]}, 
           Dynamic[$CellContext`midland$$]], 
          Manipulate`Place[1], 
          Spacer[15], 
          Manipulate`Place[2], 
          Manipulate`Place[3]}}]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`wtA$$], 80, 
       Style["solute", 
        RGBColor[0, 0, 1]]}, 0, 100, 1}, {{
       Hold[$CellContext`wtC$$], 20, 
       Style["carrier", 
        RGBColor[0.8, 0, 0.01]]}, 0, 100, 1}, {{
       Hold[$CellContext`wtS$$], 0, 
       Style["solvent", 
        RGBColor[0, 0.6, 0]]}, 0, 100, 1}, {{
       Hold[$CellContext`feed$$], {0.5, 0.606217782649107}}, Automatic}, {{
       Hold[$CellContext`solvent$$], {0.5, 0.606217782649107}}, Automatic}, {{
       Hold[$CellContext`line1$$], {0.35, 0.5196152422706631}}, Automatic}, {{
       Hold[$CellContext`line2$$], {0.65, 0.5196152422706631}}, Automatic}, {{
       Hold[$CellContext`mixing$$], {0.5, 0.606217782649107}}, Automatic}, {{
       Hold[$CellContext`outletE$$], {0.2, 0.08660254037844387}}, 
      Automatic}, {{
       Hold[$CellContext`outletR$$], {0.6, 0.34641016151377546`}}, 
      Automatic}, {
      Hold[
       Grid[{{
          PaneSelector[{5 -> Row[{"mass percent (%):", 
               Spacer[5], 
               Manipulate`Place[4], 
               Manipulate`Place[5], 
               Manipulate`Place[6]}]}, 
           Dynamic[$CellContext`midland$$]], 
          
          PaneSelector[{
           1 -> Manipulate`Place[7], 2 -> Manipulate`Place[8], 3 -> Row[{
               Manipulate`Place[9], 
               Manipulate`Place[10]}], 4 -> Manipulate`Place[11], 6 -> Row[{
               Manipulate`Place[12], 
               Manipulate`Place[13]}]}, 
           Dynamic[$CellContext`midland$$]]}}]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    600., {192., 198.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`midland$124526$$ = 
    0, $CellContext`solution$124527$$ = False, $CellContext`reset$124528$$ = 
    0, $CellContext`wtA$124529$$ = 0, $CellContext`wtC$124530$$ = 
    0, $CellContext`wtS$124531$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`feed$$ = {0.5, 
         0.606217782649107}, $CellContext`line1$$ = {0.35, 
         0.5196152422706631}, $CellContext`line2$$ = {0.65, 
         0.5196152422706631}, $CellContext`midland$$ = 
        1, $CellContext`mixing$$ = {0.5, 
         0.606217782649107}, $CellContext`outletE$$ = {0.2, 
         0.08660254037844387}, $CellContext`outletR$$ = {0.6, 
         0.34641016151377546`}, $CellContext`reset$$ = 
        1, $CellContext`solution$$ = 
        False, $CellContext`solvent$$ = {0.5, 
         0.606217782649107}, $CellContext`wtA$$ = 80, $CellContext`wtC$$ = 
        20, $CellContext`wtS$$ = 0}, "ControllerVariables" :> {
        Hold[$CellContext`midland$$, $CellContext`midland$124526$$, 0], 
        Hold[$CellContext`solution$$, $CellContext`solution$124527$$, False], 
        Hold[$CellContext`reset$$, $CellContext`reset$124528$$, 0], 
        Hold[$CellContext`wtA$$, $CellContext`wtA$124529$$, 0], 
        Hold[$CellContext`wtC$$, $CellContext`wtC$124530$$, 0], 
        Hold[$CellContext`wtS$$, $CellContext`wtS$124531$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`part$, $CellContext`phase$, $CellContext`tie$, \
$CellContext`feedA$, $CellContext`feedC$, $CellContext`feedS$, \
$CellContext`FtoS$, $CellContext`mF$, $CellContext`mS$, $CellContext`mM$, \
$CellContext`xM$, $CellContext`massA$, $CellContext`massC$, \
$CellContext`massS$, $CellContext`func1$, $CellContext`func2$, \
$CellContext`xmix$, $CellContext`ymix$, $CellContext`tieline$, \
$CellContext`lower$, $CellContext`upper$, $CellContext`lever$, \
$CellContext`newtie$, $CellContext`x1$, $CellContext`x2$}, 
        SeedRandom[$CellContext`reset$$]; $CellContext`part$ = 
         RandomInteger[{1, 5}]; $CellContext`phase$ = 
         Part[{$CellContext`phase1, $CellContext`phase2, $CellContext`phase3, \
$CellContext`phase4, $CellContext`phase5}, $CellContext`part$]; \
$CellContext`tie$ = 
         Part[{$CellContext`tie1, $CellContext`tie2, $CellContext`tie3, \
$CellContext`tie4, $CellContext`tie5}, $CellContext`part$]; \
$CellContext`feedA$ = RandomInteger[{25, 55}]; $CellContext`feedC$ = 
         100 - $CellContext`feedA$; $CellContext`feedS$ = 
         100 - $CellContext`feedA$ - $CellContext`feedC$; $CellContext`FtoS$ = 
         RandomReal[{0.1, 5}]; $CellContext`mF$ = 
         50; $CellContext`mS$ = $CellContext`mF$/$CellContext`FtoS$; \
$CellContext`mM$ = $CellContext`mF$ + $CellContext`mS$; $CellContext`xM$ = \
$CellContext`mS$/($CellContext`mF$ + $CellContext`mS$); $CellContext`massA$ = \
($CellContext`mF$/($CellContext`mF$ + $CellContext`mS$)) ($CellContext`feedA$/
           100); $CellContext`massC$ = ($CellContext`mF$/($CellContext`mF$ + \
$CellContext`mS$)) ($CellContext`feedC$/
           100); $CellContext`massS$ = $CellContext`mS$/($CellContext`mF$ + \
$CellContext`mS$); $CellContext`func1$[
           Pattern[$CellContext`x$, 
            Blank[]]] := (-
            Sqrt[3]) ($CellContext`x$ - (1 - $CellContext`xM$) (Sqrt[3]/2)/
            Tan[$CellContext`\[Theta]]) + (1 - $CellContext`xM$) (Sqrt[3]/
            2); $CellContext`func2$[
           Pattern[$CellContext`x$, 
            Blank[]]] := ((($CellContext`feedA$/100) (Sqrt[3]/2))/(
            1 - ($CellContext`feedA$/100) ((Sqrt[3]/2)/
             Tan[$CellContext`\[Theta]]))) ($CellContext`x$ - (
            1 - ($CellContext`feedA$/100) ((Sqrt[3]/2)/
             Tan[$CellContext`\[Theta]]))) + ($CellContext`feedA$/100) (
            Sqrt[3]/2); $CellContext`xmix$ = ReplaceAll[$CellContext`x, 
           Quiet[
            Part[
             
             Solve[$CellContext`func1$[$CellContext`x] == \
$CellContext`func2$[$CellContext`x], $CellContext`x], 
             1]]]; $CellContext`ymix$ = \
$CellContext`func1$[$CellContext`xmix$]; $CellContext`tieline$[
           Pattern[$CellContext`list, 
            Blank[]], 
           Pattern[$CellContext`line, 
            Blank[]], 
           Pattern[$CellContext`x, 
            Blank[]]] := ReplaceAll[
           Fit[
            Part[$CellContext`list, $CellContext`line], {
            1, $CellContext`z}, $CellContext`z], $CellContext`z -> \
$CellContext`x]; $CellContext`lower$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Which[$CellContext`ymix$ <= $CellContext`tieline$[$CellContext`tie$, 
             1, $CellContext`xmix$], 0, 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 1, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 1, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 4, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 4, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 5, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 
            4, $CellContext`x$], $CellContext`tieline$[$CellContext`tie$, 
             5, $CellContext`xmix$] < $CellContext`ymix$, 
           $CellContext`tieline$[$CellContext`tie$, 
            5, $CellContext`x$]]; $CellContext`upper$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Which[$CellContext`ymix$ <= $CellContext`tieline$[$CellContext`tie$, 
             1, $CellContext`xmix$], 
           $CellContext`tieline$[$CellContext`tie$, 1, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 1, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 4, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 4, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 4, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 5, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 
            5, $CellContext`x$], $CellContext`tieline$[$CellContext`tie$, 
             5, $CellContext`xmix$] < $CellContext`ymix$, 
           $CellContext`tieline$[$CellContext`tie$, 
            5, $CellContext`x$]]; $CellContext`lever$ = 
         If[$CellContext`ymix$ > $CellContext`tieline$[$CellContext`tie$, 
             5, $CellContext`xmix$], 
           1, ($CellContext`ymix$ - \
$CellContext`lower$[$CellContext`xmix$])/($CellContext`upper$[$CellContext`\
xmix$] - $CellContext`lower$[$CellContext`xmix$])]; $CellContext`newtie$[
           Pattern[$CellContext`x$, 
            Blank[]]] := (
            1 - $CellContext`lever$) $CellContext`lower$[$CellContext`x$] + \
$CellContext`lever$ $CellContext`upper$[$CellContext`x$]; $CellContext`x1$ = 
         ReplaceAll[$CellContext`x, 
           
           FindRoot[$CellContext`newtie$[$CellContext`x] == 
            Interpolation[$CellContext`phase$][$CellContext`x], \
{$CellContext`x, 0.1}]]; $CellContext`x2$ = ReplaceAll[$CellContext`x, 
           
           FindRoot[$CellContext`newtie$[$CellContext`x] == 
            Interpolation[$CellContext`phase$][$CellContext`x], \
{$CellContext`x, 0.9}]]; If[$CellContext`ymix$ > Quiet[
            
            Interpolation[$CellContext`phase$][$CellContext`xmix$]], \
$CellContext`reset$$ = $CellContext`reset$$ + 1]; 
        Show[$CellContext`gridlines, $CellContext`diagram, 
          PlotRange -> {{-0.25, 1.25}, {-0.2, 0.95}}, ImageSize -> {600, 390},
           Epilog -> {{Thick, 
             Line[
              Map[{#, 
                Interpolation[$CellContext`phase$][#]}& , 
               Range[
                Part[$CellContext`phase$, 1, 1], 
                Part[$CellContext`phase$, -1, 1], 0.01]]], 
             Line[$CellContext`tie$]}, 
            If[$CellContext`midland$$ == 1, {
              Text[
               Style[
                Column[{"mass % in feed", 
                  Framed[
                   Column[{
                    Row[{"solute = ", $CellContext`feedA$, "%"}], 
                    Row[{"carrier = ", $CellContext`feedC$, "%"}], 
                    Row[{"solvent = ", $CellContext`feedS$, "%"}]}, Alignment -> 
                    "="], Background -> White]}, Center], 17], {
               0, 0.9 (Sqrt[3]/2)}], 
              $CellContext`pt2[$CellContext`feed$$, $CellContext`colF], 
              Text[
               Style[
               "feed", 17, $CellContext`colF, Background -> 
                White], $CellContext`feed$$, {0, -1.75}], 
              If[$CellContext`solution$$, 
               $CellContext`pt1[{
                1 - ($CellContext`feedA$/100) (Sqrt[3]/2)/
                 Tan[$CellContext`\[Theta]], ($CellContext`feedA$/100) (
                  Sqrt[3]/2)}, $CellContext`colF]]}], 
            If[$CellContext`midland$$ > 1, {
              $CellContext`pt1[{
               1 - ($CellContext`feedA$/100) (Sqrt[3]/2)/
                Tan[$CellContext`\[Theta]], ($CellContext`feedA$/100) (
                 Sqrt[3]/2)}, $CellContext`colF], 
              Text[
               Style[" F ", 17, $CellContext`colF, Background -> White], {
               1 - ($CellContext`feedA$/100) (Sqrt[3]/2)/
                Tan[$CellContext`\[Theta]], ($CellContext`feedA$/100) (
                 Sqrt[3]/2)}, {0, -2}]}], 
            If[$CellContext`midland$$ == 2, {
              Text[
               Style[
                Column[{"mass % in solvent", 
                  Framed[
                   Column[{
                    Row[{"solute = ", 0, "%"}], 
                    Row[{"carrier = ", 0, "%"}], 
                    Row[{"solvent = ", 100, "%"}]}, Alignment -> "="], 
                   Background -> White]}, Center], 17], {0, 0.9 (Sqrt[3]/2)}], 
              $CellContext`pt2[$CellContext`solvent$$, $CellContext`colS], 
              Text[
               Style[
               "solvent", 17, $CellContext`colS, Background -> 
                White], $CellContext`solvent$$, {0, -1.75}], 
              If[$CellContext`solution$$, 
               $CellContext`pt1[{0, 0}, $CellContext`colS]]}], 
            If[$CellContext`midland$$ > 2, {
              $CellContext`pt1[{0, 0}, $CellContext`colS], 
              Text[
               Style["S", 17, $CellContext`colS, Background -> White], {0, 
               0}, {0, -2}]}], 
            If[$CellContext`midland$$ == 3, {{
               Thickness[0.007], 
               CapForm[None], Dashed, Magenta, 
               Line[{$CellContext`line1$$, $CellContext`line2$$}]}, 
              $CellContext`pt2[$CellContext`line1$$, Magenta], 
              $CellContext`pt2[$CellContext`line2$$, Magenta], 
              If[$CellContext`solution$$, {
                Thickness[0.007], 
                CapForm[None], Magenta, 
                
                Line[{{0, 0}, {
                  1 - ($CellContext`feedA$/100) ((Sqrt[3]/2)/
                    Tan[$CellContext`\[Theta]]), ($CellContext`feedA$/100) (
                    Sqrt[3]/2)}}]}]}], 
            If[$CellContext`midland$$ > 3, {
              Thickness[0.007], 
              CapForm[None], Magenta, 
              
              Line[{{0, 0}, {
                1 - ($CellContext`feedA$/100) ((Sqrt[3]/2)/
                  Tan[$CellContext`\[Theta]]), ($CellContext`feedA$/100) (
                  Sqrt[3]/2)}}]}], 
            If[$CellContext`midland$$ == 4, {
              $CellContext`pt2[$CellContext`mixing$$, $CellContext`colM], 
              Text[
               Style[
               "mixing", 17, $CellContext`colM, Background -> 
                White], $CellContext`mixing$$, {0, -1.75}], 
              If[$CellContext`solution$$ == False, 
               Text[
                Style[
                 Column[{"mass flow (kg/h)", 
                   Framed[
                    Column[{
                    Row[{"feed = ", 
                    NumberForm[$CellContext`mF$, {5, 1}]}], 
                    Row[{"solvent = ", 
                    NumberForm[$CellContext`mS$, {5, 1}]}]}, Alignment -> 
                    "="], Background -> White], 
                   Row[{
                    Style["F", Italic], "/", 
                    Style["S", Italic], " = ", 
                    NumberForm[$CellContext`FtoS$, {5, 1}]}]}, Center], 17], {
                1, 0.9 (Sqrt[3]/2)}]], 
              If[$CellContext`solution$$, 
               $CellContext`pt1[{$CellContext`xmix$, 
                 $CellContext`func1$[$CellContext`xmix$]}, \
$CellContext`colM]]}], 
            If[$CellContext`midland$$ > 4, {
              $CellContext`pt1[{$CellContext`xmix$, 
                $CellContext`func1$[$CellContext`xmix$]}, $CellContext`colM], 
              Text[
               Style[
               "M", 17, $CellContext`colM, Background -> 
                White], {$CellContext`xmix$, 
                $CellContext`func1$[$CellContext`xmix$]}, {0, -2}]}], 
            If[$CellContext`midland$$ == 5, {
              If[$CellContext`solution$$, 
               Text[
                Framed[
                 Style[
                  Column[{
                    Style[
                    Row[{"solute = ", 
                    NumberForm[$CellContext`massA$ 100, {4, 0}], 
                    "%"}], $CellContext`colA], 
                    Style[
                    Row[{"carrier = ", 
                    NumberForm[$CellContext`massC$ 100, {4, 0}], 
                    "%"}], $CellContext`colC], 
                    Style[
                    Row[{"solvent = ", 
                    NumberForm[$CellContext`massS$ 100, {4, 0}], 
                    "%"}], $CellContext`colS]}, Alignment -> "="], 17], 
                 Background -> White], {1, 0.9 (Sqrt[3]/2)}]], 
              If[$CellContext`solution$$ == False, 
               Text[
                Style[
                 Column[{"mass flow (kg/h)", 
                   Framed[
                    Column[{
                    Row[{"feed = ", 
                    NumberForm[$CellContext`mF$, {5, 1}]}], 
                    Row[{"solvent = ", 
                    NumberForm[$CellContext`mS$, {5, 1}]}]}, Alignment -> 
                    "="], Background -> White], 
                   Row[{
                    Style["F", Italic], "/", 
                    Style["S", Italic], " = ", 
                    NumberForm[$CellContext`FtoS$, {5, 1}]}]}, Center], 17], {
                1, 0.9 (Sqrt[3]/2)}]]}], 
            If[$CellContext`midland$$ == 6, {{Thick, Dashed, 
               Line[{$CellContext`outletE$$, $CellContext`outletR$$}]}, 
              $CellContext`pt2[$CellContext`outletE$$, $CellContext`colE], 
              $CellContext`pt2[$CellContext`outletR$$, $CellContext`colR], 
              Apply[If[$CellContext`solution$$ == False, 
                Text[
                 Style[#, 17, #2, Background -> White], #3, {0, -1.75}]]& , {{
                "extract", $CellContext`colE, $CellContext`outletE$$}, {
                "raffinate", $CellContext`colR, $CellContext`outletR$$}}, {
               1}], 
              If[$CellContext`solution$$, {
                Thickness[0.0075], Dashed, Orange, 
                Line[
                 Map[{#, 
                   $CellContext`newtie$[#]}& , 
                  Range[$CellContext`x1$, $CellContext`x2$, 0.01]]], 
                $CellContext`pt1[{$CellContext`x1$, 
                  $CellContext`newtie$[$CellContext`x1$]}, $CellContext`colE], 
                $CellContext`pt1[{$CellContext`x2$, 
                  $CellContext`newtie$[$CellContext`x2$]}, $CellContext`colR], 
                Text[
                 Style[
                 "E", 17, $CellContext`colE, Background -> 
                  White], {$CellContext`x1$, 
                  $CellContext`newtie$[$CellContext`x1$]}, {0, -1.75}], 
                Text[
                 Style[
                 "R", 17, $CellContext`colR, Background -> 
                  White], {$CellContext`x2$, 
                  $CellContext`newtie$[$CellContext`x2$]}, {0, -1.75}]}]}]}]],
       "Specifications" :> {
        Style[
         PaneSelector[{
          1 -> "step 1: move the point to the correct feed composition", 2 -> 
           "step 2: move the point to the correct solvent composition", 3 -> 
           "step 3: draw a line connecting feed and solvent compositions", 4 -> 
           "step 4: move the point to the correct mixing point location", 5 -> 
           "step 5: use sliders to set the correct mass percentages of the \
mixing point", 6 -> "step 6: determine outlet compositions"}, 
          Dynamic[$CellContext`midland$$]], 
         Bold], {{$CellContext`midland$$, 1, ""}, {1, 2, 3, 4, 5, 6}, 
         ControlType -> None, ControlPlacement -> 
         1}, {{$CellContext`solution$$, False, "solution"}, {True, False}, 
         Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         2}, {{$CellContext`reset$$, 1}, 1, 1000, 1, ControlType -> None, 
         ControlPlacement -> 3}, 
        Grid[{{
           Button[" new problem ", {
             
             If[$CellContext`reset$$ < 
              1000, $CellContext`reset$$ = $CellContext`reset$$ + 
               1, $CellContext`reset$$ = $CellContext`reset$$ - 
               1], $CellContext`midland$$ = 
             1, $CellContext`feed$$ = {
              0.5, 0.7 (Sqrt[3]/2)}, $CellContext`solvent$$ = {
              0.5, 0.7 (Sqrt[3]/2)}, $CellContext`line1$$ = {
              0.35, 0.6 (Sqrt[3]/2)}, $CellContext`line2$$ = {
              0.65, 0.6 (Sqrt[3]/2)}, $CellContext`mixing$$ = {
              0.5, 0.7 (Sqrt[3]/2)}, 
             
             If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 
           PaneSelector[{1 -> Style["(1) feed composition", 
               RGBColor[1, 0.4, 0]], 2 -> Style["(2) solvent composition", 
               RGBColor[0, 0.6, 0]], 3 -> "(3) draw mass balance line", 4 -> 
             Style["(4) mixing point composition", 
               RGBColor[0.5, 0, 0.5]], 5 -> "(5) mixing point composition", 6 -> 
             "(6) outlet streams"}, 
            Dynamic[$CellContext`midland$$]], 
           PaneSelector[{1 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`midland$$, Less, 
                  6], $CellContext`midland$$ = $CellContext`midland$$ + 
                  1, $CellContext`midland$$ = 6], 
                
                If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 2 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`midland$$, Less, 
                  6], $CellContext`midland$$ = $CellContext`midland$$ + 
                  1, $CellContext`midland$$ = 6], 
                
                If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 3 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`midland$$, Less, 
                  6], $CellContext`midland$$ = $CellContext`midland$$ + 
                  1, $CellContext`midland$$ = 6], 
                
                If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 4 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`midland$$, Less, 
                  6], $CellContext`midland$$ = $CellContext`midland$$ + 
                  1, $CellContext`midland$$ = 6], 
                
                If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 5 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`midland$$, Less, 
                  6], $CellContext`midland$$ = $CellContext`midland$$ + 
                  1, $CellContext`midland$$ = 6], 
                
                If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}]}, 
            Dynamic[$CellContext`midland$$]], 
           Manipulate`Place[1], 
           Spacer[15], 
           Manipulate`Place[2], 
           Manipulate`Place[3]}}], {{$CellContext`wtA$$, 80, 
          Style["solute", 
           RGBColor[0, 0, 1]]}, 0, 100, 1, Appearance -> "Labeled", ImageSize -> 
         Tiny, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         4}, {{$CellContext`wtC$$, 20, 
          Style["carrier", 
           RGBColor[0.8, 0, 0.01]]}, 0, 100, 1, Appearance -> "Labeled", 
         ImageSize -> Tiny, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         5}, {{$CellContext`wtS$$, 0, 
          Style["solvent", 
           RGBColor[0, 0.6, 0]]}, 0, 100, 1, Appearance -> "Labeled", 
         ImageSize -> Tiny, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         6}, {{$CellContext`feed$$, {0.5, 0.606217782649107}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         7}, {{$CellContext`solvent$$, {0.5, 0.606217782649107}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         8}, {{$CellContext`line1$$, {0.35, 0.5196152422706631}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         9}, {{$CellContext`line2$$, {0.65, 0.5196152422706631}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         10}, {{$CellContext`mixing$$, {0.5, 0.606217782649107}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         11}, {{$CellContext`outletE$$, {0.2, 0.08660254037844387}}, 
         Automatic, ControlType -> Locator, Appearance -> None, Enabled -> 
         Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         12}, {{$CellContext`outletR$$, {0.6, 0.34641016151377546`}}, 
         Automatic, ControlType -> Locator, Appearance -> None, Enabled -> 
         Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 13}, 
        Grid[{{
           PaneSelector[{5 -> Row[{"mass percent (%):", 
                Spacer[5], 
                Manipulate`Place[4], 
                Manipulate`Place[5], 
                Manipulate`Place[6]}]}, 
            Dynamic[$CellContext`midland$$]], 
           
           PaneSelector[{
            1 -> Manipulate`Place[7], 2 -> Manipulate`Place[8], 3 -> Row[{
                Manipulate`Place[9], 
                Manipulate`Place[10]}], 4 -> Manipulate`Place[11], 6 -> Row[{
                Manipulate`Place[12], 
                Manipulate`Place[13]}]}, 
            Dynamic[$CellContext`midland$$]]}}]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{655., {260., 267.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`phase = 
       InterpolatingFunction[{{0.08, 0.98}}, {
         5, 7, 0, {12}, {4}, 0, 0, 0, 0, Automatic, {}, {}, False}, {{0.08, 
         0.15, 0.19, 0.25, 0.33, 0.44, 0.61, 0.68, 0.77, 0.83, 0.88, 0.98}}, {
         Developer`PackedArrayForm, {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 
          12}, {0., 0.1, 0.17, 0.26, 0.37, 0.45, 0.46, 0.43, 0.35, 0.26, 0.17,
           0.}}, {Automatic}], $CellContext`phase1 = {{0.09, 0}, {0.17, 
         0.13}, {0.28, 0.3}, {0.41, 0.44}, {0.55, 0.47}, {0.7, 0.42}, {0.83, 
         0.26}, {0.98, 0}}, $CellContext`phase2 = {{0.0545, 0}, {0.136, 
         0.134}, {0.226, 0.267}, {0.3405, 0.36}, {0.534, 0.398}, {0.673, 
         0.338}, {0.7925, 0.232}, {0.956, 0}}, $CellContext`phase3 = {{
         0.098, 0}, {0.172, 0.126}, {0.2285, 0.213}, {0.422, 0.338}, {0.55, 
         0.352}, {0.7055, 0.284}, {0.7925, 0.205}, {
         0.92, 0}}, $CellContext`phase4 = {{0.07, 0}, {0.14, 0.14}, {0.26, 
         0.35}, {0.42, 0.56}, {0.56, 0.59}, {0.7, 0.42}, {0.82, 0.24}, {
         0.95, 0}}, $CellContext`phase5 = {{0, 0}, {0.12, 0.15}, {0.23, 
         0.32}, {0.34, 0.45}, {0.6, 0.5}, {0.69, 0.42}, {0.77, 0.3}, {
         0.93, 0}}, $CellContext`tie1 = {{{0.12, 0.052}, {0.93, 0.078}}, {{
        0.16, 0.104}, {0.88, 0.173}}, {{0.2, 0.173}, {0.83, 0.26}}, {{0.26, 
        0.268}, {0.77, 0.346}}, {{0.34, 0.372}, {0.67, 
        0.433}}}, $CellContext`tie2 = {{{0.1, 0.07}, {0.9, 0.09}}, {{0.13, 
        0.12}, {0.84, 0.17}}, {{0.17, 0.18}, {0.77, 0.25}}, {{0.2, 0.23}, {
        0.7, 0.32}}, {{0.24, 0.28}, {0.64, 0.36}}}, $CellContext`tie3 = {{{
        0.12, 0.03}, {0.89, 0.06}}, {{0.15, 0.09}, {0.86, 0.11}}, {{0.19, 
        0.15}, {0.82, 0.17}}, {{0.24, 0.23}, {0.72, 0.27}}, {{0.28, 0.27}, {
        0.65, 0.32}}}, $CellContext`tie4 = {{{0.1, 0.06}, {0.9, 0.1}}, {{0.15,
         0.15}, {0.84, 0.21}}, {{0.21, 0.26}, {0.75, 0.35}}, {{0.28, 0.37}, {
        0.67, 0.46}}, {{0.37, 0.51}, {0.59, 0.56}}}, $CellContext`tie5 = {{{
        0.065, 0.07}, {0.87, 0.11}}, {{0.11, 0.13}, {0.83, 0.2}}, {{0.17, 
        0.22}, {0.76, 0.32}}, {{0.24, 0.33}, {0.69, 0.41}}, {{0.33, 0.44}, {
        0.6, 0.5}}}, $CellContext`\[Theta] = 
       60 Degree, $CellContext`gridlines = Graphics[{
          GrayLevel[0.65], {{
            
            Line[{{0.025, 0.04330127018922193}, {0.975, 
             0.04330127018922193}}], 
            Line[{{0.05, 0}, {0.025, 0.04330127018922193}}], 
            Line[{{0.95, 0}, {0.975, 0.04330127018922193}}]}, {
            
            Line[{{0.07500000000000001, 0.1299038105676658}, {0.925, 
             0.1299038105676658}}], 
            
            Line[{{0.15000000000000002`, 0}, {0.07500000000000001, 
              0.1299038105676658}}], 
            Line[{{0.85, 0}, {0.925, 0.1299038105676658}}]}, {
            
            Line[{{0.125, 0.21650635094610965`}, {0.875, 
             0.21650635094610965`}}], 
            Line[{{0.25, 0}, {0.125, 0.21650635094610965`}}], 
            Line[{{0.75, 0}, {0.875, 0.21650635094610965`}}]}, {
            
            Line[{{0.17500000000000002`, 0.30310889132455354`}, {0.825, 
             0.30310889132455354`}}], 
            
            Line[{{0.35000000000000003`, 0}, {0.17500000000000002`, 
              0.30310889132455354`}}], 
            Line[{{0.6499999999999999, 0}, {0.825, 0.30310889132455354`}}]}, {
            Line[{{0.225, 0.3897114317029974}, {0.775, 0.3897114317029974}}], 
            Line[{{0.45, 0}, {0.225, 0.3897114317029974}}], 
            Line[{{0.55, 0}, {0.775, 0.3897114317029974}}]}, {
            Line[{{0.275, 0.4763139720814413}, {0.725, 0.4763139720814413}}], 
            Line[{{0.55, 0}, {0.275, 0.4763139720814413}}], 
            Line[{{0.44999999999999996`, 0}, {0.725, 0.4763139720814413}}]}, {
            
            Line[{{0.32500000000000007`, 0.5629165124598852}, {
             0.6749999999999999, 0.5629165124598852}}], 
            
            Line[{{0.6500000000000001, 0}, {0.32500000000000007`, 
              0.5629165124598852}}], 
            
            Line[{{0.34999999999999987`, 0}, {0.6749999999999999, 
              0.5629165124598852}}]}, {
            
            Line[{{0.37500000000000006`, 0.649519052838329}, {0.625, 
             0.649519052838329}}], 
            
            Line[{{0.7500000000000001, 0}, {0.37500000000000006`, 
              0.649519052838329}}], 
            Line[{{0.2499999999999999, 0}, {0.625, 0.649519052838329}}]}, {
            
            Line[{{0.42500000000000004`, 0.7361215932167728}, {0.575, 
             0.7361215932167728}}], 
            
            Line[{{0.8500000000000001, 0}, {0.42500000000000004`, 
              0.7361215932167728}}], 
            Line[{{0.1499999999999999, 0}, {0.575, 0.7361215932167728}}]}, {
            Line[{{0.475, 0.8227241335952167}, {0.525, 0.8227241335952167}}], 
            Line[{{0.95, 0}, {0.475, 0.8227241335952167}}], 
            
            Line[{{0.050000000000000044`, 0}, {0.525, 
              0.8227241335952167}}]}}, {{
            Line[{{0.05, 0.08660254037844387}, {0.97, 0.08660254037844387}}], 
            Line[{{0.1, 0}, {0.0485, 0.08920061658979718}}], 
            Line[{{0.88, -0.02}, {0.95, 0.08660254037844387}}]}, {
            Line[{{0.1, 0.17320508075688773`}, {0.92, 0.17320508075688773`}}], 
            Line[{{0.2, 0}, {0.097, 0.17840123317959436`}}], 
            Line[{{0.78, -0.02}, {0.9, 0.17320508075688773`}}]}, {
            
            Line[{{0.15000000000000002`, 0.2598076211353316}, {0.87, 
             0.2598076211353316}}], 
            
            Line[{{0.30000000000000004`, 0}, {0.14550000000000002`, 
              0.26760184976939155`}}], 
            Line[{{0.6799999999999999, -0.02}, {0.85, 0.2598076211353316}}]}, {
            
            Line[{{0.2, 0.34641016151377546`}, {0.8200000000000001, 
             0.34641016151377546`}}], 
            Line[{{0.4, 0}, {0.194, 0.3568024663591887}}], 
            Line[{{0.58, -0.02}, {0.8, 0.34641016151377546`}}]}, {
            Line[{{0.25, 0.4330127018922193}, {0.77, 0.4330127018922193}}], 
            Line[{{0.5, 0}, {0.2425, 0.4460030829489859}}], 
            Line[{{0.48, -0.02}, {0.75, 0.4330127018922193}}]}, {
            Line[{{0.3, 0.5196152422706631}, {0.72, 0.5196152422706631}}], 
            Line[{{0.6, 0}, {0.291, 0.535203699538783}}], 
            Line[{{0.38, -0.02}, {0.7, 0.5196152422706631}}]}, {
            
            Line[{{0.35000000000000003`, 0.6062177826491071}, {
             0.6699999999999999, 0.6062177826491071}}], 
            Line[{{0.7000000000000001, 0}, {0.3395, 0.6244043161285803}}], 
            
            Line[{{0.2799999999999999, -0.02}, {0.6499999999999999, 
             0.6062177826491071}}]}, {
            Line[{{0.4, 0.6928203230275509}, {0.62, 0.6928203230275509}}], 
            Line[{{0.8, 0}, {0.388, 0.7136049327183774}}], 
            
            Line[{{0.17999999999999994`, -0.02}, {0.6, 
             0.6928203230275509}}]}, {
            
            Line[{{0.45, 0.7794228634059948}, {0.5700000000000001, 
             0.7794228634059948}}], 
            Line[{{0.9, 0}, {0.4365, 0.8028055493081746}}], 
            
            Line[{{0.07999999999999996, -0.02}, {0.55, 
             0.7794228634059948}}]}}}], $CellContext`diagram = Graphics[{{
           EdgeForm[
            Thickness[Large]], 
           FaceForm[None], 
           Polygon[{{0, 0}, {0.5, Sqrt[3]/2}, {1, 0}}]}, {{
            RGBColor[0, 0, 1], 
            Text[
             Style[10., 16], {0.95, 0.08660254037844387}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[90., 16], (-60) Degree], {0.05, 0.08660254037844387}, {
             1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[10., 16], 60 Degree], {0.1, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[20., 16], {0.9, 0.17320508075688773`}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[80., 16], (-60) Degree], {0.1, 0.17320508075688773`}, {
             1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[20., 16], 60 Degree], {0.2, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[30.000000000000004`, 16], {0.85, 0.2598076211353316}, {-2, 
             0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[70., 16], (-60) Degree], {0.15000000000000002`, 
             0.2598076211353316}, {1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[30.000000000000004`, 16], 60 Degree], {
             0.30000000000000004`, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[40., 16], {0.8, 0.34641016151377546`}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[60., 16], (-60) Degree], {0.2, 0.34641016151377546`}, {
             1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[40., 16], 60 Degree], {0.4, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[50., 16], {0.75, 0.4330127018922193}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[50., 16], (-60) Degree], {0.25, 0.4330127018922193}, {
             1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[50., 16], 60 Degree], {0.5, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[60., 16], {0.7, 0.5196152422706631}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[40., 16], (-60) Degree], {0.3, 0.5196152422706631}, {
             1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[60., 16], 60 Degree], {0.6, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[70., 16], {0.6499999999999999, 0.6062177826491071}, {-2, 
             0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[29.999999999999993`, 16], (-60) Degree], {
             0.35000000000000003`, 0.6062177826491071}, {1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[70., 16], 60 Degree], {0.7000000000000001, 0}, {1.2, 
             1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[80., 16], {0.6, 0.6928203230275509}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[19.999999999999996`, 16], (-60) Degree], {0.4, 
             0.6928203230275509}, {1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[80., 16], 60 Degree], {0.8, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[90., 16], {0.55, 0.7794228634059948}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[9.999999999999998, 16], (-60) Degree], {0.45, 
             0.7794228634059948}, {1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[90., 16], 60 Degree], {0.9, 0}, {1.2, 1.5}]}}, 
          Text[
           Rotate[
            Style["solute", 17, 
             RGBColor[0, 0, 1]], (-60) Degree], {0.75, Sqrt[3]/4}, {-3, 0}], 
          Text[
           Rotate[
            Style["solvent", 17, 
             RGBColor[0, 0.6, 0]], 60 Degree], {0.25, Sqrt[3]/4}, {3, 0}], 
          Text[
           Style["carrier", 17, 
            RGBColor[0.8, 0, 0.01]], {0.5, 0}, {0, 5}], Null}], 
       Attributes[PlotRange] = {ReadProtected}, $CellContext`pt2[
         Pattern[$CellContext`pt, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]]] := {
         PointSize[0.03], $CellContext`col, 
         Point[$CellContext`pt], 
         PointSize[0.015], White, 
         Point[$CellContext`pt]}, $CellContext`colF = 
       RGBColor[1, 0.4, 0], $CellContext`pt1[
         Pattern[$CellContext`pt, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]]] := {
         PointSize[0.03], $CellContext`col, 
         Point[$CellContext`pt]}, $CellContext`colS = 
       RGBColor[0, 0.6, 0], $CellContext`colM = 
       RGBColor[0.5, 0, 0.5], $CellContext`colA = 
       RGBColor[0, 0, 1], $CellContext`colC = 
       RGBColor[0.8, 0, 0.01], $CellContext`colE = 
       RGBColor[1, 0, 0], $CellContext`colR = RGBColor[0, 0.6, 1]}; 
     Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->222013489,ExpressionUUID->"8d5c3ede-7b47-4c8f-a86b-4af46c45bda7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SnapshotsSection",ExpressionUUID->"d4cbdcae-adc4-4559-a897-3433b9632197"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`feed$$ = {0.5, 
    0.606217782649107}, $CellContext`line1$$ = {0.006000000000000005, 
    0.013999999999999985`}, $CellContext`line2$$ = {0.8220000000000001, 
    0.308}, $CellContext`midland$$ = 3, $CellContext`mixing$$ = {0.5, 
    0.606217782649107}, $CellContext`outletE$$ = {0.2, 
    0.08660254037844387}, $CellContext`outletR$$ = {0.6, 
    0.34641016151377546`}, $CellContext`reset$$ = 1, $CellContext`solution$$ =
     True, $CellContext`solvent$$ = {0.5, 
    0.606217782649107}, $CellContext`wtA$$ = 80, $CellContext`wtC$$ = 
    20, $CellContext`wtS$$ = 0, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[
       Style[
        PaneSelector[{
         1 -> "step 1: move the point to the correct feed composition", 2 -> 
          "step 2: move the point to the correct solvent composition", 3 -> 
          "step 3: draw a line connecting feed and solvent compositions", 4 -> 
          "step 4: move the point to the correct mixing point location", 5 -> 
          "step 5: use sliders to set the correct mass percentages of the \
mixing point", 6 -> "step 6: determine outlet compositions"}, 
         Dynamic[$CellContext`midland$$]], Bold]], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`midland$$], 3, ""}, {1, 2, 3, 4, 5, 6}}, {{
       Hold[$CellContext`solution$$], True, "solution"}, {True, False}}, {{
       Hold[$CellContext`reset$$], 1}, 1, 1000, 1}, {
      Hold[
       Grid[{{
          Button[" new problem ", {
            
            If[$CellContext`reset$$ < 
             1000, $CellContext`reset$$ = $CellContext`reset$$ + 
              1, $CellContext`reset$$ = $CellContext`reset$$ - 
              1], $CellContext`midland$$ = 
            1, $CellContext`feed$$ = {
             0.5, 0.7 (Sqrt[3]/2)}, $CellContext`solvent$$ = {
             0.5, 0.7 (Sqrt[3]/2)}, $CellContext`line1$$ = {
             0.35, 0.6 (Sqrt[3]/2)}, $CellContext`line2$$ = {
             0.65, 0.6 (Sqrt[3]/2)}, $CellContext`mixing$$ = {
             0.5, 0.7 (Sqrt[3]/2)}, 
            
            If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 
          PaneSelector[{1 -> Style["(1) feed composition", 
              RGBColor[1, 0.4, 0]], 2 -> Style["(2) solvent composition", 
              RGBColor[0, 0.6, 0]], 3 -> "(3) draw mass balance line", 4 -> 
            Style["(4) mixing point composition", 
              RGBColor[0.5, 0, 0.5]], 5 -> "(5) mixing point composition", 6 -> 
            "(6) outlet streams"}, 
           Dynamic[$CellContext`midland$$]], 
          PaneSelector[{1 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`midland$$, Less, 
                 6], $CellContext`midland$$ = $CellContext`midland$$ + 
                 1, $CellContext`midland$$ = 6], 
               
               If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 2 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`midland$$, Less, 
                 6], $CellContext`midland$$ = $CellContext`midland$$ + 
                 1, $CellContext`midland$$ = 6], 
               
               If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 3 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`midland$$, Less, 
                 6], $CellContext`midland$$ = $CellContext`midland$$ + 
                 1, $CellContext`midland$$ = 6], 
               
               If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 4 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`midland$$, Less, 
                 6], $CellContext`midland$$ = $CellContext`midland$$ + 
                 1, $CellContext`midland$$ = 6], 
               
               If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 5 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`midland$$, Less, 
                 6], $CellContext`midland$$ = $CellContext`midland$$ + 
                 1, $CellContext`midland$$ = 6], 
               
               If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}]}, 
           Dynamic[$CellContext`midland$$]], 
          Manipulate`Place[1], 
          Spacer[15], 
          Manipulate`Place[2], 
          Manipulate`Place[3]}}]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`wtA$$], 80, 
       Style["solute", 
        RGBColor[0, 0, 1]]}, 0, 100, 1}, {{
       Hold[$CellContext`wtC$$], 20, 
       Style["carrier", 
        RGBColor[0.8, 0, 0.01]]}, 0, 100, 1}, {{
       Hold[$CellContext`wtS$$], 0, 
       Style["solvent", 
        RGBColor[0, 0.6, 0]]}, 0, 100, 1}, {{
       Hold[$CellContext`feed$$], {0.5, 0.606217782649107}}, Automatic}, {{
       Hold[$CellContext`solvent$$], {0.5, 0.606217782649107}}, Automatic}, {{
       Hold[$CellContext`line1$$], {0.006000000000000005, 
       0.013999999999999985`}}, Automatic}, {{
       Hold[$CellContext`line2$$], {0.8220000000000001, 0.308}}, Automatic}, {{
       Hold[$CellContext`mixing$$], {0.5, 0.606217782649107}}, Automatic}, {{
       Hold[$CellContext`outletE$$], {0.2, 0.08660254037844387}}, 
      Automatic}, {{
       Hold[$CellContext`outletR$$], {0.6, 0.34641016151377546`}}, 
      Automatic}, {
      Hold[
       Grid[{{
          PaneSelector[{5 -> Row[{"mass percent (%):", 
               Spacer[5], 
               Manipulate`Place[4], 
               Manipulate`Place[5], 
               Manipulate`Place[6]}]}, 
           Dynamic[$CellContext`midland$$]], 
          
          PaneSelector[{
           1 -> Manipulate`Place[7], 2 -> Manipulate`Place[8], 3 -> Row[{
               Manipulate`Place[9], 
               Manipulate`Place[10]}], 4 -> Manipulate`Place[11], 6 -> Row[{
               Manipulate`Place[12], 
               Manipulate`Place[13]}]}, 
           Dynamic[$CellContext`midland$$]]}}]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = Automatic, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    False, $CellContext`midland$124631$$ = 0, $CellContext`solution$124632$$ =
     False, $CellContext`reset$124633$$ = 0, $CellContext`wtA$124634$$ = 
    0, $CellContext`wtC$124635$$ = 0, $CellContext`wtS$124636$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`feed$$ = {0.5, 
         0.606217782649107}, $CellContext`line1$$ = {0.006000000000000005, 
         0.013999999999999985`}, $CellContext`line2$$ = {0.8220000000000001, 
         0.308}, $CellContext`midland$$ = 
        3, $CellContext`mixing$$ = {0.5, 
         0.606217782649107}, $CellContext`outletE$$ = {0.2, 
         0.08660254037844387}, $CellContext`outletR$$ = {0.6, 
         0.34641016151377546`}, $CellContext`reset$$ = 
        1, $CellContext`solution$$ = 
        True, $CellContext`solvent$$ = {0.5, 
         0.606217782649107}, $CellContext`wtA$$ = 80, $CellContext`wtC$$ = 
        20, $CellContext`wtS$$ = 0}, "ControllerVariables" :> {
        Hold[$CellContext`midland$$, $CellContext`midland$124631$$, 0], 
        Hold[$CellContext`solution$$, $CellContext`solution$124632$$, False], 
        Hold[$CellContext`reset$$, $CellContext`reset$124633$$, 0], 
        Hold[$CellContext`wtA$$, $CellContext`wtA$124634$$, 0], 
        Hold[$CellContext`wtC$$, $CellContext`wtC$124635$$, 0], 
        Hold[$CellContext`wtS$$, $CellContext`wtS$124636$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`part$, $CellContext`phase$, $CellContext`tie$, \
$CellContext`feedA$, $CellContext`feedC$, $CellContext`feedS$, \
$CellContext`FtoS$, $CellContext`mF$, $CellContext`mS$, $CellContext`mM$, \
$CellContext`xM$, $CellContext`massA$, $CellContext`massC$, \
$CellContext`massS$, $CellContext`func1$, $CellContext`func2$, \
$CellContext`xmix$, $CellContext`ymix$, $CellContext`tieline$, \
$CellContext`lower$, $CellContext`upper$, $CellContext`lever$, \
$CellContext`newtie$, $CellContext`x1$, $CellContext`x2$}, 
        SeedRandom[$CellContext`reset$$]; $CellContext`part$ = 
         RandomInteger[{1, 5}]; $CellContext`phase$ = 
         Part[{$CellContext`phase1, $CellContext`phase2, $CellContext`phase3, \
$CellContext`phase4, $CellContext`phase5}, $CellContext`part$]; \
$CellContext`tie$ = 
         Part[{$CellContext`tie1, $CellContext`tie2, $CellContext`tie3, \
$CellContext`tie4, $CellContext`tie5}, $CellContext`part$]; \
$CellContext`feedA$ = RandomInteger[{25, 55}]; $CellContext`feedC$ = 
         100 - $CellContext`feedA$; $CellContext`feedS$ = 
         100 - $CellContext`feedA$ - $CellContext`feedC$; $CellContext`FtoS$ = 
         RandomReal[{0.1, 5}]; $CellContext`mF$ = 
         50; $CellContext`mS$ = $CellContext`mF$/$CellContext`FtoS$; \
$CellContext`mM$ = $CellContext`mF$ + $CellContext`mS$; $CellContext`xM$ = \
$CellContext`mS$/($CellContext`mF$ + $CellContext`mS$); $CellContext`massA$ = \
($CellContext`mF$/($CellContext`mF$ + $CellContext`mS$)) ($CellContext`feedA$/
           100); $CellContext`massC$ = ($CellContext`mF$/($CellContext`mF$ + \
$CellContext`mS$)) ($CellContext`feedC$/
           100); $CellContext`massS$ = $CellContext`mS$/($CellContext`mF$ + \
$CellContext`mS$); $CellContext`func1$[
           Pattern[$CellContext`x$, 
            Blank[]]] := (-
            Sqrt[3]) ($CellContext`x$ - (1 - $CellContext`xM$) (Sqrt[3]/2)/
            Tan[$CellContext`\[Theta]]) + (1 - $CellContext`xM$) (Sqrt[3]/
            2); $CellContext`func2$[
           Pattern[$CellContext`x$, 
            Blank[]]] := ((($CellContext`feedA$/100) (Sqrt[3]/2))/(
            1 - ($CellContext`feedA$/100) ((Sqrt[3]/2)/
             Tan[$CellContext`\[Theta]]))) ($CellContext`x$ - (
            1 - ($CellContext`feedA$/100) ((Sqrt[3]/2)/
             Tan[$CellContext`\[Theta]]))) + ($CellContext`feedA$/100) (
            Sqrt[3]/2); $CellContext`xmix$ = ReplaceAll[$CellContext`x, 
           Quiet[
            Part[
             
             Solve[$CellContext`func1$[$CellContext`x] == \
$CellContext`func2$[$CellContext`x], $CellContext`x], 
             1]]]; $CellContext`ymix$ = \
$CellContext`func1$[$CellContext`xmix$]; $CellContext`tieline$[
           Pattern[$CellContext`list, 
            Blank[]], 
           Pattern[$CellContext`line, 
            Blank[]], 
           Pattern[$CellContext`x, 
            Blank[]]] := ReplaceAll[
           Fit[
            Part[$CellContext`list, $CellContext`line], {
            1, $CellContext`z}, $CellContext`z], $CellContext`z -> \
$CellContext`x]; $CellContext`lower$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Which[$CellContext`ymix$ <= $CellContext`tieline$[$CellContext`tie$, 
             1, $CellContext`xmix$], 0, 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 1, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 1, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 4, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 4, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 5, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 
            4, $CellContext`x$], $CellContext`tieline$[$CellContext`tie$, 
             5, $CellContext`xmix$] < $CellContext`ymix$, 
           $CellContext`tieline$[$CellContext`tie$, 
            5, $CellContext`x$]]; $CellContext`upper$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Which[$CellContext`ymix$ <= $CellContext`tieline$[$CellContext`tie$, 
             1, $CellContext`xmix$], 
           $CellContext`tieline$[$CellContext`tie$, 1, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 1, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 4, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 4, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 4, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 5, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 
            5, $CellContext`x$], $CellContext`tieline$[$CellContext`tie$, 
             5, $CellContext`xmix$] < $CellContext`ymix$, 
           $CellContext`tieline$[$CellContext`tie$, 
            5, $CellContext`x$]]; $CellContext`lever$ = 
         If[$CellContext`ymix$ > $CellContext`tieline$[$CellContext`tie$, 
             5, $CellContext`xmix$], 
           1, ($CellContext`ymix$ - \
$CellContext`lower$[$CellContext`xmix$])/($CellContext`upper$[$CellContext`\
xmix$] - $CellContext`lower$[$CellContext`xmix$])]; $CellContext`newtie$[
           Pattern[$CellContext`x$, 
            Blank[]]] := (
            1 - $CellContext`lever$) $CellContext`lower$[$CellContext`x$] + \
$CellContext`lever$ $CellContext`upper$[$CellContext`x$]; $CellContext`x1$ = 
         ReplaceAll[$CellContext`x, 
           
           FindRoot[$CellContext`newtie$[$CellContext`x] == 
            Interpolation[$CellContext`phase$][$CellContext`x], \
{$CellContext`x, 0.1}]]; $CellContext`x2$ = ReplaceAll[$CellContext`x, 
           
           FindRoot[$CellContext`newtie$[$CellContext`x] == 
            Interpolation[$CellContext`phase$][$CellContext`x], \
{$CellContext`x, 0.9}]]; If[$CellContext`ymix$ > Quiet[
            
            Interpolation[$CellContext`phase$][$CellContext`xmix$]], \
$CellContext`reset$$ = $CellContext`reset$$ + 1]; 
        Show[$CellContext`gridlines, $CellContext`diagram, 
          PlotRange -> {{-0.25, 1.25}, {-0.2, 0.95}}, ImageSize -> {600, 390},
           Epilog -> {{Thick, 
             Line[
              Map[{#, 
                Interpolation[$CellContext`phase$][#]}& , 
               Range[
                Part[$CellContext`phase$, 1, 1], 
                Part[$CellContext`phase$, -1, 1], 0.01]]], 
             Line[$CellContext`tie$]}, 
            If[$CellContext`midland$$ == 1, {
              Text[
               Style[
                Column[{"mass % in feed", 
                  Framed[
                   Column[{
                    Row[{"solute = ", $CellContext`feedA$, "%"}], 
                    Row[{"carrier = ", $CellContext`feedC$, "%"}], 
                    Row[{"solvent = ", $CellContext`feedS$, "%"}]}, Alignment -> 
                    "="], Background -> White]}, Center], 17], {
               0, 0.9 (Sqrt[3]/2)}], 
              $CellContext`pt2[$CellContext`feed$$, $CellContext`colF], 
              Text[
               Style[
               "feed", 17, $CellContext`colF, Background -> 
                White], $CellContext`feed$$, {0, -1.75}], 
              If[$CellContext`solution$$, 
               $CellContext`pt1[{
                1 - ($CellContext`feedA$/100) (Sqrt[3]/2)/
                 Tan[$CellContext`\[Theta]], ($CellContext`feedA$/100) (
                  Sqrt[3]/2)}, $CellContext`colF]]}], 
            If[$CellContext`midland$$ > 1, {
              $CellContext`pt1[{
               1 - ($CellContext`feedA$/100) (Sqrt[3]/2)/
                Tan[$CellContext`\[Theta]], ($CellContext`feedA$/100) (
                 Sqrt[3]/2)}, $CellContext`colF], 
              Text[
               Style[" F ", 17, $CellContext`colF, Background -> White], {
               1 - ($CellContext`feedA$/100) (Sqrt[3]/2)/
                Tan[$CellContext`\[Theta]], ($CellContext`feedA$/100) (
                 Sqrt[3]/2)}, {0, -2}]}], 
            If[$CellContext`midland$$ == 2, {
              Text[
               Style[
                Column[{"mass % in solvent", 
                  Framed[
                   Column[{
                    Row[{"solute = ", 0, "%"}], 
                    Row[{"carrier = ", 0, "%"}], 
                    Row[{"solvent = ", 100, "%"}]}, Alignment -> "="], 
                   Background -> White]}, Center], 17], {0, 0.9 (Sqrt[3]/2)}], 
              $CellContext`pt2[$CellContext`solvent$$, $CellContext`colS], 
              Text[
               Style[
               "solvent", 17, $CellContext`colS, Background -> 
                White], $CellContext`solvent$$, {0, -1.75}], 
              If[$CellContext`solution$$, 
               $CellContext`pt1[{0, 0}, $CellContext`colS]]}], 
            If[$CellContext`midland$$ > 2, {
              $CellContext`pt1[{0, 0}, $CellContext`colS], 
              Text[
               Style["S", 17, $CellContext`colS, Background -> White], {0, 
               0}, {0, -2}]}], 
            If[$CellContext`midland$$ == 3, {{
               Thickness[0.007], 
               CapForm[None], Dashed, Magenta, 
               Line[{$CellContext`line1$$, $CellContext`line2$$}]}, 
              $CellContext`pt2[$CellContext`line1$$, Magenta], 
              $CellContext`pt2[$CellContext`line2$$, Magenta], 
              If[$CellContext`solution$$, {
                Thickness[0.007], 
                CapForm[None], Magenta, 
                
                Line[{{0, 0}, {
                  1 - ($CellContext`feedA$/100) ((Sqrt[3]/2)/
                    Tan[$CellContext`\[Theta]]), ($CellContext`feedA$/100) (
                    Sqrt[3]/2)}}]}]}], 
            If[$CellContext`midland$$ > 3, {
              Thickness[0.007], 
              CapForm[None], Magenta, 
              
              Line[{{0, 0}, {
                1 - ($CellContext`feedA$/100) ((Sqrt[3]/2)/
                  Tan[$CellContext`\[Theta]]), ($CellContext`feedA$/100) (
                  Sqrt[3]/2)}}]}], 
            If[$CellContext`midland$$ == 4, {
              $CellContext`pt2[$CellContext`mixing$$, $CellContext`colM], 
              Text[
               Style[
               "mixing", 17, $CellContext`colM, Background -> 
                White], $CellContext`mixing$$, {0, -1.75}], 
              If[$CellContext`solution$$ == False, 
               Text[
                Style[
                 Column[{"mass flow (kg/h)", 
                   Framed[
                    Column[{
                    Row[{"feed = ", 
                    NumberForm[$CellContext`mF$, {5, 1}]}], 
                    Row[{"solvent = ", 
                    NumberForm[$CellContext`mS$, {5, 1}]}]}, Alignment -> 
                    "="], Background -> White], 
                   Row[{
                    Style["F", Italic], "/", 
                    Style["S", Italic], " = ", 
                    NumberForm[$CellContext`FtoS$, {5, 1}]}]}, Center], 17], {
                1, 0.9 (Sqrt[3]/2)}]], 
              If[$CellContext`solution$$, 
               $CellContext`pt1[{$CellContext`xmix$, 
                 $CellContext`func1$[$CellContext`xmix$]}, \
$CellContext`colM]]}], 
            If[$CellContext`midland$$ > 4, {
              $CellContext`pt1[{$CellContext`xmix$, 
                $CellContext`func1$[$CellContext`xmix$]}, $CellContext`colM], 
              Text[
               Style[
               "M", 17, $CellContext`colM, Background -> 
                White], {$CellContext`xmix$, 
                $CellContext`func1$[$CellContext`xmix$]}, {0, -2}]}], 
            If[$CellContext`midland$$ == 5, {
              If[$CellContext`solution$$, 
               Text[
                Framed[
                 Style[
                  Column[{
                    Style[
                    Row[{"solute = ", 
                    NumberForm[$CellContext`massA$ 100, {4, 0}], 
                    "%"}], $CellContext`colA], 
                    Style[
                    Row[{"carrier = ", 
                    NumberForm[$CellContext`massC$ 100, {4, 0}], 
                    "%"}], $CellContext`colC], 
                    Style[
                    Row[{"solvent = ", 
                    NumberForm[$CellContext`massS$ 100, {4, 0}], 
                    "%"}], $CellContext`colS]}, Alignment -> "="], 17], 
                 Background -> White], {1, 0.9 (Sqrt[3]/2)}]], 
              If[$CellContext`solution$$ == False, 
               Text[
                Style[
                 Column[{"mass flow (kg/h)", 
                   Framed[
                    Column[{
                    Row[{"feed = ", 
                    NumberForm[$CellContext`mF$, {5, 1}]}], 
                    Row[{"solvent = ", 
                    NumberForm[$CellContext`mS$, {5, 1}]}]}, Alignment -> 
                    "="], Background -> White], 
                   Row[{
                    Style["F", Italic], "/", 
                    Style["S", Italic], " = ", 
                    NumberForm[$CellContext`FtoS$, {5, 1}]}]}, Center], 17], {
                1, 0.9 (Sqrt[3]/2)}]]}], 
            If[$CellContext`midland$$ == 6, {{Thick, Dashed, 
               Line[{$CellContext`outletE$$, $CellContext`outletR$$}]}, 
              $CellContext`pt2[$CellContext`outletE$$, $CellContext`colE], 
              $CellContext`pt2[$CellContext`outletR$$, $CellContext`colR], 
              Apply[If[$CellContext`solution$$ == False, 
                Text[
                 Style[#, 17, #2, Background -> White], #3, {0, -1.75}]]& , {{
                "extract", $CellContext`colE, $CellContext`outletE$$}, {
                "raffinate", $CellContext`colR, $CellContext`outletR$$}}, {
               1}], 
              If[$CellContext`solution$$, {
                Thickness[0.0075], Dashed, Orange, 
                Line[
                 Map[{#, 
                   $CellContext`newtie$[#]}& , 
                  Range[$CellContext`x1$, $CellContext`x2$, 0.01]]], 
                $CellContext`pt1[{$CellContext`x1$, 
                  $CellContext`newtie$[$CellContext`x1$]}, $CellContext`colE], 
                $CellContext`pt1[{$CellContext`x2$, 
                  $CellContext`newtie$[$CellContext`x2$]}, $CellContext`colR], 
                Text[
                 Style[
                 "E", 17, $CellContext`colE, Background -> 
                  White], {$CellContext`x1$, 
                  $CellContext`newtie$[$CellContext`x1$]}, {0, -1.75}], 
                Text[
                 Style[
                 "R", 17, $CellContext`colR, Background -> 
                  White], {$CellContext`x2$, 
                  $CellContext`newtie$[$CellContext`x2$]}, {0, -1.75}]}]}]}]],
       "Specifications" :> {
        Style[
         PaneSelector[{
          1 -> "step 1: move the point to the correct feed composition", 2 -> 
           "step 2: move the point to the correct solvent composition", 3 -> 
           "step 3: draw a line connecting feed and solvent compositions", 4 -> 
           "step 4: move the point to the correct mixing point location", 5 -> 
           "step 5: use sliders to set the correct mass percentages of the \
mixing point", 6 -> "step 6: determine outlet compositions"}, 
          Dynamic[$CellContext`midland$$]], 
         Bold], {{$CellContext`midland$$, 3, ""}, {1, 2, 3, 4, 5, 6}, 
         ControlType -> None, ControlPlacement -> 
         1}, {{$CellContext`solution$$, True, "solution"}, {True, False}, 
         Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         2}, {{$CellContext`reset$$, 1}, 1, 1000, 1, ControlType -> None, 
         ControlPlacement -> 3}, 
        Grid[{{
           Button[" new problem ", {
             
             If[$CellContext`reset$$ < 
              1000, $CellContext`reset$$ = $CellContext`reset$$ + 
               1, $CellContext`reset$$ = $CellContext`reset$$ - 
               1], $CellContext`midland$$ = 
             1, $CellContext`feed$$ = {
              0.5, 0.7 (Sqrt[3]/2)}, $CellContext`solvent$$ = {
              0.5, 0.7 (Sqrt[3]/2)}, $CellContext`line1$$ = {
              0.35, 0.6 (Sqrt[3]/2)}, $CellContext`line2$$ = {
              0.65, 0.6 (Sqrt[3]/2)}, $CellContext`mixing$$ = {
              0.5, 0.7 (Sqrt[3]/2)}, 
             
             If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 
           PaneSelector[{1 -> Style["(1) feed composition", 
               RGBColor[1, 0.4, 0]], 2 -> Style["(2) solvent composition", 
               RGBColor[0, 0.6, 0]], 3 -> "(3) draw mass balance line", 4 -> 
             Style["(4) mixing point composition", 
               RGBColor[0.5, 0, 0.5]], 5 -> "(5) mixing point composition", 6 -> 
             "(6) outlet streams"}, 
            Dynamic[$CellContext`midland$$]], 
           PaneSelector[{1 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`midland$$, Less, 
                  6], $CellContext`midland$$ = $CellContext`midland$$ + 
                  1, $CellContext`midland$$ = 6], 
                
                If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 2 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`midland$$, Less, 
                  6], $CellContext`midland$$ = $CellContext`midland$$ + 
                  1, $CellContext`midland$$ = 6], 
                
                If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 3 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`midland$$, Less, 
                  6], $CellContext`midland$$ = $CellContext`midland$$ + 
                  1, $CellContext`midland$$ = 6], 
                
                If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 4 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`midland$$, Less, 
                  6], $CellContext`midland$$ = $CellContext`midland$$ + 
                  1, $CellContext`midland$$ = 6], 
                
                If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 5 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`midland$$, Less, 
                  6], $CellContext`midland$$ = $CellContext`midland$$ + 
                  1, $CellContext`midland$$ = 6], 
                
                If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}]}, 
            Dynamic[$CellContext`midland$$]], 
           Manipulate`Place[1], 
           Spacer[15], 
           Manipulate`Place[2], 
           Manipulate`Place[3]}}], {{$CellContext`wtA$$, 80, 
          Style["solute", 
           RGBColor[0, 0, 1]]}, 0, 100, 1, Appearance -> "Labeled", ImageSize -> 
         Tiny, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         4}, {{$CellContext`wtC$$, 20, 
          Style["carrier", 
           RGBColor[0.8, 0, 0.01]]}, 0, 100, 1, Appearance -> "Labeled", 
         ImageSize -> Tiny, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         5}, {{$CellContext`wtS$$, 0, 
          Style["solvent", 
           RGBColor[0, 0.6, 0]]}, 0, 100, 1, Appearance -> "Labeled", 
         ImageSize -> Tiny, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         6}, {{$CellContext`feed$$, {0.5, 0.606217782649107}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         7}, {{$CellContext`solvent$$, {0.5, 0.606217782649107}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         8}, {{$CellContext`line1$$, {0.006000000000000005, 
          0.013999999999999985`}}, Automatic, ControlType -> Locator, 
         Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         9}, {{$CellContext`line2$$, {0.8220000000000001, 0.308}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         10}, {{$CellContext`mixing$$, {0.5, 0.606217782649107}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         11}, {{$CellContext`outletE$$, {0.2, 0.08660254037844387}}, 
         Automatic, ControlType -> Locator, Appearance -> None, Enabled -> 
         Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         12}, {{$CellContext`outletR$$, {0.6, 0.34641016151377546`}}, 
         Automatic, ControlType -> Locator, Appearance -> None, Enabled -> 
         Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 13}, 
        Grid[{{
           PaneSelector[{5 -> Row[{"mass percent (%):", 
                Spacer[5], 
                Manipulate`Place[4], 
                Manipulate`Place[5], 
                Manipulate`Place[6]}]}, 
            Dynamic[$CellContext`midland$$]], 
           
           PaneSelector[{
            1 -> Manipulate`Place[7], 2 -> Manipulate`Place[8], 3 -> Row[{
                Manipulate`Place[9], 
                Manipulate`Place[10]}], 4 -> Manipulate`Place[11], 6 -> Row[{
                Manipulate`Place[12], 
                Manipulate`Place[13]}]}, 
            Dynamic[$CellContext`midland$$]]}}]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`phase = 
       InterpolatingFunction[{{0.08, 0.98}}, {
         5, 7, 0, {12}, {4}, 0, 0, 0, 0, Automatic, {}, {}, False}, {{0.08, 
         0.15, 0.19, 0.25, 0.33, 0.44, 0.61, 0.68, 0.77, 0.83, 0.88, 0.98}}, {
         Developer`PackedArrayForm, {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 
          12}, {0., 0.1, 0.17, 0.26, 0.37, 0.45, 0.46, 0.43, 0.35, 0.26, 0.17,
           0.}}, {Automatic}], $CellContext`phase1 = {{0.09, 0}, {0.17, 
         0.13}, {0.28, 0.3}, {0.41, 0.44}, {0.55, 0.47}, {0.7, 0.42}, {0.83, 
         0.26}, {0.98, 0}}, $CellContext`phase2 = {{0.0545, 0}, {0.136, 
         0.134}, {0.226, 0.267}, {0.3405, 0.36}, {0.534, 0.398}, {0.673, 
         0.338}, {0.7925, 0.232}, {0.956, 0}}, $CellContext`phase3 = {{
         0.098, 0}, {0.172, 0.126}, {0.2285, 0.213}, {0.422, 0.338}, {0.55, 
         0.352}, {0.7055, 0.284}, {0.7925, 0.205}, {
         0.92, 0}}, $CellContext`phase4 = {{0.07, 0}, {0.14, 0.14}, {0.26, 
         0.35}, {0.42, 0.56}, {0.56, 0.59}, {0.7, 0.42}, {0.82, 0.24}, {
         0.95, 0}}, $CellContext`phase5 = {{0, 0}, {0.12, 0.15}, {0.23, 
         0.32}, {0.34, 0.45}, {0.6, 0.5}, {0.69, 0.42}, {0.77, 0.3}, {
         0.93, 0}}, $CellContext`tie1 = {{{0.12, 0.052}, {0.93, 0.078}}, {{
        0.16, 0.104}, {0.88, 0.173}}, {{0.2, 0.173}, {0.83, 0.26}}, {{0.26, 
        0.268}, {0.77, 0.346}}, {{0.34, 0.372}, {0.67, 
        0.433}}}, $CellContext`tie2 = {{{0.1, 0.07}, {0.9, 0.09}}, {{0.13, 
        0.12}, {0.84, 0.17}}, {{0.17, 0.18}, {0.77, 0.25}}, {{0.2, 0.23}, {
        0.7, 0.32}}, {{0.24, 0.28}, {0.64, 0.36}}}, $CellContext`tie3 = {{{
        0.12, 0.03}, {0.89, 0.06}}, {{0.15, 0.09}, {0.86, 0.11}}, {{0.19, 
        0.15}, {0.82, 0.17}}, {{0.24, 0.23}, {0.72, 0.27}}, {{0.28, 0.27}, {
        0.65, 0.32}}}, $CellContext`tie4 = {{{0.1, 0.06}, {0.9, 0.1}}, {{0.15,
         0.15}, {0.84, 0.21}}, {{0.21, 0.26}, {0.75, 0.35}}, {{0.28, 0.37}, {
        0.67, 0.46}}, {{0.37, 0.51}, {0.59, 0.56}}}, $CellContext`tie5 = {{{
        0.065, 0.07}, {0.87, 0.11}}, {{0.11, 0.13}, {0.83, 0.2}}, {{0.17, 
        0.22}, {0.76, 0.32}}, {{0.24, 0.33}, {0.69, 0.41}}, {{0.33, 0.44}, {
        0.6, 0.5}}}, $CellContext`\[Theta] = 
       60 Degree, $CellContext`gridlines = Graphics[{
          GrayLevel[0.65], {{
            
            Line[{{0.025, 0.04330127018922193}, {0.975, 
             0.04330127018922193}}], 
            Line[{{0.05, 0}, {0.025, 0.04330127018922193}}], 
            Line[{{0.95, 0}, {0.975, 0.04330127018922193}}]}, {
            
            Line[{{0.07500000000000001, 0.1299038105676658}, {0.925, 
             0.1299038105676658}}], 
            
            Line[{{0.15000000000000002`, 0}, {0.07500000000000001, 
              0.1299038105676658}}], 
            Line[{{0.85, 0}, {0.925, 0.1299038105676658}}]}, {
            
            Line[{{0.125, 0.21650635094610965`}, {0.875, 
             0.21650635094610965`}}], 
            Line[{{0.25, 0}, {0.125, 0.21650635094610965`}}], 
            Line[{{0.75, 0}, {0.875, 0.21650635094610965`}}]}, {
            
            Line[{{0.17500000000000002`, 0.30310889132455354`}, {0.825, 
             0.30310889132455354`}}], 
            
            Line[{{0.35000000000000003`, 0}, {0.17500000000000002`, 
              0.30310889132455354`}}], 
            Line[{{0.6499999999999999, 0}, {0.825, 0.30310889132455354`}}]}, {
            Line[{{0.225, 0.3897114317029974}, {0.775, 0.3897114317029974}}], 
            Line[{{0.45, 0}, {0.225, 0.3897114317029974}}], 
            Line[{{0.55, 0}, {0.775, 0.3897114317029974}}]}, {
            Line[{{0.275, 0.4763139720814413}, {0.725, 0.4763139720814413}}], 
            Line[{{0.55, 0}, {0.275, 0.4763139720814413}}], 
            Line[{{0.44999999999999996`, 0}, {0.725, 0.4763139720814413}}]}, {
            
            Line[{{0.32500000000000007`, 0.5629165124598852}, {
             0.6749999999999999, 0.5629165124598852}}], 
            
            Line[{{0.6500000000000001, 0}, {0.32500000000000007`, 
              0.5629165124598852}}], 
            
            Line[{{0.34999999999999987`, 0}, {0.6749999999999999, 
              0.5629165124598852}}]}, {
            
            Line[{{0.37500000000000006`, 0.649519052838329}, {0.625, 
             0.649519052838329}}], 
            
            Line[{{0.7500000000000001, 0}, {0.37500000000000006`, 
              0.649519052838329}}], 
            Line[{{0.2499999999999999, 0}, {0.625, 0.649519052838329}}]}, {
            
            Line[{{0.42500000000000004`, 0.7361215932167728}, {0.575, 
             0.7361215932167728}}], 
            
            Line[{{0.8500000000000001, 0}, {0.42500000000000004`, 
              0.7361215932167728}}], 
            Line[{{0.1499999999999999, 0}, {0.575, 0.7361215932167728}}]}, {
            Line[{{0.475, 0.8227241335952167}, {0.525, 0.8227241335952167}}], 
            Line[{{0.95, 0}, {0.475, 0.8227241335952167}}], 
            
            Line[{{0.050000000000000044`, 0}, {0.525, 
              0.8227241335952167}}]}}, {{
            Line[{{0.05, 0.08660254037844387}, {0.97, 0.08660254037844387}}], 
            Line[{{0.1, 0}, {0.0485, 0.08920061658979718}}], 
            Line[{{0.88, -0.02}, {0.95, 0.08660254037844387}}]}, {
            Line[{{0.1, 0.17320508075688773`}, {0.92, 0.17320508075688773`}}], 
            Line[{{0.2, 0}, {0.097, 0.17840123317959436`}}], 
            Line[{{0.78, -0.02}, {0.9, 0.17320508075688773`}}]}, {
            
            Line[{{0.15000000000000002`, 0.2598076211353316}, {0.87, 
             0.2598076211353316}}], 
            
            Line[{{0.30000000000000004`, 0}, {0.14550000000000002`, 
              0.26760184976939155`}}], 
            Line[{{0.6799999999999999, -0.02}, {0.85, 0.2598076211353316}}]}, {
            
            Line[{{0.2, 0.34641016151377546`}, {0.8200000000000001, 
             0.34641016151377546`}}], 
            Line[{{0.4, 0}, {0.194, 0.3568024663591887}}], 
            Line[{{0.58, -0.02}, {0.8, 0.34641016151377546`}}]}, {
            Line[{{0.25, 0.4330127018922193}, {0.77, 0.4330127018922193}}], 
            Line[{{0.5, 0}, {0.2425, 0.4460030829489859}}], 
            Line[{{0.48, -0.02}, {0.75, 0.4330127018922193}}]}, {
            Line[{{0.3, 0.5196152422706631}, {0.72, 0.5196152422706631}}], 
            Line[{{0.6, 0}, {0.291, 0.535203699538783}}], 
            Line[{{0.38, -0.02}, {0.7, 0.5196152422706631}}]}, {
            
            Line[{{0.35000000000000003`, 0.6062177826491071}, {
             0.6699999999999999, 0.6062177826491071}}], 
            Line[{{0.7000000000000001, 0}, {0.3395, 0.6244043161285803}}], 
            
            Line[{{0.2799999999999999, -0.02}, {0.6499999999999999, 
             0.6062177826491071}}]}, {
            Line[{{0.4, 0.6928203230275509}, {0.62, 0.6928203230275509}}], 
            Line[{{0.8, 0}, {0.388, 0.7136049327183774}}], 
            
            Line[{{0.17999999999999994`, -0.02}, {0.6, 
             0.6928203230275509}}]}, {
            
            Line[{{0.45, 0.7794228634059948}, {0.5700000000000001, 
             0.7794228634059948}}], 
            Line[{{0.9, 0}, {0.4365, 0.8028055493081746}}], 
            
            Line[{{0.07999999999999996, -0.02}, {0.55, 
             0.7794228634059948}}]}}}], $CellContext`diagram = Graphics[{{
           EdgeForm[
            Thickness[Large]], 
           FaceForm[None], 
           Polygon[{{0, 0}, {0.5, Sqrt[3]/2}, {1, 0}}]}, {{
            RGBColor[0, 0, 1], 
            Text[
             Style[10., 16], {0.95, 0.08660254037844387}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[90., 16], (-60) Degree], {0.05, 0.08660254037844387}, {
             1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[10., 16], 60 Degree], {0.1, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[20., 16], {0.9, 0.17320508075688773`}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[80., 16], (-60) Degree], {0.1, 0.17320508075688773`}, {
             1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[20., 16], 60 Degree], {0.2, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[30.000000000000004`, 16], {0.85, 0.2598076211353316}, {-2, 
             0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[70., 16], (-60) Degree], {0.15000000000000002`, 
             0.2598076211353316}, {1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[30.000000000000004`, 16], 60 Degree], {
             0.30000000000000004`, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[40., 16], {0.8, 0.34641016151377546`}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[60., 16], (-60) Degree], {0.2, 0.34641016151377546`}, {
             1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[40., 16], 60 Degree], {0.4, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[50., 16], {0.75, 0.4330127018922193}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[50., 16], (-60) Degree], {0.25, 0.4330127018922193}, {
             1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[50., 16], 60 Degree], {0.5, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[60., 16], {0.7, 0.5196152422706631}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[40., 16], (-60) Degree], {0.3, 0.5196152422706631}, {
             1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[60., 16], 60 Degree], {0.6, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[70., 16], {0.6499999999999999, 0.6062177826491071}, {-2, 
             0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[29.999999999999993`, 16], (-60) Degree], {
             0.35000000000000003`, 0.6062177826491071}, {1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[70., 16], 60 Degree], {0.7000000000000001, 0}, {1.2, 
             1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[80., 16], {0.6, 0.6928203230275509}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[19.999999999999996`, 16], (-60) Degree], {0.4, 
             0.6928203230275509}, {1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[80., 16], 60 Degree], {0.8, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[90., 16], {0.55, 0.7794228634059948}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[9.999999999999998, 16], (-60) Degree], {0.45, 
             0.7794228634059948}, {1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[90., 16], 60 Degree], {0.9, 0}, {1.2, 1.5}]}}, 
          Text[
           Rotate[
            Style["solute", 17, 
             RGBColor[0, 0, 1]], (-60) Degree], {0.75, Sqrt[3]/4}, {-3, 0}], 
          Text[
           Rotate[
            Style["solvent", 17, 
             RGBColor[0, 0.6, 0]], 60 Degree], {0.25, Sqrt[3]/4}, {3, 0}], 
          Text[
           Style["carrier", 17, 
            RGBColor[0.8, 0, 0.01]], {0.5, 0}, {0, 5}], Null}], 
       Attributes[PlotRange] = {ReadProtected}, $CellContext`pt2[
         Pattern[$CellContext`pt, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]]] := {
         PointSize[0.03], $CellContext`col, 
         Point[$CellContext`pt], 
         PointSize[0.015], White, 
         Point[$CellContext`pt]}, $CellContext`colF = 
       RGBColor[1, 0.4, 0], $CellContext`pt1[
         Pattern[$CellContext`pt, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]]] := {
         PointSize[0.03], $CellContext`col, 
         Point[$CellContext`pt]}, $CellContext`colS = 
       RGBColor[0, 0.6, 0], $CellContext`colM = 
       RGBColor[0.5, 0, 0.5], $CellContext`colA = 
       RGBColor[0, 0, 1], $CellContext`colC = 
       RGBColor[0.8, 0, 0.01], $CellContext`colE = 
       RGBColor[1, 0, 0], $CellContext`colR = RGBColor[0, 0.6, 1]}; 
     Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->372179902,ExpressionUUID->"68e83353-d83a-4161-ac18-bc9048ac7783"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`feed$$ = {0.5, 
    0.606217782649107}, $CellContext`line1$$ = {0.006000000000000005, 
    0.013999999999999985`}, $CellContext`line2$$ = {0.8220000000000001, 
    0.308}, $CellContext`midland$$ = 5, $CellContext`mixing$$ = {0.5, 
    0.606217782649107}, $CellContext`outletE$$ = {0.2, 
    0.08660254037844387}, $CellContext`outletR$$ = {0.6, 
    0.34641016151377546`}, $CellContext`reset$$ = 1, $CellContext`solution$$ =
     True, $CellContext`solvent$$ = {0.5, 
    0.606217782649107}, $CellContext`wtA$$ = 80, $CellContext`wtC$$ = 
    20, $CellContext`wtS$$ = 0, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[
       Style[
        PaneSelector[{
         1 -> "step 1: move the point to the correct feed composition", 2 -> 
          "step 2: move the point to the correct solvent composition", 3 -> 
          "step 3: draw a line connecting feed and solvent compositions", 4 -> 
          "step 4: move the point to the correct mixing point location", 5 -> 
          "step 5: use sliders to set the correct mass percentages of the \
mixing point", 6 -> "step 6: determine outlet compositions"}, 
         Dynamic[$CellContext`midland$$]], Bold]], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`midland$$], 5, ""}, {1, 2, 3, 4, 5, 6}}, {{
       Hold[$CellContext`solution$$], True, "solution"}, {True, False}}, {{
       Hold[$CellContext`reset$$], 1}, 1, 1000, 1}, {
      Hold[
       Grid[{{
          Button[" new problem ", {
            
            If[$CellContext`reset$$ < 
             1000, $CellContext`reset$$ = $CellContext`reset$$ + 
              1, $CellContext`reset$$ = $CellContext`reset$$ - 
              1], $CellContext`midland$$ = 
            1, $CellContext`feed$$ = {
             0.5, 0.7 (Sqrt[3]/2)}, $CellContext`solvent$$ = {
             0.5, 0.7 (Sqrt[3]/2)}, $CellContext`line1$$ = {
             0.35, 0.6 (Sqrt[3]/2)}, $CellContext`line2$$ = {
             0.65, 0.6 (Sqrt[3]/2)}, $CellContext`mixing$$ = {
             0.5, 0.7 (Sqrt[3]/2)}, 
            
            If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 
          PaneSelector[{1 -> Style["(1) feed composition", 
              RGBColor[1, 0.4, 0]], 2 -> Style["(2) solvent composition", 
              RGBColor[0, 0.6, 0]], 3 -> "(3) draw mass balance line", 4 -> 
            Style["(4) mixing point composition", 
              RGBColor[0.5, 0, 0.5]], 5 -> "(5) mixing point composition", 6 -> 
            "(6) outlet streams"}, 
           Dynamic[$CellContext`midland$$]], 
          PaneSelector[{1 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`midland$$, Less, 
                 6], $CellContext`midland$$ = $CellContext`midland$$ + 
                 1, $CellContext`midland$$ = 6], 
               
               If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 2 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`midland$$, Less, 
                 6], $CellContext`midland$$ = $CellContext`midland$$ + 
                 1, $CellContext`midland$$ = 6], 
               
               If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 3 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`midland$$, Less, 
                 6], $CellContext`midland$$ = $CellContext`midland$$ + 
                 1, $CellContext`midland$$ = 6], 
               
               If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 4 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`midland$$, Less, 
                 6], $CellContext`midland$$ = $CellContext`midland$$ + 
                 1, $CellContext`midland$$ = 6], 
               
               If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 5 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`midland$$, Less, 
                 6], $CellContext`midland$$ = $CellContext`midland$$ + 
                 1, $CellContext`midland$$ = 6], 
               
               If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}]}, 
           Dynamic[$CellContext`midland$$]], 
          Manipulate`Place[1], 
          Spacer[15], 
          Manipulate`Place[2], 
          Manipulate`Place[3]}}]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`wtA$$], 80, 
       Style["solute", 
        RGBColor[0, 0, 1]]}, 0, 100, 1}, {{
       Hold[$CellContext`wtC$$], 20, 
       Style["carrier", 
        RGBColor[0.8, 0, 0.01]]}, 0, 100, 1}, {{
       Hold[$CellContext`wtS$$], 0, 
       Style["solvent", 
        RGBColor[0, 0.6, 0]]}, 0, 100, 1}, {{
       Hold[$CellContext`feed$$], {0.5, 0.606217782649107}}, Automatic}, {{
       Hold[$CellContext`solvent$$], {0.5, 0.606217782649107}}, Automatic}, {{
       Hold[$CellContext`line1$$], {0.006000000000000005, 
       0.013999999999999985`}}, Automatic}, {{
       Hold[$CellContext`line2$$], {0.8220000000000001, 0.308}}, Automatic}, {{
       Hold[$CellContext`mixing$$], {0.5, 0.606217782649107}}, Automatic}, {{
       Hold[$CellContext`outletE$$], {0.2, 0.08660254037844387}}, 
      Automatic}, {{
       Hold[$CellContext`outletR$$], {0.6, 0.34641016151377546`}}, 
      Automatic}, {
      Hold[
       Grid[{{
          PaneSelector[{5 -> Row[{"mass percent (%):", 
               Spacer[5], 
               Manipulate`Place[4], 
               Manipulate`Place[5], 
               Manipulate`Place[6]}]}, 
           Dynamic[$CellContext`midland$$]], 
          
          PaneSelector[{
           1 -> Manipulate`Place[7], 2 -> Manipulate`Place[8], 3 -> Row[{
               Manipulate`Place[9], 
               Manipulate`Place[10]}], 4 -> Manipulate`Place[11], 6 -> Row[{
               Manipulate`Place[12], 
               Manipulate`Place[13]}]}, 
           Dynamic[$CellContext`midland$$]]}}]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = Automatic, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    False, $CellContext`midland$124736$$ = 0, $CellContext`solution$124737$$ =
     False, $CellContext`reset$124738$$ = 0, $CellContext`wtA$124739$$ = 
    0, $CellContext`wtC$124740$$ = 0, $CellContext`wtS$124741$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`feed$$ = {0.5, 
         0.606217782649107}, $CellContext`line1$$ = {0.006000000000000005, 
         0.013999999999999985`}, $CellContext`line2$$ = {0.8220000000000001, 
         0.308}, $CellContext`midland$$ = 
        5, $CellContext`mixing$$ = {0.5, 
         0.606217782649107}, $CellContext`outletE$$ = {0.2, 
         0.08660254037844387}, $CellContext`outletR$$ = {0.6, 
         0.34641016151377546`}, $CellContext`reset$$ = 
        1, $CellContext`solution$$ = 
        True, $CellContext`solvent$$ = {0.5, 
         0.606217782649107}, $CellContext`wtA$$ = 80, $CellContext`wtC$$ = 
        20, $CellContext`wtS$$ = 0}, "ControllerVariables" :> {
        Hold[$CellContext`midland$$, $CellContext`midland$124736$$, 0], 
        Hold[$CellContext`solution$$, $CellContext`solution$124737$$, False], 
        Hold[$CellContext`reset$$, $CellContext`reset$124738$$, 0], 
        Hold[$CellContext`wtA$$, $CellContext`wtA$124739$$, 0], 
        Hold[$CellContext`wtC$$, $CellContext`wtC$124740$$, 0], 
        Hold[$CellContext`wtS$$, $CellContext`wtS$124741$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`part$, $CellContext`phase$, $CellContext`tie$, \
$CellContext`feedA$, $CellContext`feedC$, $CellContext`feedS$, \
$CellContext`FtoS$, $CellContext`mF$, $CellContext`mS$, $CellContext`mM$, \
$CellContext`xM$, $CellContext`massA$, $CellContext`massC$, \
$CellContext`massS$, $CellContext`func1$, $CellContext`func2$, \
$CellContext`xmix$, $CellContext`ymix$, $CellContext`tieline$, \
$CellContext`lower$, $CellContext`upper$, $CellContext`lever$, \
$CellContext`newtie$, $CellContext`x1$, $CellContext`x2$}, 
        SeedRandom[$CellContext`reset$$]; $CellContext`part$ = 
         RandomInteger[{1, 5}]; $CellContext`phase$ = 
         Part[{$CellContext`phase1, $CellContext`phase2, $CellContext`phase3, \
$CellContext`phase4, $CellContext`phase5}, $CellContext`part$]; \
$CellContext`tie$ = 
         Part[{$CellContext`tie1, $CellContext`tie2, $CellContext`tie3, \
$CellContext`tie4, $CellContext`tie5}, $CellContext`part$]; \
$CellContext`feedA$ = RandomInteger[{25, 55}]; $CellContext`feedC$ = 
         100 - $CellContext`feedA$; $CellContext`feedS$ = 
         100 - $CellContext`feedA$ - $CellContext`feedC$; $CellContext`FtoS$ = 
         RandomReal[{0.1, 5}]; $CellContext`mF$ = 
         50; $CellContext`mS$ = $CellContext`mF$/$CellContext`FtoS$; \
$CellContext`mM$ = $CellContext`mF$ + $CellContext`mS$; $CellContext`xM$ = \
$CellContext`mS$/($CellContext`mF$ + $CellContext`mS$); $CellContext`massA$ = \
($CellContext`mF$/($CellContext`mF$ + $CellContext`mS$)) ($CellContext`feedA$/
           100); $CellContext`massC$ = ($CellContext`mF$/($CellContext`mF$ + \
$CellContext`mS$)) ($CellContext`feedC$/
           100); $CellContext`massS$ = $CellContext`mS$/($CellContext`mF$ + \
$CellContext`mS$); $CellContext`func1$[
           Pattern[$CellContext`x$, 
            Blank[]]] := (-
            Sqrt[3]) ($CellContext`x$ - (1 - $CellContext`xM$) (Sqrt[3]/2)/
            Tan[$CellContext`\[Theta]]) + (1 - $CellContext`xM$) (Sqrt[3]/
            2); $CellContext`func2$[
           Pattern[$CellContext`x$, 
            Blank[]]] := ((($CellContext`feedA$/100) (Sqrt[3]/2))/(
            1 - ($CellContext`feedA$/100) ((Sqrt[3]/2)/
             Tan[$CellContext`\[Theta]]))) ($CellContext`x$ - (
            1 - ($CellContext`feedA$/100) ((Sqrt[3]/2)/
             Tan[$CellContext`\[Theta]]))) + ($CellContext`feedA$/100) (
            Sqrt[3]/2); $CellContext`xmix$ = ReplaceAll[$CellContext`x, 
           Quiet[
            Part[
             
             Solve[$CellContext`func1$[$CellContext`x] == \
$CellContext`func2$[$CellContext`x], $CellContext`x], 
             1]]]; $CellContext`ymix$ = \
$CellContext`func1$[$CellContext`xmix$]; $CellContext`tieline$[
           Pattern[$CellContext`list, 
            Blank[]], 
           Pattern[$CellContext`line, 
            Blank[]], 
           Pattern[$CellContext`x, 
            Blank[]]] := ReplaceAll[
           Fit[
            Part[$CellContext`list, $CellContext`line], {
            1, $CellContext`z}, $CellContext`z], $CellContext`z -> \
$CellContext`x]; $CellContext`lower$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Which[$CellContext`ymix$ <= $CellContext`tieline$[$CellContext`tie$, 
             1, $CellContext`xmix$], 0, 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 1, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 1, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 4, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 4, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 5, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 
            4, $CellContext`x$], $CellContext`tieline$[$CellContext`tie$, 
             5, $CellContext`xmix$] < $CellContext`ymix$, 
           $CellContext`tieline$[$CellContext`tie$, 
            5, $CellContext`x$]]; $CellContext`upper$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Which[$CellContext`ymix$ <= $CellContext`tieline$[$CellContext`tie$, 
             1, $CellContext`xmix$], 
           $CellContext`tieline$[$CellContext`tie$, 1, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 1, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 4, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 4, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 4, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 5, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 
            5, $CellContext`x$], $CellContext`tieline$[$CellContext`tie$, 
             5, $CellContext`xmix$] < $CellContext`ymix$, 
           $CellContext`tieline$[$CellContext`tie$, 
            5, $CellContext`x$]]; $CellContext`lever$ = 
         If[$CellContext`ymix$ > $CellContext`tieline$[$CellContext`tie$, 
             5, $CellContext`xmix$], 
           1, ($CellContext`ymix$ - \
$CellContext`lower$[$CellContext`xmix$])/($CellContext`upper$[$CellContext`\
xmix$] - $CellContext`lower$[$CellContext`xmix$])]; $CellContext`newtie$[
           Pattern[$CellContext`x$, 
            Blank[]]] := (
            1 - $CellContext`lever$) $CellContext`lower$[$CellContext`x$] + \
$CellContext`lever$ $CellContext`upper$[$CellContext`x$]; $CellContext`x1$ = 
         ReplaceAll[$CellContext`x, 
           
           FindRoot[$CellContext`newtie$[$CellContext`x] == 
            Interpolation[$CellContext`phase$][$CellContext`x], \
{$CellContext`x, 0.1}]]; $CellContext`x2$ = ReplaceAll[$CellContext`x, 
           
           FindRoot[$CellContext`newtie$[$CellContext`x] == 
            Interpolation[$CellContext`phase$][$CellContext`x], \
{$CellContext`x, 0.9}]]; If[$CellContext`ymix$ > Quiet[
            
            Interpolation[$CellContext`phase$][$CellContext`xmix$]], \
$CellContext`reset$$ = $CellContext`reset$$ + 1]; 
        Show[$CellContext`gridlines, $CellContext`diagram, 
          PlotRange -> {{-0.25, 1.25}, {-0.2, 0.95}}, ImageSize -> {600, 390},
           Epilog -> {{Thick, 
             Line[
              Map[{#, 
                Interpolation[$CellContext`phase$][#]}& , 
               Range[
                Part[$CellContext`phase$, 1, 1], 
                Part[$CellContext`phase$, -1, 1], 0.01]]], 
             Line[$CellContext`tie$]}, 
            If[$CellContext`midland$$ == 1, {
              Text[
               Style[
                Column[{"mass % in feed", 
                  Framed[
                   Column[{
                    Row[{"solute = ", $CellContext`feedA$, "%"}], 
                    Row[{"carrier = ", $CellContext`feedC$, "%"}], 
                    Row[{"solvent = ", $CellContext`feedS$, "%"}]}, Alignment -> 
                    "="], Background -> White]}, Center], 17], {
               0, 0.9 (Sqrt[3]/2)}], 
              $CellContext`pt2[$CellContext`feed$$, $CellContext`colF], 
              Text[
               Style[
               "feed", 17, $CellContext`colF, Background -> 
                White], $CellContext`feed$$, {0, -1.75}], 
              If[$CellContext`solution$$, 
               $CellContext`pt1[{
                1 - ($CellContext`feedA$/100) (Sqrt[3]/2)/
                 Tan[$CellContext`\[Theta]], ($CellContext`feedA$/100) (
                  Sqrt[3]/2)}, $CellContext`colF]]}], 
            If[$CellContext`midland$$ > 1, {
              $CellContext`pt1[{
               1 - ($CellContext`feedA$/100) (Sqrt[3]/2)/
                Tan[$CellContext`\[Theta]], ($CellContext`feedA$/100) (
                 Sqrt[3]/2)}, $CellContext`colF], 
              Text[
               Style[" F ", 17, $CellContext`colF, Background -> White], {
               1 - ($CellContext`feedA$/100) (Sqrt[3]/2)/
                Tan[$CellContext`\[Theta]], ($CellContext`feedA$/100) (
                 Sqrt[3]/2)}, {0, -2}]}], 
            If[$CellContext`midland$$ == 2, {
              Text[
               Style[
                Column[{"mass % in solvent", 
                  Framed[
                   Column[{
                    Row[{"solute = ", 0, "%"}], 
                    Row[{"carrier = ", 0, "%"}], 
                    Row[{"solvent = ", 100, "%"}]}, Alignment -> "="], 
                   Background -> White]}, Center], 17], {0, 0.9 (Sqrt[3]/2)}], 
              $CellContext`pt2[$CellContext`solvent$$, $CellContext`colS], 
              Text[
               Style[
               "solvent", 17, $CellContext`colS, Background -> 
                White], $CellContext`solvent$$, {0, -1.75}], 
              If[$CellContext`solution$$, 
               $CellContext`pt1[{0, 0}, $CellContext`colS]]}], 
            If[$CellContext`midland$$ > 2, {
              $CellContext`pt1[{0, 0}, $CellContext`colS], 
              Text[
               Style["S", 17, $CellContext`colS, Background -> White], {0, 
               0}, {0, -2}]}], 
            If[$CellContext`midland$$ == 3, {{
               Thickness[0.007], 
               CapForm[None], Dashed, Magenta, 
               Line[{$CellContext`line1$$, $CellContext`line2$$}]}, 
              $CellContext`pt2[$CellContext`line1$$, Magenta], 
              $CellContext`pt2[$CellContext`line2$$, Magenta], 
              If[$CellContext`solution$$, {
                Thickness[0.007], 
                CapForm[None], Magenta, 
                
                Line[{{0, 0}, {
                  1 - ($CellContext`feedA$/100) ((Sqrt[3]/2)/
                    Tan[$CellContext`\[Theta]]), ($CellContext`feedA$/100) (
                    Sqrt[3]/2)}}]}]}], 
            If[$CellContext`midland$$ > 3, {
              Thickness[0.007], 
              CapForm[None], Magenta, 
              
              Line[{{0, 0}, {
                1 - ($CellContext`feedA$/100) ((Sqrt[3]/2)/
                  Tan[$CellContext`\[Theta]]), ($CellContext`feedA$/100) (
                  Sqrt[3]/2)}}]}], 
            If[$CellContext`midland$$ == 4, {
              $CellContext`pt2[$CellContext`mixing$$, $CellContext`colM], 
              Text[
               Style[
               "mixing", 17, $CellContext`colM, Background -> 
                White], $CellContext`mixing$$, {0, -1.75}], 
              If[$CellContext`solution$$ == False, 
               Text[
                Style[
                 Column[{"mass flow (kg/h)", 
                   Framed[
                    Column[{
                    Row[{"feed = ", 
                    NumberForm[$CellContext`mF$, {5, 1}]}], 
                    Row[{"solvent = ", 
                    NumberForm[$CellContext`mS$, {5, 1}]}]}, Alignment -> 
                    "="], Background -> White], 
                   Row[{
                    Style["F", Italic], "/", 
                    Style["S", Italic], " = ", 
                    NumberForm[$CellContext`FtoS$, {5, 1}]}]}, Center], 17], {
                1, 0.9 (Sqrt[3]/2)}]], 
              If[$CellContext`solution$$, 
               $CellContext`pt1[{$CellContext`xmix$, 
                 $CellContext`func1$[$CellContext`xmix$]}, \
$CellContext`colM]]}], 
            If[$CellContext`midland$$ > 4, {
              $CellContext`pt1[{$CellContext`xmix$, 
                $CellContext`func1$[$CellContext`xmix$]}, $CellContext`colM], 
              Text[
               Style[
               "M", 17, $CellContext`colM, Background -> 
                White], {$CellContext`xmix$, 
                $CellContext`func1$[$CellContext`xmix$]}, {0, -2}]}], 
            If[$CellContext`midland$$ == 5, {
              If[$CellContext`solution$$, 
               Text[
                Framed[
                 Style[
                  Column[{
                    Style[
                    Row[{"solute = ", 
                    NumberForm[$CellContext`massA$ 100, {4, 0}], 
                    "%"}], $CellContext`colA], 
                    Style[
                    Row[{"carrier = ", 
                    NumberForm[$CellContext`massC$ 100, {4, 0}], 
                    "%"}], $CellContext`colC], 
                    Style[
                    Row[{"solvent = ", 
                    NumberForm[$CellContext`massS$ 100, {4, 0}], 
                    "%"}], $CellContext`colS]}, Alignment -> "="], 17], 
                 Background -> White], {1, 0.9 (Sqrt[3]/2)}]], 
              If[$CellContext`solution$$ == False, 
               Text[
                Style[
                 Column[{"mass flow (kg/h)", 
                   Framed[
                    Column[{
                    Row[{"feed = ", 
                    NumberForm[$CellContext`mF$, {5, 1}]}], 
                    Row[{"solvent = ", 
                    NumberForm[$CellContext`mS$, {5, 1}]}]}, Alignment -> 
                    "="], Background -> White], 
                   Row[{
                    Style["F", Italic], "/", 
                    Style["S", Italic], " = ", 
                    NumberForm[$CellContext`FtoS$, {5, 1}]}]}, Center], 17], {
                1, 0.9 (Sqrt[3]/2)}]]}], 
            If[$CellContext`midland$$ == 6, {{Thick, Dashed, 
               Line[{$CellContext`outletE$$, $CellContext`outletR$$}]}, 
              $CellContext`pt2[$CellContext`outletE$$, $CellContext`colE], 
              $CellContext`pt2[$CellContext`outletR$$, $CellContext`colR], 
              Apply[If[$CellContext`solution$$ == False, 
                Text[
                 Style[#, 17, #2, Background -> White], #3, {0, -1.75}]]& , {{
                "extract", $CellContext`colE, $CellContext`outletE$$}, {
                "raffinate", $CellContext`colR, $CellContext`outletR$$}}, {
               1}], 
              If[$CellContext`solution$$, {
                Thickness[0.0075], Dashed, Orange, 
                Line[
                 Map[{#, 
                   $CellContext`newtie$[#]}& , 
                  Range[$CellContext`x1$, $CellContext`x2$, 0.01]]], 
                $CellContext`pt1[{$CellContext`x1$, 
                  $CellContext`newtie$[$CellContext`x1$]}, $CellContext`colE], 
                $CellContext`pt1[{$CellContext`x2$, 
                  $CellContext`newtie$[$CellContext`x2$]}, $CellContext`colR], 
                Text[
                 Style[
                 "E", 17, $CellContext`colE, Background -> 
                  White], {$CellContext`x1$, 
                  $CellContext`newtie$[$CellContext`x1$]}, {0, -1.75}], 
                Text[
                 Style[
                 "R", 17, $CellContext`colR, Background -> 
                  White], {$CellContext`x2$, 
                  $CellContext`newtie$[$CellContext`x2$]}, {0, -1.75}]}]}]}]],
       "Specifications" :> {
        Style[
         PaneSelector[{
          1 -> "step 1: move the point to the correct feed composition", 2 -> 
           "step 2: move the point to the correct solvent composition", 3 -> 
           "step 3: draw a line connecting feed and solvent compositions", 4 -> 
           "step 4: move the point to the correct mixing point location", 5 -> 
           "step 5: use sliders to set the correct mass percentages of the \
mixing point", 6 -> "step 6: determine outlet compositions"}, 
          Dynamic[$CellContext`midland$$]], 
         Bold], {{$CellContext`midland$$, 5, ""}, {1, 2, 3, 4, 5, 6}, 
         ControlType -> None, ControlPlacement -> 
         1}, {{$CellContext`solution$$, True, "solution"}, {True, False}, 
         Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         2}, {{$CellContext`reset$$, 1}, 1, 1000, 1, ControlType -> None, 
         ControlPlacement -> 3}, 
        Grid[{{
           Button[" new problem ", {
             
             If[$CellContext`reset$$ < 
              1000, $CellContext`reset$$ = $CellContext`reset$$ + 
               1, $CellContext`reset$$ = $CellContext`reset$$ - 
               1], $CellContext`midland$$ = 
             1, $CellContext`feed$$ = {
              0.5, 0.7 (Sqrt[3]/2)}, $CellContext`solvent$$ = {
              0.5, 0.7 (Sqrt[3]/2)}, $CellContext`line1$$ = {
              0.35, 0.6 (Sqrt[3]/2)}, $CellContext`line2$$ = {
              0.65, 0.6 (Sqrt[3]/2)}, $CellContext`mixing$$ = {
              0.5, 0.7 (Sqrt[3]/2)}, 
             
             If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 
           PaneSelector[{1 -> Style["(1) feed composition", 
               RGBColor[1, 0.4, 0]], 2 -> Style["(2) solvent composition", 
               RGBColor[0, 0.6, 0]], 3 -> "(3) draw mass balance line", 4 -> 
             Style["(4) mixing point composition", 
               RGBColor[0.5, 0, 0.5]], 5 -> "(5) mixing point composition", 6 -> 
             "(6) outlet streams"}, 
            Dynamic[$CellContext`midland$$]], 
           PaneSelector[{1 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`midland$$, Less, 
                  6], $CellContext`midland$$ = $CellContext`midland$$ + 
                  1, $CellContext`midland$$ = 6], 
                
                If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 2 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`midland$$, Less, 
                  6], $CellContext`midland$$ = $CellContext`midland$$ + 
                  1, $CellContext`midland$$ = 6], 
                
                If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 3 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`midland$$, Less, 
                  6], $CellContext`midland$$ = $CellContext`midland$$ + 
                  1, $CellContext`midland$$ = 6], 
                
                If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 4 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`midland$$, Less, 
                  6], $CellContext`midland$$ = $CellContext`midland$$ + 
                  1, $CellContext`midland$$ = 6], 
                
                If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 5 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`midland$$, Less, 
                  6], $CellContext`midland$$ = $CellContext`midland$$ + 
                  1, $CellContext`midland$$ = 6], 
                
                If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}]}, 
            Dynamic[$CellContext`midland$$]], 
           Manipulate`Place[1], 
           Spacer[15], 
           Manipulate`Place[2], 
           Manipulate`Place[3]}}], {{$CellContext`wtA$$, 80, 
          Style["solute", 
           RGBColor[0, 0, 1]]}, 0, 100, 1, Appearance -> "Labeled", ImageSize -> 
         Tiny, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         4}, {{$CellContext`wtC$$, 20, 
          Style["carrier", 
           RGBColor[0.8, 0, 0.01]]}, 0, 100, 1, Appearance -> "Labeled", 
         ImageSize -> Tiny, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         5}, {{$CellContext`wtS$$, 0, 
          Style["solvent", 
           RGBColor[0, 0.6, 0]]}, 0, 100, 1, Appearance -> "Labeled", 
         ImageSize -> Tiny, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         6}, {{$CellContext`feed$$, {0.5, 0.606217782649107}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         7}, {{$CellContext`solvent$$, {0.5, 0.606217782649107}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         8}, {{$CellContext`line1$$, {0.006000000000000005, 
          0.013999999999999985`}}, Automatic, ControlType -> Locator, 
         Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         9}, {{$CellContext`line2$$, {0.8220000000000001, 0.308}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         10}, {{$CellContext`mixing$$, {0.5, 0.606217782649107}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         11}, {{$CellContext`outletE$$, {0.2, 0.08660254037844387}}, 
         Automatic, ControlType -> Locator, Appearance -> None, Enabled -> 
         Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         12}, {{$CellContext`outletR$$, {0.6, 0.34641016151377546`}}, 
         Automatic, ControlType -> Locator, Appearance -> None, Enabled -> 
         Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 13}, 
        Grid[{{
           PaneSelector[{5 -> Row[{"mass percent (%):", 
                Spacer[5], 
                Manipulate`Place[4], 
                Manipulate`Place[5], 
                Manipulate`Place[6]}]}, 
            Dynamic[$CellContext`midland$$]], 
           
           PaneSelector[{
            1 -> Manipulate`Place[7], 2 -> Manipulate`Place[8], 3 -> Row[{
                Manipulate`Place[9], 
                Manipulate`Place[10]}], 4 -> Manipulate`Place[11], 6 -> Row[{
                Manipulate`Place[12], 
                Manipulate`Place[13]}]}, 
            Dynamic[$CellContext`midland$$]]}}]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`phase = 
       InterpolatingFunction[{{0.08, 0.98}}, {
         5, 7, 0, {12}, {4}, 0, 0, 0, 0, Automatic, {}, {}, False}, {{0.08, 
         0.15, 0.19, 0.25, 0.33, 0.44, 0.61, 0.68, 0.77, 0.83, 0.88, 0.98}}, {
         Developer`PackedArrayForm, {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 
          12}, {0., 0.1, 0.17, 0.26, 0.37, 0.45, 0.46, 0.43, 0.35, 0.26, 0.17,
           0.}}, {Automatic}], $CellContext`phase1 = {{0.09, 0}, {0.17, 
         0.13}, {0.28, 0.3}, {0.41, 0.44}, {0.55, 0.47}, {0.7, 0.42}, {0.83, 
         0.26}, {0.98, 0}}, $CellContext`phase2 = {{0.0545, 0}, {0.136, 
         0.134}, {0.226, 0.267}, {0.3405, 0.36}, {0.534, 0.398}, {0.673, 
         0.338}, {0.7925, 0.232}, {0.956, 0}}, $CellContext`phase3 = {{
         0.098, 0}, {0.172, 0.126}, {0.2285, 0.213}, {0.422, 0.338}, {0.55, 
         0.352}, {0.7055, 0.284}, {0.7925, 0.205}, {
         0.92, 0}}, $CellContext`phase4 = {{0.07, 0}, {0.14, 0.14}, {0.26, 
         0.35}, {0.42, 0.56}, {0.56, 0.59}, {0.7, 0.42}, {0.82, 0.24}, {
         0.95, 0}}, $CellContext`phase5 = {{0, 0}, {0.12, 0.15}, {0.23, 
         0.32}, {0.34, 0.45}, {0.6, 0.5}, {0.69, 0.42}, {0.77, 0.3}, {
         0.93, 0}}, $CellContext`tie1 = {{{0.12, 0.052}, {0.93, 0.078}}, {{
        0.16, 0.104}, {0.88, 0.173}}, {{0.2, 0.173}, {0.83, 0.26}}, {{0.26, 
        0.268}, {0.77, 0.346}}, {{0.34, 0.372}, {0.67, 
        0.433}}}, $CellContext`tie2 = {{{0.1, 0.07}, {0.9, 0.09}}, {{0.13, 
        0.12}, {0.84, 0.17}}, {{0.17, 0.18}, {0.77, 0.25}}, {{0.2, 0.23}, {
        0.7, 0.32}}, {{0.24, 0.28}, {0.64, 0.36}}}, $CellContext`tie3 = {{{
        0.12, 0.03}, {0.89, 0.06}}, {{0.15, 0.09}, {0.86, 0.11}}, {{0.19, 
        0.15}, {0.82, 0.17}}, {{0.24, 0.23}, {0.72, 0.27}}, {{0.28, 0.27}, {
        0.65, 0.32}}}, $CellContext`tie4 = {{{0.1, 0.06}, {0.9, 0.1}}, {{0.15,
         0.15}, {0.84, 0.21}}, {{0.21, 0.26}, {0.75, 0.35}}, {{0.28, 0.37}, {
        0.67, 0.46}}, {{0.37, 0.51}, {0.59, 0.56}}}, $CellContext`tie5 = {{{
        0.065, 0.07}, {0.87, 0.11}}, {{0.11, 0.13}, {0.83, 0.2}}, {{0.17, 
        0.22}, {0.76, 0.32}}, {{0.24, 0.33}, {0.69, 0.41}}, {{0.33, 0.44}, {
        0.6, 0.5}}}, $CellContext`\[Theta] = 
       60 Degree, $CellContext`gridlines = Graphics[{
          GrayLevel[0.65], {{
            
            Line[{{0.025, 0.04330127018922193}, {0.975, 
             0.04330127018922193}}], 
            Line[{{0.05, 0}, {0.025, 0.04330127018922193}}], 
            Line[{{0.95, 0}, {0.975, 0.04330127018922193}}]}, {
            
            Line[{{0.07500000000000001, 0.1299038105676658}, {0.925, 
             0.1299038105676658}}], 
            
            Line[{{0.15000000000000002`, 0}, {0.07500000000000001, 
              0.1299038105676658}}], 
            Line[{{0.85, 0}, {0.925, 0.1299038105676658}}]}, {
            
            Line[{{0.125, 0.21650635094610965`}, {0.875, 
             0.21650635094610965`}}], 
            Line[{{0.25, 0}, {0.125, 0.21650635094610965`}}], 
            Line[{{0.75, 0}, {0.875, 0.21650635094610965`}}]}, {
            
            Line[{{0.17500000000000002`, 0.30310889132455354`}, {0.825, 
             0.30310889132455354`}}], 
            
            Line[{{0.35000000000000003`, 0}, {0.17500000000000002`, 
              0.30310889132455354`}}], 
            Line[{{0.6499999999999999, 0}, {0.825, 0.30310889132455354`}}]}, {
            Line[{{0.225, 0.3897114317029974}, {0.775, 0.3897114317029974}}], 
            Line[{{0.45, 0}, {0.225, 0.3897114317029974}}], 
            Line[{{0.55, 0}, {0.775, 0.3897114317029974}}]}, {
            Line[{{0.275, 0.4763139720814413}, {0.725, 0.4763139720814413}}], 
            Line[{{0.55, 0}, {0.275, 0.4763139720814413}}], 
            Line[{{0.44999999999999996`, 0}, {0.725, 0.4763139720814413}}]}, {
            
            Line[{{0.32500000000000007`, 0.5629165124598852}, {
             0.6749999999999999, 0.5629165124598852}}], 
            
            Line[{{0.6500000000000001, 0}, {0.32500000000000007`, 
              0.5629165124598852}}], 
            
            Line[{{0.34999999999999987`, 0}, {0.6749999999999999, 
              0.5629165124598852}}]}, {
            
            Line[{{0.37500000000000006`, 0.649519052838329}, {0.625, 
             0.649519052838329}}], 
            
            Line[{{0.7500000000000001, 0}, {0.37500000000000006`, 
              0.649519052838329}}], 
            Line[{{0.2499999999999999, 0}, {0.625, 0.649519052838329}}]}, {
            
            Line[{{0.42500000000000004`, 0.7361215932167728}, {0.575, 
             0.7361215932167728}}], 
            
            Line[{{0.8500000000000001, 0}, {0.42500000000000004`, 
              0.7361215932167728}}], 
            Line[{{0.1499999999999999, 0}, {0.575, 0.7361215932167728}}]}, {
            Line[{{0.475, 0.8227241335952167}, {0.525, 0.8227241335952167}}], 
            Line[{{0.95, 0}, {0.475, 0.8227241335952167}}], 
            
            Line[{{0.050000000000000044`, 0}, {0.525, 
              0.8227241335952167}}]}}, {{
            Line[{{0.05, 0.08660254037844387}, {0.97, 0.08660254037844387}}], 
            Line[{{0.1, 0}, {0.0485, 0.08920061658979718}}], 
            Line[{{0.88, -0.02}, {0.95, 0.08660254037844387}}]}, {
            Line[{{0.1, 0.17320508075688773`}, {0.92, 0.17320508075688773`}}], 
            Line[{{0.2, 0}, {0.097, 0.17840123317959436`}}], 
            Line[{{0.78, -0.02}, {0.9, 0.17320508075688773`}}]}, {
            
            Line[{{0.15000000000000002`, 0.2598076211353316}, {0.87, 
             0.2598076211353316}}], 
            
            Line[{{0.30000000000000004`, 0}, {0.14550000000000002`, 
              0.26760184976939155`}}], 
            Line[{{0.6799999999999999, -0.02}, {0.85, 0.2598076211353316}}]}, {
            
            Line[{{0.2, 0.34641016151377546`}, {0.8200000000000001, 
             0.34641016151377546`}}], 
            Line[{{0.4, 0}, {0.194, 0.3568024663591887}}], 
            Line[{{0.58, -0.02}, {0.8, 0.34641016151377546`}}]}, {
            Line[{{0.25, 0.4330127018922193}, {0.77, 0.4330127018922193}}], 
            Line[{{0.5, 0}, {0.2425, 0.4460030829489859}}], 
            Line[{{0.48, -0.02}, {0.75, 0.4330127018922193}}]}, {
            Line[{{0.3, 0.5196152422706631}, {0.72, 0.5196152422706631}}], 
            Line[{{0.6, 0}, {0.291, 0.535203699538783}}], 
            Line[{{0.38, -0.02}, {0.7, 0.5196152422706631}}]}, {
            
            Line[{{0.35000000000000003`, 0.6062177826491071}, {
             0.6699999999999999, 0.6062177826491071}}], 
            Line[{{0.7000000000000001, 0}, {0.3395, 0.6244043161285803}}], 
            
            Line[{{0.2799999999999999, -0.02}, {0.6499999999999999, 
             0.6062177826491071}}]}, {
            Line[{{0.4, 0.6928203230275509}, {0.62, 0.6928203230275509}}], 
            Line[{{0.8, 0}, {0.388, 0.7136049327183774}}], 
            
            Line[{{0.17999999999999994`, -0.02}, {0.6, 
             0.6928203230275509}}]}, {
            
            Line[{{0.45, 0.7794228634059948}, {0.5700000000000001, 
             0.7794228634059948}}], 
            Line[{{0.9, 0}, {0.4365, 0.8028055493081746}}], 
            
            Line[{{0.07999999999999996, -0.02}, {0.55, 
             0.7794228634059948}}]}}}], $CellContext`diagram = Graphics[{{
           EdgeForm[
            Thickness[Large]], 
           FaceForm[None], 
           Polygon[{{0, 0}, {0.5, Sqrt[3]/2}, {1, 0}}]}, {{
            RGBColor[0, 0, 1], 
            Text[
             Style[10., 16], {0.95, 0.08660254037844387}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[90., 16], (-60) Degree], {0.05, 0.08660254037844387}, {
             1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[10., 16], 60 Degree], {0.1, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[20., 16], {0.9, 0.17320508075688773`}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[80., 16], (-60) Degree], {0.1, 0.17320508075688773`}, {
             1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[20., 16], 60 Degree], {0.2, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[30.000000000000004`, 16], {0.85, 0.2598076211353316}, {-2, 
             0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[70., 16], (-60) Degree], {0.15000000000000002`, 
             0.2598076211353316}, {1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[30.000000000000004`, 16], 60 Degree], {
             0.30000000000000004`, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[40., 16], {0.8, 0.34641016151377546`}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[60., 16], (-60) Degree], {0.2, 0.34641016151377546`}, {
             1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[40., 16], 60 Degree], {0.4, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[50., 16], {0.75, 0.4330127018922193}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[50., 16], (-60) Degree], {0.25, 0.4330127018922193}, {
             1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[50., 16], 60 Degree], {0.5, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[60., 16], {0.7, 0.5196152422706631}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[40., 16], (-60) Degree], {0.3, 0.5196152422706631}, {
             1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[60., 16], 60 Degree], {0.6, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[70., 16], {0.6499999999999999, 0.6062177826491071}, {-2, 
             0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[29.999999999999993`, 16], (-60) Degree], {
             0.35000000000000003`, 0.6062177826491071}, {1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[70., 16], 60 Degree], {0.7000000000000001, 0}, {1.2, 
             1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[80., 16], {0.6, 0.6928203230275509}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[19.999999999999996`, 16], (-60) Degree], {0.4, 
             0.6928203230275509}, {1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[80., 16], 60 Degree], {0.8, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[90., 16], {0.55, 0.7794228634059948}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[9.999999999999998, 16], (-60) Degree], {0.45, 
             0.7794228634059948}, {1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[90., 16], 60 Degree], {0.9, 0}, {1.2, 1.5}]}}, 
          Text[
           Rotate[
            Style["solute", 17, 
             RGBColor[0, 0, 1]], (-60) Degree], {0.75, Sqrt[3]/4}, {-3, 0}], 
          Text[
           Rotate[
            Style["solvent", 17, 
             RGBColor[0, 0.6, 0]], 60 Degree], {0.25, Sqrt[3]/4}, {3, 0}], 
          Text[
           Style["carrier", 17, 
            RGBColor[0.8, 0, 0.01]], {0.5, 0}, {0, 5}], Null}], 
       Attributes[PlotRange] = {ReadProtected}, $CellContext`pt2[
         Pattern[$CellContext`pt, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]]] := {
         PointSize[0.03], $CellContext`col, 
         Point[$CellContext`pt], 
         PointSize[0.015], White, 
         Point[$CellContext`pt]}, $CellContext`colF = 
       RGBColor[1, 0.4, 0], $CellContext`pt1[
         Pattern[$CellContext`pt, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]]] := {
         PointSize[0.03], $CellContext`col, 
         Point[$CellContext`pt]}, $CellContext`colS = 
       RGBColor[0, 0.6, 0], $CellContext`colM = 
       RGBColor[0.5, 0, 0.5], $CellContext`colA = 
       RGBColor[0, 0, 1], $CellContext`colC = 
       RGBColor[0.8, 0, 0.01], $CellContext`colE = 
       RGBColor[1, 0, 0], $CellContext`colR = RGBColor[0, 0.6, 1]}; 
     Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->462351945,ExpressionUUID->"c869807b-b144-4398-8676-6bf14073f37c"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`feed$$ = {0.5, 
    0.606217782649107}, $CellContext`line1$$ = {0.006000000000000005, 
    0.013999999999999985`}, $CellContext`line2$$ = {0.8220000000000001, 
    0.308}, $CellContext`midland$$ = 6, $CellContext`mixing$$ = {0.5, 
    0.606217782649107}, $CellContext`outletE$$ = {0.03500000000000003, 
    0.03999999999999998}, $CellContext`outletR$$ = {0.899, 
    0.066}, $CellContext`reset$$ = 1, $CellContext`solution$$ = 
    False, $CellContext`solvent$$ = {0.5, 
    0.606217782649107}, $CellContext`wtA$$ = 80, $CellContext`wtC$$ = 
    20, $CellContext`wtS$$ = 0, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[
       Style[
        PaneSelector[{
         1 -> "step 1: move the point to the correct feed composition", 2 -> 
          "step 2: move the point to the correct solvent composition", 3 -> 
          "step 3: draw a line connecting feed and solvent compositions", 4 -> 
          "step 4: move the point to the correct mixing point location", 5 -> 
          "step 5: use sliders to set the correct mass percentages of the \
mixing point", 6 -> "step 6: determine outlet compositions"}, 
         Dynamic[$CellContext`midland$$]], Bold]], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`midland$$], 6, ""}, {1, 2, 3, 4, 5, 6}}, {{
       Hold[$CellContext`solution$$], False, "solution"}, {True, False}}, {{
       Hold[$CellContext`reset$$], 1}, 1, 1000, 1}, {
      Hold[
       Grid[{{
          Button[" new problem ", {
            
            If[$CellContext`reset$$ < 
             1000, $CellContext`reset$$ = $CellContext`reset$$ + 
              1, $CellContext`reset$$ = $CellContext`reset$$ - 
              1], $CellContext`midland$$ = 
            1, $CellContext`feed$$ = {
             0.5, 0.7 (Sqrt[3]/2)}, $CellContext`solvent$$ = {
             0.5, 0.7 (Sqrt[3]/2)}, $CellContext`line1$$ = {
             0.35, 0.6 (Sqrt[3]/2)}, $CellContext`line2$$ = {
             0.65, 0.6 (Sqrt[3]/2)}, $CellContext`mixing$$ = {
             0.5, 0.7 (Sqrt[3]/2)}, 
            
            If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 
          PaneSelector[{1 -> Style["(1) feed composition", 
              RGBColor[1, 0.4, 0]], 2 -> Style["(2) solvent composition", 
              RGBColor[0, 0.6, 0]], 3 -> "(3) draw mass balance line", 4 -> 
            Style["(4) mixing point composition", 
              RGBColor[0.5, 0, 0.5]], 5 -> "(5) mixing point composition", 6 -> 
            "(6) outlet streams"}, 
           Dynamic[$CellContext`midland$$]], 
          PaneSelector[{1 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`midland$$, Less, 
                 6], $CellContext`midland$$ = $CellContext`midland$$ + 
                 1, $CellContext`midland$$ = 6], 
               
               If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 2 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`midland$$, Less, 
                 6], $CellContext`midland$$ = $CellContext`midland$$ + 
                 1, $CellContext`midland$$ = 6], 
               
               If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 3 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`midland$$, Less, 
                 6], $CellContext`midland$$ = $CellContext`midland$$ + 
                 1, $CellContext`midland$$ = 6], 
               
               If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 4 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`midland$$, Less, 
                 6], $CellContext`midland$$ = $CellContext`midland$$ + 
                 1, $CellContext`midland$$ = 6], 
               
               If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 5 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`midland$$, Less, 
                 6], $CellContext`midland$$ = $CellContext`midland$$ + 
                 1, $CellContext`midland$$ = 6], 
               
               If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}]}, 
           Dynamic[$CellContext`midland$$]], 
          Manipulate`Place[1], 
          Spacer[15], 
          Manipulate`Place[2], 
          Manipulate`Place[3]}}]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`wtA$$], 80, 
       Style["solute", 
        RGBColor[0, 0, 1]]}, 0, 100, 1}, {{
       Hold[$CellContext`wtC$$], 20, 
       Style["carrier", 
        RGBColor[0.8, 0, 0.01]]}, 0, 100, 1}, {{
       Hold[$CellContext`wtS$$], 0, 
       Style["solvent", 
        RGBColor[0, 0.6, 0]]}, 0, 100, 1}, {{
       Hold[$CellContext`feed$$], {0.5, 0.606217782649107}}, Automatic}, {{
       Hold[$CellContext`solvent$$], {0.5, 0.606217782649107}}, Automatic}, {{
       Hold[$CellContext`line1$$], {0.006000000000000005, 
       0.013999999999999985`}}, Automatic}, {{
       Hold[$CellContext`line2$$], {0.8220000000000001, 0.308}}, Automatic}, {{
       Hold[$CellContext`mixing$$], {0.5, 0.606217782649107}}, Automatic}, {{
       Hold[$CellContext`outletE$$], {0.03500000000000003, 
       0.03999999999999998}}, Automatic}, {{
       Hold[$CellContext`outletR$$], {0.899, 0.066}}, Automatic}, {
      Hold[
       Grid[{{
          PaneSelector[{5 -> Row[{"mass percent (%):", 
               Spacer[5], 
               Manipulate`Place[4], 
               Manipulate`Place[5], 
               Manipulate`Place[6]}]}, 
           Dynamic[$CellContext`midland$$]], 
          
          PaneSelector[{
           1 -> Manipulate`Place[7], 2 -> Manipulate`Place[8], 3 -> Row[{
               Manipulate`Place[9], 
               Manipulate`Place[10]}], 4 -> Manipulate`Place[11], 6 -> Row[{
               Manipulate`Place[12], 
               Manipulate`Place[13]}]}, 
           Dynamic[$CellContext`midland$$]]}}]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = Automatic, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    False, $CellContext`midland$124841$$ = 0, $CellContext`solution$124842$$ =
     False, $CellContext`reset$124843$$ = 0, $CellContext`wtA$124844$$ = 
    0, $CellContext`wtC$124845$$ = 0, $CellContext`wtS$124846$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`feed$$ = {0.5, 
         0.606217782649107}, $CellContext`line1$$ = {0.006000000000000005, 
         0.013999999999999985`}, $CellContext`line2$$ = {0.8220000000000001, 
         0.308}, $CellContext`midland$$ = 
        6, $CellContext`mixing$$ = {0.5, 
         0.606217782649107}, $CellContext`outletE$$ = {0.03500000000000003, 
         0.03999999999999998}, $CellContext`outletR$$ = {0.899, 
         0.066}, $CellContext`reset$$ = 1, $CellContext`solution$$ = 
        False, $CellContext`solvent$$ = {0.5, 
         0.606217782649107}, $CellContext`wtA$$ = 80, $CellContext`wtC$$ = 
        20, $CellContext`wtS$$ = 0}, "ControllerVariables" :> {
        Hold[$CellContext`midland$$, $CellContext`midland$124841$$, 0], 
        Hold[$CellContext`solution$$, $CellContext`solution$124842$$, False], 
        Hold[$CellContext`reset$$, $CellContext`reset$124843$$, 0], 
        Hold[$CellContext`wtA$$, $CellContext`wtA$124844$$, 0], 
        Hold[$CellContext`wtC$$, $CellContext`wtC$124845$$, 0], 
        Hold[$CellContext`wtS$$, $CellContext`wtS$124846$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`part$, $CellContext`phase$, $CellContext`tie$, \
$CellContext`feedA$, $CellContext`feedC$, $CellContext`feedS$, \
$CellContext`FtoS$, $CellContext`mF$, $CellContext`mS$, $CellContext`mM$, \
$CellContext`xM$, $CellContext`massA$, $CellContext`massC$, \
$CellContext`massS$, $CellContext`func1$, $CellContext`func2$, \
$CellContext`xmix$, $CellContext`ymix$, $CellContext`tieline$, \
$CellContext`lower$, $CellContext`upper$, $CellContext`lever$, \
$CellContext`newtie$, $CellContext`x1$, $CellContext`x2$}, 
        SeedRandom[$CellContext`reset$$]; $CellContext`part$ = 
         RandomInteger[{1, 5}]; $CellContext`phase$ = 
         Part[{$CellContext`phase1, $CellContext`phase2, $CellContext`phase3, \
$CellContext`phase4, $CellContext`phase5}, $CellContext`part$]; \
$CellContext`tie$ = 
         Part[{$CellContext`tie1, $CellContext`tie2, $CellContext`tie3, \
$CellContext`tie4, $CellContext`tie5}, $CellContext`part$]; \
$CellContext`feedA$ = RandomInteger[{25, 55}]; $CellContext`feedC$ = 
         100 - $CellContext`feedA$; $CellContext`feedS$ = 
         100 - $CellContext`feedA$ - $CellContext`feedC$; $CellContext`FtoS$ = 
         RandomReal[{0.1, 5}]; $CellContext`mF$ = 
         50; $CellContext`mS$ = $CellContext`mF$/$CellContext`FtoS$; \
$CellContext`mM$ = $CellContext`mF$ + $CellContext`mS$; $CellContext`xM$ = \
$CellContext`mS$/($CellContext`mF$ + $CellContext`mS$); $CellContext`massA$ = \
($CellContext`mF$/($CellContext`mF$ + $CellContext`mS$)) ($CellContext`feedA$/
           100); $CellContext`massC$ = ($CellContext`mF$/($CellContext`mF$ + \
$CellContext`mS$)) ($CellContext`feedC$/
           100); $CellContext`massS$ = $CellContext`mS$/($CellContext`mF$ + \
$CellContext`mS$); $CellContext`func1$[
           Pattern[$CellContext`x$, 
            Blank[]]] := (-
            Sqrt[3]) ($CellContext`x$ - (1 - $CellContext`xM$) (Sqrt[3]/2)/
            Tan[$CellContext`\[Theta]]) + (1 - $CellContext`xM$) (Sqrt[3]/
            2); $CellContext`func2$[
           Pattern[$CellContext`x$, 
            Blank[]]] := ((($CellContext`feedA$/100) (Sqrt[3]/2))/(
            1 - ($CellContext`feedA$/100) ((Sqrt[3]/2)/
             Tan[$CellContext`\[Theta]]))) ($CellContext`x$ - (
            1 - ($CellContext`feedA$/100) ((Sqrt[3]/2)/
             Tan[$CellContext`\[Theta]]))) + ($CellContext`feedA$/100) (
            Sqrt[3]/2); $CellContext`xmix$ = ReplaceAll[$CellContext`x, 
           Quiet[
            Part[
             
             Solve[$CellContext`func1$[$CellContext`x] == \
$CellContext`func2$[$CellContext`x], $CellContext`x], 
             1]]]; $CellContext`ymix$ = \
$CellContext`func1$[$CellContext`xmix$]; $CellContext`tieline$[
           Pattern[$CellContext`list, 
            Blank[]], 
           Pattern[$CellContext`line, 
            Blank[]], 
           Pattern[$CellContext`x, 
            Blank[]]] := ReplaceAll[
           Fit[
            Part[$CellContext`list, $CellContext`line], {
            1, $CellContext`z}, $CellContext`z], $CellContext`z -> \
$CellContext`x]; $CellContext`lower$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Which[$CellContext`ymix$ <= $CellContext`tieline$[$CellContext`tie$, 
             1, $CellContext`xmix$], 0, 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 1, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 1, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 4, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 4, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 5, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 
            4, $CellContext`x$], $CellContext`tieline$[$CellContext`tie$, 
             5, $CellContext`xmix$] < $CellContext`ymix$, 
           $CellContext`tieline$[$CellContext`tie$, 
            5, $CellContext`x$]]; $CellContext`upper$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Which[$CellContext`ymix$ <= $CellContext`tieline$[$CellContext`tie$, 
             1, $CellContext`xmix$], 
           $CellContext`tieline$[$CellContext`tie$, 1, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 1, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 2, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 3, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 4, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 4, $CellContext`x$], 
           Inequality[
            $CellContext`tieline$[$CellContext`tie$, 4, $CellContext`xmix$], 
            Less, $CellContext`ymix$, LessEqual, 
            $CellContext`tieline$[$CellContext`tie$, 5, $CellContext`xmix$]], 
           $CellContext`tieline$[$CellContext`tie$, 
            5, $CellContext`x$], $CellContext`tieline$[$CellContext`tie$, 
             5, $CellContext`xmix$] < $CellContext`ymix$, 
           $CellContext`tieline$[$CellContext`tie$, 
            5, $CellContext`x$]]; $CellContext`lever$ = 
         If[$CellContext`ymix$ > $CellContext`tieline$[$CellContext`tie$, 
             5, $CellContext`xmix$], 
           1, ($CellContext`ymix$ - \
$CellContext`lower$[$CellContext`xmix$])/($CellContext`upper$[$CellContext`\
xmix$] - $CellContext`lower$[$CellContext`xmix$])]; $CellContext`newtie$[
           Pattern[$CellContext`x$, 
            Blank[]]] := (
            1 - $CellContext`lever$) $CellContext`lower$[$CellContext`x$] + \
$CellContext`lever$ $CellContext`upper$[$CellContext`x$]; $CellContext`x1$ = 
         ReplaceAll[$CellContext`x, 
           
           FindRoot[$CellContext`newtie$[$CellContext`x] == 
            Interpolation[$CellContext`phase$][$CellContext`x], \
{$CellContext`x, 0.1}]]; $CellContext`x2$ = ReplaceAll[$CellContext`x, 
           
           FindRoot[$CellContext`newtie$[$CellContext`x] == 
            Interpolation[$CellContext`phase$][$CellContext`x], \
{$CellContext`x, 0.9}]]; If[$CellContext`ymix$ > Quiet[
            
            Interpolation[$CellContext`phase$][$CellContext`xmix$]], \
$CellContext`reset$$ = $CellContext`reset$$ + 1]; 
        Show[$CellContext`gridlines, $CellContext`diagram, 
          PlotRange -> {{-0.25, 1.25}, {-0.2, 0.95}}, ImageSize -> {600, 390},
           Epilog -> {{Thick, 
             Line[
              Map[{#, 
                Interpolation[$CellContext`phase$][#]}& , 
               Range[
                Part[$CellContext`phase$, 1, 1], 
                Part[$CellContext`phase$, -1, 1], 0.01]]], 
             Line[$CellContext`tie$]}, 
            If[$CellContext`midland$$ == 1, {
              Text[
               Style[
                Column[{"mass % in feed", 
                  Framed[
                   Column[{
                    Row[{"solute = ", $CellContext`feedA$, "%"}], 
                    Row[{"carrier = ", $CellContext`feedC$, "%"}], 
                    Row[{"solvent = ", $CellContext`feedS$, "%"}]}, Alignment -> 
                    "="], Background -> White]}, Center], 17], {
               0, 0.9 (Sqrt[3]/2)}], 
              $CellContext`pt2[$CellContext`feed$$, $CellContext`colF], 
              Text[
               Style[
               "feed", 17, $CellContext`colF, Background -> 
                White], $CellContext`feed$$, {0, -1.75}], 
              If[$CellContext`solution$$, 
               $CellContext`pt1[{
                1 - ($CellContext`feedA$/100) (Sqrt[3]/2)/
                 Tan[$CellContext`\[Theta]], ($CellContext`feedA$/100) (
                  Sqrt[3]/2)}, $CellContext`colF]]}], 
            If[$CellContext`midland$$ > 1, {
              $CellContext`pt1[{
               1 - ($CellContext`feedA$/100) (Sqrt[3]/2)/
                Tan[$CellContext`\[Theta]], ($CellContext`feedA$/100) (
                 Sqrt[3]/2)}, $CellContext`colF], 
              Text[
               Style[" F ", 17, $CellContext`colF, Background -> White], {
               1 - ($CellContext`feedA$/100) (Sqrt[3]/2)/
                Tan[$CellContext`\[Theta]], ($CellContext`feedA$/100) (
                 Sqrt[3]/2)}, {0, -2}]}], 
            If[$CellContext`midland$$ == 2, {
              Text[
               Style[
                Column[{"mass % in solvent", 
                  Framed[
                   Column[{
                    Row[{"solute = ", 0, "%"}], 
                    Row[{"carrier = ", 0, "%"}], 
                    Row[{"solvent = ", 100, "%"}]}, Alignment -> "="], 
                   Background -> White]}, Center], 17], {0, 0.9 (Sqrt[3]/2)}], 
              $CellContext`pt2[$CellContext`solvent$$, $CellContext`colS], 
              Text[
               Style[
               "solvent", 17, $CellContext`colS, Background -> 
                White], $CellContext`solvent$$, {0, -1.75}], 
              If[$CellContext`solution$$, 
               $CellContext`pt1[{0, 0}, $CellContext`colS]]}], 
            If[$CellContext`midland$$ > 2, {
              $CellContext`pt1[{0, 0}, $CellContext`colS], 
              Text[
               Style["S", 17, $CellContext`colS, Background -> White], {0, 
               0}, {0, -2}]}], 
            If[$CellContext`midland$$ == 3, {{
               Thickness[0.007], 
               CapForm[None], Dashed, Magenta, 
               Line[{$CellContext`line1$$, $CellContext`line2$$}]}, 
              $CellContext`pt2[$CellContext`line1$$, Magenta], 
              $CellContext`pt2[$CellContext`line2$$, Magenta], 
              If[$CellContext`solution$$, {
                Thickness[0.007], 
                CapForm[None], Magenta, 
                
                Line[{{0, 0}, {
                  1 - ($CellContext`feedA$/100) ((Sqrt[3]/2)/
                    Tan[$CellContext`\[Theta]]), ($CellContext`feedA$/100) (
                    Sqrt[3]/2)}}]}]}], 
            If[$CellContext`midland$$ > 3, {
              Thickness[0.007], 
              CapForm[None], Magenta, 
              
              Line[{{0, 0}, {
                1 - ($CellContext`feedA$/100) ((Sqrt[3]/2)/
                  Tan[$CellContext`\[Theta]]), ($CellContext`feedA$/100) (
                  Sqrt[3]/2)}}]}], 
            If[$CellContext`midland$$ == 4, {
              $CellContext`pt2[$CellContext`mixing$$, $CellContext`colM], 
              Text[
               Style[
               "mixing", 17, $CellContext`colM, Background -> 
                White], $CellContext`mixing$$, {0, -1.75}], 
              If[$CellContext`solution$$ == False, 
               Text[
                Style[
                 Column[{"mass flow (kg/h)", 
                   Framed[
                    Column[{
                    Row[{"feed = ", 
                    NumberForm[$CellContext`mF$, {5, 1}]}], 
                    Row[{"solvent = ", 
                    NumberForm[$CellContext`mS$, {5, 1}]}]}, Alignment -> 
                    "="], Background -> White], 
                   Row[{
                    Style["F", Italic], "/", 
                    Style["S", Italic], " = ", 
                    NumberForm[$CellContext`FtoS$, {5, 1}]}]}, Center], 17], {
                1, 0.9 (Sqrt[3]/2)}]], 
              If[$CellContext`solution$$, 
               $CellContext`pt1[{$CellContext`xmix$, 
                 $CellContext`func1$[$CellContext`xmix$]}, \
$CellContext`colM]]}], 
            If[$CellContext`midland$$ > 4, {
              $CellContext`pt1[{$CellContext`xmix$, 
                $CellContext`func1$[$CellContext`xmix$]}, $CellContext`colM], 
              Text[
               Style[
               "M", 17, $CellContext`colM, Background -> 
                White], {$CellContext`xmix$, 
                $CellContext`func1$[$CellContext`xmix$]}, {0, -2}]}], 
            If[$CellContext`midland$$ == 5, {
              If[$CellContext`solution$$, 
               Text[
                Framed[
                 Style[
                  Column[{
                    Style[
                    Row[{"solute = ", 
                    NumberForm[$CellContext`massA$ 100, {4, 0}], 
                    "%"}], $CellContext`colA], 
                    Style[
                    Row[{"carrier = ", 
                    NumberForm[$CellContext`massC$ 100, {4, 0}], 
                    "%"}], $CellContext`colC], 
                    Style[
                    Row[{"solvent = ", 
                    NumberForm[$CellContext`massS$ 100, {4, 0}], 
                    "%"}], $CellContext`colS]}, Alignment -> "="], 17], 
                 Background -> White], {1, 0.9 (Sqrt[3]/2)}]], 
              If[$CellContext`solution$$ == False, 
               Text[
                Style[
                 Column[{"mass flow (kg/h)", 
                   Framed[
                    Column[{
                    Row[{"feed = ", 
                    NumberForm[$CellContext`mF$, {5, 1}]}], 
                    Row[{"solvent = ", 
                    NumberForm[$CellContext`mS$, {5, 1}]}]}, Alignment -> 
                    "="], Background -> White], 
                   Row[{
                    Style["F", Italic], "/", 
                    Style["S", Italic], " = ", 
                    NumberForm[$CellContext`FtoS$, {5, 1}]}]}, Center], 17], {
                1, 0.9 (Sqrt[3]/2)}]]}], 
            If[$CellContext`midland$$ == 6, {{Thick, Dashed, 
               Line[{$CellContext`outletE$$, $CellContext`outletR$$}]}, 
              $CellContext`pt2[$CellContext`outletE$$, $CellContext`colE], 
              $CellContext`pt2[$CellContext`outletR$$, $CellContext`colR], 
              Apply[If[$CellContext`solution$$ == False, 
                Text[
                 Style[#, 17, #2, Background -> White], #3, {0, -1.75}]]& , {{
                "extract", $CellContext`colE, $CellContext`outletE$$}, {
                "raffinate", $CellContext`colR, $CellContext`outletR$$}}, {
               1}], 
              If[$CellContext`solution$$, {
                Thickness[0.0075], Dashed, Orange, 
                Line[
                 Map[{#, 
                   $CellContext`newtie$[#]}& , 
                  Range[$CellContext`x1$, $CellContext`x2$, 0.01]]], 
                $CellContext`pt1[{$CellContext`x1$, 
                  $CellContext`newtie$[$CellContext`x1$]}, $CellContext`colE], 
                $CellContext`pt1[{$CellContext`x2$, 
                  $CellContext`newtie$[$CellContext`x2$]}, $CellContext`colR], 
                Text[
                 Style[
                 "E", 17, $CellContext`colE, Background -> 
                  White], {$CellContext`x1$, 
                  $CellContext`newtie$[$CellContext`x1$]}, {0, -1.75}], 
                Text[
                 Style[
                 "R", 17, $CellContext`colR, Background -> 
                  White], {$CellContext`x2$, 
                  $CellContext`newtie$[$CellContext`x2$]}, {0, -1.75}]}]}]}]],
       "Specifications" :> {
        Style[
         PaneSelector[{
          1 -> "step 1: move the point to the correct feed composition", 2 -> 
           "step 2: move the point to the correct solvent composition", 3 -> 
           "step 3: draw a line connecting feed and solvent compositions", 4 -> 
           "step 4: move the point to the correct mixing point location", 5 -> 
           "step 5: use sliders to set the correct mass percentages of the \
mixing point", 6 -> "step 6: determine outlet compositions"}, 
          Dynamic[$CellContext`midland$$]], 
         Bold], {{$CellContext`midland$$, 6, ""}, {1, 2, 3, 4, 5, 6}, 
         ControlType -> None, ControlPlacement -> 
         1}, {{$CellContext`solution$$, False, "solution"}, {True, False}, 
         Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         2}, {{$CellContext`reset$$, 1}, 1, 1000, 1, ControlType -> None, 
         ControlPlacement -> 3}, 
        Grid[{{
           Button[" new problem ", {
             
             If[$CellContext`reset$$ < 
              1000, $CellContext`reset$$ = $CellContext`reset$$ + 
               1, $CellContext`reset$$ = $CellContext`reset$$ - 
               1], $CellContext`midland$$ = 
             1, $CellContext`feed$$ = {
              0.5, 0.7 (Sqrt[3]/2)}, $CellContext`solvent$$ = {
              0.5, 0.7 (Sqrt[3]/2)}, $CellContext`line1$$ = {
              0.35, 0.6 (Sqrt[3]/2)}, $CellContext`line2$$ = {
              0.65, 0.6 (Sqrt[3]/2)}, $CellContext`mixing$$ = {
              0.5, 0.7 (Sqrt[3]/2)}, 
             
             If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 
           PaneSelector[{1 -> Style["(1) feed composition", 
               RGBColor[1, 0.4, 0]], 2 -> Style["(2) solvent composition", 
               RGBColor[0, 0.6, 0]], 3 -> "(3) draw mass balance line", 4 -> 
             Style["(4) mixing point composition", 
               RGBColor[0.5, 0, 0.5]], 5 -> "(5) mixing point composition", 6 -> 
             "(6) outlet streams"}, 
            Dynamic[$CellContext`midland$$]], 
           PaneSelector[{1 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`midland$$, Less, 
                  6], $CellContext`midland$$ = $CellContext`midland$$ + 
                  1, $CellContext`midland$$ = 6], 
                
                If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 2 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`midland$$, Less, 
                  6], $CellContext`midland$$ = $CellContext`midland$$ + 
                  1, $CellContext`midland$$ = 6], 
                
                If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 3 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`midland$$, Less, 
                  6], $CellContext`midland$$ = $CellContext`midland$$ + 
                  1, $CellContext`midland$$ = 6], 
                
                If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 4 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`midland$$, Less, 
                  6], $CellContext`midland$$ = $CellContext`midland$$ + 
                  1, $CellContext`midland$$ = 6], 
                
                If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}], 5 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`midland$$, Less, 
                  6], $CellContext`midland$$ = $CellContext`midland$$ + 
                  1, $CellContext`midland$$ = 6], 
                
                If[$CellContext`midland$$ == $CellContext`midland$$, \
$CellContext`solution$$ = False]}]}, 
            Dynamic[$CellContext`midland$$]], 
           Manipulate`Place[1], 
           Spacer[15], 
           Manipulate`Place[2], 
           Manipulate`Place[3]}}], {{$CellContext`wtA$$, 80, 
          Style["solute", 
           RGBColor[0, 0, 1]]}, 0, 100, 1, Appearance -> "Labeled", ImageSize -> 
         Tiny, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         4}, {{$CellContext`wtC$$, 20, 
          Style["carrier", 
           RGBColor[0.8, 0, 0.01]]}, 0, 100, 1, Appearance -> "Labeled", 
         ImageSize -> Tiny, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         5}, {{$CellContext`wtS$$, 0, 
          Style["solvent", 
           RGBColor[0, 0.6, 0]]}, 0, 100, 1, Appearance -> "Labeled", 
         ImageSize -> Tiny, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         6}, {{$CellContext`feed$$, {0.5, 0.606217782649107}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         7}, {{$CellContext`solvent$$, {0.5, 0.606217782649107}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         8}, {{$CellContext`line1$$, {0.006000000000000005, 
          0.013999999999999985`}}, Automatic, ControlType -> Locator, 
         Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         9}, {{$CellContext`line2$$, {0.8220000000000001, 0.308}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         10}, {{$CellContext`mixing$$, {0.5, 0.606217782649107}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         11}, {{$CellContext`outletE$$, {0.03500000000000003, 
          0.03999999999999998}}, Automatic, ControlType -> Locator, 
         Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         12}, {{$CellContext`outletR$$, {0.899, 0.066}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 13}, 
        Grid[{{
           PaneSelector[{5 -> Row[{"mass percent (%):", 
                Spacer[5], 
                Manipulate`Place[4], 
                Manipulate`Place[5], 
                Manipulate`Place[6]}]}, 
            Dynamic[$CellContext`midland$$]], 
           
           PaneSelector[{
            1 -> Manipulate`Place[7], 2 -> Manipulate`Place[8], 3 -> Row[{
                Manipulate`Place[9], 
                Manipulate`Place[10]}], 4 -> Manipulate`Place[11], 6 -> Row[{
                Manipulate`Place[12], 
                Manipulate`Place[13]}]}, 
            Dynamic[$CellContext`midland$$]]}}]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`phase = 
       InterpolatingFunction[{{0.08, 0.98}}, {
         5, 7, 0, {12}, {4}, 0, 0, 0, 0, Automatic, {}, {}, False}, {{0.08, 
         0.15, 0.19, 0.25, 0.33, 0.44, 0.61, 0.68, 0.77, 0.83, 0.88, 0.98}}, {
         Developer`PackedArrayForm, {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 
          12}, {0., 0.1, 0.17, 0.26, 0.37, 0.45, 0.46, 0.43, 0.35, 0.26, 0.17,
           0.}}, {Automatic}], $CellContext`phase1 = {{0.09, 0}, {0.17, 
         0.13}, {0.28, 0.3}, {0.41, 0.44}, {0.55, 0.47}, {0.7, 0.42}, {0.83, 
         0.26}, {0.98, 0}}, $CellContext`phase2 = {{0.0545, 0}, {0.136, 
         0.134}, {0.226, 0.267}, {0.3405, 0.36}, {0.534, 0.398}, {0.673, 
         0.338}, {0.7925, 0.232}, {0.956, 0}}, $CellContext`phase3 = {{
         0.098, 0}, {0.172, 0.126}, {0.2285, 0.213}, {0.422, 0.338}, {0.55, 
         0.352}, {0.7055, 0.284}, {0.7925, 0.205}, {
         0.92, 0}}, $CellContext`phase4 = {{0.07, 0}, {0.14, 0.14}, {0.26, 
         0.35}, {0.42, 0.56}, {0.56, 0.59}, {0.7, 0.42}, {0.82, 0.24}, {
         0.95, 0}}, $CellContext`phase5 = {{0, 0}, {0.12, 0.15}, {0.23, 
         0.32}, {0.34, 0.45}, {0.6, 0.5}, {0.69, 0.42}, {0.77, 0.3}, {
         0.93, 0}}, $CellContext`tie1 = {{{0.12, 0.052}, {0.93, 0.078}}, {{
        0.16, 0.104}, {0.88, 0.173}}, {{0.2, 0.173}, {0.83, 0.26}}, {{0.26, 
        0.268}, {0.77, 0.346}}, {{0.34, 0.372}, {0.67, 
        0.433}}}, $CellContext`tie2 = {{{0.1, 0.07}, {0.9, 0.09}}, {{0.13, 
        0.12}, {0.84, 0.17}}, {{0.17, 0.18}, {0.77, 0.25}}, {{0.2, 0.23}, {
        0.7, 0.32}}, {{0.24, 0.28}, {0.64, 0.36}}}, $CellContext`tie3 = {{{
        0.12, 0.03}, {0.89, 0.06}}, {{0.15, 0.09}, {0.86, 0.11}}, {{0.19, 
        0.15}, {0.82, 0.17}}, {{0.24, 0.23}, {0.72, 0.27}}, {{0.28, 0.27}, {
        0.65, 0.32}}}, $CellContext`tie4 = {{{0.1, 0.06}, {0.9, 0.1}}, {{0.15,
         0.15}, {0.84, 0.21}}, {{0.21, 0.26}, {0.75, 0.35}}, {{0.28, 0.37}, {
        0.67, 0.46}}, {{0.37, 0.51}, {0.59, 0.56}}}, $CellContext`tie5 = {{{
        0.065, 0.07}, {0.87, 0.11}}, {{0.11, 0.13}, {0.83, 0.2}}, {{0.17, 
        0.22}, {0.76, 0.32}}, {{0.24, 0.33}, {0.69, 0.41}}, {{0.33, 0.44}, {
        0.6, 0.5}}}, $CellContext`\[Theta] = 
       60 Degree, $CellContext`gridlines = Graphics[{
          GrayLevel[0.65], {{
            
            Line[{{0.025, 0.04330127018922193}, {0.975, 
             0.04330127018922193}}], 
            Line[{{0.05, 0}, {0.025, 0.04330127018922193}}], 
            Line[{{0.95, 0}, {0.975, 0.04330127018922193}}]}, {
            
            Line[{{0.07500000000000001, 0.1299038105676658}, {0.925, 
             0.1299038105676658}}], 
            
            Line[{{0.15000000000000002`, 0}, {0.07500000000000001, 
              0.1299038105676658}}], 
            Line[{{0.85, 0}, {0.925, 0.1299038105676658}}]}, {
            
            Line[{{0.125, 0.21650635094610965`}, {0.875, 
             0.21650635094610965`}}], 
            Line[{{0.25, 0}, {0.125, 0.21650635094610965`}}], 
            Line[{{0.75, 0}, {0.875, 0.21650635094610965`}}]}, {
            
            Line[{{0.17500000000000002`, 0.30310889132455354`}, {0.825, 
             0.30310889132455354`}}], 
            
            Line[{{0.35000000000000003`, 0}, {0.17500000000000002`, 
              0.30310889132455354`}}], 
            Line[{{0.6499999999999999, 0}, {0.825, 0.30310889132455354`}}]}, {
            Line[{{0.225, 0.3897114317029974}, {0.775, 0.3897114317029974}}], 
            Line[{{0.45, 0}, {0.225, 0.3897114317029974}}], 
            Line[{{0.55, 0}, {0.775, 0.3897114317029974}}]}, {
            Line[{{0.275, 0.4763139720814413}, {0.725, 0.4763139720814413}}], 
            Line[{{0.55, 0}, {0.275, 0.4763139720814413}}], 
            Line[{{0.44999999999999996`, 0}, {0.725, 0.4763139720814413}}]}, {
            
            Line[{{0.32500000000000007`, 0.5629165124598852}, {
             0.6749999999999999, 0.5629165124598852}}], 
            
            Line[{{0.6500000000000001, 0}, {0.32500000000000007`, 
              0.5629165124598852}}], 
            
            Line[{{0.34999999999999987`, 0}, {0.6749999999999999, 
              0.5629165124598852}}]}, {
            
            Line[{{0.37500000000000006`, 0.649519052838329}, {0.625, 
             0.649519052838329}}], 
            
            Line[{{0.7500000000000001, 0}, {0.37500000000000006`, 
              0.649519052838329}}], 
            Line[{{0.2499999999999999, 0}, {0.625, 0.649519052838329}}]}, {
            
            Line[{{0.42500000000000004`, 0.7361215932167728}, {0.575, 
             0.7361215932167728}}], 
            
            Line[{{0.8500000000000001, 0}, {0.42500000000000004`, 
              0.7361215932167728}}], 
            Line[{{0.1499999999999999, 0}, {0.575, 0.7361215932167728}}]}, {
            Line[{{0.475, 0.8227241335952167}, {0.525, 0.8227241335952167}}], 
            Line[{{0.95, 0}, {0.475, 0.8227241335952167}}], 
            
            Line[{{0.050000000000000044`, 0}, {0.525, 
              0.8227241335952167}}]}}, {{
            Line[{{0.05, 0.08660254037844387}, {0.97, 0.08660254037844387}}], 
            Line[{{0.1, 0}, {0.0485, 0.08920061658979718}}], 
            Line[{{0.88, -0.02}, {0.95, 0.08660254037844387}}]}, {
            Line[{{0.1, 0.17320508075688773`}, {0.92, 0.17320508075688773`}}], 
            Line[{{0.2, 0}, {0.097, 0.17840123317959436`}}], 
            Line[{{0.78, -0.02}, {0.9, 0.17320508075688773`}}]}, {
            
            Line[{{0.15000000000000002`, 0.2598076211353316}, {0.87, 
             0.2598076211353316}}], 
            
            Line[{{0.30000000000000004`, 0}, {0.14550000000000002`, 
              0.26760184976939155`}}], 
            Line[{{0.6799999999999999, -0.02}, {0.85, 0.2598076211353316}}]}, {
            
            Line[{{0.2, 0.34641016151377546`}, {0.8200000000000001, 
             0.34641016151377546`}}], 
            Line[{{0.4, 0}, {0.194, 0.3568024663591887}}], 
            Line[{{0.58, -0.02}, {0.8, 0.34641016151377546`}}]}, {
            Line[{{0.25, 0.4330127018922193}, {0.77, 0.4330127018922193}}], 
            Line[{{0.5, 0}, {0.2425, 0.4460030829489859}}], 
            Line[{{0.48, -0.02}, {0.75, 0.4330127018922193}}]}, {
            Line[{{0.3, 0.5196152422706631}, {0.72, 0.5196152422706631}}], 
            Line[{{0.6, 0}, {0.291, 0.535203699538783}}], 
            Line[{{0.38, -0.02}, {0.7, 0.5196152422706631}}]}, {
            
            Line[{{0.35000000000000003`, 0.6062177826491071}, {
             0.6699999999999999, 0.6062177826491071}}], 
            Line[{{0.7000000000000001, 0}, {0.3395, 0.6244043161285803}}], 
            
            Line[{{0.2799999999999999, -0.02}, {0.6499999999999999, 
             0.6062177826491071}}]}, {
            Line[{{0.4, 0.6928203230275509}, {0.62, 0.6928203230275509}}], 
            Line[{{0.8, 0}, {0.388, 0.7136049327183774}}], 
            
            Line[{{0.17999999999999994`, -0.02}, {0.6, 
             0.6928203230275509}}]}, {
            
            Line[{{0.45, 0.7794228634059948}, {0.5700000000000001, 
             0.7794228634059948}}], 
            Line[{{0.9, 0}, {0.4365, 0.8028055493081746}}], 
            
            Line[{{0.07999999999999996, -0.02}, {0.55, 
             0.7794228634059948}}]}}}], $CellContext`diagram = Graphics[{{
           EdgeForm[
            Thickness[Large]], 
           FaceForm[None], 
           Polygon[{{0, 0}, {0.5, Sqrt[3]/2}, {1, 0}}]}, {{
            RGBColor[0, 0, 1], 
            Text[
             Style[10., 16], {0.95, 0.08660254037844387}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[90., 16], (-60) Degree], {0.05, 0.08660254037844387}, {
             1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[10., 16], 60 Degree], {0.1, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[20., 16], {0.9, 0.17320508075688773`}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[80., 16], (-60) Degree], {0.1, 0.17320508075688773`}, {
             1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[20., 16], 60 Degree], {0.2, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[30.000000000000004`, 16], {0.85, 0.2598076211353316}, {-2, 
             0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[70., 16], (-60) Degree], {0.15000000000000002`, 
             0.2598076211353316}, {1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[30.000000000000004`, 16], 60 Degree], {
             0.30000000000000004`, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[40., 16], {0.8, 0.34641016151377546`}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[60., 16], (-60) Degree], {0.2, 0.34641016151377546`}, {
             1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[40., 16], 60 Degree], {0.4, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[50., 16], {0.75, 0.4330127018922193}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[50., 16], (-60) Degree], {0.25, 0.4330127018922193}, {
             1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[50., 16], 60 Degree], {0.5, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[60., 16], {0.7, 0.5196152422706631}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[40., 16], (-60) Degree], {0.3, 0.5196152422706631}, {
             1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[60., 16], 60 Degree], {0.6, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[70., 16], {0.6499999999999999, 0.6062177826491071}, {-2, 
             0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[29.999999999999993`, 16], (-60) Degree], {
             0.35000000000000003`, 0.6062177826491071}, {1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[70., 16], 60 Degree], {0.7000000000000001, 0}, {1.2, 
             1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[80., 16], {0.6, 0.6928203230275509}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[19.999999999999996`, 16], (-60) Degree], {0.4, 
             0.6928203230275509}, {1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[80., 16], 60 Degree], {0.8, 0}, {1.2, 1.5}]}, {
            RGBColor[0, 0, 1], 
            Text[
             Style[90., 16], {0.55, 0.7794228634059948}, {-2, 0}], 
            RGBColor[0, 0.6, 0], 
            Text[
             Rotate[
              Style[9.999999999999998, 16], (-60) Degree], {0.45, 
             0.7794228634059948}, {1, -1}], 
            RGBColor[0.8, 0, 0.01], 
            Text[
             Rotate[
              Style[90., 16], 60 Degree], {0.9, 0}, {1.2, 1.5}]}}, 
          Text[
           Rotate[
            Style["solute", 17, 
             RGBColor[0, 0, 1]], (-60) Degree], {0.75, Sqrt[3]/4}, {-3, 0}], 
          Text[
           Rotate[
            Style["solvent", 17, 
             RGBColor[0, 0.6, 0]], 60 Degree], {0.25, Sqrt[3]/4}, {3, 0}], 
          Text[
           Style["carrier", 17, 
            RGBColor[0.8, 0, 0.01]], {0.5, 0}, {0, 5}], Null}], 
       Attributes[PlotRange] = {ReadProtected}, $CellContext`pt2[
         Pattern[$CellContext`pt, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]]] := {
         PointSize[0.03], $CellContext`col, 
         Point[$CellContext`pt], 
         PointSize[0.015], White, 
         Point[$CellContext`pt]}, $CellContext`colF = 
       RGBColor[1, 0.4, 0], $CellContext`pt1[
         Pattern[$CellContext`pt, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]]] := {
         PointSize[0.03], $CellContext`col, 
         Point[$CellContext`pt]}, $CellContext`colS = 
       RGBColor[0, 0.6, 0], $CellContext`colM = 
       RGBColor[0.5, 0, 0.5], $CellContext`colA = 
       RGBColor[0, 0, 1], $CellContext`colC = 
       RGBColor[0.8, 0, 0.01], $CellContext`colE = 
       RGBColor[1, 0, 0], $CellContext`colR = RGBColor[0, 0.6, 1]}; 
     Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->18954249,ExpressionUUID->"661e9e4f-7867-4d84-87bd-1f40ef0250f7"]
}, Open  ]],

Cell["", "DetailsSection",ExpressionUUID->"b0feefb6-a132-49b6-a7a4-02fa5fa73817"],

Cell[CellGroupData[{

Cell["", "ControlSuggestionsSection",ExpressionUUID->"d6345bff-73ba-4777-b1f8-83d7049dfbb6"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[
   " Resize Images",ExpressionUUID->"a9831dd5-fad8-4b63-ba7d-fb30a118924f"]}],
  "\"Click inside an image to reveal its orange resize frame.\\nDrag any of \
the orange resize handles to resize the image.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.721402361057309*^9},
 FontFamily->"Verdana",
 CellTags->
  "ResizeImages",ExpressionUUID->"213c91de-aa79-4237-a163-9ecb7ffbe3ee"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Rotate and Zoom in 3D",ExpressionUUID->
    "44e8bdc5-0039-41fb-9a3c-67522da90c77"]}],
  RowBox[{
   "\"Drag a 3D graphic to rotate it. Starting the drag near the center \
tumbles\\nthe graphic; starting near a corner turns it parallel to the plane \
of the screen.\\nHold down \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" (or \"", 
    FrameBox[
    "Cmd", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" on Mac) and drag up and down to zoom.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->
  "RotateAndZoomIn3D",ExpressionUUID->"9a3ac504-d964-41ab-a0c0-7bd6b795fd09"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[
   " Drag Locators",ExpressionUUID->"c337c12a-7a71-48e8-852e-cb3ca7cf3dbe"]}],
  RowBox[{"\"Drag any locator (\"", 
    GraphicsBox[
     LocatorBox[
      Scaled[{0.5, 0.5}]], ImageSize -> 20], 
    "\", etc.) to move it around.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.721402363290113*^9},
 FontFamily->"Verdana",
 CellTags->
  "DragLocators",ExpressionUUID->"1cdffc3d-4430-439a-b1b6-e7b3d97fb3fc"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Create and Delete Locators",ExpressionUUID->
    "09acd715-1fa2-4ced-a705-14c9112d0a19"]}],
  RowBox[{"\"Insert a new locator in the graphic by holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key\\nand clicking where you want it to be. Delete a locator by \
clicking it\\nwhile holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" key.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->
  "CreateAndDeleteLocators",ExpressionUUID->"63fdc020-286f-4939-93e1-\
88970e047817"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[
   " Slider Zoom",ExpressionUUID->"a7da249e-f1c7-484f-b554-0932427b88ea"]}],
  RowBox[{"\"Hold down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key while moving a slider to make fine adjustments in the slider \
value.\\nHold \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" and/or \"", 
    FrameBox[
    "Shift", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" at the same time as \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" to make ever finer adjustments.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.721402362337511*^9},
 FontFamily->"Verdana",
 CellTags->
  "SliderZoom",ExpressionUUID->"3387760b-1b32-41a6-94c0-d6f655d118d9"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[
   " Gamepad Controls",ExpressionUUID->
    "a671d847-02b6-487f-b063-68060db2ba3d"]}],
  "\"Control this Demonstration with a gamepad or other\\nhuman interface \
device connected to your computer.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.35696210375764*^9, 3.3895522232313623`*^9, 
  3.721402364280122*^9},
 FontFamily->"Verdana",
 CellTags->
  "GamepadControls",ExpressionUUID->"98781092-2079-4d4f-8295-c541d7f0fe4f"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[
   " Automatic Animation",ExpressionUUID->
    "a80028b3-65ec-4870-a699-de166157f1d0"]}],
  RowBox[{"\"Animate a slider in this Demonstration by clicking the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJzzTSzJSM1NLMlMTlRwL0osyMhMLlZwyy8CCjEzMjAwcIKwAgOI/R/IhBKc\n\
/4EAyGAG0f+nTZsGwgysIJIRKsWKLAXGIHFmEpUgLADxWUAkI24jZs+eTaEt\n\
IG+wQKRmzJgBlYf5lhEA30OqWA=="], "Graphics", ImageSize -> {9, 9}, ImageMargins -> 
      0, CellBaseline -> Baseline], BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"button\\nnext to the slider, and then clicking the play button that \
appears.\\nAnimate all controls by selecting \"", 
    StyleBox["Autorun", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.721402365378133*^9},
 FontFamily->"Verdana",
 CellTags->
  "AutomaticAnimation",ExpressionUUID->"d5639b59-8e23-46d0-aad8-2bc484cb691d"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Bookmark Animation",ExpressionUUID->
    "4b5542c8-8dc3-494b-9bff-fb6d27b735c4"]}],
  RowBox[{
   "\"See a prepared animation of this Demonstration by selecting\\n\"", 
    StyleBox["Animate Bookmarks", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->
  "BookmarkAnimation",ExpressionUUID->"a346f5a0-0a2b-48a5-983c-8ba2041ef1cc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SearchTermsSection",ExpressionUUID->"060c754c-2252-4082-99ad-4b9405822a58"],

Cell["chemical engineering", "SearchTerms",
 CellChangeTimes->{{3.721402367254136*^9, 3.72140237162936*^9}},
 CellID->650887660,ExpressionUUID->"625a98a9-a1df-4065-b3cb-b879985c854e"],

Cell["ternary phase diagram", "SearchTerms",
 CellChangeTimes->{{3.721402367254136*^9, 3.721402376492586*^9}},
 CellID->789385849,ExpressionUUID->"d5b3c8ce-a71f-4c40-be1f-a13ec107561d"],

Cell["ternary diagram", "SearchTerms",
 CellChangeTimes->{{3.721402367254136*^9, 3.7214023809492106`*^9}},
 CellID->467065237,ExpressionUUID->"0a4a11bf-e8fa-435d-8899-9fa0b2a92a75"],

Cell["liquid-liquid extraction", "SearchTerms",
 CellChangeTimes->{{3.721402367254136*^9, 3.721402387333049*^9}},
 CellID->111165622,ExpressionUUID->"7cfef047-fce6-40f6-98c6-afb54ce26a61"],

Cell["LLE", "SearchTerms",
 CellChangeTimes->{{3.721402367254136*^9, 3.7214023914828715`*^9}},
 CellID->83003860,ExpressionUUID->"86f33193-f8f4-456f-af07-73f551d2c6c3"],

Cell["mass balance", "SearchTerms",
 CellChangeTimes->{{3.721402367254136*^9, 3.721402393284875*^9}},
 CellID->186378867,ExpressionUUID->"f83bef5d-3f3a-4ce5-bbe7-1c57860e7571"],

Cell["separations", "SearchTerms",
 CellChangeTimes->{{3.729443293793322*^9, 3.729443296039126*^9}},
 CellID->79932300,ExpressionUUID->"1d204181-0788-48af-8008-217938b1dd22"]
}, Open  ]],

Cell["", "RelatedLinksSection",ExpressionUUID->"0de0f659-3693-4a64-8a80-708e5015ed89"],

Cell[CellGroupData[{

Cell["", "AuthorSection",ExpressionUUID->"2fe02929-8638-4d38-8ac8-6d4b04b3ed2f"],

Cell[TextData[{
 "Contributed by: ",
 ButtonBox["Rachael L. Baumann",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=Rachael+L.+\
Baumann"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=Rachael+L.+Baumann"]
}], "Author",
 CellChangeTimes->{{3.609784090101136*^9, 3.609784090103136*^9}, 
   3.60978412565917*^9, {3.6737923014250264`*^9, 3.673792313684103*^9}, {
   3.721402414474592*^9, 3.7214024152577963`*^9}},
 CellID->31372289,ExpressionUUID->"51c705c0-97d9-487b-b06b-6f3aa3a74610"],

Cell[TextData[{
 "Additional contributions by: ",
 ButtonBox["John L. Falconer",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=John+L.+\
Falconer"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=John+L.+Falconer"]
}], "Author",
 CellChangeTimes->{{3.6119539918036795`*^9, 3.611954006657529*^9}, {
   3.612814162192871*^9, 3.6128141856734595`*^9}, {3.6310182906611595`*^9, 
   3.6310182938753433`*^9}, {3.6324998002119703`*^9, 
   3.6324998249423847`*^9}, {3.632499947778411*^9, 3.6324999539327626`*^9}, {
   3.6325000200765457`*^9, 3.6325000248598194`*^9}, {3.635173347487643*^9, 
   3.6351733643826094`*^9}, {3.6356864559906425`*^9, 3.6356864559906425`*^9}, 
   3.635700513030712*^9, {3.6659447049622326`*^9, 3.6659447271204996`*^9}, {
   3.665948562325861*^9, 3.6659485631849103`*^9}, 3.6664587201240005`*^9, {
   3.6737060480817757`*^9, 3.673706048520279*^9}, 3.677590017437687*^9, {
   3.7214024174922037`*^9, 3.721402417741804*^9}},
 CellID->344056814,ExpressionUUID->"bda4ed58-d4ea-488c-98cc-b4f9e4dd0931"],

Cell["\<\
(University of Colorado Boulder, Department of Chemical and Biological \
Engineering)\
\>", "Author",
 CellChangeTimes->{{3.609784090101136*^9, 3.6097841105263042`*^9}},
 CellID->122665613,ExpressionUUID->"f2d4630c-1469-45e3-b294-c33ff16a1931"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1366, 686},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "Demonstration.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "ResizeImages"->{
  Cell[313795, 6762, 470, 11, 22, "ControlSuggestions",ExpressionUUID->"213c91de-aa79-4237-a163-9ecb7ffbe3ee",
   CellTags->"ResizeImages"]},
 "RotateAndZoomIn3D"->{
  Cell[314268, 6775, 800, 19, 22, "ControlSuggestions",ExpressionUUID->"9a3ac504-d964-41ab-a0c0-7bd6b795fd09",
   CellTags->"RotateAndZoomIn3D"]},
 "DragLocators"->{
  Cell[315071, 6796, 498, 14, 22, "ControlSuggestions",ExpressionUUID->"1cdffc3d-4430-439a-b1b6-e7b3d97fb3fc",
   CellTags->"DragLocators"]},
 "CreateAndDeleteLocators"->{
  Cell[315572, 6812, 761, 19, 22, "ControlSuggestions",ExpressionUUID->"63fdc020-286f-4939-93e1-88970e047817",
   CellTags->"CreateAndDeleteLocators"]},
 "SliderZoom"->{
  Cell[316336, 6833, 1002, 24, 22, "ControlSuggestions",ExpressionUUID->"3387760b-1b32-41a6-94c0-d6f655d118d9",
   CellTags->"SliderZoom"]},
 "GamepadControls"->{
  Cell[317341, 6859, 515, 13, 22, "ControlSuggestions",ExpressionUUID->"98781092-2079-4d4f-8295-c541d7f0fe4f",
   CellTags->"GamepadControls"]},
 "AutomaticAnimation"->{
  Cell[317859, 6874, 1627, 35, 22, "ControlSuggestions",ExpressionUUID->"d5639b59-8e23-46d0-aad8-2bc484cb691d",
   CellTags->"AutomaticAnimation"]},
 "BookmarkAnimation"->{
  Cell[319489, 6911, 1030, 24, 22, "ControlSuggestions",ExpressionUUID->"a346f5a0-0a2b-48a5-983c-8ba2041ef1cc",
   CellTags->"BookmarkAnimation"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"ResizeImages", 324466, 7034},
 {"RotateAndZoomIn3D", 324632, 7037},
 {"DragLocators", 324798, 7040},
 {"CreateAndDeleteLocators", 324970, 7043},
 {"SliderZoom", 325140, 7046},
 {"GamepadControls", 325303, 7049},
 {"AutomaticAnimation", 325473, 7052},
 {"BookmarkAnimation", 325646, 7055}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 194, 3, 74, "DemoTitle",ExpressionUUID->"8390a831-09a9-44f6-b3ab-f50cb5fef49d"],
Cell[CellGroupData[{
Cell[799, 29, 88, 0, 275, "InitializationSection",ExpressionUUID->"cbfc8ab4-ab26-4e83-ac2c-eb259901389a"],
Cell[890, 31, 271, 6, 33, "Input",ExpressionUUID->"02e54106-e008-4b7d-a91d-533365de3502",
 InitializationCell->True,
 CellID->38764562],
Cell[1164, 39, 915, 21, 33, "Input",ExpressionUUID->"e90ad32b-8695-48e3-9b42-499f136f11d7",
 InitializationCell->True,
 CellID->455768056],
Cell[2082, 62, 259, 5, 33, "Input",ExpressionUUID->"a04dcac1-c33c-47b2-a877-25b00e9db14c",
 InitializationCell->True,
 CellID->319363885],
Cell[2344, 69, 865, 24, 33, "Input",ExpressionUUID->"ac8b1106-dbdd-472e-baef-2df5ecf35f40",
 InitializationCell->True,
 CellID->23304445],
Cell[3212, 95, 764, 22, 33, "Input",ExpressionUUID->"84b78838-19d7-4aab-88b1-8897b5f33db6",
 InitializationCell->True,
 CellID->69121300],
Cell[3979, 119, 808, 23, 33, "Input",ExpressionUUID->"0bbd809e-cb42-4536-8ca5-b25f556579fd",
 InitializationCell->True,
 CellID->352699659],
Cell[4790, 144, 748, 22, 33, "Input",ExpressionUUID->"d6b06f4b-a323-4903-8dc7-ad17385922b6",
 InitializationCell->True,
 CellID->502598256],
Cell[5541, 168, 743, 22, 33, "Input",ExpressionUUID->"1af09238-389a-4cce-8591-129390939512",
 InitializationCell->True,
 CellID->427095650],
Cell[6287, 192, 250, 5, 33, "Input",ExpressionUUID->"127898b7-0a12-489b-969a-9f748f3024a4",
 InitializationCell->True,
 CellID->103515199],
Cell[6540, 199, 1578, 43, 33, "Input",ExpressionUUID->"4eb78e18-d471-47e4-ba8a-2848f2b4aea5",
 InitializationCell->True,
 CellID->31799647],
Cell[8121, 244, 1499, 42, 33, "Input",ExpressionUUID->"176f52b8-d13c-43e9-9e76-1eb0e00018fb",
 InitializationCell->True,
 CellID->174162914],
Cell[9623, 288, 1612, 44, 33, "Input",ExpressionUUID->"fa242265-00ae-4ba8-99f9-8d13e33ee096",
 InitializationCell->True,
 CellID->75987909],
Cell[11238, 334, 1439, 41, 33, "Input",ExpressionUUID->"f4b490ac-b5bb-4516-9ba8-7f46f178a2e9",
 InitializationCell->True,
 CellID->183447444],
Cell[12680, 377, 1418, 41, 33, "Input",ExpressionUUID->"dc115fdb-59d5-4cd1-9958-72f3c792ee9d",
 InitializationCell->True,
 CellID->413693497],
Cell[14101, 420, 284, 6, 33, "Input",ExpressionUUID->"a73c21bb-b9f2-4983-ae5b-3f195100d510",
 InitializationCell->True,
 CellID->227039591],
Cell[14388, 428, 6845, 169, 381, "Input",ExpressionUUID->"cf648427-aa92-4105-8c87-fb341e394a4a",
 InitializationCell->True,
 CellID->272414272],
Cell[21236, 599, 253, 5, 33, "Input",ExpressionUUID->"abf9a5b5-8181-4a14-bc7e-b27b4bc75fd7",
 InitializationCell->True,
 CellID->249738370],
Cell[21492, 606, 4173, 113, 129, "Input",ExpressionUUID->"eb1087f1-30f0-40a5-9aa8-c3a81cbd30bc",
 InitializationCell->True,
 CellID->490870812],
Cell[25668, 721, 528, 13, 33, "Input",ExpressionUUID->"649e34a0-fff6-4d4e-951c-c53975d2511c",
 InitializationCell->True,
 CellID->428591391],
Cell[26199, 736, 725, 16, 33, "Input",ExpressionUUID->"fc7b94ee-1fc5-4c40-95ba-4ae32d9151e2",
 InitializationCell->True,
 CellID->645136754]
}, Closed]],
Cell[CellGroupData[{
Cell[26961, 757, 84, 0, 189, "ManipulateSection",ExpressionUUID->"f4086e12-214d-4dde-91a3-21a04c1a772e"],
Cell[CellGroupData[{
Cell[27070, 761, 58918, 1371, 3658, "Input",ExpressionUUID->"ae3f0cb4-ab4b-475c-a08d-473f49a7ef24",
 CellID->429302332],
Cell[85991, 2134, 45197, 916, 539, "Output",ExpressionUUID->"23bb51cd-a821-4adf-9676-91dc2d74bab1",
 CellID->17607410]
}, {2}]]
}, Open  ]],
Cell[CellGroupData[{
Cell[131234, 3056, 91, 0, 169, "ManipulateCaptionSection",ExpressionUUID->"ab410455-fc48-411a-a81a-6275f3786887"],
Cell[131328, 3058, 1108, 16, 67, "ManipulateCaption",ExpressionUUID->"f79280ad-eacb-44fb-b6ac-7fc85f450577",
 CellID->107102252]
}, Open  ]],
Cell[CellGroupData[{
Cell[132473, 3079, 83, 0, 172, "ThumbnailSection",ExpressionUUID->"69349f49-4a02-482e-b6ad-b9f7cc6fe02a"],
Cell[132559, 3081, 45198, 916, 539, "Output",ExpressionUUID->"8d5c3ede-7b47-4c8f-a86b-4af46c45bda7",
 CellID->222013489]
}, Open  ]],
Cell[CellGroupData[{
Cell[177794, 4002, 83, 0, 142, "SnapshotsSection",ExpressionUUID->"d4cbdcae-adc4-4559-a897-3433b9632197"],
Cell[177880, 4004, 45234, 916, 36, "Output",ExpressionUUID->"68e83353-d83a-4161-ac18-bc9048ac7783",
 CellID->372179902],
Cell[223117, 4922, 45234, 916, 36, "Output",ExpressionUUID->"c869807b-b144-4398-8676-6bf14073f37c",
 CellID->462351945],
Cell[268354, 5840, 45225, 913, 36, "Output",ExpressionUUID->"661e9e4f-7867-4d84-87bd-1f40ef0250f7",
 CellID->18954249]
}, Open  ]],
Cell[313594, 6756, 81, 0, 335, "DetailsSection",ExpressionUUID->"b0feefb6-a132-49b6-a7a4-02fa5fa73817"],
Cell[CellGroupData[{
Cell[313700, 6760, 92, 0, 114, "ControlSuggestionsSection",ExpressionUUID->"d6345bff-73ba-4777-b1f8-83d7049dfbb6"],
Cell[313795, 6762, 470, 11, 22, "ControlSuggestions",ExpressionUUID->"213c91de-aa79-4237-a163-9ecb7ffbe3ee",
 CellTags->"ResizeImages"],
Cell[314268, 6775, 800, 19, 22, "ControlSuggestions",ExpressionUUID->"9a3ac504-d964-41ab-a0c0-7bd6b795fd09",
 CellTags->"RotateAndZoomIn3D"],
Cell[315071, 6796, 498, 14, 22, "ControlSuggestions",ExpressionUUID->"1cdffc3d-4430-439a-b1b6-e7b3d97fb3fc",
 CellTags->"DragLocators"],
Cell[315572, 6812, 761, 19, 22, "ControlSuggestions",ExpressionUUID->"63fdc020-286f-4939-93e1-88970e047817",
 CellTags->"CreateAndDeleteLocators"],
Cell[316336, 6833, 1002, 24, 22, "ControlSuggestions",ExpressionUUID->"3387760b-1b32-41a6-94c0-d6f655d118d9",
 CellTags->"SliderZoom"],
Cell[317341, 6859, 515, 13, 22, "ControlSuggestions",ExpressionUUID->"98781092-2079-4d4f-8295-c541d7f0fe4f",
 CellTags->"GamepadControls"],
Cell[317859, 6874, 1627, 35, 22, "ControlSuggestions",ExpressionUUID->"d5639b59-8e23-46d0-aad8-2bc484cb691d",
 CellTags->"AutomaticAnimation"],
Cell[319489, 6911, 1030, 24, 22, "ControlSuggestions",ExpressionUUID->"a346f5a0-0a2b-48a5-983c-8ba2041ef1cc",
 CellTags->"BookmarkAnimation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[320556, 6940, 85, 0, 155, "SearchTermsSection",ExpressionUUID->"060c754c-2252-4082-99ad-4b9405822a58"],
Cell[320644, 6942, 183, 2, 22, "SearchTerms",ExpressionUUID->"625a98a9-a1df-4065-b3cb-b879985c854e",
 CellID->650887660],
Cell[320830, 6946, 185, 2, 22, "SearchTerms",ExpressionUUID->"d5b3c8ce-a71f-4c40-be1f-a13ec107561d",
 CellID->789385849],
Cell[321018, 6950, 181, 2, 22, "SearchTerms",ExpressionUUID->"0a4a11bf-e8fa-435d-8899-9fa0b2a92a75",
 CellID->467065237],
Cell[321202, 6954, 188, 2, 22, "SearchTerms",ExpressionUUID->"7cfef047-fce6-40f6-98c6-afb54ce26a61",
 CellID->111165622],
Cell[321393, 6958, 168, 2, 22, "SearchTerms",ExpressionUUID->"86f33193-f8f4-456f-af07-73f551d2c6c3",
 CellID->83003860],
Cell[321564, 6962, 176, 2, 22, "SearchTerms",ExpressionUUID->"f83bef5d-3f3a-4ce5-bbe7-1c57860e7571",
 CellID->186378867],
Cell[321743, 6966, 174, 2, 22, "SearchTerms",ExpressionUUID->"1d204181-0788-48af-8008-217938b1dd22",
 CellID->79932300]
}, Open  ]],
Cell[321932, 6971, 86, 0, 141, "RelatedLinksSection",ExpressionUUID->"0de0f659-3693-4a64-8a80-708e5015ed89"],
Cell[CellGroupData[{
Cell[322043, 6975, 80, 0, 129, "AuthorSection",ExpressionUUID->"2fe02929-8638-4d38-8ac8-6d4b04b3ed2f"],
Cell[322126, 6977, 576, 13, 22, "Author",ExpressionUUID->"51c705c0-97d9-487b-b06b-6f3aa3a74610",
 CellID->31372289],
Cell[322705, 6992, 1103, 20, 22, "Author",ExpressionUUID->"bda4ed58-d4ea-488c-98cc-b4f9e4dd0931",
 CellID->344056814],
Cell[323811, 7014, 254, 5, 22, "Author",ExpressionUUID->"f2d4630c-1469-45e3-b294-c33ff16a1931",
 CellID->122665613]
}, Open  ]]
}, Open  ]]
}
]
*)

