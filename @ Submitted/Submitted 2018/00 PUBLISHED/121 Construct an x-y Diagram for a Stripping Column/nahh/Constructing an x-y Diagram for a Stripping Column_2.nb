(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    160062,       3736]
NotebookOptionsPosition[    150388,       3553]
NotebookOutlinePosition[    152447,       3603]
CellTagsIndexPosition[    152111,       3591]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 "Construct an ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "-", "y"}], TraditionalForm]], "InlineMath",ExpressionUUID->
  "2eef4924-843c-4fa9-b4bc-40a3cfbb0f91"],
 " Diagram for a Stripping Column"
}], "DemoTitle",
 CellChangeTimes->{{3.726412557270673*^9, 3.726412568375308*^9}, {
  3.729445670827944*^9, 
  3.7294456746521683`*^9}},ExpressionUUID->"ab2b8b81-d21f-4498-94bc-\
5aadb10171b2"],

Cell[CellGroupData[{

Cell["", "InitializationSection",ExpressionUUID->"7a75f165-9113-403f-b913-2ba3a0a3e6bb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"colL", "=", "Blue"}], ";", 
  RowBox[{"colV", "=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{"0", ",", "0.6", ",", "0"}], "]"}]}], ";", 
  RowBox[{"colOP", "=", "Magenta"}], ";", 
  RowBox[{"colEQ", "=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{"1", ",", "0.4", ",", "0"}], "]"}]}], ";", 
  RowBox[{"colS", "=", "Purple"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.722351924642107*^9, 3.722351934327661*^9}, {
  3.722353918292137*^9, 3.7223539318519125`*^9}, {3.72589295956456*^9, 
  3.7258929670372057`*^9}},
 CellID->448483865,ExpressionUUID->"fcd228ed-7be6-4698-a285-c867b21d3fc3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"textyN1", "=", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"Subscript", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
       RowBox[{"Row", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<N\>\"", ",", "Italic"}], "]"}], ",", "\"\<+1\>\""}], 
         "}"}]}]}], "]"}], ",", "17", ",", "colV", ",", 
     RowBox[{"Background", "\[Rule]", "White"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"textyN1", "=", 
     RowBox[{"Framed", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
           RowBox[{"Row", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<N\>\"", ",", "Italic"}], "]"}], ",", 
              "\"\<+1\>\""}], "}"}]}]}], "]"}], ",", "17", ",", "colV"}], 
        "]"}], ",", 
       RowBox[{"Background", "\[Rule]", "White"}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", "None"}], ",", 
       RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}]}], ";"}], 
   "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.724075877350924*^9, 3.724075880919031*^9}, {
  3.726242003062414*^9, 3.726242020920499*^9}, {3.726242111022149*^9, 
  3.726242116679878*^9}},
 CellID->493747658,ExpressionUUID->"dcaf6bb7-fb03-439c-b425-cc778b3f224b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"textxN", "=", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"Subscript", "[", 
      RowBox[{"\"\<x\>\"", ",", "\"\<N\>\""}], "]"}], ",", "Italic", ",", 
     "17", ",", "colL", ",", 
     RowBox[{"Background", "\[Rule]", "White"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"textxN", "=", 
     RowBox[{"Framed", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"\"\<x\>\"", ",", "\"\<N\>\""}], "]"}], ",", "Italic", ",", 
         "17", ",", "colL"}], "]"}], ",", 
       RowBox[{"Background", "\[Rule]", "White"}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", "None"}], ",", 
       RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}]}], ";"}], 
   "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7240759286771746`*^9, 3.7240759317310805`*^9}, {
  3.726242025554023*^9, 3.7262420451732225`*^9}, {3.7262421003041983`*^9, 
  3.7262421031023097`*^9}},
 CellID->241618003,ExpressionUUID->"49f58b9b-22ef-4e35-ab65-e75c8279f6f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"texty1", "=", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Subscript", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", "1"}], "]"}], ",",
        "17", ",", "colV", ",", 
       RowBox[{"Background", "\[Rule]", "White"}]}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"texty1", "=", 
    RowBox[{"Framed", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", "1"}], "]"}], 
        ",", "17", ",", "colV"}], "]"}], ",", 
      RowBox[{"Background", "\[Rule]", "White"}], ",", 
      RowBox[{"FrameStyle", "\[Rule]", "None"}], ",", 
      RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.724076016343301*^9, 3.7240760192203217`*^9}, {
  3.7262420493893456`*^9, 3.726242065088223*^9}},
 CellID->905169336,ExpressionUUID->"fd3da418-8c6f-4eff-a6e3-499b3c9f2475"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"textx0", "=", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Subscript", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", "0"}], "]"}], ",",
        "17", ",", "colL", ",", 
       RowBox[{"Background", "\[Rule]", "White"}]}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"textx0", "=", 
    RowBox[{"Framed", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", "0"}], "]"}], 
        ",", "17", ",", "colL"}], "]"}], ",", 
      RowBox[{"Background", "\[Rule]", "White"}], ",", 
      RowBox[{"FrameStyle", "\[Rule]", "None"}], ",", 
      RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.724076067768366*^9, 3.724076070775471*^9}, {
  3.7262420687498446`*^9, 3.7262420843689203`*^9}},
 CellID->462033904,ExpressionUUID->"fbc6132c-27ce-4975-b685-1710d2ca7487"],

Cell[BoxData[
 RowBox[{
  RowBox[{"x0y1", "=", 
   RowBox[{"Framed", "[", 
    RowBox[{
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Row", "@", 
        RowBox[{"{", 
         RowBox[{"\"\<(\>\"", ",", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Subscript", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", "0"}], "]"}],
             ",", "colL"}], "]"}], ",", "\"\<, \>\"", ",", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Subscript", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", "1"}], "]"}],
             ",", "colV"}], "]"}], ",", "\"\<)\>\""}], "}"}]}], ",", "17"}], 
      "]"}], ",", 
     RowBox[{"Background", "\[Rule]", "White"}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", "None"}], ",", 
     RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.727799382541904*^9, 3.7277994654836483`*^9}, {
  3.7277995862875576`*^9, 3.7277995996283207`*^9}},
 CellID->60133328,ExpressionUUID->"e82ffc03-25ea-4794-a75f-e9209532051d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"xNyn1", "=", 
   RowBox[{"Framed", "[", 
    RowBox[{
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Row", "@", 
        RowBox[{"{", 
         RowBox[{"\"\<(\>\"", ",", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Subscript", "[", 
             RowBox[{"\"\<x\>\"", ",", "\"\<N\>\""}], "]"}], ",", "Italic", 
            ",", "colL"}], "]"}], ",", "\"\<, \>\"", ",", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Subscript", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<N\>\"", ",", "Italic"}], "]"}], ",", 
                 "\"\<+1\>\""}], "}"}]}]}], "]"}], ",", "colV"}], "]"}], ",", 
          "\"\<)\>\""}], "}"}]}], ",", "17"}], "]"}], ",", 
     RowBox[{"Background", "\[Rule]", "White"}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", "None"}], ",", 
     RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7277994676587725`*^9, 3.7277995360186825`*^9}, {
  3.727799604928624*^9, 3.7277996202555003`*^9}, {3.7277997033512535`*^9, 
  3.7277997062744207`*^9}, {3.72779974822482*^9, 3.7277997489068584`*^9}},
 CellID->293923279,ExpressionUUID->"58b02b72-8db3-45a3-8bef-37ea227508b1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ManipulateSection",ExpressionUUID->"6737209a-a623-4c86-a530-0ea2aa9d2542"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "P", ",", "T", ",", "L", ",", "V", ",", "Ea", ",", "R", ",", "T0", ",", 
       "H0", ",", "H", ",", "x0", ",", "xN", ",", "xp1", ",", "yn1", ",", 
       "y1", ",", "yeq", ",", "yop", ",", "xp2", ",", "xp3", ",", "xp4", ",", 
       "X", ",", "Y", ",", "ntest", ",", "n", ",", "xop", ",", "xeq", ",", 
       "opt", ",", "pt1", ",", "pt2", ",", "pt3", ",", "plotlabel", ",", 
       "column", ",", "diagram"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SeedRandom", "[", "reset", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"P", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"2.1", ",", "2.4"}], "}"}], "]"}]}], ";", 
      RowBox[{"(*", "atm", "*)"}], 
      RowBox[{"T", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "16"}], "}"}], "]"}]}], ";", 
      RowBox[{"(*", "\[Degree]C", "*)"}], 
      RowBox[{"L", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"80", ",", "100"}], "}"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"V", "=", 
         RowBox[{"RandomReal", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1.5"}], "}"}], "]"}]}], ";"}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{"Mmol", "/", "h"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Ea", "=", "5000"}], ";", 
      RowBox[{"R", "=", "8.314"}], ";", 
      RowBox[{"T0", "=", "298"}], ";", 
      RowBox[{"H0", "=", "211.19"}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"atm", "/", "mole"}], " ", 
        RowBox[{"frac", "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"H", "=", 
       RowBox[{"H0", "*", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["Ea", "R"]}], "*", 
          RowBox[{"(", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"T", "+", "273"}]], "-", 
            FractionBox["1", "T0"]}], ")"}]}], "]"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"atm", "/", "mole"}], " ", 
        RowBox[{"frac", "."}]}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"V", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"x0", "=", "0.35"}], ";", 
      RowBox[{"xN", "=", "0.1"}], ";", 
      RowBox[{"xp1", "=", "0.385"}], ";", "\[IndentingNewLine]", 
      RowBox[{"yn1", "=", "1"}], ";", 
      RowBox[{"y1", "=", 
       RowBox[{"yn1", "-", 
        RowBox[{
         FractionBox["L", "V"], "*", 
         RowBox[{"(", 
          RowBox[{"xN", "-", "x0"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yeq", "[", "x_", "]"}], ":=", 
       RowBox[{
        FractionBox["H", "P"], "*", "x"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yop", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         FractionBox["L", "V"], "*", 
         RowBox[{"(", 
          RowBox[{"x", "-", "x0"}], ")"}]}], "+", "y1"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"xp2", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yop", "[", "x", "]"}], "\[Equal]", "0"}], ",", "x"}], 
          "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", 
      RowBox[{"xp3", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yop", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"1.1", "*", "y1"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xp4", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"1.1", "*", "y1"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"X", "[", "0", "]"}], "=", "x0"}], ";", 
      RowBox[{
       RowBox[{"Y", "[", "0", "]"}], "=", 
       RowBox[{"yop", "[", "x0", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"X", "[", "i", "]"}], "=", 
           RowBox[{"x", "/.", 
            RowBox[{
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", 
                RowBox[{"Y", "[", 
                 RowBox[{"i", "-", "1"}], "]"}]}], ",", "x", ",", "Reals"}], 
              "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"Y", "[", "i", "]"}], "=", 
           RowBox[{"yop", "[", 
            RowBox[{"X", "[", "i", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "10"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ntest", "=", 
       RowBox[{"1", "+", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"X", "[", "#", "]"}], "<", "xN"}], ",", "0", ",", 
              "#"}], "]"}], "&"}], "/@", 
           RowBox[{"Range", "@", "10"}]}], ",", "0"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "ntest"}], "\[Equal]", "0"}], ",", "0", ",", 
         RowBox[{"ntest", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xop", "[", "stage_", "]"}], ":=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yop", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"stage", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", 
      RowBox[{
       RowBox[{"xeq", "[", "stage_", "]"}], ":=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"stage", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"opt", "=", 
       RowBox[{"Sequence", "[", 
        RowBox[{
         RowBox[{"Thickness", "@", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"graphic", "\[And]", 
             RowBox[{"NPR", "<", "4"}]}], ",", "0.011", ",", "0.008"}], 
           "]"}]}], ",", "Dotted"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pt1", "[", 
        RowBox[{"pt_", ",", "col_"}], "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{"col", ",", 
         RowBox[{"PointSize", "@", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"graphic", "\[And]", 
             RowBox[{"NPR", "<", "4"}]}], ",", "0.04", ",", "0.025"}], 
           "]"}]}], ",", 
         RowBox[{"Point", "@", "pt"}], ",", "White", ",", 
         RowBox[{"PointSize", "@", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"graphic", "\[And]", 
             RowBox[{"NPR", "<", "4"}]}], ",", "0.025", ",", "0.015"}], 
           "]"}]}], ",", 
         RowBox[{"Point", "@", "pt"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pt2", "[", 
        RowBox[{"pt_", ",", "col_"}], "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{"col", ",", 
         RowBox[{"PointSize", "@", 
          RowBox[{"If", "[", 
           RowBox[{"graphic", ",", "0.035", ",", "0.02"}], "]"}]}], ",", 
         RowBox[{"Point", "@", "pt"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pt3", "[", 
        RowBox[{"pt_", ",", "col_"}], "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{"col", ",", 
         RowBox[{"PointSize", "@", 
          RowBox[{"If", "[", 
           RowBox[{"graphic", ",", "0.035", ",", "0.02"}], "]"}]}], ",", 
         RowBox[{"Point", "@", "pt"}], ",", "White", ",", 
         RowBox[{"PointSize", "@", 
          RowBox[{"If", "[", 
           RowBox[{"graphic", ",", "0.02", ",", "0.01"}], "]"}]}], ",", 
         RowBox[{"Point", "@", "pt"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"plotlabel", "=", 
       RowBox[{"Switch", "[", 
        RowBox[{"NPR", ",", "\[IndentingNewLine]", "1", ",", 
         RowBox[{"If", "[", 
          RowBox[{
          "hint", ",", "\"\<hint: use mass balance on solute\>\"", ",", 
           "\"\<step 1: calculate the gas flow rate, then check \
solution\>\""}], "]"}], ",", "\[IndentingNewLine]", "2", ",", 
         RowBox[{"If", "[", 
          RowBox[{
          "hint", ",", "\"\<hint: use mass balance from step 1\>\"", ",", 
           "\"\<step 2: click and drag the points to create the operating \
line, then check solution\>\""}], "]"}], ",", "\[IndentingNewLine]", "3", ",", 
         RowBox[{"If", "[", 
          RowBox[{"hint", ",", "\"\<hint: use Henry's law\>\"", ",", 
           RowBox[{"Column", "[", 
            RowBox[{"{", 
             RowBox[{
             "\"\<step 3: click and drag points to create the equilibrium \
line, then check solution\>\"", ",", 
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<P\>\"", ",", "Italic"}], "]"}], ",", 
                 "\"\< = \>\"", ",", 
                 RowBox[{"NumberForm", "[", 
                  RowBox[{"P", ",", 
                   RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}]}], "]"}], ",", 
                 "\"\< atm and \>\"", ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<H\>\"", ",", "Italic"}], "]"}], ",", 
                 "\"\< = \>\"", ",", 
                 RowBox[{"NumberForm", "[", 
                  RowBox[{"H", ",", 
                   RowBox[{"{", 
                    RowBox[{"4", ",", "1"}], "}"}]}], "]"}], ",", 
                 "\"\< atm/mole fraction\>\""}], "}"}]}]}], "}"}], "]"}]}], 
          "]"}], ",", "\[IndentingNewLine]", "4", ",", 
         RowBox[{"If", "[", 
          RowBox[{
          "hint", ",", 
           "\"\<hint: start counting stages from the top of the column\>\"", 
           ",", 
           RowBox[{"Column", "[", 
            RowBox[{"{", 
             RowBox[{
             "\"\<step 4: drag the black point to move the dashed line to \
draw the first stage,\>\"", ",", "\"\<then check solution\>\""}], "}"}], 
            "]"}]}], "]"}], ",", "\[IndentingNewLine]", "5", ",", 
         RowBox[{"If", "[", 
          RowBox[{
          "hint", ",", 
           "\"\<hint: start drawing the second stage where the forst stage \
left off\>\"", ",", 
           RowBox[{"Column", "[", 
            RowBox[{"{", 
             RowBox[{
             "\"\<step 5: drag the black point to move the dashed line to \
draw the second\>\"", ",", "\"\<stage, then check solution\>\""}], "}"}], 
            "]"}]}], "]"}], ",", "\[IndentingNewLine]", "6", ",", 
         RowBox[{"If", "[", 
          RowBox[{"hint", ",", 
           RowBox[{"Row", "@", 
            RowBox[{"{", 
             RowBox[{"\"\<hint: draw the last stage until \>\"", ",", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"\"\<x\>\"", ",", "\"\<N\>\""}], "]"}], ",", 
                "Italic"}], "]"}], ",", "\"\< is reached or surpassed\>\""}], 
             "}"}]}], ",", 
           RowBox[{"Column", "[", 
            RowBox[{"{", 
             RowBox[{
             "\"\<step 6: draw the black point to move the dashed line to \
draw the last stage,\>\"", ",", "\"\<then check solution\>\""}], "}"}], 
            "]"}]}], "]"}], ",", "\[IndentingNewLine]", "7", ",", 
         RowBox[{"Row", "@", 
          RowBox[{"{", 
           RowBox[{"\"\<solved \>\"", ",", 
            RowBox[{"Style", "[", 
             RowBox[{"\"\<x-y\>\"", ",", "Italic"}], "]"}], ",", 
            "\"\< diagram\>\""}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"column", "=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"h", ",", "w", ",", "ry"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"h", "=", "13"}], ";", 
          RowBox[{"w", "=", "12"}], ";", 
          RowBox[{"ry", "=", "2"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Graphics", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Thick", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"#", ",", "ry"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"h", "-", "ry"}]}], "}"}]}], "}"}], "]"}], "&"}], 
               "/@", 
               RowBox[{"{", 
                RowBox[{"0", ",", "w"}], "}"}]}], ",", 
              RowBox[{"Circle", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"w", "/", "2"}], ",", "ry"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"w", "/", "2"}], ",", "ry"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Pi]", ",", 
                  RowBox[{"2", "*", "\[Pi]"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"Circle", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"w", "/", "2"}], ",", 
                  RowBox[{"h", "-", "ry"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"w", "/", "2"}], ",", "ry"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Arrowheads", "@", "0.1"}], ",", 
                "\[IndentingNewLine]", "colV", ",", 
                RowBox[{"Arrow", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "w"}], "/", "2"}], ",", 
                    RowBox[{
                    RowBox[{"-", "h"}], "/", "4"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.25", "*", "w"}], ",", 
                    RowBox[{
                    RowBox[{"-", "h"}], "/", "4"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.25", "*", "w"}], ",", 
                    RowBox[{"ry", "/", "10"}]}], "}"}]}], "}"}], "]"}], ",", 
                RowBox[{"Arrow", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.25", "*", "w"}], ",", 
                    RowBox[{"h", "-", 
                    RowBox[{"ry", "/", "10"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.25", "*", "w"}], ",", 
                    RowBox[{"h", "+", 
                    RowBox[{"h", "/", "4"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "w"}], "/", "2"}], ",", 
                    RowBox[{"h", "+", 
                    RowBox[{"h", "/", "4"}]}]}], "}"}]}], "}"}], "]"}], ",", 
                "\[IndentingNewLine]", "colL", ",", 
                RowBox[{"Arrow", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.75", "*", "w"}], ",", 
                    RowBox[{"ry", "/", "10"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.75", "*", "w"}], ",", 
                    RowBox[{
                    RowBox[{"-", "h"}], "/", "4"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"w", "+", 
                    RowBox[{"w", "/", "2.3"}]}], ",", 
                    RowBox[{
                    RowBox[{"-", "h"}], "/", "4"}]}], "}"}]}], "}"}], "]"}], 
                ",", 
                RowBox[{"Arrow", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"w", "+", 
                    RowBox[{"w", "/", "2.3"}]}], ",", 
                    RowBox[{"h", "+", 
                    RowBox[{"h", "/", "4"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.75", "*", "w"}], ",", 
                    RowBox[{"h", "+", 
                    RowBox[{"h", "/", "4"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.75", "*", "w"}], ",", 
                    RowBox[{"h", "-", 
                    RowBox[{"ry", "/", "10"}]}]}], "}"}]}], "}"}], "]"}]}], 
               "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"4", "\[LessEqual]", "NPR", "\[LessEqual]", "6"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "#2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"w", ",", "#2"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"#1", ",", "17"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.5", "*", "w"}], ",", "#2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "}"}], "&"}], "@@@", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<N\>\"", ",", "Italic"}], "]"}], ",", "ry"}], 
                    "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], ",", 
                    RowBox[{"0.5", "*", "h"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"h", "-", "ry"}]}], "}"}]}], "}"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Text", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"P", ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}]}], "]"}], ",", 
                    "\"\< atm\>\""}], "}"}]}], ",", 
                    RowBox[{"Spacer", "@", "0"}], ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"T", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "0"}], "}"}]}], "]"}], ",", 
                    "\"\<\[Degree]C\>\""}], "}"}]}]}], "}"}], ",", "Center"}],
                     "]"}], ",", "17"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"w", "/", "2"}], ",", 
                    RowBox[{"h", "/", "2"}]}], "}"}]}], "]"}]}], 
               "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"Column", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"NPR", "\[Equal]", "1"}], ",", 
                    "\"\<liquid solvent feed\>\""}], "]"}], ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<L\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"L", ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "0"}], "}"}]}], "]"}], ",", 
                    "\"\< Mmol/h\>\""}], "}"}]}]}], "}"}], ",", "Right"}], 
                   "]"}], ",", "17", ",", "colL"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"w", ",", 
                  RowBox[{"h", "+", 
                   RowBox[{"h", "/", "4"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0.2", ",", 
                  RowBox[{"-", "1.2"}]}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"Column", "[", 
                   RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<V\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"NPR", "\[Equal]", "1"}], ",", "gas", ",", "V"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "1"}], "}"}]}], "]"}], ",", 
                    "\"\< Mmol/h\>\""}], "}"}]}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"NPR", "\[Equal]", "1"}], ",", "colS", ",", 
                    "colV"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"NPR", "\[Equal]", "1"}], "\[And]", "solution"}], 
                    ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<correct \>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<V\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"V", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "1"}], "}"}]}], "]"}], ",", 
                    "\"\< Mmol/h\>\""}], "}"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"NPR", "\[Equal]", "1"}], ",", 
                    "\"\<gas feed\>\""}], "]"}]}], "\[IndentingNewLine]", 
                    "}"}], "/.", 
                    RowBox[{"Null", "\[Rule]", "Nothing"}]}], "]"}], ",", 
                  "17", ",", "colV"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{
                   RowBox[{"-", "h"}], "/", "4"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"(*", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"NPR", "\[Equal]", "1"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{"solution", ",", 
                    RowBox[{"-", "0.55"}], ",", "0"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{"graphic", ",", 
                    RowBox[{"-", "0.5"}], ",", "0"}], "]"}]}], "]"}], "*)"}], 
                 RowBox[{"0", ",", "1.4"}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Text", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", "#2"}], 
                    "]"}], ",", "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"#1", ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "1"}], "}"}]}], "]"}], ",", 
                    "\"\< ppm\>\""}], "}"}]}], ",", "17", ",", "colV", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "#3"}], "}"}]}], "]"}], "&"}], "@@@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"y1", ",", "1", ",", 
                   RowBox[{"h", "+", "2"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"yn1", ",", 
                   RowBox[{"n", "+", "1"}], ",", 
                   RowBox[{"-", "2"}]}], "}"}]}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Text", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", "#2"}], 
                    "]"}], ",", "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"#1", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}]}], "]"}], ",", 
                    "\"\< ppm\>\""}], "}"}]}], ",", "17", ",", "colL", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"w", ",", "#3"}], "}"}]}], "]"}], "&"}], "@@@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x0", ",", "0", ",", 
                   RowBox[{"h", "+", "2.25"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"NumberForm", "[", 
                    RowBox[{"xN", ",", "2"}], "]"}], ",", "n", ",", 
                   RowBox[{"-", "2"}]}], "}"}]}], "}"}]}]}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"NPR", "\[Equal]", "1"}], ",", "600", ",", "250"}], 
                "]"}], ",", "390"}], "}"}]}], ",", 
            RowBox[{"AspectRatio", "\[Rule]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"NPR", "\[Equal]", "1"}], ",", "1.25", ",", "Full"}], 
              "]"}]}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "0.5"}], "*", "w"}], ",", 
                 RowBox[{"1.6", "*", "w"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"NPR", "\[Equal]", "1"}], ",", 
                   RowBox[{
                    RowBox[{"-", "0.3"}], "*", "h"}], ",", 
                   RowBox[{
                    RowBox[{"-", "h"}], "/", "5"}]}], "]"}], ",", 
                 RowBox[{"h", "+", 
                  RowBox[{"h", "/", "7"}]}]}], "}"}]}], "}"}]}], ",", 
            RowBox[{"PlotRangePadding", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"None", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Scaled", "@", "0.2"}], ",", 
                 RowBox[{"Scaled", "@", "0.17"}]}], "}"}]}], "}"}]}], ",", 
            RowBox[{"PlotLabel", "\[Rule]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"NPR", "\[Equal]", "1"}], ",", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"Column", "[", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<step 1: calculate the gas molar flow rate, then check \
solution\>\"", ",", 
                    RowBox[{"Spacer", "@", "1"}]}], "}"}], "]"}], ",", "17", 
                 ",", "Black"}], "]"}], ",", "None"}], "]"}]}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"diagram", "=", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Thick", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"DRAW", " ", "OPERATING", " ", "LINE"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NPR", "\[Equal]", "2"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Dashed", ",", "colOP", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{"op1", ",", "op2"}], "}"}], "]"}]}], "}"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"pt1", "[", 
                  RowBox[{"#", ",", "colOP"}], "]"}], "&"}], "/@", 
                RowBox[{"{", 
                 RowBox[{"op1", ",", "op2"}], "}"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"solution", "\[Equal]", "False"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}]}], "]"}], ",", 
                    "\"\< ppm\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}]}], "]"}], ",", 
                    "\"\< ppm\>\""}], "}"}]}]}], "\[IndentingNewLine]", "}"}],
                     ",", 
                    RowBox[{"Alignment", "\[Rule]", "\"\<=\>\""}]}], "]"}], 
                    ",", "17", ",", "colOP", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    "#1", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#2", "*", "0.75"}], ",", "1.5"}], "}"}]}], "]"}],
                    "&"}], "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"op1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"op2", ",", "1"}], "}"}]}], "}"}]}]}], "]"}], ",",
                "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{"{", 
                  RowBox[{"colOP", ",", 
                   RowBox[{"Line", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"yop", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"xp2", ",", "xp3", ",", "0.001"}], "]"}]}], 
                    "]"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}],
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NPR", ">", "2"}], ",", 
             RowBox[{"{", 
              RowBox[{"colOP", ",", 
               RowBox[{"Line", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"#", ",", 
                    RowBox[{"yop", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
                 RowBox[{"Range", "[", 
                  RowBox[{"xp2", ",", "xp3", ",", "0.001"}], "]"}]}], "]"}]}],
               "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"DRAW", " ", "EQUILIBRIUM", " ", "LINE"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NPR", "\[Equal]", "3"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Dashed", ",", "colEQ", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{"eq1", ",", "eq2"}], "}"}], "]"}]}], "}"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"pt1", "[", 
                  RowBox[{"#", ",", "colEQ"}], "]"}], "&"}], "/@", 
                RowBox[{"{", 
                 RowBox[{"eq1", ",", "eq2"}], "}"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"solution", "\[Equal]", "False"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}]}], "]"}], ",", 
                    "\"\< ppm\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}]}], "]"}], ",", 
                    "\"\< ppm\>\""}], "}"}]}]}], "\[IndentingNewLine]", "}"}],
                     ",", 
                    RowBox[{"Alignment", "\[Rule]", "\"\<=\>\""}]}], "]"}], 
                    ",", "17", ",", "colEQ", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    "#1", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#2", "*", "0.75"}], ",", "1.5"}], "}"}]}], "]"}],
                    "&"}], "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"eq1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"eq2", ",", "1"}], "}"}]}], "}"}]}]}], "]"}], ",",
                "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{"{", 
                  RowBox[{"colEQ", ",", 
                   RowBox[{"Line", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"yeq", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", "xp4", ",", "0.001"}], "]"}]}], "]"}]}],
                   "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NPR", ">", "3"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"colEQ", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"yeq", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{"0", ",", "xp4", ",", "0.001"}], "]"}]}], "]"}]}],
                 "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"pt2", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x0", ",", "y1"}], "}"}], ",", "colL"}], "]"}], ",", 
               RowBox[{"pt2", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"xN", ",", "yn1"}], "}"}], ",", "colL"}], "]"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"Text", "[", 
                RowBox[{"x0y1", ",", 
                 RowBox[{"{", 
                  RowBox[{"x0", ",", "y1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "0.7"}], ",", "1.5"}], "}"}]}], "]"}], ",", 
               RowBox[{"Text", "[", 
                RowBox[{"xNyn1", ",", 
                 RowBox[{"{", 
                  RowBox[{"xN", ",", "yn1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1.5"}], ",", "0"}], "}"}]}], "]"}]}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"colV", ",", "Dashed", ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "y1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x0", ",", "y1"}], "}"}]}], "}"}], "]"}], ",", 
                  RowBox[{"Text", "[", 
                   RowBox[{"texty1", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.2", "*", "x0"}], ",", "y1"}], "}"}]}], "]"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "yn1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xN", ",", "yn1"}], "}"}]}], "}"}], "]"}], ",", 
                  RowBox[{"pt2", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "yn1"}], "}"}], ",", "colV"}], "]"}], 
                  ",", 
                  RowBox[{"Text", "[", 
                   RowBox[{"textyN1", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "yn1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1.2", ",", "0"}], "}"}]}], "]"}]}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"colL", ",", "Dashed", ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x0", ",", "y1"}], "}"}]}], "}"}], "]"}], ",", 
                  RowBox[{"Text", "[", 
                   RowBox[{"textx0", ",", 
                    RowBox[{"{", 
                    RowBox[{"x0", ",", 
                    RowBox[{"0.2", "*", "y1"}]}], "}"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"xN", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xN", ",", 
                    RowBox[{"yeq", "[", "xN", "]"}]}], "}"}]}], "}"}], "]"}], 
                  ",", 
                  RowBox[{"pt2", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"xN", ",", "0"}], "}"}], ",", "colL"}], "]"}], 
                  ",", 
                  RowBox[{"Text", "[", 
                   RowBox[{"textxN", ",", 
                    RowBox[{"{", 
                    RowBox[{"xN", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.7"}], ",", 
                    RowBox[{"-", "0.8"}]}], "}"}]}], "]"}]}], "}"}]}], "*)"}],
               "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"DRAW", " ", "FIRST", " ", "STAGE"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NPR", "\[Equal]", "4"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Dashed", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xop", "[", "stage1", "]"}], ",", 
                    RowBox[{"stage1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xeq", "[", "stage1", "]"}], ",", 
                    RowBox[{"stage1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], "]"}]}],
                 "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"pt1", "[", 
                RowBox[{"stage1", ",", "Black"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "0", "]"}], ",", 
                    RowBox[{"Y", "[", "0", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "1", "]"}], ",", 
                    RowBox[{"Y", "[", "0", "]"}]}], "}"}]}], "}"}], "]"}]}], 
                "]"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NPR", ">", "4"}], ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"X", "[", "0", "]"}], ",", 
                  RowBox[{"Y", "[", "0", "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"X", "[", "1", "]"}], ",", 
                  RowBox[{"Y", "[", "0", "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"X", "[", "1", "]"}], ",", 
                  RowBox[{"Y", "[", "1", "]"}]}], "}"}]}], "}"}], "]"}]}], 
            "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"DRAW", " ", "SECOND", " ", "STAGE"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NPR", "\[Equal]", "5"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Dashed", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xop", "[", "stage2", "]"}], ",", 
                    RowBox[{"stage2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xeq", "[", "stage2", "]"}], ",", 
                    RowBox[{"stage2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], "]"}]}],
                 "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"pt1", "[", 
                RowBox[{"stage2", ",", "Black"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "1", "]"}], ",", 
                    RowBox[{"Y", "[", "1", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "2", "]"}], ",", 
                    RowBox[{"Y", "[", "1", "]"}]}], "}"}]}], "}"}], "]"}]}], 
                "]"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NPR", ">", "5"}], ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"X", "[", "1", "]"}], ",", 
                  RowBox[{"Y", "[", "1", "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"X", "[", "2", "]"}], ",", 
                  RowBox[{"Y", "[", "1", "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"X", "[", "2", "]"}], ",", 
                  RowBox[{"Y", "[", "2", "]"}]}], "}"}]}], "}"}], "]"}]}], 
            "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"DRAW", " ", "LAST", " ", "STAGE"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NPR", "\[Equal]", "6"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"n", "\[Equal]", "4"}], ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "2", "]"}], ",", 
                    RowBox[{"Y", "[", "2", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "3", "]"}], ",", 
                    RowBox[{"Y", "[", "2", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "3", "]"}], ",", 
                    RowBox[{"Y", "[", "3", "]"}]}], "}"}]}], "}"}], "]"}]}], 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"n", "\[Equal]", "5"}], ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "2", "]"}], ",", 
                    RowBox[{"Y", "[", "2", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "3", "]"}], ",", 
                    RowBox[{"Y", "[", "2", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "3", "]"}], ",", 
                    RowBox[{"Y", "[", "3", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "4", "]"}], ",", 
                    RowBox[{"Y", "[", "3", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "4", "]"}], ",", 
                    RowBox[{"Y", "[", "4", "]"}]}], "}"}]}], "}"}], "]"}]}], 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"n", "\[Equal]", "6"}], ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "2", "]"}], ",", 
                    RowBox[{"Y", "[", "2", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "3", "]"}], ",", 
                    RowBox[{"Y", "[", "2", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "3", "]"}], ",", 
                    RowBox[{"Y", "[", "3", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "4", "]"}], ",", 
                    RowBox[{"Y", "[", "3", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "4", "]"}], ",", 
                    RowBox[{"Y", "[", "4", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "5", "]"}], ",", 
                    RowBox[{"Y", "[", "4", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "5", "]"}], ",", 
                    RowBox[{"Y", "[", "5", "]"}]}], "}"}]}], "}"}], "]"}]}], 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"Dashed", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xop", "[", "stagen", "]"}], ",", 
                    RowBox[{"stagen", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xeq", "[", "stagen", "]"}], ",", 
                    RowBox[{"stagen", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], "]"}]}],
                 "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"pt1", "[", 
                RowBox[{"stagen", ",", "Black"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"n", "-", "1"}], "]"}], ",", 
                    RowBox[{"Y", "[", 
                    RowBox[{"n", "-", "1"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "n", "]"}], ",", 
                    RowBox[{"Y", "[", 
                    RowBox[{"n", "-", "1"}], "]"}]}], "}"}]}], "}"}], "]"}]}],
                 "]"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NPR", ">", "6"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"#", "-", "1"}], "]"}], ",", 
                    RowBox[{"Y", "[", 
                    RowBox[{"#", "-", "1"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "#", "]"}], ",", 
                    RowBox[{"Y", "[", 
                    RowBox[{"#", "-", "1"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "#", "]"}], ",", 
                    RowBox[{"Y", "[", "#", "]"}]}], "}"}]}], "}"}], "]"}], 
                 "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"n", "-", "1"}], "]"}]}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"n", "-", "1"}], "]"}], ",", 
                    RowBox[{"Y", "[", 
                    RowBox[{"n", "-", "1"}], "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"X", "[", "n", "]"}], ",", 
                    RowBox[{"Y", "[", 
                    RowBox[{"n", "-", "1"}], "]"}]}], "}"}]}], "}"}], "]"}]}],
               "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", "SOLUTION", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"NPR", "\[Equal]", "7"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"#", "+", "1"}], ",", "17", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "#", "]"}], ",", 
                    RowBox[{"Y", "[", "#", "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.5"}], ",", "1"}], "}"}]}], "]"}], "&"}], "/@", 
                RowBox[{"Range", "@", "n"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"1", ",", "17", ",", 
                   RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x0", ",", "y1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1.5"}], ",", "1"}], "}"}]}], "]"}]}], 
              "\[IndentingNewLine]", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "xp1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"1.1", "*", "y1"}]}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotRangeClipping", "\[Rule]", "False"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{"\"\<solute/(solute-free liquid) \>\"", ",", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", " ", 
               "\"\< (ppm)\>\""}], "}"}]}], ",", 
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{"\"\<solute/(solute-free vapor) \>\"", ",", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
               "\"\< (ppm)\>\""}], "}"}]}]}], "}"}]}], ",", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"17", ",", "Black"}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{"graphic", ",", "350", ",", "600"}], "]"}], ",", "400"}],
            "}"}]}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
         RowBox[{"GridLines", "\[Rule]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"NPR", "\[Equal]", "7"}], ",", "None", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{"0", ",", "xp1", ",", "0.02"}], "]"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{"0", ",", 
                RowBox[{"1.1", "*", "y1"}], ",", "2"}], "]"}]}], "}"}]}], 
           "]"}]}], ",", 
         RowBox[{"GridLinesStyle", "\[Rule]", 
          RowBox[{"GrayLevel", "@", "0.8"}]}], ",", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"55", ",", "10"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"50", ",", 
              RowBox[{"If", "[", 
               RowBox[{"graphic", ",", "5", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"3", "\[LessEqual]", "NPR", "\[LessEqual]", "6"}],
                     ")"}], "\[And]", 
                   RowBox[{"hint", "\[Equal]", "False"}]}], ",", "5", ",", 
                  "27"}], "]"}]}], "]"}]}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"If", "[", 
           RowBox[{"graphic", ",", "None", ",", 
            RowBox[{"Style", "[", 
             RowBox[{"plotlabel", ",", "17"}], "]"}]}], "]"}]}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NPR", "\[Equal]", "1"}], ",", "column", ",", 
        RowBox[{"If", "[", 
         RowBox[{"graphic", ",", 
          RowBox[{"Grid", "@", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"diagram", ",", "column"}], "}"}], "}"}]}], ",", 
          "diagram"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Grid", "@", 
    RowBox[{"{", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{"\"\< new problem \>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"reset", "<", "1000"}], ",", 
             RowBox[{"reset", "=", 
              RowBox[{"reset", "+", "1"}]}], ",", 
             RowBox[{"reset", "=", 
              RowBox[{"reset", "-", "1"}]}]}], "]"}], ",", 
           RowBox[{"NPR", "=", "1"}], ",", 
           RowBox[{"solution", "=", "False"}], ",", 
           RowBox[{"hint", "=", "False"}], ",", 
           RowBox[{"graphic", "=", "False"}]}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"reset", ",", "1"}], "}"}], ",", "1", ",", "1000", ",", 
          "1", ",", "None"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Dynamic", "@", 
        RowBox[{"Switch", "[", 
         RowBox[{
         "NPR", ",", "1", ",", "\"\<(1) gas flow rate\>\"", ",", "2", ",", 
          "\"\<(2) draw operating line\>\"", ",", "3", ",", 
          "\"\<(3) draw equilibrium line\>\"", ",", "4", ",", 
          "\"\<(4) draw stage 1\>\"", ",", "5", ",", 
          "\"\<(5) draw stage 2\>\"", ",", "6", ",", 
          "\"\<(6) draw last stage\>\"", ",", "7", ",", 
          "\"\<(7) solution\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"PaneSelector", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"##", "&"}], "@@", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "5", ",", 
               "6"}], "}"}], "\[Rule]", 
             RowBox[{"Button", "[", 
              RowBox[{"\"\< next \>\"", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"1", "\[LessEqual]", "NPR", "<", "7"}], ",", 
                   RowBox[{"NPR", "=", 
                    RowBox[{"NPR", "+", "1"}]}], ",", 
                   RowBox[{"NPR", "=", "7"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"solution", "=", "False"}], ";", 
                  RowBox[{"hint", "=", "False"}], ";"}]}], "}"}]}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"Dynamic", "@", "NPR"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"NPR", ",", "1", ",", "\"\<\>\""}], "}"}], ",", 
          RowBox[{"Range", "@", "7"}], ",", "None"}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PaneSelector", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"##", "&"}], "@@", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}],
               "}"}], "\[Rule]", 
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"solution", ",", "False", ",", "\"\<solution\>\""}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}], ",", 
                RowBox[{"Enabled", "\[Rule]", 
                 RowBox[{"If", "[", 
                  RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}], 
               "}"}], "]"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"Dynamic", "@", "NPR"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PaneSelector", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"##", "&"}], "@@", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}],
               "}"}], "\[Rule]", 
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"hint", ",", "False", ",", "\"\<hint\>\""}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"Dynamic", "@", "NPR"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PaneSelector", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"##", "&"}], "@@", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", "3", ",", "4"}], "}"}], "\[Rule]", 
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"graphic", ",", "False", ",", "\"\<column\>\""}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"Dynamic", "@", "NPR"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PaneSelector", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"2", "\[Rule]", 
            RowBox[{"Row", "@", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Control", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"op1", ",", 
                    RowBox[{"{", 
                    RowBox[{"0.05", ",", "15"}], "}"}]}], "}"}], ",", 
                  "Locator", ",", 
                  RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
                  RowBox[{"Enabled", "\[Rule]", 
                   RowBox[{"If", "[", 
                    RowBox[{"solution", ",", "False", ",", "True"}], 
                    "]"}]}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Control", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"op2", ",", 
                    RowBox[{"{", 
                    RowBox[{"0.35", ",", "15"}], "}"}]}], "}"}], ",", 
                  "Locator", ",", 
                  RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
                  RowBox[{"Enabled", "\[Rule]", 
                   RowBox[{"If", "[", 
                    RowBox[{"solution", ",", "False", ",", "True"}], 
                    "]"}]}]}], "}"}], "]"}]}], "}"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"3", "\[Rule]", 
            RowBox[{"Row", "@", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Control", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"eq1", ",", 
                    RowBox[{"{", 
                    RowBox[{"0.05", ",", "15"}], "}"}]}], "}"}], ",", 
                  "Locator", ",", 
                  RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
                  RowBox[{"Enabled", "\[Rule]", 
                   RowBox[{"If", "[", 
                    RowBox[{"solution", ",", "False", ",", "True"}], 
                    "]"}]}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Control", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"eq2", ",", 
                    RowBox[{"{", 
                    RowBox[{"0.35", ",", "15"}], "}"}]}], "}"}], ",", 
                  "Locator", ",", 
                  RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
                  RowBox[{"Enabled", "\[Rule]", 
                   RowBox[{"If", "[", 
                    RowBox[{"solution", ",", "False", ",", "True"}], 
                    "]"}]}]}], "}"}], "]"}]}], "}"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"4", "\[Rule]", 
            RowBox[{"Control", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"stage1", ",", 
                 RowBox[{"{", 
                  RowBox[{"0.2", ",", "13"}], "}"}]}], "}"}], ",", "Locator", 
               ",", 
               RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
               RowBox[{"Enabled", "\[Rule]", 
                RowBox[{"If", "[", 
                 RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}], 
              "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"5", "\[Rule]", 
            RowBox[{"Control", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"stage2", ",", 
                 RowBox[{"{", 
                  RowBox[{"0.15", ",", "8"}], "}"}]}], "}"}], ",", "Locator", 
               ",", 
               RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
               RowBox[{"Enabled", "\[Rule]", 
                RowBox[{"If", "[", 
                 RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}], 
              "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"6", "\[Rule]", 
            RowBox[{"Control", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"stagen", ",", 
                 RowBox[{"{", 
                  RowBox[{"0.1", ",", "6"}], "}"}]}], "}"}], ",", "Locator", 
               ",", 
               RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
               RowBox[{"Enabled", "\[Rule]", 
                RowBox[{"If", "[", 
                 RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}], 
              "}"}], "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"Dynamic", "@", "NPR"}]}], "]"}]}], "\[IndentingNewLine]", 
      "}"}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"PaneSelector", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", "\[Rule]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "gas", ",", "1.2", ",", 
            "\"\<select the correct gas flow rate (Mmol/h)\>\""}], "}"}], ",",
           "1", ",", "1.5", ",", "0.1", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
        "]"}]}], "}"}], ",", 
     RowBox[{"Dynamic", "@", "NPR"}]}], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{",", "\[IndentingNewLine]", 
    RowBox[{"SaveDefinitions", "\[Rule]", "True"}]}], "*)"}], "]"}]], "Input",
 CellChangeTimes->{{3.7262403098825235`*^9, 3.7262404488291254`*^9}, {
   3.72624158150731*^9, 3.726241656479386*^9}, {3.7262418634282675`*^9, 
   3.726241911546341*^9}, {3.7262421485725517`*^9, 3.7262422700469584`*^9}, {
   3.7262423158327904`*^9, 3.726242333675172*^9}, {3.726242372161869*^9, 
   3.7262424083320475`*^9}, {3.726242510083169*^9, 3.726242541207024*^9}, {
   3.7262425836229305`*^9, 3.7262425969968023`*^9}, {3.726242637332803*^9, 
   3.7262427854278526`*^9}, {3.72624282158243*^9, 3.7262429180919075`*^9}, {
   3.7262429484855595`*^9, 3.7262430307442784`*^9}, {3.7262430757020054`*^9, 
   3.726243178988809*^9}, {3.7262432191267147`*^9, 3.726243459578224*^9}, {
   3.7262438739838653`*^9, 3.7262438750877676`*^9}, {3.7262439056038213`*^9, 
   3.726243947892542*^9}, {3.7262439938245697`*^9, 3.7262442848967457`*^9}, {
   3.7262443230498724`*^9, 3.7262445574949584`*^9}, {3.7262446330282383`*^9, 
   3.7262449815091844`*^9}, {3.726245061645097*^9, 3.7262452920906997`*^9}, {
   3.726245328653104*^9, 3.726245329807506*^9}, {3.726245400640873*^9, 
   3.726245734179834*^9}, {3.726245794285951*^9, 3.7262458064886084`*^9}, {
   3.7262458504182386`*^9, 3.7262462447054996`*^9}, {3.7262462798076873`*^9, 
   3.726246308638379*^9}, {3.726325529797636*^9, 3.7263255415688934`*^9}, {
   3.726325613303097*^9, 3.7263256608541803`*^9}, {3.726325698978191*^9, 
   3.7263257011980114`*^9}, {3.726325761448357*^9, 3.7263258019477787`*^9}, {
   3.726325837761179*^9, 3.7263260056967435`*^9}, {3.7263260949161215`*^9, 
   3.7263266950983543`*^9}, {3.7263268729378366`*^9, 
   3.7263268747378407`*^9}, {3.7264125899225407`*^9, 3.726412600151126*^9}, {
   3.726412915667172*^9, 3.7264130390732307`*^9}, 3.727016967609393*^9, {
   3.727017000840294*^9, 3.7270171722941008`*^9}, {3.7270172290273457`*^9, 
   3.727017234451656*^9}, {3.7276221137436767`*^9, 3.7276221186199555`*^9}, {
   3.7276221583512278`*^9, 3.7276221598823156`*^9}, {3.7277090292436695`*^9, 
   3.7277090319268227`*^9}, {3.7277992660122385`*^9, 3.727799378065648*^9}, {
   3.72779955502477*^9, 3.7277995751359196`*^9}, {3.727799640229643*^9, 
   3.7277996840941515`*^9}, {3.7277997290247216`*^9, 3.72779973896129*^9}, {
   3.7277997817347364`*^9, 3.727799803458979*^9}, {3.728054163598271*^9, 
   3.728054365188801*^9}, {3.728054525865991*^9, 3.728054542749957*^9}, {
   3.728057658925192*^9, 3.7280576852156954`*^9}, {3.7296090389891195`*^9, 
   3.7296090670907264`*^9}},ExpressionUUID->"e8e7b2b3-23ee-4723-a223-\
d26ad60d3a89"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`eq1$$ = {0.05, 15}, $CellContext`eq2$$ = {
    0.35, 15}, $CellContext`gas$$ = 1.2, $CellContext`graphic$$ = 
    False, $CellContext`hint$$ = False, $CellContext`NPR$$ = 
    1, $CellContext`op1$$ = {0.05, 15}, $CellContext`op2$$ = {
    0.35, 15}, $CellContext`reset$$ = 5, $CellContext`solution$$ = 
    False, $CellContext`stage1$$ = {0.2, 13}, $CellContext`stage2$$ = {
    0.15, 8}, $CellContext`stagen$$ = {0.1, 6}, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`reset$$], 1}, 1, 1000, 1}, {{
       Hold[$CellContext`NPR$$], 1, ""}, {1, 2, 3, 4, 5, 6, 7}}, {{
       Hold[$CellContext`solution$$], False, "solution"}, {True, False}}, {{
       Hold[$CellContext`hint$$], False, "hint"}, {True, False}}, {{
       Hold[$CellContext`graphic$$], False, "column"}, {True, False}}, {{
       Hold[$CellContext`op1$$], {0.05, 15}}, Automatic}, {{
       Hold[$CellContext`op2$$], {0.35, 15}}, Automatic}, {{
       Hold[$CellContext`eq1$$], {0.05, 15}}, Automatic}, {{
       Hold[$CellContext`eq2$$], {0.35, 15}}, Automatic}, {{
       Hold[$CellContext`stage1$$], {0.2, 13}}, Automatic}, {{
       Hold[$CellContext`stage2$$], {0.15, 8}}, Automatic}, {{
       Hold[$CellContext`stagen$$], {0.1, 6}}, Automatic}, {
      Hold[
       Grid[{{
          Button[" new problem ", {
            
            If[$CellContext`reset$$ < 
             1000, $CellContext`reset$$ = $CellContext`reset$$ + 
              1, $CellContext`reset$$ = $CellContext`reset$$ - 
              1], $CellContext`NPR$$ = 1, $CellContext`solution$$ = 
            False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
            False}], 
          Manipulate`Place[1], 
          Dynamic[
           
           Switch[$CellContext`NPR$$, 1, "(1) gas flow rate", 2, 
            "(2) draw operating line", 3, "(3) draw equilibrium line", 4, 
            "(4) draw stage 1", 5, "(5) draw stage 2", 6, 
            "(6) draw last stage", 7, "(7) solution"]], 
          PaneSelector[{1 -> Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False; $CellContext`hint$$ = False; Null}], 2 -> 
            Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False; $CellContext`hint$$ = False; Null}], 3 -> 
            Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False; $CellContext`hint$$ = False; Null}], 4 -> 
            Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False; $CellContext`hint$$ = False; Null}], 5 -> 
            Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False; $CellContext`hint$$ = False; Null}], 5 -> 
            Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False; $CellContext`hint$$ = False; Null}], 6 -> 
            Button[" next ", {
               If[
                Inequality[
                1, LessEqual, $CellContext`NPR$$, Less, 
                 7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                 1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                False; $CellContext`hint$$ = False; Null}]}, 
           Dynamic[$CellContext`NPR$$]], 
          Manipulate`Place[2], 
          
          PaneSelector[{
           1 -> Manipulate`Place[3], 2 -> Manipulate`Place[3], 3 -> 
            Manipulate`Place[3], 4 -> Manipulate`Place[3], 5 -> 
            Manipulate`Place[3], 6 -> Manipulate`Place[3]}, 
           Dynamic[$CellContext`NPR$$]], 
          
          PaneSelector[{
           1 -> Manipulate`Place[4], 2 -> Manipulate`Place[4], 3 -> 
            Manipulate`Place[4], 4 -> Manipulate`Place[4], 5 -> 
            Manipulate`Place[4], 6 -> Manipulate`Place[4]}, 
           Dynamic[$CellContext`NPR$$]], 
          
          PaneSelector[{
           2 -> Manipulate`Place[5], 3 -> Manipulate`Place[5], 4 -> 
            Manipulate`Place[5]}, 
           Dynamic[$CellContext`NPR$$]], 
          PaneSelector[{2 -> Row[{
               Manipulate`Place[6], 
               Manipulate`Place[7]}], 3 -> Row[{
               Manipulate`Place[8], 
               Manipulate`Place[9]}], 4 -> Manipulate`Place[10], 5 -> 
            Manipulate`Place[11], 6 -> Manipulate`Place[12]}, 
           Dynamic[$CellContext`NPR$$]]}}]], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`gas$$], 1.2, 
       "select the correct gas flow rate (Mmol/h)"}, 1, 1.5, 0.1}, {
      Hold[
       PaneSelector[{1 -> Manipulate`Place[13]}, 
        Dynamic[$CellContext`NPR$$]]], Manipulate`Dump`ThisIsNotAControl}}, 
    Typeset`size$$ = {600., {192., 198.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`reset$25954$$ = 0, $CellContext`NPR$25955$$ = 
    0, $CellContext`solution$25956$$ = False, $CellContext`hint$25957$$ = 
    False, $CellContext`graphic$25958$$ = False, $CellContext`gas$25959$$ = 
    0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`eq1$$ = {0.05, 15}, $CellContext`eq2$$ = {
         0.35, 15}, $CellContext`gas$$ = 1.2, $CellContext`graphic$$ = 
        False, $CellContext`hint$$ = False, $CellContext`NPR$$ = 
        1, $CellContext`op1$$ = {0.05, 15}, $CellContext`op2$$ = {
         0.35, 15}, $CellContext`reset$$ = 1, $CellContext`solution$$ = 
        False, $CellContext`stage1$$ = {0.2, 13}, $CellContext`stage2$$ = {
         0.15, 8}, $CellContext`stagen$$ = {0.1, 6}}, "ControllerVariables" :> {
        Hold[$CellContext`reset$$, $CellContext`reset$25954$$, 0], 
        Hold[$CellContext`NPR$$, $CellContext`NPR$25955$$, 0], 
        Hold[$CellContext`solution$$, $CellContext`solution$25956$$, False], 
        Hold[$CellContext`hint$$, $CellContext`hint$25957$$, False], 
        Hold[$CellContext`graphic$$, $CellContext`graphic$25958$$, False], 
        Hold[$CellContext`gas$$, $CellContext`gas$25959$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`P$, $CellContext`T$, $CellContext`L$, \
$CellContext`V$, $CellContext`Ea$, $CellContext`R$, $CellContext`T0$, \
$CellContext`H0$, $CellContext`H$, $CellContext`x0$, $CellContext`xN$, \
$CellContext`xp1$, $CellContext`yn1$, $CellContext`y1$, $CellContext`yeq$, \
$CellContext`yop$, $CellContext`xp2$, $CellContext`xp3$, $CellContext`xp4$, \
$CellContext`X$, $CellContext`Y$, $CellContext`ntest$, $CellContext`n$, \
$CellContext`xop$, $CellContext`xeq$, $CellContext`opt$, $CellContext`pt1$, \
$CellContext`pt2$, $CellContext`pt3$, $CellContext`plotlabel$, \
$CellContext`column$, $CellContext`diagram$}, 
        SeedRandom[$CellContext`reset$$]; $CellContext`P$ = 
         RandomReal[{2.1, 2.4}]; $CellContext`T$ = 
         RandomInteger[{10, 16}]; $CellContext`L$ = 
         RandomInteger[{80, 100}]; $CellContext`Ea$ = 5000; $CellContext`R$ = 
         8.314; $CellContext`T0$ = 298; $CellContext`H0$ = 
         211.19; $CellContext`H$ = $CellContext`H0$ 
          Exp[(-($CellContext`Ea$/$CellContext`R$)) (
             1/($CellContext`T$ + 273) - 
             1/$CellContext`T0$)]; $CellContext`V$ = 1; $CellContext`x0$ = 
         0.35; $CellContext`xN$ = 0.1; $CellContext`xp1$ = 
         0.385; $CellContext`yn1$ = 
         1; $CellContext`y1$ = $CellContext`yn1$ - \
($CellContext`L$/$CellContext`V$) ($CellContext`xN$ - $CellContext`x0$); \
$CellContext`yeq$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := ($CellContext`H$/$CellContext`P$) $CellContext`x$; \
$CellContext`yop$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := ($CellContext`L$/$CellContext`V$) ($CellContext`x$ - \
$CellContext`x0$) + $CellContext`y1$; $CellContext`xp2$ = 
         ReplaceAll[$CellContext`x, 
           Part[
            Solve[$CellContext`yop$[$CellContext`x] == 0, $CellContext`x], 
            1]]; $CellContext`xp3$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yop$[$CellContext`x] == 
             1.1 $CellContext`y1$, $CellContext`x], 1]]; $CellContext`xp4$ = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yeq$[$CellContext`x] == 
             1.1 $CellContext`y1$, $CellContext`x], 1]]; $CellContext`X$[
          0] = $CellContext`x0$; $CellContext`Y$[
          0] = $CellContext`yop$[$CellContext`x0$]; 
        Do[{$CellContext`X$[$CellContext`i] = ReplaceAll[$CellContext`x, 
             Part[
              
              Solve[$CellContext`yeq$[$CellContext`x] == \
$CellContext`Y$[$CellContext`i - 1], $CellContext`x, Reals], 
              1]], $CellContext`Y$[$CellContext`i] = $CellContext`yop$[
             $CellContext`X$[$CellContext`i]]}, {$CellContext`i, 1, 
           10}]; $CellContext`ntest$ = 1 + DeleteCases[
            Map[If[$CellContext`X$[#] < $CellContext`xN$, 0, #]& , 
             Range[10]], 0]; $CellContext`n$ = 
         If[Length[$CellContext`ntest$] == 0, 0, 
           Part[$CellContext`ntest$, -1]]; $CellContext`xop$[
           Pattern[$CellContext`stage$, 
            Blank[]]] := ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yop$[$CellContext`x] == 
             Part[$CellContext`stage$, 2], $CellContext`x], 
            1]]; $CellContext`xeq$[
           Pattern[$CellContext`stage$, 
            Blank[]]] := ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yeq$[$CellContext`x] == 
             Part[$CellContext`stage$, 2], $CellContext`x], 
            1]]; $CellContext`opt$ = Sequence[
           Thickness[
            If[
             And[$CellContext`graphic$$, $CellContext`NPR$$ < 4], 0.011, 
             0.008]], Dotted]; $CellContext`pt1$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`col$, 
            Blank[]]] := {$CellContext`col$, 
           PointSize[
            If[
             And[$CellContext`graphic$$, $CellContext`NPR$$ < 4], 0.04, 
             0.025]], 
           Point[$CellContext`pt$], White, 
           PointSize[
            If[
             And[$CellContext`graphic$$, $CellContext`NPR$$ < 4], 0.025, 
             0.015]], 
           Point[$CellContext`pt$]}; $CellContext`pt2$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`col$, 
            Blank[]]] := {$CellContext`col$, 
           PointSize[
            If[$CellContext`graphic$$, 0.035, 0.02]], 
           Point[$CellContext`pt$]}; $CellContext`pt3$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`col$, 
            Blank[]]] := {$CellContext`col$, 
           PointSize[
            If[$CellContext`graphic$$, 0.035, 0.02]], 
           Point[$CellContext`pt$], White, 
           PointSize[
            If[$CellContext`graphic$$, 0.02, 0.01]], 
           Point[$CellContext`pt$]}; $CellContext`plotlabel$ = 
         Switch[$CellContext`NPR$$, 1, 
           If[$CellContext`hint$$, "hint: use mass balance on solute", 
            "step 1: calculate the gas flow rate, then check solution"], 2, 
           
           If[$CellContext`hint$$, "hint: use mass balance from step 1", 
            "step 2: click and drag the points to create the operating line, \
then check solution"], 3, 
           If[$CellContext`hint$$, "hint: use Henry's law", 
            
            Column[{"step 3: click and drag points to create the equilibrium \
line, then check solution", 
              Row[{
                Style["P", Italic], " = ", 
                NumberForm[$CellContext`P$, {3, 1}], " atm and ", 
                Style["H", Italic], " = ", 
                NumberForm[$CellContext`H$, {4, 1}], 
                " atm/mole fraction"}]}]], 4, 
           
           If[$CellContext`hint$$, 
            "hint: start counting stages from the top of the column", 
            
            Column[{"step 4: drag the black point to move the dashed line to \
draw the first stage,", "then check solution"}]], 5, 
           
           If[$CellContext`hint$$, 
            "hint: start drawing the second stage where the forst stage left \
off", 
            
            Column[{"step 5: drag the black point to move the dashed line to \
draw the second", "stage, then check solution"}]], 6, 
           If[$CellContext`hint$$, 
            Row[{"hint: draw the last stage until ", 
              Style[
               Subscript["x", "N"], Italic], " is reached or surpassed"}], 
            
            Column[{"step 6: draw the black point to move the dashed line to \
draw the last stage,", "then check solution"}]], 7, 
           Row[{"solved ", 
             Style["x-y", Italic], " diagram"}]]; $CellContext`column$ = 
         Module[{$CellContext`h$, $CellContext`w$, $CellContext`ry$}, \
$CellContext`h$ = 13; $CellContext`w$ = 12; $CellContext`ry$ = 2; 
           Graphics[{Thick, 
              Map[
              Line[{{#, $CellContext`ry$}, {#, $CellContext`h$ - \
$CellContext`ry$}}]& , {0, $CellContext`w$}], 
              Circle[{$CellContext`w$/2, $CellContext`ry$}, {$CellContext`w$/
                2, $CellContext`ry$}, {Pi, 2 Pi}], 
              
              Circle[{$CellContext`w$/
                2, $CellContext`h$ - $CellContext`ry$}, {$CellContext`w$/
                2, $CellContext`ry$}, {0, Pi}], {
               Arrowheads[0.1], $CellContext`colV, 
               
               Arrow[{{(-$CellContext`w$)/2, (-$CellContext`h$)/4}, {
                 0.25 $CellContext`w$, (-$CellContext`h$)/4}, {
                 0.25 $CellContext`w$, $CellContext`ry$/10}}], 
               
               Arrow[{{
                 0.25 $CellContext`w$, $CellContext`h$ - $CellContext`ry$/
                  10}, {0.25 $CellContext`w$, $CellContext`h$ + \
$CellContext`h$/4}, {(-$CellContext`w$)/
                  2, $CellContext`h$ + $CellContext`h$/
                   4}}], $CellContext`colL, 
               
               Arrow[{{0.75 $CellContext`w$, $CellContext`ry$/10}, {
                 0.75 $CellContext`w$, (-$CellContext`h$)/
                  4}, {$CellContext`w$ + $CellContext`w$/
                   2.3, (-$CellContext`h$)/4}}], 
               
               Arrow[{{$CellContext`w$ + $CellContext`w$/
                   2.3, $CellContext`h$ + $CellContext`h$/4}, {
                 0.75 $CellContext`w$, $CellContext`h$ + $CellContext`h$/4}, {
                 0.75 $CellContext`w$, $CellContext`h$ - $CellContext`ry$/
                  10}}]}, 
              If[4 <= $CellContext`NPR$$ <= 6, 
               Apply[{
                 Line[{{0, #2}, {$CellContext`w$, #2}}], 
                 Text[
                  Style[#, 17], {0.5 $CellContext`w$, #2}, {0, -1}]}& , {{
                  Style["N", Italic], $CellContext`ry$}, {
                  Style["n", Italic], 0.5 $CellContext`h$}, {
                 1, $CellContext`h$ - $CellContext`ry$}}, {1}], 
               Text[
                Style[
                 Column[{
                   Row[{
                    NumberForm[$CellContext`P$, {3, 1}], " atm"}], 
                   Spacer[0], 
                   Row[{
                    NumberForm[$CellContext`T$, {2, 0}], "\[Degree]C"}]}, 
                  Center], 17], {$CellContext`w$/2, $CellContext`h$/2}]], 
              Text[
               Style[
                Column[{
                  If[$CellContext`NPR$$ == 1, "liquid solvent feed"], 
                  Row[{
                    Style["L", Italic], " = ", 
                    NumberForm[$CellContext`L$, {4, 0}], " Mmol/h"}]}, Right],
                 17, $CellContext`colL], {$CellContext`w$, $CellContext`h$ + \
$CellContext`h$/4}, {0.2, -1.2}], 
              Text[
               Style[
                Column[
                 ReplaceAll[{
                   Style[
                    Row[{
                    Style["V", Italic], " = ", 
                    NumberForm[
                    
                    If[$CellContext`NPR$$ == 
                    1, $CellContext`gas$$, $CellContext`V$], {2, 1}], 
                    " Mmol/h"}], 
                    
                    If[$CellContext`NPR$$ == 
                    1, $CellContext`colS, $CellContext`colV]], 
                   If[
                    And[$CellContext`NPR$$ == 1, $CellContext`solution$$], 
                    Row[{"correct ", 
                    Style["V", Italic], " = ", 
                    NumberForm[$CellContext`V$, {2, 1}], " Mmol/h"}]], 
                   If[$CellContext`NPR$$ == 1, "gas feed"]}, Null -> 
                  Nothing]], 17, $CellContext`colV], {
               0, (-$CellContext`h$)/4}, {0, 1.4}], 
              Apply[Text[
                Style[
                 Row[{
                   Subscript[
                    Style["y", Italic], #2], " = ", 
                   NumberForm[#, {4, 1}], " ppm"}], 17, $CellContext`colV, 
                 Background -> White], {
                0, #3}]& , {{$CellContext`y1$, 1, $CellContext`h$ + 
                 2}, {$CellContext`yn1$, $CellContext`n$ + 1, -2}}, {1}], 
              Apply[Text[
                Style[
                 Row[{
                   Subscript[
                    Style["x", Italic], #2], " = ", 
                   NumberForm[#, {2, 2}], " ppm"}], 17, $CellContext`colL, 
                 Background -> 
                 White], {$CellContext`w$, #3}]& , {{$CellContext`x0$, 
                 0, $CellContext`h$ + 2.25}, {
                 NumberForm[$CellContext`xN$, 2], $CellContext`n$, -2}}, {
               1}]}, ImageSize -> {
               If[$CellContext`NPR$$ == 1, 600, 250], 390}, AspectRatio -> 
             If[$CellContext`NPR$$ == 1, 1.25, Full], 
             PlotRange -> {{(-0.5) $CellContext`w$, 1.6 $CellContext`w$}, {
                
                If[$CellContext`NPR$$ == 
                 1, (-0.3) $CellContext`h$, (-$CellContext`h$)/
                 5], $CellContext`h$ + $CellContext`h$/7}}, 
             PlotRangePadding -> {None, {
                Scaled[0.2], 
                Scaled[0.17]}}, PlotLabel -> If[$CellContext`NPR$$ == 1, 
               Style[
                
                Column[{
                 "step 1: calculate the gas molar flow rate, then check \
solution", 
                  Spacer[1]}], 17, Black], None]]]; $CellContext`diagram$ = 
         Graphics[{Thick, 
            If[$CellContext`NPR$$ == 2, {{Dashed, $CellContext`colOP, 
               Line[{$CellContext`op1$$, $CellContext`op2$$}]}, 
              
              Map[$CellContext`pt1$[#, $CellContext`colOP]& , \
{$CellContext`op1$$, $CellContext`op2$$}], 
              If[$CellContext`solution$$ == False, 
               Apply[Text[
                 Style[
                  Column[{
                    Row[{
                    Style["x", Italic], " = ", 
                    NumberForm[
                    Part[#, 1], {2, 2}], " ppm"}], 
                    Row[{
                    Style["y", Italic], " = ", 
                    NumberForm[
                    Part[#, 2], {3, 1}], " ppm"}]}, Alignment -> "="], 
                  17, $CellContext`colOP, Background -> White], #, {#2 0.75, 
                  1.5}]& , {{$CellContext`op1$$, -1}, {$CellContext`op2$$, 
                  1}}, {1}]], 
              If[$CellContext`solution$$, {$CellContext`colOP, 
                Line[
                 Map[{#, 
                   $CellContext`yop$[#]}& , 
                  Range[$CellContext`xp2$, $CellContext`xp3$, 0.001]]]}]}], 
            If[$CellContext`NPR$$ > 2, {$CellContext`colOP, 
              Line[
               Map[{#, 
                 $CellContext`yop$[#]}& , 
                Range[$CellContext`xp2$, $CellContext`xp3$, 0.001]]]}], 
            If[$CellContext`NPR$$ == 3, {{Dashed, $CellContext`colEQ, 
               Line[{$CellContext`eq1$$, $CellContext`eq2$$}]}, 
              
              Map[$CellContext`pt1$[#, $CellContext`colEQ]& , \
{$CellContext`eq1$$, $CellContext`eq2$$}], 
              If[$CellContext`solution$$ == False, 
               Apply[Text[
                 Style[
                  Column[{
                    Row[{
                    Style["x", Italic], " = ", 
                    NumberForm[
                    Part[#, 1], {2, 2}], " ppm"}], 
                    Row[{
                    Style["y", Italic], " = ", 
                    NumberForm[
                    Part[#, 2], {3, 1}], " ppm"}]}, Alignment -> "="], 
                  17, $CellContext`colEQ, Background -> White], #, {#2 0.75, 
                  1.5}]& , {{$CellContext`eq1$$, -1}, {$CellContext`eq2$$, 
                  1}}, {1}]], 
              If[$CellContext`solution$$, {$CellContext`colEQ, 
                Line[
                 Map[{#, 
                   $CellContext`yeq$[#]}& , 
                  Range[0, $CellContext`xp4$, 0.001]]]}]}], 
            If[$CellContext`NPR$$ > 3, {{$CellContext`colEQ, 
               Line[
                Map[{#, 
                  $CellContext`yeq$[#]}& , 
                 Range[0, $CellContext`xp4$, 0.001]]]}, 
              $CellContext`pt2$[{$CellContext`x0$, $CellContext`y1$}, \
$CellContext`colL], 
              $CellContext`pt2$[{$CellContext`xN$, $CellContext`yn1$}, \
$CellContext`colL], 
              
              Text[$CellContext`x0y1, {$CellContext`x0$, $CellContext`y1$}, \
{-0.7, 1.5}], 
              
              Text[$CellContext`xNyn1, {$CellContext`xN$, $CellContext`yn1$}, \
{-1.5, 0}]}], 
            If[$CellContext`NPR$$ == 4, {{Dashed, 
               Line[{{
                  $CellContext`xop$[$CellContext`stage1$$], 
                  Part[$CellContext`stage1$$, 2]}, {
                  $CellContext`xeq$[$CellContext`stage1$$], 
                  Part[$CellContext`stage1$$, 2]}}]}, 
              $CellContext`pt1$[$CellContext`stage1$$, Black], 
              If[$CellContext`solution$$, 
               Line[{{
                  $CellContext`X$[0], 
                  $CellContext`Y$[0]}, {
                  $CellContext`X$[1], 
                  $CellContext`Y$[0]}}]]}], 
            If[$CellContext`NPR$$ > 4, 
             Line[{{
                $CellContext`X$[0], 
                $CellContext`Y$[0]}, {
                $CellContext`X$[1], 
                $CellContext`Y$[0]}, {
                $CellContext`X$[1], 
                $CellContext`Y$[1]}}]], 
            If[$CellContext`NPR$$ == 5, {{Dashed, 
               Line[{{
                  $CellContext`xop$[$CellContext`stage2$$], 
                  Part[$CellContext`stage2$$, 2]}, {
                  $CellContext`xeq$[$CellContext`stage2$$], 
                  Part[$CellContext`stage2$$, 2]}}]}, 
              $CellContext`pt1$[$CellContext`stage2$$, Black], 
              If[$CellContext`solution$$, 
               Line[{{
                  $CellContext`X$[1], 
                  $CellContext`Y$[1]}, {
                  $CellContext`X$[2], 
                  $CellContext`Y$[1]}}]]}], 
            If[$CellContext`NPR$$ > 5, 
             Line[{{
                $CellContext`X$[1], 
                $CellContext`Y$[1]}, {
                $CellContext`X$[2], 
                $CellContext`Y$[1]}, {
                $CellContext`X$[2], 
                $CellContext`Y$[2]}}]], 
            If[$CellContext`NPR$$ == 6, {
              If[$CellContext`n$ == 4, 
               Line[{{
                  $CellContext`X$[2], 
                  $CellContext`Y$[2]}, {
                  $CellContext`X$[3], 
                  $CellContext`Y$[2]}, {
                  $CellContext`X$[3], 
                  $CellContext`Y$[3]}}]], 
              If[$CellContext`n$ == 5, 
               Line[{{
                  $CellContext`X$[2], 
                  $CellContext`Y$[2]}, {
                  $CellContext`X$[3], 
                  $CellContext`Y$[2]}, {
                  $CellContext`X$[3], 
                  $CellContext`Y$[3]}, {
                  $CellContext`X$[4], 
                  $CellContext`Y$[3]}, {
                  $CellContext`X$[4], 
                  $CellContext`Y$[4]}}]], 
              If[$CellContext`n$ == 6, 
               Line[{{
                  $CellContext`X$[2], 
                  $CellContext`Y$[2]}, {
                  $CellContext`X$[3], 
                  $CellContext`Y$[2]}, {
                  $CellContext`X$[3], 
                  $CellContext`Y$[3]}, {
                  $CellContext`X$[4], 
                  $CellContext`Y$[3]}, {
                  $CellContext`X$[4], 
                  $CellContext`Y$[4]}, {
                  $CellContext`X$[5], 
                  $CellContext`Y$[4]}, {
                  $CellContext`X$[5], 
                  $CellContext`Y$[5]}}]], {Dashed, 
               Line[{{
                  $CellContext`xop$[$CellContext`stagen$$], 
                  Part[$CellContext`stagen$$, 2]}, {
                  $CellContext`xeq$[$CellContext`stagen$$], 
                  Part[$CellContext`stagen$$, 2]}}]}, 
              $CellContext`pt1$[$CellContext`stagen$$, Black], 
              If[$CellContext`solution$$, 
               Line[{{
                  $CellContext`X$[$CellContext`n$ - 1], 
                  $CellContext`Y$[$CellContext`n$ - 1]}, {
                  $CellContext`X$[$CellContext`n$], 
                  $CellContext`Y$[$CellContext`n$ - 1]}}]]}], 
            If[$CellContext`NPR$$ > 6, {
              Map[Line[{{
                  $CellContext`X$[# - 1], 
                  $CellContext`Y$[# - 1]}, {
                  $CellContext`X$[#], 
                  $CellContext`Y$[# - 1]}, {
                  $CellContext`X$[#], 
                  $CellContext`Y$[#]}}]& , 
               Range[$CellContext`n$ - 1]], 
              Line[{{
                 $CellContext`X$[$CellContext`n$ - 1], 
                 $CellContext`Y$[$CellContext`n$ - 1]}, {
                 $CellContext`X$[$CellContext`n$], 
                 $CellContext`Y$[$CellContext`n$ - 1]}}]}], 
            If[$CellContext`NPR$$ == 7, {
              Map[Text[
                Style[# + 1, 17, Background -> White], {
                 $CellContext`X$[#], 
                 $CellContext`Y$[#]}, {-1.5, 1}]& , 
               Range[$CellContext`n$]], 
              Text[
               Style[
               1, 17, Background -> 
                White], {$CellContext`x0$, $CellContext`y1$}, {-1.5, 1}]}]}, 
           PlotRange -> {{0, $CellContext`xp1$}, {0, 1.1 $CellContext`y1$}}, 
           PlotRangeClipping -> False, Frame -> True, FrameLabel -> {
             Row[{"solute/(solute-free liquid) ", 
               Style["x", Italic], " (ppm)"}], 
             Row[{"solute/(solute-free vapor) ", 
               Style["y", Italic], " (ppm)"}]}, LabelStyle -> {17, Black}, 
           ImageSize -> {
             If[$CellContext`graphic$$, 350, 600], 400}, AspectRatio -> Full, 
           GridLines -> If[$CellContext`NPR$$ == 7, None, {
              Range[0, $CellContext`xp1$, 0.02], 
              Range[0, 1.1 $CellContext`y1$, 2]}], GridLinesStyle -> 
           GrayLevel[0.8], ImagePadding -> {{55, 10}, {50, 
              If[$CellContext`graphic$$, 5, 
               If[
                And[
                3 <= $CellContext`NPR$$ <= 6, $CellContext`hint$$ == False], 
                5, 27]]}}, PlotLabel -> If[$CellContext`graphic$$, None, 
             Style[$CellContext`plotlabel$, 17]]]; 
        If[$CellContext`NPR$$ == 1, $CellContext`column$, 
          If[$CellContext`graphic$$, 
           
           Grid[{{$CellContext`diagram$, $CellContext`column$}}], \
$CellContext`diagram$]]], 
      "Specifications" :> {{{$CellContext`reset$$, 1}, 1, 1000, 1, 
         ControlType -> None, ControlPlacement -> 
         1}, {{$CellContext`NPR$$, 1, ""}, {1, 2, 3, 4, 5, 6, 7}, ControlType -> 
         None, ControlPlacement -> 
         2}, {{$CellContext`solution$$, False, "solution"}, {True, False}, 
         Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         3}, {{$CellContext`hint$$, False, "hint"}, {True, False}, 
         ControlPlacement -> 4}, {{$CellContext`graphic$$, False, "column"}, {
         True, False}, ControlPlacement -> 
         5}, {{$CellContext`op1$$, {0.05, 15}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         6}, {{$CellContext`op2$$, {0.35, 15}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         7}, {{$CellContext`eq1$$, {0.05, 15}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         8}, {{$CellContext`eq2$$, {0.35, 15}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         9}, {{$CellContext`stage1$$, {0.2, 13}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         10}, {{$CellContext`stage2$$, {0.15, 8}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         11}, {{$CellContext`stagen$$, {0.1, 6}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 12}, 
        Grid[{{
           Button[" new problem ", {
             
             If[$CellContext`reset$$ < 
              1000, $CellContext`reset$$ = $CellContext`reset$$ + 
               1, $CellContext`reset$$ = $CellContext`reset$$ - 
               1], $CellContext`NPR$$ = 1, $CellContext`solution$$ = 
             False, $CellContext`hint$$ = False, $CellContext`graphic$$ = 
             False}], 
           Manipulate`Place[1], 
           Dynamic[
            
            Switch[$CellContext`NPR$$, 1, "(1) gas flow rate", 2, 
             "(2) draw operating line", 3, "(3) draw equilibrium line", 4, 
             "(4) draw stage 1", 5, "(5) draw stage 2", 6, 
             "(6) draw last stage", 7, "(7) solution"]], 
           PaneSelector[{1 -> Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                 False; $CellContext`hint$$ = False; Null}], 2 -> 
             Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                 False; $CellContext`hint$$ = False; Null}], 3 -> 
             Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                 False; $CellContext`hint$$ = False; Null}], 4 -> 
             Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                 False; $CellContext`hint$$ = False; Null}], 5 -> 
             Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                 False; $CellContext`hint$$ = False; Null}], 5 -> 
             Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                 False; $CellContext`hint$$ = False; Null}], 6 -> 
             Button[" next ", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`NPR$$, Less, 
                  7], $CellContext`NPR$$ = $CellContext`NPR$$ + 
                  1, $CellContext`NPR$$ = 7], $CellContext`solution$$ = 
                 False; $CellContext`hint$$ = False; Null}]}, 
            Dynamic[$CellContext`NPR$$]], 
           Manipulate`Place[2], 
           
           PaneSelector[{
            1 -> Manipulate`Place[3], 2 -> Manipulate`Place[3], 3 -> 
             Manipulate`Place[3], 4 -> Manipulate`Place[3], 5 -> 
             Manipulate`Place[3], 6 -> Manipulate`Place[3]}, 
            Dynamic[$CellContext`NPR$$]], 
           
           PaneSelector[{
            1 -> Manipulate`Place[4], 2 -> Manipulate`Place[4], 3 -> 
             Manipulate`Place[4], 4 -> Manipulate`Place[4], 5 -> 
             Manipulate`Place[4], 6 -> Manipulate`Place[4]}, 
            Dynamic[$CellContext`NPR$$]], 
           
           PaneSelector[{
            2 -> Manipulate`Place[5], 3 -> Manipulate`Place[5], 4 -> 
             Manipulate`Place[5]}, 
            Dynamic[$CellContext`NPR$$]], 
           PaneSelector[{2 -> Row[{
                Manipulate`Place[6], 
                Manipulate`Place[7]}], 3 -> Row[{
                Manipulate`Place[8], 
                Manipulate`Place[9]}], 4 -> Manipulate`Place[10], 5 -> 
             Manipulate`Place[11], 6 -> Manipulate`Place[12]}, 
            Dynamic[$CellContext`NPR$$]]}}], {{$CellContext`gas$$, 1.2, 
          "select the correct gas flow rate (Mmol/h)"}, 1, 1.5, 0.1, 
         Appearance -> "Labeled", ControlPlacement -> 13}, 
        PaneSelector[{1 -> Manipulate`Place[13]}, 
         Dynamic[$CellContext`NPR$$]]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{655., {255., 262.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.7262416700409703`*^9, {3.7262419022914934`*^9, 3.7262419126327434`*^9}, 
   3.726242273381673*^9, 3.7262423369808936`*^9, 3.7262424114978695`*^9, {
   3.7262425155513954`*^9, 3.7262425442970395`*^9}, 3.726242611077874*^9, {
   3.7262426473945546`*^9, 3.7262426943269825`*^9}, 3.7262427246552486`*^9, 
   3.7262427889447594`*^9, {3.7262428284476585`*^9, 3.7262428387007093`*^9}, {
   3.726242910609078*^9, 3.7262429284741592`*^9}, {3.726243014526086*^9, 
   3.7262430340477843`*^9}, 3.726243184440235*^9, {3.726243223781538*^9, 
   3.726243241223538*^9}, {3.7262432773519173`*^9, 3.7262433242687473`*^9}, {
   3.72624336093604*^9, 3.726243370174775*^9}, {3.7262434035756464`*^9, 
   3.726243460683343*^9}, 3.72624387893349*^9, {3.7262439151219716`*^9, 
   3.7262439501046457`*^9}, {3.726244005325122*^9, 3.7262440326707673`*^9}, 
   3.726244097291292*^9, {3.726244271190665*^9, 3.726244285948349*^9}, {
   3.7262443428244715`*^9, 3.7262443556523266`*^9}, {3.7262444481072054`*^9, 
   3.7262445241981864`*^9}, 3.7262445587741604`*^9, 3.726244677707165*^9, {
   3.726244817593275*^9, 3.726244845007705*^9}, 3.726244882501297*^9, {
   3.7262449173000603`*^9, 3.7262449533188543`*^9}, {3.726245128523057*^9, 
   3.7262451415909147`*^9}, {3.72624522465316*^9, 3.726245292763501*^9}, 
   3.7262453315451093`*^9, {3.7262454268164043`*^9, 3.726245449672531*^9}, 
   3.7262455414306087`*^9, 3.726245679859947*^9, {3.726245721735361*^9, 
   3.7262457351182365`*^9}, 3.726245797334957*^9, {3.726245869872542*^9, 
   3.7262459696310673`*^9}, 3.7262460232979383`*^9, {3.7262461054245787`*^9, 
   3.7262461306121054`*^9}, {3.7262462280046034`*^9, 
   3.7262462460193033`*^9}, {3.726246285752716*^9, 3.726246309630802*^9}, 
   3.7263213255722685`*^9, 3.7263255548661737`*^9, 3.7263256645613966`*^9, 
   3.7263257022140136`*^9, 3.7263257349382114`*^9, {3.7263257779800415`*^9, 
   3.7263258076048083`*^9}, {3.726325875184003*^9, 3.7263259048347626`*^9}, 
   3.7263259492170095`*^9, {3.7263265393089046`*^9, 3.7263265547673855`*^9}, {
   3.7263266494099083`*^9, 3.7263266683352118`*^9}, 3.726326702380007*^9, 
   3.7263268759868436`*^9, {3.726412591699642*^9, 3.7264126010351763`*^9}, 
   3.726412954804411*^9, {3.7264129935596275`*^9, 3.726413051147921*^9}, 
   3.7270169765299034`*^9, 3.7270171859958844`*^9, 3.7270172452152715`*^9, 
   3.7271811794406843`*^9, 3.727622138045067*^9, 3.7276221835476694`*^9, 
   3.7277090426384354`*^9, 3.7277993629697847`*^9, {3.7277995483353868`*^9, 
   3.7277995777710705`*^9}, 3.7277996474870577`*^9, 3.7277996849772024`*^9, {
   3.727799731826882*^9, 3.7277997398063383`*^9}, {3.727799783808855*^9, 
   3.7277998112114224`*^9}, {3.728054229534042*^9, 3.728054234447323*^9}, {
   3.728054277295774*^9, 3.72805429593284*^9}, {3.728054330084793*^9, 
   3.7280543840208783`*^9}, {3.728054532085347*^9, 3.7280545504123955`*^9}, 
   3.7280576954912834`*^9, 3.729445704271826*^9, {3.729609059325282*^9, 
   3.729609067972777*^9}},
 CellID->508339023,ExpressionUUID->"e9c7a641-25d0-4360-8ad8-3cb71502db96"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ManipulateCaptionSection",ExpressionUUID->"51dbfff2-d330-42e8-b24c-241a46c31314"],

Cell[TextData[{
 "In this Demonstration, construct an ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "-", "y"}], TraditionalForm]], "InlineMath",ExpressionUUID->
  "6f8d8328-3d6d-45f9-a48e-d966d63ee1e4"],
 " diagram step-by-step and determine the number of stages needed to achieve \
a certain separation. Press the \"new problem\" button to generate a new set \
of conditions. Check \"solution\" to see the answer before clicking \"next\" \
to move onto the next step. Once you check \"solution\" you cannot change \
your answer. Once you click \"next\" you cannot go back to the previous \
steps. Check \"hint\" for a hint."
}], "ManipulateCaption",
 CellChangeTimes->{{3.726412607412541*^9, 3.7264127728210015`*^9}, {
  3.7294455614363937`*^9, 
  3.729445562049795*^9}},ExpressionUUID->"5050a8cd-cc3a-4b47-a1cb-\
42a7569473d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ThumbnailSection",ExpressionUUID->"c8b4d3a9-e21d-4bcd-9431-fcbb3fe45a99"],

Cell[BoxData[
 GraphicsBox[
  {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], RectangleBox[{0, 0}], 
   InsetBox[
    StyleBox["\<\"Thumbnail Placeholder\"\>",
     StripOnInput->False,
     FontFamily->"Verdana",
     FontSize->14], {0.5, 0.6}], InsetBox[
    StyleBox["\<\"Replace this with your\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.45}], InsetBox[
    StyleBox["\<\"Manipulate at a particular setting.\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.39}], InsetBox[
    StyleBox["\<\"(Do not use a bitmap.)\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.315}]},
  ImageMargins->0.,
  ImageSize->220]], "Output",
 CellEditDuplicate->
  False,ExpressionUUID->"1ce6a34c-6c30-4a6a-9cd8-8e34c7259d1f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SnapshotsSection",ExpressionUUID->"3604d5b9-3472-4d2a-a1cf-c5a48198942c"],

Cell[BoxData[
 GraphicsBox[
  {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], RectangleBox[{0, 0}], 
   InsetBox[
    StyleBox["\<\"Snapshot Placeholder\"\>",
     StripOnInput->False,
     FontFamily->"Verdana",
     FontSize->14], {0.5, 0.6}], InsetBox[
    StyleBox["\<\"Replace this with your\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.45}], InsetBox[
    StyleBox["\<\"Manipulate at a particular setting.\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.39}], InsetBox[
    StyleBox["\<\"(Do not use a bitmap.)\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.315}]},
  ImageMargins->0.,
  ImageSize->220]], "Output",
 CellEditDuplicate->
  False,ExpressionUUID->"6c11cfe3-0a75-4a43-855c-d91f1c316e1a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "DetailsSection",ExpressionUUID->"b6b33cd4-a7d8-43dc-bb0d-f1aab23e2d44"],

Cell["The equilibrium line is calculated using Henry's law:", "DetailNotes",
 CellChangeTimes->{{3.717161141029582*^9, 3.7171611543448544`*^9}},
 CellID->247079330,ExpressionUUID->"c00cf5e8-7f24-4d92-ae10-aff8be030f93"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "eq"], "=", 
    RowBox[{
     FractionBox["H", "P"], " ", "x"}]}], TraditionalForm]], "InlineMath",
  ExpressionUUID->"366c814e-788c-4650-9180-33c3e3661644"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.717161141029582*^9, 3.7171611655481057`*^9}},
 CellID->1243644,ExpressionUUID->"22f28ba2-adc5-4050-b8d4-9a45c8aca4d6"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"H", "=", 
    RowBox[{
     SuperscriptBox["H", "0"], " ", 
     SuperscriptBox["e", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["E", "R"]}], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "T"], "-", 
         FractionBox["1", 
          SubscriptBox["T", "0"]]}], ")"}]}]]}]}], TraditionalForm]], 
  "InlineMath",ExpressionUUID->"8c148773-c687-4aa1-b429-f46c886802aa"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.717161141029582*^9, 3.7171611840004034`*^9}},
 CellID->179478613,ExpressionUUID->"f82db3f5-dcec-4efb-9975-878e5c6eb763"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox["H", TraditionalForm]], "InlineMath",ExpressionUUID->
  "1df6a4eb-3f55-4aef-a40f-4c7619592669"],
 " is Henry's constant (atm), ",
 Cell[BoxData[
  FormBox["P", TraditionalForm]], "InlineMath",ExpressionUUID->
  "62811ca1-e241-45aa-81c8-490128a670dc"],
 " is pressure (atm), ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["H", "0"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "c0879552-e128-4a0f-b4aa-2ec6116dfd88"],
 " is Henry's constant at ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "0"], "=", 
    RowBox[{"298", " ", 
     StyleBox["K",
      FontSlant->"Plain"]}]}], TraditionalForm]], "InlineMath",
  ExpressionUUID->"a50fdc6e-c5f2-4d1e-8d1a-97e09103926b"],
 " (atm), ",
 Cell[BoxData[
  FormBox["R", TraditionalForm]], "InlineMath",ExpressionUUID->
  "7309e49c-3731-4b2a-9788-afbdb3a348a3"],
 " is the ideal gas constant (J/[mol K]), and ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]], "InlineMath",ExpressionUUID->
  "841ab957-88c3-4d0f-a58a-3effdbd8649b"],
 " is temperature (K)."
}], "DetailNotes",
 CellChangeTimes->{{3.717161141029582*^9, 3.7171612584409804`*^9}, {
  3.7180148989363537`*^9, 3.7180148998221664`*^9}, {3.7202591753746796`*^9, 
  3.720259187618662*^9}},
 CellID->196123819,ExpressionUUID->"e9ce223f-c276-4abb-844f-22c0a32113ec"],

Cell["\<\
The operating line is calculated from a mass balance around the stripper:\
\>", "DetailNotes",
 CellChangeTimes->{{3.7171612607849846`*^9, 3.717161273058853*^9}},
 CellID->427750987,ExpressionUUID->"24f96737-3f7a-4102-a927-27359fe07cdf"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["x", "0"], " ", "L"}], "+", 
     RowBox[{
      SubscriptBox["y", 
       RowBox[{"N", "+", "1"}]], " ", "V"}]}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["x", "N"], " ", "L"}], "+", 
     RowBox[{
      SubscriptBox["y", "1"], " ", "V"}]}]}], TraditionalForm]], "InlineMath",
  ExpressionUUID->"4c4c839c-1fc7-4a27-ba22-afc3337ea496"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.7171612607849846`*^9, 3.717161303605401*^9}},
 CellID->31707568,ExpressionUUID->"0cb6c8fe-6111-4635-9d90-2b0aa09fcc8a"],

Cell["which rearranges to:", "DetailNotes",
 CellChangeTimes->{{3.7171612607849846`*^9, 3.717161310064028*^9}, {
  3.7180149283981705`*^9, 3.7180149452814407`*^9}},
 CellID->77502291,ExpressionUUID->"e5980a6e-97a6-46b2-a6d1-2f1268323077"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", 
     RowBox[{"N", "+", "1"}]], "=", 
    RowBox[{
     RowBox[{
      FractionBox["L", "V"], " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["x", "N"], "-", 
        SubscriptBox["x", "0"]}], ")"}]}], "+", 
     SubscriptBox["y", "1"]}]}], TraditionalForm]], "InlineMath",
  ExpressionUUID->"0d14a4cf-2dab-4ead-9354-665784c91015"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.7171612607849846`*^9, 3.7171613239795027`*^9}},
 CellID->418944240,ExpressionUUID->"11107815-8d80-41f7-9d4c-721c5a5d1b84"],

Cell["the operating line is:", "DetailNotes",
 CellChangeTimes->{{3.7171612607849846`*^9, 3.7171613357629547`*^9}},
 CellID->169303183,ExpressionUUID->"28f5e877-9fd8-42a6-bb88-2c340915d5ec"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["y", "op"], "=", 
   RowBox[{
    RowBox[{
     FractionBox["L", "V"], "x"}], " ", "+", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["y", 
       RowBox[{"1", " "}]], "-", 
      RowBox[{
       FractionBox["L", "V"], 
       SubscriptBox["x", "0"]}]}], ")"}]}]}], 
  TraditionalForm]], \
"InlineMath",ExpressionUUID->"61395ca0-e615-4055-a46f-e17898dd0859"]], \
"DetailNotes",
 CellChangeTimes->{{3.7171612607849846`*^9, 3.717161348581026*^9}, {
  3.7273734632764626`*^9, 3.727373471044571*^9}},
 CellID->116936178,ExpressionUUID->"fda89d94-924c-4b94-8768-e9d09fc14b71"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox["L", TraditionalForm]], "InlineMath",ExpressionUUID->
  "23ca31ba-2acd-4104-a38f-2d484b324336"],
 " is the liquid solvent molar flow rate (Mmol/h), ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]], "InlineMath",ExpressionUUID->
  "ae3e3cc1-ef4e-483d-bb88-1b3d1c890969"],
 " is the vapor molar flow rate (Mmol/h), ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "0"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "c56215f6-0d74-490e-b0b0-61d7a91c2f9b"],
 " is the mole ratio of the impurity in the inlet liquid solvent stream \
(ppm), ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", 
    RowBox[{"N", "+", "1"}]], TraditionalForm]], "InlineMath",ExpressionUUID->
  "67bd5678-8d8c-468e-9074-e870515bcdd3"],
 " is the mole ratio of the impurity in the inlet vapor stream (ppm), ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "N"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "bd920ba7-fe2d-467f-acdf-16cb5e99c47b"],
 " is the mole ratio of the impurity in the outlet liquid solvent stream \
(ppm), and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", "1"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "ac3f0550-24ab-453b-8515-b4f6b8a398a5"],
 " is the mole ratio of the impurity in the outlet vapor stream (ppm)."
}], "DetailNotes",
 CellChangeTimes->{{3.7171612607849846`*^9, 3.717161449107328*^9}},
 CellID->10277057,ExpressionUUID->"7aad052a-f9f2-45de-8cfc-609d6c865a52"],

Cell[TextData[{
 "To count off stages, start at ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "0"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "b70fdba4-f91f-4a9a-ad73-cdbc931b8e5f"],
 " on the operating line (",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "0"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "68dfc743-e133-4726-9a2c-54b963250219"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", "1"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "826cc594-4804-4ac7-85dd-a1f5b28b5468"],
 ") and draw a horizontal line to the equilibrium line ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SubscriptBox["x", "1"]}], TraditionalForm]], "InlineMath",ExpressionUUID->
  "96d9d31b-4eb1-448d-b3bd-b2cb07c362e1"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", "1"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "b2f692c8-275a-4e53-8944-8486569a2b8e"],
 "). Then draw a vertical line down to the operating line. Repeat these steps \
until ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "N"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "7cbd7568-6f5c-4f17-812e-64ede846c769"],
 " is reached."
}], "DetailNotes",
 CellChangeTimes->{{3.71716147893468*^9, 3.7171615698893323`*^9}, {
  3.7171616279993143`*^9, 3.7171616279993143`*^9}, {3.7171617490517173`*^9, 
  3.717161774406245*^9}},
 CellID->189183902,ExpressionUUID->"7767cd86-fe02-4c28-a66e-55415e6e5821"],

Cell[TextData[{
 "The outlet liquid mole ratio ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "N"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "5545c5e9-531d-43bf-a918-dfc951ae407b"],
 " is calculated from the mass balance:"
}], "DetailNotes",
 CellChangeTimes->{{3.71716147893468*^9, 3.7171615698893323`*^9}, {
  3.7171616283893147`*^9, 3.7171616503154182`*^9}},
 CellID->118340805,ExpressionUUID->"943f2180-5c4a-43f2-a789-af59cfda0d51"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "N"], "=", 
    RowBox[{
     SubscriptBox["x", "0"], "+", 
     FractionBox[
      RowBox[{
       SubscriptBox["y", 
        RowBox[{"N", "+", "1"}]], "-", 
       SubscriptBox["y", "1"]}], 
      RowBox[{"L", "/", "V"}]]}]}], TraditionalForm]], "InlineMath",
  ExpressionUUID->"f94feba0-faff-4417-9d2c-f8f9448355f7"],
 "."
}], "DetailNotes",
 CellChangeTimes->{{3.71716147893468*^9, 3.7171615698893323`*^9}, {
  3.7171616283893147`*^9, 3.717161650076418*^9}, {3.7171617088979187`*^9, 
  3.7171617246109962`*^9}},
 CellID->3072535,ExpressionUUID->"fef6690b-116f-4b80-a9bf-0cc89def1281"],

Cell["Reference", "DetailNotes",
 CellChangeTimes->{{3.700080616089089*^9, 3.700080620869473*^9}, {
  3.7002210497359147`*^9, 3.7002210499553156`*^9}},
 CellID->359414663,
 $CellContext`ExpressionUUID -> 
 "fb4d39f9-5bac-44ca-ab62-8780064af81e",ExpressionUUID->"d9546a1d-b440-4596-\
8e41-dae8257dd61b"],

Cell[TextData[{
 "[1] P.C. Wankat,",
 StyleBox[" Separation Process Engineering: Includes Mass Transfer Analysis",
  FontSlant->"Italic"],
 ", 3rd ed., Upper Saddle River, NJ: Prentice Hall, 2012."
}], "DetailNotes",
 CellChangeTimes->{{3.7000806326022177`*^9, 3.700080658235621*^9}, {
  3.7000807420163927`*^9, 3.70008078191269*^9}, {3.7002210411464643`*^9, 
  3.7002210600179667`*^9}, {3.703523576809187*^9, 3.70352363025762*^9}},
 CellID->1027769137,
 $CellContext`ExpressionUUID -> 
 "51f3289b-98e7-4b7b-b134-a4a9bc9f8f2c",ExpressionUUID->"485b2e76-bbad-42d7-\
9ae5-b4dd641413bc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ControlSuggestionsSection",ExpressionUUID->"624d04c5-1f14-4683-9cf4-8da549285b5f"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[
   " Resize Images",ExpressionUUID->"b32c2fc4-d1e8-44d1-a116-a5d0d917ca07"]}],
  "\"Click inside an image to reveal its orange resize frame.\\nDrag any of \
the orange resize handles to resize the image.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.726412825627022*^9},
 FontFamily->"Verdana",
 CellTags->
  "ResizeImages",ExpressionUUID->"30d23d0d-6c2e-48f3-b665-786255359d42"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Rotate and Zoom in 3D",ExpressionUUID->
    "352fb01d-1ce9-417a-9f72-61c2c0a58827"]}],
  RowBox[{
   "\"Drag a 3D graphic to rotate it. Starting the drag near the center \
tumbles\\nthe graphic; starting near a corner turns it parallel to the plane \
of the screen.\\nHold down \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" (or \"", 
    FrameBox[
    "Cmd", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" on Mac) and drag up and down to zoom.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->
  "RotateAndZoomIn3D",ExpressionUUID->"a319e61e-8dce-4d88-9846-0de6cb143244"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[
   " Drag Locators",ExpressionUUID->"0ea9a28a-fb98-4314-9a1e-6edf72343a10"]}],
  RowBox[{"\"Drag any locator (\"", 
    GraphicsBox[
     LocatorBox[
      Scaled[{0.5, 0.5}]], ImageSize -> 20], 
    "\", etc.) to move it around.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.726412828145166*^9},
 FontFamily->"Verdana",
 CellTags->
  "DragLocators",ExpressionUUID->"f6b3de9a-fbb0-4d6d-baf4-aedc12c1bc11"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Create and Delete Locators",ExpressionUUID->
    "18807e7b-c271-4448-a137-97429aaff934"]}],
  RowBox[{"\"Insert a new locator in the graphic by holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key\\nand clicking where you want it to be. Delete a locator by \
clicking it\\nwhile holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" key.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->
  "CreateAndDeleteLocators",ExpressionUUID->"880a52f2-2ad0-4f77-af46-\
e827515bb84c"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Slider Zoom",ExpressionUUID->"791bf61b-8c89-4245-bbaa-e65fe97abf17"]}],
  RowBox[{"\"Hold down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key while moving a slider to make fine adjustments in the slider \
value.\\nHold \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" and/or \"", 
    FrameBox[
    "Shift", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" at the same time as \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" to make ever finer adjustments.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->
  "SliderZoom",ExpressionUUID->"8cc875ad-e4cd-4ead-8c5f-ee9267eb9e01"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Gamepad Controls",ExpressionUUID->
    "5b8fa585-dd70-419c-b3f2-403f34bd82ff"]}],
  "\"Control this Demonstration with a gamepad or other\\nhuman interface \
device connected to your computer.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.35696210375764*^9, 3.3895522232313623`*^9},
 FontFamily->"Verdana",
 CellTags->
  "GamepadControls",ExpressionUUID->"cdc72190-0961-4d57-94ad-249385347b3c"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[
   " Automatic Animation",ExpressionUUID->
    "32b29223-6319-4d9a-b8e5-c4f547a9bf93"]}],
  RowBox[{"\"Animate a slider in this Demonstration by clicking the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJzzTSzJSM1NLMlMTlRwL0osyMhMLlZwyy8CCjEzMjAwcIKwAgOI/R/IhBKc\n\
/4EAyGAG0f+nTZsGwgysIJIRKsWKLAXGIHFmEpUgLADxWUAkI24jZs+eTaEt\n\
IG+wQKRmzJgBlYf5lhEA30OqWA=="], "Graphics", ImageSize -> {9, 9}, ImageMargins -> 
      0, CellBaseline -> Baseline], BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"button\\nnext to the slider, and then clicking the play button that \
appears.\\nAnimate all controls by selecting \"", 
    StyleBox["Autorun", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.7264128296512523`*^9},
 FontFamily->"Verdana",
 CellTags->
  "AutomaticAnimation",ExpressionUUID->"64e22b9b-7d57-4b7d-9277-8c7f0c4f126a"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Bookmark Animation",ExpressionUUID->
    "df4b464a-97d3-471a-ad43-1b4a5ba29303"]}],
  RowBox[{
   "\"See a prepared animation of this Demonstration by selecting\\n\"", 
    StyleBox["Animate Bookmarks", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->
  "BookmarkAnimation",ExpressionUUID->"9de9f440-2015-489c-84d4-f701d4fe1049"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SearchTermsSection",ExpressionUUID->"191caca1-407b-42f2-abf9-091ba06a0b1d"],

Cell["stripper", "SearchTerms",
 CellChangeTimes->{{3.7171618614058743`*^9, 3.7171618629454927`*^9}, {
  3.7202591285829835`*^9, 3.720259129114685*^9}},
 CellID->448987494,ExpressionUUID->"825578b8-e5c5-49a9-bfb3-23f9ab8ccdb1"],

Cell["stripping column", "SearchTerms",
 CellChangeTimes->{{3.717161841196972*^9, 3.717161846491998*^9}},
 CellID->101076238,ExpressionUUID->"0ecbaca4-7029-43f6-bea3-95932f5e382a"],

Cell["thermodynamics", "SearchTerms",
 CellChangeTimes->{{3.717161841196972*^9, 3.7171618498768206`*^9}},
 CellID->66192833,ExpressionUUID->"ff81dc4a-e326-4819-9c9b-4888e13fd83b"],

Cell["chemical engineering", "SearchTerms",
 CellChangeTimes->{{3.717161841196972*^9, 3.717161855014247*^9}},
 CellID->670627659,ExpressionUUID->"74942a70-a720-416f-a61b-5f49b6d7ee86"],

Cell["equilibrium stages", "SearchTerms",
 CellChangeTimes->{{3.717161841196972*^9, 3.7171618583820686`*^9}, {
  3.7179623448345413`*^9, 3.7179623448345413`*^9}},
 CellID->405983559,ExpressionUUID->"c09f38e5-d42f-4da0-bd2d-57f12c1bed2d"],

Cell["separations", "SearchTerms",
 CellChangeTimes->{{3.717161841196972*^9, 3.7171618583820686`*^9}, {
  3.717962345335231*^9, 3.71796237000065*^9}},
 CellID->26332692,ExpressionUUID->"543af2ff-6e46-4d3f-a5a3-edb4dab216cd"],

Cell["absorption equilibrium", "SearchTerms",
 CellChangeTimes->{{3.717161841196972*^9, 3.7171618583820686`*^9}, {
  3.717962345335231*^9, 3.717962378928979*^9}, {3.717963446897818*^9, 
  3.717963446897818*^9}, {3.720259108875868*^9, 3.7202591118322935`*^9}},
 CellID->102768744,ExpressionUUID->"c8703ed7-5ffd-455b-a827-5e6e2f80ae2d"],

Cell["phase equilibrium", "SearchTerms",
 CellChangeTimes->{{3.717161841196972*^9, 3.7171618583820686`*^9}, {
  3.717962345335231*^9, 3.717962378928979*^9}, {3.71796344764507*^9, 
  3.7179634533059697`*^9}},
 CellID->225931691,ExpressionUUID->"14613750-d95c-4503-ba6b-a1cc8d4c7a40"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "RelatedLinksSection",ExpressionUUID->"9aea10e0-f195-4d47-9bf2-081bde039fe0"],

Cell[TextData[ButtonBox["McCabe-Thiele Method for Methanol/Water Separation",
 BaseStyle->"Hyperlink",
 ButtonData->{
   URL["http://demonstrations.wolfram.com/\
McCabeThieleMethodForMethanolWaterSeparation/"], None},
 ButtonNote->
  "http://demonstrations.wolfram.com/\
McCabeThieleMethodForMethanolWaterSeparation/"]], "RelatedLinks",
 CellChangeTimes->{{3.699963664517885*^9, 3.6999636839361696`*^9}},
 CellID->42471128,
 $CellContext`ExpressionUUID -> 
 "cdb3e69b-81ad-4695-af41-15af7c7555b8",ExpressionUUID->"f31f6219-85e8-4402-\
906d-043519be4064"],

Cell[TextData[ButtonBox["Operation of an Absorption Column",
 BaseStyle->"Hyperlink",
 ButtonData->{
   URL["http://demonstrations.wolfram.com/OperationOfAnAbsorptionColumn/"], 
   None},
 ButtonNote->
  "http://demonstrations.wolfram.com/OperationOfAnAbsorptionColumn/"]], \
"RelatedLinks",
 CellChangeTimes->{{3.7181152678857737`*^9, 3.718115281710247*^9}},
 CellID->285083932,ExpressionUUID->"24a9cadd-835d-49f1-9924-3168b884b1a6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "AuthorSection",ExpressionUUID->"3348b12a-7112-44de-994a-7a27f39e0bb4"],

Cell[TextData[{
 "Contributed by: ",
 ButtonBox["Rachael L. Baumann",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=Rachael%20L.%\
20Baumann"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=Rachael%20L.%\
20Baumann"]
}], "Author",
 CellChangeTimes->{{3.699712700400914*^9, 3.699712711250766*^9}, {
   3.699712766442687*^9, 3.699712785590452*^9}, {3.6999636023826447`*^9, 
   3.699963604458664*^9}, 3.7171618331881404`*^9},
 CellID->347156356,
 $CellContext`ExpressionUUID -> 
 "ca47b61e-38b9-408d-afda-95466a86c7d6",ExpressionUUID->"98a449ad-e09f-4d2c-\
a5ce-a3cc8e8271b3"],

Cell[TextData[{
 "Additional contributions by: ",
 ButtonBox["John L. Falconer",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=John%20L.%\
20Falconer"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=John%20L.%20Falconer"]
}], "Author",
 CellChangeTimes->{{3.699712700400914*^9, 3.699712728131461*^9}, {
  3.6997128004249277`*^9, 3.6997128004249277`*^9}},
 CellID->373235529,
 $CellContext`ExpressionUUID -> 
 "39baa6b7-bfbd-410e-bf32-1c17245b691c",ExpressionUUID->"694f27ee-44cf-4779-\
a17c-1bbdf177e7c3"],

Cell["\<\
(University of Colorado Boulder, Department of Chemical and Biological \
Engineering)\
\>", "Author",
 CellChangeTimes->{{3.699712700400914*^9, 3.699712739137374*^9}},
 CellID->77347031,
 $CellContext`ExpressionUUID -> 
 "b8d8f6e5-3037-4f01-8c69-0946d1ec77a0",ExpressionUUID->"170b30cd-f19f-4a03-\
8458-ba9a2a6e7202"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1366, 686},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "Demonstration.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "ResizeImages"->{
  Cell[138876, 3253, 470, 11, 22, "ControlSuggestions",ExpressionUUID->"30d23d0d-6c2e-48f3-b665-786255359d42",
   CellTags->"ResizeImages"]},
 "RotateAndZoomIn3D"->{
  Cell[139349, 3266, 800, 19, 22, "ControlSuggestions",ExpressionUUID->"a319e61e-8dce-4d88-9846-0de6cb143244",
   CellTags->"RotateAndZoomIn3D"]},
 "DragLocators"->{
  Cell[140152, 3287, 498, 14, 22, "ControlSuggestions",ExpressionUUID->"f6b3de9a-fbb0-4d6d-baf4-aedc12c1bc11",
   CellTags->"DragLocators"]},
 "CreateAndDeleteLocators"->{
  Cell[140653, 3303, 761, 19, 22, "ControlSuggestions",ExpressionUUID->"880a52f2-2ad0-4f77-af46-e827515bb84c",
   CellTags->"CreateAndDeleteLocators"]},
 "SliderZoom"->{
  Cell[141417, 3324, 961, 23, 22, "ControlSuggestions",ExpressionUUID->"8cc875ad-e4cd-4ead-8c5f-ee9267eb9e01",
   CellTags->"SliderZoom"]},
 "GamepadControls"->{
  Cell[142381, 3349, 491, 12, 22, "ControlSuggestions",ExpressionUUID->"cdc72190-0961-4d57-94ad-249385347b3c",
   CellTags->"GamepadControls"]},
 "AutomaticAnimation"->{
  Cell[142875, 3363, 1629, 35, 22, "ControlSuggestions",ExpressionUUID->"64e22b9b-7d57-4b7d-9277-8c7f0c4f126a",
   CellTags->"AutomaticAnimation"]},
 "BookmarkAnimation"->{
  Cell[144507, 3400, 1030, 24, 22, "ControlSuggestions",ExpressionUUID->"9de9f440-2015-489c-84d4-f701d4fe1049",
   CellTags->"BookmarkAnimation"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"ResizeImages", 150761, 3564},
 {"RotateAndZoomIn3D", 150927, 3567},
 {"DragLocators", 151093, 3570},
 {"CreateAndDeleteLocators", 151265, 3573},
 {"SliderZoom", 151435, 3576},
 {"GamepadControls", 151597, 3579},
 {"AutomaticAnimation", 151767, 3582},
 {"BookmarkAnimation", 151940, 3585}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 408, 11, 75, "DemoTitle",ExpressionUUID->"ab2b8b81-d21f-4498-94bc-5aadb10171b2"],
Cell[CellGroupData[{
Cell[1013, 37, 88, 0, 275, "InitializationSection",ExpressionUUID->"7a75f165-9113-403f-b913-2ba3a0a3e6bb"],
Cell[1104, 39, 645, 15, 33, "Input",ExpressionUUID->"fcd228ed-7be6-4698-a285-c867b21d3fc3",
 InitializationCell->True,
 CellID->448483865],
Cell[1752, 56, 1620, 44, 52, "Input",ExpressionUUID->"dcaf6bb7-fb03-439c-b425-cc778b3f224b",
 InitializationCell->True,
 CellID->493747658],
Cell[3375, 102, 1120, 29, 52, "Input",ExpressionUUID->"49f58b9b-22ef-4e35-ab65-e75c8279f6f0",
 InitializationCell->True,
 CellID->241618003],
Cell[4498, 133, 1173, 32, 52, "Input",ExpressionUUID->"fd3da418-8c6f-4eff-a6e3-499b3c9f2475",
 InitializationCell->True,
 CellID->905169336],
Cell[5674, 167, 1173, 32, 52, "Input",ExpressionUUID->"fbc6132c-27ce-4975-b685-1710d2ca7487",
 InitializationCell->True,
 CellID->462033904],
Cell[6850, 201, 1242, 31, 52, "Input",ExpressionUUID->"e82ffc03-25ea-4794-a75f-e9209532051d",
 InitializationCell->True,
 CellID->60133328],
Cell[8095, 234, 1509, 35, 52, "Input",ExpressionUUID->"58b02b72-8db3-45a3-8bef-37ea227508b1",
 InitializationCell->True,
 CellID->293923279]
}, Open  ]],
Cell[CellGroupData[{
Cell[9641, 274, 84, 0, 231, "ManipulateSection",ExpressionUUID->"6737209a-a623-4c86-a530-0ea2aa9d2542"],
Cell[CellGroupData[{
Cell[9750, 278, 75610, 1765, 3215, "Input",ExpressionUUID->"e8e7b2b3-23ee-4723-a223-d26ad60d3a89"],
Cell[85363, 2045, 39429, 803, 529, "Output",ExpressionUUID->"e9c7a641-25d0-4360-8ad8-3cb71502db96",
 CellID->508339023]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[124841, 2854, 91, 0, 169, "ManipulateCaptionSection",ExpressionUUID->"51dbfff2-d330-42e8-b24c-241a46c31314"],
Cell[124935, 2856, 828, 16, 53, "ManipulateCaption",ExpressionUUID->"5050a8cd-cc3a-4b47-a1cb-42a7569473d9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125800, 2877, 83, 0, 172, "ThumbnailSection",ExpressionUUID->"c8b4d3a9-e21d-4bcd-9431-fcbb3fe45a99"],
Cell[125886, 2879, 1300, 35, 230, "Output",ExpressionUUID->"1ce6a34c-6c30-4a6a-9cd8-8e34c7259d1f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[127223, 2919, 83, 0, 142, "SnapshotsSection",ExpressionUUID->"3604d5b9-3472-4d2a-a1cf-c5a48198942c"],
Cell[127309, 2921, 1299, 35, 230, "Output",ExpressionUUID->"6c11cfe3-0a75-4a43-855c-d91f1c316e1a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128645, 2961, 81, 0, 335, "DetailsSection",ExpressionUUID->"b6b33cd4-a7d8-43dc-bb0d-f1aab23e2d44"],
Cell[128729, 2963, 219, 2, 22, "DetailNotes",ExpressionUUID->"c00cf5e8-7f24-4d92-ae10-aff8be030f93",
 CellID->247079330],
Cell[128951, 2967, 400, 11, 33, "DetailNotes",ExpressionUUID->"22f28ba2-adc5-4050-b8d4-9a45c8aca4d6",
 CellID->1243644],
Cell[129354, 2980, 627, 19, 37, "DetailNotes",ExpressionUUID->"f82db3f5-dcec-4efb-9975-878e5c6eb763",
 CellID->179478613],
Cell[129984, 3001, 1339, 36, 23, "DetailNotes",ExpressionUUID->"e9ce223f-c276-4abb-844f-22c0a32113ec",
 CellID->196123819],
Cell[131326, 3039, 247, 4, 22, "DetailNotes",ExpressionUUID->"24f96737-3f7a-4102-a927-27359fe07cdf",
 CellID->427750987],
Cell[131576, 3045, 613, 19, 23, "DetailNotes",ExpressionUUID->"0cb6c8fe-6111-4635-9d90-2b0aa09fcc8a",
 CellID->31707568],
Cell[132192, 3066, 238, 3, 22, "DetailNotes",ExpressionUUID->"e5980a6e-97a6-46b2-a6d1-2f1268323077",
 CellID->77502291],
Cell[132433, 3071, 592, 18, 33, "DetailNotes",ExpressionUUID->"11107815-8d80-41f7-9d4c-721c5a5d1b84",
 CellID->418944240],
Cell[133028, 3091, 190, 2, 22, "DetailNotes",ExpressionUUID->"28f5e877-9fd8-42a6-bb88-2c340915d5ec",
 CellID->169303183],
Cell[133221, 3095, 642, 19, 33, "DetailNotes",ExpressionUUID->"fda89d94-924c-4b94-8768-e9d09fc14b71",
 CellID->116936178],
Cell[133866, 3116, 1453, 35, 39, "DetailNotes",ExpressionUUID->"7aad052a-f9f2-45de-8cfc-609d6c865a52",
 CellID->10277057],
Cell[135322, 3153, 1411, 38, 39, "DetailNotes",ExpressionUUID->"7767cd86-fe02-4c28-a66e-55415e6e5821",
 CellID->189183902],
Cell[136736, 3193, 449, 10, 23, "DetailNotes",ExpressionUUID->"943f2180-5c4a-43f2-a789-af59cfda0d51",
 CellID->118340805],
Cell[137188, 3205, 664, 19, 33, "DetailNotes",ExpressionUUID->"fef6690b-116f-4b80-a9bf-0cc89def1281",
 CellID->3072535],
Cell[137855, 3226, 302, 6, 22, "DetailNotes",ExpressionUUID->"d9546a1d-b440-4596-8e41-dae8257dd61b",
 CellID->359414663],
Cell[138160, 3234, 584, 12, 22, "DetailNotes",ExpressionUUID->"485b2e76-bbad-42d7-9ae5-b4dd641413bc",
 CellID->1027769137]
}, Open  ]],
Cell[CellGroupData[{
Cell[138781, 3251, 92, 0, 126, "ControlSuggestionsSection",ExpressionUUID->"624d04c5-1f14-4683-9cf4-8da549285b5f"],
Cell[138876, 3253, 470, 11, 22, "ControlSuggestions",ExpressionUUID->"30d23d0d-6c2e-48f3-b665-786255359d42",
 CellTags->"ResizeImages"],
Cell[139349, 3266, 800, 19, 22, "ControlSuggestions",ExpressionUUID->"a319e61e-8dce-4d88-9846-0de6cb143244",
 CellTags->"RotateAndZoomIn3D"],
Cell[140152, 3287, 498, 14, 22, "ControlSuggestions",ExpressionUUID->"f6b3de9a-fbb0-4d6d-baf4-aedc12c1bc11",
 CellTags->"DragLocators"],
Cell[140653, 3303, 761, 19, 22, "ControlSuggestions",ExpressionUUID->"880a52f2-2ad0-4f77-af46-e827515bb84c",
 CellTags->"CreateAndDeleteLocators"],
Cell[141417, 3324, 961, 23, 22, "ControlSuggestions",ExpressionUUID->"8cc875ad-e4cd-4ead-8c5f-ee9267eb9e01",
 CellTags->"SliderZoom"],
Cell[142381, 3349, 491, 12, 22, "ControlSuggestions",ExpressionUUID->"cdc72190-0961-4d57-94ad-249385347b3c",
 CellTags->"GamepadControls"],
Cell[142875, 3363, 1629, 35, 22, "ControlSuggestions",ExpressionUUID->"64e22b9b-7d57-4b7d-9277-8c7f0c4f126a",
 CellTags->"AutomaticAnimation"],
Cell[144507, 3400, 1030, 24, 22, "ControlSuggestions",ExpressionUUID->"9de9f440-2015-489c-84d4-f701d4fe1049",
 CellTags->"BookmarkAnimation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[145574, 3429, 85, 0, 155, "SearchTermsSection",ExpressionUUID->"191caca1-407b-42f2-abf9-091ba06a0b1d"],
Cell[145662, 3431, 227, 3, 22, "SearchTerms",ExpressionUUID->"825578b8-e5c5-49a9-bfb3-23f9ab8ccdb1",
 CellID->448987494],
Cell[145892, 3436, 180, 2, 22, "SearchTerms",ExpressionUUID->"0ecbaca4-7029-43f6-bea3-95932f5e382a",
 CellID->101076238],
Cell[146075, 3440, 179, 2, 22, "SearchTerms",ExpressionUUID->"ff81dc4a-e326-4819-9c9b-4888e13fd83b",
 CellID->66192833],
Cell[146257, 3444, 184, 2, 22, "SearchTerms",ExpressionUUID->"74942a70-a720-416f-a61b-5f49b6d7ee86",
 CellID->670627659],
Cell[146444, 3448, 237, 3, 22, "SearchTerms",ExpressionUUID->"c09f38e5-d42f-4da0-bd2d-57f12c1bed2d",
 CellID->405983559],
Cell[146684, 3453, 224, 3, 22, "SearchTerms",ExpressionUUID->"543af2ff-6e46-4d3f-a5a3-edb4dab216cd",
 CellID->26332692],
Cell[146911, 3458, 334, 4, 22, "SearchTerms",ExpressionUUID->"c8703ed7-5ffd-455b-a827-5e6e2f80ae2d",
 CellID->102768744],
Cell[147248, 3464, 282, 4, 22, "SearchTerms",ExpressionUUID->"14613750-d95c-4503-ba6b-a1cc8d4c7a40",
 CellID->225931691]
}, Open  ]],
Cell[CellGroupData[{
Cell[147567, 3473, 86, 0, 141, "RelatedLinksSection",ExpressionUUID->"9aea10e0-f195-4d47-9bf2-081bde039fe0"],
Cell[147656, 3475, 554, 12, 22, "RelatedLinks",ExpressionUUID->"f31f6219-85e8-4402-906d-043519be4064",
 CellID->42471128],
Cell[148213, 3489, 434, 9, 22, "RelatedLinks",ExpressionUUID->"24a9cadd-835d-49f1-9924-3168b884b1a6",
 CellID->285083932]
}, Open  ]],
Cell[CellGroupData[{
Cell[148684, 3503, 80, 0, 141, "AuthorSection",ExpressionUUID->"3348b12a-7112-44de-994a-7a27f39e0bb4"],
Cell[148767, 3505, 664, 17, 22, "Author",ExpressionUUID->"98a449ad-e09f-4d2c-a5ce-a3cc8e8271b3",
 CellID->347156356],
Cell[149434, 3524, 596, 15, 22, "Author",ExpressionUUID->"694f27ee-44cf-4779-a17c-1bbdf177e7c3",
 CellID->373235529],
Cell[150033, 3541, 327, 8, 22, "Author",ExpressionUUID->"170b30cd-f19f-4a03-8458-ba9a2a6e7202",
 CellID->77347031]
}, Open  ]]
}, Open  ]]
}
]
*)

