(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    129326,       3166]
NotebookOptionsPosition[    122987,       3043]
NotebookOutlinePosition[    125046,       3093]
CellTagsIndexPosition[    124710,       3081]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Your Title Here", "DemoTitle",ExpressionUUID->"9bb0136e-bd2b-4252-abe7-cd2de591f205"],

Cell[CellGroupData[{

Cell["", "InitializationSection",ExpressionUUID->"8720b812-cebf-46c8-b093-c4f57cd0a2bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"base", "=", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", "Thick", "]"}], ",", 
        RowBox[{"FaceForm", "[", "None", "]"}], ",", 
        RowBox[{"Polygon", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.5", ",", 
             RowBox[{
              SqrtBox["3"], "/", "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"(*", "A", "*)"}], 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Blue", ",", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"i", ",", "17"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"i", "/", "2"}], ",", 
                RowBox[{"i", "*", 
                 RowBox[{
                  SqrtBox["3"], "/", "2"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2.25", ",", "0"}], "}"}]}], "]"}], ",", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"i", "/", "2"}], "-", "0.03"}], ",", 
                 RowBox[{"i", "*", 
                  RowBox[{
                   SqrtBox["3"], "/", "2"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"i", "/", "2"}], ",", 
                 RowBox[{"i", "*", 
                  RowBox[{
                   SqrtBox["3"], "/", "2"}]}]}], "}"}]}], "}"}], "]"}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", "S", "*)"}], 
          RowBox[{"{", 
           RowBox[{"Red", ",", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"1", "-", "i"}], ",", "17"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "2.25"}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "/", "2"}], ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"i", "+", 
                  RowBox[{"0.03", "/", "2"}]}], ",", 
                 RowBox[{
                  RowBox[{"-", "0.03"}], "*", 
                  RowBox[{
                   SqrtBox["3"], "/", "2"}]}]}], "}"}]}], "}"}], "]"}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", "C", "*)"}], 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"RGBColor", "[", 
             RowBox[{"0", ",", "0.6", ",", "0"}], "]"}], ",", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"1", "-", "i"}], ",", "17"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "-", 
                 RowBox[{"i", "/", "2"}]}], ",", 
                RowBox[{"i", "*", 
                 RowBox[{
                  SqrtBox["3"], "/", "2"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "2.25"}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1.5", ",", "2"}], "}"}]}], "]"}], ",", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"1", "-", 
                  RowBox[{"i", "/", "2"}]}], ",", 
                 RowBox[{"i", "*", 
                  RowBox[{
                   SqrtBox["3"], "/", "2"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"1", "-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"i", "-", "0.03"}], ")"}], "/", "2"}]}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"i", "+", "0.03"}], ")"}], "*", 
                  RowBox[{
                   SqrtBox["3"], "/", "2"}]}]}], "}"}]}], "}"}], "]"}]}], 
           "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0.1", ",", "0.9", ",", "0.1"}], "}"}]}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<solute\>\"", ",", "17", ",", "Blue"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", 
          RowBox[{
           SqrtBox["3"], "/", "2"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<solvent\>\"", ",", "17", ",", "Red"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<carrier\>\"", ",", "17", ",", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"0", ",", "0.6", ",", "0"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "}"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6495078657249107`*^9, 3.649507867797029*^9}, {
   3.649508048346356*^9, 3.6495080495744257`*^9}, {3.649521666925294*^9, 
   3.6495216672633133`*^9}, 3.649524425896098*^9, {3.649524492104885*^9, 
   3.6495245801339197`*^9}, 3.650133310545992*^9, {3.650728231065005*^9, 
   3.6507282408535647`*^9}, {3.6507282950616655`*^9, 
   3.6507282956977015`*^9}, {3.651336359493969*^9, 3.6513363621091185`*^9}, {
   3.6513363991792383`*^9, 3.6513364171432657`*^9}, {3.651336479521834*^9, 
   3.6513364846811295`*^9}, {3.652555505554027*^9, 3.652555540648533*^9}, {
   3.6525555812864437`*^9, 3.6525556527238092`*^9}, {3.652555692818295*^9, 
   3.6525556982897587`*^9}, {3.6525559087887497`*^9, 3.652555909994412*^9}, {
   3.652556036463067*^9, 3.652556039789757*^9}, {3.6804627507554092`*^9, 
   3.680462755088657*^9}, {3.6804629431644144`*^9, 3.6804629452555337`*^9}, {
   3.682689861435293*^9, 3.682689884135378*^9}, {3.724685771658586*^9, 
   3.724685790359885*^9}, {3.72468608330581*^9, 3.724686109470341*^9}, {
   3.7251182901852303`*^9, 3.7251183149787693`*^9}},
 CellID->922119689,ExpressionUUID->"a39c573c-1b0d-47b2-b5b8-628a36cf1482"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"wtA", "[", "y_", "]"}], ":=", 
   RowBox[{"y", "*", 
    RowBox[{"2", "/", 
     SqrtBox["3"]}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellID->218799681,ExpressionUUID->"9ffbd960-f934-4fdc-9276-c0013bbc7eef"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"wtS", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"1", "-", 
    RowBox[{"(", 
     RowBox[{"x", "+", 
      RowBox[{"y", "/", 
       SqrtBox["3"]}]}], ")"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellID->40409647,ExpressionUUID->"e0e33c9d-d66c-405e-86e9-5afa471be80f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"colF", "=", "Black"}], ";", 
  RowBox[{"colR", "=", 
   RowBox[{"Darker", "@", 
    RowBox[{"RGBColor", "[", 
     RowBox[{"0", ",", "0.4", ",", "0.6"}], "]"}]}]}], ";", 
  RowBox[{"colS", "=", "Red"}], ";", 
  RowBox[{"colM", "=", 
   RowBox[{"GrayLevel", "@", "0.3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colE1", "=", "Orange"}], ";", 
  RowBox[{"colOP", "=", "Purple"}], ";"}]}], "Input",
 InitializationCell->True,
 CellID->707626315,ExpressionUUID->"ac7f950d-7295-401d-bae3-b3bfec3b0b05"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pt1", "[", 
    RowBox[{"pt_", ",", "col_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"col", ",", 
     RowBox[{"PointSize", "@", "0.03"}], ",", 
     RowBox[{"Point", "@", "pt"}], ",", "White", ",", 
     RowBox[{"PointSize", "@", "0.015"}], ",", 
     RowBox[{"Point", "@", "pt"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7240835690121155`*^9, 3.7240836053530207`*^9}, {
  3.7240837136523137`*^9, 3.7240837322618713`*^9}, {3.7246872323729343`*^9, 
  3.724687253435243*^9}, {3.7246879309231505`*^9, 3.7246879319537525`*^9}, {
  3.7251184025276675`*^9, 3.72511840544508*^9}, {3.7264113298294673`*^9, 
  3.7264113361898313`*^9}},
 CellID->94651572,ExpressionUUID->"4bb68663-9430-4292-a77f-e9d533b164c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pt2", "[", 
    RowBox[{"pt_", ",", "col_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"col", ",", 
     RowBox[{"PointSize", "@", "0.03"}], ",", 
     RowBox[{"Point", "@", "pt"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.724083607743247*^9, 3.724083619228941*^9}, {
   3.724083722714589*^9, 3.7240837372653117`*^9}, 3.72468723514314*^9, {
   3.7246879340177712`*^9, 3.7246879341425714`*^9}, {3.7251184179749537`*^9, 
   3.7251184183055544`*^9}},
 CellID->254988361,ExpressionUUID->"6f16323a-ebb8-4f0d-af72-d4218e76e10b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ManipulateSection",ExpressionUUID->"aedeb511-43c5-4fc2-bbc4-0923640c2b0b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "x1", ",", "y1", ",", "x2", ",", "y2", ",", "x3", ",", "y3", ",", "sol",
        ",", "a", ",", "b", ",", "c", ",", "phase", ",", "phaseplot", ",", 
       "yt", ",", "xt", ",", "tie", ",", "tielines", ",", "F", ",", "S", ",", 
       "M", ",", "xF", ",", "yF", ",", "xRN", ",", "yRN", ",", "Msol", ",", 
       "xM", ",", "yM", ",", "xE", ",", "yE", ",", "xP", ",", "yP", ",", 
       "operating", ",", "lower", ",", "upper", ",", "lever", ",", "newtie", 
       ",", "xtie", ",", "xR", ",", "yR", ",", "n"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SeedRandom", "[", "reset", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"x1", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"0.02", ",", "0.15"}], "}"}], "]"}]}], ";", 
      RowBox[{"y1", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"x2", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"0.45", ",", "0.55"}], "}"}], "]"}]}], ";", 
      RowBox[{"y2", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"0.3", ",", "0.4"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"x3", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"0.85", ",", "0.98"}], "}"}], "]"}]}], ";", 
      RowBox[{"y3", "=", "0"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"Quiet", "@", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"\[Alpha]", "*", 
                SuperscriptBox["x1", "2"]}], "+", 
               RowBox[{"\[Beta]", "*", "x1"}], "+", "\[Chi]"}], "\[Equal]", 
              "y1"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Alpha]", "*", 
                SuperscriptBox["x2", "2"]}], "+", 
               RowBox[{"\[Beta]", "*", "x2"}], "+", "\[Chi]"}], "\[Equal]", 
              "y2"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Alpha]", "*", 
                SuperscriptBox["x3", "2"]}], "+", 
               RowBox[{"\[Beta]", "*", "x3"}], "+", "\[Chi]"}], "\[Equal]", 
              "y3"}]}], "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Chi]"}], "}"}]}], 
          "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"\[Alpha]", "/.", "sol"}]}], ";", 
      RowBox[{"b", "=", 
       RowBox[{"\[Beta]", "/.", "sol"}]}], ";", 
      RowBox[{"c", "=", 
       RowBox[{"\[Chi]", "/.", "sol"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"phase", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{"a", "*", 
         SuperscriptBox["x", "2"]}], "+", 
        RowBox[{"b", "*", "x"}], "+", "c"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"phaseplot", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"phase", "[", "x", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "x1", ",", "x3"}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Black"}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               SqrtBox["3"], "/", "2"}]}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yt", "[", "1", "]"}], "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.02", ",", "0.05"}], "}"}], "*", "y2"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"xt", "[", "1", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"phase", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"yt", "[", "1", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yt", "[", "2", "]"}], "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.06", ",", "0.1"}], "}"}], "*", "y2"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"xt", "[", "2", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"phase", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"yt", "[", "2", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"tie", "[", "1", "]"}], "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"yt", "[", "2", "]"}], "-", 
           RowBox[{"yt", "[", "1", "]"}]}], 
          RowBox[{
           RowBox[{"xt", "[", "2", "]"}], "-", 
           RowBox[{"xt", "[", "1", "]"}]}]], "*", 
         RowBox[{"(", 
          RowBox[{"x", "-", 
           RowBox[{"xt", "[", "1", "]"}]}], ")"}]}], "+", 
        RowBox[{"yt", "[", "1", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yt", "[", "3", "]"}], "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.15", ",", "0.2"}], "}"}], "*", "y2"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"xt", "[", "3", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"phase", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"yt", "[", "3", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yt", "[", "4", "]"}], "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.25", ",", "0.3"}], "}"}], "*", "y2"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"xt", "[", "4", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"phase", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"yt", "[", "4", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"tie", "[", "2", "]"}], "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"yt", "[", "4", "]"}], "-", 
           RowBox[{"yt", "[", "3", "]"}]}], 
          RowBox[{
           RowBox[{"xt", "[", "4", "]"}], "-", 
           RowBox[{"xt", "[", "3", "]"}]}]], "*", 
         RowBox[{"(", 
          RowBox[{"x", "-", 
           RowBox[{"xt", "[", "3", "]"}]}], ")"}]}], "+", 
        RowBox[{"yt", "[", "3", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yt", "[", "5", "]"}], "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.35", ",", "0.4"}], "}"}], "*", "y2"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"xt", "[", "5", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"phase", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"yt", "[", "5", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yt", "[", "6", "]"}], "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.5", ",", "0.55"}], "}"}], "*", "y2"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"xt", "[", "6", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"phase", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"yt", "[", "6", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"tie", "[", "3", "]"}], "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"yt", "[", "6", "]"}], "-", 
           RowBox[{"yt", "[", "5", "]"}]}], 
          RowBox[{
           RowBox[{"xt", "[", "6", "]"}], "-", 
           RowBox[{"xt", "[", "5", "]"}]}]], "*", 
         RowBox[{"(", 
          RowBox[{"x", "-", 
           RowBox[{"xt", "[", "5", "]"}]}], ")"}]}], "+", 
        RowBox[{"yt", "[", "5", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yt", "[", "7", "]"}], "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.72", ",", "0.77"}], "}"}], "*", "y2"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"xt", "[", "7", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"phase", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"yt", "[", "7", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yt", "[", "8", "]"}], "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.8", ",", "0.9"}], "}"}], "*", "y2"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"xt", "[", "8", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"phase", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"yt", "[", "8", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"tie", "[", "4", "]"}], "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"yt", "[", "8", "]"}], "-", 
           RowBox[{"yt", "[", "7", "]"}]}], 
          RowBox[{
           RowBox[{"xt", "[", "8", "]"}], "-", 
           RowBox[{"xt", "[", "7", "]"}]}]], "*", 
         RowBox[{"(", 
          RowBox[{"x", "-", 
           RowBox[{"xt", "[", "7", "]"}]}], ")"}]}], "+", 
        RowBox[{"yt", "[", "7", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"tielines", "=", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "@", "0.004"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xt", "[", "1", "]"}], ",", 
               RowBox[{"yt", "[", "1", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xt", "[", "2", "]"}], ",", 
               RowBox[{"yt", "[", "2", "]"}]}], "}"}]}], "}"}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xt", "[", "3", "]"}], ",", 
               RowBox[{"yt", "[", "3", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xt", "[", "4", "]"}], ",", 
               RowBox[{"yt", "[", "4", "]"}]}], "}"}]}], "}"}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xt", "[", "5", "]"}], ",", 
               RowBox[{"yt", "[", "5", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xt", "[", "6", "]"}], ",", 
               RowBox[{"yt", "[", "6", "]"}]}], "}"}]}], "}"}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xt", "[", "7", "]"}], ",", 
               RowBox[{"yt", "[", "7", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xt", "[", "8", "]"}], ",", 
               RowBox[{"yt", "[", "8", "]"}]}], "}"}]}], "}"}], "]"}]}], 
         "}"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"TRY", " ", "CHANGING", " ", "THIS"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"F", "=", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{"{", 
           RowBox[{"500", ",", "1500"}], "}"}], "]"}]}], ";", 
        RowBox[{"S", "=", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{"{", 
           RowBox[{"1500", ",", "2000"}], "}"}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"F", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1000", ",", "1500"}], "}"}], "]"}]}], ";", 
      RowBox[{"S", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1500", ",", "2000"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"F", "=", "feed"}], ";", 
        RowBox[{"S", "=", "solvent"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"M", "=", 
       RowBox[{"F", "+", "S"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"xF", "=", 
         RowBox[{"RandomReal", "[", 
          RowBox[{"{", 
           RowBox[{"0.6", ",", "0.7"}], "}"}], "]"}]}], ";", 
        RowBox[{"yF", "=", 
         RowBox[{"RandomReal", "[", 
          RowBox[{"{", 
           RowBox[{"0.4", ",", "0.45"}], "}"}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"xF", "=", 
         RowBox[{"ptF", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"yF", "=", 
         RowBox[{"ptF", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"xF", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"0.6", ",", "0.7"}], "}"}], "]"}]}], ";", 
      RowBox[{"yF", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"0.4", ",", "0.45"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xRN", "=", 
       RowBox[{"0.99", "*", "x3"}]}], ";", 
      RowBox[{"yRN", "=", 
       RowBox[{"phase", "[", "xRN", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"mixing", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Msol", "=", 
       RowBox[{"Quiet", "@", 
        RowBox[{"First", "@", 
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"wtA", "[", "yF", "]"}], "*", "F"}], "\[Equal]", 
             RowBox[{"xA", "*", "M"}]}], "\[And]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"wtS", "[", 
                RowBox[{"xF", ",", "yF"}], "]"}], "*", "F"}], "+", "S"}], 
             "\[Equal]", 
             RowBox[{"xS", "*", "M"}]}], "\[And]", 
            RowBox[{
             RowBox[{"xA", "+", "xS", "+", "xC"}], "\[Equal]", "1"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"xA", ",", "xS", ",", "xC"}], "}"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xM", "=", 
       RowBox[{"1", "-", 
        RowBox[{"(", 
         RowBox[{"xS", "/.", "Msol"}], ")"}], "-", 
        RowBox[{"yM", "/", 
         SqrtBox["3"]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"yM", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SqrtBox["3"], "/", "2"}], ")"}], "*", "xA"}], "/.", "Msol"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"extract", " ", "1"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xE", "[", "1", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{"Quiet", "@", 
         RowBox[{"First", "@", 
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"phase", "[", "x", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"yRN", "-", "yM"}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{"xRN", "-", "xM"}], ")"}]}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{"x", "-", "xRN"}], ")"}]}], "+", "yRN"}]}], ",", 
            "x"}], "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yE", "[", "1", "]"}], "=", 
       RowBox[{"phase", "[", 
        RowBox[{"xE", "[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"operating", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"xP", "=", 
       RowBox[{"x", "/.", 
        RowBox[{"Quiet", "@", 
         RowBox[{"First", "@", 
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"yF", "-", 
                 RowBox[{"yE", "[", "1", "]"}]}], 
                RowBox[{"xF", "-", 
                 RowBox[{"xE", "[", "1", "]"}]}]], "*", 
               RowBox[{"(", 
                RowBox[{"x", "-", "xF"}], ")"}]}], "+", "yF"}], "\[Equal]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"yRN", "/", "xRN"}], ")"}], "*", "x"}]}], ",", "x"}], 
           "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"yP", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"yRN", "/", "xRN"}], ")"}], "*", "xP"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"operating", "[", 
        RowBox[{"i_", ",", "x_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"yR", "[", "i", "]"}], "-", "yP"}], 
          RowBox[{
           RowBox[{"xR", "[", "i", "]"}], "-", "xP"}]], "*", 
         RowBox[{"(", 
          RowBox[{"x", "-", "xP"}], ")"}]}], "+", "yP"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"lower", "[", 
        RowBox[{"pt_", ",", "x_"}], "]"}], ":=", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pt", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", 
          RowBox[{
           RowBox[{"tie", "[", "1", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", "0", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"tie", "[", "1", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", 
          RowBox[{"pt", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", 
          RowBox[{
           RowBox[{"tie", "[", "2", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"tie", "[", "1", "]"}], "[", "x", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"tie", "[", "2", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", 
          RowBox[{"pt", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", 
          RowBox[{
           RowBox[{"tie", "[", "3", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"tie", "[", "2", "]"}], "[", "x", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"tie", "[", "3", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", 
          RowBox[{"pt", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", 
          RowBox[{
           RowBox[{"tie", "[", "4", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"tie", "[", "3", "]"}], "[", "x", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"tie", "[", "4", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", 
          RowBox[{"pt", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"tie", "[", "4", "]"}], "[", "x", "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"upper", "[", 
        RowBox[{"pt_", ",", "x_"}], "]"}], ":=", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pt", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "<", 
          RowBox[{
           RowBox[{"tie", "[", "1", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"tie", "[", "1", "]"}], "[", "x", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"tie", "[", "1", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", 
          RowBox[{"pt", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", 
          RowBox[{
           RowBox[{"tie", "[", "2", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"tie", "[", "2", "]"}], "[", "x", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"tie", "[", "2", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", 
          RowBox[{"pt", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", 
          RowBox[{
           RowBox[{"tie", "[", "3", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"tie", "[", "3", "]"}], "[", "x", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"tie", "[", "3", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", 
          RowBox[{"pt", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", 
          RowBox[{
           RowBox[{"tie", "[", "4", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"tie", "[", "4", "]"}], "[", "x", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"tie", "[", "4", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", 
          RowBox[{"pt", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"tie", "[", "4", "]"}], "[", "x", "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"lever", "[", "pt_", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pt", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[GreaterEqual]", 
          RowBox[{
           RowBox[{"tie", "[", "4", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", "1", ",", 
         FractionBox[
          RowBox[{
           RowBox[{"pt", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", 
           RowBox[{"upper", "[", 
            RowBox[{"pt", ",", 
             RowBox[{"pt", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], 
          RowBox[{
           RowBox[{"lower", "[", 
            RowBox[{"pt", ",", 
             RowBox[{"pt", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"upper", "[", 
            RowBox[{"pt", ",", 
             RowBox[{"pt", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newtie", "[", 
        RowBox[{"pt_", ",", "x_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"lever", "[", "pt", "]"}], "*", 
         RowBox[{"lower", "[", 
          RowBox[{"pt", ",", "x"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"lever", "[", "pt", "]"}]}], ")"}], "*", 
         RowBox[{"upper", "[", 
          RowBox[{"pt", ",", "x"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xtie", "[", 
        RowBox[{"pt_", ",", "i_"}], "]"}], ":=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"newtie", "[", 
             RowBox[{"pt", ",", "x"}], "]"}], "\[Equal]", 
            RowBox[{"phase", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xR", "[", "1", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"newtie", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xE", "[", "1", "]"}], ",", 
                RowBox[{"yE", "[", "1", "]"}]}], "}"}], ",", "x"}], "]"}], 
            "\[Equal]", 
            RowBox[{"phase", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", 
      RowBox[{
       RowBox[{"yR", "[", "1", "]"}], "=", 
       RowBox[{"phase", "[", 
        RowBox[{"xR", "[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xE", "[", "2", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"operating", "[", 
             RowBox[{"1", ",", "x"}], "]"}], "\[Equal]", 
            RowBox[{"phase", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", 
      RowBox[{
       RowBox[{"yE", "[", "2", "]"}], "=", 
       RowBox[{"phase", "[", 
        RowBox[{"xE", "[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"xR", "[", 
            RowBox[{"#", "-", "1"}], "]"}], "<", "xRN"}], ",", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"xR", "[", "#", "]"}], "=", 
             RowBox[{"x", "/.", 
              RowBox[{
               RowBox[{"Solve", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"newtie", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xE", "[", "#", "]"}], ",", 
                    RowBox[{"yE", "[", "#", "]"}]}], "}"}], ",", "x"}], "]"}],
                   "\[Equal]", 
                  RowBox[{"phase", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], ";", 
            RowBox[{
             RowBox[{"yR", "[", "#", "]"}], "=", 
             RowBox[{"phase", "[", 
              RowBox[{"xR", "[", "#", "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"xE", "[", 
              RowBox[{"#", "+", "1"}], "]"}], "=", 
             RowBox[{"x", "/.", 
              RowBox[{
               RowBox[{"Solve", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"operating", "[", 
                   RowBox[{"#", ",", "x"}], "]"}], "\[Equal]", 
                  RowBox[{"phase", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], ";", 
            RowBox[{
             RowBox[{"yE", "[", 
              RowBox[{"#", "+", "1"}], "]"}], "=", 
             RowBox[{"phase", "[", 
              RowBox[{"xE", "[", 
               RowBox[{"#", "+", "1"}], "]"}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", "}"}]}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"2", ",", "20"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"xR", "[", "#", "]"}], "<", "xRN"}], ",", "0", ",", 
              "#"}], "]"}], "&"}], "/@", 
           RowBox[{"Range", "@", "20"}]}], ",", "0"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xR", "[", "#", "]"}], ",", 
           RowBox[{"yR", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
        RowBox[{"Range", "@", "4"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", "\[Equal]", "8"}], ",", 
        RowBox[{"reset", "=", 
         RowBox[{"reset", "+", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{"base", ",", "tielines", ",", "phaseplot", ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"600", ",", "400"}], "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Row", "@", 
              RowBox[{"{", 
               RowBox[{"n", ",", "\"\< stages\>\"", ",", 
                RowBox[{"Spacer", "@", "10"}], ",", "\"\<F = \>\"", ",", "F", 
                ",", 
                RowBox[{"Spacer", "@", "10"}], ",", "\"\<S = \>\"", ",", "S", 
                ",", 
                RowBox[{"Spacer", "@", "10"}], ",", "\"\<feed = \>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"xF", ",", "yF"}], "}"}]}], "}"}]}], ",", "17", ",", 
             "Black"}], "]"}]}], ","}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"pt2", "[", 
            RowBox[{"ptF", ",", "Black"}], "]"}], ",", 
           RowBox[{"pt2", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"xM", ",", "yM"}], "}"}], ",", "Magenta"}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Red", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xR", "[", "#", "]"}], ",", 
                    RowBox[{"yR", "[", "#", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xE", "[", "#", "]"}], ",", 
                    RowBox[{"yE", "[", "#", "]"}]}], "}"}]}], "}"}], "]"}]}], 
                "}"}], "&"}], "/@", 
              RowBox[{"Range", "@", "n"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pt2", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xR", "[", "#", "]"}], ",", 
                    RowBox[{"yR", "[", "#", "]"}]}], "}"}], ",", "colR"}], 
                  "]"}], ",", 
                 RowBox[{"pt2", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xE", "[", 
                    RowBox[{"#", "+", "1"}], "]"}], ",", 
                    RowBox[{"yE", "[", 
                    RowBox[{"#", "+", "1"}], "]"}]}], "}"}], ",", "colE1"}], 
                  "]"}]}], "}"}], "&"}], "/@", 
              RowBox[{"Range", "@", "n"}]}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Dashed", ",", "colE1", ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"xE", "[", "#", "]"}], ",", 
                    RowBox[{"yE", "[", "#", "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"xR", "[", "#", "]"}], ",", 
                    RowBox[{"yR", "[", "#", "]"}]}], "}"}]}], "}"}], "]"}], 
               ",", "colR", ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"xR", "[", "#", "]"}], ",", 
                    RowBox[{"yR", "[", "#", "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"xE", "[", 
                    RowBox[{"#", "+", "1"}], "]"}], ",", 
                    RowBox[{"yE", "[", 
                    RowBox[{"#", "+", "1"}], "]"}]}], "}"}]}], "}"}], "]"}]}],
               "}"}], "&"}], "/@", 
            RowBox[{"Range", "@", "n"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"pt2", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"xE", "[", "#", "]"}], ",", 
                  RowBox[{"yE", "[", "#", "]"}]}], "}"}], ",", "colE1"}], 
               "]"}], "}"}], "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"2", ",", "n"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"pt2", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"xR", "[", "#", "]"}], ",", 
                  RowBox[{"yR", "[", "#", "]"}]}], "}"}], ",", "colR"}], 
               "]"}], "}"}], "&"}], "/@", 
            RowBox[{"Range", "@", "n"}]}], ","}], "\[IndentingNewLine]", 
          "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Grid", "@", 
    RowBox[{"{", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{"\"\< new problem \>\"", ",", 
         RowBox[{"{", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"reset", "<", "1000"}], ",", 
            RowBox[{"reset", "=", 
             RowBox[{"reset", "+", "1"}]}], ",", 
            RowBox[{"reset", "=", 
             RowBox[{"reset", "-", "1"}]}]}], "]"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"reset", ",", "1"}], "}"}], ",", "1", ",", "1000", ",", 
          "1", ",", "None"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ptF", ",", 
            RowBox[{"{", 
             RowBox[{"0.68", ",", "0.4"}], "}"}]}], "}"}], ",", "Locator", 
          ",", 
          RowBox[{"Appearance", "\[Rule]", "None"}]}], "}"}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"SaveDefinitions", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQLVG07eX5068dm3luvgPRn9lKlC8AaYc9gq4g+s5n
jzgQvWQJWzaIDoo06gTRFv8+TwHRrBUWs0H0NptTYNpMPPfuRSBtJC/1AEQL
7bWb/wlIC9w7sgREt1zyOACi59SuOQiim5gLToDoI4WS10F0KoOo7BcgLXFj
gSKIFl7jpgaiO/1KwDTPGoa/IHraO3HGr0A65GHs+m8ge57cOwWiH4dNuAGi
34Xdug2iV3utvw+i3aTVH4BorwCmpyCayffrcxAt/LP1HVh8s+I3EH1owWHm
70C6jYOPH0RLX0wRBtGeEkWiIPrAhHCVH0B6Qu1xVRC9cseRFhC9Y3ZoG4j+
0JViXX3mtePu2pM2IFprqfKC+UBa7hrDUhANAL462/E=
  "],ExpressionUUID->"a1243796-8b2e-42d5-bc71-f9e1562f1878"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`ptF$$ = {0.68, 0.4}, $CellContext`reset$$ = 
    1, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`reset$$], 1}, 1, 1000, 1}, {{
       Hold[$CellContext`ptF$$], {0.68, 0.4}}, Automatic}, {
      Hold[
       Grid[{{
          Button[" new problem ", {
            
            If[$CellContext`reset$$ < 
             1000, $CellContext`reset$$ = $CellContext`reset$$ + 
              1, $CellContext`reset$$ = $CellContext`reset$$ - 1]}], 
          Manipulate`Place[1], 
          Manipulate`Place[2]}}]], Manipulate`Dump`ThisIsNotAControl}}, 
    Typeset`size$$ = {600., {197., 203.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    False, $CellContext`reset$5624$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`ptF$$ = {0.68, 0.4}, $CellContext`reset$$ = 
        1}, "ControllerVariables" :> {
        Hold[$CellContext`reset$$, $CellContext`reset$5624$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`x1$, $CellContext`y1$, $CellContext`x2$, \
$CellContext`y2$, $CellContext`x3$, $CellContext`y3$, $CellContext`sol$, \
$CellContext`a$, $CellContext`b$, $CellContext`c$, $CellContext`phase$, \
$CellContext`phaseplot$, $CellContext`yt$, $CellContext`xt$, \
$CellContext`tie$, $CellContext`tielines$, $CellContext`F$, $CellContext`S$, \
$CellContext`M$, $CellContext`xF$, $CellContext`yF$, $CellContext`xRN$, \
$CellContext`yRN$, $CellContext`Msol$, $CellContext`xM$, $CellContext`yM$, \
$CellContext`xE$, $CellContext`yE$, $CellContext`xP$, $CellContext`yP$, \
$CellContext`operating$, $CellContext`lower$, $CellContext`upper$, \
$CellContext`lever$, $CellContext`newtie$, $CellContext`xtie$, \
$CellContext`xR$, $CellContext`yR$, $CellContext`n$}, 
        SeedRandom[$CellContext`reset$$]; $CellContext`x1$ = 
         RandomReal[{0.02, 0.15}]; $CellContext`y1$ = 0; $CellContext`x2$ = 
         RandomReal[{0.45, 0.55}]; $CellContext`y2$ = 
         RandomReal[{0.3, 0.4}]; $CellContext`x3$ = 
         RandomReal[{0.85, 0.98}]; $CellContext`y3$ = 0; $CellContext`sol$ = 
         Quiet[
           Part[
            
            Solve[{$CellContext`\[Alpha] $CellContext`x1$^2 + $CellContext`\
\[Beta] $CellContext`x1$ + $CellContext`\[Chi] == $CellContext`y1$, \
$CellContext`\[Alpha] $CellContext`x2$^2 + $CellContext`\[Beta] \
$CellContext`x2$ + $CellContext`\[Chi] == $CellContext`y2$, $CellContext`\
\[Alpha] $CellContext`x3$^2 + $CellContext`\[Beta] $CellContext`x3$ + \
$CellContext`\[Chi] == $CellContext`y3$}, {$CellContext`\[Alpha], \
$CellContext`\[Beta], $CellContext`\[Chi]}], 1]]; $CellContext`a$ = 
         ReplaceAll[$CellContext`\[Alpha], $CellContext`sol$]; \
$CellContext`b$ = 
         ReplaceAll[$CellContext`\[Beta], $CellContext`sol$]; $CellContext`c$ = 
         ReplaceAll[$CellContext`\[Chi], $CellContext`sol$]; \
$CellContext`phase$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`a$ $CellContext`x$^2 + $CellContext`b$ \
$CellContext`x$ + $CellContext`c$; $CellContext`phaseplot$ = Plot[
           $CellContext`phase$[$CellContext`x], {$CellContext`x, \
$CellContext`x1$, $CellContext`x3$}, PlotStyle -> {Thick, Black}, 
           PlotRange -> {{0, 1}, {0, Sqrt[3]/2}}]; $CellContext`yt$[1] = 
         RandomReal[{0.02, 0.05} $CellContext`y2$]; $CellContext`xt$[1] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              1], $CellContext`x], 1]]; $CellContext`yt$[2] = 
         RandomReal[{0.06, 0.1} $CellContext`y2$]; $CellContext`xt$[2] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              2], $CellContext`x], 2]]; $CellContext`tie$[1][
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yt$[2] - $CellContext`yt$[
             1])/($CellContext`xt$[2] - $CellContext`xt$[
            1])) ($CellContext`x$ - $CellContext`xt$[1]) + $CellContext`yt$[
           1]; $CellContext`yt$[3] = 
         RandomReal[{0.15, 0.2} $CellContext`y2$]; $CellContext`xt$[3] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              3], $CellContext`x], 1]]; $CellContext`yt$[4] = 
         RandomReal[{0.25, 0.3} $CellContext`y2$]; $CellContext`xt$[4] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              4], $CellContext`x], 2]]; $CellContext`tie$[2][
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yt$[4] - $CellContext`yt$[
             3])/($CellContext`xt$[4] - $CellContext`xt$[
            3])) ($CellContext`x$ - $CellContext`xt$[3]) + $CellContext`yt$[
           3]; $CellContext`yt$[5] = 
         RandomReal[{0.35, 0.4} $CellContext`y2$]; $CellContext`xt$[5] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              5], $CellContext`x], 1]]; $CellContext`yt$[6] = 
         RandomReal[{0.5, 0.55} $CellContext`y2$]; $CellContext`xt$[6] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              6], $CellContext`x], 2]]; $CellContext`tie$[3][
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yt$[6] - $CellContext`yt$[
             5])/($CellContext`xt$[6] - $CellContext`xt$[
            5])) ($CellContext`x$ - $CellContext`xt$[5]) + $CellContext`yt$[
           5]; $CellContext`yt$[7] = 
         RandomReal[{0.72, 0.77} $CellContext`y2$]; $CellContext`xt$[7] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              7], $CellContext`x], 1]]; $CellContext`yt$[8] = 
         RandomReal[{0.8, 0.9} $CellContext`y2$]; $CellContext`xt$[8] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              8], $CellContext`x], 2]]; $CellContext`tie$[4][
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yt$[8] - $CellContext`yt$[
             7])/($CellContext`xt$[8] - $CellContext`xt$[
            7])) ($CellContext`x$ - $CellContext`xt$[7]) + $CellContext`yt$[
           7]; $CellContext`tielines$ = Graphics[{
            Thickness[0.004], 
            Line[{{
               $CellContext`xt$[1], 
               $CellContext`yt$[1]}, {
               $CellContext`xt$[2], 
               $CellContext`yt$[2]}}], 
            Line[{{
               $CellContext`xt$[3], 
               $CellContext`yt$[3]}, {
               $CellContext`xt$[4], 
               $CellContext`yt$[4]}}], 
            Line[{{
               $CellContext`xt$[5], 
               $CellContext`yt$[5]}, {
               $CellContext`xt$[6], 
               $CellContext`yt$[6]}}], 
            Line[{{
               $CellContext`xt$[7], 
               $CellContext`yt$[7]}, {
               $CellContext`xt$[8], 
               $CellContext`yt$[8]}}]}]; $CellContext`F$ = 
         RandomInteger[{1000, 1500}]; $CellContext`S$ = 
         RandomInteger[{1500, 
           2000}]; $CellContext`M$ = $CellContext`F$ + $CellContext`S$; \
$CellContext`xF$ = RandomReal[{0.6, 0.7}]; $CellContext`yF$ = 
         RandomReal[{0.4, 0.45}]; $CellContext`xRN$ = 
         0.99 $CellContext`x3$; $CellContext`yRN$ = \
$CellContext`phase$[$CellContext`xRN$]; $CellContext`Msol$ = Quiet[
           First[
            Solve[
             
             And[$CellContext`wtA[$CellContext`yF$] $CellContext`F$ == \
$CellContext`xA $CellContext`M$, $CellContext`wtS[$CellContext`xF$, \
$CellContext`yF$] $CellContext`F$ + $CellContext`S$ == $CellContext`xS \
$CellContext`M$, $CellContext`xA + $CellContext`xS + $CellContext`xC == 
              1], {$CellContext`xA, $CellContext`xS, $CellContext`xC}]]]; \
$CellContext`xM$ = 
         1 - ReplaceAll[$CellContext`xS, $CellContext`Msol$] - \
$CellContext`yM$/Sqrt[3]; $CellContext`yM$ = 
         ReplaceAll[(Sqrt[3]/
            2) $CellContext`xA, $CellContext`Msol$]; $CellContext`xE$[1] = 
         ReplaceAll[$CellContext`x, 
           Quiet[
            First[
             
             Solve[$CellContext`phase$[$CellContext`x] == (($CellContext`yRN$ - \
$CellContext`yM$)/($CellContext`xRN$ - $CellContext`xM$)) ($CellContext`x - \
$CellContext`xRN$) + $CellContext`yRN$, $CellContext`x]]]]; $CellContext`yE$[
          1] = $CellContext`phase$[
           $CellContext`xE$[1]]; $CellContext`xP$ = ReplaceAll[$CellContext`x, 
           Quiet[
            First[
             
             Solve[(($CellContext`yF$ - $CellContext`yE$[
                  1])/($CellContext`xF$ - $CellContext`xE$[
                 1])) ($CellContext`x - $CellContext`xF$) + $CellContext`yF$ == \
($CellContext`yRN$/$CellContext`xRN$) $CellContext`x, $CellContext`x]]]]; \
$CellContext`yP$ = ($CellContext`yRN$/$CellContext`xRN$) $CellContext`xP$; \
$CellContext`operating$[
           Pattern[$CellContext`i$, 
            Blank[]], 
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yR$[$CellContext`i$] - \
$CellContext`yP$)/($CellContext`xR$[$CellContext`i$] - $CellContext`xP$)) \
($CellContext`x$ - $CellContext`xP$) + $CellContext`yP$; $CellContext`lower$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Which[Part[$CellContext`pt$, 2] <= $CellContext`tie$[1][
             Part[$CellContext`pt$, 1]], 0, 
           Inequality[
            $CellContext`tie$[1][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[2][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[1][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[2][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[3][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[2][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[3][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[3][$CellContext`x$], $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]] < Part[$CellContext`pt$, 2], 
           $CellContext`tie$[4][$CellContext`x$]]; $CellContext`upper$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Which[Part[$CellContext`pt$, 2] < $CellContext`tie$[1][
             Part[$CellContext`pt$, 1]], 
           $CellContext`tie$[1][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[1][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[2][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[2][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[2][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[3][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[3][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[3][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[4][$CellContext`x$], $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]] < Part[$CellContext`pt$, 2], 
           $CellContext`tie$[4][$CellContext`x$]]; $CellContext`lever$[
           Pattern[$CellContext`pt$, 
            Blank[]]] := If[Part[$CellContext`pt$, 2] >= $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]], 
           1, (Part[$CellContext`pt$, 
              2] - $CellContext`upper$[$CellContext`pt$, 
             
             Part[$CellContext`pt$, 
              1]])/($CellContext`lower$[$CellContext`pt$, 
             
             Part[$CellContext`pt$, 
              1]] - $CellContext`upper$[$CellContext`pt$, 
            Part[$CellContext`pt$, 1]])]; $CellContext`newtie$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`lever$[$CellContext`pt$] \
$CellContext`lower$[$CellContext`pt$, $CellContext`x$] + (
            1 - $CellContext`lever$[$CellContext`pt$]) \
$CellContext`upper$[$CellContext`pt$, $CellContext`x$]; $CellContext`xtie$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`i$, 
            Blank[]]] := ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`newtie$[$CellContext`pt$, $CellContext`x] == \
$CellContext`phase$[$CellContext`x], $CellContext`x], $CellContext`i$]]; \
$CellContext`xR$[1] = ReplaceAll[$CellContext`x, 
           Part[
            Solve[$CellContext`newtie$[{
                $CellContext`xE$[1], 
                $CellContext`yE$[
                1]}, $CellContext`x] == $CellContext`phase$[$CellContext`x], \
$CellContext`x], 2]]; $CellContext`yR$[1] = $CellContext`phase$[
           $CellContext`xR$[1]]; $CellContext`xE$[2] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`operating$[
              1, $CellContext`x] == $CellContext`phase$[$CellContext`x], \
$CellContext`x], 1]]; $CellContext`yE$[2] = $CellContext`phase$[
           $CellContext`xE$[2]]; 
        Map[If[$CellContext`xR$[# - 
             1] < $CellContext`xRN$, {$CellContext`xR$[#] = 
             ReplaceAll[$CellContext`x, 
               Part[
                Solve[$CellContext`newtie$[{
                    $CellContext`xE$[#], 
                    $CellContext`yE$[#]}, $CellContext`x] == \
$CellContext`phase$[$CellContext`x], $CellContext`x], 
                2]]; $CellContext`yR$[#] = $CellContext`phase$[
               $CellContext`xR$[#]]; $CellContext`xE$[# + 1] = 
             ReplaceAll[$CellContext`x, 
               Part[
                
                Solve[$CellContext`operating$[#, $CellContext`x] == \
$CellContext`phase$[$CellContext`x], $CellContext`x], 1]]; $CellContext`yE$[# + 
               1] = $CellContext`phase$[
               $CellContext`xE$[# + 1]]; Null}]& , 
          Range[2, 20]]; $CellContext`n$ = Part[
           DeleteCases[
            Map[If[$CellContext`xR$[#] < $CellContext`xRN$, 0, #]& , 
             Range[20]], 0], 1]; 
        If[$CellContext`n$ == 
          8, $CellContext`reset$$ = $CellContext`reset$$ + 1]; 
        Show[$CellContext`base, $CellContext`tielines$, \
$CellContext`phaseplot$, ImageSize -> {600, 400}, Epilog -> {
            $CellContext`pt2[$CellContext`ptF$$, Black], 
            $CellContext`pt2[{$CellContext`xM$, $CellContext`yM$}, Magenta], 
            Map[{Dashed, $CellContext`colE1, 
              Line[{{
                 $CellContext`xE$[#], 
                 $CellContext`yE$[#]}, {
                 $CellContext`xR$[#], 
                 $CellContext`yR$[#]}}], $CellContext`colR, 
              Line[{{
                 $CellContext`xR$[#], 
                 $CellContext`yR$[#]}, {
                 $CellContext`xE$[# + 1], 
                 $CellContext`yE$[# + 1]}}]}& , 
             Range[$CellContext`n$]], 
            Map[{
              $CellContext`pt2[{
                $CellContext`xE$[#], 
                $CellContext`yE$[#]}, $CellContext`colE1]}& , 
             Range[2, $CellContext`n$]], 
            Map[{
              $CellContext`pt2[{
                $CellContext`xR$[#], 
                $CellContext`yR$[#]}, $CellContext`colR]}& , 
             Range[$CellContext`n$]], Null}]], 
      "Specifications" :> {{{$CellContext`reset$$, 1}, 1, 1000, 1, 
         ControlType -> None, ControlPlacement -> 
         1}, {{$CellContext`ptF$$, {0.68, 0.4}}, Automatic, ControlType -> 
         Locator, Appearance -> None, ControlPlacement -> 2}, 
        Grid[{{
           Button[" new problem ", {
             
             If[$CellContext`reset$$ < 
              1000, $CellContext`reset$$ = $CellContext`reset$$ + 
               1, $CellContext`reset$$ = $CellContext`reset$$ - 1]}], 
           Manipulate`Place[1], 
           Manipulate`Place[2]}}]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{655., {246., 253.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({
      Attributes[PlotRange] = {ReadProtected}, $CellContext`wtA[
         Pattern[$CellContext`y, 
          Blank[]]] := $CellContext`y (2/Sqrt[3]), $CellContext`wtS[
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`y, 
          Blank[]]] := 
       1 - ($CellContext`x + $CellContext`y/Sqrt[3]), $CellContext`base = 
       Graphics[{{
           EdgeForm[
            Thickness[Large]], 
           FaceForm[None], 
           Polygon[{{0, 0}, {0.5, Sqrt[3]/2}, {1, 0}}]}, {{{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.1, 17], {0.05, 0.08660254037844387}, {2.25, 0}], 
             
             Line[{{0.020000000000000004`, 0.08660254037844387}, {0.05, 
              0.08660254037844387}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.9, 17], {0.1, 0}, {-2.25, 0}, {1/2, -1}], 
             Line[{{0.1, 0}, {0.115, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.9, 17], {0.95, 0.08660254037844387}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.95, 0.08660254037844387}, {0.965, 
              0.11258330249197702`}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.2, 17], {0.1, 0.17320508075688773`}, {2.25, 0}], 
             
             Line[{{0.07, 0.17320508075688773`}, {0.1, 
              0.17320508075688773`}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.8, 17], {0.2, 0}, {-2.25, 0}, {1/2, -1}], 
             
             Line[{{0.2, 0}, {
               0.21500000000000002`, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.8, 17], {0.9, 0.17320508075688773`}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.9, 0.17320508075688773`}, {0.915, 
              0.19918584287042088`}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.30000000000000004`, 17], {0.15000000000000002`, 
              0.2598076211353316}, {2.25, 0}], 
             
             Line[{{0.12000000000000002`, 0.2598076211353316}, {
              0.15000000000000002`, 0.2598076211353316}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.7, 17], {0.30000000000000004`, 0}, {-2.25, 0}, {
              1/2, -1}], 
             
             Line[{{0.30000000000000004`, 0}, {
               0.31500000000000006`, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.7, 17], {0.85, 0.2598076211353316}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.85, 0.2598076211353316}, {0.865, 
              0.2857883832488648}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.4, 17], {0.2, 0.34641016151377546`}, {2.25, 0}], 
             
             Line[{{0.17, 0.34641016151377546`}, {0.2, 
              0.34641016151377546`}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.6, 17], {0.4, 0}, {-2.25, 0}, {1/2, -1}], 
             
             Line[{{0.4, 0}, {
               0.41500000000000004`, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.6, 17], {0.8, 0.34641016151377546`}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.8, 0.34641016151377546`}, {0.815, 
              0.37239092362730863`}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.5, 17], {0.25, 0.4330127018922193}, {2.25, 0}], 
             Line[{{0.22, 0.4330127018922193}, {0.25, 0.4330127018922193}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.5, 17], {0.5, 0}, {-2.25, 0}, {1/2, -1}], 
             Line[{{0.5, 0}, {0.515, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.5, 17], {0.75, 0.4330127018922193}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.75, 0.4330127018922193}, {0.765, 
              0.45899346400575247`}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.6, 17], {0.3, 0.5196152422706631}, {2.25, 0}], 
             Line[{{0.27, 0.5196152422706631}, {0.3, 0.5196152422706631}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.4, 17], {0.6, 0}, {-2.25, 0}, {1/2, -1}], 
             Line[{{0.6, 0}, {0.615, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.4, 17], {0.7, 0.5196152422706631}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.7, 0.5196152422706631}, {0.7150000000000001, 
              0.5455960043841963}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.7000000000000001, 17], {0.35000000000000003`, 
              0.6062177826491071}, {2.25, 0}], 
             
             Line[{{0.32000000000000006`, 0.6062177826491071}, {
              0.35000000000000003`, 0.6062177826491071}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.29999999999999993`, 17], {
              0.7000000000000001, 0}, {-2.25, 0}, {1/2, -1}], 
             
             Line[{{0.7000000000000001, 0}, {
               0.7150000000000001, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.29999999999999993`, 17], {0.6499999999999999, 
              0.6062177826491071}, {-2.25, 0}, {1.5, 2}], 
             
             Line[{{0.6499999999999999, 0.6062177826491071}, {0.665, 
              0.6321985447626403}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.8, 17], {0.4, 0.6928203230275509}, {2.25, 0}], 
             Line[{{0.37, 0.6928203230275509}, {0.4, 0.6928203230275509}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.19999999999999996`, 17], {0.8, 0}, {-2.25, 0}, {
              1/2, -1}], 
             Line[{{0.8, 0}, {0.8150000000000001, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.19999999999999996`, 17], {0.6, 
              0.6928203230275509}, {-2.25, 0}, {1.5, 2}], 
             
             Line[{{0.6, 0.6928203230275509}, {0.615, 
              0.7188010851410841}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.9, 17], {0.45, 0.7794228634059948}, {2.25, 0}], 
             
             Line[{{0.42000000000000004`, 0.7794228634059948}, {0.45, 
              0.7794228634059948}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.09999999999999998, 17], {0.9, 0}, {-2.25, 0}, {
              1/2, -1}], 
             Line[{{0.9, 0}, {0.915, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.09999999999999998, 17], {0.55, 
              0.7794228634059948}, {-2.25, 0}, {1.5, 2}], 
             
             Line[{{0.55, 0.7794228634059948}, {0.565, 
              0.8054036255195279}}]}}}, 
          Text[
           Style["solute", 17, 
            RGBColor[0, 0, 1]], {0.5, Sqrt[3]/2}, {0, -1}], 
          Text[
           Style["solvent", 17, 
            RGBColor[1, 0, 0]], {0, 0}, {1, 2}], 
          Text[
           Style["carrier", 17, 
            RGBColor[0, 0.6, 0]], {1, 0}, {-1, 2}]}], $CellContext`pt2[
         Pattern[$CellContext`pt, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]]] := {$CellContext`col, 
         PointSize[0.03], 
         Point[$CellContext`pt]}, $CellContext`colE1 = 
       RGBColor[1, 0.5, 0], $CellContext`colR = 
       RGBColor[0, 0.2666666666666667, 0.4]}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.730735488348609*^9, 3.7307355135630517`*^9}, {
   3.7307355903924456`*^9, 3.7307355988949323`*^9}, 3.730735657198267*^9, {
   3.7307359557743444`*^9, 3.7307359623107185`*^9}, {3.7307362769107122`*^9, 
   3.7307362961898155`*^9}, {3.7307389344567156`*^9, 3.730738946155384*^9}, 
   3.73080596363093*^9, {3.730806030213738*^9, 3.7308060556371922`*^9}, 
   3.730806359533574*^9, 3.730806462245449*^9, 3.7308091413986874`*^9, 
   3.730810889325907*^9, 3.7308134907567005`*^9, 3.730814430279438*^9, {
   3.730814466815528*^9, 3.7308145573757076`*^9}, 3.730814602758303*^9, {
   3.730814672619299*^9, 3.7308146875711546`*^9}, 3.7308147240242395`*^9, {
   3.7308147625044403`*^9, 3.730814787538872*^9}, 3.730814897692172*^9, 
   3.730815098419654*^9, 3.730815149529577*^9, 3.7308173273801427`*^9, 
   3.73081809975532*^9, 3.7310858007327375`*^9, 3.731149018276513*^9, {
   3.7311603239180717`*^9, 3.731160361157202*^9}},
 CellID->7139174,ExpressionUUID->"518d130f-f288-44fc-b568-b5fb5d26b038"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`ptF$$ = {0.68, 0.4}, $CellContext`reset$$ = 
    13, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`reset$$], 1}, 1, 1000, 1}, {{
       Hold[$CellContext`ptF$$], {0.68, 0.4}}, Automatic}, {
      Hold[
       Grid[{{
          Button[" new problem ", 
           
           If[$CellContext`reset$$ < 
            1000, $CellContext`reset$$ = $CellContext`reset$$ + 
             1, $CellContext`reset$$ = $CellContext`reset$$ - 1]], 
          Manipulate`Place[1], 
          Manipulate`Place[2]}}]], Manipulate`Dump`ThisIsNotAControl}}, 
    Typeset`size$$ = {600., {197., 203.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    False, $CellContext`reset$82442$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`ptF$$ = {0.68, 0.4}, $CellContext`reset$$ = 
        1}, "ControllerVariables" :> {
        Hold[$CellContext`reset$$, $CellContext`reset$82442$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`x1$, $CellContext`y1$, $CellContext`x2$, \
$CellContext`y2$, $CellContext`x3$, $CellContext`y3$, $CellContext`sol$, \
$CellContext`a$, $CellContext`b$, $CellContext`c$, $CellContext`phase$, \
$CellContext`phaseplot$, $CellContext`yt$, $CellContext`xt$, \
$CellContext`tie$, $CellContext`tielines$, $CellContext`F$, $CellContext`S$, \
$CellContext`M$, $CellContext`xF$, $CellContext`yF$, $CellContext`xRN$, \
$CellContext`yRN$, $CellContext`Msol$, $CellContext`xM$, $CellContext`yM$, \
$CellContext`xE$, $CellContext`yE$, $CellContext`xP$, $CellContext`yP$, \
$CellContext`operating$, $CellContext`lower$, $CellContext`upper$, \
$CellContext`lever$, $CellContext`newtie$, $CellContext`xtie$, \
$CellContext`xR$, $CellContext`yR$, $CellContext`n$}, 
        SeedRandom[$CellContext`reset$$]; $CellContext`x1$ = 
         RandomReal[{0.02, 0.15}]; $CellContext`y1$ = 0; $CellContext`x2$ = 
         RandomReal[{0.45, 0.55}]; $CellContext`y2$ = 
         RandomReal[{0.3, 0.4}]; $CellContext`x3$ = 
         RandomReal[{0.85, 0.98}]; $CellContext`y3$ = 0; $CellContext`sol$ = 
         Quiet[
           Part[
            
            Solve[{$CellContext`\[Alpha] $CellContext`x1$^2 + $CellContext`\
\[Beta] $CellContext`x1$ + $CellContext`\[Chi] == $CellContext`y1$, \
$CellContext`\[Alpha] $CellContext`x2$^2 + $CellContext`\[Beta] \
$CellContext`x2$ + $CellContext`\[Chi] == $CellContext`y2$, $CellContext`\
\[Alpha] $CellContext`x3$^2 + $CellContext`\[Beta] $CellContext`x3$ + \
$CellContext`\[Chi] == $CellContext`y3$}, {$CellContext`\[Alpha], \
$CellContext`\[Beta], $CellContext`\[Chi]}], 1]]; $CellContext`a$ = 
         ReplaceAll[$CellContext`\[Alpha], $CellContext`sol$]; \
$CellContext`b$ = 
         ReplaceAll[$CellContext`\[Beta], $CellContext`sol$]; $CellContext`c$ = 
         ReplaceAll[$CellContext`\[Chi], $CellContext`sol$]; \
$CellContext`phase$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`a$ $CellContext`x$^2 + $CellContext`b$ \
$CellContext`x$ + $CellContext`c$; $CellContext`phaseplot$ = Plot[
           $CellContext`phase$[$CellContext`x], {$CellContext`x, \
$CellContext`x1$, $CellContext`x3$}, PlotStyle -> {Thick, Black}, 
           PlotRange -> {{0, 1}, {0, Sqrt[3]/2}}]; $CellContext`yt$[1] = 
         RandomReal[{0.02, 0.05} $CellContext`y2$]; $CellContext`xt$[1] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              1], $CellContext`x], 1]]; $CellContext`yt$[2] = 
         RandomReal[{0.06, 0.1} $CellContext`y2$]; $CellContext`xt$[2] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              2], $CellContext`x], 2]]; $CellContext`tie$[1][
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yt$[2] - $CellContext`yt$[
             1])/($CellContext`xt$[2] - $CellContext`xt$[
            1])) ($CellContext`x$ - $CellContext`xt$[1]) + $CellContext`yt$[
           1]; $CellContext`yt$[3] = 
         RandomReal[{0.15, 0.2} $CellContext`y2$]; $CellContext`xt$[3] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              3], $CellContext`x], 1]]; $CellContext`yt$[4] = 
         RandomReal[{0.25, 0.3} $CellContext`y2$]; $CellContext`xt$[4] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              4], $CellContext`x], 2]]; $CellContext`tie$[2][
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yt$[4] - $CellContext`yt$[
             3])/($CellContext`xt$[4] - $CellContext`xt$[
            3])) ($CellContext`x$ - $CellContext`xt$[3]) + $CellContext`yt$[
           3]; $CellContext`yt$[5] = 
         RandomReal[{0.35, 0.4} $CellContext`y2$]; $CellContext`xt$[5] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              5], $CellContext`x], 1]]; $CellContext`yt$[6] = 
         RandomReal[{0.5, 0.55} $CellContext`y2$]; $CellContext`xt$[6] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              6], $CellContext`x], 2]]; $CellContext`tie$[3][
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yt$[6] - $CellContext`yt$[
             5])/($CellContext`xt$[6] - $CellContext`xt$[
            5])) ($CellContext`x$ - $CellContext`xt$[5]) + $CellContext`yt$[
           5]; $CellContext`yt$[7] = 
         RandomReal[{0.72, 0.77} $CellContext`y2$]; $CellContext`xt$[7] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              7], $CellContext`x], 1]]; $CellContext`yt$[8] = 
         RandomReal[{0.8, 0.9} $CellContext`y2$]; $CellContext`xt$[8] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              8], $CellContext`x], 2]]; $CellContext`tie$[4][
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yt$[8] - $CellContext`yt$[
             7])/($CellContext`xt$[8] - $CellContext`xt$[
            7])) ($CellContext`x$ - $CellContext`xt$[7]) + $CellContext`yt$[
           7]; $CellContext`tielines$ = Graphics[{
            Thickness[0.004], 
            Line[{{
               $CellContext`xt$[1], 
               $CellContext`yt$[1]}, {
               $CellContext`xt$[2], 
               $CellContext`yt$[2]}}], 
            Line[{{
               $CellContext`xt$[3], 
               $CellContext`yt$[3]}, {
               $CellContext`xt$[4], 
               $CellContext`yt$[4]}}], 
            Line[{{
               $CellContext`xt$[5], 
               $CellContext`yt$[5]}, {
               $CellContext`xt$[6], 
               $CellContext`yt$[6]}}], 
            Line[{{
               $CellContext`xt$[7], 
               $CellContext`yt$[7]}, {
               $CellContext`xt$[8], 
               $CellContext`yt$[8]}}]}]; $CellContext`F$ = 
         RandomInteger[{1000, 1500}]; $CellContext`S$ = 
         RandomInteger[{1500, 
           2000}]; $CellContext`M$ = $CellContext`F$ + $CellContext`S$; \
$CellContext`xF$ = RandomReal[{0.6, 0.7}]; $CellContext`yF$ = 
         RandomReal[{0.4, 0.45}]; $CellContext`xRN$ = 
         0.99 $CellContext`x3$; $CellContext`yRN$ = \
$CellContext`phase$[$CellContext`xRN$]; $CellContext`Msol$ = Quiet[
           First[
            Solve[
             
             And[$CellContext`wtA[$CellContext`yF$] $CellContext`F$ == \
$CellContext`xA $CellContext`M$, $CellContext`wtS[$CellContext`xF$, \
$CellContext`yF$] $CellContext`F$ + $CellContext`S$ == $CellContext`xS \
$CellContext`M$, $CellContext`xA + $CellContext`xS + $CellContext`xC == 
              1], {$CellContext`xA, $CellContext`xS, $CellContext`xC}]]]; \
$CellContext`xM$ = 
         1 - ReplaceAll[$CellContext`xS, $CellContext`Msol$] - \
$CellContext`yM$/Sqrt[3]; $CellContext`yM$ = 
         ReplaceAll[(Sqrt[3]/
            2) $CellContext`xA, $CellContext`Msol$]; $CellContext`xE$[1] = 
         ReplaceAll[$CellContext`x, 
           Quiet[
            First[
             
             Solve[$CellContext`phase$[$CellContext`x] == (($CellContext`yRN$ - \
$CellContext`yM$)/($CellContext`xRN$ - $CellContext`xM$)) ($CellContext`x - \
$CellContext`xRN$) + $CellContext`yRN$, $CellContext`x]]]]; $CellContext`yE$[
          1] = $CellContext`phase$[
           $CellContext`xE$[1]]; $CellContext`xP$ = ReplaceAll[$CellContext`x, 
           Quiet[
            First[
             
             Solve[(($CellContext`yF$ - $CellContext`yE$[
                  1])/($CellContext`xF$ - $CellContext`xE$[
                 1])) ($CellContext`x - $CellContext`xF$) + $CellContext`yF$ == \
($CellContext`yRN$/$CellContext`xRN$) $CellContext`x, $CellContext`x]]]]; \
$CellContext`yP$ = ($CellContext`yRN$/$CellContext`xRN$) $CellContext`xP$; \
$CellContext`operating$[
           Pattern[$CellContext`i$, 
            Blank[]], 
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yR$[$CellContext`i$] - \
$CellContext`yP$)/($CellContext`xR$[$CellContext`i$] - $CellContext`xP$)) \
($CellContext`x$ - $CellContext`xP$) + $CellContext`yP$; $CellContext`lower$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Which[Part[$CellContext`pt$, 2] <= $CellContext`tie$[1][
             Part[$CellContext`pt$, 1]], 0, 
           Inequality[
            $CellContext`tie$[1][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[2][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[1][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[2][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[3][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[2][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[3][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[3][$CellContext`x$], $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]] < Part[$CellContext`pt$, 2], 
           $CellContext`tie$[4][$CellContext`x$]]; $CellContext`upper$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Which[Part[$CellContext`pt$, 2] < $CellContext`tie$[1][
             Part[$CellContext`pt$, 1]], 
           $CellContext`tie$[1][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[1][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[2][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[2][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[2][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[3][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[3][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[3][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[4][$CellContext`x$], $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]] < Part[$CellContext`pt$, 2], 
           $CellContext`tie$[4][$CellContext`x$]]; $CellContext`lever$[
           Pattern[$CellContext`pt$, 
            Blank[]]] := If[Part[$CellContext`pt$, 2] >= $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]], 
           1, (Part[$CellContext`pt$, 
              2] - $CellContext`upper$[$CellContext`pt$, 
             
             Part[$CellContext`pt$, 
              1]])/($CellContext`lower$[$CellContext`pt$, 
             
             Part[$CellContext`pt$, 
              1]] - $CellContext`upper$[$CellContext`pt$, 
            Part[$CellContext`pt$, 1]])]; $CellContext`newtie$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`lever$[$CellContext`pt$] \
$CellContext`lower$[$CellContext`pt$, $CellContext`x$] + (
            1 - $CellContext`lever$[$CellContext`pt$]) \
$CellContext`upper$[$CellContext`pt$, $CellContext`x$]; $CellContext`xtie$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`i$, 
            Blank[]]] := ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`newtie$[$CellContext`pt$, $CellContext`x] == \
$CellContext`phase$[$CellContext`x], $CellContext`x], $CellContext`i$]]; \
$CellContext`xR$[1] = ReplaceAll[$CellContext`x, 
           Part[
            Solve[$CellContext`newtie$[{
                $CellContext`xE$[1], 
                $CellContext`yE$[
                1]}, $CellContext`x] == $CellContext`phase$[$CellContext`x], \
$CellContext`x], 2]]; $CellContext`yR$[1] = $CellContext`phase$[
           $CellContext`xR$[1]]; $CellContext`xE$[2] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`operating$[
              1, $CellContext`x] == $CellContext`phase$[$CellContext`x], \
$CellContext`x], 1]]; $CellContext`yE$[2] = $CellContext`phase$[
           $CellContext`xE$[2]]; 
        Map[If[$CellContext`xR$[# - 
             1] < $CellContext`xRN$, {$CellContext`xR$[#] = 
             ReplaceAll[$CellContext`x, 
               Part[
                Solve[$CellContext`newtie$[{
                    $CellContext`xE$[#], 
                    $CellContext`yE$[#]}, $CellContext`x] == \
$CellContext`phase$[$CellContext`x], $CellContext`x], 
                2]]; $CellContext`yR$[#] = $CellContext`phase$[
               $CellContext`xR$[#]]; $CellContext`xE$[# + 1] = 
             ReplaceAll[$CellContext`x, 
               Part[
                
                Solve[$CellContext`operating$[#, $CellContext`x] == \
$CellContext`phase$[$CellContext`x], $CellContext`x], 1]]; $CellContext`yE$[# + 
               1] = $CellContext`phase$[
               $CellContext`xE$[# + 1]]; Null}]& , 
          Range[2, 20]]; $CellContext`n$ = Part[
           DeleteCases[
            Map[If[$CellContext`xR$[#] < $CellContext`xRN$, 0, #]& , 
             Range[20]], 0], 1]; 
        Show[$CellContext`base, $CellContext`tielines$, \
$CellContext`phaseplot$, ImageSize -> {600, 400}, PlotLabel -> Style[
            Row[{$CellContext`n$, " stages", 
              Spacer[10], "F = ", $CellContext`F$, 
              Spacer[10], "S = ", $CellContext`S$, 
              Spacer[10], "feed = ", {$CellContext`xF$, $CellContext`yF$}}], 
            17, Black], Epilog -> {
            $CellContext`pt2[$CellContext`ptF$$, Black], 
            $CellContext`pt2[{$CellContext`xM$, $CellContext`yM$}, Magenta], 
            Map[{Dashed, $CellContext`colE1, 
              Line[{{
                 $CellContext`xE$[#], 
                 $CellContext`yE$[#]}, {
                 $CellContext`xR$[#], 
                 $CellContext`yR$[#]}}], $CellContext`colR, 
              Line[{{
                 $CellContext`xR$[#], 
                 $CellContext`yR$[#]}, {
                 $CellContext`xE$[# + 1], 
                 $CellContext`yE$[# + 1]}}]}& , 
             Range[$CellContext`n$]], 
            Map[{
              $CellContext`pt2[{
                $CellContext`xE$[#], 
                $CellContext`yE$[#]}, $CellContext`colE1]}& , 
             Range[2, $CellContext`n$]], 
            Map[{
              $CellContext`pt2[{
                $CellContext`xR$[#], 
                $CellContext`yR$[#]}, $CellContext`colR]}& , 
             Range[$CellContext`n$]], Null}]], 
      "Specifications" :> {{{$CellContext`reset$$, 1}, 1, 1000, 1, 
         ControlType -> None, ControlPlacement -> 
         1}, {{$CellContext`ptF$$, {0.68, 0.4}}, Automatic, ControlType -> 
         Locator, Appearance -> None, ControlPlacement -> 2}, 
        Grid[{{
           Button[" new problem ", 
            
            If[$CellContext`reset$$ < 
             1000, $CellContext`reset$$ = $CellContext`reset$$ + 
              1, $CellContext`reset$$ = $CellContext`reset$$ - 1]], 
           Manipulate`Place[1], 
           Manipulate`Place[2]}}]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{655., {246., 253.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`wtA[
         Pattern[$CellContext`y, 
          Blank[]]] := $CellContext`y (2/Sqrt[3]), $CellContext`wtS[
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`y, 
          Blank[]]] := 
       1 - ($CellContext`x + $CellContext`y/Sqrt[3]), $CellContext`base = 
       Graphics[{{
           EdgeForm[
            Thickness[Large]], 
           FaceForm[None], 
           Polygon[{{0, 0}, {0.5, Sqrt[3]/2}, {1, 0}}]}, {{{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.1, 17], {0.05, 0.08660254037844387}, {2.25, 0}], 
             
             Line[{{0.020000000000000004`, 0.08660254037844387}, {0.05, 
              0.08660254037844387}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.9, 17], {0.1, 0}, {-2.25, 0}, {1/2, -1}], 
             Line[{{0.1, 0}, {0.115, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.9, 17], {0.95, 0.08660254037844387}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.95, 0.08660254037844387}, {0.965, 
              0.11258330249197702`}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.2, 17], {0.1, 0.17320508075688773`}, {2.25, 0}], 
             
             Line[{{0.07, 0.17320508075688773`}, {0.1, 
              0.17320508075688773`}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.8, 17], {0.2, 0}, {-2.25, 0}, {1/2, -1}], 
             
             Line[{{0.2, 0}, {
               0.21500000000000002`, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.8, 17], {0.9, 0.17320508075688773`}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.9, 0.17320508075688773`}, {0.915, 
              0.19918584287042088`}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.30000000000000004`, 17], {0.15000000000000002`, 
              0.2598076211353316}, {2.25, 0}], 
             
             Line[{{0.12000000000000002`, 0.2598076211353316}, {
              0.15000000000000002`, 0.2598076211353316}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.7, 17], {0.30000000000000004`, 0}, {-2.25, 0}, {
              1/2, -1}], 
             
             Line[{{0.30000000000000004`, 0}, {
               0.31500000000000006`, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.7, 17], {0.85, 0.2598076211353316}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.85, 0.2598076211353316}, {0.865, 
              0.2857883832488648}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.4, 17], {0.2, 0.34641016151377546`}, {2.25, 0}], 
             
             Line[{{0.17, 0.34641016151377546`}, {0.2, 
              0.34641016151377546`}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.6, 17], {0.4, 0}, {-2.25, 0}, {1/2, -1}], 
             
             Line[{{0.4, 0}, {
               0.41500000000000004`, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.6, 17], {0.8, 0.34641016151377546`}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.8, 0.34641016151377546`}, {0.815, 
              0.37239092362730863`}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.5, 17], {0.25, 0.4330127018922193}, {2.25, 0}], 
             Line[{{0.22, 0.4330127018922193}, {0.25, 0.4330127018922193}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.5, 17], {0.5, 0}, {-2.25, 0}, {1/2, -1}], 
             Line[{{0.5, 0}, {0.515, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.5, 17], {0.75, 0.4330127018922193}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.75, 0.4330127018922193}, {0.765, 
              0.45899346400575247`}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.6, 17], {0.3, 0.5196152422706631}, {2.25, 0}], 
             Line[{{0.27, 0.5196152422706631}, {0.3, 0.5196152422706631}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.4, 17], {0.6, 0}, {-2.25, 0}, {1/2, -1}], 
             Line[{{0.6, 0}, {0.615, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.4, 17], {0.7, 0.5196152422706631}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.7, 0.5196152422706631}, {0.7150000000000001, 
              0.5455960043841963}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.7000000000000001, 17], {0.35000000000000003`, 
              0.6062177826491071}, {2.25, 0}], 
             
             Line[{{0.32000000000000006`, 0.6062177826491071}, {
              0.35000000000000003`, 0.6062177826491071}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.29999999999999993`, 17], {
              0.7000000000000001, 0}, {-2.25, 0}, {1/2, -1}], 
             
             Line[{{0.7000000000000001, 0}, {
               0.7150000000000001, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.29999999999999993`, 17], {0.6499999999999999, 
              0.6062177826491071}, {-2.25, 0}, {1.5, 2}], 
             
             Line[{{0.6499999999999999, 0.6062177826491071}, {0.665, 
              0.6321985447626403}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.8, 17], {0.4, 0.6928203230275509}, {2.25, 0}], 
             Line[{{0.37, 0.6928203230275509}, {0.4, 0.6928203230275509}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.19999999999999996`, 17], {0.8, 0}, {-2.25, 0}, {
              1/2, -1}], 
             Line[{{0.8, 0}, {0.8150000000000001, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.19999999999999996`, 17], {0.6, 
              0.6928203230275509}, {-2.25, 0}, {1.5, 2}], 
             
             Line[{{0.6, 0.6928203230275509}, {0.615, 
              0.7188010851410841}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.9, 17], {0.45, 0.7794228634059948}, {2.25, 0}], 
             Line[{{0.42000000000000004`, 0.7794228634059948}, {0.45, 
              0.7794228634059948}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.09999999999999998, 17], {0.9, 0}, {-2.25, 0}, {
              1/2, -1}], 
             Line[{{0.9, 0}, {0.915, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.09999999999999998, 17], {0.55, 
              0.7794228634059948}, {-2.25, 0}, {1.5, 2}], 
             
             Line[{{0.55, 0.7794228634059948}, {0.565, 
              0.8054036255195279}}]}}}, 
          Text[
           Style["solute", 17, 
            RGBColor[0, 0, 1]], {0.5, Sqrt[3]/2}, {0, -1}], 
          Text[
           Style["solvent", 17, 
            RGBColor[1, 0, 0]], {0, 0}, {1, 2}], 
          Text[
           Style["carrier", 17, 
            RGBColor[0, 0.6, 0]], {1, 0}, {-1, 2}]}], $CellContext`pt2[
         Pattern[$CellContext`pt, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]]] := {$CellContext`col, 
         PointSize[0.03], 
         Point[$CellContext`pt]}, $CellContext`colE1 = 
       RGBColor[1, 0.5, 0], $CellContext`colR = 
       RGBColor[0, 0.2666666666666667, 0.4]}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Input",
 CellID->480277556,ExpressionUUID->"4c9cdbaf-de5b-4206-b525-9805b211e633"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"F", "=", 
     RowBox[{"RandomInteger", "[", 
      RowBox[{"{", 
       RowBox[{"1000", ",", "2000"}], "}"}], "]"}]}], ";", 
    RowBox[{"S", "=", 
     RowBox[{"RandomInteger", "[", 
      RowBox[{"{", 
       RowBox[{"1500", ",", "2000"}], "}"}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellID->41632623,ExpressionUUID->"f5badb6f-6e0b-4c97-aae5-e07e8f550763"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xR", "[", "1", "]"}], "<", "xRN"}], ",", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"xR", "[", "2", "]"}], "=", 
        RowBox[{"x", "/.", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"newtie", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xE", "[", "2", "]"}], ",", 
                 RowBox[{"yE", "[", "2", "]"}]}], "}"}], ",", "x"}], "]"}], 
             "\[Equal]", 
             RowBox[{"phase", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ";", 
       RowBox[{
        RowBox[{"yR", "[", "2", "]"}], "=", 
        RowBox[{"phase", "[", 
         RowBox[{"xR", "[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xE", "[", "3", "]"}], "=", 
        RowBox[{"x", "/.", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"operating", "[", 
              RowBox[{"2", ",", "x"}], "]"}], "\[Equal]", 
             RowBox[{"phase", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", 
       RowBox[{
        RowBox[{"yE", "[", "3", "]"}], "=", 
        RowBox[{"phase", "[", 
         RowBox[{"xE", "[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]",
       "}"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xR", "[", "2", "]"}], "<", "xRN"}], ",", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"xR", "[", "3", "]"}], "=", 
        RowBox[{"x", "/.", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"newtie", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xE", "[", "3", "]"}], ",", 
                 RowBox[{"yE", "[", "3", "]"}]}], "}"}], ",", "x"}], "]"}], 
             "\[Equal]", 
             RowBox[{"phase", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ";", 
       RowBox[{
        RowBox[{"yR", "[", "3", "]"}], "=", 
        RowBox[{"phase", "[", 
         RowBox[{"xR", "[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xE", "[", "4", "]"}], "=", 
        RowBox[{"x", "/.", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"operating", "[", 
              RowBox[{"3", ",", "x"}], "]"}], "\[Equal]", 
             RowBox[{"phase", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", 
       RowBox[{
        RowBox[{"yE", "[", "4", "]"}], "=", 
        RowBox[{"phase", "[", 
         RowBox[{"xE", "[", "4", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]",
       "}"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xR", "[", "3", "]"}], "<", "xRN"}], ",", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"xR", "[", "4", "]"}], "=", 
        RowBox[{"x", "/.", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"newtie", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xE", "[", "4", "]"}], ",", 
                 RowBox[{"yE", "[", "4", "]"}]}], "}"}], ",", "x"}], "]"}], 
             "\[Equal]", 
             RowBox[{"phase", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ";", 
       RowBox[{
        RowBox[{"yR", "[", "4", "]"}], "=", 
        RowBox[{"phase", "[", 
         RowBox[{"xR", "[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xE", "[", "5", "]"}], "=", 
        RowBox[{"x", "/.", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"operating", "[", 
              RowBox[{"4", ",", "x"}], "]"}], "\[Equal]", 
             RowBox[{"phase", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", 
       RowBox[{
        RowBox[{"yE", "[", "5", "]"}], "=", 
        RowBox[{"phase", "[", 
         RowBox[{"xE", "[", "5", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]",
       "}"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xR", "[", "4", "]"}], "<", "xRN"}], ",", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"xR", "[", "5", "]"}], "=", 
        RowBox[{"x", "/.", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"newtie", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xE", "[", "5", "]"}], ",", 
                 RowBox[{"yE", "[", "5", "]"}]}], "}"}], ",", "x"}], "]"}], 
             "\[Equal]", 
             RowBox[{"phase", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ";", 
       RowBox[{
        RowBox[{"yR", "[", "5", "]"}], "=", 
        RowBox[{"phase", "[", 
         RowBox[{"xR", "[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xE", "[", "6", "]"}], "=", 
        RowBox[{"x", "/.", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"operating", "[", 
              RowBox[{"5", ",", "x"}], "]"}], "\[Equal]", 
             RowBox[{"phase", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", 
       RowBox[{
        RowBox[{"yE", "[", "6", "]"}], "=", 
        RowBox[{"phase", "[", 
         RowBox[{"xE", "[", "6", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]",
       "}"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xR", "[", "5", "]"}], "<", "xRN"}], ",", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"xR", "[", "6", "]"}], "=", 
        RowBox[{"x", "/.", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"newtie", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xE", "[", "6", "]"}], ",", 
                 RowBox[{"yE", "[", "6", "]"}]}], "}"}], ",", "x"}], "]"}], 
             "\[Equal]", 
             RowBox[{"phase", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ";", 
       RowBox[{
        RowBox[{"yR", "[", "6", "]"}], "=", 
        RowBox[{"phase", "[", 
         RowBox[{"xR", "[", "6", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xE", "[", "7", "]"}], "=", 
        RowBox[{"x", "/.", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"operating", "[", 
              RowBox[{"6", ",", "x"}], "]"}], "\[Equal]", 
             RowBox[{"phase", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", 
       RowBox[{
        RowBox[{"yE", "[", "7", "]"}], "=", 
        RowBox[{"phase", "[", 
         RowBox[{"xE", "[", "7", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]",
       "}"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xR", "[", "6", "]"}], "<", "xRN"}], ",", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"xR", "[", "7", "]"}], "=", 
        RowBox[{"x", "/.", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"newtie", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xE", "[", "7", "]"}], ",", 
                 RowBox[{"yE", "[", "7", "]"}]}], "}"}], ",", "x"}], "]"}], 
             "\[Equal]", 
             RowBox[{"phase", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ";", 
       RowBox[{
        RowBox[{"yR", "[", "7", "]"}], "=", 
        RowBox[{"phase", "[", 
         RowBox[{"xR", "[", "7", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xE", "[", "8", "]"}], "=", 
        RowBox[{"x", "/.", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"operating", "[", 
              RowBox[{"7", ",", "x"}], "]"}], "\[Equal]", 
             RowBox[{"phase", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", 
       RowBox[{
        RowBox[{"yE", "[", "8", "]"}], "=", 
        RowBox[{"phase", "[", 
         RowBox[{"xE", "[", "8", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]",
       "}"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xR", "[", "7", "]"}], "<", "xRN"}], ",", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"xR", "[", "8", "]"}], "=", 
        RowBox[{"x", "/.", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"newtie", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xE", "[", "8", "]"}], ",", 
                 RowBox[{"yE", "[", "8", "]"}]}], "}"}], ",", "x"}], "]"}], 
             "\[Equal]", 
             RowBox[{"phase", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ";", 
       RowBox[{
        RowBox[{"yR", "[", "8", "]"}], "=", 
        RowBox[{"phase", "[", 
         RowBox[{"xR", "[", "8", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xE", "[", "9", "]"}], "=", 
        RowBox[{"x", "/.", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"operating", "[", 
              RowBox[{"8", ",", "x"}], "]"}], "\[Equal]", 
             RowBox[{"phase", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", 
       RowBox[{
        RowBox[{"yE", "[", "9", "]"}], "=", 
        RowBox[{"phase", "[", 
         RowBox[{"xE", "[", "9", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]",
       "}"}]}], "]"}], ";"}], "*)"}]], "Input",
 CellID->10951115,ExpressionUUID->"342f755a-afff-487f-a74e-6b2aff50846a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ManipulateCaptionSection",ExpressionUUID->"bc57e95c-3611-4c38-84c4-1326750ececc"],

Cell["XXXX", "ManipulateCaption",ExpressionUUID->"24caef0b-8f1e-4b63-841d-97ac35dfe5fb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ThumbnailSection",ExpressionUUID->"308cffc6-b479-417e-b239-45839f5b2da2"],

Cell[BoxData[
 GraphicsBox[
  {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], RectangleBox[{0, 0}], 
   InsetBox[
    StyleBox["\<\"Thumbnail Placeholder\"\>",
     StripOnInput->False,
     FontFamily->"Verdana",
     FontSize->14], {0.5, 0.6}], InsetBox[
    StyleBox["\<\"Replace this with your\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.45}], InsetBox[
    StyleBox["\<\"Manipulate at a particular setting.\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.39}], InsetBox[
    StyleBox["\<\"(Do not use a bitmap.)\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.315}]},
  ImageMargins->0.,
  ImageSize->220]], "Output",
 CellEditDuplicate->
  False,ExpressionUUID->"c300072d-3491-4a12-bc27-88502d55788c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SnapshotsSection",ExpressionUUID->"4646149a-b18b-4b2f-9d0c-831fb8f1688b"],

Cell[BoxData[
 GraphicsBox[
  {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], RectangleBox[{0, 0}], 
   InsetBox[
    StyleBox["\<\"Snapshot Placeholder\"\>",
     StripOnInput->False,
     FontFamily->"Verdana",
     FontSize->14], {0.5, 0.6}], InsetBox[
    StyleBox["\<\"Replace this with your\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.45}], InsetBox[
    StyleBox["\<\"Manipulate at a particular setting.\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.39}], InsetBox[
    StyleBox["\<\"(Do not use a bitmap.)\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.315}]},
  ImageMargins->0.,
  ImageSize->220]], "Output",
 CellEditDuplicate->
  False,ExpressionUUID->"12e8adb3-bc31-41ef-82a8-f1bd7df4dbb2"]
}, Open  ]],

Cell["", "DetailsSection",ExpressionUUID->"b830f491-1178-4fce-9f34-dc1622943ab0"],

Cell[CellGroupData[{

Cell["", "ControlSuggestionsSection",ExpressionUUID->"871f9c54-a831-4580-9403-63bb8bffbdfc"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Resize Images",ExpressionUUID->"c0f6df7e-d3e4-4ed3-87a4-c0bb0f6a0bc6"]}],
  "\"Click inside an image to reveal its orange resize frame.\\nDrag any of \
the orange resize handles to resize the image.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->
  "ResizeImages",ExpressionUUID->"038d9390-5832-48a6-831f-ccb29fc17d40"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Rotate and Zoom in 3D",ExpressionUUID->
    "ba0a9301-c6a3-4045-850d-4ac1e6dd303a"]}],
  RowBox[{
   "\"Drag a 3D graphic to rotate it. Starting the drag near the center \
tumbles\\nthe graphic; starting near a corner turns it parallel to the plane \
of the screen.\\nHold down \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" (or \"", 
    FrameBox[
    "Cmd", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" on Mac) and drag up and down to zoom.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->
  "RotateAndZoomIn3D",ExpressionUUID->"971905f9-eea1-485b-90ee-1c1f3f301611"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Drag Locators",ExpressionUUID->"60419373-907b-46ce-aa8f-93e40eb744bc"]}],
  RowBox[{"\"Drag any locator (\"", 
    GraphicsBox[
     LocatorBox[
      Scaled[{0.5, 0.5}]], ImageSize -> 20], 
    "\", etc.) to move it around.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->
  "DragLocators",ExpressionUUID->"d6b96b67-2524-4230-a9f7-1a5ed3fc3de2"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Create and Delete Locators",ExpressionUUID->
    "c287ce5f-0ec7-4cb2-9fe4-89ec51a3cf70"]}],
  RowBox[{"\"Insert a new locator in the graphic by holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key\\nand clicking where you want it to be. Delete a locator by \
clicking it\\nwhile holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" key.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->
  "CreateAndDeleteLocators",ExpressionUUID->"b7cdee8c-7961-439c-99cd-\
89db3e4a7813"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Slider Zoom",ExpressionUUID->"2451609d-e1cc-484d-a76e-040f030efb04"]}],
  RowBox[{"\"Hold down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key while moving a slider to make fine adjustments in the slider \
value.\\nHold \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" and/or \"", 
    FrameBox[
    "Shift", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" at the same time as \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" to make ever finer adjustments.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->
  "SliderZoom",ExpressionUUID->"a2a50848-d1f2-453a-986b-2839d58c3206"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Gamepad Controls",ExpressionUUID->
    "c3db65e2-6f8c-4a1f-8ab7-e64e1aa444fd"]}],
  "\"Control this Demonstration with a gamepad or other\\nhuman interface \
device connected to your computer.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.35696210375764*^9, 3.3895522232313623`*^9},
 FontFamily->"Verdana",
 CellTags->
  "GamepadControls",ExpressionUUID->"b800c76b-66be-460d-bf28-34900b673e07"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Automatic Animation",ExpressionUUID->
    "5f19657b-7340-48da-a26a-34e9276cd17e"]}],
  RowBox[{"\"Animate a slider in this Demonstration by clicking the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJzzTSzJSM1NLMlMTlRwL0osyMhMLlZwyy8CCjEzMjAwcIKwAgOI/R/IhBKc\n\
/4EAyGAG0f+nTZsGwgysIJIRKsWKLAXGIHFmEpUgLADxWUAkI24jZs+eTaEt\n\
IG+wQKRmzJgBlYf5lhEA30OqWA=="], "Graphics", ImageSize -> {9, 9}, ImageMargins -> 
      0, CellBaseline -> Baseline], BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"button\\nnext to the slider, and then clicking the play button that \
appears.\\nAnimate all controls by selecting \"", 
    StyleBox["Autorun", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->
  "AutomaticAnimation",ExpressionUUID->"d8ca7348-c53b-4b6e-909a-6537bf9da271"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Bookmark Animation",ExpressionUUID->
    "acafd16e-3f0f-4ad2-a881-a8b7f1376233"]}],
  RowBox[{
   "\"See a prepared animation of this Demonstration by selecting\\n\"", 
    StyleBox["Animate Bookmarks", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->
  "BookmarkAnimation",ExpressionUUID->"c531e1cc-1b9c-4af6-9d49-863224ad3483"]
}, Open  ]],

Cell["", "SearchTermsSection",ExpressionUUID->"90da0b0d-9dd0-46d2-bed4-90db798ef784"],

Cell["", "RelatedLinksSection",ExpressionUUID->"d253f5f1-2c28-4a91-91ad-56911d8b17c6"],

Cell[CellGroupData[{

Cell["", "AuthorSection",ExpressionUUID->"3813b47e-cce6-46e4-ab8f-c4c580e5eb60"],

Cell["Contributed by: XXXX", "Author",ExpressionUUID->"a88878a5-e0b6-4002-bc12-d2c82a5cd16c"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1366, 686},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "Demonstration.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "ResizeImages"->{
  Cell[116033, 2860, 429, 10, 70, "ControlSuggestions",ExpressionUUID->"ed6c3131-4f1e-46a9-b5a9-1ea3b8a0d95b",
   CellTags->"ResizeImages"]},
 "RotateAndZoomIn3D"->{
  Cell[116465, 2872, 800, 19, 70, "ControlSuggestions",ExpressionUUID->"52655f78-0c0f-487e-847d-9360414e6b13",
   CellTags->"RotateAndZoomIn3D"]},
 "DragLocators"->{
  Cell[117268, 2893, 457, 13, 70, "ControlSuggestions",ExpressionUUID->"bd7546a7-8016-482e-9de0-aa56c7b31cda",
   CellTags->"DragLocators"]},
 "CreateAndDeleteLocators"->{
  Cell[117728, 2908, 761, 19, 70, "ControlSuggestions",ExpressionUUID->"ddf3d451-0714-417a-b627-22944846acac",
   CellTags->"CreateAndDeleteLocators"]},
 "SliderZoom"->{
  Cell[118492, 2929, 961, 23, 70, "ControlSuggestions",ExpressionUUID->"713a3590-3a74-4573-a53e-1ad2bade340a",
   CellTags->"SliderZoom"]},
 "GamepadControls"->{
  Cell[119456, 2954, 491, 12, 70, "ControlSuggestions",ExpressionUUID->"e92b3717-6906-4fbe-b5bf-1260290860a4",
   CellTags->"GamepadControls"]},
 "AutomaticAnimation"->{
  Cell[119950, 2968, 1586, 34, 70, "ControlSuggestions",ExpressionUUID->"6ac691dc-7418-4aac-86c5-009031a888fc",
   CellTags->"AutomaticAnimation"]},
 "BookmarkAnimation"->{
  Cell[121539, 3004, 1030, 24, 70, "ControlSuggestions",ExpressionUUID->"b9c06bd7-6940-421b-b94d-ac228df16024",
   CellTags->"BookmarkAnimation"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"ResizeImages", 123360, 3054},
 {"RotateAndZoomIn3D", 123526, 3057},
 {"DragLocators", 123692, 3060},
 {"CreateAndDeleteLocators", 123864, 3063},
 {"SliderZoom", 124034, 3066},
 {"GamepadControls", 124196, 3069},
 {"AutomaticAnimation", 124366, 3072},
 {"BookmarkAnimation", 124539, 3075}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 91, 0, 74, "DemoTitle",ExpressionUUID->"9bb0136e-bd2b-4252-abe7-cd2de591f205"],
Cell[CellGroupData[{
Cell[696, 26, 88, 0, 275, "InitializationSection",ExpressionUUID->"8720b812-cebf-46c8-b093-c4f57cd0a2bd"],
Cell[787, 28, 7344, 183, 308, "Input",ExpressionUUID->"a39c573c-1b0d-47b2-b5b8-628a36cf1482",
 InitializationCell->True,
 CellID->922119689],
Cell[8134, 213, 266, 8, 44, "Input",ExpressionUUID->"9ffbd960-f934-4fdc-9276-c0013bbc7eef",
 InitializationCell->True,
 CellID->218799681],
Cell[8403, 223, 346, 11, 44, "Input",ExpressionUUID->"e0e33c9d-d66c-405e-86e9-5afa471be80f",
 InitializationCell->True,
 CellID->40409647],
Cell[8752, 236, 547, 14, 52, "Input",ExpressionUUID->"ac7f950d-7295-401d-bae3-b3bfec3b0b05",
 InitializationCell->True,
 CellID->707626315],
Cell[9302, 252, 789, 17, 33, "Input",ExpressionUUID->"4bb68663-9430-4292-a77f-e9d533b164c8",
 InitializationCell->True,
 CellID->94651572],
Cell[10094, 271, 607, 14, 33, "Input",ExpressionUUID->"6f16323a-ebb8-4f0d-af72-d4218e76e10b",
 InitializationCell->True,
 CellID->254988361]
}, Open  ]],
Cell[CellGroupData[{
Cell[10738, 290, 84, 0, 231, "ManipulateSection",ExpressionUUID->"aedeb511-43c5-4fc2-bbc4-0923640c2b0b"],
Cell[CellGroupData[{
Cell[10847, 294, 37557, 985, 2263, "Input",ExpressionUUID->"a1243796-8b2e-42d5-bc71-f9e1562f1878"],
Cell[48407, 1281, 26834, 587, 511, "Output",ExpressionUUID->"518d130f-f288-44fc-b568-b5fb5d26b038",
 CellID->7139174]
}, Open  ]],
Cell[75256, 1871, 26005, 575, 512, "Input",ExpressionUUID->"4c9cdbaf-de5b-4206-b525-9805b211e633",
 CellID->480277556],
Cell[101264, 2448, 451, 13, 44, "Input",ExpressionUUID->"f5badb6f-6e0b-4c97-aae5-e07e8f550763",
 CellID->41632623],
Cell[101718, 2463, 11035, 297, 872, "Input",ExpressionUUID->"342f755a-afff-487f-a74e-6b2aff50846a",
 CellID->10951115]
}, Open  ]],
Cell[CellGroupData[{
Cell[112790, 2765, 91, 0, 169, "ManipulateCaptionSection",ExpressionUUID->"bc57e95c-3611-4c38-84c4-1326750ececc"],
Cell[112884, 2767, 88, 0, 22, "ManipulateCaption",ExpressionUUID->"24caef0b-8f1e-4b63-841d-97ac35dfe5fb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113009, 2772, 83, 0, 172, "ThumbnailSection",ExpressionUUID->"308cffc6-b479-417e-b239-45839f5b2da2"],
Cell[113095, 2774, 1300, 35, 230, "Output",ExpressionUUID->"c300072d-3491-4a12-bc27-88502d55788c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[114432, 2814, 83, 0, 142, "SnapshotsSection",ExpressionUUID->"4646149a-b18b-4b2f-9d0c-831fb8f1688b"],
Cell[114518, 2816, 1299, 35, 230, "Output",ExpressionUUID->"12e8adb3-bc31-41ef-82a8-f1bd7df4dbb2"]
}, Open  ]],
Cell[115832, 2854, 81, 0, 70, "DetailsSection",ExpressionUUID->"981e82c6-7fe2-4729-a39a-ff8c1c575654"],
Cell[CellGroupData[{
Cell[115938, 2858, 92, 0, 70, "ControlSuggestionsSection",ExpressionUUID->"0871d472-9349-4815-9500-60d21461b38a"],
Cell[116033, 2860, 429, 10, 70, "ControlSuggestions",ExpressionUUID->"ed6c3131-4f1e-46a9-b5a9-1ea3b8a0d95b",
 CellTags->"ResizeImages"],
Cell[116465, 2872, 800, 19, 70, "ControlSuggestions",ExpressionUUID->"52655f78-0c0f-487e-847d-9360414e6b13",
 CellTags->"RotateAndZoomIn3D"],
Cell[117268, 2893, 457, 13, 70, "ControlSuggestions",ExpressionUUID->"bd7546a7-8016-482e-9de0-aa56c7b31cda",
 CellTags->"DragLocators"],
Cell[117728, 2908, 761, 19, 70, "ControlSuggestions",ExpressionUUID->"ddf3d451-0714-417a-b627-22944846acac",
 CellTags->"CreateAndDeleteLocators"],
Cell[118492, 2929, 961, 23, 70, "ControlSuggestions",ExpressionUUID->"713a3590-3a74-4573-a53e-1ad2bade340a",
 CellTags->"SliderZoom"],
Cell[119456, 2954, 491, 12, 70, "ControlSuggestions",ExpressionUUID->"e92b3717-6906-4fbe-b5bf-1260290860a4",
 CellTags->"GamepadControls"],
Cell[119950, 2968, 1586, 34, 70, "ControlSuggestions",ExpressionUUID->"6ac691dc-7418-4aac-86c5-009031a888fc",
 CellTags->"AutomaticAnimation"],
Cell[121539, 3004, 1030, 24, 70, "ControlSuggestions",ExpressionUUID->"b9c06bd7-6940-421b-b94d-ac228df16024",
 CellTags->"BookmarkAnimation"]
}, Open  ]],
Cell[122584, 3031, 85, 0, 70, "SearchTermsSection",ExpressionUUID->"a4a5f810-f1f1-4185-b6dd-232ba63318db"],
Cell[122672, 3033, 86, 0, 70, "RelatedLinksSection",ExpressionUUID->"00228134-394f-4040-a773-20dcb4223eee"],
Cell[CellGroupData[{
Cell[122783, 3037, 80, 0, 70, "AuthorSection",ExpressionUUID->"235efd4d-40f6-4a8b-836b-f1c8cd125965"],
Cell[122866, 3039, 93, 0, 70, "Author",ExpressionUUID->"07e95b9a-72e6-4625-8322-b43f1240a5a7"]
}, Open  ]]
}, Open  ]]
}
]
*)

