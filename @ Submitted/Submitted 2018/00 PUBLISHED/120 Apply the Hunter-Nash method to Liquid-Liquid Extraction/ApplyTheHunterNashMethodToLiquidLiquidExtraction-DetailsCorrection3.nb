(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='WolframCDFPlayer 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       163,          7]
NotebookDataLength[    509854,      11148]
NotebookOptionsPosition[    497008,      10910]
NotebookOutlinePosition[    499095,      10961]
CellTagsIndexPosition[    498751,      10949]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Apply the Hunter-Nash Method to Liquid-Liquid Extraction", "DemoTitle",
 CellChangeTimes->{{3.725115225381298*^9, 3.7251152380910254`*^9}, {
  3.7262578615026493`*^9, 3.726257875813667*^9}, {3.7264121755298386`*^9, 
  3.7264121758238554`*^9}},ExpressionUUID->"b61995fd-94db-4295-a261-\
80de9bb6280f"],

Cell[CellGroupData[{

Cell["", "InitializationSection",ExpressionUUID->"903b8a71-0d03-4bac-8327-8cfc0eefcd3a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"base", "=", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", "Thick", "]"}], ",", 
        RowBox[{"FaceForm", "[", "None", "]"}], ",", 
        RowBox[{"Polygon", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.5", ",", 
             RowBox[{
              SqrtBox["3"], "/", "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"(*", "A", "*)"}], 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Blue", ",", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"i", ",", "17"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"i", "/", "2"}], ",", 
                RowBox[{"i", "*", 
                 RowBox[{
                  SqrtBox["3"], "/", "2"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2.25", ",", "0"}], "}"}]}], "]"}], ",", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"i", "/", "2"}], "-", "0.03"}], ",", 
                 RowBox[{"i", "*", 
                  RowBox[{
                   SqrtBox["3"], "/", "2"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"i", "/", "2"}], ",", 
                 RowBox[{"i", "*", 
                  RowBox[{
                   SqrtBox["3"], "/", "2"}]}]}], "}"}]}], "}"}], "]"}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", "S", "*)"}], 
          RowBox[{"{", 
           RowBox[{"Red", ",", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"1", "-", "i"}], ",", "17"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "2.25"}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "/", "2"}], ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"i", "+", 
                  RowBox[{"0.03", "/", "2"}]}], ",", 
                 RowBox[{
                  RowBox[{"-", "0.03"}], "*", 
                  RowBox[{
                   SqrtBox["3"], "/", "2"}]}]}], "}"}]}], "}"}], "]"}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", "C", "*)"}], 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"RGBColor", "[", 
             RowBox[{"0", ",", "0.6", ",", "0"}], "]"}], ",", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"1", "-", "i"}], ",", "17"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "-", 
                 RowBox[{"i", "/", "2"}]}], ",", 
                RowBox[{"i", "*", 
                 RowBox[{
                  SqrtBox["3"], "/", "2"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "2.25"}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1.5", ",", "2"}], "}"}]}], "]"}], ",", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"1", "-", 
                  RowBox[{"i", "/", "2"}]}], ",", 
                 RowBox[{"i", "*", 
                  RowBox[{
                   SqrtBox["3"], "/", "2"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"1", "-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"i", "-", "0.03"}], ")"}], "/", "2"}]}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"i", "+", "0.03"}], ")"}], "*", 
                  RowBox[{
                   SqrtBox["3"], "/", "2"}]}]}], "}"}]}], "}"}], "]"}]}], 
           "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0.1", ",", "0.9", ",", "0.1"}], "}"}]}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<solute\>\"", ",", "17", ",", "Blue"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", 
          RowBox[{
           SqrtBox["3"], "/", "2"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<solvent\>\"", ",", "17", ",", "Red"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<carrier\>\"", ",", "17", ",", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"0", ",", "0.6", ",", "0"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "}"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6495078657249107`*^9, 3.649507867797029*^9}, {
   3.649508048346356*^9, 3.6495080495744257`*^9}, {3.649521666925294*^9, 
   3.6495216672633133`*^9}, 3.649524425896098*^9, {3.649524492104885*^9, 
   3.6495245801339197`*^9}, 3.650133310545992*^9, {3.650728231065005*^9, 
   3.6507282408535647`*^9}, {3.6507282950616655`*^9, 
   3.6507282956977015`*^9}, {3.651336359493969*^9, 3.6513363621091185`*^9}, {
   3.6513363991792383`*^9, 3.6513364171432657`*^9}, {3.651336479521834*^9, 
   3.6513364846811295`*^9}, {3.652555505554027*^9, 3.652555540648533*^9}, {
   3.6525555812864437`*^9, 3.6525556527238092`*^9}, {3.652555692818295*^9, 
   3.6525556982897587`*^9}, {3.6525559087887497`*^9, 3.652555909994412*^9}, {
   3.652556036463067*^9, 3.652556039789757*^9}, {3.6804627507554092`*^9, 
   3.680462755088657*^9}, {3.6804629431644144`*^9, 3.6804629452555337`*^9}, {
   3.682689861435293*^9, 3.682689884135378*^9}, {3.724685771658586*^9, 
   3.724685790359885*^9}, {3.72468608330581*^9, 3.724686109470341*^9}, {
   3.7251182901852303`*^9, 3.7251183149787693`*^9}},
 CellID->922119689,ExpressionUUID->"fcbff6a7-5c15-4c8f-8d76-7e3213d5bb41"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gridLines", "=", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Thin", ",", 
      RowBox[{"GrayLevel", "@", "0.7"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"(*", "A", "*)"}], 
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "/", "2"}], ",", 
               RowBox[{"i", "*", 
                RowBox[{
                 SqrtBox["3"], "/", "2"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "-", 
                RowBox[{"i", "/", "2"}]}], ",", 
               RowBox[{"i", "*", 
                RowBox[{
                 SqrtBox["3"], "/", "2"}]}]}], "}"}]}], "}"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", "S", "*)"}], 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "/", "2"}], ",", 
               RowBox[{"i", "*", 
                RowBox[{
                 SqrtBox["3"], "/", "2"}]}]}], "}"}]}], "}"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", "C", "*)"}], 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "-", "i"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "-", 
                RowBox[{"i", "/", "2"}]}], ",", 
               RowBox[{"i", "*", 
                RowBox[{
                 SqrtBox["3"], "/", "2"}]}]}], "}"}]}], "}"}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "1", ",", "0.05"}], "}"}]}], "]"}]}], 
     "}"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649508053589656*^9, 3.6495080624811645`*^9}, 
   3.652556044869495*^9, {3.724684275281994*^9, 3.7246842969423027`*^9}, 
   3.7251183686626806`*^9},
 CellID->202469671,ExpressionUUID->"74e4923b-d080-4e73-a4e6-482521c61e80"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"table1", "[", 
    RowBox[{"title_", ",", "x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Text", "[", 
    RowBox[{
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Column", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Row", "@", 
            RowBox[{"{", 
             RowBox[{"title", ",", "\"\< mole fractions\>\""}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Framed", "[", 
            RowBox[{
             RowBox[{"Column", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"Row", "@", 
                   RowBox[{"{", 
                    RowBox[{"\"\<solute = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"wtA", "[", "y", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "}"}]}], ",", 
                  "Blue"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"Row", "@", 
                   RowBox[{"{", 
                    RowBox[{"\"\<solvent = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"wtS", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "}"}]}], ",", 
                  "Red"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"Row", "@", 
                   RowBox[{"{", 
                    RowBox[{"\"\<carrier = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"x", "-", 
                    RowBox[{"y", "/", 
                    SqrtBox["3"]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "}"}]}], ",", 
                  RowBox[{"RGBColor", "[", 
                   RowBox[{"0", ",", "0.6", ",", "0"}], "]"}]}], "]"}]}], 
               "}"}], "]"}], ",", 
             RowBox[{"FrameMargins", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"20", ",", "20"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], "}"}]}]}], 
            "]"}]}], "\[IndentingNewLine]", "}"}], ",", "Center"}], "]"}], 
       ",", "17"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.05"}], ",", "0.75"}], "}"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.724687739589761*^9, 3.724687741356564*^9}, {
   3.724687786028797*^9, 3.724687811562529*^9}, {3.725118156149492*^9, 
   3.7251181575926948`*^9}, {3.7251182619860835`*^9, 3.725118278991372*^9}, 
   3.72520261176275*^9, {3.725202722560065*^9, 3.725202727761896*^9}, {
   3.7252028608611984`*^9, 3.725202869282446*^9}, 3.725211862545709*^9},
 CellID->177147,ExpressionUUID->"86bb489c-3b7e-4b26-a75c-8e32b7cb4e10"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"table2", "[", 
    RowBox[{"title_", ",", "x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Text", "[", 
    RowBox[{
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Column", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Row", "@", 
            RowBox[{"{", 
             RowBox[{"title", ",", "\"\< mole fractions\>\""}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Framed", "[", 
            RowBox[{
             RowBox[{"Column", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"Row", "@", 
                   RowBox[{"{", 
                    RowBox[{"\"\<solute = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"wtA", "[", "y", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "}"}]}], ",", 
                  "Blue"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"Row", "@", 
                   RowBox[{"{", 
                    RowBox[{"\"\<solvent = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"wtS", "[", 
                    RowBox[{"x", ",", "y"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "}"}]}], ",", 
                  "Red"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"Row", "@", 
                   RowBox[{"{", 
                    RowBox[{"\"\<carrier = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"x", "-", 
                    RowBox[{"y", "/", 
                    SqrtBox["3"]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "}"}]}], ",", 
                  RowBox[{"RGBColor", "[", 
                   RowBox[{"0", ",", "0.6", ",", "0"}], "]"}]}], "]"}]}], 
               "}"}], "]"}], ",", 
             RowBox[{"FrameMargins", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"20", ",", "20"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], "}"}]}]}], 
            "]"}]}], "\[IndentingNewLine]", "}"}], ",", "Center"}], "]"}], 
       ",", "17"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.05", ",", "0.75"}], "}"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.725202614948363*^9, 3.725202623809226*^9}, {
  3.7252026969189043`*^9, 3.7252026988743134`*^9}, {3.725202730796526*^9, 
  3.7252027389207697`*^9}, {3.7252028734720774`*^9, 3.7252028787509127`*^9}, {
  3.725211842014896*^9, 3.7252118544682736`*^9}},
 CellID->46637666,ExpressionUUID->"44c85351-cdf0-4554-baca-72d453b7f84e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"wtA", "[", "y_", "]"}], ":=", 
   RowBox[{"y", "*", 
    RowBox[{"2", "/", 
     SqrtBox["3"]}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellID->218799681,ExpressionUUID->"578e6160-71c4-4b79-b574-32744f6b1a15"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"wtS", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"1", "-", 
    RowBox[{"(", 
     RowBox[{"x", "+", 
      RowBox[{"y", "/", 
       SqrtBox["3"]}]}], ")"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellID->40409647,ExpressionUUID->"8920b215-4693-42bb-9736-bbd8432a3e7e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"colF", "=", "Black"}], ";", 
  RowBox[{"colR", "=", 
   RowBox[{"Darker", "@", 
    RowBox[{"RGBColor", "[", 
     RowBox[{"0", ",", "0.4", ",", "0.6"}], "]"}]}]}], ";", 
  RowBox[{"colS", "=", "Red"}], ";", 
  RowBox[{"colM", "=", 
   RowBox[{"GrayLevel", "@", "0.3"}]}], ";", " ", 
  RowBox[{"colE1", "=", "Orange"}], ";", " ", 
  RowBox[{"colOP", "=", "Purple"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7326317184630957`*^9, 3.732631722587173*^9}},
 CellID->707626315,ExpressionUUID->"4b8b24bb-4aef-4995-9fec-186bc44333ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pt1", "[", 
   RowBox[{"pt_", ",", "col_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"col", ",", 
    RowBox[{"PointSize", "@", "0.03"}], ",", 
    RowBox[{"Point", "@", "pt"}], ",", "White", ",", 
    RowBox[{"PointSize", "@", "0.015"}], ",", 
    RowBox[{"Point", "@", "pt"}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7240835690121155`*^9, 3.7240836053530207`*^9}, {
   3.7240837136523137`*^9, 3.7240837322618713`*^9}, {3.7246872323729343`*^9, 
   3.724687253435243*^9}, {3.7246879309231505`*^9, 3.7246879319537525`*^9}, {
   3.7251184025276675`*^9, 3.72511840544508*^9}, {3.7264113298294673`*^9, 
   3.7264113361898313`*^9}, 3.732631710190024*^9},
 CellID->94651572,ExpressionUUID->"d339a15e-df09-4634-9a7a-ebe460e5680e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pt2", "[", 
   RowBox[{"pt_", ",", "col_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"col", ",", 
    RowBox[{"PointSize", "@", "0.03"}], ",", 
    RowBox[{"Point", "@", "pt"}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.724083607743247*^9, 3.724083619228941*^9}, {
   3.724083722714589*^9, 3.7240837372653117`*^9}, 3.72468723514314*^9, {
   3.7246879340177712`*^9, 3.7246879341425714`*^9}, {3.7251184179749537`*^9, 
   3.7251184183055544`*^9}, 3.732631703683147*^9},
 CellID->254988361,ExpressionUUID->"55c441d0-d110-4553-b5b4-64cf0d1db4e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"label1", "[", 
   RowBox[{"text_", ",", "col_", ",", "loc_"}], "]"}], ":=", 
  RowBox[{"Text", "[", 
   RowBox[{
    RowBox[{"Framed", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Row", "@", 
         RowBox[{"{", 
          RowBox[{"\"\< \>\"", ",", "text", ",", "\"\< \>\""}], "}"}]}], ",", 
        "18", ",", "Italic", ",", "col"}], "]"}], ",", 
      RowBox[{"Background", "\[Rule]", "White"}], ",", 
      RowBox[{"FrameStyle", "\[Rule]", "col"}], ",", 
      RowBox[{"FrameMargins", "\[Rule]", "Tiny"}], ",", 
      RowBox[{"RoundingRadius", "\[Rule]", "15"}]}], "]"}], ",", "loc", ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"-", "1.5"}]}], "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7246882843823895`*^9, 3.7246883885383167`*^9}, {
   3.724688612269455*^9, 3.72468861630928*^9}, 3.7248587893916216`*^9},
 CellID->402911930,ExpressionUUID->"15b4afb4-ec36-46ad-a12b-dbb4f02c1a02"],

Cell[BoxData[
 RowBox[{
  RowBox[{"label2", "[", 
   RowBox[{"text_", ",", "col_", ",", "loc_"}], "]"}], ":=", 
  RowBox[{"Text", "[", 
   RowBox[{
    RowBox[{"Framed", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"text", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "Italic"}], "]"}], ",", 
          RowBox[{"text", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "18", ",", "col"}], 
       "]"}], ",", 
      RowBox[{"Background", "\[Rule]", "White"}], ",", 
      RowBox[{"FrameStyle", "\[Rule]", "col"}], ",", 
      RowBox[{"FrameMargins", "\[Rule]", "Small"}], ",", 
      RowBox[{"RoundingRadius", "\[Rule]", "15"}]}], "]"}], ",", "loc", ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"-", "1.5"}]}], "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7248587923057885`*^9, 3.7248588662940207`*^9}},
 CellID->124215,ExpressionUUID->"665a78cf-6e2e-42cb-9cb6-6d4f2e3c068d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ManipulateSection",ExpressionUUID->"558554a3-a7f3-4b6e-9501-7ba51edc5203"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "x1", ",", "y1", ",", "x2", ",", "y2", ",", "x3", ",", "y3", ",", "sol",
        ",", "a", ",", "b", ",", "c", ",", "phase", ",", "yt", ",", "xt", ",",
        "tie", ",", "phaseplot", ",", "tielines", ",", "F", ",", "S", ",", 
       "M", ",", "xF", ",", "yF", ",", "xRN", ",", "yRN", ",", "Msol", ",", 
       "xM", ",", "yM", ",", "xE", ",", "yE", ",", "xP", ",", "yP", ",", 
       "operating", ",", "lower", ",", "upper", ",", "lever", ",", "newtie", 
       ",", "xtie", ",", "xR", ",", "yR", ",", "n", ",", "plotlabel"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SeedRandom", "[", "reset", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"x1", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"0.02", ",", "0.07"}], "}"}], "]"}]}], ";", 
      RowBox[{"y1", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"x2", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"0.45", ",", "0.55"}], "}"}], "]"}]}], ";", 
      RowBox[{"y2", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"0.3", ",", "0.4"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"x3", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"0.85", ",", "0.98"}], "}"}], "]"}]}], ";", 
      RowBox[{"y3", "=", "0"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"Quiet", "@", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"\[Alpha]", "*", 
                SuperscriptBox["x1", "2"]}], "+", 
               RowBox[{"\[Beta]", "*", "x1"}], "+", "\[Chi]"}], "\[Equal]", 
              "y1"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Alpha]", "*", 
                SuperscriptBox["x2", "2"]}], "+", 
               RowBox[{"\[Beta]", "*", "x2"}], "+", "\[Chi]"}], "\[Equal]", 
              "y2"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Alpha]", "*", 
                SuperscriptBox["x3", "2"]}], "+", 
               RowBox[{"\[Beta]", "*", "x3"}], "+", "\[Chi]"}], "\[Equal]", 
              "y3"}]}], "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Chi]"}], "}"}]}], 
          "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"\[Alpha]", "/.", "sol"}]}], ";", 
      RowBox[{"b", "=", 
       RowBox[{"\[Beta]", "/.", "sol"}]}], ";", 
      RowBox[{"c", "=", 
       RowBox[{"\[Chi]", "/.", "sol"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"phase", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{"a", "*", 
         SuperscriptBox["x", "2"]}], "+", 
        RowBox[{"b", "*", "x"}], "+", "c"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yt", "[", "1", "]"}], "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.02", ",", "0.05"}], "}"}], "*", "y2"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"xt", "[", "1", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"phase", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"yt", "[", "1", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yt", "[", "2", "]"}], "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.06", ",", "0.1"}], "}"}], "*", "y2"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"xt", "[", "2", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"phase", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"yt", "[", "2", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"tie", "[", "1", "]"}], "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"yt", "[", "2", "]"}], "-", 
           RowBox[{"yt", "[", "1", "]"}]}], 
          RowBox[{
           RowBox[{"xt", "[", "2", "]"}], "-", 
           RowBox[{"xt", "[", "1", "]"}]}]], "*", 
         RowBox[{"(", 
          RowBox[{"x", "-", 
           RowBox[{"xt", "[", "1", "]"}]}], ")"}]}], "+", 
        RowBox[{"yt", "[", "1", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yt", "[", "3", "]"}], "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.15", ",", "0.2"}], "}"}], "*", "y2"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"xt", "[", "3", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"phase", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"yt", "[", "3", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yt", "[", "4", "]"}], "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.25", ",", "0.3"}], "}"}], "*", "y2"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"xt", "[", "4", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"phase", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"yt", "[", "4", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"tie", "[", "2", "]"}], "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"yt", "[", "4", "]"}], "-", 
           RowBox[{"yt", "[", "3", "]"}]}], 
          RowBox[{
           RowBox[{"xt", "[", "4", "]"}], "-", 
           RowBox[{"xt", "[", "3", "]"}]}]], "*", 
         RowBox[{"(", 
          RowBox[{"x", "-", 
           RowBox[{"xt", "[", "3", "]"}]}], ")"}]}], "+", 
        RowBox[{"yt", "[", "3", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yt", "[", "5", "]"}], "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.35", ",", "0.4"}], "}"}], "*", "y2"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"xt", "[", "5", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"phase", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"yt", "[", "5", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yt", "[", "6", "]"}], "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.5", ",", "0.55"}], "}"}], "*", "y2"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"xt", "[", "6", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"phase", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"yt", "[", "6", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"tie", "[", "3", "]"}], "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"yt", "[", "6", "]"}], "-", 
           RowBox[{"yt", "[", "5", "]"}]}], 
          RowBox[{
           RowBox[{"xt", "[", "6", "]"}], "-", 
           RowBox[{"xt", "[", "5", "]"}]}]], "*", 
         RowBox[{"(", 
          RowBox[{"x", "-", 
           RowBox[{"xt", "[", "5", "]"}]}], ")"}]}], "+", 
        RowBox[{"yt", "[", "5", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yt", "[", "7", "]"}], "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.72", ",", "0.77"}], "}"}], "*", "y2"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"xt", "[", "7", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"phase", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"yt", "[", "7", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yt", "[", "8", "]"}], "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.8", ",", "0.9"}], "}"}], "*", "y2"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"xt", "[", "8", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"phase", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"yt", "[", "8", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"tie", "[", "4", "]"}], "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"yt", "[", "8", "]"}], "-", 
           RowBox[{"yt", "[", "7", "]"}]}], 
          RowBox[{
           RowBox[{"xt", "[", "8", "]"}], "-", 
           RowBox[{"xt", "[", "7", "]"}]}]], "*", 
         RowBox[{"(", 
          RowBox[{"x", "-", 
           RowBox[{"xt", "[", "7", "]"}]}], ")"}]}], "+", 
        RowBox[{"yt", "[", "7", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"phaseplot", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"phase", "[", "x", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "x1", ",", "x3"}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Black"}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               SqrtBox["3"], "/", "2"}]}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tielines", "=", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "@", "0.004"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xt", "[", "1", "]"}], ",", 
               RowBox[{"yt", "[", "1", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xt", "[", "2", "]"}], ",", 
               RowBox[{"yt", "[", "2", "]"}]}], "}"}]}], "}"}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xt", "[", "3", "]"}], ",", 
               RowBox[{"yt", "[", "3", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xt", "[", "4", "]"}], ",", 
               RowBox[{"yt", "[", "4", "]"}]}], "}"}]}], "}"}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xt", "[", "5", "]"}], ",", 
               RowBox[{"yt", "[", "5", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xt", "[", "6", "]"}], ",", 
               RowBox[{"yt", "[", "6", "]"}]}], "}"}]}], "}"}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xt", "[", "7", "]"}], ",", 
               RowBox[{"yt", "[", "7", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xt", "[", "8", "]"}], ",", 
               RowBox[{"yt", "[", "8", "]"}]}], "}"}]}], "}"}], "]"}]}], 
         "}"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"F", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1000", ",", "1500"}], "}"}], "]"}]}], ";", 
      RowBox[{"S", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1500", ",", "2000"}], "}"}], "]"}]}], ";", 
      RowBox[{"M", "=", 
       RowBox[{"F", "+", "S"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"xF", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"0.6", ",", "0.7"}], "}"}], "]"}]}], ";", 
      RowBox[{"yF", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"0.4", ",", "0.45"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xRN", "=", 
       RowBox[{"0.99", "*", "x3"}]}], ";", 
      RowBox[{"yRN", "=", 
       RowBox[{"phase", "[", "xRN", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"mixing", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Msol", "=", 
       RowBox[{"Quiet", "@", 
        RowBox[{"First", "@", 
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"wtA", "[", "yF", "]"}], "*", "F"}], "\[Equal]", 
             RowBox[{"xA", "*", "M"}]}], "\[And]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"wtS", "[", 
                RowBox[{"xF", ",", "yF"}], "]"}], "*", "F"}], "+", "S"}], 
             "\[Equal]", 
             RowBox[{"xS", "*", "M"}]}], "\[And]", 
            RowBox[{
             RowBox[{"xA", "+", "xS", "+", "xC"}], "\[Equal]", "1"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"xA", ",", "xS", ",", "xC"}], "}"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xM", "=", 
       RowBox[{"1", "-", 
        RowBox[{"(", 
         RowBox[{"xS", "/.", "Msol"}], ")"}], "-", 
        RowBox[{"yM", "/", 
         SqrtBox["3"]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"yM", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SqrtBox["3"], "/", "2"}], ")"}], "*", "xA"}], "/.", "Msol"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"extract", " ", "1"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xE", "[", "1", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{"Quiet", "@", 
         RowBox[{"First", "@", 
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"phase", "[", "x", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"yRN", "-", "yM"}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{"xRN", "-", "xM"}], ")"}]}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{"x", "-", "xRN"}], ")"}]}], "+", "yRN"}]}], ",", 
            "x"}], "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yE", "[", "1", "]"}], "=", 
       RowBox[{"phase", "[", 
        RowBox[{"xE", "[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"operating", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"xP", "=", 
       RowBox[{"x", "/.", 
        RowBox[{"Quiet", "@", 
         RowBox[{"First", "@", 
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"yF", "-", 
                 RowBox[{"yE", "[", "1", "]"}]}], 
                RowBox[{"xF", "-", 
                 RowBox[{"xE", "[", "1", "]"}]}]], "*", 
               RowBox[{"(", 
                RowBox[{"x", "-", "xF"}], ")"}]}], "+", "yF"}], "\[Equal]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"yRN", "/", "xRN"}], ")"}], "*", "x"}]}], ",", "x"}], 
           "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"yP", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"yRN", "/", "xRN"}], ")"}], "*", "xP"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"operating", "[", 
        RowBox[{"i_", ",", "x_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"yR", "[", "i", "]"}], "-", "yP"}], 
          RowBox[{
           RowBox[{"xR", "[", "i", "]"}], "-", "xP"}]], "*", 
         RowBox[{"(", 
          RowBox[{"x", "-", "xP"}], ")"}]}], "+", "yP"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"lower", "[", 
        RowBox[{"pt_", ",", "x_"}], "]"}], ":=", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pt", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", 
          RowBox[{
           RowBox[{"tie", "[", "1", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", "0", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"tie", "[", "1", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", 
          RowBox[{"pt", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", 
          RowBox[{
           RowBox[{"tie", "[", "2", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"tie", "[", "1", "]"}], "[", "x", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"tie", "[", "2", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", 
          RowBox[{"pt", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", 
          RowBox[{
           RowBox[{"tie", "[", "3", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"tie", "[", "2", "]"}], "[", "x", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"tie", "[", "3", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", 
          RowBox[{"pt", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", 
          RowBox[{
           RowBox[{"tie", "[", "4", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"tie", "[", "3", "]"}], "[", "x", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"tie", "[", "4", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", 
          RowBox[{"pt", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"tie", "[", "4", "]"}], "[", "x", "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"upper", "[", 
        RowBox[{"pt_", ",", "x_"}], "]"}], ":=", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pt", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "<", 
          RowBox[{
           RowBox[{"tie", "[", "1", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"tie", "[", "1", "]"}], "[", "x", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"tie", "[", "1", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", 
          RowBox[{"pt", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", 
          RowBox[{
           RowBox[{"tie", "[", "2", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"tie", "[", "2", "]"}], "[", "x", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"tie", "[", "2", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", 
          RowBox[{"pt", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", 
          RowBox[{
           RowBox[{"tie", "[", "3", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"tie", "[", "3", "]"}], "[", "x", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"tie", "[", "3", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", 
          RowBox[{"pt", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", 
          RowBox[{
           RowBox[{"tie", "[", "4", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"tie", "[", "4", "]"}], "[", "x", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"tie", "[", "4", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", 
          RowBox[{"pt", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"tie", "[", "4", "]"}], "[", "x", "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"lever", "[", "pt_", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pt", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[GreaterEqual]", 
          RowBox[{
           RowBox[{"tie", "[", "4", "]"}], "[", 
           RowBox[{"pt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", "1", ",", 
         FractionBox[
          RowBox[{
           RowBox[{"pt", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", 
           RowBox[{"upper", "[", 
            RowBox[{"pt", ",", 
             RowBox[{"pt", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], 
          RowBox[{
           RowBox[{"lower", "[", 
            RowBox[{"pt", ",", 
             RowBox[{"pt", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"upper", "[", 
            RowBox[{"pt", ",", 
             RowBox[{"pt", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newtie", "[", 
        RowBox[{"pt_", ",", "x_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"lever", "[", "pt", "]"}], "*", 
         RowBox[{"lower", "[", 
          RowBox[{"pt", ",", "x"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"lever", "[", "pt", "]"}]}], ")"}], "*", 
         RowBox[{"upper", "[", 
          RowBox[{"pt", ",", "x"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xtie", "[", 
        RowBox[{"pt_", ",", "i_"}], "]"}], ":=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"newtie", "[", 
             RowBox[{"pt", ",", "x"}], "]"}], "\[Equal]", 
            RowBox[{"phase", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xR", "[", "1", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"newtie", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xE", "[", "1", "]"}], ",", 
                RowBox[{"yE", "[", "1", "]"}]}], "}"}], ",", "x"}], "]"}], 
            "\[Equal]", 
            RowBox[{"phase", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", 
      RowBox[{
       RowBox[{"yR", "[", "1", "]"}], "=", 
       RowBox[{"phase", "[", 
        RowBox[{"xR", "[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xE", "[", "2", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"operating", "[", 
             RowBox[{"1", ",", "x"}], "]"}], "\[Equal]", 
            RowBox[{"phase", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", 
      RowBox[{
       RowBox[{"yE", "[", "2", "]"}], "=", 
       RowBox[{"phase", "[", 
        RowBox[{"xE", "[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"xR", "[", 
            RowBox[{"#", "-", "1"}], "]"}], "<", "xRN"}], ",", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"xR", "[", "#", "]"}], "=", 
             RowBox[{"x", "/.", 
              RowBox[{
               RowBox[{"Solve", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"newtie", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xE", "[", "#", "]"}], ",", 
                    RowBox[{"yE", "[", "#", "]"}]}], "}"}], ",", "x"}], "]"}],
                   "\[Equal]", 
                  RowBox[{"phase", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], ";", 
            RowBox[{
             RowBox[{"yR", "[", "#", "]"}], "=", 
             RowBox[{"phase", "[", 
              RowBox[{"xR", "[", "#", "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"xE", "[", 
              RowBox[{"#", "+", "1"}], "]"}], "=", 
             RowBox[{"x", "/.", 
              RowBox[{
               RowBox[{"Solve", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"operating", "[", 
                   RowBox[{"#", ",", "x"}], "]"}], "\[Equal]", 
                  RowBox[{"phase", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], ";", 
            RowBox[{
             RowBox[{"yE", "[", 
              RowBox[{"#", "+", "1"}], "]"}], "=", 
             RowBox[{"phase", "[", 
              RowBox[{"xE", "[", 
               RowBox[{"#", "+", "1"}], "]"}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", "}"}]}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"2", ",", "10"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"xR", "[", "#", "]"}], "<", "xRN"}], ",", "0", ",", 
              "#"}], "]"}], "&"}], "/@", 
           RowBox[{"Range", "@", "10"}]}], ",", "0"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", "\[Equal]", "8"}], ",", 
        RowBox[{"reset", "=", 
         RowBox[{"reset", "+", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"plotlabel", "=", 
       RowBox[{"Switch", "[", 
        RowBox[{"MCR", ",", "\[IndentingNewLine]", "1", ",", 
         RowBox[{"If", "[", 
          RowBox[{
          "hint", ",", "\"\<hint: read the compositions on the axes\>\"", ",", 
           RowBox[{"Row", "@", 
            RowBox[{"{", 
             RowBox[{"\"\<Step 1: move the feed point \>\"", ",", 
              RowBox[{"Style", "[", 
               RowBox[{"\"\<F\>\"", ",", "Italic"}], "]"}], ",", 
              "\"\< to \\nthe correct location, then check solution\>\""}], 
             "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", "2", ",", 
         RowBox[{"If", "[", 
          RowBox[{
          "hint", ",", "\"\<hint: read the compositions on the axes\>\"", ",", 
           RowBox[{"Row", "@", 
            RowBox[{"{", 
             RowBox[{"\"\<Step 2: move the solvent point \>\"", ",", 
              RowBox[{"Style", "[", 
               RowBox[{"\"\<S\>\"", ",", "Italic"}], "]"}], ",", 
              "\"\< to \\nthe correct location, then check solution\>\""}], 
             "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", "3", ",", 
         RowBox[{"If", "[", 
          RowBox[{
          "hint", ",", "\"\<hint: read the compositions on the axes\>\"", ",", 
           RowBox[{"Row", "@", 
            RowBox[{"{", 
             RowBox[{"\"\<Step 3: move the desired raffinate point \>\"", ",", 
              RowBox[{"Subscript", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<R\>\"", ",", "Italic"}], "]"}], ",", 
                "\"\<N\>\""}], "]"}], ",", 
              "\"\< to \\nthe correct location, then check solution\>\""}], 
             "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", "4", ",", 
         RowBox[{"If", "[", 
          RowBox[{
          "hint", ",", "\"\<hint: use the lever rule\>\"", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Row", "@", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Step 4: use mass balance for two entering streams (\>\"", 
              ",", 
              RowBox[{"Style", "[", 
               RowBox[{"\"\<F\>\"", ",", "Italic"}], "]"}], ",", "\"\<, \>\"",
               ",", 
              RowBox[{"Style", "[", 
               RowBox[{"\"\<S\>\"", ",", "Italic"}], "]"}], ",", 
              "\"\<)\\n to determine the average composition \>\"", ",", 
              RowBox[{"Style", "[", 
               RowBox[{"\"\<M\>\"", ",", "Italic"}], "]"}], ",", 
              "\"\<, then check solution\>\""}], "}"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", "5", ",", 
         RowBox[{"If", "[", 
          RowBox[{"hint", ",", 
           RowBox[{"Row", "@", 
            RowBox[{"{", 
             RowBox[{
             "\"\<hint: use mass balance for two exit streams (\>\"", ",", 
              RowBox[{"Subscript", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<R\>\"", ",", "Italic"}], "]"}], ",", 
                "\"\<N\>\""}], "]"}], ",", "\"\<, \>\"", ",", 
              RowBox[{"Subscript", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<E\>\"", ",", "Italic"}], "]"}], ",", "1"}], 
               "]"}], ",", "\"\<)\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Row", "@", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Step 5: move the point for the first extract composition \>\
\"", ",", 
              RowBox[{"Subscript", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<E\>\"", ",", "Italic"}], "]"}], ",", "1"}], 
               "]"}], ",", 
              "\"\<\\n to the correct location, then check solution\>\""}], 
             "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", "6", ",", 
         RowBox[{"If", "[", 
          RowBox[{"hint", ",", 
           RowBox[{"Row", "@", 
            RowBox[{"{", 
             RowBox[{
             "\"\<hint: the operating point is at the intersection of \\na \
line through \>\"", ",", 
              RowBox[{"Style", "[", 
               RowBox[{"\"\<F\>\"", ",", "Italic"}], "]"}], ",", 
              "\"\< and \>\"", ",", 
              RowBox[{"Subscript", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<E\>\"", ",", "Italic"}], "]"}], ",", "1"}], 
               "]"}], ",", "\"\< and a line through \>\"", ",", 
              RowBox[{"Style", "[", 
               RowBox[{"\"\<S\>\"", ",", "Italic"}], "]"}], ",", 
              "\"\< and \>\"", ",", 
              RowBox[{"Subscript", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<R\>\"", ",", "Italic"}], "]"}], ",", 
                "\"\<N\>\""}], "]"}]}], "}"}]}], ",", 
           RowBox[{"Row", "@", 
            RowBox[{"{", 
             RowBox[{"\"\<Step 6: move the operating point \>\"", ",", 
              RowBox[{"Style", "[", 
               RowBox[{"\"\<P\>\"", ",", "Italic"}], "]"}], ",", 
              "\"\< \\nto the correct location, then check solution\>\""}], 
             "}"}]}]}], "]"}], ",", " ", "\[IndentingNewLine]", "7", ",", 
         RowBox[{"If", "[", 
          RowBox[{
          "hint", ",", 
           "\"\<hint: follow the tie line to the other side of the phase \
boundary\>\"", ",", 
           "\"\<Step 7: move the blue point to the correct raffinate \
composition\>\""}], "]"}], ",", "\[IndentingNewLine]", "8", ",", 
         RowBox[{"If", "[", 
          RowBox[{
          "hint", ",", "\"\<hint: draw a line to the operating point\>\"", 
           ",", "\"\<Step 8: move the yellow point to the correct extract \
composition\>\""}], "]"}], ",", "\[IndentingNewLine]", "9", ",", 
         RowBox[{"If", "[", 
          RowBox[{
          "hint", ",", 
           "\"\<hint: follow the tie line to the other side of the phase \
boundary\>\"", ",", 
           "\"\<Step 9: move the blue point to the correct raffinate \
composition\>\""}], "]"}], ",", "\[IndentingNewLine]", "10", ",", 
         RowBox[{"If", "[", 
          RowBox[{
          "hint", ",", "\"\<hint: draw a line to the operating point\>\"", 
           ",", "\"\<Step 10: move the yellow point to the correct extract \
composition\>\""}], "]"}], ",", "\[IndentingNewLine]", "11", ",", 
         RowBox[{"Row", "@", 
          RowBox[{"{", 
           RowBox[{"n", ",", "\"\< stages needed\>\""}], "}"}]}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MCR", "\[LessEqual]", "4"}], ",", "gridLines", ",", 
          RowBox[{"{", "}"}]}], "]"}], ",", "base", ",", "phaseplot", ",", 
        "tielines", ",", "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"600", ",", "390"}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.25"}], ",", "1.15"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.1"}], ",", "0.93"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"ImagePadding", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"55", ",", "55"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"5", ",", 
             RowBox[{"If", "[", 
              RowBox[{"hint", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MCR", "\[Equal]", "6"}], ",", "15", ",", "35"}], 
                "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"3", "\[LessEqual]", "MCR", "\[LessEqual]", "5"}], 
                 ",", "15", ",", "35"}], "]"}]}], "]"}]}], "}"}]}], "}"}]}], 
        ",", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"Style", "[", 
          RowBox[{"plotlabel", ",", "17", ",", "Black"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"LOCATE", " ", "FEED", " ", "POINT"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MCR", "\[Equal]", "1"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"pt1", "[", 
                RowBox[{"feed", ",", "colF"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"label1", "[", 
                RowBox[{"\"\<F\>\"", ",", "colF", ",", "feed"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"table1", "[", 
                RowBox[{"\"\<feed\>\"", ",", "xF", ",", "yF"}], "]"}], ",", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"table2", "[", 
                  RowBox[{"\"\<feed\>\"", ",", 
                   RowBox[{"feed", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"feed", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ","}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{"pt2", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"xF", ",", "yF"}], "}"}], ",", "colF"}], "]"}]}], 
                "]"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MCR", ">", "1"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pt2", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"xF", ",", "yF"}], "}"}], ",", "colF"}], "]"}], ",", 
               RowBox[{"label1", "[", 
                RowBox[{"\"\<F\>\"", ",", "colF", ",", 
                 RowBox[{"{", 
                  RowBox[{"xF", ",", "yF"}], "}"}]}], "]"}]}], "}"}]}], "]"}],
            ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"LOCATE", " ", "SOLVENT", " ", "POINT"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MCR", "\[Equal]", "2"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"pt1", "[", 
                RowBox[{"solvent", ",", "colS"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"label1", "[", 
                RowBox[{"\"\<S\>\"", ",", "colS", ",", "solvent"}], "]"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"table1", "[", 
                RowBox[{"\"\<solvent\>\"", ",", "0", ",", "0"}], "]"}], ",", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"table2", "[", 
                  RowBox[{"\"\<solvent\>\"", ",", 
                   RowBox[{"solvent", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"solvent", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ","}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{"pt2", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", "colS"}], "]"}]}], 
                "]"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MCR", ">", "2"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pt2", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}], ",", "colS"}], "]"}], ",", 
               RowBox[{"label1", "[", 
                RowBox[{"\"\<S\>\"", ",", "colS", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], "}"}]}], "]"}], 
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"LOCATE", " ", "RAFFINATE"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MCR", "\[Equal]", "3"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"pt1", "[", 
                RowBox[{"raffinateN", ",", "colR"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"label2", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<R\>\"", ",", "\"\<N\>\""}], "}"}], ",", "colR",
                  ",", "raffinateN"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"table1", "[", 
                RowBox[{"\"\<raffinate\>\"", ",", "xRN", ",", "yRN"}], "]"}], 
               ",", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"table2", "[", 
                  RowBox[{"\"\<raffinate\>\"", ",", 
                   RowBox[{"raffinateN", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"raffinateN", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ","}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{"pt2", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"xRN", ",", "yRN"}], "}"}], ",", "colR"}], 
                  "]"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MCR", ">", "3"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pt2", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"xRN", ",", "yRN"}], "}"}], ",", "colR"}], "]"}], 
               ",", 
               RowBox[{"label2", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<R\>\"", ",", "\"\<N\>\""}], "}"}], ",", "colR",
                  ",", 
                 RowBox[{"{", 
                  RowBox[{"xRN", ",", "yRN"}], "}"}]}], "]"}]}], "}"}]}], 
            "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"LOCATE", " ", "MIXING", " ", "POINT"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MCR", "\[Equal]", "4"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Dashed", ",", "colM", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"xF", ",", "yF"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"pt1", "[", 
                RowBox[{"mixing", ",", "colM"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"label1", "[", 
                RowBox[{"\"\<M\>\"", ",", "colM", ",", "mixing"}], "]"}], ",",
                "\[IndentingNewLine]", 
               RowBox[{"table2", "[", 
                RowBox[{"\"\<mixing\>\"", ",", 
                 RowBox[{"mixing", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"mixing", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<flow rates\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"Framed", "@", 
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<F\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"F", ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "0"}], "}"}]}], "]"}], ",", 
                    "\"\< kg/h\>\""}], "}"}]}], ",", "colF"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<S\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"S", ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "0"}], "}"}]}], "]"}], ",", 
                    "\"\< kg/h\>\""}], "}"}]}], ",", "colS"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", "\"\<=\>\""}]}], 
                    "]"}]}]}], "}"}], ",", "Center"}], "]"}], ",", "17"}], 
                  "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "0.05"}], ",", "0.75"}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{"pt2", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"xM", ",", "yM"}], "}"}], ",", "colM"}], "]"}]}], 
                "]"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"MCR", ">", "4"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pt2", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"xM", ",", "yM"}], "}"}], ",", "colM"}], "]"}], 
                 ",", 
                 RowBox[{"label1", "[", 
                  RowBox[{"\"\<M\>\"", ",", "colM", ",", 
                   RowBox[{"{", 
                    RowBox[{"xM", ",", "yM"}], "}"}]}], "]"}]}], "}"}]}], 
              "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"EXTRACT", " ", "1", " ", "POINT"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MCR", "\[Equal]", "5"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"pt2", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"xM", ",", "yM"}], "}"}], ",", "colM"}], "]"}], ",", 
               RowBox[{"label1", "[", 
                RowBox[{"\"\<M\>\"", ",", "colM", ",", 
                 RowBox[{"{", 
                  RowBox[{"xM", ",", "yM"}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"colE1", ",", 
                 RowBox[{"Arrow", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"xRN", ",", "yRN"}], "}"}], ",", "extract1"}], 
                   "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"pt1", "[", 
                RowBox[{"extract1", ",", "colE1"}], "]"}], ",", 
               RowBox[{"label2", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<E\>\"", ",", "1"}], "}"}], ",", "colE1", ",", 
                 "extract1"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{"pt2", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xE", "[", "1", "]"}], ",", 
                    RowBox[{"yE", "[", "1", "]"}]}], "}"}], ",", "colE1"}], 
                  "]"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MCR", ">", "5"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pt2", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"xE", "[", "1", "]"}], ",", 
                   RowBox[{"yE", "[", "1", "]"}]}], "}"}], ",", "colE1"}], 
                "]"}], ",", 
               RowBox[{"label2", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<E\>\"", ",", "1"}], "}"}], ",", "colE1", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"xE", "[", "1", "]"}], ",", 
                   RowBox[{"yE", "[", "1", "]"}]}], "}"}]}], "]"}]}], "}"}]}],
             "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"OPERATING", " ", "POINT"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MCR", "\[Equal]", "6"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Thickness", "@", "0.007"}], ",", "Dotted", ",", 
                 "colOP", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{"operatingpt", ",", 
                    RowBox[{"{", 
                    RowBox[{"xF", ",", "yF"}], "}"}]}], "}"}], "]"}], ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{"operatingpt", ",", 
                    RowBox[{"{", 
                    RowBox[{"xRN", ",", "yRN"}], "}"}]}], "}"}], "]"}]}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"pt1", "[", 
                RowBox[{"operatingpt", ",", "colOP"}], "]"}], ",", 
               RowBox[{"label1", "[", 
                RowBox[{"\"\<P\>\"", ",", "colOP", ",", "operatingpt"}], 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{"{", 
                  RowBox[{"Dashed", ",", "colOP", ",", 
                   RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"xP", ",", "yP"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xF", ",", "yF"}], "}"}]}], "}"}], "]"}], ",", 
                   RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"xP", ",", "yP"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xRN", ",", "yRN"}], "}"}]}], "}"}], "]"}], ",", 
                   RowBox[{"pt2", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"xP", ",", "yP"}], "}"}], ",", "colOP"}], "]"}]}],
                   "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"6", "<", "MCR", "<", "11"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pt2", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"xP", ",", "yP"}], "}"}], ",", "colOP"}], "]"}], 
               ",", 
               RowBox[{"label1", "[", 
                RowBox[{"\"\<P\>\"", ",", "colOP", ",", 
                 RowBox[{"{", 
                  RowBox[{"xP", ",", "yP"}], "}"}]}], "]"}]}], "}"}]}], "]"}],
            ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"FIRST", " ", "RAFFINATE"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MCR", "\[Equal]", "7"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"colR", ",", "Dashed", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xE", "[", "1", "]"}], ",", 
                    RowBox[{"yE", "[", "1", "]"}]}], "}"}], ",", 
                    "raffinate1"}], "}"}], "]"}]}], "}"}], ",", 
               RowBox[{"pt1", "[", 
                RowBox[{"raffinate1", ",", "colR"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"label2", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<R\>\"", ",", "1"}], "}"}], ",", "colR", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{"solution", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xR", "[", "1", "]"}], ",", 
                    RowBox[{"yR", "[", "1", "]"}]}], "}"}], ",", 
                   "raffinate1"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{"{", 
                  RowBox[{"colR", ",", "Dashed", ",", 
                   RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xE", "[", "1", "]"}], ",", 
                    RowBox[{"yE", "[", "1", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xR", "[", "1", "]"}], ",", 
                    RowBox[{"yR", "[", "1", "]"}]}], "}"}]}], "}"}], "]"}], 
                   ",", 
                   RowBox[{"pt2", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xR", "[", "1", "]"}], ",", 
                    RowBox[{"yR", "[", "1", "]"}]}], "}"}], ",", "colR"}], 
                    "]"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}],
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"7", "<", "MCR", "<", "11"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"colR", ",", "Dashed", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xE", "[", "1", "]"}], ",", 
                    RowBox[{"yE", "[", "1", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xR", "[", "1", "]"}], ",", 
                    RowBox[{"yR", "[", "1", "]"}]}], "}"}]}], "}"}], "]"}]}], 
                "}"}], ",", 
               RowBox[{"pt2", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"xR", "[", "1", "]"}], ",", 
                   RowBox[{"yR", "[", "1", "]"}]}], "}"}], ",", "colR"}], 
                "]"}], ",", 
               RowBox[{"label2", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<R\>\"", ",", "1"}], "}"}], ",", "colR", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"xR", "[", "1", "]"}], ",", 
                   RowBox[{"yR", "[", "1", "]"}]}], "}"}]}], "]"}]}], "}"}]}],
             "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"SECOND", " ", "EXTRACT"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MCR", "\[Equal]", "8"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"colE1", ",", "Dashed", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xR", "[", "1", "]"}], ",", 
                    RowBox[{"yR", "[", "1", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xP", ",", "yP"}], "}"}]}], "}"}], "]"}]}], "}"}],
                ",", 
               RowBox[{"pt1", "[", 
                RowBox[{"extract2", ",", "colE1"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"label2", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<E\>\"", ",", "2"}], "}"}], ",", "colE1", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{"solution", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xE", "[", "2", "]"}], ",", 
                    RowBox[{"yE", "[", "2", "]"}]}], "}"}], ",", "extract2"}],
                   "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"colE1", ",", "Dashed", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xR", "[", "1", "]"}], ",", 
                    RowBox[{"yR", "[", "1", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xE", "[", "2", "]"}], ",", 
                    RowBox[{"yE", "[", "2", "]"}]}], "}"}]}], "}"}], "]"}]}], 
                    "}"}], ",", 
                   RowBox[{"pt2", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xE", "[", "2", "]"}], ",", 
                    RowBox[{"yE", "[", "2", "]"}]}], "}"}], ",", "colE1"}], 
                    "]"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}],
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"8", "<", "MCR", "<", "11"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"colE1", ",", "Dashed", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xR", "[", "1", "]"}], ",", 
                    RowBox[{"yR", "[", "1", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xE", "[", "2", "]"}], ",", 
                    RowBox[{"yE", "[", "2", "]"}]}], "}"}]}], "}"}], "]"}]}], 
                "}"}], ",", 
               RowBox[{"pt2", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"xE", "[", "2", "]"}], ",", 
                   RowBox[{"yE", "[", "2", "]"}]}], "}"}], ",", "colE1"}], 
                "]"}], ",", 
               RowBox[{"label2", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<E\>\"", ",", "2"}], "}"}], ",", "colE1", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"xE", "[", "2", "]"}], ",", 
                   RowBox[{"yE", "[", "2", "]"}]}], "}"}]}], "]"}]}], "}"}]}],
             "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"SECOND", " ", "RAFFINATE"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MCR", "\[Equal]", "9"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"colR", ",", "Dashed", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xE", "[", "2", "]"}], ",", 
                    RowBox[{"yE", "[", "2", "]"}]}], "}"}], ",", 
                    "raffinate2"}], "}"}], "]"}]}], "}"}], ",", 
               RowBox[{"pt1", "[", 
                RowBox[{"raffinate2", ",", "colR"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"label2", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<R\>\"", ",", "2"}], "}"}], ",", "colR", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{"solution", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xR", "[", "2", "]"}], ",", 
                    RowBox[{"yR", "[", "2", "]"}]}], "}"}], ",", 
                   "raffinate2"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{"{", 
                  RowBox[{"colR", ",", "Dashed", ",", 
                   RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xE", "[", "2", "]"}], ",", 
                    RowBox[{"yE", "[", "2", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xR", "[", "2", "]"}], ",", 
                    RowBox[{"yR", "[", "2", "]"}]}], "}"}]}], "}"}], "]"}], 
                   ",", 
                   RowBox[{"pt2", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xR", "[", "2", "]"}], ",", 
                    RowBox[{"yR", "[", "2", "]"}]}], "}"}], ",", "colR"}], 
                    "]"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}],
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"9", "<", "MCR", "<", "11"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"colR", ",", "Dashed", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xE", "[", "2", "]"}], ",", 
                    RowBox[{"yE", "[", "2", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xR", "[", "2", "]"}], ",", 
                    RowBox[{"yR", "[", "2", "]"}]}], "}"}]}], "}"}], "]"}]}], 
                "}"}], ",", 
               RowBox[{"pt2", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"xR", "[", "2", "]"}], ",", 
                   RowBox[{"yR", "[", "2", "]"}]}], "}"}], ",", "colR"}], 
                "]"}], ",", 
               RowBox[{"label2", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<R\>\"", ",", "2"}], "}"}], ",", "colR", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"xR", "[", "2", "]"}], ",", 
                   RowBox[{"yR", "[", "2", "]"}]}], "}"}]}], "]"}]}], "}"}]}],
             "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"THIRD", " ", "EXTRACT"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MCR", "\[Equal]", "10"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"colE1", ",", "Dashed", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xR", "[", "2", "]"}], ",", 
                    RowBox[{"yR", "[", "2", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xP", ",", "yP"}], "}"}]}], "}"}], "]"}]}], "}"}],
                ",", 
               RowBox[{"pt1", "[", 
                RowBox[{"extract3", ",", "colE1"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"label2", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<E\>\"", ",", "3"}], "}"}], ",", "colE1", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{"solution", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xE", "[", "3", "]"}], ",", 
                    RowBox[{"yE", "[", "3", "]"}]}], "}"}], ",", "extract3"}],
                   "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"solution", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"colE1", ",", "Dashed", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xR", "[", "2", "]"}], ",", 
                    RowBox[{"yR", "[", "2", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xE", "[", "3", "]"}], ",", 
                    RowBox[{"yE", "[", "3", "]"}]}], "}"}]}], "}"}], "]"}]}], 
                    "}"}], ",", 
                   RowBox[{"pt2", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xE", "[", "3", "]"}], ",", 
                    RowBox[{"yE", "[", "3", "]"}]}], "}"}], ",", "colE1"}], 
                    "]"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}],
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"10", "<", "MCR", "<", "11"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"colE1", ",", "Dashed", ",", 
                   RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xR", "[", "2", "]"}], ",", 
                    RowBox[{"yR", "[", "2", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xE", "[", "3", "]"}], ",", 
                    RowBox[{"yE", "[", "3", "]"}]}], "}"}]}], "}"}], "]"}]}], 
                  "}"}], ",", 
                 RowBox[{"pt2", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xE", "[", "3", "]"}], ",", 
                    RowBox[{"yE", "[", "3", "]"}]}], "}"}], ",", "colE1"}], 
                  "]"}], ",", 
                 RowBox[{"label2", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"\"\<E\>\"", ",", "3"}], "}"}], ",", "colE1", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xE", "[", "3", "]"}], ",", 
                    RowBox[{"yE", "[", "3", "]"}]}], "}"}]}], "]"}]}], 
                "}"}]}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", "SOLUTION", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MCR", "\[Equal]", "11"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Dashed", ",", "colE1", ",", 
                   RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xE", "[", "#", "]"}], ",", 
                    RowBox[{"yE", "[", "#", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xR", "[", "#", "]"}], ",", 
                    RowBox[{"yR", "[", "#", "]"}]}], "}"}]}], "}"}], "]"}], 
                   ",", "colR", ",", 
                   RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xR", "[", "#", "]"}], ",", 
                    RowBox[{"yR", "[", "#", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xE", "[", 
                    RowBox[{"#", "+", "1"}], "]"}], ",", 
                    RowBox[{"yE", "[", 
                    RowBox[{"#", "+", "1"}], "]"}]}], "}"}]}], "}"}], "]"}]}],
                   "}"}], "&"}], "/@", 
                RowBox[{"Range", "@", "n"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"pt2", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xE", "[", "#", "]"}], ",", 
                    RowBox[{"yE", "[", "#", "]"}]}], "}"}], ",", "colE1"}], 
                    "]"}], ",", 
                   RowBox[{"label2", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<E\>\"", ",", "#"}], "}"}], ",", "colE1", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xE", "[", "#", "]"}], ",", 
                    RowBox[{"yE", "[", "#", "]"}]}], "}"}]}], "]"}]}], "}"}], 
                 "&"}], "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"2", ",", "n"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"pt2", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xR", "[", "#", "]"}], ",", 
                    RowBox[{"yR", "[", "#", "]"}]}], "}"}], ",", "colR"}], 
                    "]"}], ",", 
                   RowBox[{"label2", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<R\>\"", ",", "#"}], "}"}], ",", "colR", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xR", "[", "#", "]"}], ",", 
                    RowBox[{"yR", "[", "#", "]"}]}], "}"}]}], "]"}]}], "}"}], 
                 "&"}], "/@", 
                RowBox[{"Range", "@", "n"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", ",", "#", ",", "\"\< \>\""}], 
                    "}"}]}], ",", "18", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"xE", "[", "#", "]"}], "+", 
                    RowBox[{"xR", "[", "#", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"yE", "[", "#", "]"}], "+", 
                    RowBox[{"yR", "[", "#", "]"}]}]}], "}"}], "/", "2"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1.5"}]}], "}"}]}], "]"}], "&"}], "/@", 
                RowBox[{"Range", "@", "n"}]}]}], "\[IndentingNewLine]", 
              "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Grid", "@", 
    RowBox[{"{", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{"\"\<new problem\>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"reset", "<", "1000"}], ",", 
             RowBox[{"reset", "=", 
              RowBox[{"reset", "+", "1"}]}], ",", 
             RowBox[{"reset", "=", 
              RowBox[{"reset", "-", "1"}]}]}], "]"}], ",", 
           RowBox[{"MCR", "=", "1"}], ",", 
           RowBox[{"solution", "=", "False"}], ",", 
           RowBox[{"hint", "=", "False"}], ",", 
           RowBox[{"feed", "=", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "0.7"}], "}"}]}], ",", 
           RowBox[{"solvent", "=", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "0.7"}], "}"}]}], ",", 
           RowBox[{"raffinateN", "=", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "0.7"}], "}"}]}], ",", 
           RowBox[{"mixing", "=", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "0.7"}], "}"}]}], ",", 
           RowBox[{"extract1", "=", 
            RowBox[{"{", 
             RowBox[{"0.4", ",", "0.3"}], "}"}]}], ",", 
           RowBox[{"operatingpt", "=", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "0.7"}], "}"}]}], ",", 
           RowBox[{"raffinate1", "=", 
            RowBox[{"{", 
             RowBox[{"0.6", ",", "0.3"}], "}"}]}], ",", 
           RowBox[{"rafinate2", "=", 
            RowBox[{"{", 
             RowBox[{"0.6", ",", "0.3"}], "}"}]}], ",", 
           RowBox[{"raffinate3", "=", 
            RowBox[{"{", 
             RowBox[{"0.6", ",", "0.3"}], "}"}]}], ",", 
           RowBox[{"rafinate4", "=", 
            RowBox[{"{", 
             RowBox[{"0.6", ",", "0.3"}], "}"}]}], ",", 
           RowBox[{"rafinate5", "=", 
            RowBox[{"{", 
             RowBox[{"0.6", ",", "0.3"}], "}"}]}], ",", 
           RowBox[{"extract2", "=", 
            RowBox[{"{", 
             RowBox[{"0.4", ",", "0.15"}], "}"}]}], ",", 
           RowBox[{"extract3", "=", 
            RowBox[{"{", 
             RowBox[{"0.4", ",", "0.15"}], "}"}]}], ",", 
           RowBox[{"extract4", "=", 
            RowBox[{"{", 
             RowBox[{"0.4", ",", "0.15"}], "}"}]}], ",", 
           RowBox[{"extract5", "=", 
            RowBox[{"{", 
             RowBox[{"0.4", ",", "0.15"}], "}"}]}], ",", 
           RowBox[{"extract6", "=", 
            RowBox[{"{", 
             RowBox[{"0.4", ",", "0.15"}], "}"}]}], ",", 
           RowBox[{"Estage", "=", "1"}], ",", 
           RowBox[{"Rstage", "=", "1"}]}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"reset", ",", "1"}], "}"}], ",", "1", ",", "1000", ",", 
          "1", ",", "None"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PaneSelector", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "\"\<(1) locate feed point\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"2", "\[Rule]", "\"\<(2) locate solvent point\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"3", "\[Rule]", "\"\<(3) locate raffinate point\>\""}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"4", "\[Rule]", "\"\<(4) locate mixing point\>\""}], ",", 
           RowBox[{
           "5", "\[Rule]", "\[IndentingNewLine]", 
            "\"\<(5) locate first extract point\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"6", "\[Rule]", "\"\<(6) locate operating point\>\""}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"7", "\[Rule]", 
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{"\"\<(7) determine \>\"", ",", 
               RowBox[{"Subscript", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<R\>\"", ",", "Italic"}], "]"}], ",", "1"}], 
                "]"}]}], "}"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"8", "\[Rule]", 
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{"\"\<(8) determine \>\"", ",", 
               RowBox[{"Subscript", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<E\>\"", ",", "Italic"}], "]"}], ",", "2"}], 
                "]"}]}], "}"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"9", "\[Rule]", 
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{"\"\<(9) determine \>\"", ",", 
               RowBox[{"Subscript", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<R\>\"", ",", "Italic"}], "]"}], ",", "2"}], 
                "]"}]}], "}"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"10", "\[Rule]", 
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{"\"\<(10) determine \>\"", ",", 
               RowBox[{"Subscript", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<E\>\"", ",", "Italic"}], "]"}], ",", "3"}], 
                "]"}]}], "}"}]}]}], ",", 
           RowBox[{"11", "\[Rule]", "\"\<(11) solution\>\""}]}], 
          "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"Dynamic", "@", "MCR"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"MCR", ",", "1", ",", "\"\<\>\""}], "}"}], ",", 
          RowBox[{"Range", "@", "11"}], ",", "None"}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PaneSelector", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"##", "&"}], "@@", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7",
                ",", "8", ",", "9", ",", "10"}], "}"}], "\[Rule]", 
             RowBox[{"Button", "[", 
              RowBox[{"\"\<next\>\"", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"1", "\[LessEqual]", "MCR", "<", "11"}], ",", 
                   RowBox[{"MCR", "=", 
                    RowBox[{"MCR", "+", "1"}]}], ",", 
                   RowBox[{"MCR", "=", "11"}]}], "]"}], ",", 
                 RowBox[{"solution", "=", "False"}], ",", 
                 RowBox[{"hint", "=", "False"}]}], "}"}]}], "]"}]}], "]"}]}], 
          "}"}], ",", 
         RowBox[{"Dynamic", "@", "MCR"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PaneSelector", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"##", "&"}], "@@", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7",
                ",", "8", ",", "9", ",", "10"}], "}"}], "\[Rule]", 
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"solution", ",", "False", ",", "\"\<solution\>\""}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}], ",", 
                RowBox[{"Enabled", "\[Rule]", 
                 RowBox[{"If", "[", 
                  RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}], 
               "}"}], "]"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"Dynamic", "@", "MCR"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PaneSelector", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"##", "&"}], "@@", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7",
                ",", "8", ",", "9", ",", "10"}], "}"}], "\[Rule]", 
             RowBox[{"Control", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"hint", ",", "False", ",", "\"\<hint\>\""}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"Dynamic", "@", "MCR"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PaneSelector", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", 
            RowBox[{"Control", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"feed", ",", 
                 RowBox[{"{", 
                  RowBox[{"0.5", ",", "0.7"}], "}"}]}], "}"}], ",", "Locator",
                ",", 
               RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
               RowBox[{"Enabled", "\[Rule]", 
                RowBox[{"If", "[", 
                 RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}], 
              "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"2", "\[Rule]", 
            RowBox[{"Control", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"solvent", ",", 
                 RowBox[{"{", 
                  RowBox[{"0.5", ",", "0.7"}], "}"}]}], "}"}], ",", "Locator",
                ",", 
               RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
               RowBox[{"Enabled", "\[Rule]", 
                RowBox[{"If", "[", 
                 RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}], 
              "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"3", "\[Rule]", 
            RowBox[{"Control", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"raffinateN", ",", 
                 RowBox[{"{", 
                  RowBox[{"0.5", ",", "0.7"}], "}"}]}], "}"}], ",", "Locator",
                ",", 
               RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
               RowBox[{"Enabled", "\[Rule]", 
                RowBox[{"If", "[", 
                 RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}], 
              "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"4", "\[Rule]", 
            RowBox[{"Control", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"mixing", ",", 
                 RowBox[{"{", 
                  RowBox[{"0.5", ",", "0.7"}], "}"}]}], "}"}], ",", "Locator",
                ",", 
               RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
               RowBox[{"Enabled", "\[Rule]", 
                RowBox[{"If", "[", 
                 RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}], 
              "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"5", "\[Rule]", 
            RowBox[{"Control", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"extract1", ",", 
                 RowBox[{"{", 
                  RowBox[{"0.4", ",", "0.3"}], "}"}]}], "}"}], ",", "Locator",
                ",", 
               RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
               RowBox[{"Enabled", "\[Rule]", 
                RowBox[{"If", "[", 
                 RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}], 
              "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"6", "\[Rule]", 
            RowBox[{"Control", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"operatingpt", ",", 
                 RowBox[{"{", 
                  RowBox[{"0.5", ",", "0.7"}], "}"}]}], "}"}], ",", "Locator",
                ",", 
               RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
               RowBox[{"Enabled", "\[Rule]", 
                RowBox[{"If", "[", 
                 RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}], 
              "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"7", "\[Rule]", 
            RowBox[{"Control", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"raffinate1", ",", 
                 RowBox[{"{", 
                  RowBox[{"0.6", ",", "0.3"}], "}"}]}], "}"}], ",", "Locator",
                ",", 
               RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
               RowBox[{"Enabled", "\[Rule]", 
                RowBox[{"If", "[", 
                 RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}], 
              "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"8", "\[Rule]", 
            RowBox[{"Control", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"extract2", ",", 
                 RowBox[{"{", 
                  RowBox[{"0.4", ",", "0.15"}], "}"}]}], "}"}], ",", 
               "Locator", ",", 
               RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
               RowBox[{"Enabled", "\[Rule]", 
                RowBox[{"If", "[", 
                 RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}], 
              "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"9", "\[Rule]", 
            RowBox[{"Control", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"raffinate2", ",", 
                 RowBox[{"{", 
                  RowBox[{"0.6", ",", "0.3"}], "}"}]}], "}"}], ",", "Locator",
                ",", 
               RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
               RowBox[{"Enabled", "\[Rule]", 
                RowBox[{"If", "[", 
                 RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}], 
              "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"10", "\[Rule]", 
            RowBox[{"Control", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"extract3", ",", 
                 RowBox[{"{", 
                  RowBox[{"0.4", ",", "0.15"}], "}"}]}], "}"}], ",", 
               "Locator", ",", 
               RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
               RowBox[{"Enabled", "\[Rule]", 
                RowBox[{"If", "[", 
                 RowBox[{"solution", ",", "False", ",", "True"}], "]"}]}]}], 
              "}"}], "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"Dynamic", "@", "MCR"}]}], "]"}]}], "\[IndentingNewLine]", 
      "}"}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"SaveDefinitions", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.724685799046118*^9, 3.724685815089817*^9}, {
   3.7246858804831486`*^9, 3.7246860566386776`*^9}, 3.7246861470681405`*^9, {
   3.7246861851501265`*^9, 3.72468621513488*^9}, {3.7246862622671323`*^9, 
   3.7246863215152397`*^9}, {3.724686358344025*^9, 3.7246863934724035`*^9}, {
   3.7246864271321764`*^9, 3.7246864838848615`*^9}, {3.724686531584711*^9, 
   3.724686614101141*^9}, {3.724686722653504*^9, 3.72468673445916*^9}, {
   3.7246867681225405`*^9, 3.724686927217575*^9}, {3.7246869663009634`*^9, 
   3.724687223347687*^9}, {3.7246872727601423`*^9, 3.7246872897266235`*^9}, {
   3.7246873284852257`*^9, 3.7246875631462374`*^9}, {3.724687719705058*^9, 
   3.7246877291531096`*^9}, 3.724687762093669*^9, {3.724687798659069*^9, 
   3.724687917516675*^9}, {3.7246882547886333`*^9, 3.7246882730875216`*^9}, {
   3.7246883470373077`*^9, 3.7246883589401803`*^9}, {3.7246885521235466`*^9, 
   3.72468860704523*^9}, {3.7246887247548437`*^9, 3.7246889075509925`*^9}, {
   3.724689006672904*^9, 3.7246890938579445`*^9}, {3.724689158763875*^9, 
   3.7246892326348505`*^9}, {3.724689273576457*^9, 3.7246893260311375`*^9}, {
   3.724689500382223*^9, 3.724689610747198*^9}, {3.7247702722508297`*^9, 
   3.7247706696875343`*^9}, {3.7247709044155755`*^9, 3.724770923305679*^9}, {
   3.724771022490589*^9, 3.7247711239783297`*^9}, {3.724771187345853*^9, 
   3.724771207403557*^9}, {3.724858399984349*^9, 3.724858467216194*^9}, {
   3.7248585045253286`*^9, 3.724858547071762*^9}, {3.724858614142598*^9, 
   3.724858619348896*^9}, {3.7248586572620645`*^9, 3.7248587384627085`*^9}, {
   3.7248587723046446`*^9, 3.724858781827189*^9}, {3.7248589037271614`*^9, 
   3.724859133756318*^9}, {3.7248592296358023`*^9, 3.724859580993899*^9}, {
   3.724859629777689*^9, 3.724859685618883*^9}, {3.7248597220749683`*^9, 
   3.72485979467212*^9}, {3.724859878480914*^9, 3.724859933715073*^9}, {
   3.7248599689410877`*^9, 3.724860391047231*^9}, {3.7250266554308057`*^9, 
   3.725026903037685*^9}, {3.725026940438278*^9, 3.7250269440461006`*^9}, {
   3.7250269847331147`*^9, 3.7250270934368873`*^9}, 3.7250272746809297`*^9, {
   3.7250273057090907`*^9, 3.7250273351274405`*^9}, {3.7250273780056643`*^9, 
   3.725027906015194*^9}, {3.7250282007471232`*^9, 3.7250284527154455`*^9}, {
   3.7250285340720634`*^9, 3.725028725013047*^9}, {3.7250287934974008`*^9, 
   3.7250288533603106`*^9}, {3.7250289559130335`*^9, 3.725028978284956*^9}, {
   3.7250292823253207`*^9, 3.725029358340708*^9}, {3.7250294091345654`*^9, 
   3.7250294388569155`*^9}, {3.7250295115808773`*^9, 3.7250296514112096`*^9}, 
   3.7250296930108275`*^9, {3.725029734984036*^9, 3.7250297996977696`*^9}, 
   3.7250300438864193`*^9, {3.7250301059777403`*^9, 3.7250301607008224`*^9}, {
   3.725030202762639*^9, 3.7250304434632883`*^9}, {3.725030484614705*^9, 
   3.725030543740616*^9}, {3.7250305790575953`*^9, 3.7250307719327717`*^9}, {
   3.725030854903408*^9, 3.7250311447671027`*^9}, {3.7250311861897106`*^9, 
   3.725031211998639*^9}, {3.72503126558752*^9, 3.725031313742361*^9}, {
   3.7251167591451917`*^9, 3.72511697431423*^9}, {3.7251173239227753`*^9, 
   3.725117393239173*^9}, {3.7251176615753164`*^9, 3.725117750389222*^9}, {
   3.725117781066989*^9, 3.7251178186351833`*^9}, {3.725117854396386*^9, 
   3.725118096827962*^9}, {3.725118130609535*^9, 3.725118180934832*^9}, {
   3.7251183395549083`*^9, 3.7251183485821643`*^9}, {3.725202638833725*^9, 
   3.7252026415249476`*^9}, {3.7252026720349464`*^9, 
   3.7252026818292117`*^9}, {3.725202755092899*^9, 3.72520284794591*^9}, {
   3.72520292389441*^9, 3.7252029363731003`*^9}, {3.7252117825460634`*^9, 
   3.7252117902031136`*^9}, {3.7252121722894773`*^9, 
   3.7252121741808977`*^9}, {3.725212244057374*^9, 3.725212255385231*^9}, {
   3.7256323412348843`*^9, 3.7256323435553055`*^9}, {3.7264113831725187`*^9, 
   3.7264113902439227`*^9}, {3.7264114457300963`*^9, 
   3.7264114847663293`*^9}, {3.7264118511362844`*^9, 3.7264118660381365`*^9}, 
   3.7264119336900063`*^9, {3.726411968863018*^9, 3.726411984532914*^9}, {
   3.726412023725156*^9, 3.7264120548619366`*^9}, {3.7264121079699745`*^9, 
   3.7264121308972855`*^9}, {3.726412194317913*^9, 3.726412194833943*^9}, {
   3.7264122920685043`*^9, 3.726412313308719*^9}, {3.7264123643696394`*^9, 
   3.7264124153635564`*^9}, {3.7268469096615677`*^9, 
   3.7268469291674185`*^9}, {3.726846963017023*^9, 3.7268469909956236`*^9}, {
   3.726847105032146*^9, 3.7268471584151993`*^9}, {3.726847206201933*^9, 
   3.726847252676591*^9}, {3.727193948998707*^9, 3.727193954359256*^9}, {
   3.7271940373900857`*^9, 3.727194087200653*^9}, {3.727194180467352*^9, 
   3.7271941815316525`*^9}, {3.727194376566284*^9, 3.7271943878437967`*^9}, {
   3.727194436511919*^9, 3.7271944379528303`*^9}, {3.727194522669653*^9, 
   3.7271945371690083`*^9}, {3.727194584624886*^9, 3.727194653935609*^9}, {
   3.7271948768105364`*^9, 3.7271948826552467`*^9}, {3.727194935702636*^9, 
   3.7271949365624995`*^9}, {3.727195169811696*^9, 3.7271952138490124`*^9}, {
   3.7271953914794607`*^9, 3.7271954099874067`*^9}, {3.7271958114213057`*^9, 
   3.727195823971637*^9}, 3.727449105539003*^9, {3.727449229325083*^9, 
   3.7274493106167326`*^9}, 3.7274493495329585`*^9, {3.727449380636738*^9, 
   3.727449433188743*^9}, {3.7274494820965405`*^9, 3.7274495426790056`*^9}, {
   3.7274495775890026`*^9, 3.727449590884763*^9}, {3.7274496309550548`*^9, 
   3.727449635487314*^9}, {3.7274497102365894`*^9, 3.727449862608305*^9}, {
   3.7274499126261654`*^9, 3.7274501854207687`*^9}, {3.7274502343075647`*^9, 
   3.727450250633498*^9}, {3.728832084509528*^9, 3.7288321372555447`*^9}, {
   3.729348519053709*^9, 3.729348564899534*^9}, {3.7293486328614836`*^9, 
   3.7293487610771446`*^9}, {3.729348808661375*^9, 3.729349017104333*^9}, {
   3.7293490515505085`*^9, 3.729349095329716*^9}, {3.7293491320761175`*^9, 
   3.729349156897046*^9}, {3.7293491905890017`*^9, 3.7293492392186546`*^9}, {
   3.7293492853200855`*^9, 3.729349340999571*^9}, {3.729349440596074*^9, 
   3.7293494602177753`*^9}, 3.72934960306779*^9, {3.7293496974552603`*^9, 
   3.729349720859268*^9}, {3.7293497696258106`*^9, 3.729349796405239*^9}, {
   3.729349837331043*^9, 3.729349837576255*^9}, {3.729349880584259*^9, 
   3.729349929291005*^9}, {3.72934997416183*^9, 3.729350055423028*^9}, {
   3.729350128126893*^9, 3.729350156041322*^9}, 3.7293502153620186`*^9, {
   3.7293502682268925`*^9, 3.7293502686636934`*^9}, {3.7293503354440207`*^9, 
   3.729350386034068*^9}, {3.7293504826762476`*^9, 3.729350494417516*^9}, {
   3.729367158250085*^9, 3.7293671904219246`*^9}, 3.7307389791382713`*^9, {
   3.7307391647978897`*^9, 3.730739169703171*^9}, {3.7307397349691706`*^9, 
   3.7307397390764055`*^9}, 3.730739790516348*^9, {3.7308151829614887`*^9, 
   3.73081524207187*^9}, {3.7308152912706842`*^9, 3.730815316954153*^9}, {
   3.730815354609307*^9, 3.730815355213341*^9}, 3.730815417675914*^9, {
   3.7308210833279705`*^9, 3.7308212002756596`*^9}, 3.7308217892533474`*^9, {
   3.730821827636543*^9, 3.730821838512165*^9}, {3.730823492997796*^9, 
   3.730823503523398*^9}, {3.731085835783742*^9, 3.7310858360847597`*^9}, {
   3.7312544563551517`*^9, 3.7312544699704*^9}, {3.731323309953328*^9, 
   3.731323310057334*^9}, {3.731323377705203*^9, 3.731323593644554*^9}, {
   3.731323663578554*^9, 3.731324003681343*^9}, {3.731324115136718*^9, 
   3.7313241495016837`*^9}, {3.7313241840256586`*^9, 3.731324350986208*^9}, {
   3.7313243955087547`*^9, 3.731324440163308*^9}, {3.731324478756516*^9, 
   3.7313245344887037`*^9}, {3.731328197729229*^9, 3.731328407438224*^9}, {
   3.7313322125278625`*^9, 3.7313324107492*^9}, {3.731332457044848*^9, 
   3.7313325878983326`*^9}, {3.731332651393964*^9, 3.7313326777864733`*^9}, 
   3.732631902662121*^9, {3.732631964985135*^9, 3.73263198462733*^9}, {
   3.7326320233871603`*^9, 3.732632024712838*^9}, 3.732633446123847*^9, {
   3.7326339843250504`*^9, 3.7326341247506123`*^9}, {3.7326341897955914`*^9, 
   3.732634212826535*^9}, {3.732634251000894*^9, 3.732634294043435*^9}, 
   3.732634342006035*^9, {3.732634378063328*^9, 3.732634435990905*^9}, 
   3.732634473409562*^9, {3.7326345333288393`*^9, 3.732634551700416*^9}, {
   3.732634928272544*^9, 3.732634947216333*^9}, {3.732635035433607*^9, 
   3.73263506057124*^9}, {3.7326350922865553`*^9, 3.7326350923474903`*^9}, {
   3.732635144364822*^9, 3.732635144426443*^9}, 3.7326353789749317`*^9, 
   3.7326354328171997`*^9, {3.73263546615903*^9, 3.732635466206759*^9}, {
   3.7326355294133987`*^9, 3.7326355827177*^9}, {3.732635619571357*^9, 
   3.732635648135119*^9}, {3.732635686769013*^9, 3.732635693946597*^9}, {
   3.732636895641262*^9, 3.732636918332635*^9}, {3.732636972642481*^9, 
   3.732636990423736*^9}, {3.732637025724154*^9, 3.7326370285639143`*^9}, {
   3.7326370627066097`*^9, 3.732637067416913*^9}, {3.732637108215963*^9, 
   3.7326371145522738`*^9}, {3.732637197530074*^9, 3.732637207342677*^9}, {
   3.732638287374831*^9, 3.732638321339005*^9}, {3.7601902365462465`*^9, 
   3.7601902795007067`*^9}, {3.7601903266113844`*^9, 3.760190327228587*^9}, {
   3.762017216266293*^9, 
   3.762017216483941*^9}},ExpressionUUID->"2270e6d3-b229-4dcb-92a0-\
d4975bd41447"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`extract1$$ = {0.4, 
    0.3}, $CellContext`extract2$$ = {0.4, 0.15}, $CellContext`extract3$$ = {
    0.4, 0.15}, $CellContext`feed$$ = {0.5, 0.7}, $CellContext`hint$$ = 
    False, $CellContext`MCR$$ = 1, $CellContext`mixing$$ = {0.5, 
    0.7}, $CellContext`operatingpt$$ = {0.5, 
    0.7}, $CellContext`raffinate1$$ = {0.6, 
    0.3}, $CellContext`raffinate2$$ = {0.6, 
    0.3}, $CellContext`raffinateN$$ = {0.5, 0.7}, $CellContext`reset$$ = 
    1, $CellContext`solution$$ = False, $CellContext`solvent$$ = {0.5, 0.7}, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`reset$$], 1}, 1, 1000, 1}, {{
       Hold[$CellContext`MCR$$], 1, ""}, {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 
      11}}, {{
       Hold[$CellContext`solution$$], False, "solution"}, {True, False}}, {{
       Hold[$CellContext`hint$$], False, "hint"}, {True, False}}, {{
       Hold[$CellContext`feed$$], {0.5, 0.7}}, Automatic}, {{
       Hold[$CellContext`solvent$$], {0.5, 0.7}}, Automatic}, {{
       Hold[$CellContext`raffinateN$$], {0.5, 0.7}}, Automatic}, {{
       Hold[$CellContext`mixing$$], {0.5, 0.7}}, Automatic}, {{
       Hold[$CellContext`extract1$$], {0.4, 0.3}}, Automatic}, {{
       Hold[$CellContext`operatingpt$$], {0.5, 0.7}}, Automatic}, {{
       Hold[$CellContext`raffinate1$$], {0.6, 0.3}}, Automatic}, {{
       Hold[$CellContext`extract2$$], {0.4, 0.15}}, Automatic}, {{
       Hold[$CellContext`raffinate2$$], {0.6, 0.3}}, Automatic}, {{
       Hold[$CellContext`extract3$$], {0.4, 0.15}}, Automatic}, {
      Hold[
       Grid[{{
          Button["new problem", {
            
            If[$CellContext`reset$$ < 
             1000, $CellContext`reset$$ = $CellContext`reset$$ + 
              1, $CellContext`reset$$ = $CellContext`reset$$ - 
              1], $CellContext`MCR$$ = 1, $CellContext`solution$$ = 
            False, $CellContext`hint$$ = 
            False, $CellContext`feed$$ = {0.5, 
             0.7}, $CellContext`solvent$$ = {0.5, 
             0.7}, $CellContext`raffinateN$$ = {0.5, 
             0.7}, $CellContext`mixing$$ = {0.5, 
             0.7}, $CellContext`extract1$$ = {0.4, 
             0.3}, $CellContext`operatingpt$$ = {0.5, 
             0.7}, $CellContext`raffinate1$$ = {0.6, 
             0.3}, $CellContext`rafinate2 = {0.6, 
             0.3}, $CellContext`raffinate3 = {0.6, 
             0.3}, $CellContext`rafinate4 = {0.6, 
             0.3}, $CellContext`rafinate5 = {0.6, 
             0.3}, $CellContext`extract2$$ = {0.4, 
             0.15}, $CellContext`extract3$$ = {0.4, 
             0.15}, $CellContext`extract4 = {0.4, 
             0.15}, $CellContext`extract5 = {0.4, 
             0.15}, $CellContext`extract6 = {0.4, 0.15}, $CellContext`Estage = 
            1, $CellContext`Rstage = 1}], 
          Manipulate`Place[1], 
          
          PaneSelector[{
           1 -> "(1) locate feed point", 2 -> "(2) locate solvent point", 3 -> 
            "(3) locate raffinate point", 4 -> "(4) locate mixing point", 5 -> 
            "(5) locate first extract point", 6 -> 
            "(6) locate operating point", 7 -> Row[{"(7) determine ", 
               Subscript[
                Style["R", Italic], 1]}], 8 -> Row[{"(8) determine ", 
               Subscript[
                Style["E", Italic], 2]}], 9 -> Row[{"(9) determine ", 
               Subscript[
                Style["R", Italic], 2]}], 10 -> Row[{"(10) determine ", 
               Subscript[
                Style["E", Italic], 3]}], 11 -> "(11) solution"}, 
           Dynamic[$CellContext`MCR$$]], 
          Manipulate`Place[2], 
          PaneSelector[{1 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 2 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 3 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 4 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 5 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 6 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 7 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 8 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 9 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 10 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}]}, 
           Dynamic[$CellContext`MCR$$]], 
          
          PaneSelector[{
           1 -> Manipulate`Place[3], 2 -> Manipulate`Place[3], 3 -> 
            Manipulate`Place[3], 4 -> Manipulate`Place[3], 5 -> 
            Manipulate`Place[3], 6 -> Manipulate`Place[3], 7 -> 
            Manipulate`Place[3], 8 -> Manipulate`Place[3], 9 -> 
            Manipulate`Place[3], 10 -> Manipulate`Place[3]}, 
           Dynamic[$CellContext`MCR$$]], 
          
          PaneSelector[{
           1 -> Manipulate`Place[4], 2 -> Manipulate`Place[4], 3 -> 
            Manipulate`Place[4], 4 -> Manipulate`Place[4], 5 -> 
            Manipulate`Place[4], 6 -> Manipulate`Place[4], 7 -> 
            Manipulate`Place[4], 8 -> Manipulate`Place[4], 9 -> 
            Manipulate`Place[4], 10 -> Manipulate`Place[4]}, 
           Dynamic[$CellContext`MCR$$]], 
          
          PaneSelector[{
           1 -> Manipulate`Place[5], 2 -> Manipulate`Place[6], 3 -> 
            Manipulate`Place[7], 4 -> Manipulate`Place[8], 5 -> 
            Manipulate`Place[9], 6 -> Manipulate`Place[10], 7 -> 
            Manipulate`Place[11], 8 -> Manipulate`Place[12], 9 -> 
            Manipulate`Place[13], 10 -> Manipulate`Place[14]}, 
           Dynamic[$CellContext`MCR$$]]}}]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    600., {193., 197.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`reset$81342$$ = 
    0, $CellContext`MCR$81343$$ = 0, $CellContext`solution$81344$$ = 
    False, $CellContext`hint$81345$$ = False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`extract1$$ = {0.4, 
         0.3}, $CellContext`extract2$$ = {0.4, 
         0.15}, $CellContext`extract3$$ = {0.4, 0.15}, $CellContext`feed$$ = {
         0.5, 0.7}, $CellContext`hint$$ = False, $CellContext`MCR$$ = 
        1, $CellContext`mixing$$ = {0.5, 0.7}, $CellContext`operatingpt$$ = {
         0.5, 0.7}, $CellContext`raffinate1$$ = {0.6, 
         0.3}, $CellContext`raffinate2$$ = {0.6, 
         0.3}, $CellContext`raffinateN$$ = {0.5, 0.7}, $CellContext`reset$$ = 
        1, $CellContext`solution$$ = 
        False, $CellContext`solvent$$ = {0.5, 0.7}}, "ControllerVariables" :> {
        Hold[$CellContext`reset$$, $CellContext`reset$81342$$, 0], 
        Hold[$CellContext`MCR$$, $CellContext`MCR$81343$$, 0], 
        Hold[$CellContext`solution$$, $CellContext`solution$81344$$, False], 
        Hold[$CellContext`hint$$, $CellContext`hint$81345$$, False]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`x1$, $CellContext`y1$, $CellContext`x2$, \
$CellContext`y2$, $CellContext`x3$, $CellContext`y3$, $CellContext`sol$, \
$CellContext`a$, $CellContext`b$, $CellContext`c$, $CellContext`phase$, \
$CellContext`yt$, $CellContext`xt$, $CellContext`tie$, \
$CellContext`phaseplot$, $CellContext`tielines$, $CellContext`F$, \
$CellContext`S$, $CellContext`M$, $CellContext`xF$, $CellContext`yF$, \
$CellContext`xRN$, $CellContext`yRN$, $CellContext`Msol$, $CellContext`xM$, \
$CellContext`yM$, $CellContext`xE$, $CellContext`yE$, $CellContext`xP$, \
$CellContext`yP$, $CellContext`operating$, $CellContext`lower$, \
$CellContext`upper$, $CellContext`lever$, $CellContext`newtie$, \
$CellContext`xtie$, $CellContext`xR$, $CellContext`yR$, $CellContext`n$, \
$CellContext`plotlabel$}, 
        SeedRandom[$CellContext`reset$$]; $CellContext`x1$ = 
         RandomReal[{0.02, 0.07}]; $CellContext`y1$ = 0; $CellContext`x2$ = 
         RandomReal[{0.45, 0.55}]; $CellContext`y2$ = 
         RandomReal[{0.3, 0.4}]; $CellContext`x3$ = 
         RandomReal[{0.85, 0.98}]; $CellContext`y3$ = 0; $CellContext`sol$ = 
         Quiet[
           Part[
            
            Solve[{$CellContext`\[Alpha] $CellContext`x1$^2 + $CellContext`\
\[Beta] $CellContext`x1$ + $CellContext`\[Chi] == $CellContext`y1$, \
$CellContext`\[Alpha] $CellContext`x2$^2 + $CellContext`\[Beta] \
$CellContext`x2$ + $CellContext`\[Chi] == $CellContext`y2$, $CellContext`\
\[Alpha] $CellContext`x3$^2 + $CellContext`\[Beta] $CellContext`x3$ + \
$CellContext`\[Chi] == $CellContext`y3$}, {$CellContext`\[Alpha], \
$CellContext`\[Beta], $CellContext`\[Chi]}], 1]]; $CellContext`a$ = 
         ReplaceAll[$CellContext`\[Alpha], $CellContext`sol$]; \
$CellContext`b$ = 
         ReplaceAll[$CellContext`\[Beta], $CellContext`sol$]; $CellContext`c$ = 
         ReplaceAll[$CellContext`\[Chi], $CellContext`sol$]; \
$CellContext`phase$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`a$ $CellContext`x$^2 + $CellContext`b$ \
$CellContext`x$ + $CellContext`c$; $CellContext`yt$[1] = 
         RandomReal[{0.02, 0.05} $CellContext`y2$]; $CellContext`xt$[1] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              1], $CellContext`x], 1]]; $CellContext`yt$[2] = 
         RandomReal[{0.06, 0.1} $CellContext`y2$]; $CellContext`xt$[2] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              2], $CellContext`x], 2]]; $CellContext`tie$[1][
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yt$[2] - $CellContext`yt$[
             1])/($CellContext`xt$[2] - $CellContext`xt$[
            1])) ($CellContext`x$ - $CellContext`xt$[1]) + $CellContext`yt$[
           1]; $CellContext`yt$[3] = 
         RandomReal[{0.15, 0.2} $CellContext`y2$]; $CellContext`xt$[3] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              3], $CellContext`x], 1]]; $CellContext`yt$[4] = 
         RandomReal[{0.25, 0.3} $CellContext`y2$]; $CellContext`xt$[4] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              4], $CellContext`x], 2]]; $CellContext`tie$[2][
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yt$[4] - $CellContext`yt$[
             3])/($CellContext`xt$[4] - $CellContext`xt$[
            3])) ($CellContext`x$ - $CellContext`xt$[3]) + $CellContext`yt$[
           3]; $CellContext`yt$[5] = 
         RandomReal[{0.35, 0.4} $CellContext`y2$]; $CellContext`xt$[5] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              5], $CellContext`x], 1]]; $CellContext`yt$[6] = 
         RandomReal[{0.5, 0.55} $CellContext`y2$]; $CellContext`xt$[6] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              6], $CellContext`x], 2]]; $CellContext`tie$[3][
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yt$[6] - $CellContext`yt$[
             5])/($CellContext`xt$[6] - $CellContext`xt$[
            5])) ($CellContext`x$ - $CellContext`xt$[5]) + $CellContext`yt$[
           5]; $CellContext`yt$[7] = 
         RandomReal[{0.72, 0.77} $CellContext`y2$]; $CellContext`xt$[7] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              7], $CellContext`x], 1]]; $CellContext`yt$[8] = 
         RandomReal[{0.8, 0.9} $CellContext`y2$]; $CellContext`xt$[8] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              8], $CellContext`x], 2]]; $CellContext`tie$[4][
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yt$[8] - $CellContext`yt$[
             7])/($CellContext`xt$[8] - $CellContext`xt$[
            7])) ($CellContext`x$ - $CellContext`xt$[7]) + $CellContext`yt$[
           7]; $CellContext`phaseplot$ = Plot[
           $CellContext`phase$[$CellContext`x], {$CellContext`x, \
$CellContext`x1$, $CellContext`x3$}, PlotStyle -> {Thick, Black}, 
           PlotRange -> {{0, 1}, {0, Sqrt[3]/2}}]; $CellContext`tielines$ = 
         Graphics[{
            Thickness[0.004], 
            Line[{{
               $CellContext`xt$[1], 
               $CellContext`yt$[1]}, {
               $CellContext`xt$[2], 
               $CellContext`yt$[2]}}], 
            Line[{{
               $CellContext`xt$[3], 
               $CellContext`yt$[3]}, {
               $CellContext`xt$[4], 
               $CellContext`yt$[4]}}], 
            Line[{{
               $CellContext`xt$[5], 
               $CellContext`yt$[5]}, {
               $CellContext`xt$[6], 
               $CellContext`yt$[6]}}], 
            Line[{{
               $CellContext`xt$[7], 
               $CellContext`yt$[7]}, {
               $CellContext`xt$[8], 
               $CellContext`yt$[8]}}]}]; $CellContext`F$ = 
         RandomInteger[{1000, 1500}]; $CellContext`S$ = 
         RandomInteger[{1500, 
           2000}]; $CellContext`M$ = $CellContext`F$ + $CellContext`S$; \
$CellContext`xF$ = RandomReal[{0.6, 0.7}]; $CellContext`yF$ = 
         RandomReal[{0.4, 0.45}]; $CellContext`xRN$ = 
         0.99 $CellContext`x3$; $CellContext`yRN$ = \
$CellContext`phase$[$CellContext`xRN$]; $CellContext`Msol$ = Quiet[
           First[
            Solve[
             
             And[$CellContext`wtA[$CellContext`yF$] $CellContext`F$ == \
$CellContext`xA $CellContext`M$, $CellContext`wtS[$CellContext`xF$, \
$CellContext`yF$] $CellContext`F$ + $CellContext`S$ == $CellContext`xS \
$CellContext`M$, $CellContext`xA + $CellContext`xS + $CellContext`xC == 
              1], {$CellContext`xA, $CellContext`xS, $CellContext`xC}]]]; \
$CellContext`xM$ = 
         1 - ReplaceAll[$CellContext`xS, $CellContext`Msol$] - \
$CellContext`yM$/Sqrt[3]; $CellContext`yM$ = 
         ReplaceAll[(Sqrt[3]/
            2) $CellContext`xA, $CellContext`Msol$]; $CellContext`xE$[1] = 
         ReplaceAll[$CellContext`x, 
           Quiet[
            First[
             
             Solve[$CellContext`phase$[$CellContext`x] == (($CellContext`yRN$ - \
$CellContext`yM$)/($CellContext`xRN$ - $CellContext`xM$)) ($CellContext`x - \
$CellContext`xRN$) + $CellContext`yRN$, $CellContext`x]]]]; $CellContext`yE$[
          1] = $CellContext`phase$[
           $CellContext`xE$[1]]; $CellContext`xP$ = ReplaceAll[$CellContext`x, 
           Quiet[
            First[
             
             Solve[(($CellContext`yF$ - $CellContext`yE$[
                  1])/($CellContext`xF$ - $CellContext`xE$[
                 1])) ($CellContext`x - $CellContext`xF$) + $CellContext`yF$ == \
($CellContext`yRN$/$CellContext`xRN$) $CellContext`x, $CellContext`x]]]]; \
$CellContext`yP$ = ($CellContext`yRN$/$CellContext`xRN$) $CellContext`xP$; \
$CellContext`operating$[
           Pattern[$CellContext`i$, 
            Blank[]], 
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yR$[$CellContext`i$] - \
$CellContext`yP$)/($CellContext`xR$[$CellContext`i$] - $CellContext`xP$)) \
($CellContext`x$ - $CellContext`xP$) + $CellContext`yP$; $CellContext`lower$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Which[Part[$CellContext`pt$, 2] <= $CellContext`tie$[1][
             Part[$CellContext`pt$, 1]], 0, 
           Inequality[
            $CellContext`tie$[1][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[2][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[1][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[2][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[3][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[2][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[3][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[3][$CellContext`x$], $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]] < Part[$CellContext`pt$, 2], 
           $CellContext`tie$[4][$CellContext`x$]]; $CellContext`upper$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Which[Part[$CellContext`pt$, 2] < $CellContext`tie$[1][
             Part[$CellContext`pt$, 1]], 
           $CellContext`tie$[1][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[1][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[2][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[2][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[2][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[3][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[3][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[3][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[4][$CellContext`x$], $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]] < Part[$CellContext`pt$, 2], 
           $CellContext`tie$[4][$CellContext`x$]]; $CellContext`lever$[
           Pattern[$CellContext`pt$, 
            Blank[]]] := If[Part[$CellContext`pt$, 2] >= $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]], 
           1, (Part[$CellContext`pt$, 
              2] - $CellContext`upper$[$CellContext`pt$, 
             
             Part[$CellContext`pt$, 
              1]])/($CellContext`lower$[$CellContext`pt$, 
             
             Part[$CellContext`pt$, 
              1]] - $CellContext`upper$[$CellContext`pt$, 
            Part[$CellContext`pt$, 1]])]; $CellContext`newtie$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`lever$[$CellContext`pt$] \
$CellContext`lower$[$CellContext`pt$, $CellContext`x$] + (
            1 - $CellContext`lever$[$CellContext`pt$]) \
$CellContext`upper$[$CellContext`pt$, $CellContext`x$]; $CellContext`xtie$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`i$, 
            Blank[]]] := ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`newtie$[$CellContext`pt$, $CellContext`x] == \
$CellContext`phase$[$CellContext`x], $CellContext`x], $CellContext`i$]]; \
$CellContext`xR$[1] = ReplaceAll[$CellContext`x, 
           Part[
            Solve[$CellContext`newtie$[{
                $CellContext`xE$[1], 
                $CellContext`yE$[
                1]}, $CellContext`x] == $CellContext`phase$[$CellContext`x], \
$CellContext`x], 2]]; $CellContext`yR$[1] = $CellContext`phase$[
           $CellContext`xR$[1]]; $CellContext`xE$[2] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`operating$[
              1, $CellContext`x] == $CellContext`phase$[$CellContext`x], \
$CellContext`x], 1]]; $CellContext`yE$[2] = $CellContext`phase$[
           $CellContext`xE$[2]]; 
        Map[If[$CellContext`xR$[# - 
             1] < $CellContext`xRN$, {$CellContext`xR$[#] = 
             ReplaceAll[$CellContext`x, 
               Part[
                Solve[$CellContext`newtie$[{
                    $CellContext`xE$[#], 
                    $CellContext`yE$[#]}, $CellContext`x] == \
$CellContext`phase$[$CellContext`x], $CellContext`x], 
                2]]; $CellContext`yR$[#] = $CellContext`phase$[
               $CellContext`xR$[#]]; $CellContext`xE$[# + 1] = 
             ReplaceAll[$CellContext`x, 
               Part[
                
                Solve[$CellContext`operating$[#, $CellContext`x] == \
$CellContext`phase$[$CellContext`x], $CellContext`x], 1]]; $CellContext`yE$[# + 
               1] = $CellContext`phase$[
               $CellContext`xE$[# + 1]]; Null}]& , 
          Range[2, 10]]; $CellContext`n$ = Part[
           DeleteCases[
            Map[If[$CellContext`xR$[#] < $CellContext`xRN$, 0, #]& , 
             Range[10]], 0], 1]; 
        If[$CellContext`n$ == 
          8, $CellContext`reset$$ = $CellContext`reset$$ + 
           1]; $CellContext`plotlabel$ = Switch[$CellContext`MCR$$, 1, 
           If[$CellContext`hint$$, "hint: read the compositions on the axes", 
            Row[{"Step 1: move the feed point ", 
              Style["F", Italic], 
              " to \nthe correct location, then check solution"}]], 2, 
           If[$CellContext`hint$$, "hint: read the compositions on the axes", 
            Row[{"Step 2: move the solvent point ", 
              Style["S", Italic], 
              " to \nthe correct location, then check solution"}]], 3, 
           If[$CellContext`hint$$, "hint: read the compositions on the axes", 
            Row[{"Step 3: move the desired raffinate point ", 
              Subscript[
               Style["R", Italic], "N"], 
              " to \nthe correct location, then check solution"}]], 4, 
           If[$CellContext`hint$$, "hint: use the lever rule", 
            Row[{"Step 4: use mass balance for two entering streams (", 
              Style["F", Italic], ", ", 
              Style["S", Italic], ")\n to determine the average composition ", 
              Style["M", Italic], ", then check solution"}]], 5, 
           If[$CellContext`hint$$, 
            Row[{"hint: use mass balance for two exit streams (", 
              Subscript[
               Style["R", Italic], "N"], ", ", 
              Subscript[
               Style["E", Italic], 1], ")"}], 
            Row[{"Step 5: move the point for the first extract composition ", 
              Subscript[
               Style["E", Italic], 1], 
              "\n to the correct location, then check solution"}]], 6, 
           If[$CellContext`hint$$, 
            
            Row[{"hint: the operating point is at the intersection of \na \
line through ", 
              Style["F", Italic], " and ", 
              Subscript[
               Style["E", Italic], 1], " and a line through ", 
              Style["S", Italic], " and ", 
              Subscript[
               Style["R", Italic], "N"]}], 
            Row[{"Step 6: move the operating point ", 
              Style["P", Italic], 
              " \nto the correct location, then check solution"}]], 7, 
           
           If[$CellContext`hint$$, 
            "hint: follow the tie line to the other side of the phase \
boundary", 
            "Step 7: move the blue point to the correct raffinate \
composition"], 8, 
           
           If[$CellContext`hint$$, "hint: draw a line to the operating point",
             "Step 8: move the yellow point to the correct extract \
composition"], 9, 
           
           If[$CellContext`hint$$, 
            "hint: follow the tie line to the other side of the phase \
boundary", 
            "Step 9: move the blue point to the correct raffinate \
composition"], 10, 
           
           If[$CellContext`hint$$, "hint: draw a line to the operating point",
             "Step 10: move the yellow point to the correct extract \
composition"], 11, 
           Row[{$CellContext`n$, " stages needed"}]]; Show[
          
          If[$CellContext`MCR$$ <= 
           4, $CellContext`gridLines, {}], $CellContext`base, \
$CellContext`phaseplot$, $CellContext`tielines$, ImageSize -> {600, 390}, 
          PlotRange -> {{-0.25, 1.15}, {-0.1, 0.93}}, 
          ImagePadding -> {{55, 55}, {5, 
             If[$CellContext`hint$$, 
              If[$CellContext`MCR$$ == 6, 15, 35], 
              If[3 <= $CellContext`MCR$$ <= 5, 15, 35]]}}, PlotLabel -> 
          Style[$CellContext`plotlabel$, 17, Black], Epilog -> {Thick, 
            If[$CellContext`MCR$$ == 1, {
              $CellContext`pt1[$CellContext`feed$$, $CellContext`colF], 
              $CellContext`label1[
              "F", $CellContext`colF, $CellContext`feed$$], 
              $CellContext`table1["feed", $CellContext`xF$, $CellContext`yF$], 
              If[$CellContext`solution$$, 
               $CellContext`pt2[{$CellContext`xF$, $CellContext`yF$}, \
$CellContext`colF]]}], 
            If[$CellContext`MCR$$ > 1, {
              $CellContext`pt2[{$CellContext`xF$, $CellContext`yF$}, \
$CellContext`colF], 
              $CellContext`label1[
              "F", $CellContext`colF, {$CellContext`xF$, $CellContext`yF$}]}], 
            If[$CellContext`MCR$$ == 2, {
              $CellContext`pt1[$CellContext`solvent$$, $CellContext`colS], 
              $CellContext`label1[
              "S", $CellContext`colS, $CellContext`solvent$$], 
              $CellContext`table1["solvent", 0, 0], 
              If[$CellContext`solution$$, 
               $CellContext`pt2[{0, 0}, $CellContext`colS]]}], 
            If[$CellContext`MCR$$ > 2, {
              $CellContext`pt2[{0, 0}, $CellContext`colS], 
              $CellContext`label1["S", $CellContext`colS, {0, 0}]}], 
            If[$CellContext`MCR$$ == 3, {
              $CellContext`pt1[$CellContext`raffinateN$$, $CellContext`colR], 
              $CellContext`label2[{
               "R", "N"}, $CellContext`colR, $CellContext`raffinateN$$], 
              $CellContext`table1[
              "raffinate", $CellContext`xRN$, $CellContext`yRN$], 
              If[$CellContext`solution$$, 
               $CellContext`pt2[{$CellContext`xRN$, $CellContext`yRN$}, \
$CellContext`colR]]}], 
            If[$CellContext`MCR$$ > 3, {
              $CellContext`pt2[{$CellContext`xRN$, $CellContext`yRN$}, \
$CellContext`colR], 
              $CellContext`label2[{
               "R", "N"}, $CellContext`colR, {$CellContext`xRN$, \
$CellContext`yRN$}]}], 
            If[$CellContext`MCR$$ == 4, {{Dashed, $CellContext`colM, 
               Line[{{$CellContext`xF$, $CellContext`yF$}, {0, 0}}]}, 
              $CellContext`pt1[$CellContext`mixing$$, $CellContext`colM], 
              $CellContext`label1[
              "M", $CellContext`colM, $CellContext`mixing$$], 
              $CellContext`table2["mixing", 
               Part[$CellContext`mixing$$, 1], 
               Part[$CellContext`mixing$$, 2]], 
              Text[
               Style[
                Column[{"flow rates", 
                  Framed[
                   Column[{
                    Style[
                    Row[{
                    Style["F", Italic], " = ", 
                    NumberForm[$CellContext`F$, {4, 0}], 
                    " kg/h"}], $CellContext`colF], 
                    Style[
                    Row[{
                    Style["S", Italic], " = ", 
                    NumberForm[$CellContext`S$, {4, 0}], 
                    " kg/h"}], $CellContext`colS]}, Alignment -> "="]]}, 
                 Center], 17], {-0.05, 0.75}], 
              If[$CellContext`solution$$, 
               $CellContext`pt2[{$CellContext`xM$, $CellContext`yM$}, \
$CellContext`colM]]}], 
            If[$CellContext`MCR$$ == 5, {
              $CellContext`pt2[{$CellContext`xM$, $CellContext`yM$}, \
$CellContext`colM], 
              $CellContext`label1[
              "M", $CellContext`colM, {$CellContext`xM$, $CellContext`yM$}], \
{$CellContext`colE1, 
               
               Arrow[{{$CellContext`xRN$, $CellContext`yRN$}, \
$CellContext`extract1$$}]}, 
              $CellContext`pt1[$CellContext`extract1$$, $CellContext`colE1], 
              $CellContext`label2[{
               "E", 1}, $CellContext`colE1, $CellContext`extract1$$], 
              If[$CellContext`solution$$, 
               $CellContext`pt2[{
                 $CellContext`xE$[1], 
                 $CellContext`yE$[1]}, $CellContext`colE1]]}], 
            If[$CellContext`MCR$$ > 5, {
              $CellContext`pt2[{
                $CellContext`xE$[1], 
                $CellContext`yE$[1]}, $CellContext`colE1], 
              $CellContext`label2[{"E", 1}, $CellContext`colE1, {
                $CellContext`xE$[1], 
                $CellContext`yE$[1]}]}], 
            If[$CellContext`MCR$$ == 6, {{
               Thickness[0.007], Dotted, $CellContext`colOP, 
               
               Line[{$CellContext`operatingpt$$, {$CellContext`xF$, \
$CellContext`yF$}}], 
               
               Line[{$CellContext`operatingpt$$, {$CellContext`xRN$, \
$CellContext`yRN$}}]}, 
              $CellContext`pt1[$CellContext`operatingpt$$, \
$CellContext`colOP], 
              $CellContext`label1[
              "P", $CellContext`colOP, $CellContext`operatingpt$$], 
              If[$CellContext`solution$$, {Dashed, $CellContext`colOP, 
                
                Line[{{$CellContext`xP$, $CellContext`yP$}, \
{$CellContext`xF$, $CellContext`yF$}}], 
                
                Line[{{$CellContext`xP$, $CellContext`yP$}, \
{$CellContext`xRN$, $CellContext`yRN$}}], 
                $CellContext`pt2[{$CellContext`xP$, $CellContext`yP$}, \
$CellContext`colOP]}]}], 
            If[6 < $CellContext`MCR$$ < 11, {
              $CellContext`pt2[{$CellContext`xP$, $CellContext`yP$}, \
$CellContext`colOP], 
              $CellContext`label1[
              "P", $CellContext`colOP, {$CellContext`xP$, \
$CellContext`yP$}]}], 
            If[$CellContext`MCR$$ == 7, {{$CellContext`colR, Dashed, 
               Line[{{
                  $CellContext`xE$[1], 
                  $CellContext`yE$[1]}, $CellContext`raffinate1$$}]}, 
              $CellContext`pt1[$CellContext`raffinate1$$, $CellContext`colR], 
              $CellContext`label2[{"R", 1}, $CellContext`colR, 
               If[$CellContext`solution$$, {
                 $CellContext`xR$[1], 
                 $CellContext`yR$[1]}, $CellContext`raffinate1$$]], 
              If[$CellContext`solution$$, {$CellContext`colR, Dashed, 
                Line[{{
                   $CellContext`xE$[1], 
                   $CellContext`yE$[1]}, {
                   $CellContext`xR$[1], 
                   $CellContext`yR$[1]}}], 
                $CellContext`pt2[{
                  $CellContext`xR$[1], 
                  $CellContext`yR$[1]}, $CellContext`colR]}]}], 
            If[7 < $CellContext`MCR$$ < 11, {{$CellContext`colR, Dashed, 
               Line[{{
                  $CellContext`xE$[1], 
                  $CellContext`yE$[1]}, {
                  $CellContext`xR$[1], 
                  $CellContext`yR$[1]}}]}, 
              $CellContext`pt2[{
                $CellContext`xR$[1], 
                $CellContext`yR$[1]}, $CellContext`colR], 
              $CellContext`label2[{"R", 1}, $CellContext`colR, {
                $CellContext`xR$[1], 
                $CellContext`yR$[1]}]}], 
            If[$CellContext`MCR$$ == 8, {{$CellContext`colE1, Dashed, 
               Line[{{
                  $CellContext`xR$[1], 
                  $CellContext`yR$[
                  1]}, {$CellContext`xP$, $CellContext`yP$}}]}, 
              $CellContext`pt1[$CellContext`extract2$$, $CellContext`colE1], 
              $CellContext`label2[{"E", 2}, $CellContext`colE1, 
               If[$CellContext`solution$$, {
                 $CellContext`xE$[2], 
                 $CellContext`yE$[2]}, $CellContext`extract2$$]], 
              If[$CellContext`solution$$, {{$CellContext`colE1, Dashed, 
                 Line[{{
                    $CellContext`xR$[1], 
                    $CellContext`yR$[1]}, {
                    $CellContext`xE$[2], 
                    $CellContext`yE$[2]}}]}, 
                $CellContext`pt2[{
                  $CellContext`xE$[2], 
                  $CellContext`yE$[2]}, $CellContext`colE1]}]}], 
            If[8 < $CellContext`MCR$$ < 11, {{$CellContext`colE1, Dashed, 
               Line[{{
                  $CellContext`xR$[1], 
                  $CellContext`yR$[1]}, {
                  $CellContext`xE$[2], 
                  $CellContext`yE$[2]}}]}, 
              $CellContext`pt2[{
                $CellContext`xE$[2], 
                $CellContext`yE$[2]}, $CellContext`colE1], 
              $CellContext`label2[{"E", 2}, $CellContext`colE1, {
                $CellContext`xE$[2], 
                $CellContext`yE$[2]}]}], 
            If[$CellContext`MCR$$ == 9, {{$CellContext`colR, Dashed, 
               Line[{{
                  $CellContext`xE$[2], 
                  $CellContext`yE$[2]}, $CellContext`raffinate2$$}]}, 
              $CellContext`pt1[$CellContext`raffinate2$$, $CellContext`colR], 
              $CellContext`label2[{"R", 2}, $CellContext`colR, 
               If[$CellContext`solution$$, {
                 $CellContext`xR$[2], 
                 $CellContext`yR$[2]}, $CellContext`raffinate2$$]], 
              If[$CellContext`solution$$, {$CellContext`colR, Dashed, 
                Line[{{
                   $CellContext`xE$[2], 
                   $CellContext`yE$[2]}, {
                   $CellContext`xR$[2], 
                   $CellContext`yR$[2]}}], 
                $CellContext`pt2[{
                  $CellContext`xR$[2], 
                  $CellContext`yR$[2]}, $CellContext`colR]}]}], 
            If[9 < $CellContext`MCR$$ < 11, {{$CellContext`colR, Dashed, 
               Line[{{
                  $CellContext`xE$[2], 
                  $CellContext`yE$[2]}, {
                  $CellContext`xR$[2], 
                  $CellContext`yR$[2]}}]}, 
              $CellContext`pt2[{
                $CellContext`xR$[2], 
                $CellContext`yR$[2]}, $CellContext`colR], 
              $CellContext`label2[{"R", 2}, $CellContext`colR, {
                $CellContext`xR$[2], 
                $CellContext`yR$[2]}]}], 
            If[$CellContext`MCR$$ == 10, {{$CellContext`colE1, Dashed, 
               Line[{{
                  $CellContext`xR$[2], 
                  $CellContext`yR$[
                  2]}, {$CellContext`xP$, $CellContext`yP$}}]}, 
              $CellContext`pt1[$CellContext`extract3$$, $CellContext`colE1], 
              $CellContext`label2[{"E", 3}, $CellContext`colE1, 
               If[$CellContext`solution$$, {
                 $CellContext`xE$[3], 
                 $CellContext`yE$[3]}, $CellContext`extract3$$]], 
              If[$CellContext`solution$$, {{$CellContext`colE1, Dashed, 
                 Line[{{
                    $CellContext`xR$[2], 
                    $CellContext`yR$[2]}, {
                    $CellContext`xE$[3], 
                    $CellContext`yE$[3]}}]}, 
                $CellContext`pt2[{
                  $CellContext`xE$[3], 
                  $CellContext`yE$[3]}, $CellContext`colE1]}]}], 
            If[$CellContext`MCR$$ == 11, {
              Map[{Dashed, $CellContext`colE1, 
                Line[{{
                   $CellContext`xE$[#], 
                   $CellContext`yE$[#]}, {
                   $CellContext`xR$[#], 
                   $CellContext`yR$[#]}}], $CellContext`colR, 
                Line[{{
                   $CellContext`xR$[#], 
                   $CellContext`yR$[#]}, {
                   $CellContext`xE$[# + 1], 
                   $CellContext`yE$[# + 1]}}]}& , 
               Range[$CellContext`n$]], 
              Map[{
                $CellContext`pt2[{
                  $CellContext`xE$[#], 
                  $CellContext`yE$[#]}, $CellContext`colE1], 
                $CellContext`label2[{"E", #}, $CellContext`colE1, {
                  $CellContext`xE$[#], 
                  $CellContext`yE$[#]}]}& , 
               Range[2, $CellContext`n$]], 
              Map[{
                $CellContext`pt2[{
                  $CellContext`xR$[#], 
                  $CellContext`yR$[#]}, $CellContext`colR], 
                $CellContext`label2[{"R", #}, $CellContext`colR, {
                  $CellContext`xR$[#], 
                  $CellContext`yR$[#]}]}& , 
               Range[$CellContext`n$]], 
              Map[Text[
                Style[
                 Row[{" ", #, " "}], 18, Background -> 
                 White], {$CellContext`xE$[#] + $CellContext`xR$[#], \
$CellContext`yE$[#] + $CellContext`yR$[#]}/2, {0, -1.5}]& , 
               Range[$CellContext`n$]]}]}]], 
      "Specifications" :> {{{$CellContext`reset$$, 1}, 1, 1000, 1, 
         ControlType -> None, ControlPlacement -> 
         1}, {{$CellContext`MCR$$, 1, ""}, {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 
         11}, ControlType -> None, ControlPlacement -> 
         2}, {{$CellContext`solution$$, False, "solution"}, {True, False}, 
         Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         3}, {{$CellContext`hint$$, False, "hint"}, {True, False}, 
         ControlPlacement -> 4}, {{$CellContext`feed$$, {0.5, 0.7}}, 
         Automatic, ControlType -> Locator, Appearance -> None, Enabled -> 
         Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         5}, {{$CellContext`solvent$$, {0.5, 0.7}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         6}, {{$CellContext`raffinateN$$, {0.5, 0.7}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         7}, {{$CellContext`mixing$$, {0.5, 0.7}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         8}, {{$CellContext`extract1$$, {0.4, 0.3}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         9}, {{$CellContext`operatingpt$$, {0.5, 0.7}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         10}, {{$CellContext`raffinate1$$, {0.6, 0.3}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         11}, {{$CellContext`extract2$$, {0.4, 0.15}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         12}, {{$CellContext`raffinate2$$, {0.6, 0.3}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         13}, {{$CellContext`extract3$$, {0.4, 0.15}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 14}, 
        Grid[{{
           Button["new problem", {
             
             If[$CellContext`reset$$ < 
              1000, $CellContext`reset$$ = $CellContext`reset$$ + 
               1, $CellContext`reset$$ = $CellContext`reset$$ - 
               1], $CellContext`MCR$$ = 1, $CellContext`solution$$ = 
             False, $CellContext`hint$$ = 
             False, $CellContext`feed$$ = {0.5, 
              0.7}, $CellContext`solvent$$ = {0.5, 
              0.7}, $CellContext`raffinateN$$ = {0.5, 
              0.7}, $CellContext`mixing$$ = {0.5, 
              0.7}, $CellContext`extract1$$ = {0.4, 
              0.3}, $CellContext`operatingpt$$ = {0.5, 
              0.7}, $CellContext`raffinate1$$ = {0.6, 
              0.3}, $CellContext`rafinate2 = {0.6, 
              0.3}, $CellContext`raffinate3 = {0.6, 
              0.3}, $CellContext`rafinate4 = {0.6, 
              0.3}, $CellContext`rafinate5 = {0.6, 
              0.3}, $CellContext`extract2$$ = {0.4, 
              0.15}, $CellContext`extract3$$ = {0.4, 
              0.15}, $CellContext`extract4 = {0.4, 
              0.15}, $CellContext`extract5 = {0.4, 
              0.15}, $CellContext`extract6 = {0.4, 0.15}, $CellContext`Estage = 
             1, $CellContext`Rstage = 1}], 
           Manipulate`Place[1], 
           
           PaneSelector[{
            1 -> "(1) locate feed point", 2 -> "(2) locate solvent point", 3 -> 
             "(3) locate raffinate point", 4 -> "(4) locate mixing point", 5 -> 
             "(5) locate first extract point", 6 -> 
             "(6) locate operating point", 7 -> Row[{"(7) determine ", 
                Subscript[
                 Style["R", Italic], 1]}], 8 -> Row[{"(8) determine ", 
                Subscript[
                 Style["E", Italic], 2]}], 9 -> Row[{"(9) determine ", 
                Subscript[
                 Style["R", Italic], 2]}], 10 -> Row[{"(10) determine ", 
                Subscript[
                 Style["E", Italic], 3]}], 11 -> "(11) solution"}, 
            Dynamic[$CellContext`MCR$$]], 
           Manipulate`Place[2], 
           PaneSelector[{1 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 2 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 3 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 4 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 5 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 6 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 7 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 8 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 9 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 10 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}]}, 
            Dynamic[$CellContext`MCR$$]], 
           
           PaneSelector[{
            1 -> Manipulate`Place[3], 2 -> Manipulate`Place[3], 3 -> 
             Manipulate`Place[3], 4 -> Manipulate`Place[3], 5 -> 
             Manipulate`Place[3], 6 -> Manipulate`Place[3], 7 -> 
             Manipulate`Place[3], 8 -> Manipulate`Place[3], 9 -> 
             Manipulate`Place[3], 10 -> Manipulate`Place[3]}, 
            Dynamic[$CellContext`MCR$$]], 
           
           PaneSelector[{
            1 -> Manipulate`Place[4], 2 -> Manipulate`Place[4], 3 -> 
             Manipulate`Place[4], 4 -> Manipulate`Place[4], 5 -> 
             Manipulate`Place[4], 6 -> Manipulate`Place[4], 7 -> 
             Manipulate`Place[4], 8 -> Manipulate`Place[4], 9 -> 
             Manipulate`Place[4], 10 -> Manipulate`Place[4]}, 
            Dynamic[$CellContext`MCR$$]], 
           
           PaneSelector[{
            1 -> Manipulate`Place[5], 2 -> Manipulate`Place[6], 3 -> 
             Manipulate`Place[7], 4 -> Manipulate`Place[8], 5 -> 
             Manipulate`Place[9], 6 -> Manipulate`Place[10], 7 -> 
             Manipulate`Place[11], 8 -> Manipulate`Place[12], 9 -> 
             Manipulate`Place[13], 10 -> Manipulate`Place[14]}, 
            Dynamic[$CellContext`MCR$$]]}}]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{649., {242., 248.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({
      Attributes[PlotRange] = {ReadProtected}, $CellContext`wtA[
         Pattern[$CellContext`y, 
          Blank[]]] := $CellContext`y (2/Sqrt[3]), $CellContext`wtS[
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`y, 
          Blank[]]] := 1 - ($CellContext`x + $CellContext`y/Sqrt[3]), 
       Attributes[Subscript] = {NHoldRest}, $CellContext`gridLines = Graphics[{
          Thickness[Tiny], 
          GrayLevel[0.7], {{
            Line[{{0., 0.}, {1., 0.}}], 
            Line[{{0., 0}, {0., 0.}}], 
            Line[{{1., 0}, {1., 0.}}]}, {
            
            Line[{{0.025, 0.04330127018922193}, {0.975, 
             0.04330127018922193}}], 
            Line[{{0.05, 0}, {0.025, 0.04330127018922193}}], 
            Line[{{0.95, 0}, {0.975, 0.04330127018922193}}]}, {
            Line[{{0.05, 0.08660254037844387}, {0.95, 0.08660254037844387}}], 
            Line[{{0.1, 0}, {0.05, 0.08660254037844387}}], 
            Line[{{0.9, 0}, {0.95, 0.08660254037844387}}]}, {
            
            Line[{{0.07500000000000001, 0.1299038105676658}, {0.925, 
             0.1299038105676658}}], 
            
            Line[{{0.15000000000000002`, 0}, {0.07500000000000001, 
              0.1299038105676658}}], 
            Line[{{0.85, 0}, {0.925, 0.1299038105676658}}]}, {
            Line[{{0.1, 0.17320508075688773`}, {0.9, 0.17320508075688773`}}], 
            Line[{{0.2, 0}, {0.1, 0.17320508075688773`}}], 
            Line[{{0.8, 0}, {0.9, 0.17320508075688773`}}]}, {
            
            Line[{{0.125, 0.21650635094610965`}, {0.875, 
             0.21650635094610965`}}], 
            Line[{{0.25, 0}, {0.125, 0.21650635094610965`}}], 
            Line[{{0.75, 0}, {0.875, 0.21650635094610965`}}]}, {
            
            Line[{{0.15000000000000002`, 0.2598076211353316}, {0.85, 
             0.2598076211353316}}], 
            
            Line[{{0.30000000000000004`, 0}, {0.15000000000000002`, 
              0.2598076211353316}}], 
            Line[{{0.7, 0}, {0.85, 0.2598076211353316}}]}, {
            
            Line[{{0.17500000000000002`, 0.30310889132455354`}, {0.825, 
             0.30310889132455354`}}], 
            
            Line[{{0.35000000000000003`, 0}, {0.17500000000000002`, 
              0.30310889132455354`}}], 
            Line[{{0.6499999999999999, 0}, {0.825, 0.30310889132455354`}}]}, {
            Line[{{0.2, 0.34641016151377546`}, {0.8, 0.34641016151377546`}}], 
            Line[{{0.4, 0}, {0.2, 0.34641016151377546`}}], 
            Line[{{0.6, 0}, {0.8, 0.34641016151377546`}}]}, {
            Line[{{0.225, 0.3897114317029974}, {0.775, 0.3897114317029974}}], 
            Line[{{0.45, 0}, {0.225, 0.3897114317029974}}], 
            Line[{{0.55, 0}, {0.775, 0.3897114317029974}}]}, {
            Line[{{0.25, 0.4330127018922193}, {0.75, 0.4330127018922193}}], 
            Line[{{0.5, 0}, {0.25, 0.4330127018922193}}], 
            Line[{{0.5, 0}, {0.75, 0.4330127018922193}}]}, {
            Line[{{0.275, 0.4763139720814413}, {0.725, 0.4763139720814413}}], 
            Line[{{0.55, 0}, {0.275, 0.4763139720814413}}], 
            Line[{{0.44999999999999996`, 0}, {0.725, 0.4763139720814413}}]}, {
            
            Line[{{0.30000000000000004`, 0.5196152422706632}, {0.7, 
             0.5196152422706632}}], 
            
            Line[{{0.6000000000000001, 0}, {0.30000000000000004`, 
              0.5196152422706632}}], 
            Line[{{0.3999999999999999, 0}, {0.7, 0.5196152422706632}}]}, {
            Line[{{0.325, 0.562916512459885}, {0.675, 0.562916512459885}}], 
            Line[{{0.65, 0}, {0.325, 0.562916512459885}}], 
            Line[{{0.35, 0}, {0.675, 0.562916512459885}}]}, {
            
            Line[{{0.35000000000000003`, 0.6062177826491071}, {
             0.6499999999999999, 0.6062177826491071}}], 
            
            Line[{{0.7000000000000001, 0}, {0.35000000000000003`, 
              0.6062177826491071}}], 
            
            Line[{{0.29999999999999993`, 0}, {0.6499999999999999, 
              0.6062177826491071}}]}, {
            Line[{{0.375, 0.649519052838329}, {0.625, 0.649519052838329}}], 
            Line[{{0.75, 0}, {0.375, 0.649519052838329}}], 
            Line[{{0.25, 0}, {0.625, 0.649519052838329}}]}, {
            Line[{{0.4, 0.6928203230275509}, {0.6, 0.6928203230275509}}], 
            Line[{{0.8, 0}, {0.4, 0.6928203230275509}}], 
            Line[{{0.19999999999999996`, 0}, {0.6, 0.6928203230275509}}]}, {
            Line[{{0.42500000000000004`, 0.7361215932167728}, {0.575, 
             0.7361215932167728}}], 
            
            Line[{{0.8500000000000001, 0}, {0.42500000000000004`, 
              0.7361215932167728}}], 
            Line[{{0.1499999999999999, 0}, {0.575, 0.7361215932167728}}]}, {
            Line[{{0.45, 0.7794228634059948}, {0.55, 0.7794228634059948}}], 
            Line[{{0.9, 0}, {0.45, 0.7794228634059948}}], 
            Line[{{0.09999999999999998, 0}, {0.55, 0.7794228634059948}}]}, {
            
            Line[{{0.47500000000000003`, 0.8227241335952167}, {
             0.5249999999999999, 0.8227241335952167}}], 
            
            Line[{{0.9500000000000001, 0}, {0.47500000000000003`, 
              0.8227241335952167}}], 
            
            Line[{{0.04999999999999993, 0}, {0.5249999999999999, 
              0.8227241335952167}}]}, {
            Line[{{0.5, 0.8660254037844386}, {0.5, 0.8660254037844386}}], 
            Line[{{1., 0}, {0.5, 0.8660254037844386}}], 
            Line[{{0., 0}, {0.5, 0.8660254037844386}}]}}}], $CellContext`base = 
       Graphics[{{
           EdgeForm[
            Thickness[Large]], 
           FaceForm[None], 
           Polygon[{{0, 0}, {0.5, Sqrt[3]/2}, {1, 0}}]}, {{{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.1, 17], {0.05, 0.08660254037844387}, {2.25, 0}], 
             
             Line[{{0.020000000000000004`, 0.08660254037844387}, {0.05, 
              0.08660254037844387}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.9, 17], {0.1, 0}, {-2.25, 0}, {1/2, -1}], 
             Line[{{0.1, 0}, {0.115, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.9, 17], {0.95, 0.08660254037844387}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.95, 0.08660254037844387}, {0.965, 
              0.11258330249197702`}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.2, 17], {0.1, 0.17320508075688773`}, {2.25, 0}], 
             Line[{{0.07, 0.17320508075688773`}, {0.1, 
              0.17320508075688773`}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.8, 17], {0.2, 0}, {-2.25, 0}, {1/2, -1}], 
             
             Line[{{0.2, 0}, {
               0.21500000000000002`, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.8, 17], {0.9, 0.17320508075688773`}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.9, 0.17320508075688773`}, {0.915, 
              0.19918584287042088`}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.30000000000000004`, 17], {0.15000000000000002`, 
              0.2598076211353316}, {2.25, 0}], 
             
             Line[{{0.12000000000000002`, 0.2598076211353316}, {
              0.15000000000000002`, 0.2598076211353316}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.7, 17], {0.30000000000000004`, 0}, {-2.25, 0}, {
              1/2, -1}], 
             
             Line[{{0.30000000000000004`, 0}, {
               0.31500000000000006`, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.7, 17], {0.85, 0.2598076211353316}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.85, 0.2598076211353316}, {0.865, 
              0.2857883832488648}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.4, 17], {0.2, 0.34641016151377546`}, {2.25, 0}], 
             
             Line[{{0.17, 0.34641016151377546`}, {0.2, 
              0.34641016151377546`}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.6, 17], {0.4, 0}, {-2.25, 0}, {1/2, -1}], 
             
             Line[{{0.4, 0}, {
               0.41500000000000004`, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.6, 17], {0.8, 0.34641016151377546`}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.8, 0.34641016151377546`}, {0.815, 
              0.37239092362730863`}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.5, 17], {0.25, 0.4330127018922193}, {2.25, 0}], 
             Line[{{0.22, 0.4330127018922193}, {0.25, 0.4330127018922193}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.5, 17], {0.5, 0}, {-2.25, 0}, {1/2, -1}], 
             Line[{{0.5, 0}, {0.515, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.5, 17], {0.75, 0.4330127018922193}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.75, 0.4330127018922193}, {0.765, 
              0.45899346400575247`}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.6, 17], {0.3, 0.5196152422706631}, {2.25, 0}], 
             Line[{{0.27, 0.5196152422706631}, {0.3, 0.5196152422706631}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.4, 17], {0.6, 0}, {-2.25, 0}, {1/2, -1}], 
             Line[{{0.6, 0}, {0.615, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.4, 17], {0.7, 0.5196152422706631}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.7, 0.5196152422706631}, {0.7150000000000001, 
              0.5455960043841963}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.7000000000000001, 17], {0.35000000000000003`, 
              0.6062177826491071}, {2.25, 0}], 
             
             Line[{{0.32000000000000006`, 0.6062177826491071}, {
              0.35000000000000003`, 0.6062177826491071}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.29999999999999993`, 17], {
              0.7000000000000001, 0}, {-2.25, 0}, {1/2, -1}], 
             
             Line[{{0.7000000000000001, 0}, {
               0.7150000000000001, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.29999999999999993`, 17], {0.6499999999999999, 
              0.6062177826491071}, {-2.25, 0}, {1.5, 2}], 
             
             Line[{{0.6499999999999999, 0.6062177826491071}, {0.665, 
              0.6321985447626403}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.8, 17], {0.4, 0.6928203230275509}, {2.25, 0}], 
             Line[{{0.37, 0.6928203230275509}, {0.4, 0.6928203230275509}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.19999999999999996`, 17], {0.8, 0}, {-2.25, 0}, {
              1/2, -1}], 
             Line[{{0.8, 0}, {0.8150000000000001, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.19999999999999996`, 17], {0.6, 
              0.6928203230275509}, {-2.25, 0}, {1.5, 2}], 
             
             Line[{{0.6, 0.6928203230275509}, {0.615, 
              0.7188010851410841}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.9, 17], {0.45, 0.7794228634059948}, {2.25, 0}], 
             
             Line[{{0.42000000000000004`, 0.7794228634059948}, {0.45, 
              0.7794228634059948}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.09999999999999998, 17], {0.9, 0}, {-2.25, 0}, {
              1/2, -1}], 
             Line[{{0.9, 0}, {0.915, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.09999999999999998, 17], {0.55, 
              0.7794228634059948}, {-2.25, 0}, {1.5, 2}], 
             
             Line[{{0.55, 0.7794228634059948}, {0.565, 
              0.8054036255195279}}]}}}, 
          Text[
           Style["solute", 17, 
            RGBColor[0, 0, 1]], {0.5, Sqrt[3]/2}, {0, -1}], 
          Text[
           Style["solvent", 17, 
            RGBColor[1, 0, 0]], {0, 0}, {1, 2}], 
          Text[
           Style["carrier", 17, 
            RGBColor[0, 0.6, 0]], {1, 0}, {-1, 2}]}], $CellContext`pt1[
         Pattern[$CellContext`pt, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]]] := {$CellContext`col, 
         PointSize[0.03], 
         Point[$CellContext`pt], White, 
         PointSize[0.015], 
         Point[$CellContext`pt]}, $CellContext`colF = 
       GrayLevel[0], $CellContext`label1[
         Pattern[$CellContext`text, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]], 
         Pattern[$CellContext`loc, 
          Blank[]]] := Text[
         Framed[
          Style[
           Row[{" ", $CellContext`text, " "}], 18, Italic, $CellContext`col], 
          Background -> White, FrameStyle -> $CellContext`col, FrameMargins -> 
          Tiny, RoundingRadius -> 15], $CellContext`loc, {
         0, -1.5}], $CellContext`table1[
         Pattern[$CellContext`title, 
          Blank[]], 
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`y, 
          Blank[]]] := Text[
         Style[
          Column[{
            Row[{$CellContext`title, " mole fractions"}], 
            Framed[
             Column[{
               Style[
                Row[{"solute = ", 
                  NumberForm[
                   $CellContext`wtA[$CellContext`y], {2, 2}]}], Blue], 
               Style[
                Row[{"solvent = ", 
                  NumberForm[
                   $CellContext`wtS[$CellContext`x, $CellContext`y], {2, 
                   2}]}], Red], 
               Style[
                Row[{"carrier = ", 
                  
                  NumberForm[$CellContext`x - $CellContext`y/Sqrt[3], {2, 
                   2}]}], 
                RGBColor[0, 0.6, 0]]}], 
             FrameMargins -> {{20, 20}, {Automatic, Automatic}}]}, Center], 
          17], {-0.05, 0.75}], $CellContext`pt2[
         Pattern[$CellContext`pt, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]]] := {$CellContext`col, 
         PointSize[0.03], 
         Point[$CellContext`pt]}, $CellContext`colS = 
       RGBColor[1, 0, 0], $CellContext`colR = 
       RGBColor[0, 0.2666666666666667, 0.4], $CellContext`label2[
         Pattern[$CellContext`text, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]], 
         Pattern[$CellContext`loc, 
          Blank[]]] := Text[
         Framed[
          Style[
           Subscript[
            Style[
             Part[$CellContext`text, 1], Italic], 
            Part[$CellContext`text, 2]], 18, $CellContext`col], Background -> 
          White, FrameStyle -> $CellContext`col, FrameMargins -> Small, 
          RoundingRadius -> 15], $CellContext`loc, {
         0, -1.5}], $CellContext`colM = GrayLevel[0.3], $CellContext`table2[
         Pattern[$CellContext`title, 
          Blank[]], 
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`y, 
          Blank[]]] := Text[
         Style[
          Column[{
            Row[{$CellContext`title, " mole fractions"}], 
            Framed[
             Column[{
               Style[
                Row[{"solute = ", 
                  NumberForm[
                   $CellContext`wtA[$CellContext`y], {2, 2}]}], Blue], 
               Style[
                Row[{"solvent = ", 
                  NumberForm[
                   $CellContext`wtS[$CellContext`x, $CellContext`y], {2, 
                   2}]}], Red], 
               Style[
                Row[{"carrier = ", 
                  
                  NumberForm[$CellContext`x - $CellContext`y/Sqrt[3], {2, 
                   2}]}], 
                RGBColor[0, 0.6, 0]]}], 
             FrameMargins -> {{20, 20}, {Automatic, Automatic}}]}, Center], 
          17], {1.05, 0.75}], $CellContext`colE1 = 
       RGBColor[1, 0.5, 0], $CellContext`colOP = 
       RGBColor[0.5, 0, 0.5], $CellContext`rafinate2 = {0.6, 
        0.3}, $CellContext`raffinate3 = {0.6, 0.3}, $CellContext`rafinate4 = {
        0.6, 0.3}, $CellContext`rafinate5 = {0.6, 
        0.3}, $CellContext`extract4 = {0.4, 0.15}, $CellContext`extract5 = {
        0.4, 0.15}, $CellContext`extract6 = {0.4, 0.15}, $CellContext`Estage = 
       1, $CellContext`Rstage = 1}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.732638396263473*^9, {3.7601869722529664`*^9, 3.7601869941468487`*^9}, 
   3.7601870747220287`*^9, {3.760190284024488*^9, 3.7601903632468433`*^9}, 
   3.762016939592909*^9, {3.762017224583386*^9, 3.762017240088715*^9}},
 CellID->1747526224,ExpressionUUID->"0179c184-4743-431e-a96d-03b7e9edc7ed"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ManipulateCaptionSection",ExpressionUUID->"26e2ca32-add8-4453-98db-7b5dd267b96f"],

Cell["\<\
In this Demonstration, you can construct a ternary phase diagram step by step \
using the Hunter\[Dash]Nash method to determine the number of equilibrium \
stages needed to achieve a certain separation. Press the \"new problem\" \
button to generate a new set of conditions; pressing this button takes you \
back to the beginning of the Demonstration. Check \"solution\" to see the \
answer. Once you check \"solution\", you cannot change your answers. Click \
\"next\" to move onto the next step, but once you press \"next\", you cannot \
go backward.\
\>", "ManipulateCaption",
 CellChangeTimes->{{3.725116627934428*^9, 3.7251167308878217`*^9}, {
  3.72511698370427*^9, 3.7251173098763065`*^9}, {3.7251184273950124`*^9, 
  3.7251184482865314`*^9}, {3.7262579820862675`*^9, 3.726258003893669*^9}, {
  3.726412223055557*^9, 3.7264122349532375`*^9}, {3.732632868411455*^9, 
  3.7326329126211643`*^9}, {3.732632995381495*^9, 3.732633033699347*^9}, {
  3.73263306445889*^9, 3.732633066561878*^9}, {3.732638413640306*^9, 
  3.7326384405495977`*^9}, {3.7329023758061857`*^9, 
  3.732902388581208*^9}},ExpressionUUID->"e2f276fd-902c-49d3-9cde-\
e044363c6fab"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ThumbnailSection",ExpressionUUID->"2c98bbad-0e82-42cd-881c-8bab126bcd9d"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`extract1$$ = {0.4, 
    0.3}, $CellContext`extract2$$ = {0.4, 0.15}, $CellContext`extract3$$ = {
    0.4, 0.15}, $CellContext`feed$$ = {0.5, 0.7}, $CellContext`hint$$ = 
    False, $CellContext`MCR$$ = 4, $CellContext`mixing$$ = {0.5, 
    0.7}, $CellContext`operatingpt$$ = {0.5, 
    0.7}, $CellContext`raffinate1$$ = {0.6, 
    0.3}, $CellContext`raffinate2$$ = {0.6, 
    0.3}, $CellContext`raffinateN$$ = {0.5, 0.7}, $CellContext`reset$$ = 
    1, $CellContext`solution$$ = False, $CellContext`solvent$$ = {0.5, 0.7}, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`reset$$], 1}, 1, 1000, 1}, {{
       Hold[$CellContext`MCR$$], 1, ""}, {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 
      11}}, {{
       Hold[$CellContext`solution$$], False, "solution"}, {True, False}}, {{
       Hold[$CellContext`hint$$], False, "hint"}, {True, False}}, {{
       Hold[$CellContext`feed$$], {0.5, 0.7}}, Automatic}, {{
       Hold[$CellContext`solvent$$], {0.5, 0.7}}, Automatic}, {{
       Hold[$CellContext`raffinateN$$], {0.5, 0.7}}, Automatic}, {{
       Hold[$CellContext`mixing$$], {0.5, 0.7}}, Automatic}, {{
       Hold[$CellContext`extract1$$], {0.4, 0.3}}, Automatic}, {{
       Hold[$CellContext`operatingpt$$], {0.5, 0.7}}, Automatic}, {{
       Hold[$CellContext`raffinate1$$], {0.6, 0.3}}, Automatic}, {{
       Hold[$CellContext`extract2$$], {0.4, 0.15}}, Automatic}, {{
       Hold[$CellContext`raffinate2$$], {0.6, 0.3}}, Automatic}, {{
       Hold[$CellContext`extract3$$], {0.4, 0.15}}, Automatic}, {
      Hold[
       Grid[{{
          Button["new problem", {
            
            If[$CellContext`reset$$ < 
             1000, $CellContext`reset$$ = $CellContext`reset$$ + 
              1, $CellContext`reset$$ = $CellContext`reset$$ - 
              1], $CellContext`MCR$$ = 1, $CellContext`solution$$ = 
            False, $CellContext`hint$$ = 
            False, $CellContext`feed$$ = {0.5, 
             0.7}, $CellContext`solvent$$ = {0.5, 
             0.7}, $CellContext`raffinateN$$ = {0.5, 
             0.7}, $CellContext`mixing$$ = {0.5, 
             0.7}, $CellContext`extract1$$ = {0.4, 
             0.3}, $CellContext`operatingpt$$ = {0.5, 
             0.7}, $CellContext`raffinate1$$ = {0.6, 
             0.3}, $CellContext`rafinate2 = {0.6, 
             0.3}, $CellContext`raffinate3 = {0.6, 
             0.3}, $CellContext`rafinate4 = {0.6, 
             0.3}, $CellContext`rafinate5 = {0.6, 
             0.3}, $CellContext`extract2$$ = {0.4, 
             0.15}, $CellContext`extract3$$ = {0.4, 
             0.15}, $CellContext`extract4 = {0.4, 
             0.15}, $CellContext`extract5 = {0.4, 
             0.15}, $CellContext`extract6 = {0.4, 0.15}, $CellContext`Estage = 
            1, $CellContext`Rstage = 1}], 
          Manipulate`Place[1], 
          
          PaneSelector[{
           1 -> "(1) locate feed point", 2 -> "(2) locate solvent point", 3 -> 
            "(3) locate raffinate point", 4 -> "(4) locate mixing point", 5 -> 
            "(5) locate first extract point", 6 -> 
            "(6) locate operating point", 7 -> Row[{"(7) determine ", 
               Subscript[
                Style["R", Italic], 1]}], 8 -> Row[{"(8) determine ", 
               Subscript[
                Style["E", Italic], 2]}], 9 -> Row[{"(9) determine ", 
               Subscript[
                Style["R", Italic], 2]}], 10 -> Row[{"(10) determine ", 
               Subscript[
                Style["E", Italic], 3]}], 11 -> "(11) solution"}, 
           Dynamic[$CellContext`MCR$$]], 
          Manipulate`Place[2], 
          PaneSelector[{1 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 2 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 3 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 4 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 5 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 6 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 7 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 8 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 9 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 10 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}]}, 
           Dynamic[$CellContext`MCR$$]], 
          
          PaneSelector[{
           1 -> Manipulate`Place[3], 2 -> Manipulate`Place[3], 3 -> 
            Manipulate`Place[3], 4 -> Manipulate`Place[3], 5 -> 
            Manipulate`Place[3], 6 -> Manipulate`Place[3], 7 -> 
            Manipulate`Place[3], 8 -> Manipulate`Place[3], 9 -> 
            Manipulate`Place[3], 10 -> Manipulate`Place[3]}, 
           Dynamic[$CellContext`MCR$$]], 
          
          PaneSelector[{
           1 -> Manipulate`Place[4], 2 -> Manipulate`Place[4], 3 -> 
            Manipulate`Place[4], 4 -> Manipulate`Place[4], 5 -> 
            Manipulate`Place[4], 6 -> Manipulate`Place[4], 7 -> 
            Manipulate`Place[4], 8 -> Manipulate`Place[4], 9 -> 
            Manipulate`Place[4], 10 -> Manipulate`Place[4]}, 
           Dynamic[$CellContext`MCR$$]], 
          
          PaneSelector[{
           1 -> Manipulate`Place[5], 2 -> Manipulate`Place[6], 3 -> 
            Manipulate`Place[7], 4 -> Manipulate`Place[8], 5 -> 
            Manipulate`Place[9], 6 -> Manipulate`Place[10], 7 -> 
            Manipulate`Place[11], 8 -> Manipulate`Place[12], 9 -> 
            Manipulate`Place[13], 10 -> Manipulate`Place[14]}, 
           Dynamic[$CellContext`MCR$$]]}}]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    600., {193., 197.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`reset$81342$$ = 
    0, $CellContext`MCR$81343$$ = 0, $CellContext`solution$81344$$ = 
    False, $CellContext`hint$81345$$ = False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`extract1$$ = {0.4, 
         0.3}, $CellContext`extract2$$ = {0.4, 
         0.15}, $CellContext`extract3$$ = {0.4, 0.15}, $CellContext`feed$$ = {
         0.5, 0.7}, $CellContext`hint$$ = False, $CellContext`MCR$$ = 
        1, $CellContext`mixing$$ = {0.5, 0.7}, $CellContext`operatingpt$$ = {
         0.5, 0.7}, $CellContext`raffinate1$$ = {0.6, 
         0.3}, $CellContext`raffinate2$$ = {0.6, 
         0.3}, $CellContext`raffinateN$$ = {0.5, 0.7}, $CellContext`reset$$ = 
        1, $CellContext`solution$$ = 
        False, $CellContext`solvent$$ = {0.5, 0.7}}, "ControllerVariables" :> {
        Hold[$CellContext`reset$$, $CellContext`reset$81342$$, 0], 
        Hold[$CellContext`MCR$$, $CellContext`MCR$81343$$, 0], 
        Hold[$CellContext`solution$$, $CellContext`solution$81344$$, False], 
        Hold[$CellContext`hint$$, $CellContext`hint$81345$$, False]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`x1$, $CellContext`y1$, $CellContext`x2$, \
$CellContext`y2$, $CellContext`x3$, $CellContext`y3$, $CellContext`sol$, \
$CellContext`a$, $CellContext`b$, $CellContext`c$, $CellContext`phase$, \
$CellContext`yt$, $CellContext`xt$, $CellContext`tie$, \
$CellContext`phaseplot$, $CellContext`tielines$, $CellContext`F$, \
$CellContext`S$, $CellContext`M$, $CellContext`xF$, $CellContext`yF$, \
$CellContext`xRN$, $CellContext`yRN$, $CellContext`Msol$, $CellContext`xM$, \
$CellContext`yM$, $CellContext`xE$, $CellContext`yE$, $CellContext`xP$, \
$CellContext`yP$, $CellContext`operating$, $CellContext`lower$, \
$CellContext`upper$, $CellContext`lever$, $CellContext`newtie$, \
$CellContext`xtie$, $CellContext`xR$, $CellContext`yR$, $CellContext`n$, \
$CellContext`plotlabel$}, 
        SeedRandom[$CellContext`reset$$]; $CellContext`x1$ = 
         RandomReal[{0.02, 0.07}]; $CellContext`y1$ = 0; $CellContext`x2$ = 
         RandomReal[{0.45, 0.55}]; $CellContext`y2$ = 
         RandomReal[{0.3, 0.4}]; $CellContext`x3$ = 
         RandomReal[{0.85, 0.98}]; $CellContext`y3$ = 0; $CellContext`sol$ = 
         Quiet[
           Part[
            
            Solve[{$CellContext`\[Alpha] $CellContext`x1$^2 + $CellContext`\
\[Beta] $CellContext`x1$ + $CellContext`\[Chi] == $CellContext`y1$, \
$CellContext`\[Alpha] $CellContext`x2$^2 + $CellContext`\[Beta] \
$CellContext`x2$ + $CellContext`\[Chi] == $CellContext`y2$, $CellContext`\
\[Alpha] $CellContext`x3$^2 + $CellContext`\[Beta] $CellContext`x3$ + \
$CellContext`\[Chi] == $CellContext`y3$}, {$CellContext`\[Alpha], \
$CellContext`\[Beta], $CellContext`\[Chi]}], 1]]; $CellContext`a$ = 
         ReplaceAll[$CellContext`\[Alpha], $CellContext`sol$]; \
$CellContext`b$ = 
         ReplaceAll[$CellContext`\[Beta], $CellContext`sol$]; $CellContext`c$ = 
         ReplaceAll[$CellContext`\[Chi], $CellContext`sol$]; \
$CellContext`phase$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`a$ $CellContext`x$^2 + $CellContext`b$ \
$CellContext`x$ + $CellContext`c$; $CellContext`yt$[1] = 
         RandomReal[{0.02, 0.05} $CellContext`y2$]; $CellContext`xt$[1] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              1], $CellContext`x], 1]]; $CellContext`yt$[2] = 
         RandomReal[{0.06, 0.1} $CellContext`y2$]; $CellContext`xt$[2] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              2], $CellContext`x], 2]]; $CellContext`tie$[1][
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yt$[2] - $CellContext`yt$[
             1])/($CellContext`xt$[2] - $CellContext`xt$[
            1])) ($CellContext`x$ - $CellContext`xt$[1]) + $CellContext`yt$[
           1]; $CellContext`yt$[3] = 
         RandomReal[{0.15, 0.2} $CellContext`y2$]; $CellContext`xt$[3] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              3], $CellContext`x], 1]]; $CellContext`yt$[4] = 
         RandomReal[{0.25, 0.3} $CellContext`y2$]; $CellContext`xt$[4] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              4], $CellContext`x], 2]]; $CellContext`tie$[2][
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yt$[4] - $CellContext`yt$[
             3])/($CellContext`xt$[4] - $CellContext`xt$[
            3])) ($CellContext`x$ - $CellContext`xt$[3]) + $CellContext`yt$[
           3]; $CellContext`yt$[5] = 
         RandomReal[{0.35, 0.4} $CellContext`y2$]; $CellContext`xt$[5] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              5], $CellContext`x], 1]]; $CellContext`yt$[6] = 
         RandomReal[{0.5, 0.55} $CellContext`y2$]; $CellContext`xt$[6] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              6], $CellContext`x], 2]]; $CellContext`tie$[3][
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yt$[6] - $CellContext`yt$[
             5])/($CellContext`xt$[6] - $CellContext`xt$[
            5])) ($CellContext`x$ - $CellContext`xt$[5]) + $CellContext`yt$[
           5]; $CellContext`yt$[7] = 
         RandomReal[{0.72, 0.77} $CellContext`y2$]; $CellContext`xt$[7] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              7], $CellContext`x], 1]]; $CellContext`yt$[8] = 
         RandomReal[{0.8, 0.9} $CellContext`y2$]; $CellContext`xt$[8] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              8], $CellContext`x], 2]]; $CellContext`tie$[4][
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yt$[8] - $CellContext`yt$[
             7])/($CellContext`xt$[8] - $CellContext`xt$[
            7])) ($CellContext`x$ - $CellContext`xt$[7]) + $CellContext`yt$[
           7]; $CellContext`phaseplot$ = Plot[
           $CellContext`phase$[$CellContext`x], {$CellContext`x, \
$CellContext`x1$, $CellContext`x3$}, PlotStyle -> {Thick, Black}, 
           PlotRange -> {{0, 1}, {0, Sqrt[3]/2}}]; $CellContext`tielines$ = 
         Graphics[{
            Thickness[0.004], 
            Line[{{
               $CellContext`xt$[1], 
               $CellContext`yt$[1]}, {
               $CellContext`xt$[2], 
               $CellContext`yt$[2]}}], 
            Line[{{
               $CellContext`xt$[3], 
               $CellContext`yt$[3]}, {
               $CellContext`xt$[4], 
               $CellContext`yt$[4]}}], 
            Line[{{
               $CellContext`xt$[5], 
               $CellContext`yt$[5]}, {
               $CellContext`xt$[6], 
               $CellContext`yt$[6]}}], 
            Line[{{
               $CellContext`xt$[7], 
               $CellContext`yt$[7]}, {
               $CellContext`xt$[8], 
               $CellContext`yt$[8]}}]}]; $CellContext`F$ = 
         RandomInteger[{1000, 1500}]; $CellContext`S$ = 
         RandomInteger[{1500, 
           2000}]; $CellContext`M$ = $CellContext`F$ + $CellContext`S$; \
$CellContext`xF$ = RandomReal[{0.6, 0.7}]; $CellContext`yF$ = 
         RandomReal[{0.4, 0.45}]; $CellContext`xRN$ = 
         0.99 $CellContext`x3$; $CellContext`yRN$ = \
$CellContext`phase$[$CellContext`xRN$]; $CellContext`Msol$ = Quiet[
           First[
            Solve[
             
             And[$CellContext`wtA[$CellContext`yF$] $CellContext`F$ == \
$CellContext`xA $CellContext`M$, $CellContext`wtS[$CellContext`xF$, \
$CellContext`yF$] $CellContext`F$ + $CellContext`S$ == $CellContext`xS \
$CellContext`M$, $CellContext`xA + $CellContext`xS + $CellContext`xC == 
              1], {$CellContext`xA, $CellContext`xS, $CellContext`xC}]]]; \
$CellContext`xM$ = 
         1 - ReplaceAll[$CellContext`xS, $CellContext`Msol$] - \
$CellContext`yM$/Sqrt[3]; $CellContext`yM$ = 
         ReplaceAll[(Sqrt[3]/
            2) $CellContext`xA, $CellContext`Msol$]; $CellContext`xE$[1] = 
         ReplaceAll[$CellContext`x, 
           Quiet[
            First[
             
             Solve[$CellContext`phase$[$CellContext`x] == (($CellContext`yRN$ - \
$CellContext`yM$)/($CellContext`xRN$ - $CellContext`xM$)) ($CellContext`x - \
$CellContext`xRN$) + $CellContext`yRN$, $CellContext`x]]]]; $CellContext`yE$[
          1] = $CellContext`phase$[
           $CellContext`xE$[1]]; $CellContext`xP$ = ReplaceAll[$CellContext`x, 
           Quiet[
            First[
             
             Solve[(($CellContext`yF$ - $CellContext`yE$[
                  1])/($CellContext`xF$ - $CellContext`xE$[
                 1])) ($CellContext`x - $CellContext`xF$) + $CellContext`yF$ == \
($CellContext`yRN$/$CellContext`xRN$) $CellContext`x, $CellContext`x]]]]; \
$CellContext`yP$ = ($CellContext`yRN$/$CellContext`xRN$) $CellContext`xP$; \
$CellContext`operating$[
           Pattern[$CellContext`i$, 
            Blank[]], 
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yR$[$CellContext`i$] - \
$CellContext`yP$)/($CellContext`xR$[$CellContext`i$] - $CellContext`xP$)) \
($CellContext`x$ - $CellContext`xP$) + $CellContext`yP$; $CellContext`lower$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Which[Part[$CellContext`pt$, 2] <= $CellContext`tie$[1][
             Part[$CellContext`pt$, 1]], 0, 
           Inequality[
            $CellContext`tie$[1][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[2][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[1][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[2][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[3][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[2][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[3][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[3][$CellContext`x$], $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]] < Part[$CellContext`pt$, 2], 
           $CellContext`tie$[4][$CellContext`x$]]; $CellContext`upper$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Which[Part[$CellContext`pt$, 2] < $CellContext`tie$[1][
             Part[$CellContext`pt$, 1]], 
           $CellContext`tie$[1][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[1][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[2][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[2][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[2][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[3][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[3][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[3][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[4][$CellContext`x$], $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]] < Part[$CellContext`pt$, 2], 
           $CellContext`tie$[4][$CellContext`x$]]; $CellContext`lever$[
           Pattern[$CellContext`pt$, 
            Blank[]]] := If[Part[$CellContext`pt$, 2] >= $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]], 
           1, (Part[$CellContext`pt$, 
              2] - $CellContext`upper$[$CellContext`pt$, 
             
             Part[$CellContext`pt$, 
              1]])/($CellContext`lower$[$CellContext`pt$, 
             
             Part[$CellContext`pt$, 
              1]] - $CellContext`upper$[$CellContext`pt$, 
            Part[$CellContext`pt$, 1]])]; $CellContext`newtie$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`lever$[$CellContext`pt$] \
$CellContext`lower$[$CellContext`pt$, $CellContext`x$] + (
            1 - $CellContext`lever$[$CellContext`pt$]) \
$CellContext`upper$[$CellContext`pt$, $CellContext`x$]; $CellContext`xtie$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`i$, 
            Blank[]]] := ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`newtie$[$CellContext`pt$, $CellContext`x] == \
$CellContext`phase$[$CellContext`x], $CellContext`x], $CellContext`i$]]; \
$CellContext`xR$[1] = ReplaceAll[$CellContext`x, 
           Part[
            Solve[$CellContext`newtie$[{
                $CellContext`xE$[1], 
                $CellContext`yE$[
                1]}, $CellContext`x] == $CellContext`phase$[$CellContext`x], \
$CellContext`x], 2]]; $CellContext`yR$[1] = $CellContext`phase$[
           $CellContext`xR$[1]]; $CellContext`xE$[2] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`operating$[
              1, $CellContext`x] == $CellContext`phase$[$CellContext`x], \
$CellContext`x], 1]]; $CellContext`yE$[2] = $CellContext`phase$[
           $CellContext`xE$[2]]; 
        Map[If[$CellContext`xR$[# - 
             1] < $CellContext`xRN$, {$CellContext`xR$[#] = 
             ReplaceAll[$CellContext`x, 
               Part[
                Solve[$CellContext`newtie$[{
                    $CellContext`xE$[#], 
                    $CellContext`yE$[#]}, $CellContext`x] == \
$CellContext`phase$[$CellContext`x], $CellContext`x], 
                2]]; $CellContext`yR$[#] = $CellContext`phase$[
               $CellContext`xR$[#]]; $CellContext`xE$[# + 1] = 
             ReplaceAll[$CellContext`x, 
               Part[
                
                Solve[$CellContext`operating$[#, $CellContext`x] == \
$CellContext`phase$[$CellContext`x], $CellContext`x], 1]]; $CellContext`yE$[# + 
               1] = $CellContext`phase$[
               $CellContext`xE$[# + 1]]; Null}]& , 
          Range[2, 10]]; $CellContext`n$ = Part[
           DeleteCases[
            Map[If[$CellContext`xR$[#] < $CellContext`xRN$, 0, #]& , 
             Range[10]], 0], 1]; 
        If[$CellContext`n$ == 
          8, $CellContext`reset$$ = $CellContext`reset$$ + 
           1]; $CellContext`plotlabel$ = Switch[$CellContext`MCR$$, 1, 
           If[$CellContext`hint$$, "hint: read the compositions on the axes", 
            Row[{"Step 1: move the feed point ", 
              Style["F", Italic], 
              " to \nthe correct location, then check solution"}]], 2, 
           If[$CellContext`hint$$, "hint: read the compositions on the axes", 
            Row[{"Step 2: move the solvent point ", 
              Style["S", Italic], 
              " to \nthe correct location, then check solution"}]], 3, 
           If[$CellContext`hint$$, "hint: read the compositions on the axes", 
            Row[{"Step 3: move the desired raffinate point ", 
              Subscript[
               Style["R", Italic], "N"], 
              " to \nthe correct location, then check solution"}]], 4, 
           If[$CellContext`hint$$, "hint: use the lever rule", 
            Row[{"Step 4: use mass balance for two entering streams (", 
              Style["F", Italic], ", ", 
              Style["S", Italic], ")\n to determine the average composition ", 
              Style["M", Italic], ", then check solution"}]], 5, 
           If[$CellContext`hint$$, 
            Row[{"hint: use mass balance for two exit streams (", 
              Subscript[
               Style["R", Italic], "N"], ", ", 
              Subscript[
               Style["E", Italic], 1], ")"}], 
            Row[{"Step 5: move the point for the first extract composition ", 
              Subscript[
               Style["E", Italic], 1], 
              "\n to the correct location, then check solution"}]], 6, 
           If[$CellContext`hint$$, 
            
            Row[{"hint: the operating point is at the intersection of \na \
line through ", 
              Style["F", Italic], " and ", 
              Subscript[
               Style["E", Italic], 1], " and a line through ", 
              Style["S", Italic], " and ", 
              Subscript[
               Style["R", Italic], "N"]}], 
            Row[{"Step 6: move the operating point ", 
              Style["P", Italic], 
              " \nto the correct location, then check solution"}]], 7, 
           
           If[$CellContext`hint$$, 
            "hint: follow the tie line to the other side of the phase \
boundary", 
            "Step 7: move the blue point to the correct raffinate \
composition"], 8, 
           
           If[$CellContext`hint$$, "hint: draw a line to the operating point",
             "Step 8: move the yellow point to the correct extract \
composition"], 9, 
           
           If[$CellContext`hint$$, 
            "hint: follow the tie line to the other side of the phase \
boundary", 
            "Step 9: move the blue point to the correct raffinate \
composition"], 10, 
           
           If[$CellContext`hint$$, "hint: draw a line to the operating point",
             "Step 10: move the yellow point to the correct extract \
composition"], 11, 
           Row[{$CellContext`n$, " stages needed"}]]; Show[
          
          If[$CellContext`MCR$$ <= 
           4, $CellContext`gridLines, {}], $CellContext`base, \
$CellContext`phaseplot$, $CellContext`tielines$, ImageSize -> {600, 390}, 
          PlotRange -> {{-0.25, 1.15}, {-0.1, 0.93}}, 
          ImagePadding -> {{55, 55}, {5, 
             If[$CellContext`hint$$, 
              If[$CellContext`MCR$$ == 6, 15, 35], 
              If[3 <= $CellContext`MCR$$ <= 5, 15, 35]]}}, PlotLabel -> 
          Style[$CellContext`plotlabel$, 17, Black], Epilog -> {Thick, 
            If[$CellContext`MCR$$ == 1, {
              $CellContext`pt1[$CellContext`feed$$, $CellContext`colF], 
              $CellContext`label1[
              "F", $CellContext`colF, $CellContext`feed$$], 
              $CellContext`table1["feed", $CellContext`xF$, $CellContext`yF$], 
              If[$CellContext`solution$$, 
               $CellContext`pt2[{$CellContext`xF$, $CellContext`yF$}, \
$CellContext`colF]]}], 
            If[$CellContext`MCR$$ > 1, {
              $CellContext`pt2[{$CellContext`xF$, $CellContext`yF$}, \
$CellContext`colF], 
              $CellContext`label1[
              "F", $CellContext`colF, {$CellContext`xF$, $CellContext`yF$}]}], 
            If[$CellContext`MCR$$ == 2, {
              $CellContext`pt1[$CellContext`solvent$$, $CellContext`colS], 
              $CellContext`label1[
              "S", $CellContext`colS, $CellContext`solvent$$], 
              $CellContext`table1["solvent", 0, 0], 
              If[$CellContext`solution$$, 
               $CellContext`pt2[{0, 0}, $CellContext`colS]]}], 
            If[$CellContext`MCR$$ > 2, {
              $CellContext`pt2[{0, 0}, $CellContext`colS], 
              $CellContext`label1["S", $CellContext`colS, {0, 0}]}], 
            If[$CellContext`MCR$$ == 3, {
              $CellContext`pt1[$CellContext`raffinateN$$, $CellContext`colR], 
              $CellContext`label2[{
               "R", "N"}, $CellContext`colR, $CellContext`raffinateN$$], 
              $CellContext`table1[
              "raffinate", $CellContext`xRN$, $CellContext`yRN$], 
              If[$CellContext`solution$$, 
               $CellContext`pt2[{$CellContext`xRN$, $CellContext`yRN$}, \
$CellContext`colR]]}], 
            If[$CellContext`MCR$$ > 3, {
              $CellContext`pt2[{$CellContext`xRN$, $CellContext`yRN$}, \
$CellContext`colR], 
              $CellContext`label2[{
               "R", "N"}, $CellContext`colR, {$CellContext`xRN$, \
$CellContext`yRN$}]}], 
            If[$CellContext`MCR$$ == 4, {{Dashed, $CellContext`colM, 
               Line[{{$CellContext`xF$, $CellContext`yF$}, {0, 0}}]}, 
              $CellContext`pt1[$CellContext`mixing$$, $CellContext`colM], 
              $CellContext`label1[
              "M", $CellContext`colM, $CellContext`mixing$$], 
              $CellContext`table2["mixing", 
               Part[$CellContext`mixing$$, 1], 
               Part[$CellContext`mixing$$, 2]], 
              Text[
               Style[
                Column[{"flow rates", 
                  Framed[
                   Column[{
                    Style[
                    Row[{
                    Style["F", Italic], " = ", 
                    NumberForm[$CellContext`F$, {4, 0}], 
                    " kg/h"}], $CellContext`colF], 
                    Style[
                    Row[{
                    Style["S", Italic], " = ", 
                    NumberForm[$CellContext`S$, {4, 0}], 
                    " kg/h"}], $CellContext`colS]}, Alignment -> "="]]}, 
                 Center], 17], {-0.05, 0.75}], 
              If[$CellContext`solution$$, 
               $CellContext`pt2[{$CellContext`xM$, $CellContext`yM$}, \
$CellContext`colM]]}], 
            If[$CellContext`MCR$$ == 5, {
              $CellContext`pt2[{$CellContext`xM$, $CellContext`yM$}, \
$CellContext`colM], 
              $CellContext`label1[
              "M", $CellContext`colM, {$CellContext`xM$, $CellContext`yM$}], \
{$CellContext`colE1, 
               
               Arrow[{{$CellContext`xRN$, $CellContext`yRN$}, \
$CellContext`extract1$$}]}, 
              $CellContext`pt1[$CellContext`extract1$$, $CellContext`colE1], 
              $CellContext`label2[{
               "E", 1}, $CellContext`colE1, $CellContext`extract1$$], 
              If[$CellContext`solution$$, 
               $CellContext`pt2[{
                 $CellContext`xE$[1], 
                 $CellContext`yE$[1]}, $CellContext`colE1]]}], 
            If[$CellContext`MCR$$ > 5, {
              $CellContext`pt2[{
                $CellContext`xE$[1], 
                $CellContext`yE$[1]}, $CellContext`colE1], 
              $CellContext`label2[{"E", 1}, $CellContext`colE1, {
                $CellContext`xE$[1], 
                $CellContext`yE$[1]}]}], 
            If[$CellContext`MCR$$ == 6, {{
               Thickness[0.007], Dotted, $CellContext`colOP, 
               
               Line[{$CellContext`operatingpt$$, {$CellContext`xF$, \
$CellContext`yF$}}], 
               
               Line[{$CellContext`operatingpt$$, {$CellContext`xRN$, \
$CellContext`yRN$}}]}, 
              $CellContext`pt1[$CellContext`operatingpt$$, \
$CellContext`colOP], 
              $CellContext`label1[
              "P", $CellContext`colOP, $CellContext`operatingpt$$], 
              If[$CellContext`solution$$, {Dashed, $CellContext`colOP, 
                
                Line[{{$CellContext`xP$, $CellContext`yP$}, \
{$CellContext`xF$, $CellContext`yF$}}], 
                
                Line[{{$CellContext`xP$, $CellContext`yP$}, \
{$CellContext`xRN$, $CellContext`yRN$}}], 
                $CellContext`pt2[{$CellContext`xP$, $CellContext`yP$}, \
$CellContext`colOP]}]}], 
            If[6 < $CellContext`MCR$$ < 11, {
              $CellContext`pt2[{$CellContext`xP$, $CellContext`yP$}, \
$CellContext`colOP], 
              $CellContext`label1[
              "P", $CellContext`colOP, {$CellContext`xP$, \
$CellContext`yP$}]}], 
            If[$CellContext`MCR$$ == 7, {{$CellContext`colR, Dashed, 
               Line[{{
                  $CellContext`xE$[1], 
                  $CellContext`yE$[1]}, $CellContext`raffinate1$$}]}, 
              $CellContext`pt1[$CellContext`raffinate1$$, $CellContext`colR], 
              $CellContext`label2[{"R", 1}, $CellContext`colR, 
               If[$CellContext`solution$$, {
                 $CellContext`xR$[1], 
                 $CellContext`yR$[1]}, $CellContext`raffinate1$$]], 
              If[$CellContext`solution$$, {$CellContext`colR, Dashed, 
                Line[{{
                   $CellContext`xE$[1], 
                   $CellContext`yE$[1]}, {
                   $CellContext`xR$[1], 
                   $CellContext`yR$[1]}}], 
                $CellContext`pt2[{
                  $CellContext`xR$[1], 
                  $CellContext`yR$[1]}, $CellContext`colR]}]}], 
            If[7 < $CellContext`MCR$$ < 11, {{$CellContext`colR, Dashed, 
               Line[{{
                  $CellContext`xE$[1], 
                  $CellContext`yE$[1]}, {
                  $CellContext`xR$[1], 
                  $CellContext`yR$[1]}}]}, 
              $CellContext`pt2[{
                $CellContext`xR$[1], 
                $CellContext`yR$[1]}, $CellContext`colR], 
              $CellContext`label2[{"R", 1}, $CellContext`colR, {
                $CellContext`xR$[1], 
                $CellContext`yR$[1]}]}], 
            If[$CellContext`MCR$$ == 8, {{$CellContext`colE1, Dashed, 
               Line[{{
                  $CellContext`xR$[1], 
                  $CellContext`yR$[
                  1]}, {$CellContext`xP$, $CellContext`yP$}}]}, 
              $CellContext`pt1[$CellContext`extract2$$, $CellContext`colE1], 
              $CellContext`label2[{"E", 2}, $CellContext`colE1, 
               If[$CellContext`solution$$, {
                 $CellContext`xE$[2], 
                 $CellContext`yE$[2]}, $CellContext`extract2$$]], 
              If[$CellContext`solution$$, {{$CellContext`colE1, Dashed, 
                 Line[{{
                    $CellContext`xR$[1], 
                    $CellContext`yR$[1]}, {
                    $CellContext`xE$[2], 
                    $CellContext`yE$[2]}}]}, 
                $CellContext`pt2[{
                  $CellContext`xE$[2], 
                  $CellContext`yE$[2]}, $CellContext`colE1]}]}], 
            If[8 < $CellContext`MCR$$ < 11, {{$CellContext`colE1, Dashed, 
               Line[{{
                  $CellContext`xR$[1], 
                  $CellContext`yR$[1]}, {
                  $CellContext`xE$[2], 
                  $CellContext`yE$[2]}}]}, 
              $CellContext`pt2[{
                $CellContext`xE$[2], 
                $CellContext`yE$[2]}, $CellContext`colE1], 
              $CellContext`label2[{"E", 2}, $CellContext`colE1, {
                $CellContext`xE$[2], 
                $CellContext`yE$[2]}]}], 
            If[$CellContext`MCR$$ == 9, {{$CellContext`colR, Dashed, 
               Line[{{
                  $CellContext`xE$[2], 
                  $CellContext`yE$[2]}, $CellContext`raffinate2$$}]}, 
              $CellContext`pt1[$CellContext`raffinate2$$, $CellContext`colR], 
              $CellContext`label2[{"R", 2}, $CellContext`colR, 
               If[$CellContext`solution$$, {
                 $CellContext`xR$[2], 
                 $CellContext`yR$[2]}, $CellContext`raffinate2$$]], 
              If[$CellContext`solution$$, {$CellContext`colR, Dashed, 
                Line[{{
                   $CellContext`xE$[2], 
                   $CellContext`yE$[2]}, {
                   $CellContext`xR$[2], 
                   $CellContext`yR$[2]}}], 
                $CellContext`pt2[{
                  $CellContext`xR$[2], 
                  $CellContext`yR$[2]}, $CellContext`colR]}]}], 
            If[9 < $CellContext`MCR$$ < 11, {{$CellContext`colR, Dashed, 
               Line[{{
                  $CellContext`xE$[2], 
                  $CellContext`yE$[2]}, {
                  $CellContext`xR$[2], 
                  $CellContext`yR$[2]}}]}, 
              $CellContext`pt2[{
                $CellContext`xR$[2], 
                $CellContext`yR$[2]}, $CellContext`colR], 
              $CellContext`label2[{"R", 2}, $CellContext`colR, {
                $CellContext`xR$[2], 
                $CellContext`yR$[2]}]}], 
            If[$CellContext`MCR$$ == 10, {{$CellContext`colE1, Dashed, 
               Line[{{
                  $CellContext`xR$[2], 
                  $CellContext`yR$[
                  2]}, {$CellContext`xP$, $CellContext`yP$}}]}, 
              $CellContext`pt1[$CellContext`extract3$$, $CellContext`colE1], 
              $CellContext`label2[{"E", 3}, $CellContext`colE1, 
               If[$CellContext`solution$$, {
                 $CellContext`xE$[3], 
                 $CellContext`yE$[3]}, $CellContext`extract3$$]], 
              If[$CellContext`solution$$, {{$CellContext`colE1, Dashed, 
                 Line[{{
                    $CellContext`xR$[2], 
                    $CellContext`yR$[2]}, {
                    $CellContext`xE$[3], 
                    $CellContext`yE$[3]}}]}, 
                $CellContext`pt2[{
                  $CellContext`xE$[3], 
                  $CellContext`yE$[3]}, $CellContext`colE1]}]}], 
            If[$CellContext`MCR$$ == 11, {
              Map[{Dashed, $CellContext`colE1, 
                Line[{{
                   $CellContext`xE$[#], 
                   $CellContext`yE$[#]}, {
                   $CellContext`xR$[#], 
                   $CellContext`yR$[#]}}], $CellContext`colR, 
                Line[{{
                   $CellContext`xR$[#], 
                   $CellContext`yR$[#]}, {
                   $CellContext`xE$[# + 1], 
                   $CellContext`yE$[# + 1]}}]}& , 
               Range[$CellContext`n$]], 
              Map[{
                $CellContext`pt2[{
                  $CellContext`xE$[#], 
                  $CellContext`yE$[#]}, $CellContext`colE1], 
                $CellContext`label2[{"E", #}, $CellContext`colE1, {
                  $CellContext`xE$[#], 
                  $CellContext`yE$[#]}]}& , 
               Range[2, $CellContext`n$]], 
              Map[{
                $CellContext`pt2[{
                  $CellContext`xR$[#], 
                  $CellContext`yR$[#]}, $CellContext`colR], 
                $CellContext`label2[{"R", #}, $CellContext`colR, {
                  $CellContext`xR$[#], 
                  $CellContext`yR$[#]}]}& , 
               Range[$CellContext`n$]], 
              Map[Text[
                Style[
                 Row[{" ", #, " "}], 18, Background -> 
                 White], {$CellContext`xE$[#] + $CellContext`xR$[#], \
$CellContext`yE$[#] + $CellContext`yR$[#]}/2, {0, -1.5}]& , 
               Range[$CellContext`n$]]}]}]], 
      "Specifications" :> {{{$CellContext`reset$$, 1}, 1, 1000, 1, 
         ControlType -> None, ControlPlacement -> 
         1}, {{$CellContext`MCR$$, 1, ""}, {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 
         11}, ControlType -> None, ControlPlacement -> 
         2}, {{$CellContext`solution$$, False, "solution"}, {True, False}, 
         Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         3}, {{$CellContext`hint$$, False, "hint"}, {True, False}, 
         ControlPlacement -> 4}, {{$CellContext`feed$$, {0.5, 0.7}}, 
         Automatic, ControlType -> Locator, Appearance -> None, Enabled -> 
         Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         5}, {{$CellContext`solvent$$, {0.5, 0.7}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         6}, {{$CellContext`raffinateN$$, {0.5, 0.7}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         7}, {{$CellContext`mixing$$, {0.5, 0.7}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         8}, {{$CellContext`extract1$$, {0.4, 0.3}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         9}, {{$CellContext`operatingpt$$, {0.5, 0.7}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         10}, {{$CellContext`raffinate1$$, {0.6, 0.3}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         11}, {{$CellContext`extract2$$, {0.4, 0.15}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         12}, {{$CellContext`raffinate2$$, {0.6, 0.3}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         13}, {{$CellContext`extract3$$, {0.4, 0.15}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 14}, 
        Grid[{{
           Button["new problem", {
             
             If[$CellContext`reset$$ < 
              1000, $CellContext`reset$$ = $CellContext`reset$$ + 
               1, $CellContext`reset$$ = $CellContext`reset$$ - 
               1], $CellContext`MCR$$ = 1, $CellContext`solution$$ = 
             False, $CellContext`hint$$ = 
             False, $CellContext`feed$$ = {0.5, 
              0.7}, $CellContext`solvent$$ = {0.5, 
              0.7}, $CellContext`raffinateN$$ = {0.5, 
              0.7}, $CellContext`mixing$$ = {0.5, 
              0.7}, $CellContext`extract1$$ = {0.4, 
              0.3}, $CellContext`operatingpt$$ = {0.5, 
              0.7}, $CellContext`raffinate1$$ = {0.6, 
              0.3}, $CellContext`rafinate2 = {0.6, 
              0.3}, $CellContext`raffinate3 = {0.6, 
              0.3}, $CellContext`rafinate4 = {0.6, 
              0.3}, $CellContext`rafinate5 = {0.6, 
              0.3}, $CellContext`extract2$$ = {0.4, 
              0.15}, $CellContext`extract3$$ = {0.4, 
              0.15}, $CellContext`extract4 = {0.4, 
              0.15}, $CellContext`extract5 = {0.4, 
              0.15}, $CellContext`extract6 = {0.4, 0.15}, $CellContext`Estage = 
             1, $CellContext`Rstage = 1}], 
           Manipulate`Place[1], 
           
           PaneSelector[{
            1 -> "(1) locate feed point", 2 -> "(2) locate solvent point", 3 -> 
             "(3) locate raffinate point", 4 -> "(4) locate mixing point", 5 -> 
             "(5) locate first extract point", 6 -> 
             "(6) locate operating point", 7 -> Row[{"(7) determine ", 
                Subscript[
                 Style["R", Italic], 1]}], 8 -> Row[{"(8) determine ", 
                Subscript[
                 Style["E", Italic], 2]}], 9 -> Row[{"(9) determine ", 
                Subscript[
                 Style["R", Italic], 2]}], 10 -> Row[{"(10) determine ", 
                Subscript[
                 Style["E", Italic], 3]}], 11 -> "(11) solution"}, 
            Dynamic[$CellContext`MCR$$]], 
           Manipulate`Place[2], 
           PaneSelector[{1 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 2 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 3 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 4 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 5 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 6 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 7 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 8 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 9 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 10 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}]}, 
            Dynamic[$CellContext`MCR$$]], 
           
           PaneSelector[{
            1 -> Manipulate`Place[3], 2 -> Manipulate`Place[3], 3 -> 
             Manipulate`Place[3], 4 -> Manipulate`Place[3], 5 -> 
             Manipulate`Place[3], 6 -> Manipulate`Place[3], 7 -> 
             Manipulate`Place[3], 8 -> Manipulate`Place[3], 9 -> 
             Manipulate`Place[3], 10 -> Manipulate`Place[3]}, 
            Dynamic[$CellContext`MCR$$]], 
           
           PaneSelector[{
            1 -> Manipulate`Place[4], 2 -> Manipulate`Place[4], 3 -> 
             Manipulate`Place[4], 4 -> Manipulate`Place[4], 5 -> 
             Manipulate`Place[4], 6 -> Manipulate`Place[4], 7 -> 
             Manipulate`Place[4], 8 -> Manipulate`Place[4], 9 -> 
             Manipulate`Place[4], 10 -> Manipulate`Place[4]}, 
            Dynamic[$CellContext`MCR$$]], 
           
           PaneSelector[{
            1 -> Manipulate`Place[5], 2 -> Manipulate`Place[6], 3 -> 
             Manipulate`Place[7], 4 -> Manipulate`Place[8], 5 -> 
             Manipulate`Place[9], 6 -> Manipulate`Place[10], 7 -> 
             Manipulate`Place[11], 8 -> Manipulate`Place[12], 9 -> 
             Manipulate`Place[13], 10 -> Manipulate`Place[14]}, 
            Dynamic[$CellContext`MCR$$]]}}]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{649., {242., 248.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({
      Attributes[PlotRange] = {ReadProtected}, $CellContext`wtA[
         Pattern[$CellContext`y, 
          Blank[]]] := $CellContext`y (2/Sqrt[3]), $CellContext`wtS[
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`y, 
          Blank[]]] := 1 - ($CellContext`x + $CellContext`y/Sqrt[3]), 
       Attributes[Subscript] = {NHoldRest}, $CellContext`gridLines = Graphics[{
          Thickness[Tiny], 
          GrayLevel[0.7], {{
            Line[{{0., 0.}, {1., 0.}}], 
            Line[{{0., 0}, {0., 0.}}], 
            Line[{{1., 0}, {1., 0.}}]}, {
            
            Line[{{0.025, 0.04330127018922193}, {0.975, 
             0.04330127018922193}}], 
            Line[{{0.05, 0}, {0.025, 0.04330127018922193}}], 
            Line[{{0.95, 0}, {0.975, 0.04330127018922193}}]}, {
            Line[{{0.05, 0.08660254037844387}, {0.95, 0.08660254037844387}}], 
            Line[{{0.1, 0}, {0.05, 0.08660254037844387}}], 
            Line[{{0.9, 0}, {0.95, 0.08660254037844387}}]}, {
            
            Line[{{0.07500000000000001, 0.1299038105676658}, {0.925, 
             0.1299038105676658}}], 
            
            Line[{{0.15000000000000002`, 0}, {0.07500000000000001, 
              0.1299038105676658}}], 
            Line[{{0.85, 0}, {0.925, 0.1299038105676658}}]}, {
            Line[{{0.1, 0.17320508075688773`}, {0.9, 0.17320508075688773`}}], 
            Line[{{0.2, 0}, {0.1, 0.17320508075688773`}}], 
            Line[{{0.8, 0}, {0.9, 0.17320508075688773`}}]}, {
            
            Line[{{0.125, 0.21650635094610965`}, {0.875, 
             0.21650635094610965`}}], 
            Line[{{0.25, 0}, {0.125, 0.21650635094610965`}}], 
            Line[{{0.75, 0}, {0.875, 0.21650635094610965`}}]}, {
            
            Line[{{0.15000000000000002`, 0.2598076211353316}, {0.85, 
             0.2598076211353316}}], 
            
            Line[{{0.30000000000000004`, 0}, {0.15000000000000002`, 
              0.2598076211353316}}], 
            Line[{{0.7, 0}, {0.85, 0.2598076211353316}}]}, {
            
            Line[{{0.17500000000000002`, 0.30310889132455354`}, {0.825, 
             0.30310889132455354`}}], 
            
            Line[{{0.35000000000000003`, 0}, {0.17500000000000002`, 
              0.30310889132455354`}}], 
            Line[{{0.6499999999999999, 0}, {0.825, 0.30310889132455354`}}]}, {
            Line[{{0.2, 0.34641016151377546`}, {0.8, 0.34641016151377546`}}], 
            Line[{{0.4, 0}, {0.2, 0.34641016151377546`}}], 
            Line[{{0.6, 0}, {0.8, 0.34641016151377546`}}]}, {
            Line[{{0.225, 0.3897114317029974}, {0.775, 0.3897114317029974}}], 
            Line[{{0.45, 0}, {0.225, 0.3897114317029974}}], 
            Line[{{0.55, 0}, {0.775, 0.3897114317029974}}]}, {
            Line[{{0.25, 0.4330127018922193}, {0.75, 0.4330127018922193}}], 
            Line[{{0.5, 0}, {0.25, 0.4330127018922193}}], 
            Line[{{0.5, 0}, {0.75, 0.4330127018922193}}]}, {
            Line[{{0.275, 0.4763139720814413}, {0.725, 0.4763139720814413}}], 
            Line[{{0.55, 0}, {0.275, 0.4763139720814413}}], 
            Line[{{0.44999999999999996`, 0}, {0.725, 0.4763139720814413}}]}, {
            
            Line[{{0.30000000000000004`, 0.5196152422706632}, {0.7, 
             0.5196152422706632}}], 
            
            Line[{{0.6000000000000001, 0}, {0.30000000000000004`, 
              0.5196152422706632}}], 
            Line[{{0.3999999999999999, 0}, {0.7, 0.5196152422706632}}]}, {
            Line[{{0.325, 0.562916512459885}, {0.675, 0.562916512459885}}], 
            Line[{{0.65, 0}, {0.325, 0.562916512459885}}], 
            Line[{{0.35, 0}, {0.675, 0.562916512459885}}]}, {
            
            Line[{{0.35000000000000003`, 0.6062177826491071}, {
             0.6499999999999999, 0.6062177826491071}}], 
            
            Line[{{0.7000000000000001, 0}, {0.35000000000000003`, 
              0.6062177826491071}}], 
            
            Line[{{0.29999999999999993`, 0}, {0.6499999999999999, 
              0.6062177826491071}}]}, {
            Line[{{0.375, 0.649519052838329}, {0.625, 0.649519052838329}}], 
            Line[{{0.75, 0}, {0.375, 0.649519052838329}}], 
            Line[{{0.25, 0}, {0.625, 0.649519052838329}}]}, {
            Line[{{0.4, 0.6928203230275509}, {0.6, 0.6928203230275509}}], 
            Line[{{0.8, 0}, {0.4, 0.6928203230275509}}], 
            Line[{{0.19999999999999996`, 0}, {0.6, 0.6928203230275509}}]}, {
            Line[{{0.42500000000000004`, 0.7361215932167728}, {0.575, 
             0.7361215932167728}}], 
            
            Line[{{0.8500000000000001, 0}, {0.42500000000000004`, 
              0.7361215932167728}}], 
            Line[{{0.1499999999999999, 0}, {0.575, 0.7361215932167728}}]}, {
            Line[{{0.45, 0.7794228634059948}, {0.55, 0.7794228634059948}}], 
            Line[{{0.9, 0}, {0.45, 0.7794228634059948}}], 
            Line[{{0.09999999999999998, 0}, {0.55, 0.7794228634059948}}]}, {
            
            Line[{{0.47500000000000003`, 0.8227241335952167}, {
             0.5249999999999999, 0.8227241335952167}}], 
            
            Line[{{0.9500000000000001, 0}, {0.47500000000000003`, 
              0.8227241335952167}}], 
            
            Line[{{0.04999999999999993, 0}, {0.5249999999999999, 
              0.8227241335952167}}]}, {
            Line[{{0.5, 0.8660254037844386}, {0.5, 0.8660254037844386}}], 
            Line[{{1., 0}, {0.5, 0.8660254037844386}}], 
            Line[{{0., 0}, {0.5, 0.8660254037844386}}]}}}], $CellContext`base = 
       Graphics[{{
           EdgeForm[
            Thickness[Large]], 
           FaceForm[None], 
           Polygon[{{0, 0}, {0.5, Sqrt[3]/2}, {1, 0}}]}, {{{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.1, 17], {0.05, 0.08660254037844387}, {2.25, 0}], 
             
             Line[{{0.020000000000000004`, 0.08660254037844387}, {0.05, 
              0.08660254037844387}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.9, 17], {0.1, 0}, {-2.25, 0}, {1/2, -1}], 
             Line[{{0.1, 0}, {0.115, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.9, 17], {0.95, 0.08660254037844387}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.95, 0.08660254037844387}, {0.965, 
              0.11258330249197702`}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.2, 17], {0.1, 0.17320508075688773`}, {2.25, 0}], 
             Line[{{0.07, 0.17320508075688773`}, {0.1, 
              0.17320508075688773`}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.8, 17], {0.2, 0}, {-2.25, 0}, {1/2, -1}], 
             
             Line[{{0.2, 0}, {
               0.21500000000000002`, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.8, 17], {0.9, 0.17320508075688773`}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.9, 0.17320508075688773`}, {0.915, 
              0.19918584287042088`}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.30000000000000004`, 17], {0.15000000000000002`, 
              0.2598076211353316}, {2.25, 0}], 
             
             Line[{{0.12000000000000002`, 0.2598076211353316}, {
              0.15000000000000002`, 0.2598076211353316}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.7, 17], {0.30000000000000004`, 0}, {-2.25, 0}, {
              1/2, -1}], 
             
             Line[{{0.30000000000000004`, 0}, {
               0.31500000000000006`, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.7, 17], {0.85, 0.2598076211353316}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.85, 0.2598076211353316}, {0.865, 
              0.2857883832488648}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.4, 17], {0.2, 0.34641016151377546`}, {2.25, 0}], 
             
             Line[{{0.17, 0.34641016151377546`}, {0.2, 
              0.34641016151377546`}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.6, 17], {0.4, 0}, {-2.25, 0}, {1/2, -1}], 
             
             Line[{{0.4, 0}, {
               0.41500000000000004`, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.6, 17], {0.8, 0.34641016151377546`}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.8, 0.34641016151377546`}, {0.815, 
              0.37239092362730863`}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.5, 17], {0.25, 0.4330127018922193}, {2.25, 0}], 
             Line[{{0.22, 0.4330127018922193}, {0.25, 0.4330127018922193}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.5, 17], {0.5, 0}, {-2.25, 0}, {1/2, -1}], 
             Line[{{0.5, 0}, {0.515, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.5, 17], {0.75, 0.4330127018922193}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.75, 0.4330127018922193}, {0.765, 
              0.45899346400575247`}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.6, 17], {0.3, 0.5196152422706631}, {2.25, 0}], 
             Line[{{0.27, 0.5196152422706631}, {0.3, 0.5196152422706631}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.4, 17], {0.6, 0}, {-2.25, 0}, {1/2, -1}], 
             Line[{{0.6, 0}, {0.615, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.4, 17], {0.7, 0.5196152422706631}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.7, 0.5196152422706631}, {0.7150000000000001, 
              0.5455960043841963}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.7000000000000001, 17], {0.35000000000000003`, 
              0.6062177826491071}, {2.25, 0}], 
             
             Line[{{0.32000000000000006`, 0.6062177826491071}, {
              0.35000000000000003`, 0.6062177826491071}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.29999999999999993`, 17], {
              0.7000000000000001, 0}, {-2.25, 0}, {1/2, -1}], 
             
             Line[{{0.7000000000000001, 0}, {
               0.7150000000000001, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.29999999999999993`, 17], {0.6499999999999999, 
              0.6062177826491071}, {-2.25, 0}, {1.5, 2}], 
             
             Line[{{0.6499999999999999, 0.6062177826491071}, {0.665, 
              0.6321985447626403}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.8, 17], {0.4, 0.6928203230275509}, {2.25, 0}], 
             Line[{{0.37, 0.6928203230275509}, {0.4, 0.6928203230275509}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.19999999999999996`, 17], {0.8, 0}, {-2.25, 0}, {
              1/2, -1}], 
             Line[{{0.8, 0}, {0.8150000000000001, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.19999999999999996`, 17], {0.6, 
              0.6928203230275509}, {-2.25, 0}, {1.5, 2}], 
             
             Line[{{0.6, 0.6928203230275509}, {0.615, 
              0.7188010851410841}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.9, 17], {0.45, 0.7794228634059948}, {2.25, 0}], 
             
             Line[{{0.42000000000000004`, 0.7794228634059948}, {0.45, 
              0.7794228634059948}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.09999999999999998, 17], {0.9, 0}, {-2.25, 0}, {
              1/2, -1}], 
             Line[{{0.9, 0}, {0.915, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.09999999999999998, 17], {0.55, 
              0.7794228634059948}, {-2.25, 0}, {1.5, 2}], 
             
             Line[{{0.55, 0.7794228634059948}, {0.565, 
              0.8054036255195279}}]}}}, 
          Text[
           Style["solute", 17, 
            RGBColor[0, 0, 1]], {0.5, Sqrt[3]/2}, {0, -1}], 
          Text[
           Style["solvent", 17, 
            RGBColor[1, 0, 0]], {0, 0}, {1, 2}], 
          Text[
           Style["carrier", 17, 
            RGBColor[0, 0.6, 0]], {1, 0}, {-1, 2}]}], $CellContext`pt1[
         Pattern[$CellContext`pt, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]]] := {$CellContext`col, 
         PointSize[0.03], 
         Point[$CellContext`pt], White, 
         PointSize[0.015], 
         Point[$CellContext`pt]}, $CellContext`colF = 
       GrayLevel[0], $CellContext`label1[
         Pattern[$CellContext`text, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]], 
         Pattern[$CellContext`loc, 
          Blank[]]] := Text[
         Framed[
          Style[
           Row[{" ", $CellContext`text, " "}], 18, Italic, $CellContext`col], 
          Background -> White, FrameStyle -> $CellContext`col, FrameMargins -> 
          Tiny, RoundingRadius -> 15], $CellContext`loc, {
         0, -1.5}], $CellContext`table1[
         Pattern[$CellContext`title, 
          Blank[]], 
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`y, 
          Blank[]]] := Text[
         Style[
          Column[{
            Row[{$CellContext`title, " mole fractions"}], 
            Framed[
             Column[{
               Style[
                Row[{"solute = ", 
                  NumberForm[
                   $CellContext`wtA[$CellContext`y], {2, 2}]}], Blue], 
               Style[
                Row[{"solvent = ", 
                  NumberForm[
                   $CellContext`wtS[$CellContext`x, $CellContext`y], {2, 
                   2}]}], Red], 
               Style[
                Row[{"carrier = ", 
                  
                  NumberForm[$CellContext`x - $CellContext`y/Sqrt[3], {2, 
                   2}]}], 
                RGBColor[0, 0.6, 0]]}], 
             FrameMargins -> {{20, 20}, {Automatic, Automatic}}]}, Center], 
          17], {-0.05, 0.75}], $CellContext`pt2[
         Pattern[$CellContext`pt, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]]] := {$CellContext`col, 
         PointSize[0.03], 
         Point[$CellContext`pt]}, $CellContext`colS = 
       RGBColor[1, 0, 0], $CellContext`colR = 
       RGBColor[0, 0.2666666666666667, 0.4], $CellContext`label2[
         Pattern[$CellContext`text, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]], 
         Pattern[$CellContext`loc, 
          Blank[]]] := Text[
         Framed[
          Style[
           Subscript[
            Style[
             Part[$CellContext`text, 1], Italic], 
            Part[$CellContext`text, 2]], 18, $CellContext`col], Background -> 
          White, FrameStyle -> $CellContext`col, FrameMargins -> Small, 
          RoundingRadius -> 15], $CellContext`loc, {
         0, -1.5}], $CellContext`colM = GrayLevel[0.3], $CellContext`table2[
         Pattern[$CellContext`title, 
          Blank[]], 
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`y, 
          Blank[]]] := Text[
         Style[
          Column[{
            Row[{$CellContext`title, " mole fractions"}], 
            Framed[
             Column[{
               Style[
                Row[{"solute = ", 
                  NumberForm[
                   $CellContext`wtA[$CellContext`y], {2, 2}]}], Blue], 
               Style[
                Row[{"solvent = ", 
                  NumberForm[
                   $CellContext`wtS[$CellContext`x, $CellContext`y], {2, 
                   2}]}], Red], 
               Style[
                Row[{"carrier = ", 
                  
                  NumberForm[$CellContext`x - $CellContext`y/Sqrt[3], {2, 
                   2}]}], 
                RGBColor[0, 0.6, 0]]}], 
             FrameMargins -> {{20, 20}, {Automatic, Automatic}}]}, Center], 
          17], {1.05, 0.75}], $CellContext`colE1 = 
       RGBColor[1, 0.5, 0], $CellContext`colOP = 
       RGBColor[0.5, 0, 0.5], $CellContext`rafinate2 = {0.6, 
        0.3}, $CellContext`raffinate3 = {0.6, 0.3}, $CellContext`rafinate4 = {
        0.6, 0.3}, $CellContext`rafinate5 = {0.6, 
        0.3}, $CellContext`extract4 = {0.4, 0.15}, $CellContext`extract5 = {
        0.4, 0.15}, $CellContext`extract6 = {0.4, 0.15}, $CellContext`Estage = 
       1, $CellContext`Rstage = 1}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Input",
 CellChangeTimes->{{3.762017244420496*^9, 3.762017245137944*^9}},
 CellID->321261046,ExpressionUUID->"92b9ed90-3221-45aa-8232-56c54fac04ec"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SnapshotsSection",ExpressionUUID->"d16cfa91-ef01-4f24-97c7-d0a30d8234e5"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`extract1$$ = {0.4, 
    0.3}, $CellContext`extract2$$ = {0.4, 0.15}, $CellContext`extract3$$ = {
    0.4, 0.15}, $CellContext`feed$$ = {0.5, 0.7}, $CellContext`hint$$ = 
    False, $CellContext`MCR$$ = 1, $CellContext`mixing$$ = {0.5, 
    0.7}, $CellContext`operatingpt$$ = {0.5, 
    0.7}, $CellContext`raffinate1$$ = {0.6, 
    0.3}, $CellContext`raffinate2$$ = {0.6, 
    0.3}, $CellContext`raffinateN$$ = {0.5, 0.7}, $CellContext`reset$$ = 
    1, $CellContext`solution$$ = False, $CellContext`solvent$$ = {0.5, 0.7}, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`reset$$], 1}, 1, 1000, 1}, {{
       Hold[$CellContext`MCR$$], 1, ""}, {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 
      11}}, {{
       Hold[$CellContext`solution$$], False, "solution"}, {True, False}}, {{
       Hold[$CellContext`hint$$], False, "hint"}, {True, False}}, {{
       Hold[$CellContext`feed$$], {0.5, 0.7}}, Automatic}, {{
       Hold[$CellContext`solvent$$], {0.5, 0.7}}, Automatic}, {{
       Hold[$CellContext`raffinateN$$], {0.5, 0.7}}, Automatic}, {{
       Hold[$CellContext`mixing$$], {0.5, 0.7}}, Automatic}, {{
       Hold[$CellContext`extract1$$], {0.4, 0.3}}, Automatic}, {{
       Hold[$CellContext`operatingpt$$], {0.5, 0.7}}, Automatic}, {{
       Hold[$CellContext`raffinate1$$], {0.6, 0.3}}, Automatic}, {{
       Hold[$CellContext`extract2$$], {0.4, 0.15}}, Automatic}, {{
       Hold[$CellContext`raffinate2$$], {0.6, 0.3}}, Automatic}, {{
       Hold[$CellContext`extract3$$], {0.4, 0.15}}, Automatic}, {
      Hold[
       Grid[{{
          Button["new problem", {
            
            If[$CellContext`reset$$ < 
             1000, $CellContext`reset$$ = $CellContext`reset$$ + 
              1, $CellContext`reset$$ = $CellContext`reset$$ - 
              1], $CellContext`MCR$$ = 1, $CellContext`solution$$ = 
            False, $CellContext`hint$$ = 
            False, $CellContext`feed$$ = {0.5, 
             0.7}, $CellContext`solvent$$ = {0.5, 
             0.7}, $CellContext`raffinateN$$ = {0.5, 
             0.7}, $CellContext`mixing$$ = {0.5, 
             0.7}, $CellContext`extract1$$ = {0.4, 
             0.3}, $CellContext`operatingpt$$ = {0.5, 
             0.7}, $CellContext`raffinate1$$ = {0.6, 
             0.3}, $CellContext`rafinate2 = {0.6, 
             0.3}, $CellContext`raffinate3 = {0.6, 
             0.3}, $CellContext`rafinate4 = {0.6, 
             0.3}, $CellContext`rafinate5 = {0.6, 
             0.3}, $CellContext`extract2$$ = {0.4, 
             0.15}, $CellContext`extract3$$ = {0.4, 
             0.15}, $CellContext`extract4 = {0.4, 
             0.15}, $CellContext`extract5 = {0.4, 
             0.15}, $CellContext`extract6 = {0.4, 0.15}, $CellContext`Estage = 
            1, $CellContext`Rstage = 1}], 
          Manipulate`Place[1], 
          
          PaneSelector[{
           1 -> "(1) locate feed point", 2 -> "(2) locate solvent point", 3 -> 
            "(3) locate raffinate point", 4 -> "(4) locate mixing point", 5 -> 
            "(5) locate first extract point", 6 -> 
            "(6) locate operating point", 7 -> Row[{"(7) determine ", 
               Subscript[
                Style["R", Italic], 1]}], 8 -> Row[{"(8) determine ", 
               Subscript[
                Style["E", Italic], 2]}], 9 -> Row[{"(9) determine ", 
               Subscript[
                Style["R", Italic], 2]}], 10 -> Row[{"(10) determine ", 
               Subscript[
                Style["E", Italic], 3]}], 11 -> "(11) solution"}, 
           Dynamic[$CellContext`MCR$$]], 
          Manipulate`Place[2], 
          PaneSelector[{1 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 2 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 3 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 4 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 5 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 6 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 7 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 8 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 9 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 10 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}]}, 
           Dynamic[$CellContext`MCR$$]], 
          
          PaneSelector[{
           1 -> Manipulate`Place[3], 2 -> Manipulate`Place[3], 3 -> 
            Manipulate`Place[3], 4 -> Manipulate`Place[3], 5 -> 
            Manipulate`Place[3], 6 -> Manipulate`Place[3], 7 -> 
            Manipulate`Place[3], 8 -> Manipulate`Place[3], 9 -> 
            Manipulate`Place[3], 10 -> Manipulate`Place[3]}, 
           Dynamic[$CellContext`MCR$$]], 
          
          PaneSelector[{
           1 -> Manipulate`Place[4], 2 -> Manipulate`Place[4], 3 -> 
            Manipulate`Place[4], 4 -> Manipulate`Place[4], 5 -> 
            Manipulate`Place[4], 6 -> Manipulate`Place[4], 7 -> 
            Manipulate`Place[4], 8 -> Manipulate`Place[4], 9 -> 
            Manipulate`Place[4], 10 -> Manipulate`Place[4]}, 
           Dynamic[$CellContext`MCR$$]], 
          
          PaneSelector[{
           1 -> Manipulate`Place[5], 2 -> Manipulate`Place[6], 3 -> 
            Manipulate`Place[7], 4 -> Manipulate`Place[8], 5 -> 
            Manipulate`Place[9], 6 -> Manipulate`Place[10], 7 -> 
            Manipulate`Place[11], 8 -> Manipulate`Place[12], 9 -> 
            Manipulate`Place[13], 10 -> Manipulate`Place[14]}, 
           Dynamic[$CellContext`MCR$$]]}}]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    600., {193., 197.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`reset$81342$$ = 
    0, $CellContext`MCR$81343$$ = 0, $CellContext`solution$81344$$ = 
    False, $CellContext`hint$81345$$ = False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`extract1$$ = {0.4, 
         0.3}, $CellContext`extract2$$ = {0.4, 
         0.15}, $CellContext`extract3$$ = {0.4, 0.15}, $CellContext`feed$$ = {
         0.5, 0.7}, $CellContext`hint$$ = False, $CellContext`MCR$$ = 
        1, $CellContext`mixing$$ = {0.5, 0.7}, $CellContext`operatingpt$$ = {
         0.5, 0.7}, $CellContext`raffinate1$$ = {0.6, 
         0.3}, $CellContext`raffinate2$$ = {0.6, 
         0.3}, $CellContext`raffinateN$$ = {0.5, 0.7}, $CellContext`reset$$ = 
        1, $CellContext`solution$$ = 
        False, $CellContext`solvent$$ = {0.5, 0.7}}, "ControllerVariables" :> {
        Hold[$CellContext`reset$$, $CellContext`reset$81342$$, 0], 
        Hold[$CellContext`MCR$$, $CellContext`MCR$81343$$, 0], 
        Hold[$CellContext`solution$$, $CellContext`solution$81344$$, False], 
        Hold[$CellContext`hint$$, $CellContext`hint$81345$$, False]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`x1$, $CellContext`y1$, $CellContext`x2$, \
$CellContext`y2$, $CellContext`x3$, $CellContext`y3$, $CellContext`sol$, \
$CellContext`a$, $CellContext`b$, $CellContext`c$, $CellContext`phase$, \
$CellContext`yt$, $CellContext`xt$, $CellContext`tie$, \
$CellContext`phaseplot$, $CellContext`tielines$, $CellContext`F$, \
$CellContext`S$, $CellContext`M$, $CellContext`xF$, $CellContext`yF$, \
$CellContext`xRN$, $CellContext`yRN$, $CellContext`Msol$, $CellContext`xM$, \
$CellContext`yM$, $CellContext`xE$, $CellContext`yE$, $CellContext`xP$, \
$CellContext`yP$, $CellContext`operating$, $CellContext`lower$, \
$CellContext`upper$, $CellContext`lever$, $CellContext`newtie$, \
$CellContext`xtie$, $CellContext`xR$, $CellContext`yR$, $CellContext`n$, \
$CellContext`plotlabel$}, 
        SeedRandom[$CellContext`reset$$]; $CellContext`x1$ = 
         RandomReal[{0.02, 0.07}]; $CellContext`y1$ = 0; $CellContext`x2$ = 
         RandomReal[{0.45, 0.55}]; $CellContext`y2$ = 
         RandomReal[{0.3, 0.4}]; $CellContext`x3$ = 
         RandomReal[{0.85, 0.98}]; $CellContext`y3$ = 0; $CellContext`sol$ = 
         Quiet[
           Part[
            
            Solve[{$CellContext`\[Alpha] $CellContext`x1$^2 + $CellContext`\
\[Beta] $CellContext`x1$ + $CellContext`\[Chi] == $CellContext`y1$, \
$CellContext`\[Alpha] $CellContext`x2$^2 + $CellContext`\[Beta] \
$CellContext`x2$ + $CellContext`\[Chi] == $CellContext`y2$, $CellContext`\
\[Alpha] $CellContext`x3$^2 + $CellContext`\[Beta] $CellContext`x3$ + \
$CellContext`\[Chi] == $CellContext`y3$}, {$CellContext`\[Alpha], \
$CellContext`\[Beta], $CellContext`\[Chi]}], 1]]; $CellContext`a$ = 
         ReplaceAll[$CellContext`\[Alpha], $CellContext`sol$]; \
$CellContext`b$ = 
         ReplaceAll[$CellContext`\[Beta], $CellContext`sol$]; $CellContext`c$ = 
         ReplaceAll[$CellContext`\[Chi], $CellContext`sol$]; \
$CellContext`phase$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`a$ $CellContext`x$^2 + $CellContext`b$ \
$CellContext`x$ + $CellContext`c$; $CellContext`yt$[1] = 
         RandomReal[{0.02, 0.05} $CellContext`y2$]; $CellContext`xt$[1] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              1], $CellContext`x], 1]]; $CellContext`yt$[2] = 
         RandomReal[{0.06, 0.1} $CellContext`y2$]; $CellContext`xt$[2] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              2], $CellContext`x], 2]]; $CellContext`tie$[1][
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yt$[2] - $CellContext`yt$[
             1])/($CellContext`xt$[2] - $CellContext`xt$[
            1])) ($CellContext`x$ - $CellContext`xt$[1]) + $CellContext`yt$[
           1]; $CellContext`yt$[3] = 
         RandomReal[{0.15, 0.2} $CellContext`y2$]; $CellContext`xt$[3] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              3], $CellContext`x], 1]]; $CellContext`yt$[4] = 
         RandomReal[{0.25, 0.3} $CellContext`y2$]; $CellContext`xt$[4] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              4], $CellContext`x], 2]]; $CellContext`tie$[2][
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yt$[4] - $CellContext`yt$[
             3])/($CellContext`xt$[4] - $CellContext`xt$[
            3])) ($CellContext`x$ - $CellContext`xt$[3]) + $CellContext`yt$[
           3]; $CellContext`yt$[5] = 
         RandomReal[{0.35, 0.4} $CellContext`y2$]; $CellContext`xt$[5] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              5], $CellContext`x], 1]]; $CellContext`yt$[6] = 
         RandomReal[{0.5, 0.55} $CellContext`y2$]; $CellContext`xt$[6] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              6], $CellContext`x], 2]]; $CellContext`tie$[3][
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yt$[6] - $CellContext`yt$[
             5])/($CellContext`xt$[6] - $CellContext`xt$[
            5])) ($CellContext`x$ - $CellContext`xt$[5]) + $CellContext`yt$[
           5]; $CellContext`yt$[7] = 
         RandomReal[{0.72, 0.77} $CellContext`y2$]; $CellContext`xt$[7] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              7], $CellContext`x], 1]]; $CellContext`yt$[8] = 
         RandomReal[{0.8, 0.9} $CellContext`y2$]; $CellContext`xt$[8] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              8], $CellContext`x], 2]]; $CellContext`tie$[4][
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yt$[8] - $CellContext`yt$[
             7])/($CellContext`xt$[8] - $CellContext`xt$[
            7])) ($CellContext`x$ - $CellContext`xt$[7]) + $CellContext`yt$[
           7]; $CellContext`phaseplot$ = Plot[
           $CellContext`phase$[$CellContext`x], {$CellContext`x, \
$CellContext`x1$, $CellContext`x3$}, PlotStyle -> {Thick, Black}, 
           PlotRange -> {{0, 1}, {0, Sqrt[3]/2}}]; $CellContext`tielines$ = 
         Graphics[{
            Thickness[0.004], 
            Line[{{
               $CellContext`xt$[1], 
               $CellContext`yt$[1]}, {
               $CellContext`xt$[2], 
               $CellContext`yt$[2]}}], 
            Line[{{
               $CellContext`xt$[3], 
               $CellContext`yt$[3]}, {
               $CellContext`xt$[4], 
               $CellContext`yt$[4]}}], 
            Line[{{
               $CellContext`xt$[5], 
               $CellContext`yt$[5]}, {
               $CellContext`xt$[6], 
               $CellContext`yt$[6]}}], 
            Line[{{
               $CellContext`xt$[7], 
               $CellContext`yt$[7]}, {
               $CellContext`xt$[8], 
               $CellContext`yt$[8]}}]}]; $CellContext`F$ = 
         RandomInteger[{1000, 1500}]; $CellContext`S$ = 
         RandomInteger[{1500, 
           2000}]; $CellContext`M$ = $CellContext`F$ + $CellContext`S$; \
$CellContext`xF$ = RandomReal[{0.6, 0.7}]; $CellContext`yF$ = 
         RandomReal[{0.4, 0.45}]; $CellContext`xRN$ = 
         0.99 $CellContext`x3$; $CellContext`yRN$ = \
$CellContext`phase$[$CellContext`xRN$]; $CellContext`Msol$ = Quiet[
           First[
            Solve[
             
             And[$CellContext`wtA[$CellContext`yF$] $CellContext`F$ == \
$CellContext`xA $CellContext`M$, $CellContext`wtS[$CellContext`xF$, \
$CellContext`yF$] $CellContext`F$ + $CellContext`S$ == $CellContext`xS \
$CellContext`M$, $CellContext`xA + $CellContext`xS + $CellContext`xC == 
              1], {$CellContext`xA, $CellContext`xS, $CellContext`xC}]]]; \
$CellContext`xM$ = 
         1 - ReplaceAll[$CellContext`xS, $CellContext`Msol$] - \
$CellContext`yM$/Sqrt[3]; $CellContext`yM$ = 
         ReplaceAll[(Sqrt[3]/
            2) $CellContext`xA, $CellContext`Msol$]; $CellContext`xE$[1] = 
         ReplaceAll[$CellContext`x, 
           Quiet[
            First[
             
             Solve[$CellContext`phase$[$CellContext`x] == (($CellContext`yRN$ - \
$CellContext`yM$)/($CellContext`xRN$ - $CellContext`xM$)) ($CellContext`x - \
$CellContext`xRN$) + $CellContext`yRN$, $CellContext`x]]]]; $CellContext`yE$[
          1] = $CellContext`phase$[
           $CellContext`xE$[1]]; $CellContext`xP$ = ReplaceAll[$CellContext`x, 
           Quiet[
            First[
             
             Solve[(($CellContext`yF$ - $CellContext`yE$[
                  1])/($CellContext`xF$ - $CellContext`xE$[
                 1])) ($CellContext`x - $CellContext`xF$) + $CellContext`yF$ == \
($CellContext`yRN$/$CellContext`xRN$) $CellContext`x, $CellContext`x]]]]; \
$CellContext`yP$ = ($CellContext`yRN$/$CellContext`xRN$) $CellContext`xP$; \
$CellContext`operating$[
           Pattern[$CellContext`i$, 
            Blank[]], 
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yR$[$CellContext`i$] - \
$CellContext`yP$)/($CellContext`xR$[$CellContext`i$] - $CellContext`xP$)) \
($CellContext`x$ - $CellContext`xP$) + $CellContext`yP$; $CellContext`lower$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Which[Part[$CellContext`pt$, 2] <= $CellContext`tie$[1][
             Part[$CellContext`pt$, 1]], 0, 
           Inequality[
            $CellContext`tie$[1][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[2][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[1][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[2][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[3][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[2][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[3][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[3][$CellContext`x$], $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]] < Part[$CellContext`pt$, 2], 
           $CellContext`tie$[4][$CellContext`x$]]; $CellContext`upper$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Which[Part[$CellContext`pt$, 2] < $CellContext`tie$[1][
             Part[$CellContext`pt$, 1]], 
           $CellContext`tie$[1][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[1][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[2][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[2][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[2][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[3][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[3][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[3][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[4][$CellContext`x$], $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]] < Part[$CellContext`pt$, 2], 
           $CellContext`tie$[4][$CellContext`x$]]; $CellContext`lever$[
           Pattern[$CellContext`pt$, 
            Blank[]]] := If[Part[$CellContext`pt$, 2] >= $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]], 
           1, (Part[$CellContext`pt$, 
              2] - $CellContext`upper$[$CellContext`pt$, 
             
             Part[$CellContext`pt$, 
              1]])/($CellContext`lower$[$CellContext`pt$, 
             
             Part[$CellContext`pt$, 
              1]] - $CellContext`upper$[$CellContext`pt$, 
            Part[$CellContext`pt$, 1]])]; $CellContext`newtie$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`lever$[$CellContext`pt$] \
$CellContext`lower$[$CellContext`pt$, $CellContext`x$] + (
            1 - $CellContext`lever$[$CellContext`pt$]) \
$CellContext`upper$[$CellContext`pt$, $CellContext`x$]; $CellContext`xtie$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`i$, 
            Blank[]]] := ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`newtie$[$CellContext`pt$, $CellContext`x] == \
$CellContext`phase$[$CellContext`x], $CellContext`x], $CellContext`i$]]; \
$CellContext`xR$[1] = ReplaceAll[$CellContext`x, 
           Part[
            Solve[$CellContext`newtie$[{
                $CellContext`xE$[1], 
                $CellContext`yE$[
                1]}, $CellContext`x] == $CellContext`phase$[$CellContext`x], \
$CellContext`x], 2]]; $CellContext`yR$[1] = $CellContext`phase$[
           $CellContext`xR$[1]]; $CellContext`xE$[2] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`operating$[
              1, $CellContext`x] == $CellContext`phase$[$CellContext`x], \
$CellContext`x], 1]]; $CellContext`yE$[2] = $CellContext`phase$[
           $CellContext`xE$[2]]; 
        Map[If[$CellContext`xR$[# - 
             1] < $CellContext`xRN$, {$CellContext`xR$[#] = 
             ReplaceAll[$CellContext`x, 
               Part[
                Solve[$CellContext`newtie$[{
                    $CellContext`xE$[#], 
                    $CellContext`yE$[#]}, $CellContext`x] == \
$CellContext`phase$[$CellContext`x], $CellContext`x], 
                2]]; $CellContext`yR$[#] = $CellContext`phase$[
               $CellContext`xR$[#]]; $CellContext`xE$[# + 1] = 
             ReplaceAll[$CellContext`x, 
               Part[
                
                Solve[$CellContext`operating$[#, $CellContext`x] == \
$CellContext`phase$[$CellContext`x], $CellContext`x], 1]]; $CellContext`yE$[# + 
               1] = $CellContext`phase$[
               $CellContext`xE$[# + 1]]; Null}]& , 
          Range[2, 10]]; $CellContext`n$ = Part[
           DeleteCases[
            Map[If[$CellContext`xR$[#] < $CellContext`xRN$, 0, #]& , 
             Range[10]], 0], 1]; 
        If[$CellContext`n$ == 
          8, $CellContext`reset$$ = $CellContext`reset$$ + 
           1]; $CellContext`plotlabel$ = Switch[$CellContext`MCR$$, 1, 
           If[$CellContext`hint$$, "hint: read the compositions on the axes", 
            Row[{"Step 1: move the feed point ", 
              Style["F", Italic], 
              " to \nthe correct location, then check solution"}]], 2, 
           If[$CellContext`hint$$, "hint: read the compositions on the axes", 
            Row[{"Step 2: move the solvent point ", 
              Style["S", Italic], 
              " to \nthe correct location, then check solution"}]], 3, 
           If[$CellContext`hint$$, "hint: read the compositions on the axes", 
            Row[{"Step 3: move the desired raffinate point ", 
              Subscript[
               Style["R", Italic], "N"], 
              " to \nthe correct location, then check solution"}]], 4, 
           If[$CellContext`hint$$, "hint: use the lever rule", 
            Row[{"Step 4: use mass balance for two entering streams (", 
              Style["F", Italic], ", ", 
              Style["S", Italic], ")\n to determine the average composition ", 
              Style["M", Italic], ", then check solution"}]], 5, 
           If[$CellContext`hint$$, 
            Row[{"hint: use mass balance for two exit streams (", 
              Subscript[
               Style["R", Italic], "N"], ", ", 
              Subscript[
               Style["E", Italic], 1], ")"}], 
            Row[{"Step 5: move the point for the first extract composition ", 
              Subscript[
               Style["E", Italic], 1], 
              "\n to the correct location, then check solution"}]], 6, 
           If[$CellContext`hint$$, 
            
            Row[{"hint: the operating point is at the intersection of \na \
line through ", 
              Style["F", Italic], " and ", 
              Subscript[
               Style["E", Italic], 1], " and a line through ", 
              Style["S", Italic], " and ", 
              Subscript[
               Style["R", Italic], "N"]}], 
            Row[{"Step 6: move the operating point ", 
              Style["P", Italic], 
              " \nto the correct location, then check solution"}]], 7, 
           
           If[$CellContext`hint$$, 
            "hint: follow the tie line to the other side of the phase \
boundary", 
            "Step 7: move the blue point to the correct raffinate \
composition"], 8, 
           
           If[$CellContext`hint$$, "hint: draw a line to the operating point",
             "Step 8: move the yellow point to the correct extract \
composition"], 9, 
           
           If[$CellContext`hint$$, 
            "hint: follow the tie line to the other side of the phase \
boundary", 
            "Step 9: move the blue point to the correct raffinate \
composition"], 10, 
           
           If[$CellContext`hint$$, "hint: draw a line to the operating point",
             "Step 10: move the yellow point to the correct extract \
composition"], 11, 
           Row[{$CellContext`n$, " stages needed"}]]; Show[
          
          If[$CellContext`MCR$$ <= 
           4, $CellContext`gridLines, {}], $CellContext`base, \
$CellContext`phaseplot$, $CellContext`tielines$, ImageSize -> {600, 390}, 
          PlotRange -> {{-0.25, 1.15}, {-0.1, 0.93}}, 
          ImagePadding -> {{55, 55}, {5, 
             If[$CellContext`hint$$, 
              If[$CellContext`MCR$$ == 6, 15, 35], 
              If[3 <= $CellContext`MCR$$ <= 5, 15, 35]]}}, PlotLabel -> 
          Style[$CellContext`plotlabel$, 17, Black], Epilog -> {Thick, 
            If[$CellContext`MCR$$ == 1, {
              $CellContext`pt1[$CellContext`feed$$, $CellContext`colF], 
              $CellContext`label1[
              "F", $CellContext`colF, $CellContext`feed$$], 
              $CellContext`table1["feed", $CellContext`xF$, $CellContext`yF$], 
              If[$CellContext`solution$$, 
               $CellContext`pt2[{$CellContext`xF$, $CellContext`yF$}, \
$CellContext`colF]]}], 
            If[$CellContext`MCR$$ > 1, {
              $CellContext`pt2[{$CellContext`xF$, $CellContext`yF$}, \
$CellContext`colF], 
              $CellContext`label1[
              "F", $CellContext`colF, {$CellContext`xF$, $CellContext`yF$}]}], 
            If[$CellContext`MCR$$ == 2, {
              $CellContext`pt1[$CellContext`solvent$$, $CellContext`colS], 
              $CellContext`label1[
              "S", $CellContext`colS, $CellContext`solvent$$], 
              $CellContext`table1["solvent", 0, 0], 
              If[$CellContext`solution$$, 
               $CellContext`pt2[{0, 0}, $CellContext`colS]]}], 
            If[$CellContext`MCR$$ > 2, {
              $CellContext`pt2[{0, 0}, $CellContext`colS], 
              $CellContext`label1["S", $CellContext`colS, {0, 0}]}], 
            If[$CellContext`MCR$$ == 3, {
              $CellContext`pt1[$CellContext`raffinateN$$, $CellContext`colR], 
              $CellContext`label2[{
               "R", "N"}, $CellContext`colR, $CellContext`raffinateN$$], 
              $CellContext`table1[
              "raffinate", $CellContext`xRN$, $CellContext`yRN$], 
              If[$CellContext`solution$$, 
               $CellContext`pt2[{$CellContext`xRN$, $CellContext`yRN$}, \
$CellContext`colR]]}], 
            If[$CellContext`MCR$$ > 3, {
              $CellContext`pt2[{$CellContext`xRN$, $CellContext`yRN$}, \
$CellContext`colR], 
              $CellContext`label2[{
               "R", "N"}, $CellContext`colR, {$CellContext`xRN$, \
$CellContext`yRN$}]}], 
            If[$CellContext`MCR$$ == 4, {{Dashed, $CellContext`colM, 
               Line[{{$CellContext`xF$, $CellContext`yF$}, {0, 0}}]}, 
              $CellContext`pt1[$CellContext`mixing$$, $CellContext`colM], 
              $CellContext`label1[
              "M", $CellContext`colM, $CellContext`mixing$$], 
              $CellContext`table2["mixing", 
               Part[$CellContext`mixing$$, 1], 
               Part[$CellContext`mixing$$, 2]], 
              Text[
               Style[
                Column[{"flow rates", 
                  Framed[
                   Column[{
                    Style[
                    Row[{
                    Style["F", Italic], " = ", 
                    NumberForm[$CellContext`F$, {4, 0}], 
                    " kg/h"}], $CellContext`colF], 
                    Style[
                    Row[{
                    Style["S", Italic], " = ", 
                    NumberForm[$CellContext`S$, {4, 0}], 
                    " kg/h"}], $CellContext`colS]}, Alignment -> "="]]}, 
                 Center], 17], {-0.05, 0.75}], 
              If[$CellContext`solution$$, 
               $CellContext`pt2[{$CellContext`xM$, $CellContext`yM$}, \
$CellContext`colM]]}], 
            If[$CellContext`MCR$$ == 5, {
              $CellContext`pt2[{$CellContext`xM$, $CellContext`yM$}, \
$CellContext`colM], 
              $CellContext`label1[
              "M", $CellContext`colM, {$CellContext`xM$, $CellContext`yM$}], \
{$CellContext`colE1, 
               
               Arrow[{{$CellContext`xRN$, $CellContext`yRN$}, \
$CellContext`extract1$$}]}, 
              $CellContext`pt1[$CellContext`extract1$$, $CellContext`colE1], 
              $CellContext`label2[{
               "E", 1}, $CellContext`colE1, $CellContext`extract1$$], 
              If[$CellContext`solution$$, 
               $CellContext`pt2[{
                 $CellContext`xE$[1], 
                 $CellContext`yE$[1]}, $CellContext`colE1]]}], 
            If[$CellContext`MCR$$ > 5, {
              $CellContext`pt2[{
                $CellContext`xE$[1], 
                $CellContext`yE$[1]}, $CellContext`colE1], 
              $CellContext`label2[{"E", 1}, $CellContext`colE1, {
                $CellContext`xE$[1], 
                $CellContext`yE$[1]}]}], 
            If[$CellContext`MCR$$ == 6, {{
               Thickness[0.007], Dotted, $CellContext`colOP, 
               
               Line[{$CellContext`operatingpt$$, {$CellContext`xF$, \
$CellContext`yF$}}], 
               
               Line[{$CellContext`operatingpt$$, {$CellContext`xRN$, \
$CellContext`yRN$}}]}, 
              $CellContext`pt1[$CellContext`operatingpt$$, \
$CellContext`colOP], 
              $CellContext`label1[
              "P", $CellContext`colOP, $CellContext`operatingpt$$], 
              If[$CellContext`solution$$, {Dashed, $CellContext`colOP, 
                
                Line[{{$CellContext`xP$, $CellContext`yP$}, \
{$CellContext`xF$, $CellContext`yF$}}], 
                
                Line[{{$CellContext`xP$, $CellContext`yP$}, \
{$CellContext`xRN$, $CellContext`yRN$}}], 
                $CellContext`pt2[{$CellContext`xP$, $CellContext`yP$}, \
$CellContext`colOP]}]}], 
            If[6 < $CellContext`MCR$$ < 11, {
              $CellContext`pt2[{$CellContext`xP$, $CellContext`yP$}, \
$CellContext`colOP], 
              $CellContext`label1[
              "P", $CellContext`colOP, {$CellContext`xP$, \
$CellContext`yP$}]}], 
            If[$CellContext`MCR$$ == 7, {{$CellContext`colR, Dashed, 
               Line[{{
                  $CellContext`xE$[1], 
                  $CellContext`yE$[1]}, $CellContext`raffinate1$$}]}, 
              $CellContext`pt1[$CellContext`raffinate1$$, $CellContext`colR], 
              $CellContext`label2[{"R", 1}, $CellContext`colR, 
               If[$CellContext`solution$$, {
                 $CellContext`xR$[1], 
                 $CellContext`yR$[1]}, $CellContext`raffinate1$$]], 
              If[$CellContext`solution$$, {$CellContext`colR, Dashed, 
                Line[{{
                   $CellContext`xE$[1], 
                   $CellContext`yE$[1]}, {
                   $CellContext`xR$[1], 
                   $CellContext`yR$[1]}}], 
                $CellContext`pt2[{
                  $CellContext`xR$[1], 
                  $CellContext`yR$[1]}, $CellContext`colR]}]}], 
            If[7 < $CellContext`MCR$$ < 11, {{$CellContext`colR, Dashed, 
               Line[{{
                  $CellContext`xE$[1], 
                  $CellContext`yE$[1]}, {
                  $CellContext`xR$[1], 
                  $CellContext`yR$[1]}}]}, 
              $CellContext`pt2[{
                $CellContext`xR$[1], 
                $CellContext`yR$[1]}, $CellContext`colR], 
              $CellContext`label2[{"R", 1}, $CellContext`colR, {
                $CellContext`xR$[1], 
                $CellContext`yR$[1]}]}], 
            If[$CellContext`MCR$$ == 8, {{$CellContext`colE1, Dashed, 
               Line[{{
                  $CellContext`xR$[1], 
                  $CellContext`yR$[
                  1]}, {$CellContext`xP$, $CellContext`yP$}}]}, 
              $CellContext`pt1[$CellContext`extract2$$, $CellContext`colE1], 
              $CellContext`label2[{"E", 2}, $CellContext`colE1, 
               If[$CellContext`solution$$, {
                 $CellContext`xE$[2], 
                 $CellContext`yE$[2]}, $CellContext`extract2$$]], 
              If[$CellContext`solution$$, {{$CellContext`colE1, Dashed, 
                 Line[{{
                    $CellContext`xR$[1], 
                    $CellContext`yR$[1]}, {
                    $CellContext`xE$[2], 
                    $CellContext`yE$[2]}}]}, 
                $CellContext`pt2[{
                  $CellContext`xE$[2], 
                  $CellContext`yE$[2]}, $CellContext`colE1]}]}], 
            If[8 < $CellContext`MCR$$ < 11, {{$CellContext`colE1, Dashed, 
               Line[{{
                  $CellContext`xR$[1], 
                  $CellContext`yR$[1]}, {
                  $CellContext`xE$[2], 
                  $CellContext`yE$[2]}}]}, 
              $CellContext`pt2[{
                $CellContext`xE$[2], 
                $CellContext`yE$[2]}, $CellContext`colE1], 
              $CellContext`label2[{"E", 2}, $CellContext`colE1, {
                $CellContext`xE$[2], 
                $CellContext`yE$[2]}]}], 
            If[$CellContext`MCR$$ == 9, {{$CellContext`colR, Dashed, 
               Line[{{
                  $CellContext`xE$[2], 
                  $CellContext`yE$[2]}, $CellContext`raffinate2$$}]}, 
              $CellContext`pt1[$CellContext`raffinate2$$, $CellContext`colR], 
              $CellContext`label2[{"R", 2}, $CellContext`colR, 
               If[$CellContext`solution$$, {
                 $CellContext`xR$[2], 
                 $CellContext`yR$[2]}, $CellContext`raffinate2$$]], 
              If[$CellContext`solution$$, {$CellContext`colR, Dashed, 
                Line[{{
                   $CellContext`xE$[2], 
                   $CellContext`yE$[2]}, {
                   $CellContext`xR$[2], 
                   $CellContext`yR$[2]}}], 
                $CellContext`pt2[{
                  $CellContext`xR$[2], 
                  $CellContext`yR$[2]}, $CellContext`colR]}]}], 
            If[9 < $CellContext`MCR$$ < 11, {{$CellContext`colR, Dashed, 
               Line[{{
                  $CellContext`xE$[2], 
                  $CellContext`yE$[2]}, {
                  $CellContext`xR$[2], 
                  $CellContext`yR$[2]}}]}, 
              $CellContext`pt2[{
                $CellContext`xR$[2], 
                $CellContext`yR$[2]}, $CellContext`colR], 
              $CellContext`label2[{"R", 2}, $CellContext`colR, {
                $CellContext`xR$[2], 
                $CellContext`yR$[2]}]}], 
            If[$CellContext`MCR$$ == 10, {{$CellContext`colE1, Dashed, 
               Line[{{
                  $CellContext`xR$[2], 
                  $CellContext`yR$[
                  2]}, {$CellContext`xP$, $CellContext`yP$}}]}, 
              $CellContext`pt1[$CellContext`extract3$$, $CellContext`colE1], 
              $CellContext`label2[{"E", 3}, $CellContext`colE1, 
               If[$CellContext`solution$$, {
                 $CellContext`xE$[3], 
                 $CellContext`yE$[3]}, $CellContext`extract3$$]], 
              If[$CellContext`solution$$, {{$CellContext`colE1, Dashed, 
                 Line[{{
                    $CellContext`xR$[2], 
                    $CellContext`yR$[2]}, {
                    $CellContext`xE$[3], 
                    $CellContext`yE$[3]}}]}, 
                $CellContext`pt2[{
                  $CellContext`xE$[3], 
                  $CellContext`yE$[3]}, $CellContext`colE1]}]}], 
            If[$CellContext`MCR$$ == 11, {
              Map[{Dashed, $CellContext`colE1, 
                Line[{{
                   $CellContext`xE$[#], 
                   $CellContext`yE$[#]}, {
                   $CellContext`xR$[#], 
                   $CellContext`yR$[#]}}], $CellContext`colR, 
                Line[{{
                   $CellContext`xR$[#], 
                   $CellContext`yR$[#]}, {
                   $CellContext`xE$[# + 1], 
                   $CellContext`yE$[# + 1]}}]}& , 
               Range[$CellContext`n$]], 
              Map[{
                $CellContext`pt2[{
                  $CellContext`xE$[#], 
                  $CellContext`yE$[#]}, $CellContext`colE1], 
                $CellContext`label2[{"E", #}, $CellContext`colE1, {
                  $CellContext`xE$[#], 
                  $CellContext`yE$[#]}]}& , 
               Range[2, $CellContext`n$]], 
              Map[{
                $CellContext`pt2[{
                  $CellContext`xR$[#], 
                  $CellContext`yR$[#]}, $CellContext`colR], 
                $CellContext`label2[{"R", #}, $CellContext`colR, {
                  $CellContext`xR$[#], 
                  $CellContext`yR$[#]}]}& , 
               Range[$CellContext`n$]], 
              Map[Text[
                Style[
                 Row[{" ", #, " "}], 18, Background -> 
                 White], {$CellContext`xE$[#] + $CellContext`xR$[#], \
$CellContext`yE$[#] + $CellContext`yR$[#]}/2, {0, -1.5}]& , 
               Range[$CellContext`n$]]}]}]], 
      "Specifications" :> {{{$CellContext`reset$$, 1}, 1, 1000, 1, 
         ControlType -> None, ControlPlacement -> 
         1}, {{$CellContext`MCR$$, 1, ""}, {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 
         11}, ControlType -> None, ControlPlacement -> 
         2}, {{$CellContext`solution$$, False, "solution"}, {True, False}, 
         Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         3}, {{$CellContext`hint$$, False, "hint"}, {True, False}, 
         ControlPlacement -> 4}, {{$CellContext`feed$$, {0.5, 0.7}}, 
         Automatic, ControlType -> Locator, Appearance -> None, Enabled -> 
         Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         5}, {{$CellContext`solvent$$, {0.5, 0.7}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         6}, {{$CellContext`raffinateN$$, {0.5, 0.7}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         7}, {{$CellContext`mixing$$, {0.5, 0.7}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         8}, {{$CellContext`extract1$$, {0.4, 0.3}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         9}, {{$CellContext`operatingpt$$, {0.5, 0.7}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         10}, {{$CellContext`raffinate1$$, {0.6, 0.3}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         11}, {{$CellContext`extract2$$, {0.4, 0.15}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         12}, {{$CellContext`raffinate2$$, {0.6, 0.3}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         13}, {{$CellContext`extract3$$, {0.4, 0.15}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 14}, 
        Grid[{{
           Button["new problem", {
             
             If[$CellContext`reset$$ < 
              1000, $CellContext`reset$$ = $CellContext`reset$$ + 
               1, $CellContext`reset$$ = $CellContext`reset$$ - 
               1], $CellContext`MCR$$ = 1, $CellContext`solution$$ = 
             False, $CellContext`hint$$ = 
             False, $CellContext`feed$$ = {0.5, 
              0.7}, $CellContext`solvent$$ = {0.5, 
              0.7}, $CellContext`raffinateN$$ = {0.5, 
              0.7}, $CellContext`mixing$$ = {0.5, 
              0.7}, $CellContext`extract1$$ = {0.4, 
              0.3}, $CellContext`operatingpt$$ = {0.5, 
              0.7}, $CellContext`raffinate1$$ = {0.6, 
              0.3}, $CellContext`rafinate2 = {0.6, 
              0.3}, $CellContext`raffinate3 = {0.6, 
              0.3}, $CellContext`rafinate4 = {0.6, 
              0.3}, $CellContext`rafinate5 = {0.6, 
              0.3}, $CellContext`extract2$$ = {0.4, 
              0.15}, $CellContext`extract3$$ = {0.4, 
              0.15}, $CellContext`extract4 = {0.4, 
              0.15}, $CellContext`extract5 = {0.4, 
              0.15}, $CellContext`extract6 = {0.4, 0.15}, $CellContext`Estage = 
             1, $CellContext`Rstage = 1}], 
           Manipulate`Place[1], 
           
           PaneSelector[{
            1 -> "(1) locate feed point", 2 -> "(2) locate solvent point", 3 -> 
             "(3) locate raffinate point", 4 -> "(4) locate mixing point", 5 -> 
             "(5) locate first extract point", 6 -> 
             "(6) locate operating point", 7 -> Row[{"(7) determine ", 
                Subscript[
                 Style["R", Italic], 1]}], 8 -> Row[{"(8) determine ", 
                Subscript[
                 Style["E", Italic], 2]}], 9 -> Row[{"(9) determine ", 
                Subscript[
                 Style["R", Italic], 2]}], 10 -> Row[{"(10) determine ", 
                Subscript[
                 Style["E", Italic], 3]}], 11 -> "(11) solution"}, 
            Dynamic[$CellContext`MCR$$]], 
           Manipulate`Place[2], 
           PaneSelector[{1 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 2 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 3 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 4 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 5 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 6 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 7 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 8 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 9 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 10 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}]}, 
            Dynamic[$CellContext`MCR$$]], 
           
           PaneSelector[{
            1 -> Manipulate`Place[3], 2 -> Manipulate`Place[3], 3 -> 
             Manipulate`Place[3], 4 -> Manipulate`Place[3], 5 -> 
             Manipulate`Place[3], 6 -> Manipulate`Place[3], 7 -> 
             Manipulate`Place[3], 8 -> Manipulate`Place[3], 9 -> 
             Manipulate`Place[3], 10 -> Manipulate`Place[3]}, 
            Dynamic[$CellContext`MCR$$]], 
           
           PaneSelector[{
            1 -> Manipulate`Place[4], 2 -> Manipulate`Place[4], 3 -> 
             Manipulate`Place[4], 4 -> Manipulate`Place[4], 5 -> 
             Manipulate`Place[4], 6 -> Manipulate`Place[4], 7 -> 
             Manipulate`Place[4], 8 -> Manipulate`Place[4], 9 -> 
             Manipulate`Place[4], 10 -> Manipulate`Place[4]}, 
            Dynamic[$CellContext`MCR$$]], 
           
           PaneSelector[{
            1 -> Manipulate`Place[5], 2 -> Manipulate`Place[6], 3 -> 
             Manipulate`Place[7], 4 -> Manipulate`Place[8], 5 -> 
             Manipulate`Place[9], 6 -> Manipulate`Place[10], 7 -> 
             Manipulate`Place[11], 8 -> Manipulate`Place[12], 9 -> 
             Manipulate`Place[13], 10 -> Manipulate`Place[14]}, 
            Dynamic[$CellContext`MCR$$]]}}]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{649., {242., 248.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({
      Attributes[PlotRange] = {ReadProtected}, $CellContext`wtA[
         Pattern[$CellContext`y, 
          Blank[]]] := $CellContext`y (2/Sqrt[3]), $CellContext`wtS[
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`y, 
          Blank[]]] := 1 - ($CellContext`x + $CellContext`y/Sqrt[3]), 
       Attributes[Subscript] = {NHoldRest}, $CellContext`gridLines = Graphics[{
          Thickness[Tiny], 
          GrayLevel[0.7], {{
            Line[{{0., 0.}, {1., 0.}}], 
            Line[{{0., 0}, {0., 0.}}], 
            Line[{{1., 0}, {1., 0.}}]}, {
            
            Line[{{0.025, 0.04330127018922193}, {0.975, 
             0.04330127018922193}}], 
            Line[{{0.05, 0}, {0.025, 0.04330127018922193}}], 
            Line[{{0.95, 0}, {0.975, 0.04330127018922193}}]}, {
            Line[{{0.05, 0.08660254037844387}, {0.95, 0.08660254037844387}}], 
            Line[{{0.1, 0}, {0.05, 0.08660254037844387}}], 
            Line[{{0.9, 0}, {0.95, 0.08660254037844387}}]}, {
            
            Line[{{0.07500000000000001, 0.1299038105676658}, {0.925, 
             0.1299038105676658}}], 
            
            Line[{{0.15000000000000002`, 0}, {0.07500000000000001, 
              0.1299038105676658}}], 
            Line[{{0.85, 0}, {0.925, 0.1299038105676658}}]}, {
            Line[{{0.1, 0.17320508075688773`}, {0.9, 0.17320508075688773`}}], 
            Line[{{0.2, 0}, {0.1, 0.17320508075688773`}}], 
            Line[{{0.8, 0}, {0.9, 0.17320508075688773`}}]}, {
            
            Line[{{0.125, 0.21650635094610965`}, {0.875, 
             0.21650635094610965`}}], 
            Line[{{0.25, 0}, {0.125, 0.21650635094610965`}}], 
            Line[{{0.75, 0}, {0.875, 0.21650635094610965`}}]}, {
            
            Line[{{0.15000000000000002`, 0.2598076211353316}, {0.85, 
             0.2598076211353316}}], 
            
            Line[{{0.30000000000000004`, 0}, {0.15000000000000002`, 
              0.2598076211353316}}], 
            Line[{{0.7, 0}, {0.85, 0.2598076211353316}}]}, {
            
            Line[{{0.17500000000000002`, 0.30310889132455354`}, {0.825, 
             0.30310889132455354`}}], 
            
            Line[{{0.35000000000000003`, 0}, {0.17500000000000002`, 
              0.30310889132455354`}}], 
            Line[{{0.6499999999999999, 0}, {0.825, 0.30310889132455354`}}]}, {
            Line[{{0.2, 0.34641016151377546`}, {0.8, 0.34641016151377546`}}], 
            Line[{{0.4, 0}, {0.2, 0.34641016151377546`}}], 
            Line[{{0.6, 0}, {0.8, 0.34641016151377546`}}]}, {
            Line[{{0.225, 0.3897114317029974}, {0.775, 0.3897114317029974}}], 
            Line[{{0.45, 0}, {0.225, 0.3897114317029974}}], 
            Line[{{0.55, 0}, {0.775, 0.3897114317029974}}]}, {
            Line[{{0.25, 0.4330127018922193}, {0.75, 0.4330127018922193}}], 
            Line[{{0.5, 0}, {0.25, 0.4330127018922193}}], 
            Line[{{0.5, 0}, {0.75, 0.4330127018922193}}]}, {
            Line[{{0.275, 0.4763139720814413}, {0.725, 0.4763139720814413}}], 
            Line[{{0.55, 0}, {0.275, 0.4763139720814413}}], 
            Line[{{0.44999999999999996`, 0}, {0.725, 0.4763139720814413}}]}, {
            
            Line[{{0.30000000000000004`, 0.5196152422706632}, {0.7, 
             0.5196152422706632}}], 
            
            Line[{{0.6000000000000001, 0}, {0.30000000000000004`, 
              0.5196152422706632}}], 
            Line[{{0.3999999999999999, 0}, {0.7, 0.5196152422706632}}]}, {
            Line[{{0.325, 0.562916512459885}, {0.675, 0.562916512459885}}], 
            Line[{{0.65, 0}, {0.325, 0.562916512459885}}], 
            Line[{{0.35, 0}, {0.675, 0.562916512459885}}]}, {
            
            Line[{{0.35000000000000003`, 0.6062177826491071}, {
             0.6499999999999999, 0.6062177826491071}}], 
            
            Line[{{0.7000000000000001, 0}, {0.35000000000000003`, 
              0.6062177826491071}}], 
            
            Line[{{0.29999999999999993`, 0}, {0.6499999999999999, 
              0.6062177826491071}}]}, {
            Line[{{0.375, 0.649519052838329}, {0.625, 0.649519052838329}}], 
            Line[{{0.75, 0}, {0.375, 0.649519052838329}}], 
            Line[{{0.25, 0}, {0.625, 0.649519052838329}}]}, {
            Line[{{0.4, 0.6928203230275509}, {0.6, 0.6928203230275509}}], 
            Line[{{0.8, 0}, {0.4, 0.6928203230275509}}], 
            Line[{{0.19999999999999996`, 0}, {0.6, 0.6928203230275509}}]}, {
            Line[{{0.42500000000000004`, 0.7361215932167728}, {0.575, 
             0.7361215932167728}}], 
            
            Line[{{0.8500000000000001, 0}, {0.42500000000000004`, 
              0.7361215932167728}}], 
            Line[{{0.1499999999999999, 0}, {0.575, 0.7361215932167728}}]}, {
            Line[{{0.45, 0.7794228634059948}, {0.55, 0.7794228634059948}}], 
            Line[{{0.9, 0}, {0.45, 0.7794228634059948}}], 
            Line[{{0.09999999999999998, 0}, {0.55, 0.7794228634059948}}]}, {
            
            Line[{{0.47500000000000003`, 0.8227241335952167}, {
             0.5249999999999999, 0.8227241335952167}}], 
            
            Line[{{0.9500000000000001, 0}, {0.47500000000000003`, 
              0.8227241335952167}}], 
            
            Line[{{0.04999999999999993, 0}, {0.5249999999999999, 
              0.8227241335952167}}]}, {
            Line[{{0.5, 0.8660254037844386}, {0.5, 0.8660254037844386}}], 
            Line[{{1., 0}, {0.5, 0.8660254037844386}}], 
            Line[{{0., 0}, {0.5, 0.8660254037844386}}]}}}], $CellContext`base = 
       Graphics[{{
           EdgeForm[
            Thickness[Large]], 
           FaceForm[None], 
           Polygon[{{0, 0}, {0.5, Sqrt[3]/2}, {1, 0}}]}, {{{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.1, 17], {0.05, 0.08660254037844387}, {2.25, 0}], 
             
             Line[{{0.020000000000000004`, 0.08660254037844387}, {0.05, 
              0.08660254037844387}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.9, 17], {0.1, 0}, {-2.25, 0}, {1/2, -1}], 
             Line[{{0.1, 0}, {0.115, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.9, 17], {0.95, 0.08660254037844387}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.95, 0.08660254037844387}, {0.965, 
              0.11258330249197702`}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.2, 17], {0.1, 0.17320508075688773`}, {2.25, 0}], 
             Line[{{0.07, 0.17320508075688773`}, {0.1, 
              0.17320508075688773`}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.8, 17], {0.2, 0}, {-2.25, 0}, {1/2, -1}], 
             
             Line[{{0.2, 0}, {
               0.21500000000000002`, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.8, 17], {0.9, 0.17320508075688773`}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.9, 0.17320508075688773`}, {0.915, 
              0.19918584287042088`}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.30000000000000004`, 17], {0.15000000000000002`, 
              0.2598076211353316}, {2.25, 0}], 
             
             Line[{{0.12000000000000002`, 0.2598076211353316}, {
              0.15000000000000002`, 0.2598076211353316}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.7, 17], {0.30000000000000004`, 0}, {-2.25, 0}, {
              1/2, -1}], 
             
             Line[{{0.30000000000000004`, 0}, {
               0.31500000000000006`, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.7, 17], {0.85, 0.2598076211353316}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.85, 0.2598076211353316}, {0.865, 
              0.2857883832488648}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.4, 17], {0.2, 0.34641016151377546`}, {2.25, 0}], 
             
             Line[{{0.17, 0.34641016151377546`}, {0.2, 
              0.34641016151377546`}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.6, 17], {0.4, 0}, {-2.25, 0}, {1/2, -1}], 
             
             Line[{{0.4, 0}, {
               0.41500000000000004`, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.6, 17], {0.8, 0.34641016151377546`}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.8, 0.34641016151377546`}, {0.815, 
              0.37239092362730863`}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.5, 17], {0.25, 0.4330127018922193}, {2.25, 0}], 
             Line[{{0.22, 0.4330127018922193}, {0.25, 0.4330127018922193}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.5, 17], {0.5, 0}, {-2.25, 0}, {1/2, -1}], 
             Line[{{0.5, 0}, {0.515, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.5, 17], {0.75, 0.4330127018922193}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.75, 0.4330127018922193}, {0.765, 
              0.45899346400575247`}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.6, 17], {0.3, 0.5196152422706631}, {2.25, 0}], 
             Line[{{0.27, 0.5196152422706631}, {0.3, 0.5196152422706631}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.4, 17], {0.6, 0}, {-2.25, 0}, {1/2, -1}], 
             Line[{{0.6, 0}, {0.615, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.4, 17], {0.7, 0.5196152422706631}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.7, 0.5196152422706631}, {0.7150000000000001, 
              0.5455960043841963}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.7000000000000001, 17], {0.35000000000000003`, 
              0.6062177826491071}, {2.25, 0}], 
             
             Line[{{0.32000000000000006`, 0.6062177826491071}, {
              0.35000000000000003`, 0.6062177826491071}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.29999999999999993`, 17], {
              0.7000000000000001, 0}, {-2.25, 0}, {1/2, -1}], 
             
             Line[{{0.7000000000000001, 0}, {
               0.7150000000000001, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.29999999999999993`, 17], {0.6499999999999999, 
              0.6062177826491071}, {-2.25, 0}, {1.5, 2}], 
             
             Line[{{0.6499999999999999, 0.6062177826491071}, {0.665, 
              0.6321985447626403}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.8, 17], {0.4, 0.6928203230275509}, {2.25, 0}], 
             Line[{{0.37, 0.6928203230275509}, {0.4, 0.6928203230275509}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.19999999999999996`, 17], {0.8, 0}, {-2.25, 0}, {
              1/2, -1}], 
             Line[{{0.8, 0}, {0.8150000000000001, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.19999999999999996`, 17], {0.6, 
              0.6928203230275509}, {-2.25, 0}, {1.5, 2}], 
             
             Line[{{0.6, 0.6928203230275509}, {0.615, 
              0.7188010851410841}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.9, 17], {0.45, 0.7794228634059948}, {2.25, 0}], 
             
             Line[{{0.42000000000000004`, 0.7794228634059948}, {0.45, 
              0.7794228634059948}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.09999999999999998, 17], {0.9, 0}, {-2.25, 0}, {
              1/2, -1}], 
             Line[{{0.9, 0}, {0.915, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.09999999999999998, 17], {0.55, 
              0.7794228634059948}, {-2.25, 0}, {1.5, 2}], 
             
             Line[{{0.55, 0.7794228634059948}, {0.565, 
              0.8054036255195279}}]}}}, 
          Text[
           Style["solute", 17, 
            RGBColor[0, 0, 1]], {0.5, Sqrt[3]/2}, {0, -1}], 
          Text[
           Style["solvent", 17, 
            RGBColor[1, 0, 0]], {0, 0}, {1, 2}], 
          Text[
           Style["carrier", 17, 
            RGBColor[0, 0.6, 0]], {1, 0}, {-1, 2}]}], $CellContext`pt1[
         Pattern[$CellContext`pt, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]]] := {$CellContext`col, 
         PointSize[0.03], 
         Point[$CellContext`pt], White, 
         PointSize[0.015], 
         Point[$CellContext`pt]}, $CellContext`colF = 
       GrayLevel[0], $CellContext`label1[
         Pattern[$CellContext`text, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]], 
         Pattern[$CellContext`loc, 
          Blank[]]] := Text[
         Framed[
          Style[
           Row[{" ", $CellContext`text, " "}], 18, Italic, $CellContext`col], 
          Background -> White, FrameStyle -> $CellContext`col, FrameMargins -> 
          Tiny, RoundingRadius -> 15], $CellContext`loc, {
         0, -1.5}], $CellContext`table1[
         Pattern[$CellContext`title, 
          Blank[]], 
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`y, 
          Blank[]]] := Text[
         Style[
          Column[{
            Row[{$CellContext`title, " mole fractions"}], 
            Framed[
             Column[{
               Style[
                Row[{"solute = ", 
                  NumberForm[
                   $CellContext`wtA[$CellContext`y], {2, 2}]}], Blue], 
               Style[
                Row[{"solvent = ", 
                  NumberForm[
                   $CellContext`wtS[$CellContext`x, $CellContext`y], {2, 
                   2}]}], Red], 
               Style[
                Row[{"carrier = ", 
                  
                  NumberForm[$CellContext`x - $CellContext`y/Sqrt[3], {2, 
                   2}]}], 
                RGBColor[0, 0.6, 0]]}], 
             FrameMargins -> {{20, 20}, {Automatic, Automatic}}]}, Center], 
          17], {-0.05, 0.75}], $CellContext`pt2[
         Pattern[$CellContext`pt, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]]] := {$CellContext`col, 
         PointSize[0.03], 
         Point[$CellContext`pt]}, $CellContext`colS = 
       RGBColor[1, 0, 0], $CellContext`colR = 
       RGBColor[0, 0.2666666666666667, 0.4], $CellContext`label2[
         Pattern[$CellContext`text, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]], 
         Pattern[$CellContext`loc, 
          Blank[]]] := Text[
         Framed[
          Style[
           Subscript[
            Style[
             Part[$CellContext`text, 1], Italic], 
            Part[$CellContext`text, 2]], 18, $CellContext`col], Background -> 
          White, FrameStyle -> $CellContext`col, FrameMargins -> Small, 
          RoundingRadius -> 15], $CellContext`loc, {
         0, -1.5}], $CellContext`colM = GrayLevel[0.3], $CellContext`table2[
         Pattern[$CellContext`title, 
          Blank[]], 
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`y, 
          Blank[]]] := Text[
         Style[
          Column[{
            Row[{$CellContext`title, " mole fractions"}], 
            Framed[
             Column[{
               Style[
                Row[{"solute = ", 
                  NumberForm[
                   $CellContext`wtA[$CellContext`y], {2, 2}]}], Blue], 
               Style[
                Row[{"solvent = ", 
                  NumberForm[
                   $CellContext`wtS[$CellContext`x, $CellContext`y], {2, 
                   2}]}], Red], 
               Style[
                Row[{"carrier = ", 
                  
                  NumberForm[$CellContext`x - $CellContext`y/Sqrt[3], {2, 
                   2}]}], 
                RGBColor[0, 0.6, 0]]}], 
             FrameMargins -> {{20, 20}, {Automatic, Automatic}}]}, Center], 
          17], {1.05, 0.75}], $CellContext`colE1 = 
       RGBColor[1, 0.5, 0], $CellContext`colOP = 
       RGBColor[0.5, 0, 0.5], $CellContext`rafinate2 = {0.6, 
        0.3}, $CellContext`raffinate3 = {0.6, 0.3}, $CellContext`rafinate4 = {
        0.6, 0.3}, $CellContext`rafinate5 = {0.6, 
        0.3}, $CellContext`extract4 = {0.4, 0.15}, $CellContext`extract5 = {
        0.4, 0.15}, $CellContext`extract6 = {0.4, 0.15}, $CellContext`Estage = 
       1, $CellContext`Rstage = 1}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->1537150000,ExpressionUUID->"8b33844a-b922-4db3-93cd-36862ce1a450"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`extract1$$ = {0.4, 
    0.3}, $CellContext`extract2$$ = {0.4, 0.15}, $CellContext`extract3$$ = {
    0.4, 0.15}, $CellContext`feed$$ = {0.5, 0.7}, $CellContext`hint$$ = 
    False, $CellContext`MCR$$ = 5, $CellContext`mixing$$ = {0.5, 
    0.7}, $CellContext`operatingpt$$ = {0.5, 
    0.7}, $CellContext`raffinate1$$ = {0.6, 
    0.3}, $CellContext`raffinate2$$ = {0.6, 
    0.3}, $CellContext`raffinateN$$ = {0.5, 0.7}, $CellContext`reset$$ = 
    1, $CellContext`solution$$ = False, $CellContext`solvent$$ = {0.5, 0.7}, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`reset$$], 1}, 1, 1000, 1}, {{
       Hold[$CellContext`MCR$$], 1, ""}, {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 
      11}}, {{
       Hold[$CellContext`solution$$], False, "solution"}, {True, False}}, {{
       Hold[$CellContext`hint$$], False, "hint"}, {True, False}}, {{
       Hold[$CellContext`feed$$], {0.5, 0.7}}, Automatic}, {{
       Hold[$CellContext`solvent$$], {0.5, 0.7}}, Automatic}, {{
       Hold[$CellContext`raffinateN$$], {0.5, 0.7}}, Automatic}, {{
       Hold[$CellContext`mixing$$], {0.5, 0.7}}, Automatic}, {{
       Hold[$CellContext`extract1$$], {0.4, 0.3}}, Automatic}, {{
       Hold[$CellContext`operatingpt$$], {0.5, 0.7}}, Automatic}, {{
       Hold[$CellContext`raffinate1$$], {0.6, 0.3}}, Automatic}, {{
       Hold[$CellContext`extract2$$], {0.4, 0.15}}, Automatic}, {{
       Hold[$CellContext`raffinate2$$], {0.6, 0.3}}, Automatic}, {{
       Hold[$CellContext`extract3$$], {0.4, 0.15}}, Automatic}, {
      Hold[
       Grid[{{
          Button["new problem", {
            
            If[$CellContext`reset$$ < 
             1000, $CellContext`reset$$ = $CellContext`reset$$ + 
              1, $CellContext`reset$$ = $CellContext`reset$$ - 
              1], $CellContext`MCR$$ = 1, $CellContext`solution$$ = 
            False, $CellContext`hint$$ = 
            False, $CellContext`feed$$ = {0.5, 
             0.7}, $CellContext`solvent$$ = {0.5, 
             0.7}, $CellContext`raffinateN$$ = {0.5, 
             0.7}, $CellContext`mixing$$ = {0.5, 
             0.7}, $CellContext`extract1$$ = {0.4, 
             0.3}, $CellContext`operatingpt$$ = {0.5, 
             0.7}, $CellContext`raffinate1$$ = {0.6, 
             0.3}, $CellContext`rafinate2 = {0.6, 
             0.3}, $CellContext`raffinate3 = {0.6, 
             0.3}, $CellContext`rafinate4 = {0.6, 
             0.3}, $CellContext`rafinate5 = {0.6, 
             0.3}, $CellContext`extract2$$ = {0.4, 
             0.15}, $CellContext`extract3$$ = {0.4, 
             0.15}, $CellContext`extract4 = {0.4, 
             0.15}, $CellContext`extract5 = {0.4, 
             0.15}, $CellContext`extract6 = {0.4, 0.15}, $CellContext`Estage = 
            1, $CellContext`Rstage = 1}], 
          Manipulate`Place[1], 
          
          PaneSelector[{
           1 -> "(1) locate feed point", 2 -> "(2) locate solvent point", 3 -> 
            "(3) locate raffinate point", 4 -> "(4) locate mixing point", 5 -> 
            "(5) locate first extract point", 6 -> 
            "(6) locate operating point", 7 -> Row[{"(7) determine ", 
               Subscript[
                Style["R", Italic], 1]}], 8 -> Row[{"(8) determine ", 
               Subscript[
                Style["E", Italic], 2]}], 9 -> Row[{"(9) determine ", 
               Subscript[
                Style["R", Italic], 2]}], 10 -> Row[{"(10) determine ", 
               Subscript[
                Style["E", Italic], 3]}], 11 -> "(11) solution"}, 
           Dynamic[$CellContext`MCR$$]], 
          Manipulate`Place[2], 
          PaneSelector[{1 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 2 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 3 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 4 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 5 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 6 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 7 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 8 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 9 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 10 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}]}, 
           Dynamic[$CellContext`MCR$$]], 
          
          PaneSelector[{
           1 -> Manipulate`Place[3], 2 -> Manipulate`Place[3], 3 -> 
            Manipulate`Place[3], 4 -> Manipulate`Place[3], 5 -> 
            Manipulate`Place[3], 6 -> Manipulate`Place[3], 7 -> 
            Manipulate`Place[3], 8 -> Manipulate`Place[3], 9 -> 
            Manipulate`Place[3], 10 -> Manipulate`Place[3]}, 
           Dynamic[$CellContext`MCR$$]], 
          
          PaneSelector[{
           1 -> Manipulate`Place[4], 2 -> Manipulate`Place[4], 3 -> 
            Manipulate`Place[4], 4 -> Manipulate`Place[4], 5 -> 
            Manipulate`Place[4], 6 -> Manipulate`Place[4], 7 -> 
            Manipulate`Place[4], 8 -> Manipulate`Place[4], 9 -> 
            Manipulate`Place[4], 10 -> Manipulate`Place[4]}, 
           Dynamic[$CellContext`MCR$$]], 
          
          PaneSelector[{
           1 -> Manipulate`Place[5], 2 -> Manipulate`Place[6], 3 -> 
            Manipulate`Place[7], 4 -> Manipulate`Place[8], 5 -> 
            Manipulate`Place[9], 6 -> Manipulate`Place[10], 7 -> 
            Manipulate`Place[11], 8 -> Manipulate`Place[12], 9 -> 
            Manipulate`Place[13], 10 -> Manipulate`Place[14]}, 
           Dynamic[$CellContext`MCR$$]]}}]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    600., {193., 197.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`reset$81342$$ = 
    0, $CellContext`MCR$81343$$ = 0, $CellContext`solution$81344$$ = 
    False, $CellContext`hint$81345$$ = False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`extract1$$ = {0.4, 
         0.3}, $CellContext`extract2$$ = {0.4, 
         0.15}, $CellContext`extract3$$ = {0.4, 0.15}, $CellContext`feed$$ = {
         0.5, 0.7}, $CellContext`hint$$ = False, $CellContext`MCR$$ = 
        1, $CellContext`mixing$$ = {0.5, 0.7}, $CellContext`operatingpt$$ = {
         0.5, 0.7}, $CellContext`raffinate1$$ = {0.6, 
         0.3}, $CellContext`raffinate2$$ = {0.6, 
         0.3}, $CellContext`raffinateN$$ = {0.5, 0.7}, $CellContext`reset$$ = 
        1, $CellContext`solution$$ = 
        False, $CellContext`solvent$$ = {0.5, 0.7}}, "ControllerVariables" :> {
        Hold[$CellContext`reset$$, $CellContext`reset$81342$$, 0], 
        Hold[$CellContext`MCR$$, $CellContext`MCR$81343$$, 0], 
        Hold[$CellContext`solution$$, $CellContext`solution$81344$$, False], 
        Hold[$CellContext`hint$$, $CellContext`hint$81345$$, False]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`x1$, $CellContext`y1$, $CellContext`x2$, \
$CellContext`y2$, $CellContext`x3$, $CellContext`y3$, $CellContext`sol$, \
$CellContext`a$, $CellContext`b$, $CellContext`c$, $CellContext`phase$, \
$CellContext`yt$, $CellContext`xt$, $CellContext`tie$, \
$CellContext`phaseplot$, $CellContext`tielines$, $CellContext`F$, \
$CellContext`S$, $CellContext`M$, $CellContext`xF$, $CellContext`yF$, \
$CellContext`xRN$, $CellContext`yRN$, $CellContext`Msol$, $CellContext`xM$, \
$CellContext`yM$, $CellContext`xE$, $CellContext`yE$, $CellContext`xP$, \
$CellContext`yP$, $CellContext`operating$, $CellContext`lower$, \
$CellContext`upper$, $CellContext`lever$, $CellContext`newtie$, \
$CellContext`xtie$, $CellContext`xR$, $CellContext`yR$, $CellContext`n$, \
$CellContext`plotlabel$}, 
        SeedRandom[$CellContext`reset$$]; $CellContext`x1$ = 
         RandomReal[{0.02, 0.07}]; $CellContext`y1$ = 0; $CellContext`x2$ = 
         RandomReal[{0.45, 0.55}]; $CellContext`y2$ = 
         RandomReal[{0.3, 0.4}]; $CellContext`x3$ = 
         RandomReal[{0.85, 0.98}]; $CellContext`y3$ = 0; $CellContext`sol$ = 
         Quiet[
           Part[
            
            Solve[{$CellContext`\[Alpha] $CellContext`x1$^2 + $CellContext`\
\[Beta] $CellContext`x1$ + $CellContext`\[Chi] == $CellContext`y1$, \
$CellContext`\[Alpha] $CellContext`x2$^2 + $CellContext`\[Beta] \
$CellContext`x2$ + $CellContext`\[Chi] == $CellContext`y2$, $CellContext`\
\[Alpha] $CellContext`x3$^2 + $CellContext`\[Beta] $CellContext`x3$ + \
$CellContext`\[Chi] == $CellContext`y3$}, {$CellContext`\[Alpha], \
$CellContext`\[Beta], $CellContext`\[Chi]}], 1]]; $CellContext`a$ = 
         ReplaceAll[$CellContext`\[Alpha], $CellContext`sol$]; \
$CellContext`b$ = 
         ReplaceAll[$CellContext`\[Beta], $CellContext`sol$]; $CellContext`c$ = 
         ReplaceAll[$CellContext`\[Chi], $CellContext`sol$]; \
$CellContext`phase$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`a$ $CellContext`x$^2 + $CellContext`b$ \
$CellContext`x$ + $CellContext`c$; $CellContext`yt$[1] = 
         RandomReal[{0.02, 0.05} $CellContext`y2$]; $CellContext`xt$[1] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              1], $CellContext`x], 1]]; $CellContext`yt$[2] = 
         RandomReal[{0.06, 0.1} $CellContext`y2$]; $CellContext`xt$[2] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              2], $CellContext`x], 2]]; $CellContext`tie$[1][
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yt$[2] - $CellContext`yt$[
             1])/($CellContext`xt$[2] - $CellContext`xt$[
            1])) ($CellContext`x$ - $CellContext`xt$[1]) + $CellContext`yt$[
           1]; $CellContext`yt$[3] = 
         RandomReal[{0.15, 0.2} $CellContext`y2$]; $CellContext`xt$[3] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              3], $CellContext`x], 1]]; $CellContext`yt$[4] = 
         RandomReal[{0.25, 0.3} $CellContext`y2$]; $CellContext`xt$[4] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              4], $CellContext`x], 2]]; $CellContext`tie$[2][
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yt$[4] - $CellContext`yt$[
             3])/($CellContext`xt$[4] - $CellContext`xt$[
            3])) ($CellContext`x$ - $CellContext`xt$[3]) + $CellContext`yt$[
           3]; $CellContext`yt$[5] = 
         RandomReal[{0.35, 0.4} $CellContext`y2$]; $CellContext`xt$[5] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              5], $CellContext`x], 1]]; $CellContext`yt$[6] = 
         RandomReal[{0.5, 0.55} $CellContext`y2$]; $CellContext`xt$[6] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              6], $CellContext`x], 2]]; $CellContext`tie$[3][
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yt$[6] - $CellContext`yt$[
             5])/($CellContext`xt$[6] - $CellContext`xt$[
            5])) ($CellContext`x$ - $CellContext`xt$[5]) + $CellContext`yt$[
           5]; $CellContext`yt$[7] = 
         RandomReal[{0.72, 0.77} $CellContext`y2$]; $CellContext`xt$[7] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              7], $CellContext`x], 1]]; $CellContext`yt$[8] = 
         RandomReal[{0.8, 0.9} $CellContext`y2$]; $CellContext`xt$[8] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              8], $CellContext`x], 2]]; $CellContext`tie$[4][
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yt$[8] - $CellContext`yt$[
             7])/($CellContext`xt$[8] - $CellContext`xt$[
            7])) ($CellContext`x$ - $CellContext`xt$[7]) + $CellContext`yt$[
           7]; $CellContext`phaseplot$ = Plot[
           $CellContext`phase$[$CellContext`x], {$CellContext`x, \
$CellContext`x1$, $CellContext`x3$}, PlotStyle -> {Thick, Black}, 
           PlotRange -> {{0, 1}, {0, Sqrt[3]/2}}]; $CellContext`tielines$ = 
         Graphics[{
            Thickness[0.004], 
            Line[{{
               $CellContext`xt$[1], 
               $CellContext`yt$[1]}, {
               $CellContext`xt$[2], 
               $CellContext`yt$[2]}}], 
            Line[{{
               $CellContext`xt$[3], 
               $CellContext`yt$[3]}, {
               $CellContext`xt$[4], 
               $CellContext`yt$[4]}}], 
            Line[{{
               $CellContext`xt$[5], 
               $CellContext`yt$[5]}, {
               $CellContext`xt$[6], 
               $CellContext`yt$[6]}}], 
            Line[{{
               $CellContext`xt$[7], 
               $CellContext`yt$[7]}, {
               $CellContext`xt$[8], 
               $CellContext`yt$[8]}}]}]; $CellContext`F$ = 
         RandomInteger[{1000, 1500}]; $CellContext`S$ = 
         RandomInteger[{1500, 
           2000}]; $CellContext`M$ = $CellContext`F$ + $CellContext`S$; \
$CellContext`xF$ = RandomReal[{0.6, 0.7}]; $CellContext`yF$ = 
         RandomReal[{0.4, 0.45}]; $CellContext`xRN$ = 
         0.99 $CellContext`x3$; $CellContext`yRN$ = \
$CellContext`phase$[$CellContext`xRN$]; $CellContext`Msol$ = Quiet[
           First[
            Solve[
             
             And[$CellContext`wtA[$CellContext`yF$] $CellContext`F$ == \
$CellContext`xA $CellContext`M$, $CellContext`wtS[$CellContext`xF$, \
$CellContext`yF$] $CellContext`F$ + $CellContext`S$ == $CellContext`xS \
$CellContext`M$, $CellContext`xA + $CellContext`xS + $CellContext`xC == 
              1], {$CellContext`xA, $CellContext`xS, $CellContext`xC}]]]; \
$CellContext`xM$ = 
         1 - ReplaceAll[$CellContext`xS, $CellContext`Msol$] - \
$CellContext`yM$/Sqrt[3]; $CellContext`yM$ = 
         ReplaceAll[(Sqrt[3]/
            2) $CellContext`xA, $CellContext`Msol$]; $CellContext`xE$[1] = 
         ReplaceAll[$CellContext`x, 
           Quiet[
            First[
             
             Solve[$CellContext`phase$[$CellContext`x] == (($CellContext`yRN$ - \
$CellContext`yM$)/($CellContext`xRN$ - $CellContext`xM$)) ($CellContext`x - \
$CellContext`xRN$) + $CellContext`yRN$, $CellContext`x]]]]; $CellContext`yE$[
          1] = $CellContext`phase$[
           $CellContext`xE$[1]]; $CellContext`xP$ = ReplaceAll[$CellContext`x, 
           Quiet[
            First[
             
             Solve[(($CellContext`yF$ - $CellContext`yE$[
                  1])/($CellContext`xF$ - $CellContext`xE$[
                 1])) ($CellContext`x - $CellContext`xF$) + $CellContext`yF$ == \
($CellContext`yRN$/$CellContext`xRN$) $CellContext`x, $CellContext`x]]]]; \
$CellContext`yP$ = ($CellContext`yRN$/$CellContext`xRN$) $CellContext`xP$; \
$CellContext`operating$[
           Pattern[$CellContext`i$, 
            Blank[]], 
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yR$[$CellContext`i$] - \
$CellContext`yP$)/($CellContext`xR$[$CellContext`i$] - $CellContext`xP$)) \
($CellContext`x$ - $CellContext`xP$) + $CellContext`yP$; $CellContext`lower$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Which[Part[$CellContext`pt$, 2] <= $CellContext`tie$[1][
             Part[$CellContext`pt$, 1]], 0, 
           Inequality[
            $CellContext`tie$[1][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[2][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[1][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[2][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[3][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[2][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[3][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[3][$CellContext`x$], $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]] < Part[$CellContext`pt$, 2], 
           $CellContext`tie$[4][$CellContext`x$]]; $CellContext`upper$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Which[Part[$CellContext`pt$, 2] < $CellContext`tie$[1][
             Part[$CellContext`pt$, 1]], 
           $CellContext`tie$[1][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[1][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[2][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[2][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[2][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[3][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[3][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[3][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[4][$CellContext`x$], $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]] < Part[$CellContext`pt$, 2], 
           $CellContext`tie$[4][$CellContext`x$]]; $CellContext`lever$[
           Pattern[$CellContext`pt$, 
            Blank[]]] := If[Part[$CellContext`pt$, 2] >= $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]], 
           1, (Part[$CellContext`pt$, 
              2] - $CellContext`upper$[$CellContext`pt$, 
             
             Part[$CellContext`pt$, 
              1]])/($CellContext`lower$[$CellContext`pt$, 
             
             Part[$CellContext`pt$, 
              1]] - $CellContext`upper$[$CellContext`pt$, 
            Part[$CellContext`pt$, 1]])]; $CellContext`newtie$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`lever$[$CellContext`pt$] \
$CellContext`lower$[$CellContext`pt$, $CellContext`x$] + (
            1 - $CellContext`lever$[$CellContext`pt$]) \
$CellContext`upper$[$CellContext`pt$, $CellContext`x$]; $CellContext`xtie$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`i$, 
            Blank[]]] := ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`newtie$[$CellContext`pt$, $CellContext`x] == \
$CellContext`phase$[$CellContext`x], $CellContext`x], $CellContext`i$]]; \
$CellContext`xR$[1] = ReplaceAll[$CellContext`x, 
           Part[
            Solve[$CellContext`newtie$[{
                $CellContext`xE$[1], 
                $CellContext`yE$[
                1]}, $CellContext`x] == $CellContext`phase$[$CellContext`x], \
$CellContext`x], 2]]; $CellContext`yR$[1] = $CellContext`phase$[
           $CellContext`xR$[1]]; $CellContext`xE$[2] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`operating$[
              1, $CellContext`x] == $CellContext`phase$[$CellContext`x], \
$CellContext`x], 1]]; $CellContext`yE$[2] = $CellContext`phase$[
           $CellContext`xE$[2]]; 
        Map[If[$CellContext`xR$[# - 
             1] < $CellContext`xRN$, {$CellContext`xR$[#] = 
             ReplaceAll[$CellContext`x, 
               Part[
                Solve[$CellContext`newtie$[{
                    $CellContext`xE$[#], 
                    $CellContext`yE$[#]}, $CellContext`x] == \
$CellContext`phase$[$CellContext`x], $CellContext`x], 
                2]]; $CellContext`yR$[#] = $CellContext`phase$[
               $CellContext`xR$[#]]; $CellContext`xE$[# + 1] = 
             ReplaceAll[$CellContext`x, 
               Part[
                
                Solve[$CellContext`operating$[#, $CellContext`x] == \
$CellContext`phase$[$CellContext`x], $CellContext`x], 1]]; $CellContext`yE$[# + 
               1] = $CellContext`phase$[
               $CellContext`xE$[# + 1]]; Null}]& , 
          Range[2, 10]]; $CellContext`n$ = Part[
           DeleteCases[
            Map[If[$CellContext`xR$[#] < $CellContext`xRN$, 0, #]& , 
             Range[10]], 0], 1]; 
        If[$CellContext`n$ == 
          8, $CellContext`reset$$ = $CellContext`reset$$ + 
           1]; $CellContext`plotlabel$ = Switch[$CellContext`MCR$$, 1, 
           If[$CellContext`hint$$, "hint: read the compositions on the axes", 
            Row[{"Step 1: move the feed point ", 
              Style["F", Italic], 
              " to \nthe correct location, then check solution"}]], 2, 
           If[$CellContext`hint$$, "hint: read the compositions on the axes", 
            Row[{"Step 2: move the solvent point ", 
              Style["S", Italic], 
              " to \nthe correct location, then check solution"}]], 3, 
           If[$CellContext`hint$$, "hint: read the compositions on the axes", 
            Row[{"Step 3: move the desired raffinate point ", 
              Subscript[
               Style["R", Italic], "N"], 
              " to \nthe correct location, then check solution"}]], 4, 
           If[$CellContext`hint$$, "hint: use the lever rule", 
            Row[{"Step 4: use mass balance for two entering streams (", 
              Style["F", Italic], ", ", 
              Style["S", Italic], ")\n to determine the average composition ", 
              Style["M", Italic], ", then check solution"}]], 5, 
           If[$CellContext`hint$$, 
            Row[{"hint: use mass balance for two exit streams (", 
              Subscript[
               Style["R", Italic], "N"], ", ", 
              Subscript[
               Style["E", Italic], 1], ")"}], 
            Row[{"Step 5: move the point for the first extract composition ", 
              Subscript[
               Style["E", Italic], 1], 
              "\n to the correct location, then check solution"}]], 6, 
           If[$CellContext`hint$$, 
            
            Row[{"hint: the operating point is at the intersection of \na \
line through ", 
              Style["F", Italic], " and ", 
              Subscript[
               Style["E", Italic], 1], " and a line through ", 
              Style["S", Italic], " and ", 
              Subscript[
               Style["R", Italic], "N"]}], 
            Row[{"Step 6: move the operating point ", 
              Style["P", Italic], 
              " \nto the correct location, then check solution"}]], 7, 
           
           If[$CellContext`hint$$, 
            "hint: follow the tie line to the other side of the phase \
boundary", 
            "Step 7: move the blue point to the correct raffinate \
composition"], 8, 
           
           If[$CellContext`hint$$, "hint: draw a line to the operating point",
             "Step 8: move the yellow point to the correct extract \
composition"], 9, 
           
           If[$CellContext`hint$$, 
            "hint: follow the tie line to the other side of the phase \
boundary", 
            "Step 9: move the blue point to the correct raffinate \
composition"], 10, 
           
           If[$CellContext`hint$$, "hint: draw a line to the operating point",
             "Step 10: move the yellow point to the correct extract \
composition"], 11, 
           Row[{$CellContext`n$, " stages needed"}]]; Show[
          
          If[$CellContext`MCR$$ <= 
           4, $CellContext`gridLines, {}], $CellContext`base, \
$CellContext`phaseplot$, $CellContext`tielines$, ImageSize -> {600, 390}, 
          PlotRange -> {{-0.25, 1.15}, {-0.1, 0.93}}, 
          ImagePadding -> {{55, 55}, {5, 
             If[$CellContext`hint$$, 
              If[$CellContext`MCR$$ == 6, 15, 35], 
              If[3 <= $CellContext`MCR$$ <= 5, 15, 35]]}}, PlotLabel -> 
          Style[$CellContext`plotlabel$, 17, Black], Epilog -> {Thick, 
            If[$CellContext`MCR$$ == 1, {
              $CellContext`pt1[$CellContext`feed$$, $CellContext`colF], 
              $CellContext`label1[
              "F", $CellContext`colF, $CellContext`feed$$], 
              $CellContext`table1["feed", $CellContext`xF$, $CellContext`yF$], 
              If[$CellContext`solution$$, 
               $CellContext`pt2[{$CellContext`xF$, $CellContext`yF$}, \
$CellContext`colF]]}], 
            If[$CellContext`MCR$$ > 1, {
              $CellContext`pt2[{$CellContext`xF$, $CellContext`yF$}, \
$CellContext`colF], 
              $CellContext`label1[
              "F", $CellContext`colF, {$CellContext`xF$, $CellContext`yF$}]}], 
            If[$CellContext`MCR$$ == 2, {
              $CellContext`pt1[$CellContext`solvent$$, $CellContext`colS], 
              $CellContext`label1[
              "S", $CellContext`colS, $CellContext`solvent$$], 
              $CellContext`table1["solvent", 0, 0], 
              If[$CellContext`solution$$, 
               $CellContext`pt2[{0, 0}, $CellContext`colS]]}], 
            If[$CellContext`MCR$$ > 2, {
              $CellContext`pt2[{0, 0}, $CellContext`colS], 
              $CellContext`label1["S", $CellContext`colS, {0, 0}]}], 
            If[$CellContext`MCR$$ == 3, {
              $CellContext`pt1[$CellContext`raffinateN$$, $CellContext`colR], 
              $CellContext`label2[{
               "R", "N"}, $CellContext`colR, $CellContext`raffinateN$$], 
              $CellContext`table1[
              "raffinate", $CellContext`xRN$, $CellContext`yRN$], 
              If[$CellContext`solution$$, 
               $CellContext`pt2[{$CellContext`xRN$, $CellContext`yRN$}, \
$CellContext`colR]]}], 
            If[$CellContext`MCR$$ > 3, {
              $CellContext`pt2[{$CellContext`xRN$, $CellContext`yRN$}, \
$CellContext`colR], 
              $CellContext`label2[{
               "R", "N"}, $CellContext`colR, {$CellContext`xRN$, \
$CellContext`yRN$}]}], 
            If[$CellContext`MCR$$ == 4, {{Dashed, $CellContext`colM, 
               Line[{{$CellContext`xF$, $CellContext`yF$}, {0, 0}}]}, 
              $CellContext`pt1[$CellContext`mixing$$, $CellContext`colM], 
              $CellContext`label1[
              "M", $CellContext`colM, $CellContext`mixing$$], 
              $CellContext`table2["mixing", 
               Part[$CellContext`mixing$$, 1], 
               Part[$CellContext`mixing$$, 2]], 
              Text[
               Style[
                Column[{"flow rates", 
                  Framed[
                   Column[{
                    Style[
                    Row[{
                    Style["F", Italic], " = ", 
                    NumberForm[$CellContext`F$, {4, 0}], 
                    " kg/h"}], $CellContext`colF], 
                    Style[
                    Row[{
                    Style["S", Italic], " = ", 
                    NumberForm[$CellContext`S$, {4, 0}], 
                    " kg/h"}], $CellContext`colS]}, Alignment -> "="]]}, 
                 Center], 17], {-0.05, 0.75}], 
              If[$CellContext`solution$$, 
               $CellContext`pt2[{$CellContext`xM$, $CellContext`yM$}, \
$CellContext`colM]]}], 
            If[$CellContext`MCR$$ == 5, {
              $CellContext`pt2[{$CellContext`xM$, $CellContext`yM$}, \
$CellContext`colM], 
              $CellContext`label1[
              "M", $CellContext`colM, {$CellContext`xM$, $CellContext`yM$}], \
{$CellContext`colE1, 
               
               Arrow[{{$CellContext`xRN$, $CellContext`yRN$}, \
$CellContext`extract1$$}]}, 
              $CellContext`pt1[$CellContext`extract1$$, $CellContext`colE1], 
              $CellContext`label2[{
               "E", 1}, $CellContext`colE1, $CellContext`extract1$$], 
              If[$CellContext`solution$$, 
               $CellContext`pt2[{
                 $CellContext`xE$[1], 
                 $CellContext`yE$[1]}, $CellContext`colE1]]}], 
            If[$CellContext`MCR$$ > 5, {
              $CellContext`pt2[{
                $CellContext`xE$[1], 
                $CellContext`yE$[1]}, $CellContext`colE1], 
              $CellContext`label2[{"E", 1}, $CellContext`colE1, {
                $CellContext`xE$[1], 
                $CellContext`yE$[1]}]}], 
            If[$CellContext`MCR$$ == 6, {{
               Thickness[0.007], Dotted, $CellContext`colOP, 
               
               Line[{$CellContext`operatingpt$$, {$CellContext`xF$, \
$CellContext`yF$}}], 
               
               Line[{$CellContext`operatingpt$$, {$CellContext`xRN$, \
$CellContext`yRN$}}]}, 
              $CellContext`pt1[$CellContext`operatingpt$$, \
$CellContext`colOP], 
              $CellContext`label1[
              "P", $CellContext`colOP, $CellContext`operatingpt$$], 
              If[$CellContext`solution$$, {Dashed, $CellContext`colOP, 
                
                Line[{{$CellContext`xP$, $CellContext`yP$}, \
{$CellContext`xF$, $CellContext`yF$}}], 
                
                Line[{{$CellContext`xP$, $CellContext`yP$}, \
{$CellContext`xRN$, $CellContext`yRN$}}], 
                $CellContext`pt2[{$CellContext`xP$, $CellContext`yP$}, \
$CellContext`colOP]}]}], 
            If[6 < $CellContext`MCR$$ < 11, {
              $CellContext`pt2[{$CellContext`xP$, $CellContext`yP$}, \
$CellContext`colOP], 
              $CellContext`label1[
              "P", $CellContext`colOP, {$CellContext`xP$, \
$CellContext`yP$}]}], 
            If[$CellContext`MCR$$ == 7, {{$CellContext`colR, Dashed, 
               Line[{{
                  $CellContext`xE$[1], 
                  $CellContext`yE$[1]}, $CellContext`raffinate1$$}]}, 
              $CellContext`pt1[$CellContext`raffinate1$$, $CellContext`colR], 
              $CellContext`label2[{"R", 1}, $CellContext`colR, 
               If[$CellContext`solution$$, {
                 $CellContext`xR$[1], 
                 $CellContext`yR$[1]}, $CellContext`raffinate1$$]], 
              If[$CellContext`solution$$, {$CellContext`colR, Dashed, 
                Line[{{
                   $CellContext`xE$[1], 
                   $CellContext`yE$[1]}, {
                   $CellContext`xR$[1], 
                   $CellContext`yR$[1]}}], 
                $CellContext`pt2[{
                  $CellContext`xR$[1], 
                  $CellContext`yR$[1]}, $CellContext`colR]}]}], 
            If[7 < $CellContext`MCR$$ < 11, {{$CellContext`colR, Dashed, 
               Line[{{
                  $CellContext`xE$[1], 
                  $CellContext`yE$[1]}, {
                  $CellContext`xR$[1], 
                  $CellContext`yR$[1]}}]}, 
              $CellContext`pt2[{
                $CellContext`xR$[1], 
                $CellContext`yR$[1]}, $CellContext`colR], 
              $CellContext`label2[{"R", 1}, $CellContext`colR, {
                $CellContext`xR$[1], 
                $CellContext`yR$[1]}]}], 
            If[$CellContext`MCR$$ == 8, {{$CellContext`colE1, Dashed, 
               Line[{{
                  $CellContext`xR$[1], 
                  $CellContext`yR$[
                  1]}, {$CellContext`xP$, $CellContext`yP$}}]}, 
              $CellContext`pt1[$CellContext`extract2$$, $CellContext`colE1], 
              $CellContext`label2[{"E", 2}, $CellContext`colE1, 
               If[$CellContext`solution$$, {
                 $CellContext`xE$[2], 
                 $CellContext`yE$[2]}, $CellContext`extract2$$]], 
              If[$CellContext`solution$$, {{$CellContext`colE1, Dashed, 
                 Line[{{
                    $CellContext`xR$[1], 
                    $CellContext`yR$[1]}, {
                    $CellContext`xE$[2], 
                    $CellContext`yE$[2]}}]}, 
                $CellContext`pt2[{
                  $CellContext`xE$[2], 
                  $CellContext`yE$[2]}, $CellContext`colE1]}]}], 
            If[8 < $CellContext`MCR$$ < 11, {{$CellContext`colE1, Dashed, 
               Line[{{
                  $CellContext`xR$[1], 
                  $CellContext`yR$[1]}, {
                  $CellContext`xE$[2], 
                  $CellContext`yE$[2]}}]}, 
              $CellContext`pt2[{
                $CellContext`xE$[2], 
                $CellContext`yE$[2]}, $CellContext`colE1], 
              $CellContext`label2[{"E", 2}, $CellContext`colE1, {
                $CellContext`xE$[2], 
                $CellContext`yE$[2]}]}], 
            If[$CellContext`MCR$$ == 9, {{$CellContext`colR, Dashed, 
               Line[{{
                  $CellContext`xE$[2], 
                  $CellContext`yE$[2]}, $CellContext`raffinate2$$}]}, 
              $CellContext`pt1[$CellContext`raffinate2$$, $CellContext`colR], 
              $CellContext`label2[{"R", 2}, $CellContext`colR, 
               If[$CellContext`solution$$, {
                 $CellContext`xR$[2], 
                 $CellContext`yR$[2]}, $CellContext`raffinate2$$]], 
              If[$CellContext`solution$$, {$CellContext`colR, Dashed, 
                Line[{{
                   $CellContext`xE$[2], 
                   $CellContext`yE$[2]}, {
                   $CellContext`xR$[2], 
                   $CellContext`yR$[2]}}], 
                $CellContext`pt2[{
                  $CellContext`xR$[2], 
                  $CellContext`yR$[2]}, $CellContext`colR]}]}], 
            If[9 < $CellContext`MCR$$ < 11, {{$CellContext`colR, Dashed, 
               Line[{{
                  $CellContext`xE$[2], 
                  $CellContext`yE$[2]}, {
                  $CellContext`xR$[2], 
                  $CellContext`yR$[2]}}]}, 
              $CellContext`pt2[{
                $CellContext`xR$[2], 
                $CellContext`yR$[2]}, $CellContext`colR], 
              $CellContext`label2[{"R", 2}, $CellContext`colR, {
                $CellContext`xR$[2], 
                $CellContext`yR$[2]}]}], 
            If[$CellContext`MCR$$ == 10, {{$CellContext`colE1, Dashed, 
               Line[{{
                  $CellContext`xR$[2], 
                  $CellContext`yR$[
                  2]}, {$CellContext`xP$, $CellContext`yP$}}]}, 
              $CellContext`pt1[$CellContext`extract3$$, $CellContext`colE1], 
              $CellContext`label2[{"E", 3}, $CellContext`colE1, 
               If[$CellContext`solution$$, {
                 $CellContext`xE$[3], 
                 $CellContext`yE$[3]}, $CellContext`extract3$$]], 
              If[$CellContext`solution$$, {{$CellContext`colE1, Dashed, 
                 Line[{{
                    $CellContext`xR$[2], 
                    $CellContext`yR$[2]}, {
                    $CellContext`xE$[3], 
                    $CellContext`yE$[3]}}]}, 
                $CellContext`pt2[{
                  $CellContext`xE$[3], 
                  $CellContext`yE$[3]}, $CellContext`colE1]}]}], 
            If[$CellContext`MCR$$ == 11, {
              Map[{Dashed, $CellContext`colE1, 
                Line[{{
                   $CellContext`xE$[#], 
                   $CellContext`yE$[#]}, {
                   $CellContext`xR$[#], 
                   $CellContext`yR$[#]}}], $CellContext`colR, 
                Line[{{
                   $CellContext`xR$[#], 
                   $CellContext`yR$[#]}, {
                   $CellContext`xE$[# + 1], 
                   $CellContext`yE$[# + 1]}}]}& , 
               Range[$CellContext`n$]], 
              Map[{
                $CellContext`pt2[{
                  $CellContext`xE$[#], 
                  $CellContext`yE$[#]}, $CellContext`colE1], 
                $CellContext`label2[{"E", #}, $CellContext`colE1, {
                  $CellContext`xE$[#], 
                  $CellContext`yE$[#]}]}& , 
               Range[2, $CellContext`n$]], 
              Map[{
                $CellContext`pt2[{
                  $CellContext`xR$[#], 
                  $CellContext`yR$[#]}, $CellContext`colR], 
                $CellContext`label2[{"R", #}, $CellContext`colR, {
                  $CellContext`xR$[#], 
                  $CellContext`yR$[#]}]}& , 
               Range[$CellContext`n$]], 
              Map[Text[
                Style[
                 Row[{" ", #, " "}], 18, Background -> 
                 White], {$CellContext`xE$[#] + $CellContext`xR$[#], \
$CellContext`yE$[#] + $CellContext`yR$[#]}/2, {0, -1.5}]& , 
               Range[$CellContext`n$]]}]}]], 
      "Specifications" :> {{{$CellContext`reset$$, 1}, 1, 1000, 1, 
         ControlType -> None, ControlPlacement -> 
         1}, {{$CellContext`MCR$$, 1, ""}, {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 
         11}, ControlType -> None, ControlPlacement -> 
         2}, {{$CellContext`solution$$, False, "solution"}, {True, False}, 
         Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         3}, {{$CellContext`hint$$, False, "hint"}, {True, False}, 
         ControlPlacement -> 4}, {{$CellContext`feed$$, {0.5, 0.7}}, 
         Automatic, ControlType -> Locator, Appearance -> None, Enabled -> 
         Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         5}, {{$CellContext`solvent$$, {0.5, 0.7}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         6}, {{$CellContext`raffinateN$$, {0.5, 0.7}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         7}, {{$CellContext`mixing$$, {0.5, 0.7}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         8}, {{$CellContext`extract1$$, {0.4, 0.3}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         9}, {{$CellContext`operatingpt$$, {0.5, 0.7}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         10}, {{$CellContext`raffinate1$$, {0.6, 0.3}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         11}, {{$CellContext`extract2$$, {0.4, 0.15}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         12}, {{$CellContext`raffinate2$$, {0.6, 0.3}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         13}, {{$CellContext`extract3$$, {0.4, 0.15}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 14}, 
        Grid[{{
           Button["new problem", {
             
             If[$CellContext`reset$$ < 
              1000, $CellContext`reset$$ = $CellContext`reset$$ + 
               1, $CellContext`reset$$ = $CellContext`reset$$ - 
               1], $CellContext`MCR$$ = 1, $CellContext`solution$$ = 
             False, $CellContext`hint$$ = 
             False, $CellContext`feed$$ = {0.5, 
              0.7}, $CellContext`solvent$$ = {0.5, 
              0.7}, $CellContext`raffinateN$$ = {0.5, 
              0.7}, $CellContext`mixing$$ = {0.5, 
              0.7}, $CellContext`extract1$$ = {0.4, 
              0.3}, $CellContext`operatingpt$$ = {0.5, 
              0.7}, $CellContext`raffinate1$$ = {0.6, 
              0.3}, $CellContext`rafinate2 = {0.6, 
              0.3}, $CellContext`raffinate3 = {0.6, 
              0.3}, $CellContext`rafinate4 = {0.6, 
              0.3}, $CellContext`rafinate5 = {0.6, 
              0.3}, $CellContext`extract2$$ = {0.4, 
              0.15}, $CellContext`extract3$$ = {0.4, 
              0.15}, $CellContext`extract4 = {0.4, 
              0.15}, $CellContext`extract5 = {0.4, 
              0.15}, $CellContext`extract6 = {0.4, 0.15}, $CellContext`Estage = 
             1, $CellContext`Rstage = 1}], 
           Manipulate`Place[1], 
           
           PaneSelector[{
            1 -> "(1) locate feed point", 2 -> "(2) locate solvent point", 3 -> 
             "(3) locate raffinate point", 4 -> "(4) locate mixing point", 5 -> 
             "(5) locate first extract point", 6 -> 
             "(6) locate operating point", 7 -> Row[{"(7) determine ", 
                Subscript[
                 Style["R", Italic], 1]}], 8 -> Row[{"(8) determine ", 
                Subscript[
                 Style["E", Italic], 2]}], 9 -> Row[{"(9) determine ", 
                Subscript[
                 Style["R", Italic], 2]}], 10 -> Row[{"(10) determine ", 
                Subscript[
                 Style["E", Italic], 3]}], 11 -> "(11) solution"}, 
            Dynamic[$CellContext`MCR$$]], 
           Manipulate`Place[2], 
           PaneSelector[{1 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 2 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 3 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 4 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 5 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 6 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 7 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 8 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 9 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 10 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}]}, 
            Dynamic[$CellContext`MCR$$]], 
           
           PaneSelector[{
            1 -> Manipulate`Place[3], 2 -> Manipulate`Place[3], 3 -> 
             Manipulate`Place[3], 4 -> Manipulate`Place[3], 5 -> 
             Manipulate`Place[3], 6 -> Manipulate`Place[3], 7 -> 
             Manipulate`Place[3], 8 -> Manipulate`Place[3], 9 -> 
             Manipulate`Place[3], 10 -> Manipulate`Place[3]}, 
            Dynamic[$CellContext`MCR$$]], 
           
           PaneSelector[{
            1 -> Manipulate`Place[4], 2 -> Manipulate`Place[4], 3 -> 
             Manipulate`Place[4], 4 -> Manipulate`Place[4], 5 -> 
             Manipulate`Place[4], 6 -> Manipulate`Place[4], 7 -> 
             Manipulate`Place[4], 8 -> Manipulate`Place[4], 9 -> 
             Manipulate`Place[4], 10 -> Manipulate`Place[4]}, 
            Dynamic[$CellContext`MCR$$]], 
           
           PaneSelector[{
            1 -> Manipulate`Place[5], 2 -> Manipulate`Place[6], 3 -> 
             Manipulate`Place[7], 4 -> Manipulate`Place[8], 5 -> 
             Manipulate`Place[9], 6 -> Manipulate`Place[10], 7 -> 
             Manipulate`Place[11], 8 -> Manipulate`Place[12], 9 -> 
             Manipulate`Place[13], 10 -> Manipulate`Place[14]}, 
            Dynamic[$CellContext`MCR$$]]}}]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{649., {242., 248.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({
      Attributes[PlotRange] = {ReadProtected}, $CellContext`wtA[
         Pattern[$CellContext`y, 
          Blank[]]] := $CellContext`y (2/Sqrt[3]), $CellContext`wtS[
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`y, 
          Blank[]]] := 1 - ($CellContext`x + $CellContext`y/Sqrt[3]), 
       Attributes[Subscript] = {NHoldRest}, $CellContext`gridLines = Graphics[{
          Thickness[Tiny], 
          GrayLevel[0.7], {{
            Line[{{0., 0.}, {1., 0.}}], 
            Line[{{0., 0}, {0., 0.}}], 
            Line[{{1., 0}, {1., 0.}}]}, {
            
            Line[{{0.025, 0.04330127018922193}, {0.975, 
             0.04330127018922193}}], 
            Line[{{0.05, 0}, {0.025, 0.04330127018922193}}], 
            Line[{{0.95, 0}, {0.975, 0.04330127018922193}}]}, {
            Line[{{0.05, 0.08660254037844387}, {0.95, 0.08660254037844387}}], 
            Line[{{0.1, 0}, {0.05, 0.08660254037844387}}], 
            Line[{{0.9, 0}, {0.95, 0.08660254037844387}}]}, {
            
            Line[{{0.07500000000000001, 0.1299038105676658}, {0.925, 
             0.1299038105676658}}], 
            
            Line[{{0.15000000000000002`, 0}, {0.07500000000000001, 
              0.1299038105676658}}], 
            Line[{{0.85, 0}, {0.925, 0.1299038105676658}}]}, {
            Line[{{0.1, 0.17320508075688773`}, {0.9, 0.17320508075688773`}}], 
            Line[{{0.2, 0}, {0.1, 0.17320508075688773`}}], 
            Line[{{0.8, 0}, {0.9, 0.17320508075688773`}}]}, {
            
            Line[{{0.125, 0.21650635094610965`}, {0.875, 
             0.21650635094610965`}}], 
            Line[{{0.25, 0}, {0.125, 0.21650635094610965`}}], 
            Line[{{0.75, 0}, {0.875, 0.21650635094610965`}}]}, {
            
            Line[{{0.15000000000000002`, 0.2598076211353316}, {0.85, 
             0.2598076211353316}}], 
            
            Line[{{0.30000000000000004`, 0}, {0.15000000000000002`, 
              0.2598076211353316}}], 
            Line[{{0.7, 0}, {0.85, 0.2598076211353316}}]}, {
            
            Line[{{0.17500000000000002`, 0.30310889132455354`}, {0.825, 
             0.30310889132455354`}}], 
            
            Line[{{0.35000000000000003`, 0}, {0.17500000000000002`, 
              0.30310889132455354`}}], 
            Line[{{0.6499999999999999, 0}, {0.825, 0.30310889132455354`}}]}, {
            Line[{{0.2, 0.34641016151377546`}, {0.8, 0.34641016151377546`}}], 
            Line[{{0.4, 0}, {0.2, 0.34641016151377546`}}], 
            Line[{{0.6, 0}, {0.8, 0.34641016151377546`}}]}, {
            Line[{{0.225, 0.3897114317029974}, {0.775, 0.3897114317029974}}], 
            Line[{{0.45, 0}, {0.225, 0.3897114317029974}}], 
            Line[{{0.55, 0}, {0.775, 0.3897114317029974}}]}, {
            Line[{{0.25, 0.4330127018922193}, {0.75, 0.4330127018922193}}], 
            Line[{{0.5, 0}, {0.25, 0.4330127018922193}}], 
            Line[{{0.5, 0}, {0.75, 0.4330127018922193}}]}, {
            Line[{{0.275, 0.4763139720814413}, {0.725, 0.4763139720814413}}], 
            Line[{{0.55, 0}, {0.275, 0.4763139720814413}}], 
            Line[{{0.44999999999999996`, 0}, {0.725, 0.4763139720814413}}]}, {
            
            Line[{{0.30000000000000004`, 0.5196152422706632}, {0.7, 
             0.5196152422706632}}], 
            
            Line[{{0.6000000000000001, 0}, {0.30000000000000004`, 
              0.5196152422706632}}], 
            Line[{{0.3999999999999999, 0}, {0.7, 0.5196152422706632}}]}, {
            Line[{{0.325, 0.562916512459885}, {0.675, 0.562916512459885}}], 
            Line[{{0.65, 0}, {0.325, 0.562916512459885}}], 
            Line[{{0.35, 0}, {0.675, 0.562916512459885}}]}, {
            
            Line[{{0.35000000000000003`, 0.6062177826491071}, {
             0.6499999999999999, 0.6062177826491071}}], 
            
            Line[{{0.7000000000000001, 0}, {0.35000000000000003`, 
              0.6062177826491071}}], 
            
            Line[{{0.29999999999999993`, 0}, {0.6499999999999999, 
              0.6062177826491071}}]}, {
            Line[{{0.375, 0.649519052838329}, {0.625, 0.649519052838329}}], 
            Line[{{0.75, 0}, {0.375, 0.649519052838329}}], 
            Line[{{0.25, 0}, {0.625, 0.649519052838329}}]}, {
            Line[{{0.4, 0.6928203230275509}, {0.6, 0.6928203230275509}}], 
            Line[{{0.8, 0}, {0.4, 0.6928203230275509}}], 
            Line[{{0.19999999999999996`, 0}, {0.6, 0.6928203230275509}}]}, {
            Line[{{0.42500000000000004`, 0.7361215932167728}, {0.575, 
             0.7361215932167728}}], 
            
            Line[{{0.8500000000000001, 0}, {0.42500000000000004`, 
              0.7361215932167728}}], 
            Line[{{0.1499999999999999, 0}, {0.575, 0.7361215932167728}}]}, {
            Line[{{0.45, 0.7794228634059948}, {0.55, 0.7794228634059948}}], 
            Line[{{0.9, 0}, {0.45, 0.7794228634059948}}], 
            Line[{{0.09999999999999998, 0}, {0.55, 0.7794228634059948}}]}, {
            
            Line[{{0.47500000000000003`, 0.8227241335952167}, {
             0.5249999999999999, 0.8227241335952167}}], 
            
            Line[{{0.9500000000000001, 0}, {0.47500000000000003`, 
              0.8227241335952167}}], 
            
            Line[{{0.04999999999999993, 0}, {0.5249999999999999, 
              0.8227241335952167}}]}, {
            Line[{{0.5, 0.8660254037844386}, {0.5, 0.8660254037844386}}], 
            Line[{{1., 0}, {0.5, 0.8660254037844386}}], 
            Line[{{0., 0}, {0.5, 0.8660254037844386}}]}}}], $CellContext`base = 
       Graphics[{{
           EdgeForm[
            Thickness[Large]], 
           FaceForm[None], 
           Polygon[{{0, 0}, {0.5, Sqrt[3]/2}, {1, 0}}]}, {{{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.1, 17], {0.05, 0.08660254037844387}, {2.25, 0}], 
             
             Line[{{0.020000000000000004`, 0.08660254037844387}, {0.05, 
              0.08660254037844387}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.9, 17], {0.1, 0}, {-2.25, 0}, {1/2, -1}], 
             Line[{{0.1, 0}, {0.115, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.9, 17], {0.95, 0.08660254037844387}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.95, 0.08660254037844387}, {0.965, 
              0.11258330249197702`}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.2, 17], {0.1, 0.17320508075688773`}, {2.25, 0}], 
             Line[{{0.07, 0.17320508075688773`}, {0.1, 
              0.17320508075688773`}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.8, 17], {0.2, 0}, {-2.25, 0}, {1/2, -1}], 
             
             Line[{{0.2, 0}, {
               0.21500000000000002`, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.8, 17], {0.9, 0.17320508075688773`}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.9, 0.17320508075688773`}, {0.915, 
              0.19918584287042088`}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.30000000000000004`, 17], {0.15000000000000002`, 
              0.2598076211353316}, {2.25, 0}], 
             
             Line[{{0.12000000000000002`, 0.2598076211353316}, {
              0.15000000000000002`, 0.2598076211353316}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.7, 17], {0.30000000000000004`, 0}, {-2.25, 0}, {
              1/2, -1}], 
             
             Line[{{0.30000000000000004`, 0}, {
               0.31500000000000006`, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.7, 17], {0.85, 0.2598076211353316}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.85, 0.2598076211353316}, {0.865, 
              0.2857883832488648}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.4, 17], {0.2, 0.34641016151377546`}, {2.25, 0}], 
             
             Line[{{0.17, 0.34641016151377546`}, {0.2, 
              0.34641016151377546`}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.6, 17], {0.4, 0}, {-2.25, 0}, {1/2, -1}], 
             
             Line[{{0.4, 0}, {
               0.41500000000000004`, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.6, 17], {0.8, 0.34641016151377546`}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.8, 0.34641016151377546`}, {0.815, 
              0.37239092362730863`}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.5, 17], {0.25, 0.4330127018922193}, {2.25, 0}], 
             Line[{{0.22, 0.4330127018922193}, {0.25, 0.4330127018922193}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.5, 17], {0.5, 0}, {-2.25, 0}, {1/2, -1}], 
             Line[{{0.5, 0}, {0.515, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.5, 17], {0.75, 0.4330127018922193}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.75, 0.4330127018922193}, {0.765, 
              0.45899346400575247`}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.6, 17], {0.3, 0.5196152422706631}, {2.25, 0}], 
             Line[{{0.27, 0.5196152422706631}, {0.3, 0.5196152422706631}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.4, 17], {0.6, 0}, {-2.25, 0}, {1/2, -1}], 
             Line[{{0.6, 0}, {0.615, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.4, 17], {0.7, 0.5196152422706631}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.7, 0.5196152422706631}, {0.7150000000000001, 
              0.5455960043841963}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.7000000000000001, 17], {0.35000000000000003`, 
              0.6062177826491071}, {2.25, 0}], 
             
             Line[{{0.32000000000000006`, 0.6062177826491071}, {
              0.35000000000000003`, 0.6062177826491071}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.29999999999999993`, 17], {
              0.7000000000000001, 0}, {-2.25, 0}, {1/2, -1}], 
             
             Line[{{0.7000000000000001, 0}, {
               0.7150000000000001, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.29999999999999993`, 17], {0.6499999999999999, 
              0.6062177826491071}, {-2.25, 0}, {1.5, 2}], 
             
             Line[{{0.6499999999999999, 0.6062177826491071}, {0.665, 
              0.6321985447626403}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.8, 17], {0.4, 0.6928203230275509}, {2.25, 0}], 
             Line[{{0.37, 0.6928203230275509}, {0.4, 0.6928203230275509}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.19999999999999996`, 17], {0.8, 0}, {-2.25, 0}, {
              1/2, -1}], 
             Line[{{0.8, 0}, {0.8150000000000001, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.19999999999999996`, 17], {0.6, 
              0.6928203230275509}, {-2.25, 0}, {1.5, 2}], 
             
             Line[{{0.6, 0.6928203230275509}, {0.615, 
              0.7188010851410841}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.9, 17], {0.45, 0.7794228634059948}, {2.25, 0}], 
             
             Line[{{0.42000000000000004`, 0.7794228634059948}, {0.45, 
              0.7794228634059948}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.09999999999999998, 17], {0.9, 0}, {-2.25, 0}, {
              1/2, -1}], 
             Line[{{0.9, 0}, {0.915, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.09999999999999998, 17], {0.55, 
              0.7794228634059948}, {-2.25, 0}, {1.5, 2}], 
             
             Line[{{0.55, 0.7794228634059948}, {0.565, 
              0.8054036255195279}}]}}}, 
          Text[
           Style["solute", 17, 
            RGBColor[0, 0, 1]], {0.5, Sqrt[3]/2}, {0, -1}], 
          Text[
           Style["solvent", 17, 
            RGBColor[1, 0, 0]], {0, 0}, {1, 2}], 
          Text[
           Style["carrier", 17, 
            RGBColor[0, 0.6, 0]], {1, 0}, {-1, 2}]}], $CellContext`pt1[
         Pattern[$CellContext`pt, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]]] := {$CellContext`col, 
         PointSize[0.03], 
         Point[$CellContext`pt], White, 
         PointSize[0.015], 
         Point[$CellContext`pt]}, $CellContext`colF = 
       GrayLevel[0], $CellContext`label1[
         Pattern[$CellContext`text, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]], 
         Pattern[$CellContext`loc, 
          Blank[]]] := Text[
         Framed[
          Style[
           Row[{" ", $CellContext`text, " "}], 18, Italic, $CellContext`col], 
          Background -> White, FrameStyle -> $CellContext`col, FrameMargins -> 
          Tiny, RoundingRadius -> 15], $CellContext`loc, {
         0, -1.5}], $CellContext`table1[
         Pattern[$CellContext`title, 
          Blank[]], 
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`y, 
          Blank[]]] := Text[
         Style[
          Column[{
            Row[{$CellContext`title, " mole fractions"}], 
            Framed[
             Column[{
               Style[
                Row[{"solute = ", 
                  NumberForm[
                   $CellContext`wtA[$CellContext`y], {2, 2}]}], Blue], 
               Style[
                Row[{"solvent = ", 
                  NumberForm[
                   $CellContext`wtS[$CellContext`x, $CellContext`y], {2, 
                   2}]}], Red], 
               Style[
                Row[{"carrier = ", 
                  
                  NumberForm[$CellContext`x - $CellContext`y/Sqrt[3], {2, 
                   2}]}], 
                RGBColor[0, 0.6, 0]]}], 
             FrameMargins -> {{20, 20}, {Automatic, Automatic}}]}, Center], 
          17], {-0.05, 0.75}], $CellContext`pt2[
         Pattern[$CellContext`pt, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]]] := {$CellContext`col, 
         PointSize[0.03], 
         Point[$CellContext`pt]}, $CellContext`colS = 
       RGBColor[1, 0, 0], $CellContext`colR = 
       RGBColor[0, 0.2666666666666667, 0.4], $CellContext`label2[
         Pattern[$CellContext`text, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]], 
         Pattern[$CellContext`loc, 
          Blank[]]] := Text[
         Framed[
          Style[
           Subscript[
            Style[
             Part[$CellContext`text, 1], Italic], 
            Part[$CellContext`text, 2]], 18, $CellContext`col], Background -> 
          White, FrameStyle -> $CellContext`col, FrameMargins -> Small, 
          RoundingRadius -> 15], $CellContext`loc, {
         0, -1.5}], $CellContext`colM = GrayLevel[0.3], $CellContext`table2[
         Pattern[$CellContext`title, 
          Blank[]], 
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`y, 
          Blank[]]] := Text[
         Style[
          Column[{
            Row[{$CellContext`title, " mole fractions"}], 
            Framed[
             Column[{
               Style[
                Row[{"solute = ", 
                  NumberForm[
                   $CellContext`wtA[$CellContext`y], {2, 2}]}], Blue], 
               Style[
                Row[{"solvent = ", 
                  NumberForm[
                   $CellContext`wtS[$CellContext`x, $CellContext`y], {2, 
                   2}]}], Red], 
               Style[
                Row[{"carrier = ", 
                  
                  NumberForm[$CellContext`x - $CellContext`y/Sqrt[3], {2, 
                   2}]}], 
                RGBColor[0, 0.6, 0]]}], 
             FrameMargins -> {{20, 20}, {Automatic, Automatic}}]}, Center], 
          17], {1.05, 0.75}], $CellContext`colE1 = 
       RGBColor[1, 0.5, 0], $CellContext`colOP = 
       RGBColor[0.5, 0, 0.5], $CellContext`rafinate2 = {0.6, 
        0.3}, $CellContext`raffinate3 = {0.6, 0.3}, $CellContext`rafinate4 = {
        0.6, 0.3}, $CellContext`rafinate5 = {0.6, 
        0.3}, $CellContext`extract4 = {0.4, 0.15}, $CellContext`extract5 = {
        0.4, 0.15}, $CellContext`extract6 = {0.4, 0.15}, $CellContext`Estage = 
       1, $CellContext`Rstage = 1}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->25974513,ExpressionUUID->"754ed7de-fb90-4c70-a404-4339692130a9"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`extract1$$ = {0.4, 
    0.3}, $CellContext`extract2$$ = {0.45699999999999996`, 
    0.42600000000000005`}, $CellContext`extract3$$ = {0.44400000000000006`, 
    0.506}, $CellContext`feed$$ = {0.5, 0.7}, $CellContext`hint$$ = 
    False, $CellContext`MCR$$ = 10, $CellContext`mixing$$ = {0.5, 
    0.7}, $CellContext`operatingpt$$ = {0.5, 
    0.7}, $CellContext`raffinate1$$ = {0.6, 
    0.3}, $CellContext`raffinate2$$ = {0.6, 
    0.3}, $CellContext`raffinateN$$ = {0.5, 0.7}, $CellContext`reset$$ = 
    1, $CellContext`solution$$ = False, $CellContext`solvent$$ = {0.5, 0.7}, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`reset$$], 1}, 1, 1000, 1}, {{
       Hold[$CellContext`MCR$$], 1, ""}, {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 
      11}}, {{
       Hold[$CellContext`solution$$], False, "solution"}, {True, False}}, {{
       Hold[$CellContext`hint$$], False, "hint"}, {True, False}}, {{
       Hold[$CellContext`feed$$], {0.5, 0.7}}, Automatic}, {{
       Hold[$CellContext`solvent$$], {0.5, 0.7}}, Automatic}, {{
       Hold[$CellContext`raffinateN$$], {0.5, 0.7}}, Automatic}, {{
       Hold[$CellContext`mixing$$], {0.5, 0.7}}, Automatic}, {{
       Hold[$CellContext`extract1$$], {0.4, 0.3}}, Automatic}, {{
       Hold[$CellContext`operatingpt$$], {0.5, 0.7}}, Automatic}, {{
       Hold[$CellContext`raffinate1$$], {0.6, 0.3}}, Automatic}, {{
       Hold[$CellContext`extract2$$], {0.4, 0.15}}, Automatic}, {{
       Hold[$CellContext`raffinate2$$], {0.6, 0.3}}, Automatic}, {{
       Hold[$CellContext`extract3$$], {0.4, 0.15}}, Automatic}, {
      Hold[
       Grid[{{
          Button["new problem", {
            
            If[$CellContext`reset$$ < 
             1000, $CellContext`reset$$ = $CellContext`reset$$ + 
              1, $CellContext`reset$$ = $CellContext`reset$$ - 
              1], $CellContext`MCR$$ = 1, $CellContext`solution$$ = 
            False, $CellContext`hint$$ = 
            False, $CellContext`feed$$ = {0.5, 
             0.7}, $CellContext`solvent$$ = {0.5, 
             0.7}, $CellContext`raffinateN$$ = {0.5, 
             0.7}, $CellContext`mixing$$ = {0.5, 
             0.7}, $CellContext`extract1$$ = {0.4, 
             0.3}, $CellContext`operatingpt$$ = {0.5, 
             0.7}, $CellContext`raffinate1$$ = {0.6, 
             0.3}, $CellContext`rafinate2 = {0.6, 
             0.3}, $CellContext`raffinate3 = {0.6, 
             0.3}, $CellContext`rafinate4 = {0.6, 
             0.3}, $CellContext`rafinate5 = {0.6, 
             0.3}, $CellContext`extract2$$ = {0.4, 
             0.15}, $CellContext`extract3$$ = {0.4, 
             0.15}, $CellContext`extract4 = {0.4, 
             0.15}, $CellContext`extract5 = {0.4, 
             0.15}, $CellContext`extract6 = {0.4, 0.15}, $CellContext`Estage = 
            1, $CellContext`Rstage = 1}], 
          Manipulate`Place[1], 
          
          PaneSelector[{
           1 -> "(1) locate feed point", 2 -> "(2) locate solvent point", 3 -> 
            "(3) locate raffinate point", 4 -> "(4) locate mixing point", 5 -> 
            "(5) locate first extract point", 6 -> 
            "(6) locate operating point", 7 -> Row[{"(7) determine ", 
               Subscript[
                Style["R", Italic], 1]}], 8 -> Row[{"(8) determine ", 
               Subscript[
                Style["E", Italic], 2]}], 9 -> Row[{"(9) determine ", 
               Subscript[
                Style["R", Italic], 2]}], 10 -> Row[{"(10) determine ", 
               Subscript[
                Style["E", Italic], 3]}], 11 -> "(11) solution"}, 
           Dynamic[$CellContext`MCR$$]], 
          Manipulate`Place[2], 
          PaneSelector[{1 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 2 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 3 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 4 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 5 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 6 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 7 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 8 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 9 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}], 10 -> Button["next", {
               If[
                Inequality[
                1, LessEqual, $CellContext`MCR$$, Less, 
                 11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                 1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
               False, $CellContext`hint$$ = False}]}, 
           Dynamic[$CellContext`MCR$$]], 
          
          PaneSelector[{
           1 -> Manipulate`Place[3], 2 -> Manipulate`Place[3], 3 -> 
            Manipulate`Place[3], 4 -> Manipulate`Place[3], 5 -> 
            Manipulate`Place[3], 6 -> Manipulate`Place[3], 7 -> 
            Manipulate`Place[3], 8 -> Manipulate`Place[3], 9 -> 
            Manipulate`Place[3], 10 -> Manipulate`Place[3]}, 
           Dynamic[$CellContext`MCR$$]], 
          
          PaneSelector[{
           1 -> Manipulate`Place[4], 2 -> Manipulate`Place[4], 3 -> 
            Manipulate`Place[4], 4 -> Manipulate`Place[4], 5 -> 
            Manipulate`Place[4], 6 -> Manipulate`Place[4], 7 -> 
            Manipulate`Place[4], 8 -> Manipulate`Place[4], 9 -> 
            Manipulate`Place[4], 10 -> Manipulate`Place[4]}, 
           Dynamic[$CellContext`MCR$$]], 
          
          PaneSelector[{
           1 -> Manipulate`Place[5], 2 -> Manipulate`Place[6], 3 -> 
            Manipulate`Place[7], 4 -> Manipulate`Place[8], 5 -> 
            Manipulate`Place[9], 6 -> Manipulate`Place[10], 7 -> 
            Manipulate`Place[11], 8 -> Manipulate`Place[12], 9 -> 
            Manipulate`Place[13], 10 -> Manipulate`Place[14]}, 
           Dynamic[$CellContext`MCR$$]]}}]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    600., {193., 197.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`reset$81342$$ = 
    0, $CellContext`MCR$81343$$ = 0, $CellContext`solution$81344$$ = 
    False, $CellContext`hint$81345$$ = False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`extract1$$ = {0.4, 
         0.3}, $CellContext`extract2$$ = {0.4, 
         0.15}, $CellContext`extract3$$ = {0.4, 0.15}, $CellContext`feed$$ = {
         0.5, 0.7}, $CellContext`hint$$ = False, $CellContext`MCR$$ = 
        1, $CellContext`mixing$$ = {0.5, 0.7}, $CellContext`operatingpt$$ = {
         0.5, 0.7}, $CellContext`raffinate1$$ = {0.6, 
         0.3}, $CellContext`raffinate2$$ = {0.6, 
         0.3}, $CellContext`raffinateN$$ = {0.5, 0.7}, $CellContext`reset$$ = 
        1, $CellContext`solution$$ = 
        False, $CellContext`solvent$$ = {0.5, 0.7}}, "ControllerVariables" :> {
        Hold[$CellContext`reset$$, $CellContext`reset$81342$$, 0], 
        Hold[$CellContext`MCR$$, $CellContext`MCR$81343$$, 0], 
        Hold[$CellContext`solution$$, $CellContext`solution$81344$$, False], 
        Hold[$CellContext`hint$$, $CellContext`hint$81345$$, False]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`x1$, $CellContext`y1$, $CellContext`x2$, \
$CellContext`y2$, $CellContext`x3$, $CellContext`y3$, $CellContext`sol$, \
$CellContext`a$, $CellContext`b$, $CellContext`c$, $CellContext`phase$, \
$CellContext`yt$, $CellContext`xt$, $CellContext`tie$, \
$CellContext`phaseplot$, $CellContext`tielines$, $CellContext`F$, \
$CellContext`S$, $CellContext`M$, $CellContext`xF$, $CellContext`yF$, \
$CellContext`xRN$, $CellContext`yRN$, $CellContext`Msol$, $CellContext`xM$, \
$CellContext`yM$, $CellContext`xE$, $CellContext`yE$, $CellContext`xP$, \
$CellContext`yP$, $CellContext`operating$, $CellContext`lower$, \
$CellContext`upper$, $CellContext`lever$, $CellContext`newtie$, \
$CellContext`xtie$, $CellContext`xR$, $CellContext`yR$, $CellContext`n$, \
$CellContext`plotlabel$}, 
        SeedRandom[$CellContext`reset$$]; $CellContext`x1$ = 
         RandomReal[{0.02, 0.07}]; $CellContext`y1$ = 0; $CellContext`x2$ = 
         RandomReal[{0.45, 0.55}]; $CellContext`y2$ = 
         RandomReal[{0.3, 0.4}]; $CellContext`x3$ = 
         RandomReal[{0.85, 0.98}]; $CellContext`y3$ = 0; $CellContext`sol$ = 
         Quiet[
           Part[
            
            Solve[{$CellContext`\[Alpha] $CellContext`x1$^2 + $CellContext`\
\[Beta] $CellContext`x1$ + $CellContext`\[Chi] == $CellContext`y1$, \
$CellContext`\[Alpha] $CellContext`x2$^2 + $CellContext`\[Beta] \
$CellContext`x2$ + $CellContext`\[Chi] == $CellContext`y2$, $CellContext`\
\[Alpha] $CellContext`x3$^2 + $CellContext`\[Beta] $CellContext`x3$ + \
$CellContext`\[Chi] == $CellContext`y3$}, {$CellContext`\[Alpha], \
$CellContext`\[Beta], $CellContext`\[Chi]}], 1]]; $CellContext`a$ = 
         ReplaceAll[$CellContext`\[Alpha], $CellContext`sol$]; \
$CellContext`b$ = 
         ReplaceAll[$CellContext`\[Beta], $CellContext`sol$]; $CellContext`c$ = 
         ReplaceAll[$CellContext`\[Chi], $CellContext`sol$]; \
$CellContext`phase$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`a$ $CellContext`x$^2 + $CellContext`b$ \
$CellContext`x$ + $CellContext`c$; $CellContext`yt$[1] = 
         RandomReal[{0.02, 0.05} $CellContext`y2$]; $CellContext`xt$[1] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              1], $CellContext`x], 1]]; $CellContext`yt$[2] = 
         RandomReal[{0.06, 0.1} $CellContext`y2$]; $CellContext`xt$[2] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              2], $CellContext`x], 2]]; $CellContext`tie$[1][
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yt$[2] - $CellContext`yt$[
             1])/($CellContext`xt$[2] - $CellContext`xt$[
            1])) ($CellContext`x$ - $CellContext`xt$[1]) + $CellContext`yt$[
           1]; $CellContext`yt$[3] = 
         RandomReal[{0.15, 0.2} $CellContext`y2$]; $CellContext`xt$[3] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              3], $CellContext`x], 1]]; $CellContext`yt$[4] = 
         RandomReal[{0.25, 0.3} $CellContext`y2$]; $CellContext`xt$[4] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              4], $CellContext`x], 2]]; $CellContext`tie$[2][
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yt$[4] - $CellContext`yt$[
             3])/($CellContext`xt$[4] - $CellContext`xt$[
            3])) ($CellContext`x$ - $CellContext`xt$[3]) + $CellContext`yt$[
           3]; $CellContext`yt$[5] = 
         RandomReal[{0.35, 0.4} $CellContext`y2$]; $CellContext`xt$[5] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              5], $CellContext`x], 1]]; $CellContext`yt$[6] = 
         RandomReal[{0.5, 0.55} $CellContext`y2$]; $CellContext`xt$[6] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              6], $CellContext`x], 2]]; $CellContext`tie$[3][
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yt$[6] - $CellContext`yt$[
             5])/($CellContext`xt$[6] - $CellContext`xt$[
            5])) ($CellContext`x$ - $CellContext`xt$[5]) + $CellContext`yt$[
           5]; $CellContext`yt$[7] = 
         RandomReal[{0.72, 0.77} $CellContext`y2$]; $CellContext`xt$[7] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              7], $CellContext`x], 1]]; $CellContext`yt$[8] = 
         RandomReal[{0.8, 0.9} $CellContext`y2$]; $CellContext`xt$[8] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`phase$[$CellContext`x] == $CellContext`yt$[
              8], $CellContext`x], 2]]; $CellContext`tie$[4][
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yt$[8] - $CellContext`yt$[
             7])/($CellContext`xt$[8] - $CellContext`xt$[
            7])) ($CellContext`x$ - $CellContext`xt$[7]) + $CellContext`yt$[
           7]; $CellContext`phaseplot$ = Plot[
           $CellContext`phase$[$CellContext`x], {$CellContext`x, \
$CellContext`x1$, $CellContext`x3$}, PlotStyle -> {Thick, Black}, 
           PlotRange -> {{0, 1}, {0, Sqrt[3]/2}}]; $CellContext`tielines$ = 
         Graphics[{
            Thickness[0.004], 
            Line[{{
               $CellContext`xt$[1], 
               $CellContext`yt$[1]}, {
               $CellContext`xt$[2], 
               $CellContext`yt$[2]}}], 
            Line[{{
               $CellContext`xt$[3], 
               $CellContext`yt$[3]}, {
               $CellContext`xt$[4], 
               $CellContext`yt$[4]}}], 
            Line[{{
               $CellContext`xt$[5], 
               $CellContext`yt$[5]}, {
               $CellContext`xt$[6], 
               $CellContext`yt$[6]}}], 
            Line[{{
               $CellContext`xt$[7], 
               $CellContext`yt$[7]}, {
               $CellContext`xt$[8], 
               $CellContext`yt$[8]}}]}]; $CellContext`F$ = 
         RandomInteger[{1000, 1500}]; $CellContext`S$ = 
         RandomInteger[{1500, 
           2000}]; $CellContext`M$ = $CellContext`F$ + $CellContext`S$; \
$CellContext`xF$ = RandomReal[{0.6, 0.7}]; $CellContext`yF$ = 
         RandomReal[{0.4, 0.45}]; $CellContext`xRN$ = 
         0.99 $CellContext`x3$; $CellContext`yRN$ = \
$CellContext`phase$[$CellContext`xRN$]; $CellContext`Msol$ = Quiet[
           First[
            Solve[
             
             And[$CellContext`wtA[$CellContext`yF$] $CellContext`F$ == \
$CellContext`xA $CellContext`M$, $CellContext`wtS[$CellContext`xF$, \
$CellContext`yF$] $CellContext`F$ + $CellContext`S$ == $CellContext`xS \
$CellContext`M$, $CellContext`xA + $CellContext`xS + $CellContext`xC == 
              1], {$CellContext`xA, $CellContext`xS, $CellContext`xC}]]]; \
$CellContext`xM$ = 
         1 - ReplaceAll[$CellContext`xS, $CellContext`Msol$] - \
$CellContext`yM$/Sqrt[3]; $CellContext`yM$ = 
         ReplaceAll[(Sqrt[3]/
            2) $CellContext`xA, $CellContext`Msol$]; $CellContext`xE$[1] = 
         ReplaceAll[$CellContext`x, 
           Quiet[
            First[
             
             Solve[$CellContext`phase$[$CellContext`x] == (($CellContext`yRN$ - \
$CellContext`yM$)/($CellContext`xRN$ - $CellContext`xM$)) ($CellContext`x - \
$CellContext`xRN$) + $CellContext`yRN$, $CellContext`x]]]]; $CellContext`yE$[
          1] = $CellContext`phase$[
           $CellContext`xE$[1]]; $CellContext`xP$ = ReplaceAll[$CellContext`x, 
           Quiet[
            First[
             
             Solve[(($CellContext`yF$ - $CellContext`yE$[
                  1])/($CellContext`xF$ - $CellContext`xE$[
                 1])) ($CellContext`x - $CellContext`xF$) + $CellContext`yF$ == \
($CellContext`yRN$/$CellContext`xRN$) $CellContext`x, $CellContext`x]]]]; \
$CellContext`yP$ = ($CellContext`yRN$/$CellContext`xRN$) $CellContext`xP$; \
$CellContext`operating$[
           Pattern[$CellContext`i$, 
            Blank[]], 
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yR$[$CellContext`i$] - \
$CellContext`yP$)/($CellContext`xR$[$CellContext`i$] - $CellContext`xP$)) \
($CellContext`x$ - $CellContext`xP$) + $CellContext`yP$; $CellContext`lower$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Which[Part[$CellContext`pt$, 2] <= $CellContext`tie$[1][
             Part[$CellContext`pt$, 1]], 0, 
           Inequality[
            $CellContext`tie$[1][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[2][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[1][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[2][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[3][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[2][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[3][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[3][$CellContext`x$], $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]] < Part[$CellContext`pt$, 2], 
           $CellContext`tie$[4][$CellContext`x$]]; $CellContext`upper$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         Which[Part[$CellContext`pt$, 2] < $CellContext`tie$[1][
             Part[$CellContext`pt$, 1]], 
           $CellContext`tie$[1][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[1][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[2][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[2][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[2][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[3][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[3][$CellContext`x$], 
           Inequality[
            $CellContext`tie$[3][
             Part[$CellContext`pt$, 1]], Less, 
            Part[$CellContext`pt$, 2], LessEqual, 
            $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]]], 
           $CellContext`tie$[4][$CellContext`x$], $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]] < Part[$CellContext`pt$, 2], 
           $CellContext`tie$[4][$CellContext`x$]]; $CellContext`lever$[
           Pattern[$CellContext`pt$, 
            Blank[]]] := If[Part[$CellContext`pt$, 2] >= $CellContext`tie$[4][
             Part[$CellContext`pt$, 1]], 
           1, (Part[$CellContext`pt$, 
              2] - $CellContext`upper$[$CellContext`pt$, 
             
             Part[$CellContext`pt$, 
              1]])/($CellContext`lower$[$CellContext`pt$, 
             
             Part[$CellContext`pt$, 
              1]] - $CellContext`upper$[$CellContext`pt$, 
            Part[$CellContext`pt$, 1]])]; $CellContext`newtie$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`lever$[$CellContext`pt$] \
$CellContext`lower$[$CellContext`pt$, $CellContext`x$] + (
            1 - $CellContext`lever$[$CellContext`pt$]) \
$CellContext`upper$[$CellContext`pt$, $CellContext`x$]; $CellContext`xtie$[
           Pattern[$CellContext`pt$, 
            Blank[]], 
           Pattern[$CellContext`i$, 
            Blank[]]] := ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`newtie$[$CellContext`pt$, $CellContext`x] == \
$CellContext`phase$[$CellContext`x], $CellContext`x], $CellContext`i$]]; \
$CellContext`xR$[1] = ReplaceAll[$CellContext`x, 
           Part[
            Solve[$CellContext`newtie$[{
                $CellContext`xE$[1], 
                $CellContext`yE$[
                1]}, $CellContext`x] == $CellContext`phase$[$CellContext`x], \
$CellContext`x], 2]]; $CellContext`yR$[1] = $CellContext`phase$[
           $CellContext`xR$[1]]; $CellContext`xE$[2] = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`operating$[
              1, $CellContext`x] == $CellContext`phase$[$CellContext`x], \
$CellContext`x], 1]]; $CellContext`yE$[2] = $CellContext`phase$[
           $CellContext`xE$[2]]; 
        Map[If[$CellContext`xR$[# - 
             1] < $CellContext`xRN$, {$CellContext`xR$[#] = 
             ReplaceAll[$CellContext`x, 
               Part[
                Solve[$CellContext`newtie$[{
                    $CellContext`xE$[#], 
                    $CellContext`yE$[#]}, $CellContext`x] == \
$CellContext`phase$[$CellContext`x], $CellContext`x], 
                2]]; $CellContext`yR$[#] = $CellContext`phase$[
               $CellContext`xR$[#]]; $CellContext`xE$[# + 1] = 
             ReplaceAll[$CellContext`x, 
               Part[
                
                Solve[$CellContext`operating$[#, $CellContext`x] == \
$CellContext`phase$[$CellContext`x], $CellContext`x], 1]]; $CellContext`yE$[# + 
               1] = $CellContext`phase$[
               $CellContext`xE$[# + 1]]; Null}]& , 
          Range[2, 10]]; $CellContext`n$ = Part[
           DeleteCases[
            Map[If[$CellContext`xR$[#] < $CellContext`xRN$, 0, #]& , 
             Range[10]], 0], 1]; 
        If[$CellContext`n$ == 
          8, $CellContext`reset$$ = $CellContext`reset$$ + 
           1]; $CellContext`plotlabel$ = Switch[$CellContext`MCR$$, 1, 
           If[$CellContext`hint$$, "hint: read the compositions on the axes", 
            Row[{"Step 1: move the feed point ", 
              Style["F", Italic], 
              " to \nthe correct location, then check solution"}]], 2, 
           If[$CellContext`hint$$, "hint: read the compositions on the axes", 
            Row[{"Step 2: move the solvent point ", 
              Style["S", Italic], 
              " to \nthe correct location, then check solution"}]], 3, 
           If[$CellContext`hint$$, "hint: read the compositions on the axes", 
            Row[{"Step 3: move the desired raffinate point ", 
              Subscript[
               Style["R", Italic], "N"], 
              " to \nthe correct location, then check solution"}]], 4, 
           If[$CellContext`hint$$, "hint: use the lever rule", 
            Row[{"Step 4: use mass balance for two entering streams (", 
              Style["F", Italic], ", ", 
              Style["S", Italic], ")\n to determine the average composition ", 
              Style["M", Italic], ", then check solution"}]], 5, 
           If[$CellContext`hint$$, 
            Row[{"hint: use mass balance for two exit streams (", 
              Subscript[
               Style["R", Italic], "N"], ", ", 
              Subscript[
               Style["E", Italic], 1], ")"}], 
            Row[{"Step 5: move the point for the first extract composition ", 
              Subscript[
               Style["E", Italic], 1], 
              "\n to the correct location, then check solution"}]], 6, 
           If[$CellContext`hint$$, 
            
            Row[{"hint: the operating point is at the intersection of \na \
line through ", 
              Style["F", Italic], " and ", 
              Subscript[
               Style["E", Italic], 1], " and a line through ", 
              Style["S", Italic], " and ", 
              Subscript[
               Style["R", Italic], "N"]}], 
            Row[{"Step 6: move the operating point ", 
              Style["P", Italic], 
              " \nto the correct location, then check solution"}]], 7, 
           
           If[$CellContext`hint$$, 
            "hint: follow the tie line to the other side of the phase \
boundary", 
            "Step 7: move the blue point to the correct raffinate \
composition"], 8, 
           
           If[$CellContext`hint$$, "hint: draw a line to the operating point",
             "Step 8: move the yellow point to the correct extract \
composition"], 9, 
           
           If[$CellContext`hint$$, 
            "hint: follow the tie line to the other side of the phase \
boundary", 
            "Step 9: move the blue point to the correct raffinate \
composition"], 10, 
           
           If[$CellContext`hint$$, "hint: draw a line to the operating point",
             "Step 10: move the yellow point to the correct extract \
composition"], 11, 
           Row[{$CellContext`n$, " stages needed"}]]; Show[
          
          If[$CellContext`MCR$$ <= 
           4, $CellContext`gridLines, {}], $CellContext`base, \
$CellContext`phaseplot$, $CellContext`tielines$, ImageSize -> {600, 390}, 
          PlotRange -> {{-0.25, 1.15}, {-0.1, 0.93}}, 
          ImagePadding -> {{55, 55}, {5, 
             If[$CellContext`hint$$, 
              If[$CellContext`MCR$$ == 6, 15, 35], 
              If[3 <= $CellContext`MCR$$ <= 5, 15, 35]]}}, PlotLabel -> 
          Style[$CellContext`plotlabel$, 17, Black], Epilog -> {Thick, 
            If[$CellContext`MCR$$ == 1, {
              $CellContext`pt1[$CellContext`feed$$, $CellContext`colF], 
              $CellContext`label1[
              "F", $CellContext`colF, $CellContext`feed$$], 
              $CellContext`table1["feed", $CellContext`xF$, $CellContext`yF$], 
              If[$CellContext`solution$$, 
               $CellContext`pt2[{$CellContext`xF$, $CellContext`yF$}, \
$CellContext`colF]]}], 
            If[$CellContext`MCR$$ > 1, {
              $CellContext`pt2[{$CellContext`xF$, $CellContext`yF$}, \
$CellContext`colF], 
              $CellContext`label1[
              "F", $CellContext`colF, {$CellContext`xF$, $CellContext`yF$}]}], 
            If[$CellContext`MCR$$ == 2, {
              $CellContext`pt1[$CellContext`solvent$$, $CellContext`colS], 
              $CellContext`label1[
              "S", $CellContext`colS, $CellContext`solvent$$], 
              $CellContext`table1["solvent", 0, 0], 
              If[$CellContext`solution$$, 
               $CellContext`pt2[{0, 0}, $CellContext`colS]]}], 
            If[$CellContext`MCR$$ > 2, {
              $CellContext`pt2[{0, 0}, $CellContext`colS], 
              $CellContext`label1["S", $CellContext`colS, {0, 0}]}], 
            If[$CellContext`MCR$$ == 3, {
              $CellContext`pt1[$CellContext`raffinateN$$, $CellContext`colR], 
              $CellContext`label2[{
               "R", "N"}, $CellContext`colR, $CellContext`raffinateN$$], 
              $CellContext`table1[
              "raffinate", $CellContext`xRN$, $CellContext`yRN$], 
              If[$CellContext`solution$$, 
               $CellContext`pt2[{$CellContext`xRN$, $CellContext`yRN$}, \
$CellContext`colR]]}], 
            If[$CellContext`MCR$$ > 3, {
              $CellContext`pt2[{$CellContext`xRN$, $CellContext`yRN$}, \
$CellContext`colR], 
              $CellContext`label2[{
               "R", "N"}, $CellContext`colR, {$CellContext`xRN$, \
$CellContext`yRN$}]}], 
            If[$CellContext`MCR$$ == 4, {{Dashed, $CellContext`colM, 
               Line[{{$CellContext`xF$, $CellContext`yF$}, {0, 0}}]}, 
              $CellContext`pt1[$CellContext`mixing$$, $CellContext`colM], 
              $CellContext`label1[
              "M", $CellContext`colM, $CellContext`mixing$$], 
              $CellContext`table2["mixing", 
               Part[$CellContext`mixing$$, 1], 
               Part[$CellContext`mixing$$, 2]], 
              Text[
               Style[
                Column[{"flow rates", 
                  Framed[
                   Column[{
                    Style[
                    Row[{
                    Style["F", Italic], " = ", 
                    NumberForm[$CellContext`F$, {4, 0}], 
                    " kg/h"}], $CellContext`colF], 
                    Style[
                    Row[{
                    Style["S", Italic], " = ", 
                    NumberForm[$CellContext`S$, {4, 0}], 
                    " kg/h"}], $CellContext`colS]}, Alignment -> "="]]}, 
                 Center], 17], {-0.05, 0.75}], 
              If[$CellContext`solution$$, 
               $CellContext`pt2[{$CellContext`xM$, $CellContext`yM$}, \
$CellContext`colM]]}], 
            If[$CellContext`MCR$$ == 5, {
              $CellContext`pt2[{$CellContext`xM$, $CellContext`yM$}, \
$CellContext`colM], 
              $CellContext`label1[
              "M", $CellContext`colM, {$CellContext`xM$, $CellContext`yM$}], \
{$CellContext`colE1, 
               
               Arrow[{{$CellContext`xRN$, $CellContext`yRN$}, \
$CellContext`extract1$$}]}, 
              $CellContext`pt1[$CellContext`extract1$$, $CellContext`colE1], 
              $CellContext`label2[{
               "E", 1}, $CellContext`colE1, $CellContext`extract1$$], 
              If[$CellContext`solution$$, 
               $CellContext`pt2[{
                 $CellContext`xE$[1], 
                 $CellContext`yE$[1]}, $CellContext`colE1]]}], 
            If[$CellContext`MCR$$ > 5, {
              $CellContext`pt2[{
                $CellContext`xE$[1], 
                $CellContext`yE$[1]}, $CellContext`colE1], 
              $CellContext`label2[{"E", 1}, $CellContext`colE1, {
                $CellContext`xE$[1], 
                $CellContext`yE$[1]}]}], 
            If[$CellContext`MCR$$ == 6, {{
               Thickness[0.007], Dotted, $CellContext`colOP, 
               
               Line[{$CellContext`operatingpt$$, {$CellContext`xF$, \
$CellContext`yF$}}], 
               
               Line[{$CellContext`operatingpt$$, {$CellContext`xRN$, \
$CellContext`yRN$}}]}, 
              $CellContext`pt1[$CellContext`operatingpt$$, \
$CellContext`colOP], 
              $CellContext`label1[
              "P", $CellContext`colOP, $CellContext`operatingpt$$], 
              If[$CellContext`solution$$, {Dashed, $CellContext`colOP, 
                
                Line[{{$CellContext`xP$, $CellContext`yP$}, \
{$CellContext`xF$, $CellContext`yF$}}], 
                
                Line[{{$CellContext`xP$, $CellContext`yP$}, \
{$CellContext`xRN$, $CellContext`yRN$}}], 
                $CellContext`pt2[{$CellContext`xP$, $CellContext`yP$}, \
$CellContext`colOP]}]}], 
            If[6 < $CellContext`MCR$$ < 11, {
              $CellContext`pt2[{$CellContext`xP$, $CellContext`yP$}, \
$CellContext`colOP], 
              $CellContext`label1[
              "P", $CellContext`colOP, {$CellContext`xP$, \
$CellContext`yP$}]}], 
            If[$CellContext`MCR$$ == 7, {{$CellContext`colR, Dashed, 
               Line[{{
                  $CellContext`xE$[1], 
                  $CellContext`yE$[1]}, $CellContext`raffinate1$$}]}, 
              $CellContext`pt1[$CellContext`raffinate1$$, $CellContext`colR], 
              $CellContext`label2[{"R", 1}, $CellContext`colR, 
               If[$CellContext`solution$$, {
                 $CellContext`xR$[1], 
                 $CellContext`yR$[1]}, $CellContext`raffinate1$$]], 
              If[$CellContext`solution$$, {$CellContext`colR, Dashed, 
                Line[{{
                   $CellContext`xE$[1], 
                   $CellContext`yE$[1]}, {
                   $CellContext`xR$[1], 
                   $CellContext`yR$[1]}}], 
                $CellContext`pt2[{
                  $CellContext`xR$[1], 
                  $CellContext`yR$[1]}, $CellContext`colR]}]}], 
            If[7 < $CellContext`MCR$$ < 11, {{$CellContext`colR, Dashed, 
               Line[{{
                  $CellContext`xE$[1], 
                  $CellContext`yE$[1]}, {
                  $CellContext`xR$[1], 
                  $CellContext`yR$[1]}}]}, 
              $CellContext`pt2[{
                $CellContext`xR$[1], 
                $CellContext`yR$[1]}, $CellContext`colR], 
              $CellContext`label2[{"R", 1}, $CellContext`colR, {
                $CellContext`xR$[1], 
                $CellContext`yR$[1]}]}], 
            If[$CellContext`MCR$$ == 8, {{$CellContext`colE1, Dashed, 
               Line[{{
                  $CellContext`xR$[1], 
                  $CellContext`yR$[
                  1]}, {$CellContext`xP$, $CellContext`yP$}}]}, 
              $CellContext`pt1[$CellContext`extract2$$, $CellContext`colE1], 
              $CellContext`label2[{"E", 2}, $CellContext`colE1, 
               If[$CellContext`solution$$, {
                 $CellContext`xE$[2], 
                 $CellContext`yE$[2]}, $CellContext`extract2$$]], 
              If[$CellContext`solution$$, {{$CellContext`colE1, Dashed, 
                 Line[{{
                    $CellContext`xR$[1], 
                    $CellContext`yR$[1]}, {
                    $CellContext`xE$[2], 
                    $CellContext`yE$[2]}}]}, 
                $CellContext`pt2[{
                  $CellContext`xE$[2], 
                  $CellContext`yE$[2]}, $CellContext`colE1]}]}], 
            If[8 < $CellContext`MCR$$ < 11, {{$CellContext`colE1, Dashed, 
               Line[{{
                  $CellContext`xR$[1], 
                  $CellContext`yR$[1]}, {
                  $CellContext`xE$[2], 
                  $CellContext`yE$[2]}}]}, 
              $CellContext`pt2[{
                $CellContext`xE$[2], 
                $CellContext`yE$[2]}, $CellContext`colE1], 
              $CellContext`label2[{"E", 2}, $CellContext`colE1, {
                $CellContext`xE$[2], 
                $CellContext`yE$[2]}]}], 
            If[$CellContext`MCR$$ == 9, {{$CellContext`colR, Dashed, 
               Line[{{
                  $CellContext`xE$[2], 
                  $CellContext`yE$[2]}, $CellContext`raffinate2$$}]}, 
              $CellContext`pt1[$CellContext`raffinate2$$, $CellContext`colR], 
              $CellContext`label2[{"R", 2}, $CellContext`colR, 
               If[$CellContext`solution$$, {
                 $CellContext`xR$[2], 
                 $CellContext`yR$[2]}, $CellContext`raffinate2$$]], 
              If[$CellContext`solution$$, {$CellContext`colR, Dashed, 
                Line[{{
                   $CellContext`xE$[2], 
                   $CellContext`yE$[2]}, {
                   $CellContext`xR$[2], 
                   $CellContext`yR$[2]}}], 
                $CellContext`pt2[{
                  $CellContext`xR$[2], 
                  $CellContext`yR$[2]}, $CellContext`colR]}]}], 
            If[9 < $CellContext`MCR$$ < 11, {{$CellContext`colR, Dashed, 
               Line[{{
                  $CellContext`xE$[2], 
                  $CellContext`yE$[2]}, {
                  $CellContext`xR$[2], 
                  $CellContext`yR$[2]}}]}, 
              $CellContext`pt2[{
                $CellContext`xR$[2], 
                $CellContext`yR$[2]}, $CellContext`colR], 
              $CellContext`label2[{"R", 2}, $CellContext`colR, {
                $CellContext`xR$[2], 
                $CellContext`yR$[2]}]}], 
            If[$CellContext`MCR$$ == 10, {{$CellContext`colE1, Dashed, 
               Line[{{
                  $CellContext`xR$[2], 
                  $CellContext`yR$[
                  2]}, {$CellContext`xP$, $CellContext`yP$}}]}, 
              $CellContext`pt1[$CellContext`extract3$$, $CellContext`colE1], 
              $CellContext`label2[{"E", 3}, $CellContext`colE1, 
               If[$CellContext`solution$$, {
                 $CellContext`xE$[3], 
                 $CellContext`yE$[3]}, $CellContext`extract3$$]], 
              If[$CellContext`solution$$, {{$CellContext`colE1, Dashed, 
                 Line[{{
                    $CellContext`xR$[2], 
                    $CellContext`yR$[2]}, {
                    $CellContext`xE$[3], 
                    $CellContext`yE$[3]}}]}, 
                $CellContext`pt2[{
                  $CellContext`xE$[3], 
                  $CellContext`yE$[3]}, $CellContext`colE1]}]}], 
            If[$CellContext`MCR$$ == 11, {
              Map[{Dashed, $CellContext`colE1, 
                Line[{{
                   $CellContext`xE$[#], 
                   $CellContext`yE$[#]}, {
                   $CellContext`xR$[#], 
                   $CellContext`yR$[#]}}], $CellContext`colR, 
                Line[{{
                   $CellContext`xR$[#], 
                   $CellContext`yR$[#]}, {
                   $CellContext`xE$[# + 1], 
                   $CellContext`yE$[# + 1]}}]}& , 
               Range[$CellContext`n$]], 
              Map[{
                $CellContext`pt2[{
                  $CellContext`xE$[#], 
                  $CellContext`yE$[#]}, $CellContext`colE1], 
                $CellContext`label2[{"E", #}, $CellContext`colE1, {
                  $CellContext`xE$[#], 
                  $CellContext`yE$[#]}]}& , 
               Range[2, $CellContext`n$]], 
              Map[{
                $CellContext`pt2[{
                  $CellContext`xR$[#], 
                  $CellContext`yR$[#]}, $CellContext`colR], 
                $CellContext`label2[{"R", #}, $CellContext`colR, {
                  $CellContext`xR$[#], 
                  $CellContext`yR$[#]}]}& , 
               Range[$CellContext`n$]], 
              Map[Text[
                Style[
                 Row[{" ", #, " "}], 18, Background -> 
                 White], {$CellContext`xE$[#] + $CellContext`xR$[#], \
$CellContext`yE$[#] + $CellContext`yR$[#]}/2, {0, -1.5}]& , 
               Range[$CellContext`n$]]}]}]], 
      "Specifications" :> {{{$CellContext`reset$$, 1}, 1, 1000, 1, 
         ControlType -> None, ControlPlacement -> 
         1}, {{$CellContext`MCR$$, 1, ""}, {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 
         11}, ControlType -> None, ControlPlacement -> 
         2}, {{$CellContext`solution$$, False, "solution"}, {True, False}, 
         Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         3}, {{$CellContext`hint$$, False, "hint"}, {True, False}, 
         ControlPlacement -> 4}, {{$CellContext`feed$$, {0.5, 0.7}}, 
         Automatic, ControlType -> Locator, Appearance -> None, Enabled -> 
         Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         5}, {{$CellContext`solvent$$, {0.5, 0.7}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         6}, {{$CellContext`raffinateN$$, {0.5, 0.7}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         7}, {{$CellContext`mixing$$, {0.5, 0.7}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         8}, {{$CellContext`extract1$$, {0.4, 0.3}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         9}, {{$CellContext`operatingpt$$, {0.5, 0.7}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         10}, {{$CellContext`raffinate1$$, {0.6, 0.3}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         11}, {{$CellContext`extract2$$, {0.4, 0.15}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         12}, {{$CellContext`raffinate2$$, {0.6, 0.3}}, Automatic, 
         ControlType -> Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 
         13}, {{$CellContext`extract3$$, {0.4, 0.15}}, Automatic, ControlType -> 
         Locator, Appearance -> None, Enabled -> Dynamic[
           If[$CellContext`solution$$, False, True]], ControlPlacement -> 14}, 
        Grid[{{
           Button["new problem", {
             
             If[$CellContext`reset$$ < 
              1000, $CellContext`reset$$ = $CellContext`reset$$ + 
               1, $CellContext`reset$$ = $CellContext`reset$$ - 
               1], $CellContext`MCR$$ = 1, $CellContext`solution$$ = 
             False, $CellContext`hint$$ = 
             False, $CellContext`feed$$ = {0.5, 
              0.7}, $CellContext`solvent$$ = {0.5, 
              0.7}, $CellContext`raffinateN$$ = {0.5, 
              0.7}, $CellContext`mixing$$ = {0.5, 
              0.7}, $CellContext`extract1$$ = {0.4, 
              0.3}, $CellContext`operatingpt$$ = {0.5, 
              0.7}, $CellContext`raffinate1$$ = {0.6, 
              0.3}, $CellContext`rafinate2 = {0.6, 
              0.3}, $CellContext`raffinate3 = {0.6, 
              0.3}, $CellContext`rafinate4 = {0.6, 
              0.3}, $CellContext`rafinate5 = {0.6, 
              0.3}, $CellContext`extract2$$ = {0.4, 
              0.15}, $CellContext`extract3$$ = {0.4, 
              0.15}, $CellContext`extract4 = {0.4, 
              0.15}, $CellContext`extract5 = {0.4, 
              0.15}, $CellContext`extract6 = {0.4, 0.15}, $CellContext`Estage = 
             1, $CellContext`Rstage = 1}], 
           Manipulate`Place[1], 
           
           PaneSelector[{
            1 -> "(1) locate feed point", 2 -> "(2) locate solvent point", 3 -> 
             "(3) locate raffinate point", 4 -> "(4) locate mixing point", 5 -> 
             "(5) locate first extract point", 6 -> 
             "(6) locate operating point", 7 -> Row[{"(7) determine ", 
                Subscript[
                 Style["R", Italic], 1]}], 8 -> Row[{"(8) determine ", 
                Subscript[
                 Style["E", Italic], 2]}], 9 -> Row[{"(9) determine ", 
                Subscript[
                 Style["R", Italic], 2]}], 10 -> Row[{"(10) determine ", 
                Subscript[
                 Style["E", Italic], 3]}], 11 -> "(11) solution"}, 
            Dynamic[$CellContext`MCR$$]], 
           Manipulate`Place[2], 
           PaneSelector[{1 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 2 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 3 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 4 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 5 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 6 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 7 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 8 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 9 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}], 10 -> Button["next", {
                If[
                 Inequality[
                 1, LessEqual, $CellContext`MCR$$, Less, 
                  11], $CellContext`MCR$$ = $CellContext`MCR$$ + 
                  1, $CellContext`MCR$$ = 11], $CellContext`solution$$ = 
                False, $CellContext`hint$$ = False}]}, 
            Dynamic[$CellContext`MCR$$]], 
           
           PaneSelector[{
            1 -> Manipulate`Place[3], 2 -> Manipulate`Place[3], 3 -> 
             Manipulate`Place[3], 4 -> Manipulate`Place[3], 5 -> 
             Manipulate`Place[3], 6 -> Manipulate`Place[3], 7 -> 
             Manipulate`Place[3], 8 -> Manipulate`Place[3], 9 -> 
             Manipulate`Place[3], 10 -> Manipulate`Place[3]}, 
            Dynamic[$CellContext`MCR$$]], 
           
           PaneSelector[{
            1 -> Manipulate`Place[4], 2 -> Manipulate`Place[4], 3 -> 
             Manipulate`Place[4], 4 -> Manipulate`Place[4], 5 -> 
             Manipulate`Place[4], 6 -> Manipulate`Place[4], 7 -> 
             Manipulate`Place[4], 8 -> Manipulate`Place[4], 9 -> 
             Manipulate`Place[4], 10 -> Manipulate`Place[4]}, 
            Dynamic[$CellContext`MCR$$]], 
           
           PaneSelector[{
            1 -> Manipulate`Place[5], 2 -> Manipulate`Place[6], 3 -> 
             Manipulate`Place[7], 4 -> Manipulate`Place[8], 5 -> 
             Manipulate`Place[9], 6 -> Manipulate`Place[10], 7 -> 
             Manipulate`Place[11], 8 -> Manipulate`Place[12], 9 -> 
             Manipulate`Place[13], 10 -> Manipulate`Place[14]}, 
            Dynamic[$CellContext`MCR$$]]}}]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{649., {242., 248.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({
      Attributes[PlotRange] = {ReadProtected}, $CellContext`wtA[
         Pattern[$CellContext`y, 
          Blank[]]] := $CellContext`y (2/Sqrt[3]), $CellContext`wtS[
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`y, 
          Blank[]]] := 1 - ($CellContext`x + $CellContext`y/Sqrt[3]), 
       Attributes[Subscript] = {NHoldRest}, $CellContext`gridLines = Graphics[{
          Thickness[Tiny], 
          GrayLevel[0.7], {{
            Line[{{0., 0.}, {1., 0.}}], 
            Line[{{0., 0}, {0., 0.}}], 
            Line[{{1., 0}, {1., 0.}}]}, {
            
            Line[{{0.025, 0.04330127018922193}, {0.975, 
             0.04330127018922193}}], 
            Line[{{0.05, 0}, {0.025, 0.04330127018922193}}], 
            Line[{{0.95, 0}, {0.975, 0.04330127018922193}}]}, {
            Line[{{0.05, 0.08660254037844387}, {0.95, 0.08660254037844387}}], 
            Line[{{0.1, 0}, {0.05, 0.08660254037844387}}], 
            Line[{{0.9, 0}, {0.95, 0.08660254037844387}}]}, {
            
            Line[{{0.07500000000000001, 0.1299038105676658}, {0.925, 
             0.1299038105676658}}], 
            
            Line[{{0.15000000000000002`, 0}, {0.07500000000000001, 
              0.1299038105676658}}], 
            Line[{{0.85, 0}, {0.925, 0.1299038105676658}}]}, {
            Line[{{0.1, 0.17320508075688773`}, {0.9, 0.17320508075688773`}}], 
            Line[{{0.2, 0}, {0.1, 0.17320508075688773`}}], 
            Line[{{0.8, 0}, {0.9, 0.17320508075688773`}}]}, {
            
            Line[{{0.125, 0.21650635094610965`}, {0.875, 
             0.21650635094610965`}}], 
            Line[{{0.25, 0}, {0.125, 0.21650635094610965`}}], 
            Line[{{0.75, 0}, {0.875, 0.21650635094610965`}}]}, {
            
            Line[{{0.15000000000000002`, 0.2598076211353316}, {0.85, 
             0.2598076211353316}}], 
            
            Line[{{0.30000000000000004`, 0}, {0.15000000000000002`, 
              0.2598076211353316}}], 
            Line[{{0.7, 0}, {0.85, 0.2598076211353316}}]}, {
            
            Line[{{0.17500000000000002`, 0.30310889132455354`}, {0.825, 
             0.30310889132455354`}}], 
            
            Line[{{0.35000000000000003`, 0}, {0.17500000000000002`, 
              0.30310889132455354`}}], 
            Line[{{0.6499999999999999, 0}, {0.825, 0.30310889132455354`}}]}, {
            Line[{{0.2, 0.34641016151377546`}, {0.8, 0.34641016151377546`}}], 
            Line[{{0.4, 0}, {0.2, 0.34641016151377546`}}], 
            Line[{{0.6, 0}, {0.8, 0.34641016151377546`}}]}, {
            Line[{{0.225, 0.3897114317029974}, {0.775, 0.3897114317029974}}], 
            Line[{{0.45, 0}, {0.225, 0.3897114317029974}}], 
            Line[{{0.55, 0}, {0.775, 0.3897114317029974}}]}, {
            Line[{{0.25, 0.4330127018922193}, {0.75, 0.4330127018922193}}], 
            Line[{{0.5, 0}, {0.25, 0.4330127018922193}}], 
            Line[{{0.5, 0}, {0.75, 0.4330127018922193}}]}, {
            Line[{{0.275, 0.4763139720814413}, {0.725, 0.4763139720814413}}], 
            Line[{{0.55, 0}, {0.275, 0.4763139720814413}}], 
            Line[{{0.44999999999999996`, 0}, {0.725, 0.4763139720814413}}]}, {
            
            Line[{{0.30000000000000004`, 0.5196152422706632}, {0.7, 
             0.5196152422706632}}], 
            
            Line[{{0.6000000000000001, 0}, {0.30000000000000004`, 
              0.5196152422706632}}], 
            Line[{{0.3999999999999999, 0}, {0.7, 0.5196152422706632}}]}, {
            Line[{{0.325, 0.562916512459885}, {0.675, 0.562916512459885}}], 
            Line[{{0.65, 0}, {0.325, 0.562916512459885}}], 
            Line[{{0.35, 0}, {0.675, 0.562916512459885}}]}, {
            
            Line[{{0.35000000000000003`, 0.6062177826491071}, {
             0.6499999999999999, 0.6062177826491071}}], 
            
            Line[{{0.7000000000000001, 0}, {0.35000000000000003`, 
              0.6062177826491071}}], 
            
            Line[{{0.29999999999999993`, 0}, {0.6499999999999999, 
              0.6062177826491071}}]}, {
            Line[{{0.375, 0.649519052838329}, {0.625, 0.649519052838329}}], 
            Line[{{0.75, 0}, {0.375, 0.649519052838329}}], 
            Line[{{0.25, 0}, {0.625, 0.649519052838329}}]}, {
            Line[{{0.4, 0.6928203230275509}, {0.6, 0.6928203230275509}}], 
            Line[{{0.8, 0}, {0.4, 0.6928203230275509}}], 
            Line[{{0.19999999999999996`, 0}, {0.6, 0.6928203230275509}}]}, {
            
            Line[{{0.42500000000000004`, 0.7361215932167728}, {0.575, 
             0.7361215932167728}}], 
            
            Line[{{0.8500000000000001, 0}, {0.42500000000000004`, 
              0.7361215932167728}}], 
            Line[{{0.1499999999999999, 0}, {0.575, 0.7361215932167728}}]}, {
            Line[{{0.45, 0.7794228634059948}, {0.55, 0.7794228634059948}}], 
            Line[{{0.9, 0}, {0.45, 0.7794228634059948}}], 
            Line[{{0.09999999999999998, 0}, {0.55, 0.7794228634059948}}]}, {
            
            Line[{{0.47500000000000003`, 0.8227241335952167}, {
             0.5249999999999999, 0.8227241335952167}}], 
            
            Line[{{0.9500000000000001, 0}, {0.47500000000000003`, 
              0.8227241335952167}}], 
            
            Line[{{0.04999999999999993, 0}, {0.5249999999999999, 
              0.8227241335952167}}]}, {
            Line[{{0.5, 0.8660254037844386}, {0.5, 0.8660254037844386}}], 
            Line[{{1., 0}, {0.5, 0.8660254037844386}}], 
            Line[{{0., 0}, {0.5, 0.8660254037844386}}]}}}], $CellContext`base = 
       Graphics[{{
           EdgeForm[
            Thickness[Large]], 
           FaceForm[None], 
           Polygon[{{0, 0}, {0.5, Sqrt[3]/2}, {1, 0}}]}, {{{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.1, 17], {0.05, 0.08660254037844387}, {2.25, 0}], 
             
             Line[{{0.020000000000000004`, 0.08660254037844387}, {0.05, 
              0.08660254037844387}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.9, 17], {0.1, 0}, {-2.25, 0}, {1/2, -1}], 
             Line[{{0.1, 0}, {0.115, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.9, 17], {0.95, 0.08660254037844387}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.95, 0.08660254037844387}, {0.965, 
              0.11258330249197702`}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.2, 17], {0.1, 0.17320508075688773`}, {2.25, 0}], 
             
             Line[{{0.07, 0.17320508075688773`}, {0.1, 
              0.17320508075688773`}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.8, 17], {0.2, 0}, {-2.25, 0}, {1/2, -1}], 
             
             Line[{{0.2, 0}, {
               0.21500000000000002`, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.8, 17], {0.9, 0.17320508075688773`}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.9, 0.17320508075688773`}, {0.915, 
              0.19918584287042088`}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.30000000000000004`, 17], {0.15000000000000002`, 
              0.2598076211353316}, {2.25, 0}], 
             
             Line[{{0.12000000000000002`, 0.2598076211353316}, {
              0.15000000000000002`, 0.2598076211353316}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.7, 17], {0.30000000000000004`, 0}, {-2.25, 0}, {
              1/2, -1}], 
             
             Line[{{0.30000000000000004`, 0}, {
               0.31500000000000006`, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.7, 17], {0.85, 0.2598076211353316}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.85, 0.2598076211353316}, {0.865, 
              0.2857883832488648}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.4, 17], {0.2, 0.34641016151377546`}, {2.25, 0}], 
             
             Line[{{0.17, 0.34641016151377546`}, {0.2, 
              0.34641016151377546`}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.6, 17], {0.4, 0}, {-2.25, 0}, {1/2, -1}], 
             
             Line[{{0.4, 0}, {
               0.41500000000000004`, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.6, 17], {0.8, 0.34641016151377546`}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.8, 0.34641016151377546`}, {0.815, 
              0.37239092362730863`}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.5, 17], {0.25, 0.4330127018922193}, {2.25, 0}], 
             Line[{{0.22, 0.4330127018922193}, {0.25, 0.4330127018922193}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.5, 17], {0.5, 0}, {-2.25, 0}, {1/2, -1}], 
             Line[{{0.5, 0}, {0.515, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.5, 17], {0.75, 0.4330127018922193}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.75, 0.4330127018922193}, {0.765, 
              0.45899346400575247`}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.6, 17], {0.3, 0.5196152422706631}, {2.25, 0}], 
             Line[{{0.27, 0.5196152422706631}, {0.3, 0.5196152422706631}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.4, 17], {0.6, 0}, {-2.25, 0}, {1/2, -1}], 
             Line[{{0.6, 0}, {0.615, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.4, 17], {0.7, 0.5196152422706631}, {-2.25, 0}, {
              1.5, 2}], 
             
             Line[{{0.7, 0.5196152422706631}, {0.7150000000000001, 
              0.5455960043841963}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.7000000000000001, 17], {0.35000000000000003`, 
              0.6062177826491071}, {2.25, 0}], 
             
             Line[{{0.32000000000000006`, 0.6062177826491071}, {
              0.35000000000000003`, 0.6062177826491071}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.29999999999999993`, 17], {
              0.7000000000000001, 0}, {-2.25, 0}, {1/2, -1}], 
             Line[{{0.7000000000000001, 0}, {
               0.7150000000000001, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.29999999999999993`, 17], {0.6499999999999999, 
              0.6062177826491071}, {-2.25, 0}, {1.5, 2}], 
             
             Line[{{0.6499999999999999, 0.6062177826491071}, {0.665, 
              0.6321985447626403}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.8, 17], {0.4, 0.6928203230275509}, {2.25, 0}], 
             Line[{{0.37, 0.6928203230275509}, {0.4, 0.6928203230275509}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.19999999999999996`, 17], {0.8, 0}, {-2.25, 0}, {
              1/2, -1}], 
             Line[{{0.8, 0}, {0.8150000000000001, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.19999999999999996`, 17], {0.6, 
              0.6928203230275509}, {-2.25, 0}, {1.5, 2}], 
             
             Line[{{0.6, 0.6928203230275509}, {0.615, 
              0.7188010851410841}}]}}, {{
             RGBColor[0, 0, 1], 
             Text[
              Style[0.9, 17], {0.45, 0.7794228634059948}, {2.25, 0}], 
             
             Line[{{0.42000000000000004`, 0.7794228634059948}, {0.45, 
              0.7794228634059948}}]}, {
             RGBColor[1, 0, 0], 
             Text[
              Style[0.09999999999999998, 17], {0.9, 0}, {-2.25, 0}, {
              1/2, -1}], 
             Line[{{0.9, 0}, {0.915, -0.025980762113533156`}}]}, {
             RGBColor[0, 0.6, 0], 
             Text[
              Style[0.09999999999999998, 17], {0.55, 
              0.7794228634059948}, {-2.25, 0}, {1.5, 2}], 
             
             Line[{{0.55, 0.7794228634059948}, {0.565, 
              0.8054036255195279}}]}}}, 
          Text[
           Style["solute", 17, 
            RGBColor[0, 0, 1]], {0.5, Sqrt[3]/2}, {0, -1}], 
          Text[
           Style["solvent", 17, 
            RGBColor[1, 0, 0]], {0, 0}, {1, 2}], 
          Text[
           Style["carrier", 17, 
            RGBColor[0, 0.6, 0]], {1, 0}, {-1, 2}]}], $CellContext`pt1[
         Pattern[$CellContext`pt, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]]] := {$CellContext`col, 
         PointSize[0.03], 
         Point[$CellContext`pt], White, 
         PointSize[0.015], 
         Point[$CellContext`pt]}, $CellContext`colF = 
       GrayLevel[0], $CellContext`label1[
         Pattern[$CellContext`text, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]], 
         Pattern[$CellContext`loc, 
          Blank[]]] := Text[
         Framed[
          Style[
           Row[{" ", $CellContext`text, " "}], 18, Italic, $CellContext`col], 
          Background -> White, FrameStyle -> $CellContext`col, FrameMargins -> 
          Tiny, RoundingRadius -> 15], $CellContext`loc, {
         0, -1.5}], $CellContext`table1[
         Pattern[$CellContext`title, 
          Blank[]], 
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`y, 
          Blank[]]] := Text[
         Style[
          Column[{
            Row[{$CellContext`title, " mole fractions"}], 
            Framed[
             Column[{
               Style[
                Row[{"solute = ", 
                  NumberForm[
                   $CellContext`wtA[$CellContext`y], {2, 2}]}], Blue], 
               Style[
                Row[{"solvent = ", 
                  NumberForm[
                   $CellContext`wtS[$CellContext`x, $CellContext`y], {2, 
                   2}]}], Red], 
               Style[
                Row[{"carrier = ", 
                  
                  NumberForm[$CellContext`x - $CellContext`y/Sqrt[3], {2, 
                   2}]}], 
                RGBColor[0, 0.6, 0]]}], 
             FrameMargins -> {{20, 20}, {Automatic, Automatic}}]}, Center], 
          17], {-0.05, 0.75}], $CellContext`pt2[
         Pattern[$CellContext`pt, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]]] := {$CellContext`col, 
         PointSize[0.03], 
         Point[$CellContext`pt]}, $CellContext`colS = 
       RGBColor[1, 0, 0], $CellContext`colR = 
       RGBColor[0, 0.2666666666666667, 0.4], $CellContext`label2[
         Pattern[$CellContext`text, 
          Blank[]], 
         Pattern[$CellContext`col, 
          Blank[]], 
         Pattern[$CellContext`loc, 
          Blank[]]] := Text[
         Framed[
          Style[
           Subscript[
            Style[
             Part[$CellContext`text, 1], Italic], 
            Part[$CellContext`text, 2]], 18, $CellContext`col], Background -> 
          White, FrameStyle -> $CellContext`col, FrameMargins -> Small, 
          RoundingRadius -> 15], $CellContext`loc, {
         0, -1.5}], $CellContext`colM = GrayLevel[0.3], $CellContext`table2[
         Pattern[$CellContext`title, 
          Blank[]], 
         Pattern[$CellContext`x, 
          Blank[]], 
         Pattern[$CellContext`y, 
          Blank[]]] := Text[
         Style[
          Column[{
            Row[{$CellContext`title, " mole fractions"}], 
            Framed[
             Column[{
               Style[
                Row[{"solute = ", 
                  NumberForm[
                   $CellContext`wtA[$CellContext`y], {2, 2}]}], Blue], 
               Style[
                Row[{"solvent = ", 
                  NumberForm[
                   $CellContext`wtS[$CellContext`x, $CellContext`y], {2, 
                   2}]}], Red], 
               Style[
                Row[{"carrier = ", 
                  
                  NumberForm[$CellContext`x - $CellContext`y/Sqrt[3], {2, 
                   2}]}], 
                RGBColor[0, 0.6, 0]]}], 
             FrameMargins -> {{20, 20}, {Automatic, Automatic}}]}, Center], 
          17], {1.05, 0.75}], $CellContext`colE1 = 
       RGBColor[1, 0.5, 0], $CellContext`colOP = 
       RGBColor[0.5, 0, 0.5], $CellContext`rafinate2 = {0.6, 
        0.3}, $CellContext`raffinate3 = {0.6, 0.3}, $CellContext`rafinate4 = {
        0.6, 0.3}, $CellContext`rafinate5 = {0.6, 
        0.3}, $CellContext`extract4 = {0.4, 0.15}, $CellContext`extract5 = {
        0.4, 0.15}, $CellContext`extract6 = {0.4, 0.15}, $CellContext`Estage = 
       1, $CellContext`Rstage = 1}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->567416889,ExpressionUUID->"a87645a3-fd10-4ce0-b0ed-cc7c1a15609f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "DetailsSection",ExpressionUUID->"f61d10d2-97b5-419f-9836-6d6d9e75bfea"],

Cell["\<\
The feed flow rate, solvent flow rate and feed composition are given. The \
desired raffinate composition is specified, and the extract composition and \
the number of stages to obtain the desired raffinate composition are \
determined by mass balances. First, the mixing point composition is \
calculated and located on the ternary phase diagram. The mixing point \
corresponds to the composition that would be obtained if the feed and solvent \
flows were mixed together. The mass balance is:\
\>", "DetailNotes",
 CellChangeTimes->{{3.7251152663486414`*^9, 3.725115384313389*^9}, {
   3.7251154622518463`*^9, 3.725115502682159*^9}, 3.7326330854070673`*^9, {
   3.732638495875351*^9, 3.7326385019793577`*^9}, 3.732902241929515*^9, {
   3.756745421170127*^9, 3.756745433898632*^9}, {3.756745472189477*^9, 
   3.756745475534223*^9}, {3.761410399627199*^9, 3.761410415759355*^9}},
 CellID->1795169,ExpressionUUID->"a01f2b5a-d7ad-4db1-8ef3-564e6e73ec52"],

Cell[TextData[{
 "overall: \t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     OverscriptBox["F", 
      StyleBox[".",
       FontWeight->"Bold"]], "+", 
     OverscriptBox["S", 
      StyleBox[".",
       FontWeight->"Bold"]]}], 
    StyleBox["=",
     FontWeight->"Bold"], 
    OverscriptBox["M", 
     StyleBox[".",
      FontWeight->"Bold"]]}], TraditionalForm]], "InlineMath",ExpressionUUID->
  "1b78f0c3-e5de-4226-bd35-97271566861e"]
}], "DetailNotes",
 CellChangeTimes->{{3.7251152663486414`*^9, 3.725115384313389*^9}, {
  3.7251154622518463`*^9, 3.725115510119584*^9}, {3.756745388831993*^9, 
  3.756745417032525*^9}, {3.761409914524478*^9, 3.761410013200508*^9}, {
  3.7614101748893623`*^9, 3.761410177553787*^9}, {3.7614103819378853`*^9, 
  3.761410390881171*^9}, {3.761410424005549*^9, 3.7614104378751574`*^9}},
 CellID->32714542,ExpressionUUID->"8dc62b4d-ddde-4742-aa78-36d0626cf3ec"],

Cell[TextData[{
 "solute ",
 Cell[BoxData[
  FormBox[
   StyleBox["A",
    FontSlant->"Plain"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "d4793804-adfe-48d1-ab8c-04f7e4a9b5a7"],
 ": \t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubsuperscriptBox["x", 
      StyleBox["A",
       FontSlant->"Plain"], 
      StyleBox["F",
       FontSlant->"Plain"]], " ", 
     OverscriptBox["F", 
      StyleBox[".",
       FontWeight->"Bold"]]}], "=", 
    RowBox[{
     SubsuperscriptBox["x", 
      StyleBox["A",
       FontSlant->"Plain"], 
      StyleBox["M",
       FontSlant->"Plain"]], " ", 
     OverscriptBox["M", 
      StyleBox[".",
       FontWeight->"Bold"]]}]}], TraditionalForm]], "InlineMath",
  ExpressionUUID->"0325d909-1389-4070-95d1-4ec2dd1ac99b"]
}], "DetailNotes",
 CellChangeTimes->{{3.7251152663486414`*^9, 3.725115384313389*^9}, {
  3.7251154622518463`*^9, 3.7251155488828015`*^9}, {3.756745398237894*^9, 
  3.756745403080212*^9}, {3.761410022730112*^9, 3.761410022730258*^9}, {
  3.761410055569676*^9, 3.761410055569871*^9}, {3.7614104299831448`*^9, 
  3.761410439010386*^9}},
 CellID->155155985,ExpressionUUID->"11410f89-53ed-45fc-8e8f-40864fca1b0f"],

Cell[TextData[{
 "solvent ",
 Cell[BoxData[
  FormBox[
   StyleBox["S",
    FontSlant->"Plain"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "9681d0ee-c34b-483f-98b0-1dbdb71a72d9"],
 ": \t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubsuperscriptBox["x", 
       StyleBox["S",
        FontSlant->"Plain"], 
       StyleBox["F",
        FontSlant->"Plain"]], " ", 
      OverscriptBox["F", 
       StyleBox[".",
        FontWeight->"Bold"]]}], "+", 
     OverscriptBox["S", 
      StyleBox[".",
       FontWeight->"Bold"]]}], "=", 
    RowBox[{
     SubsuperscriptBox["x", 
      StyleBox["S",
       FontSlant->"Plain"], 
      StyleBox["M",
       FontSlant->"Plain"]], " ", 
     OverscriptBox["M", 
      StyleBox[".",
       FontWeight->"Bold"]]}]}], TraditionalForm]], "InlineMath",
  ExpressionUUID->"2459d70b-89ac-47c2-8a66-f9cf720789d7"]
}], "DetailNotes",
 CellChangeTimes->{{3.7251152663486414`*^9, 3.725115384313389*^9}, {
  3.7251154622518463`*^9, 3.7251155893261147`*^9}, {3.756745488807539*^9, 
  3.756745495206255*^9}, {3.761410024621894*^9, 3.761410058162182*^9}, {
  3.761410432403111*^9, 3.7614104402571898`*^9}},
 CellID->346443311,ExpressionUUID->"72fa3830-b091-4f05-9217-fb10cac3307e"],

Cell[TextData[{
 "carrier ",
 Cell[BoxData[
  FormBox[
   StyleBox["C",
    FontSlant->"Plain"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "61f5ef91-69d5-4993-b3a3-44a864d4fc06"],
 ": \t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubsuperscriptBox["x", 
      StyleBox["A",
       FontSlant->"Plain"], 
      StyleBox["M",
       FontSlant->"Plain"]], "+", 
     SubsuperscriptBox["x", 
      StyleBox["S",
       FontSlant->"Plain"], 
      StyleBox["M",
       FontSlant->"Plain"]], "+", 
     SubsuperscriptBox["x", 
      StyleBox["C",
       FontSlant->"Plain"], 
      StyleBox["M",
       FontSlant->"Plain"]]}], "=", "1"}], TraditionalForm]], "InlineMath",
  ExpressionUUID->"9dd1b44b-74c2-4104-8570-7808b1c7344f"]
}], "DetailNotes",
 CellChangeTimes->{{3.7251152663486414`*^9, 3.725115384313389*^9}, {
  3.7251154622518463`*^9, 3.7251156270532722`*^9}, {3.761410281227273*^9, 
  3.761410281227429*^9}, {3.761410435180009*^9, 3.761410441428226*^9}},
 CellID->371748320,ExpressionUUID->"c7b0041f-3c2b-4bcd-99c2-44548a69f8c7"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["F", 
    StyleBox[".",
     FontWeight->"Bold"]], TraditionalForm]], "InlineMath",ExpressionUUID->
  "c464e8d5-8ede-48a7-903c-aafd37b9911c"],
 " is the feed flow rate (kg/h); ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["S", 
    StyleBox[".",
     FontWeight->"Bold"]], TraditionalForm]], "InlineMath",ExpressionUUID->
  "811582dc-dc1b-46ca-9887-84602a7b7e5c"],
 " is the solvent flow rate (kg/h); ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["M", 
    StyleBox[".",
     FontWeight->"Bold"]], TraditionalForm]], "InlineMath",ExpressionUUID->
  "59646122-5dc4-48f6-9ac2-45c0da3b050f"],
 " is the combined feed and solvent flow rate (kg/h); ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["x", 
    StyleBox["A",
     FontSlant->"Plain"], "i"], TraditionalForm]], "InlineMath",
  ExpressionUUID->"57d6327e-2e1f-4972-80df-b052c9204970"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["x", 
    StyleBox["S",
     FontSlant->"Plain"], "i"], TraditionalForm]], "InlineMath",
  ExpressionUUID->"0b792cf7-7a50-445a-94d0-90a0aad000a6"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["x", 
    StyleBox["C",
     FontSlant->"Plain"], "i"], TraditionalForm]], "InlineMath",
  ExpressionUUID->"d8ed9b31-41cf-452e-aafc-013778d87f9d"],
 " refer to the mass fractions of the solute, solvent and carrier in ",
 Cell[BoxData[
  FormBox[
   RowBox[{"i", "=", 
    RowBox[{"(", 
     RowBox[{
      StyleBox["F",
       FontSlant->"Plain"], ",", 
      StyleBox["S",
       FontSlant->"Plain"], ",", 
      StyleBox["M",
       FontSlant->"Plain"]}], ")"}]}], TraditionalForm]], "InlineMath",
  ExpressionUUID->"f1371543-f116-4c23-a5a2-c233dc914cea"],
 ", where the superscripts ",
 Cell[BoxData[
  FormBox[
   StyleBox["F",
    FontSlant->"Plain"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "1f7a956f-d0ec-4b2b-b33b-80207175cd10"],
 ", ",
 Cell[BoxData[
  FormBox[
   StyleBox["S",
    FontSlant->"Plain"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "85e3c6c1-a6b1-426f-bcc9-ff7939d10b7e"],
 " and ",
 Cell[BoxData[
  FormBox[
   StyleBox["M",
    FontSlant->"Plain"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "3bb83bbb-557d-4950-9687-3fa276b2e1b9"],
 " refer to the three kinds of stream: feed, solvent and mixed. The \
coordinates of the mixing point ",
 Cell[BoxData[
  FormBox["M", TraditionalForm]], "InlineMath",
  FormatType->"TraditionalForm",ExpressionUUID->
  "2d97cd92-392c-4004-a787-cd9c73abdc32"],
 " on the ternary diagram are (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["x", 
     StyleBox["A",
      FontSlant->"Plain"], 
     StyleBox["M",
      FontSlant->"Plain"]], ",", " ", 
    SubsuperscriptBox["x", 
     StyleBox["S",
      FontSlant->"Plain"], 
     StyleBox["M",
      FontSlant->"Plain"]], ",", " ", 
    SubsuperscriptBox["x", 
     StyleBox["C",
      FontSlant->"Plain"], 
     StyleBox["M",
      FontSlant->"Plain"]]}], TraditionalForm]], "InlineMath",
  FormatType->"TraditionalForm",ExpressionUUID->
  "f097e838-a9f4-478c-be37-639f0d9c87fb"],
 ")."
}], "DetailNotes",
 CellChangeTimes->{{3.7251152663486414`*^9, 3.725115384313389*^9}, {
   3.7251154622518463`*^9, 3.7251158142259784`*^9}, {3.732633123753379*^9, 
   3.732633161650901*^9}, 3.7326332519605007`*^9, 3.732633283372861*^9, {
   3.7326372644693832`*^9, 3.732637335426692*^9}, {3.732902481873114*^9, 
   3.732902504457129*^9}, {3.756745478446924*^9, 3.756745486332231*^9}, {
   3.7601869324868608`*^9, 3.7601869405211573`*^9}, {3.76141007792247*^9, 
   3.76141009583846*^9}, {3.7614101977505293`*^9, 3.761410212063122*^9}, {
   3.761410293910981*^9, 3.7614103081001463`*^9}, {3.761410519333027*^9, 
   3.761410529013936*^9}},
 CellID->514600296,ExpressionUUID->"b5a31d40-2da5-4be4-96b2-b4bbc902012b"],

Cell["\<\
The mixing point can also be located on the phase diagram using the lever \
rule:\
\>", "DetailNotes",
 CellChangeTimes->{{3.7251158236605177`*^9, 3.7251158469008474`*^9}, {
  3.756745596037121*^9, 3.756745597736857*^9}, {3.761410553712562*^9, 
  3.76141055566885*^9}},
 CellID->411988528,ExpressionUUID->"a7e62409-a6b8-42ee-ac0a-3de8ded67398"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    OverscriptBox["F", 
     StyleBox[".",
      FontWeight->"Bold"]], "/", 
    OverscriptBox["S", 
     StyleBox[".",
      FontWeight->"Bold"]]}], "=", 
   RowBox[{
    OverscriptBox[
     RowBox[{"M", " ", "F"}], "_"], "/", 
    OverscriptBox[
     RowBox[{"M", " ", "S"}], "_"]}]}], 
  TraditionalForm]], \
"InlineMath",ExpressionUUID->"9e710655-800b-404b-93dd-3a7b5308dd88"]], \
"DetailNotes",
 CellChangeTimes->{{3.7251158236605177`*^9, 3.725115902318017*^9}, {
   3.756745599851492*^9, 3.756745600977631*^9}, {3.761410107019113*^9, 
   3.761410112277872*^9}, 3.761410632390905*^9},
 CellID->131173849,ExpressionUUID->"237ff664-d39d-439b-9318-f2af2194c44d"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{"M", " ", "F"}], "_"], TraditionalForm]], "InlineMath",
  ExpressionUUID->"c7e63bff-ec85-4f5b-ab71-349ceb1b5b85"],
 " is the length of the line segment from the mixing point to the feed \
composition ",
 Cell[BoxData[
  FormBox["F", TraditionalForm]], "InlineMath",
  FormatType->"TraditionalForm",ExpressionUUID->
  "63ebf802-be0b-4e98-bda6-df41486e1706"],
 ", and ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    RowBox[{"M", " ", "S"}], "_"], TraditionalForm]], "InlineMath",
  ExpressionUUID->"bcb04b5f-71cd-43d3-b6f3-aa479b52d96c"],
 " is the length of the line segment from the mixing point ",
 Cell[BoxData[
  FormBox["M", TraditionalForm]], "InlineMath",
  FormatType->"TraditionalForm",ExpressionUUID->
  "59680999-fbd8-448a-be81-c923a05bcafa"],
 " to the solvent composition S."
}], "DetailNotes",
 CellChangeTimes->{{3.7251158236605177`*^9, 3.725115975200186*^9}, 
   3.732633309372963*^9, {3.756745612230651*^9, 3.756745619128714*^9}, {
   3.7567699912823496`*^9, 3.756770000122769*^9}, {3.761410583261635*^9, 
   3.761410606970709*^9}},
 CellID->200669767,ExpressionUUID->"836fde7e-f317-4684-a92e-e8932a3dc170"],

Cell[TextData[{
 "A line is drawn from the desired raffinate composition ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["R", 
    StyleBox["N",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath",ExpressionUUID->
  "89685fe0-5a21-4da5-a9c3-68c70e369a69"],
 " through the mixing point until it intersects the phase boundary, giving \
the extract composition leaving stage 1, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "1"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "6de34a30-5ead-4cb3-b112-6a497cb8fd25"],
 "."
}], "DetailNotes",
 CellChangeTimes->{{3.7251158236605177`*^9, 3.7251159901710415`*^9}, {
  3.7251160778420563`*^9, 3.725116110994952*^9}, {3.732633344853799*^9, 
  3.732633345112112*^9}},
 CellID->158207208,ExpressionUUID->"344521ac-ae97-4d91-ab53-948cdc780109"],

Cell[TextData[{
 "The operating point ",
 Cell[BoxData[
  FormBox["P", TraditionalForm]], "InlineMath",ExpressionUUID->
  "9cf1713f-431a-4270-a5b9-53c58d3eca3c"],
 " is located at the intersection of a line drawn through points ",
 Cell[BoxData[
  FormBox["F", TraditionalForm]], "InlineMath",ExpressionUUID->
  "9e18761b-79ff-4b40-b80c-66329074edb6"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "1"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "e2cc9f79-4011-4362-9f00-166393051bc2"],
 " and a line drawn through points ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["R", 
    StyleBox["N",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath",ExpressionUUID->
  "51eeae44-f2c9-4ac1-a8ef-f6ac85b47975"],
 " and ",
 Cell[BoxData[
  FormBox["S", TraditionalForm]], "InlineMath",ExpressionUUID->
  "96c8ea97-fd5b-4e8d-800b-c3839cd68a0b"],
 ", because the overall mass balance for the system is:"
}], "DetailNotes",
 CellChangeTimes->{{3.7251158236605177`*^9, 3.7251159901710415`*^9}, {
  3.7251160778420563`*^9, 3.7251161705473585`*^9}},
 CellID->549174646,ExpressionUUID->"3acfe47a-6618-4759-8772-eadf4943c635"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"F", "+", "S"}], "=", 
   RowBox[{
    SubscriptBox["E", "1"], "+", 
    SubscriptBox["R", 
     StyleBox["N",
      FontSlant->"Plain"]]}]}], 
  TraditionalForm]], \
"InlineMath",ExpressionUUID->"82efc39d-e52a-4165-a803-78cfaf4e5580"]], \
"DetailNotes",
 CellChangeTimes->{{3.7251158236605177`*^9, 3.7251159901710415`*^9}, {
   3.7251160778420563`*^9, 3.725116181281973*^9}, 3.761410630843202*^9},
 CellID->207624347,ExpressionUUID->"c645375b-0742-4988-b3dd-4810b87095b2"],

Cell["This equation is rearranged to define the operating point:", \
"DetailNotes",
 CellChangeTimes->{{3.7251158236605177`*^9, 3.7251159901710415`*^9}, {
  3.7251160778420563`*^9, 3.725116203075219*^9}},
 CellID->247058506,ExpressionUUID->"14357deb-1faa-4eb0-8306-d80e37c492e1"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"P", "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["E", "1"], "-", "F"}], "=", 
    RowBox[{"S", "-", 
     SubscriptBox["R", 
      StyleBox["N",
       FontSlant->"Plain"]]}]}]}], 
  TraditionalForm]], \
"InlineMath",ExpressionUUID->"7dcca575-b0fc-4fd5-9888-c50206ee58bd"]], \
"DetailNotes",
 CellChangeTimes->{{3.7251158236605177`*^9, 3.7251159901710415`*^9}, {
   3.7251160778420563`*^9, 3.7251162169880147`*^9}, {3.756745358638996*^9, 
   3.756745362737603*^9}, 3.761410633869678*^9},
 CellID->787679570,ExpressionUUID->"36519552-8329-4164-92a3-5305fb5c0e32"],

Cell[TextData[{
 "A tie line from ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "1"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "2401a723-96c8-4795-9360-4d9a7852f292"],
 " to the right side of the phase boundary yields the raffinate composition \
leaving stage 1, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["R", "1"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "279b57f6-2847-4abd-9d54-7f423ad7e8a7"],
 "; this line represents the first equilibrium stage."
}], "DetailNotes",
 CellChangeTimes->{{3.7251158236605177`*^9, 3.7251159901710415`*^9}, {
   3.7251160778420563`*^9, 3.7251162670368776`*^9}, 3.732633378820393*^9},
 CellID->115417136,ExpressionUUID->"e0d1bfbc-e499-491b-83a1-8eddca481d9b"],

Cell["A mass balance on stage 1 is:", "DetailNotes",
 CellChangeTimes->{{3.7251158236605177`*^9, 3.7251159901710415`*^9}, {
  3.7251160778420563`*^9, 3.725116279636598*^9}},
 CellID->636047144,ExpressionUUID->"371a2b37-9dc3-422f-a71e-d0be3b23d1f1"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SubscriptBox["E", "2"], "+", "F"}], "=", 
   RowBox[{
    SubscriptBox["E", "1"], "+", 
    SubscriptBox["R", "1"]}]}], 
  TraditionalForm]], \
"InlineMath",ExpressionUUID->"cf9db9c4-ce42-426d-8c0c-8da3c00a77db"]], \
"DetailNotes",
 CellChangeTimes->{{3.7251158236605177`*^9, 3.7251159901710415`*^9}, {
   3.7251160778420563`*^9, 3.725116292322324*^9}, 3.761410635363572*^9},
 CellID->25549287,ExpressionUUID->"f81f76dd-f318-42b5-b215-41b3b7db2066"],

Cell["which can be written as:", "DetailNotes",
 CellChangeTimes->{{3.7251158236605177`*^9, 3.7251159901710415`*^9}, {
  3.7251160778420563`*^9, 3.7251162971616006`*^9}},
 CellID->63399934,ExpressionUUID->"c3d8b58a-b74b-41b9-a911-a9c16e9dc633"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SubscriptBox["E", "2"], "-", 
    SubscriptBox["R", "1"]}], "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["E", "1"], "-", "F"}], "=", "P"}]}], 
  TraditionalForm]], \
"InlineMath",ExpressionUUID->"31ef15c8-d754-4281-8312-b16e9b4ea955"]], \
"DetailNotes",
 CellChangeTimes->{{3.7251158236605177`*^9, 3.7251159901710415`*^9}, {
   3.7251160778420563`*^9, 3.725116308713261*^9}, 3.76141063652264*^9},
 CellID->509010446,ExpressionUUID->"1c307fe7-4991-4eed-898f-ba5ad3f7cf0e"],

Cell[TextData[{
 "Thus, the extract composition leaving stage 2, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "2"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "9277427d-e5af-4573-bb0f-0ffaa329e6ad"],
 ", is found by drawing a straight line from ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["R", "1"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "7d7c17ac-292c-43d0-9680-15fe1051364b"],
 " to ",
 Cell[BoxData[
  FormBox["P", TraditionalForm]], "InlineMath",ExpressionUUID->
  "8c2bbdf9-8fa3-4ecb-bd4a-48dd04e5c6e5"],
 " (because ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"P", "+", 
     SubscriptBox["R", "1"]}], "=", 
    SubscriptBox["E", "2"]}], TraditionalForm]], "InlineMath",ExpressionUUID->
  "24b0e887-a50b-4767-8ea2-a6f77b48bb99"],
 " from the previous equation). Where this line intersects the left side of \
the phase boundary is the composition ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "2"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "850b78f3-065a-4091-b54c-e20763ac07b0"],
 "."
}], "DetailNotes",
 CellChangeTimes->{{3.7251158236605177`*^9, 3.7251159901710415`*^9}, {
  3.7251160778420563`*^9, 3.7251163909939675`*^9}},
 CellID->215465713,ExpressionUUID->"c98a5cbb-8933-41f9-bb7d-73c23805b33d"],

Cell[TextData[{
 "This procedure is repeated for additional stages until the raffinate \
composition is nearly equal to the desired raffinate composition ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["R", 
    StyleBox["N",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath",ExpressionUUID->
  "cf82a590-2f7e-4ff0-8b0d-8c86233f175b"],
 ". The number of orange lines drawn is the number of equilibrium stages."
}], "DetailNotes",
 CellChangeTimes->{{3.7251158236605177`*^9, 3.7251159901710415`*^9}, {
  3.7251160778420563`*^9, 3.725116443276958*^9}, {3.7251164931118083`*^9, 
  3.725116512786934*^9}, {3.7251173833491173`*^9, 3.725117384041519*^9}},
 CellID->253207522,ExpressionUUID->"14d74a36-fe9b-42e1-888e-57faeb8aa883"],

Cell["\<\
See [1\[Dash]4] for screencasts that describe the Hunter\[Dash]Nash method \
and present examples.\
\>", "DetailNotes",
 CellChangeTimes->{{3.650732304931017*^9, 3.6507323220189943`*^9}, {
   3.650732403162635*^9, 3.6507325214283996`*^9}, {3.650732586039095*^9, 
   3.6507326583152294`*^9}, {3.6507327411439667`*^9, 
   3.6507327433760943`*^9}, {3.6507327769650154`*^9, 3.65073286708817*^9}, {
   3.6507329533981066`*^9, 3.6507329584573965`*^9}, {3.6507329891361513`*^9, 
   3.6507331371026144`*^9}, {3.650733210200795*^9, 3.650733212752941*^9}, {
   3.650808866399925*^9, 3.6508090600510015`*^9}, {3.650809259044383*^9, 
   3.6508093963582373`*^9}, {3.650809555696351*^9, 3.650809600302902*^9}, 
   3.6510041274134645`*^9, {3.651591361871708*^9, 3.651591370815221*^9}, {
   3.652550891267016*^9, 3.652550892195141*^9}, {3.652551773869348*^9, 
   3.652551774076977*^9}, {3.6804652111417303`*^9, 3.680465216793053*^9}, {
   3.6805106338182297`*^9, 3.6805106713774834`*^9}, {3.6826890424594917`*^9, 
   3.682689042684443*^9}, {3.6826892839572477`*^9, 3.682689288655818*^9}, {
   3.7271934075775557`*^9, 3.7271934075775557`*^9}},
 CellID->196589969,ExpressionUUID->"1967b672-82e3-4d13-89d9-6f4ad543b0aa"],

Cell["\<\
This Demonstration is a Mathematica version of a browser-based simulation [5].\
\>", "DetailNotes",
 CellChangeTimes->{{3.650732304931017*^9, 3.6507323220189943`*^9}, {
   3.650732403162635*^9, 3.6507325214283996`*^9}, {3.650732586039095*^9, 
   3.6507326583152294`*^9}, {3.6507327411439667`*^9, 
   3.6507327433760943`*^9}, {3.6507327769650154`*^9, 3.65073286708817*^9}, {
   3.6507329533981066`*^9, 3.6507329584573965`*^9}, {3.6507329891361513`*^9, 
   3.6507331371026144`*^9}, {3.650733210200795*^9, 3.650733212752941*^9}, {
   3.650808866399925*^9, 3.6508090600510015`*^9}, {3.650809259044383*^9, 
   3.6508093963582373`*^9}, {3.650809555696351*^9, 3.650809600302902*^9}, 
   3.6510041274134645`*^9, {3.651591361871708*^9, 3.651591370815221*^9}, {
   3.652550891267016*^9, 3.652550892195141*^9}, {3.652551773869348*^9, 
   3.652551774076977*^9}, {3.6804652111417303`*^9, 3.680465216793053*^9}, {
   3.6805106338182297`*^9, 3.6805106713774834`*^9}, {3.6826890424594917`*^9, 
   3.682689042684443*^9}, {3.6826892839572477`*^9, 3.682689288655818*^9}, {
   3.7271934114888687`*^9, 3.7271934513252535`*^9}, {3.727193501262966*^9, 
   3.727193517546363*^9}, {3.727193550251996*^9, 3.7271935555881863`*^9}, 
   3.727193607330799*^9, {3.7271936927050676`*^9, 3.727193753642475*^9}, 
   3.732632741030695*^9, {3.732633415328128*^9, 3.7326334165527*^9}},
 CellID->182661868,ExpressionUUID->"81e12bce-e82b-4256-8be4-be4bbe1bdab6"],

Cell["References", "DetailNotes",
 CellChangeTimes->{{3.651591373914138*^9, 3.651591375559074*^9}, {
  3.652550915795631*^9, 3.652550915798377*^9}},
 CellID->650929921,ExpressionUUID->"3f7d7c29-e5ad-4961-8079-66793a825468"],

Cell[TextData[{
 "[1] ",
 StyleBox["Hunter\[Dash]Nash Method: Liquid-Liquid Extraction",
  FontSlant->"Italic"],
 " [Video]. ",
 "(Apr 13, 2018)",
 " ",
 ButtonBox["www.youtube.com/watch?v=e0Yt5RMkyj4",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://www.youtube.com/watch?v=e0Yt5RMkyj4"], 
    "https://www.youtube.com/watch?v=e0Yt5RMkyj4"},
  ButtonNote->"https://www.youtube.com/watch?v=e0Yt5RMkyj4"],
 "."
}], "DetailNotes",
 CellChangeTimes->{{3.651591373914138*^9, 3.651591375559074*^9}, {
   3.652550915795631*^9, 3.652550935113722*^9}, {3.652551006183118*^9, 
   3.652551101796389*^9}, {3.6525511498922977`*^9, 3.6525511498944817`*^9}, {
   3.6805105669198165`*^9, 3.6805105711402044`*^9}, {3.6805106062901745`*^9, 
   3.6805106103788776`*^9}, {3.6826890713056107`*^9, 3.6826890764687567`*^9}, 
   3.7326327349107237`*^9},
 CellID->795704731,ExpressionUUID->"ea83c20d-6f74-4dff-8ebc-0d0554a8a8d2"],

Cell[TextData[{
 "[2] ",
 StyleBox["Hunter\[Dash]Nash Method: Liquid-Liquid Extraction Example",
  FontSlant->"Italic"],
 " [Video]. ",
 "(Apr 13, 2018)",
 " ",
 ButtonBox["www.youtube.com/watch?v=FaKIZU3XPR8",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://www.youtube.com/watch?v=FaKIZU3XPR8"], 
    "https://www.youtube.com/watch?v=FaKIZU3XPR8"},
  ButtonNote->"https://www.youtube.com/watch?v=FaKIZU3XPR8"],
 "."
}], "DetailNotes",
 CellChangeTimes->{{3.651591373914138*^9, 3.651591375559074*^9}, {
   3.652550915795631*^9, 3.652550935113722*^9}, {3.652551006183118*^9, 
   3.652551101796389*^9}, {3.6525511498922977`*^9, 3.652551230856626*^9}, {
   3.652621064073069*^9, 3.652621066080347*^9}, {3.6805105736895914`*^9, 
   3.6805106005166264`*^9}, {3.682689102299576*^9, 3.682689105854014*^9}, 
   3.732632717900269*^9},
 CellID->1033333502,ExpressionUUID->"da501df3-21e0-4538-897b-1b0ba5f7c086"],

Cell[TextData[{
 "[3] ",
 StyleBox["Hunter\[Dash]Nash Method 1: Mixing and Operating Points",
  FontSlant->"Italic"],
 " [Video]. ",
 "(Apr 13, 2018)",
 " ",
 ButtonBox["www.youtube.com/watch?v=-yW0jIcH0_E",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://www.youtube.com/watch?v=-yW0jIcH0_E"], None},
  ButtonNote->"https://www.youtube.com/watch?v=-yW0jIcH0_E"],
 "."
}], "DetailNotes",
 CellChangeTimes->{{3.6804652398053694`*^9, 3.680465287702109*^9}, {
   3.6805105790341835`*^9, 3.6805105822668715`*^9}, {3.682689127094776*^9, 
   3.6826891332814913`*^9}, {3.682689181827813*^9, 3.682689182016486*^9}, 
   3.73263269881946*^9},
 CellID->262511509,ExpressionUUID->"e512973b-7c7d-48e2-833a-0b1d421222bd"],

Cell[TextData[{
 "[4] ",
 StyleBox["Hunter\[Dash]Nash Method 2: Number of Stages",
  FontSlant->"Italic"],
 " [Video]. (Apr 13, 2018) ",
 ButtonBox["www.youtube.com/watch?v=JZuavrt8ksQ",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://www.youtube.com/watch?v=JZuavrt8ksQ"], None},
  ButtonNote->"https://www.youtube.com/watch?v=JZuavrt8ksQ"],
 "."
}], "DetailNotes",
 CellChangeTimes->{{3.6804653004638386`*^9, 3.6804653401831107`*^9}, {
   3.6805105842375216`*^9, 3.6805105882576375`*^9}, {3.682689152666256*^9, 
   3.682689155612649*^9}, 3.682689188092229*^9, {3.727193611187214*^9, 
   3.7271936111880875`*^9}, {3.732632679580817*^9, 3.7326326835277843`*^9}},
 CellID->374100856,ExpressionUUID->"a3463568-1f01-473c-add2-601f262ece4d"],

Cell[TextData[{
 "[5] T. B\[AAcute]ns\[AAcute]gi and T. L. Rodgers, ",
 StyleBox["Liquid-Liquid Extraction: Hunter-Nash Method",
  FontSlant->"Italic"],
 ". (Apr 13, 2018) ",
 ButtonBox["chem.co.nf/LLE/ternary_hn.html",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://chem.co.nf/LLE/ternary_hn.html"], None},
  ButtonNote->"http://chem.co.nf/LLE/ternary_hn.html"],
 "."
}], "DetailNotes",
 CellChangeTimes->{{3.6804653004638386`*^9, 3.6804653401831107`*^9}, {
   3.6805105842375216`*^9, 3.6805105882576375`*^9}, {3.682689152666256*^9, 
   3.682689155612649*^9}, 3.682689188092229*^9, {3.7271936138862357`*^9, 
   3.727193679907683*^9}, {3.7271937169366403`*^9, 3.727193721844047*^9}, {
   3.732632591986836*^9, 3.732632663726295*^9}},
 CellID->364587102,ExpressionUUID->"08a62dd9-9232-41ee-964f-beedc21433ee"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ControlSuggestionsSection",ExpressionUUID->"84b627ab-b25e-425d-ba44-8ef94fd36c29"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Resize Images",ExpressionUUID->"8bd179f0-bca3-4c72-9132-a47946cc8bed"]}],
  "\"Click inside an image to reveal its orange resize frame.\\nDrag any of \
the orange resize handles to resize the image.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.725116518790277*^9, 3.73263736341854*^9},
 FontFamily->"Verdana",
 CellTags->
  "ResizeImages",ExpressionUUID->"b57ebdd4-fc85-4430-a179-57ac44fd5443"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Rotate and Zoom in 3D",ExpressionUUID->
    "b0580436-1fff-493b-b35a-ab93d52df1f0"]}],
  RowBox[{
   "\"Drag a 3D graphic to rotate it. Starting the drag near the center \
tumbles\\nthe graphic; starting near a corner turns it parallel to the plane \
of the screen.\\nHold down \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" (or \"", 
    FrameBox[
    "Cmd", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" on Mac) and drag up and down to zoom.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->
  "RotateAndZoomIn3D",ExpressionUUID->"2c809d5d-d8dd-49d1-8657-b0db7feb35b1"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[
   " Drag Locators",ExpressionUUID->"693b9b2d-687f-4c89-97d3-8e4f3babdd03"]}],
  RowBox[{"\"Drag any locator (\"", 
    GraphicsBox[
     LocatorBox[
      Scaled[{0.5, 0.5}]], ImageSize -> 20], 
    "\", etc.) to move it around.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.7251165201193533`*^9},
 FontFamily->"Verdana",
 CellTags->
  "DragLocators",ExpressionUUID->"094b96c1-713b-47a8-a4a4-b4642487f6e2"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Create and Delete Locators",ExpressionUUID->
    "70c21f76-38e1-42f8-a7a4-7b628b8b7ee2"]}],
  RowBox[{"\"Insert a new locator in the graphic by holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key\\nand clicking where you want it to be. Delete a locator by \
clicking it\\nwhile holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" key.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->
  "CreateAndDeleteLocators",ExpressionUUID->"6759678e-d1d0-4c80-b9ad-\
140c38559201"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Slider Zoom",ExpressionUUID->"ef8a3d6a-fb2e-4557-ac0f-0833323f6ccb"]}],
  RowBox[{"\"Hold down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key while moving a slider to make fine adjustments in the slider \
value.\\nHold \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" and/or \"", 
    FrameBox[
    "Shift", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" at the same time as \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" to make ever finer adjustments.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->
  "SliderZoom",ExpressionUUID->"fb3fcc44-8656-47d0-80cb-8a92520918d6"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Gamepad Controls",ExpressionUUID->
    "4a738ad5-abef-43fa-b918-b25a3986e3db"]}],
  "\"Control this Demonstration with a gamepad or other\\nhuman interface \
device connected to your computer.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.35696210375764*^9, 3.3895522232313623`*^9},
 FontFamily->"Verdana",
 CellTags->
  "GamepadControls",ExpressionUUID->"e8d2c1d1-d55c-48c3-b204-21453a89aaac"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[
   " Automatic Animation",ExpressionUUID->
    "d81e1887-f5e3-4405-9c98-7f2bb0c5467b"]}],
  RowBox[{"\"Animate a slider in this Demonstration by clicking the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJzzTSzJSM1NLMlMTlRwL0osyMhMLlZwyy8CCjEzMjAwcIKwAgOI/R/IhBKc\n\
/4EAyGAG0f+nTZsGwgysIJIRKsWKLAXGIHFmEpUgLADxWUAkI24jZs+eTaEt\n\
IG+wQKRmzJgBlYf5lhEA30OqWA=="], "Graphics", ImageSize -> {9, 9}, ImageMargins -> 
      0, CellBaseline -> Baseline], BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"button\\nnext to the slider, and then clicking the play button that \
appears.\\nAnimate all controls by selecting \"", 
    StyleBox["Autorun", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.7251165217344456`*^9},
 FontFamily->"Verdana",
 CellTags->
  "AutomaticAnimation",ExpressionUUID->"37a7bb67-a3af-4f89-8f52-5d37a040be60"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Bookmark Animation",ExpressionUUID->
    "5087542d-decb-4358-9066-cc446b6d59c8"]}],
  RowBox[{
   "\"See a prepared animation of this Demonstration by selecting\\n\"", 
    StyleBox["Animate Bookmarks", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->
  "BookmarkAnimation",ExpressionUUID->"864ece68-376d-4170-adc9-25c78e91364c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SearchTermsSection",ExpressionUUID->"9276f611-b813-4a4e-bc01-2556afbd1aea"],

Cell["chemical engineering", "SearchTerms",
 CellChangeTimes->{{3.6508098166662774`*^9, 3.6508098211775355`*^9}},
 CellID->25273347,ExpressionUUID->"5aafd9dd-6cdb-46f9-91ca-c0e1421cf991"],

Cell["Hunter-Nash method", "SearchTerms",
 CellChangeTimes->{{3.68046535783512*^9, 3.680465360209256*^9}, {
  3.6805105010719967`*^9, 3.6805105019425135`*^9}},
 CellID->516856553,ExpressionUUID->"41444075-4862-43a3-a766-d95f8db9d078"],

Cell["liquid-liquid extraction", "SearchTerms",
 CellChangeTimes->{{3.6508098166662774`*^9, 3.650809831434122*^9}},
 CellID->550405887,ExpressionUUID->"958bd2f5-0379-437b-9376-677441967580"],

Cell["LLE", "SearchTerms",
 CellChangeTimes->{{3.6508098166662774`*^9, 3.650809833198223*^9}, {
  3.6513087093338194`*^9, 3.6513087093338194`*^9}},
 CellID->113825678,ExpressionUUID->"acafbf92-7737-402b-863c-4bcfc10675e6"],

Cell["liquid-liquid equilibrium", "SearchTerms",
 CellChangeTimes->{{3.6508098166662774`*^9, 3.650809833198223*^9}, {
  3.6513087093338194`*^9, 3.6513087195895696`*^9}},
 CellID->123468224,ExpressionUUID->"f1697799-8041-4c7c-86b3-f9e01cb5b77a"],

Cell["ternary phase diagram", "SearchTerms",
 CellChangeTimes->{{3.6508098166662774`*^9, 3.65080983682143*^9}, {
  3.6513087229026623`*^9, 3.651308724122738*^9}},
 CellID->232056720,ExpressionUUID->"1d22be58-f79b-4688-8154-a1d379ec73c4"],

Cell["separations", "SearchTerms",
 CellChangeTimes->{{3.6508098166662774`*^9, 3.650809854848461*^9}, {
  3.6510041798834877`*^9, 3.6510041798834877`*^9}},
 CellID->457814245,ExpressionUUID->"6a38d77c-c6b0-4ef0-92f2-c264bdb33a5e"],

Cell["phase equilibrium", "SearchTerms",
 CellChangeTimes->{{3.6508098166662774`*^9, 3.650809854848461*^9}, {
  3.6510041798834877`*^9, 3.6510041840671463`*^9}},
 CellID->618351522,ExpressionUUID->"c7e1ddfc-b4ec-41f9-a670-f8e6ecec6ab9"],

Cell["mass balances", "SearchTerms",
 CellChangeTimes->{{3.6508098166662774`*^9, 3.6508098574206085`*^9}, 
   3.651004186967927*^9},
 CellID->87439811,ExpressionUUID->"d39fdd27-4374-4d50-a79f-e510268c52b8"],

Cell["step by step", "SearchTerms",
 CellChangeTimes->{{3.725116529064865*^9, 3.725116531551007*^9}, {
  3.732633433845039*^9, 3.7326334357457857`*^9}},
 CellID->32782905,ExpressionUUID->"5e7645d2-4f46-4767-99b6-ceaf1911ad14"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "RelatedLinksSection",ExpressionUUID->"d7a99474-f9e9-47c4-83f9-fa3d5d412b5c"],

Cell[TextData[ButtonBox["Extraction of Acetic Acid from Water Using Isopropyl \
Ether",
 BaseStyle->"Hyperlink",
 ButtonData->{
   URL["http://demonstrations.wolfram.com/\
ExtractionOfAceticAcidFromWaterUsingIsopropylEther/"], None},
 ButtonNote->
  "http://demonstrations.wolfram.com/\
ExtractionOfAceticAcidFromWaterUsingIsopropylEther/"]], "RelatedLinks",
 CellID->59120858,ExpressionUUID->"cc81e418-6b79-454a-b45f-f5bd92a8049b"],

Cell[TextData[ButtonBox["Basic Ternary Phase Diagram",
 BaseStyle->"Hyperlink",
 ButtonData->{
   URL["http://demonstrations.wolfram.com/BasicTernaryPhaseDiagram/"], None},
 ButtonNote->
  "http://demonstrations.wolfram.com/BasicTernaryPhaseDiagram/"]], \
"RelatedLinks",
 CellChangeTimes->{{3.651432959183753*^9, 3.651432976703755*^9}},
 CellID->140534484,ExpressionUUID->"90c988dc-0325-4901-8645-d69b43fa2b83"],

Cell[TextData[ButtonBox["Ternary Phase Diagram with Phase Envelope",
 BaseStyle->"Hyperlink",
 ButtonData->{
   URL["http://demonstrations.wolfram.com/\
TernaryPhaseDiagramWithPhaseEnvelope/"], None},
 ButtonNote->
  "http://demonstrations.wolfram.com/TernaryPhaseDiagramWithPhaseEnvelope/"]],\
 "RelatedLinks",
 CellChangeTimes->{{3.651432959183753*^9, 3.651433016470029*^9}},
 CellID->388109435,ExpressionUUID->"51023410-b357-42a4-926d-e46363585a70"],

Cell[TextData[ButtonBox["Ternary Phase Diagram with Alternate Phase Envelope",
 BaseStyle->"Hyperlink",
 ButtonData->{
   URL["http://demonstrations.wolfram.com/\
TernaryPhaseDiagramWithAlternatePhaseEnvelope/"], None},
 ButtonNote->
  "http://demonstrations.wolfram.com/\
TernaryPhaseDiagramWithAlternatePhaseEnvelope/"]], "RelatedLinks",
 CellChangeTimes->{{3.651432959183753*^9, 3.6514330645917816`*^9}},
 CellID->348224188,ExpressionUUID->"cee797c0-ce5b-44be-9a7f-21319d8d0bc2"],

Cell[TextData[ButtonBox["Hunter-Nash Method for Liquid-Liquid Extraction \
(LLE)",
 BaseStyle->"Hyperlink",
 ButtonData->{
   URL["http://demonstrations.wolfram.com/\
HunterNashMethodForLiquidLiquidExtractionLLE/"], None},
 ButtonNote->
  "http://demonstrations.wolfram.com/\
HunterNashMethodForLiquidLiquidExtractionLLE/"]], "RelatedLinks",
 CellChangeTimes->{{3.725116574912938*^9, 3.725116597571658*^9}},
 CellID->506300868,ExpressionUUID->"8fe59bc2-ce28-4b13-9eaf-1ea014d77d8b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "AuthorSection",ExpressionUUID->"28a8e73f-9b30-4362-aac0-efccd403eb2b"],

Cell[TextData[{
 "Contributed by: ",
 ButtonBox["Rachael L. Baumann",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=Rachael+L.+\
Baumann"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=Rachael+L.+Baumann"]
}], "Author",
 CellChangeTimes->{{3.609784090101136*^9, 3.609784090103136*^9}, 
   3.60978412565917*^9, {3.6109793544694567`*^9, 3.6109793544704585`*^9}, {
   3.6109921182558336`*^9, 3.6109921182578335`*^9}, {3.6325066799655933`*^9, 
   3.632506689057065*^9}, {3.63258095035064*^9, 3.632580960165201*^9}, {
   3.632675426689807*^9, 3.6326754405424213`*^9}, {3.6508294982911205`*^9, 
   3.6508295003882403`*^9}},
 CellID->9119879,ExpressionUUID->"6a973b85-197c-4143-a7c2-5cda232ddc83"],

Cell[TextData[{
 "Additional contributions by: ",
 ButtonBox["John L. Falconer",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=John+L.+\
Falconer"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=John+L.+Falconer"],
 " "
}], "Author",
 CellChangeTimes->{{3.609784090101136*^9, 3.609784090103136*^9}, 
   3.60978412565917*^9, {3.6109793544694567`*^9, 3.6109793544704585`*^9}, {
   3.6109921182558336`*^9, 3.6109921185688515`*^9}, {3.6321448389752903`*^9, 
   3.632144846238706*^9}, {3.632144877483493*^9, 3.6321448807876825`*^9}, {
   3.6322490388279934`*^9, 3.6322491007665367`*^9}, {3.632495028348035*^9, 
   3.632495036484501*^9}, {3.6325066930439334`*^9, 3.6325066935222616`*^9}},
 CellID->142231542,ExpressionUUID->"0ead735c-4418-4c82-a7d8-ade567769af1"],

Cell["\<\
(University of Colorado Boulder, Department of Chemical and Biological \
Engineering)\
\>", "Author",
 CellChangeTimes->{{3.609784090101136*^9, 3.6097841105263042`*^9}, {
  3.610992060718543*^9, 3.610992060722543*^9}, {3.632580939566023*^9, 
  3.632580959043137*^9}},
 CellID->122665613,ExpressionUUID->"6faaf441-b01f-48c8-aaa0-b96d98e8b3f1"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1278, 1348},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "Demonstration.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "ResizeImages"->{
  Cell[483425, 10571, 492, 11, 29, "ControlSuggestions",ExpressionUUID->"b57ebdd4-fc85-4430-a179-57ac44fd5443",
   CellTags->"ResizeImages"]},
 "RotateAndZoomIn3D"->{
  Cell[483920, 10584, 800, 19, 29, "ControlSuggestions",ExpressionUUID->"2c809d5d-d8dd-49d1-8657-b0db7feb35b1",
   CellTags->"RotateAndZoomIn3D"]},
 "DragLocators"->{
  Cell[484723, 10605, 500, 14, 29, "ControlSuggestions",ExpressionUUID->"094b96c1-713b-47a8-a4a4-b4642487f6e2",
   CellTags->"DragLocators"]},
 "CreateAndDeleteLocators"->{
  Cell[485226, 10621, 761, 19, 29, "ControlSuggestions",ExpressionUUID->"6759678e-d1d0-4c80-b9ad-140c38559201",
   CellTags->"CreateAndDeleteLocators"]},
 "SliderZoom"->{
  Cell[485990, 10642, 961, 23, 29, "ControlSuggestions",ExpressionUUID->"fb3fcc44-8656-47d0-80cb-8a92520918d6",
   CellTags->"SliderZoom"]},
 "GamepadControls"->{
  Cell[486954, 10667, 491, 12, 29, "ControlSuggestions",ExpressionUUID->"e8d2c1d1-d55c-48c3-b204-21453a89aaac",
   CellTags->"GamepadControls"]},
 "AutomaticAnimation"->{
  Cell[487448, 10681, 1629, 35, 29, "ControlSuggestions",ExpressionUUID->"37a7bb67-a3af-4f89-8f52-5d37a040be60",
   CellTags->"AutomaticAnimation"]},
 "BookmarkAnimation"->{
  Cell[489080, 10718, 1030, 24, 29, "ControlSuggestions",ExpressionUUID->"864ece68-376d-4170-adc9-25c78e91364c",
   CellTags->"BookmarkAnimation"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"ResizeImages", 497393, 10922},
 {"RotateAndZoomIn3D", 497560, 10925},
 {"DragLocators", 497727, 10928},
 {"CreateAndDeleteLocators", 497900, 10931},
 {"SliderZoom", 498071, 10934},
 {"GamepadControls", 498234, 10937},
 {"AutomaticAnimation", 498405, 10940},
 {"BookmarkAnimation", 498579, 10943}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[585, 22, 306, 4, 76, "DemoTitle",ExpressionUUID->"b61995fd-94db-4295-a261-80de9bb6280f"],
Cell[CellGroupData[{
Cell[916, 30, 88, 0, 301, "InitializationSection",ExpressionUUID->"903b8a71-0d03-4bac-8327-8cfc0eefcd3a"],
Cell[1007, 32, 7344, 183, 296, "Input",ExpressionUUID->"fcbff6a7-5c15-4c8f-8d76-7e3213d5bb41",
 InitializationCell->True,
 CellID->922119689],
Cell[8354, 217, 2322, 64, 154, "Input",ExpressionUUID->"74e4923b-d080-4e73-a4e6-482521c61e80",
 InitializationCell->True,
 CellID->202469671],
Cell[10679, 283, 3340, 78, 185, "Input",ExpressionUUID->"86bb489c-3b7e-4b26-a75c-8e32b7cb4e10",
 InitializationCell->True,
 CellID->177147],
Cell[14022, 363, 3229, 76, 185, "Input",ExpressionUUID->"44c85351-cdf0-4554-baca-72d453b7f84e",
 InitializationCell->True,
 CellID->46637666],
Cell[17254, 441, 266, 8, 50, "Input",ExpressionUUID->"578e6160-71c4-4b79-b574-32744f6b1a15",
 InitializationCell->True,
 CellID->218799681],
Cell[17523, 451, 346, 11, 51, "Input",ExpressionUUID->"8920b215-4693-42bb-9736-bbd8432a3e7e",
 InitializationCell->True,
 CellID->40409647],
Cell[17872, 464, 588, 14, 43, "Input",ExpressionUUID->"4b8b24bb-4aef-4995-9fec-186bc44333ea",
 InitializationCell->True,
 CellID->707626315],
Cell[18463, 480, 789, 16, 43, "Input",ExpressionUUID->"d339a15e-df09-4634-9a7a-ebe460e5680e",
 InitializationCell->True,
 CellID->94651572],
Cell[19255, 498, 605, 13, 43, "Input",ExpressionUUID->"55c441d0-d110-4553-b5b4-64cf0d1db4e0",
 InitializationCell->True,
 CellID->254988361],
Cell[19863, 513, 1011, 24, 63, "Input",ExpressionUUID->"15b4afb4-ec36-46ad-a12b-dbb4f02c1a02",
 InitializationCell->True,
 CellID->402911930],
Cell[20877, 539, 1094, 28, 82, "Input",ExpressionUUID->"665a78cf-6e2e-42cb-9cb6-6d4f2e3c068d",
 InitializationCell->True,
 CellID->124215]
}, Open  ]],
Cell[CellGroupData[{
Cell[22008, 572, 84, 0, 247, "ManipulateSection",ExpressionUUID->"558554a3-a7f3-4b6e-9501-7ba51edc5203"],
Cell[CellGroupData[{
Cell[22117, 576, 98883, 2295, 4921, "Input",ExpressionUUID->"2270e6d3-b229-4dcb-92a0-d4975bd41447"],
Cell[121003, 2873, 67063, 1394, 502, "Output",ExpressionUUID->"0179c184-4743-431e-a96d-03b7e9edc7ed",
 CellID->1747526224]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[188115, 4273, 91, 0, 181, "ManipulateCaptionSection",ExpressionUUID->"26e2ca32-add8-4453-98db-7b5dd267b96f"],
Cell[188209, 4275, 1163, 18, 55, "ManipulateCaption",ExpressionUUID->"e2f276fd-902c-49d3-9cde-e044363c6fab"]
}, Open  ]],
Cell[CellGroupData[{
Cell[189409, 4298, 83, 0, 179, "ThumbnailSection",ExpressionUUID->"2c98bbad-0e82-42cd-881c-8bab126bcd9d"],
Cell[189495, 4300, 66884, 1391, 503, InheritFromParent,ExpressionUUID->"92b9ed90-3221-45aa-8232-56c54fac04ec",
 CellID->321261046]
}, Open  ]],
Cell[CellGroupData[{
Cell[256416, 5696, 83, 0, 149, "SnapshotsSection",ExpressionUUID->"d16cfa91-ef01-4f24-97c7-d0a30d8234e5"],
Cell[256502, 5698, 66820, 1390, 502, "Output",ExpressionUUID->"8b33844a-b922-4db3-93cd-36862ce1a450",
 CellID->1537150000],
Cell[323325, 7090, 66818, 1390, 502, "Output",ExpressionUUID->"754ed7de-fb90-4c70-a404-4339692130a9",
 CellID->25974513],
Cell[390146, 8482, 66889, 1392, 502, "Output",ExpressionUUID->"a87645a3-fd10-4ce0-b0ed-cc7c1a15609f",
 CellID->567416889]
}, Open  ]],
Cell[CellGroupData[{
Cell[457072, 9879, 81, 0, 359, "DetailsSection",ExpressionUUID->"f61d10d2-97b5-419f-9836-6d6d9e75bfea"],
Cell[457156, 9881, 962, 14, 55, "DetailNotes",ExpressionUUID->"a01f2b5a-d7ad-4db1-8ef3-564e6e73ec52",
 CellID->1795169],
Cell[458121, 9897, 905, 24, 26, "DetailNotes",ExpressionUUID->"8dc62b4d-ddde-4742-aa78-36d0626cf3ec",
 CellID->32714542],
Cell[459029, 9923, 1187, 36, 27, "DetailNotes",ExpressionUUID->"11410f89-53ed-45fc-8e8f-40864fca1b0f",
 CellID->155155985],
Cell[460219, 9961, 1243, 39, 27, "DetailNotes",ExpressionUUID->"72fa3830-b091-4f05-9217-fb10cac3307e",
 CellID->346443311],
Cell[461465, 10002, 1056, 32, 25, "DetailNotes",ExpressionUUID->"c7b0041f-3c2b-4bcd-99c2-44548a69f8c7",
 CellID->371748320],
Cell[462524, 10036, 3821, 112, 45, "DetailNotes",ExpressionUUID->"b5a31d40-2da5-4be4-96b2-b4bbc902012b",
 CellID->514600296],
Cell[466348, 10150, 354, 7, 23, "DetailNotes",ExpressionUUID->"a7e62409-a6b8-42ee-ac0a-3de8ded67398",
 CellID->411988528],
Cell[466705, 10159, 725, 21, 26, "DetailNotes",ExpressionUUID->"237ff664-d39d-439b-9318-f2af2194c44d",
 CellID->131173849],
Cell[467433, 10182, 1209, 30, 25, "DetailNotes",ExpressionUUID->"836fde7e-f317-4684-a92e-e8932a3dc170",
 CellID->200669767],
Cell[468645, 10214, 795, 19, 23, "DetailNotes",ExpressionUUID->"344521ac-ae97-4d91-ab53-948cdc780109",
 CellID->158207208],
Cell[469443, 10235, 1136, 29, 23, "DetailNotes",ExpressionUUID->"3acfe47a-6618-4759-8772-eadf4943c635",
 CellID->549174646],
Cell[470582, 10266, 533, 14, 21, "DetailNotes",ExpressionUUID->"c645375b-0742-4988-b3dd-4810b87095b2",
 CellID->207624347],
Cell[471118, 10282, 279, 4, 23, "DetailNotes",ExpressionUUID->"14357deb-1faa-4eb0-8306-d80e37c492e1",
 CellID->247058506],
Cell[471400, 10288, 615, 16, 21, "DetailNotes",ExpressionUUID->"36519552-8329-4164-92a3-5305fb5c0e32",
 CellID->787679570],
Cell[472018, 10306, 719, 16, 23, "DetailNotes",ExpressionUUID->"e0d1bfbc-e499-491b-83a1-8eddca481d9b",
 CellID->115417136],
Cell[472740, 10324, 248, 3, 23, "DetailNotes",ExpressionUUID->"371a2b37-9dc3-422f-a71e-d0be3b23d1f1",
 CellID->636047144],
Cell[472991, 10329, 514, 13, 21, "DetailNotes",ExpressionUUID->"f81f76dd-f318-42b5-b215-41b3b7db2066",
 CellID->25549287],
Cell[473508, 10344, 244, 3, 23, "DetailNotes",ExpressionUUID->"c3d8b58a-b74b-41b9-a911-a9c16e9dc633",
 CellID->63399934],
Cell[473755, 10349, 540, 14, 21, "DetailNotes",ExpressionUUID->"1c307fe7-4991-4eed-898f-ba5ad3f7cf0e",
 CellID->509010446],
Cell[474298, 10365, 1257, 33, 39, "DetailNotes",ExpressionUUID->"c98a5cbb-8933-41f9-bb7d-73c23805b33d",
 CellID->215465713],
Cell[475558, 10400, 730, 14, 39, "DetailNotes",ExpressionUUID->"14d74a36-fe9b-42e1-888e-57faeb8aa883",
 CellID->253207522],
Cell[476291, 10416, 1211, 18, 23, "DetailNotes",ExpressionUUID->"1967b672-82e3-4d13-89d9-6f4ad543b0aa",
 CellID->196589969],
Cell[477505, 10436, 1433, 20, 23, "DetailNotes",ExpressionUUID->"81e12bce-e82b-4256-8be4-be4bbe1bdab6",
 CellID->182661868],
Cell[478941, 10458, 223, 3, 23, "DetailNotes",ExpressionUUID->"3f7d7c29-e5ad-4961-8079-66793a825468",
 CellID->650929921],
Cell[479167, 10463, 916, 21, 23, "DetailNotes",ExpressionUUID->"ea83c20d-6f74-4dff-8ebc-0d0554a8a8d2",
 CellID->795704731],
Cell[480086, 10486, 913, 21, 23, "DetailNotes",ExpressionUUID->"da501df3-21e0-4538-897b-1b0ba5f7c086",
 CellID->1033333502],
Cell[481002, 10509, 718, 18, 23, "DetailNotes",ExpressionUUID->"e512973b-7c7d-48e2-833a-0b1d421222bd",
 CellID->262511509],
Cell[481723, 10529, 748, 16, 23, "DetailNotes",ExpressionUUID->"a3463568-1f01-473c-add2-601f262ece4d",
 CellID->374100856],
Cell[482474, 10547, 819, 17, 23, "DetailNotes",ExpressionUUID->"08a62dd9-9232-41ee-964f-beedc21433ee",
 CellID->364587102]
}, Open  ]],
Cell[CellGroupData[{
Cell[483330, 10569, 92, 0, 131, "ControlSuggestionsSection",ExpressionUUID->"84b627ab-b25e-425d-ba44-8ef94fd36c29"],
Cell[483425, 10571, 492, 11, 29, "ControlSuggestions",ExpressionUUID->"b57ebdd4-fc85-4430-a179-57ac44fd5443",
 CellTags->"ResizeImages"],
Cell[483920, 10584, 800, 19, 29, "ControlSuggestions",ExpressionUUID->"2c809d5d-d8dd-49d1-8657-b0db7feb35b1",
 CellTags->"RotateAndZoomIn3D"],
Cell[484723, 10605, 500, 14, 29, "ControlSuggestions",ExpressionUUID->"094b96c1-713b-47a8-a4a4-b4642487f6e2",
 CellTags->"DragLocators"],
Cell[485226, 10621, 761, 19, 29, "ControlSuggestions",ExpressionUUID->"6759678e-d1d0-4c80-b9ad-140c38559201",
 CellTags->"CreateAndDeleteLocators"],
Cell[485990, 10642, 961, 23, 29, "ControlSuggestions",ExpressionUUID->"fb3fcc44-8656-47d0-80cb-8a92520918d6",
 CellTags->"SliderZoom"],
Cell[486954, 10667, 491, 12, 29, "ControlSuggestions",ExpressionUUID->"e8d2c1d1-d55c-48c3-b204-21453a89aaac",
 CellTags->"GamepadControls"],
Cell[487448, 10681, 1629, 35, 29, "ControlSuggestions",ExpressionUUID->"37a7bb67-a3af-4f89-8f52-5d37a040be60",
 CellTags->"AutomaticAnimation"],
Cell[489080, 10718, 1030, 24, 29, "ControlSuggestions",ExpressionUUID->"864ece68-376d-4170-adc9-25c78e91364c",
 CellTags->"BookmarkAnimation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[490147, 10747, 85, 0, 165, "SearchTermsSection",ExpressionUUID->"9276f611-b813-4a4e-bc01-2556afbd1aea"],
Cell[490235, 10749, 187, 2, 23, "SearchTerms",ExpressionUUID->"5aafd9dd-6cdb-46f9-91ca-c0e1421cf991",
 CellID->25273347],
Cell[490425, 10753, 234, 3, 23, "SearchTerms",ExpressionUUID->"41444075-4862-43a3-a766-d95f8db9d078",
 CellID->516856553],
Cell[490662, 10758, 190, 2, 23, "SearchTerms",ExpressionUUID->"958bd2f5-0379-437b-9376-677441967580",
 CellID->550405887],
Cell[490855, 10762, 222, 3, 23, "SearchTerms",ExpressionUUID->"acafbf92-7737-402b-863c-4bcfc10675e6",
 CellID->113825678],
Cell[491080, 10767, 244, 3, 23, "SearchTerms",ExpressionUUID->"f1697799-8041-4c7c-86b3-f9e01cb5b77a",
 CellID->123468224],
Cell[491327, 10772, 237, 3, 23, "SearchTerms",ExpressionUUID->"1d22be58-f79b-4688-8154-a1d379ec73c4",
 CellID->232056720],
Cell[491567, 10777, 230, 3, 23, "SearchTerms",ExpressionUUID->"6a38d77c-c6b0-4ef0-92f2-c264bdb33a5e",
 CellID->457814245],
Cell[491800, 10782, 236, 3, 23, "SearchTerms",ExpressionUUID->"c7e1ddfc-b4ec-41f9-a670-f8e6ecec6ab9",
 CellID->618351522],
Cell[492039, 10787, 206, 3, 23, "SearchTerms",ExpressionUUID->"d39fdd27-4374-4d50-a79f-e510268c52b8",
 CellID->87439811],
Cell[492248, 10792, 226, 3, 23, "SearchTerms",ExpressionUUID->"5e7645d2-4f46-4767-99b6-ceaf1911ad14",
 CellID->32782905]
}, Open  ]],
Cell[CellGroupData[{
Cell[492511, 10800, 86, 0, 149, "RelatedLinksSection",ExpressionUUID->"d7a99474-f9e9-47c4-83f9-fa3d5d412b5c"],
Cell[492600, 10802, 432, 9, 23, "RelatedLinks",ExpressionUUID->"cc81e418-6b79-454a-b45f-f5bd92a8049b",
 CellID->59120858],
Cell[493035, 10813, 412, 8, 23, "RelatedLinks",ExpressionUUID->"90c988dc-0325-4901-8645-d69b43fa2b83",
 CellID->140534484],
Cell[493450, 10823, 452, 9, 23, "RelatedLinks",ExpressionUUID->"51023410-b357-42a4-926d-e46363585a70",
 CellID->388109435],
Cell[493905, 10834, 482, 9, 23, "RelatedLinks",ExpressionUUID->"cee797c0-ce5b-44be-9a7f-21319d8d0bc2",
 CellID->348224188],
Cell[494390, 10845, 482, 10, 23, "RelatedLinks",ExpressionUUID->"8fe59bc2-ce28-4b13-9eaf-1ea014d77d8b",
 CellID->506300868]
}, Open  ]],
Cell[CellGroupData[{
Cell[494909, 10860, 80, 0, 149, "AuthorSection",ExpressionUUID->"28a8e73f-9b30-4362-aac0-efccd403eb2b"],
Cell[494992, 10862, 782, 16, 23, "Author",ExpressionUUID->"6a973b85-197c-4143-a7c2-5cda232ddc83",
 CellID->9119879],
Cell[495777, 10880, 848, 17, 23, "Author",ExpressionUUID->"0ead735c-4418-4c82-a7d8-ade567769af1",
 CellID->142231542],
Cell[496628, 10899, 352, 7, 23, "Author",ExpressionUUID->"6faaf441-b01f-48c8-aaa0-b96d98e8b3f1",
 CellID->122665613]
}, Open  ]]
}, Open  ]]
}
]
*)

