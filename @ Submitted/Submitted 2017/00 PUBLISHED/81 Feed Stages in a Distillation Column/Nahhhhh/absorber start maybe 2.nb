(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     62567,       1531]
NotebookOptionsPosition[     61884,       1503]
NotebookOutlinePosition[     62229,       1518]
CellTagsIndexPosition[     62186,       1515]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "colL", ",", "colV", ",", "\[Delta]x", ",", "\[Delta]y", ",", "\[Delta]w",
      ",", "\[Delta]h", ",", "th1", ",", "th2"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"colL", "=", "Blue"}], ";", 
    RowBox[{"colV", "=", 
     RowBox[{"RGBColor", "[", 
      RowBox[{"0", ",", "0.7", ",", "0"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Delta]x", "=", "1"}], ";", 
    RowBox[{"\[Delta]y", "=", 
     RowBox[{"0.4", "*", "\[Delta]x"}]}], ";", 
    RowBox[{"\[Delta]w", "=", 
     RowBox[{"0.35", "*", "\[Delta]x"}]}], ";", 
    RowBox[{"\[Delta]h", "=", 
     RowBox[{"0.5", "*", "\[Delta]y"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"th1", "=", "0.015"}], ";", 
    RowBox[{"th2", "=", "0.007"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Graphics", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EdgeForm", "@", "Thick"}], ",", 
          RowBox[{"FaceForm", "@", 
           RowBox[{"GrayLevel", "@", "0.95"}]}], ",", 
          RowBox[{"Rectangle", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Delta]x", ",", "\[Delta]y"}], "}"}]}], "]"}]}], "}"}],
         ",", "\[IndentingNewLine]", "Thick", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#", ",", 
               RowBox[{
                RowBox[{"-", "0.75"}], "*", "\[Delta]y"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"#", ",", 
               RowBox[{"1.75", "*", "\[Delta]y"}]}], "}"}]}], "}"}], "]"}], 
          "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"0", ",", "\[Delta]x"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Arrowheads", "@", "0.07"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Blue", ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"0.25", "*", "\[Delta]x"}], ",", 
               RowBox[{"\[Delta]y", "+", "\[Delta]h"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"0.25", "*", "\[Delta]x"}], ",", "\[Delta]y"}], 
              "}"}]}], "}"}], "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"0.25", "*", "\[Delta]x"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"0.25", "*", "\[Delta]x"}], ",", 
               RowBox[{"-", "\[Delta]h"}]}], "}"}]}], "}"}], "]"}]}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"RGBColor", "[", 
           RowBox[{"0", ",", "0.7", ",", "0"}], "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"0.75", "*", "\[Delta]x"}], ",", "\[Delta]y"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"0.75", "*", "\[Delta]x"}], ",", 
               RowBox[{"\[Delta]y", "+", "\[Delta]h"}]}], "}"}]}], "}"}], 
           "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"0.75", "*", "\[Delta]x"}], ",", 
               RowBox[{"-", "\[Delta]h"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"0.75", "*", "\[Delta]x"}], ",", "0"}], "}"}]}], "}"}],
            "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<X\>\"", ",", "Italic"}], "]"}], ",", "#1"}], 
               "]"}], ",", "18"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"0.25", "*", "\[Delta]x"}], ",", "#2"}], "}"}]}], "]"}],
           "&"}], "@@@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<n-1\>\"", ",", 
             RowBox[{"\[Delta]y", "+", 
              RowBox[{"1.2", "*", "\[Delta]h"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<n\>\"", ",", 
             RowBox[{
              RowBox[{"-", "1.2"}], "*", "\[Delta]h"}]}], "}"}]}], "}"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<Y\>\"", ",", "Italic"}], "]"}], ",", "#1"}], 
               "]"}], ",", "18"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"0.75", "*", "\[Delta]x"}], ",", "#2"}], "}"}]}], "]"}],
           "&"}], "@@@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<n\>\"", ",", 
             RowBox[{"\[Delta]y", "+", 
              RowBox[{"1.2", "*", "\[Delta]h"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<n+1\>\"", ",", 
             RowBox[{
              RowBox[{"-", "1.2"}], "*", "\[Delta]h"}]}], "}"}]}], "}"}]}]}], 
       "\[IndentingNewLine]", "}"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"600", ",", "400"}], "}"}]}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.699795727058833*^9, 3.6997958589893794`*^9}, {
  3.6997967928837953`*^9, 3.699796795402939*^9}, {3.70049097590088*^9, 
  3.7004909890226307`*^9}, {3.7004910525122623`*^9, 3.7004910789447737`*^9}, {
  3.70049122206096*^9, 3.700491314642255*^9}, {3.7004913576287136`*^9, 
  3.700491417383131*^9}, {3.700491626835111*^9, 3.700491753634364*^9}}],

Cell[BoxData[
 GraphicsBox[{
   {EdgeForm[Thickness[Large]], FaceForm[GrayLevel[0.95]], 
    RectangleBox[{0, 0}, {1, 0.4}]}, 
   {Thickness[
    Large], {LineBox[{{0, -0.30000000000000004`}, {0, 0.7000000000000001}}], 
     LineBox[{{1, -0.30000000000000004`}, {1, 0.7000000000000001}}]}, 
    {Arrowheads[0.07], 
     {RGBColor[0, 0, 1], ArrowBox[{{0.25, 0.6000000000000001}, {0.25, 0.4}}], 
      ArrowBox[{{0.25, 0}, {0.25, -0.2}}]}, 
     {RGBColor[0, 0.7, 0], 
      ArrowBox[{{0.75, 0.4}, {0.75, 0.6000000000000001}}], 
      ArrowBox[{{0.75, -0.2}, {0.75, 0}}]}, {InsetBox[
       StyleBox[
        SubscriptBox[
         StyleBox["\<\"X\"\>",
          StripOnInput->False,
          FontSlant->Italic], "\<\"n-1\"\>"],
        StripOnInput->False,
        FontSize->18], {0.25, 0.64}], InsetBox[
       StyleBox[
        SubscriptBox[
         StyleBox["\<\"X\"\>",
          StripOnInput->False,
          FontSlant->Italic], "\<\"n\"\>"],
        StripOnInput->False,
        FontSize->18], {0.25, -0.24}]}, {InsetBox[
       StyleBox[
        SubscriptBox[
         StyleBox["\<\"Y\"\>",
          StripOnInput->False,
          FontSlant->Italic], "\<\"n\"\>"],
        StripOnInput->False,
        FontSize->18], {0.75, 0.64}], InsetBox[
       StyleBox[
        SubscriptBox[
         StyleBox["\<\"Y\"\>",
          StripOnInput->False,
          FontSlant->Italic], "\<\"n+1\"\>"],
        StripOnInput->False,
        FontSize->18], {0.75, -0.24}]}}}},
  ImageSize->{600, 400}]], "Output",
 CellChangeTimes->{
  3.699795860350457*^9, {3.7004912591260796`*^9, 3.7004912814463563`*^9}, 
   3.700491315372297*^9, {3.70049136298602*^9, 3.7004914122068353`*^9}, {
   3.7004916823672876`*^9, 3.7004917543274035`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Ea", ",", "R", ",", "H0", ",", "HB", ",", "\[Rho]", ",", "MW", ",", 
       "\[Mu]", ",", "X0", ",", "Y1", ",", "XN", ",", "Yeq", ",", "YN1", ",", 
       "Yinlet", ",", "sol", ",", "check", ",", "check2", ",", "stage", ",", 
       "test", ",", "n", ",", "steps", ",", "stepping", ",", "KN", ",", 
       "E0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Ea", "=", "5000"}], ";", 
      RowBox[{"R", "=", "8.314"}], ";", "\[IndentingNewLine]", 
      RowBox[{"H0", "=", 
       RowBox[{"Hi", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{"211.19", "\[Equal]", 
            RowBox[{"Hi", "*", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "5000"}], "/", "8.314"}], "/", "298"}], 
              "]"}]}]}], ",", "Hi"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"HB", "=", 
       RowBox[{"H0", "*", 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          FractionBox["Ea", 
           RowBox[{"R", "*", 
            RowBox[{"(", 
             RowBox[{"T", "+", "273"}], ")"}]}]]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]", "=", "94.27"}], ";", 
      RowBox[{"(*", 
       RowBox[{"lb", "/", "ft3"}], "*)"}], 
      RowBox[{"MW", "=", "63.01"}], ";", 
      RowBox[{"(*", 
       RowBox[{"g", "/", "mol"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Mu]", "=", 
       RowBox[{"Quiet", "@", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "3.5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"20", ",", "2.5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"50", ",", "1.4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"100", ",", "0.7"}], "}"}]}], "}"}], "]"}], "[", "T", 
         "]"}]}]}], ";", 
      RowBox[{"(*", "cP", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"X0", "=", "0"}], ";", 
      RowBox[{"Y1", "=", "10"}], ";", 
      RowBox[{"XN", "=", "1.3"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Yeq", "[", "x_", "]"}], ":=", 
       RowBox[{
        FractionBox["HB", "P"], "*", "x"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"YN1", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{"LV", "*", 
         RowBox[{"(", 
          RowBox[{"x", "-", "X0"}], ")"}]}], "+", "Y1"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Yinlet", "[", "x_", "]"}], ":=", "yn1"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Yeq", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"Yinlet", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"check", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"YN1", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"Yinlet", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"check2", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Yeq", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"YN1", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"stage", "[", "1", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Yeq", "[", "x", "]"}], "\[Equal]", "Y1"}], ",", "x"}], 
          "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"stage", "[", "i", "]"}], "=", 
         RowBox[{"x", "/.", 
          RowBox[{
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Yeq", "[", "x", "]"}], "\[Equal]", 
              RowBox[{"YN1", "[", 
               RowBox[{"stage", "[", 
                RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ",", "x"}], "]"}], 
           "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", "50"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"test", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"stage", "[", "n", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", "50"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"n", "=", "1"}], ";", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"test", "[", 
           RowBox[{"[", "n", "]"}], "]"}], "<", "check"}], "\[And]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"check2", ">", "0"}], ",", 
           RowBox[{
            RowBox[{"Yeq", "[", "check2", "]"}], ">", 
            RowBox[{"Yinlet", "[", "check2", "]"}]}], ",", "True"}], "]"}]}], 
        ",", 
        RowBox[{"n", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"test", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"Yeq", "[", 
                RowBox[{"test", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"test", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"YN1", "[", 
                RowBox[{"test", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "}"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "1"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"stepping", "=", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", "Y1"}], "}"}], "}"}], ",", "steps"}], "]"}], 
         ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"2", "*", "n"}], "+", "1"}], ",", "2"}], "}"}], 
          "\[Rule]", "yn1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"KN", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"YN1", "[", "n", "]"}], 
         RowBox[{"1", "+", 
          RowBox[{"YN1", "[", "n", "]"}]}]], "/", 
        FractionBox["XN", 
         RowBox[{"1", "+", "XN"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"E0", "=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"1.597", "-", 
          RowBox[{"0.199", "*", 
           RowBox[{"Log10", "[", 
            FractionBox[
             RowBox[{"KN", "*", "MW", "*", "\[Mu]"}], "\[Rho]"], "]"}]}], "-", 
          RowBox[{"0.0896", "*", 
           SuperscriptBox[
            RowBox[{"Log10", "[", 
             FractionBox[
              RowBox[{"KN", "*", "MW", "*", "\[Mu]"}], "\[Rho]"], "]"}], 
            "2"]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Yeq", "[", "x", "]"}], ",", 
          RowBox[{"YN1", "[", "x", "]"}], ",", 
          RowBox[{"Yinlet", "[", "x", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", "XN"}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Dashed", ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "0.6", ",", "0"}], "]"}]}], "}"}]}], "}"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Row", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<X\>\"", ",", "Italic"}], "]"}], ",", 
              "\"\< (ppm)\>\""}], "}"}]}], ",", 
           RowBox[{"Row", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<Y\>\"", ",", "Italic"}], "]"}], ",", 
              "\"\< (ppm)\>\""}], "}"}]}]}], "}"}]}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"17", ",", "Black"}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"YN1", "[", "n", "]"}], 
             RowBox[{"1", "+", 
              RowBox[{"YN1", "[", "n", "]"}]}]], "/", 
            FractionBox["XN", 
             RowBox[{"1", "+", "XN"}]]}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Yeq", "[", "n", "]"}], 
             RowBox[{"1", "+", 
              RowBox[{"Yeq", "[", "n", "]"}]}]], "/", 
            FractionBox["XN", 
             RowBox[{"1", "+", "XN"}]]}], ",", "n"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Line", "[", "stepping", "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"#", ",", "16"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"stage", "[", "#", "]"}], "+", "0.025"}], ",", 
                 RowBox[{
                  RowBox[{"Yeq", "[", 
                   RowBox[{"stage", "[", "#", "]"}], "]"}], "-", "3"}]}], 
                "}"}]}], "]"}], "&"}], "/@", 
            RowBox[{"Range", "@", "n"}]}]}], "\[IndentingNewLine]", "}"}]}]}],
        "]"}], ";", "E0"}]}], "\[IndentingNewLine]", "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"P", ",", "2.5", ",", "\"\<pressure (atm)\>\""}], "}"}], 
            ",", "1.5", ",", "3", ",", "0.1", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}], ",", 
         "SpanFromLeft", ",", "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"T", ",", "25", ",", "\"\<Temperature \[Degree]C\>\""}], 
             "}"}], ",", "10", ",", "80", ",", "5", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}], ",", 
         "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"LV", ",", "100", ",", 
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<L\>\"", ",", "Italic"}], "]"}], ",", 
                 "\"\</\>\"", ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<V\>\"", ",", "Italic"}], "]"}]}], "}"}]}]}], 
             "}"}], ",", "50", ",", "300", ",", "5", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], 
           RowBox[{"(*", 
            RowBox[{",", 
             RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "*)"}], "}"}], 
          "]"}], ",", "SpanFromLeft", ",", "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "yn1", ",", "100", ",", "\"\<inlet concentration (ppm)\>\""}], 
             "}"}], ",", "40", ",", "120", ",", "1", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}]}], 
        "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.6997970767830334`*^9, 3.699797548186996*^9}, {
  3.699797587490244*^9, 3.6997976215041895`*^9}, {3.6997976705029917`*^9, 
  3.699797712735408*^9}, {3.699797775086974*^9, 3.6997977879837112`*^9}, {
  3.6997978384645987`*^9, 3.6997978609778867`*^9}, {3.699798348563775*^9, 
  3.6997983810086308`*^9}, {3.69979847156281*^9, 3.699798541579815*^9}, {
  3.699798587848461*^9, 3.699798823350931*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`LV$$ = 290, $CellContext`P$$ = 
    3., $CellContext`T$$ = 10, $CellContext`yn1$$ = 40, Typeset`show$$ = True,
     Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`P$$], 2.5, "pressure (atm)"}, 1.5, 3, 0.1}, {{
       Hold[$CellContext`T$$], 25, "Temperature \[Degree]C"}, 10, 80, 5}, {{
       Hold[$CellContext`LV$$], 100, 
       Row[{
         Style["L", Italic], "/", 
         Style["V", Italic]}]}, 50, 300, 5}, {{
       Hold[$CellContext`yn1$$], 100, "inlet concentration (ppm)"}, 40, 120, 
      1}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], SpanFromLeft, 
          Manipulate`Place[2], SpanFromLeft}, {
          Manipulate`Place[3], SpanFromLeft, 
          Manipulate`Place[4]}}, Alignment -> Left]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {35., {0., 8.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`P$201979$$ = 0, $CellContext`T$201980$$ = 
    0, $CellContext`LV$201981$$ = 0, $CellContext`yn1$201982$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`LV$$ = 100, $CellContext`P$$ = 
        2.5, $CellContext`T$$ = 25, $CellContext`yn1$$ = 100}, 
      "ControllerVariables" :> {
        Hold[$CellContext`P$$, $CellContext`P$201979$$, 0], 
        Hold[$CellContext`T$$, $CellContext`T$201980$$, 0], 
        Hold[$CellContext`LV$$, $CellContext`LV$201981$$, 0], 
        Hold[$CellContext`yn1$$, $CellContext`yn1$201982$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`Ea$, $CellContext`R$, $CellContext`H0$, \
$CellContext`HB$, $CellContext`\[Rho]$, $CellContext`MW$, \
$CellContext`\[Mu]$, $CellContext`X0$, $CellContext`Y1$, $CellContext`XN$, \
$CellContext`Yeq$, $CellContext`YN1$, $CellContext`Yinlet$, \
$CellContext`sol$, $CellContext`check$, $CellContext`check2$, \
$CellContext`stage$, $CellContext`test$, $CellContext`n$, \
$CellContext`steps$, $CellContext`stepping$, $CellContext`KN$, \
$CellContext`E0$}, $CellContext`Ea$ = 5000; $CellContext`R$ = 
         8.314; $CellContext`H0$ = ReplaceAll[$CellContext`Hi, 
           Part[
            Solve[
            211.19 == $CellContext`Hi 
              Exp[((-5000)/8.314)/298], $CellContext`Hi], 
            1]]; $CellContext`HB$ = $CellContext`H0$ 
          Exp[-($CellContext`Ea$/($CellContext`R$ ($CellContext`T$$ + 
              273)))]; $CellContext`\[Rho]$ = 94.27; $CellContext`MW$ = 
         63.01; $CellContext`\[Mu]$ = Quiet[
           
           Interpolation[{{0, 3.5}, {20, 2.5}, {50, 1.4}, {
             100, 0.7}}][$CellContext`T$$]]; $CellContext`X0$ = 
         0; $CellContext`Y1$ = 10; $CellContext`XN$ = 1.3; $CellContext`Yeq$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := ($CellContext`HB$/$CellContext`P$$) $CellContext`x$; \
$CellContext`YN1$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`LV$$ ($CellContext`x$ - \
$CellContext`X0$) + $CellContext`Y1$; $CellContext`Yinlet$[
           Pattern[$CellContext`x$, 
            Blank[]]] := $CellContext`yn1$$; $CellContext`sol$ = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`Yeq$[$CellContext`x] == \
$CellContext`Yinlet$[$CellContext`x], $CellContext`x], 
            1]]; $CellContext`check$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`YN1$[$CellContext`x] == \
$CellContext`Yinlet$[$CellContext`x], $CellContext`x], 
            1]]; $CellContext`check2$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`Yeq$[$CellContext`x] == \
$CellContext`YN1$[$CellContext`x], $CellContext`x], 1]]; $CellContext`stage$[
          1] = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`Yeq$[$CellContext`x] == $CellContext`Y1$, \
$CellContext`x], 1]]; 
        Do[$CellContext`stage$[$CellContext`i] = ReplaceAll[$CellContext`x, 
            Part[
             Solve[$CellContext`Yeq$[$CellContext`x] == $CellContext`YN1$[
                $CellContext`stage$[$CellContext`i - 1]], $CellContext`x], 
             1]], {$CellContext`i, 2, 50}]; $CellContext`test$ = Table[
           $CellContext`stage$[$CellContext`n$], {$CellContext`n$, 1, 
            50}]; $CellContext`n$ = 1; While[
          And[Part[$CellContext`test$, $CellContext`n$] < $CellContext`check$, 
           
           If[$CellContext`check2$ > 
            0, $CellContext`Yeq$[$CellContext`check2$] > \
$CellContext`Yinlet$[$CellContext`check2$], True]], 
          Increment[$CellContext`n$]]; $CellContext`steps$ = Flatten[
           Table[{{
              Part[$CellContext`test$, $CellContext`i], 
              $CellContext`Yeq$[
               Part[$CellContext`test$, $CellContext`i]]}, {
              Part[$CellContext`test$, $CellContext`i], 
              $CellContext`YN1$[
               Part[$CellContext`test$, $CellContext`i]]}}, {$CellContext`i, 
             1, $CellContext`n$}], 1]; $CellContext`stepping$ = ReplacePart[
           
           Join[{{0, $CellContext`Y1$}}, $CellContext`steps$], {
            2 $CellContext`n$ + 1, 
             2} -> $CellContext`yn1$$]; $CellContext`KN$ = \
($CellContext`YN1$[$CellContext`n$]/(
           1 + $CellContext`YN1$[$CellContext`n$]))/($CellContext`XN$/(
          1 + $CellContext`XN$)); $CellContext`E0$ = 
         10^(1.597 - 0.199 
           Log10[($CellContext`KN$ $CellContext`MW$) \
($CellContext`\[Mu]$/$CellContext`\[Rho]$)] - 0.0896 
           Log10[($CellContext`KN$ $CellContext`MW$) \
($CellContext`\[Mu]$/$CellContext`\[Rho]$)]^2); Plot[{
           $CellContext`Yeq$[$CellContext`x], 
           $CellContext`YN1$[$CellContext`x], 
           $CellContext`Yinlet$[$CellContext`x]}, {$CellContext`x, 
           0, $CellContext`XN$}, 
          PlotStyle -> {{Thick, Blue}, {Thick, Black}, {Thick, Dashed, 
             RGBColor[0, 0.6, 0]}}, Frame -> True, FrameLabel -> {
            Row[{
              Style["X", Italic], " (ppm)"}], 
            Row[{
              Style["Y", Italic], " (ppm)"}]}, LabelStyle -> {17, Black}, 
          ImageSize -> 600, 
          PlotLabel -> {($CellContext`YN1$[$CellContext`n$]/(
             1 + $CellContext`YN1$[$CellContext`n$]))/($CellContext`XN$/(
            1 + $CellContext`XN$)), ($CellContext`Yeq$[$CellContext`n$]/(
             1 + $CellContext`Yeq$[$CellContext`n$]))/($CellContext`XN$/(
            1 + $CellContext`XN$)), $CellContext`n$}, Epilog -> {
            Line[$CellContext`stepping$], 
            Map[Text[
              Style[#, 16], {$CellContext`stage$[#] + 0.025, $CellContext`Yeq$[
                 $CellContext`stage$[#]] - 3}]& , 
             Range[$CellContext`n$]]}]; $CellContext`E0$], 
      "Specifications" :> {{{$CellContext`P$$, 2.5, "pressure (atm)"}, 1.5, 3,
          0.1, Appearance -> "Labeled", ImageSize -> Small, ControlPlacement -> 
         1}, {{$CellContext`T$$, 25, "Temperature \[Degree]C"}, 10, 80, 5, 
         Appearance -> "Labeled", ImageSize -> Small, ControlPlacement -> 
         2}, {{$CellContext`LV$$, 100, 
          Row[{
            Style["L", Italic], "/", 
            Style["V", Italic]}]}, 50, 300, 5, Appearance -> "Labeled", 
         ControlPlacement -> 
         3}, {{$CellContext`yn1$$, 100, "inlet concentration (ppm)"}, 40, 120,
          1, Appearance -> "Labeled", ImageSize -> Small, ControlPlacement -> 
         4}, 
        Grid[{{
           Manipulate`Place[1], SpanFromLeft, 
           Manipulate`Place[2], SpanFromLeft}, {
           Manipulate`Place[3], SpanFromLeft, 
           Manipulate`Place[4]}}, Alignment -> Left]}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{633., {63., 70.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.699796802632353*^9, {3.699797107002762*^9, 3.6997971491011696`*^9}, {
   3.69979733950406*^9, 3.699797500963295*^9}, {3.6997975415206146`*^9, 
   3.6997975485840187`*^9}, {3.6997975976888275`*^9, 
   3.6997976224442434`*^9}, {3.69979770071672*^9, 3.6997977136134577`*^9}, 
   3.6997977886567497`*^9, {3.699797847454113*^9, 3.6997978617239294`*^9}, {
   3.6997986137129407`*^9, 3.699798644180683*^9}, 3.699798804829872*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Ea", ",", "R", ",", "H0", ",", "HB", ",", "\[Rho]", ",", "MW", ",", 
       "\[Mu]", ",", "X0", ",", "Y1", ",", "yn1", ",", "Yeq", ",", "YN1", ",",
        "Yinlet", ",", "sol", ",", "check", ",", "check2", ",", "stage", ",", 
       "test", ",", "n", ",", "KN", ",", "E0", ",", "XN"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Ea", "=", "5000"}], ";", 
      RowBox[{"R", "=", "8.314"}], ";", "\[IndentingNewLine]", 
      RowBox[{"H0", "=", 
       RowBox[{"Hi", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{"211.19", "\[Equal]", 
            RowBox[{"Hi", "*", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "5000"}], "/", "8.314"}], "/", "298"}], 
              "]"}]}]}], ",", "Hi"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"HB", "=", 
       RowBox[{"H0", "*", 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          FractionBox["Ea", 
           RowBox[{"R", "*", 
            RowBox[{"(", 
             RowBox[{"T", "+", "273"}], ")"}]}]]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]", "=", "94.27"}], ";", 
      RowBox[{"(*", 
       RowBox[{"lb", "/", "ft3"}], "*)"}], 
      RowBox[{"MW", "=", "63.01"}], ";", 
      RowBox[{"(*", 
       RowBox[{"g", "/", "mol"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Mu]", "=", 
       RowBox[{"Quiet", "@", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "3.5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"20", ",", "2.5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"50", ",", "1.4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"100", ",", "0.7"}], "}"}]}], "}"}], "]"}], "[", "T", 
         "]"}]}]}], ";", 
      RowBox[{"(*", "cP", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"X0", "=", "0"}], ";", 
      RowBox[{"Y1", "=", "10"}], ";", 
      RowBox[{"yn1", "=", "100"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Yeq", "[", "x_", "]"}], ":=", 
       RowBox[{
        FractionBox["HB", "P"], "*", "x"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"YN1", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{"LV", "*", 
         RowBox[{"(", 
          RowBox[{"x", "-", "X0"}], ")"}]}], "+", "Y1"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Yinlet", "[", "x_", "]"}], ":=", "yn1"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Yeq", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"Yinlet", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"check", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"YN1", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"Yinlet", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"check2", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Yeq", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"YN1", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"stage", "[", "1", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Yeq", "[", "x", "]"}], "\[Equal]", "Y1"}], ",", "x"}], 
          "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"stage", "[", "i", "]"}], "=", 
         RowBox[{"x", "/.", 
          RowBox[{
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Yeq", "[", "x", "]"}], "\[Equal]", 
              RowBox[{"YN1", "[", 
               RowBox[{"stage", "[", 
                RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ",", "x"}], "]"}], 
           "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", "50"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"test", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"stage", "[", "n", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", "50"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"n", "=", "1"}], ";", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"test", "[", 
           RowBox[{"[", "n", "]"}], "]"}], "<", "check"}], "\[And]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"check2", ">", "0"}], ",", 
           RowBox[{
            RowBox[{"Yeq", "[", "check2", "]"}], ">", 
            RowBox[{"Yinlet", "[", "check2", "]"}]}], ",", "True"}], "]"}]}], 
        ",", 
        RowBox[{"n", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"KN", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"YN1", "[", "n", "]"}], 
         RowBox[{"1", "+", 
          RowBox[{"YN1", "[", "n", "]"}]}]], "/", 
        FractionBox["xn", 
         RowBox[{"1", "+", "xn"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"E0", "=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"1.597", "-", 
          RowBox[{"0.199", "*", 
           RowBox[{"Log10", "[", 
            FractionBox[
             RowBox[{"KN", "*", "MW", "*", "\[Mu]"}], "\[Rho]"], "]"}]}], "-", 
          RowBox[{"0.0896", "*", 
           SuperscriptBox[
            RowBox[{"Log10", "[", 
             FractionBox[
              RowBox[{"KN", "*", "MW", "*", "\[Mu]"}], "\[Rho]"], "]"}], 
            "2"]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"XN", "=", 
       RowBox[{"xn", "/.", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{"E0", "\[Equal]", "e0"}], ",", 
          RowBox[{"{", 
           RowBox[{"xn", ",", "0.1"}], "}"}]}], "]"}]}]}]}]}], 
    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"P", ",", "2.5", ",", "\"\<pressure (atm)\>\""}], "}"}], 
            ",", "1.5", ",", "3", ",", "0.1", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}], ",", 
         "SpanFromLeft", ",", "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"T", ",", "25", ",", "\"\<Temperature \[Degree]C\>\""}], 
             "}"}], ",", "10", ",", "80", ",", "5", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}], ",", 
         "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"LV", ",", "100", ",", 
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<L\>\"", ",", "Italic"}], "]"}], ",", 
                 "\"\</\>\"", ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<V\>\"", ",", "Italic"}], "]"}]}], "}"}]}]}], 
             "}"}], ",", "50", ",", "300", ",", "5", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], 
           RowBox[{"(*", 
            RowBox[{",", 
             RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "*)"}], "}"}], 
          "]"}], ",", "SpanFromLeft", ",", "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"e0", ",", "31", ",", "\"\<efficiency\>\""}], "}"}], ",",
             "10", ",", "35", ",", "1", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}]}], 
        "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.69979889553006*^9, 3.6997989416126957`*^9}, {
  3.7009185104941225`*^9, 3.700918510665723*^9}, {3.700918545922687*^9, 
  3.7009185740969276`*^9}, {3.700918608452739*^9, 3.7009186326324787`*^9}, {
  3.7009186678012996`*^9, 3.700918690220824*^9}, {3.7009187366686163`*^9, 
  3.700918876816114*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`e0$$ = 31, $CellContext`LV$$ = 
    100, $CellContext`P$$ = 2.5, $CellContext`T$$ = 25, Typeset`show$$ = True,
     Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`P$$], 2.5, "pressure (atm)"}, 1.5, 3, 0.1}, {{
       Hold[$CellContext`T$$], 25, "Temperature \[Degree]C"}, 10, 80, 5}, {{
       Hold[$CellContext`LV$$], 100, 
       Row[{
         Style["L", Italic], "/", 
         Style["V", Italic]}]}, 50, 300, 5}, {{
       Hold[$CellContext`e0$$], 31, "efficiency"}, 10, 35, 1}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], SpanFromLeft, 
          Manipulate`Place[2], SpanFromLeft}, {
          Manipulate`Place[3], SpanFromLeft, 
          Manipulate`Place[4]}}, Alignment -> Left]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {35., {0., 8.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`P$30364$$ = 0, $CellContext`T$30365$$ = 
    0, $CellContext`LV$30366$$ = 0, $CellContext`e0$30367$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`e0$$ = 31, $CellContext`LV$$ = 
        100, $CellContext`P$$ = 2.5, $CellContext`T$$ = 25}, 
      "ControllerVariables" :> {
        Hold[$CellContext`P$$, $CellContext`P$30364$$, 0], 
        Hold[$CellContext`T$$, $CellContext`T$30365$$, 0], 
        Hold[$CellContext`LV$$, $CellContext`LV$30366$$, 0], 
        Hold[$CellContext`e0$$, $CellContext`e0$30367$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`Ea$, $CellContext`R$, $CellContext`H0$, \
$CellContext`HB$, $CellContext`\[Rho]$, $CellContext`MW$, \
$CellContext`\[Mu]$, $CellContext`X0$, $CellContext`Y1$, $CellContext`yn1$, \
$CellContext`Yeq$, $CellContext`YN1$, $CellContext`Yinlet$, \
$CellContext`sol$, $CellContext`check$, $CellContext`check2$, \
$CellContext`stage$, $CellContext`test$, $CellContext`n$, $CellContext`KN$, \
$CellContext`E0$, $CellContext`XN$}, $CellContext`Ea$ = 5000; $CellContext`R$ = 
         8.314; $CellContext`H0$ = ReplaceAll[$CellContext`Hi, 
           Part[
            Solve[
            211.19 == $CellContext`Hi 
              Exp[((-5000)/8.314)/298], $CellContext`Hi], 
            1]]; $CellContext`HB$ = $CellContext`H0$ 
          Exp[-($CellContext`Ea$/($CellContext`R$ ($CellContext`T$$ + 
              273)))]; $CellContext`\[Rho]$ = 94.27; $CellContext`MW$ = 
         63.01; $CellContext`\[Mu]$ = Quiet[
           
           Interpolation[{{0, 3.5}, {20, 2.5}, {50, 1.4}, {
             100, 0.7}}][$CellContext`T$$]]; $CellContext`X0$ = 
         0; $CellContext`Y1$ = 10; $CellContext`yn1$ = 100; $CellContext`Yeq$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := ($CellContext`HB$/$CellContext`P$$) $CellContext`x$; \
$CellContext`YN1$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`LV$$ ($CellContext`x$ - \
$CellContext`X0$) + $CellContext`Y1$; $CellContext`Yinlet$[
           Pattern[$CellContext`x$, 
            Blank[]]] := $CellContext`yn1$; $CellContext`sol$ = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`Yeq$[$CellContext`x] == \
$CellContext`Yinlet$[$CellContext`x], $CellContext`x], 
            1]]; $CellContext`check$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`YN1$[$CellContext`x] == \
$CellContext`Yinlet$[$CellContext`x], $CellContext`x], 
            1]]; $CellContext`check2$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`Yeq$[$CellContext`x] == \
$CellContext`YN1$[$CellContext`x], $CellContext`x], 1]]; $CellContext`stage$[
          1] = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`Yeq$[$CellContext`x] == $CellContext`Y1$, \
$CellContext`x], 1]]; 
        Do[$CellContext`stage$[$CellContext`i] = ReplaceAll[$CellContext`x, 
            Part[
             Solve[$CellContext`Yeq$[$CellContext`x] == $CellContext`YN1$[
                $CellContext`stage$[$CellContext`i - 1]], $CellContext`x], 
             1]], {$CellContext`i, 2, 50}]; $CellContext`test$ = Table[
           $CellContext`stage$[$CellContext`n$], {$CellContext`n$, 1, 
            50}]; $CellContext`n$ = 1; While[
          And[Part[$CellContext`test$, $CellContext`n$] < $CellContext`check$, 
           
           If[$CellContext`check2$ > 
            0, $CellContext`Yeq$[$CellContext`check2$] > \
$CellContext`Yinlet$[$CellContext`check2$], True]], 
          
          Increment[$CellContext`n$]]; $CellContext`KN$ = \
($CellContext`YN1$[$CellContext`n$]/(
           1 + $CellContext`YN1$[$CellContext`n$]))/($CellContext`xn/(
          1 + $CellContext`xn)); $CellContext`E0$ = 
         10^(1.597 - 0.199 
           Log10[$CellContext`KN$ $CellContext`MW$ \
$CellContext`\[Mu]$/$CellContext`\[Rho]$] - 0.0896 
           Log10[$CellContext`KN$ $CellContext`MW$ \
$CellContext`\[Mu]$/$CellContext`\[Rho]$]^2); $CellContext`XN$ = 
         ReplaceAll[$CellContext`xn, 
           
           FindRoot[$CellContext`E0$ == $CellContext`e0$$, {$CellContext`xn, 
             0.1}]]], 
      "Specifications" :> {{{$CellContext`P$$, 2.5, "pressure (atm)"}, 1.5, 3,
          0.1, Appearance -> "Labeled", ImageSize -> Small, ControlPlacement -> 
         1}, {{$CellContext`T$$, 25, "Temperature \[Degree]C"}, 10, 80, 5, 
         Appearance -> "Labeled", ImageSize -> Small, ControlPlacement -> 
         2}, {{$CellContext`LV$$, 100, 
          Row[{
            Style["L", Italic], "/", 
            Style["V", Italic]}]}, 50, 300, 5, Appearance -> "Labeled", 
         ControlPlacement -> 3}, {{$CellContext`e0$$, 31, "efficiency"}, 10, 
         35, 1, Appearance -> "Labeled", ImageSize -> Small, ControlPlacement -> 
         4}, 
        Grid[{{
           Manipulate`Place[1], SpanFromLeft, 
           Manipulate`Place[2], SpanFromLeft}, {
           Manipulate`Place[3], SpanFromLeft, 
           Manipulate`Place[4]}}, Alignment -> Left]}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{567., {63., 70.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.6997989446888714`*^9, 3.700918634951085*^9, {3.700918785586971*^9, 
   3.7009188779055166`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "P", ",", "T", ",", "LV", ",", "Ea", ",", "R", ",", "H0", ",", "HB", 
       ",", "\[Rho]", ",", "MW", ",", "\[Mu]", ",", "X0", ",", "Y1", ",", 
       "yn1", ",", "Yeq", ",", "YN1", ",", "Yinlet", ",", "sol", ",", "check",
        ",", "check2", ",", "stage", ",", "test", ",", "n", ",", "KN", ",", 
       "E0", ",", "XN"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"P", "=", "2.5"}], ";", 
      RowBox[{"T", "=", "25"}], ";", 
      RowBox[{"LV", "=", "100"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Ea", "=", "5000"}], ";", 
      RowBox[{"R", "=", "8.314"}], ";", "\[IndentingNewLine]", 
      RowBox[{"H0", "=", 
       RowBox[{"Hi", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{"211.19", "\[Equal]", 
            RowBox[{"Hi", "*", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "5000"}], "/", "8.314"}], "/", "298"}], 
              "]"}]}]}], ",", "Hi"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"HB", "=", 
       RowBox[{"H0", "*", 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          FractionBox["Ea", 
           RowBox[{"R", "*", 
            RowBox[{"(", 
             RowBox[{"T", "+", "273"}], ")"}]}]]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]", "=", "94.27"}], ";", 
      RowBox[{"(*", 
       RowBox[{"lb", "/", "ft3"}], "*)"}], 
      RowBox[{"MW", "=", "63.01"}], ";", 
      RowBox[{"(*", 
       RowBox[{"g", "/", "mol"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Mu]", "=", 
       RowBox[{"Quiet", "@", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "3.5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"20", ",", "2.5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"50", ",", "1.4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"100", ",", "0.7"}], "}"}]}], "}"}], "]"}], "[", "T", 
         "]"}]}]}], ";", 
      RowBox[{"(*", "cP", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"X0", "=", "0"}], ";", 
      RowBox[{"Y1", "=", "10"}], ";", 
      RowBox[{"yn1", "=", "100"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Yeq", "[", "x_", "]"}], ":=", 
       RowBox[{
        FractionBox["HB", "P"], "*", "x"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"YN1", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{"LV", "*", 
         RowBox[{"(", 
          RowBox[{"x", "-", "X0"}], ")"}]}], "+", "Y1"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Yinlet", "[", "x_", "]"}], ":=", "yn1"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Yeq", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"Yinlet", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"check", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"YN1", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"Yinlet", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"check2", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Yeq", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"YN1", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"stage", "[", "1", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Yeq", "[", "x", "]"}], "\[Equal]", "Y1"}], ",", "x"}], 
          "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"stage", "[", "i", "]"}], "=", 
         RowBox[{"x", "/.", 
          RowBox[{
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Yeq", "[", "x", "]"}], "\[Equal]", 
              RowBox[{"YN1", "[", 
               RowBox[{"stage", "[", 
                RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ",", "x"}], "]"}], 
           "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", "50"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"test", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"stage", "[", "n", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", "50"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"n", "=", "1"}], ";", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"test", "[", 
           RowBox[{"[", "n", "]"}], "]"}], "<", "check"}], "\[And]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"check2", ">", "0"}], ",", 
           RowBox[{
            RowBox[{"Yeq", "[", "check2", "]"}], ">", 
            RowBox[{"Yinlet", "[", "check2", "]"}]}], ",", "True"}], "]"}]}], 
        ",", 
        RowBox[{"n", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"KN", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"YN1", "[", "n", "]"}], 
         RowBox[{"1", "+", 
          RowBox[{"YN1", "[", "n", "]"}]}]], "/", 
        FractionBox["xn", 
         RowBox[{"1", "+", "xn"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"E0", "=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"1.597", "-", 
          RowBox[{"0.199", "*", 
           RowBox[{"Log10", "[", 
            FractionBox[
             RowBox[{"KN", "*", "MW", "*", "\[Mu]"}], "\[Rho]"], "]"}]}], "-", 
          RowBox[{"0.0896", "*", 
           SuperscriptBox[
            RowBox[{"Log10", "[", 
             FractionBox[
              RowBox[{"KN", "*", "MW", "*", "\[Mu]"}], "\[Rho]"], "]"}], 
            "2"]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"XN", "=", 
       RowBox[{"xn", "/.", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{"E0", "\[Equal]", "e0"}], ",", 
          RowBox[{"{", 
           RowBox[{"xn", ",", "0.1"}], "}"}]}], "]"}]}]}]}]}], 
    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"e0", ",", "31", ",", "\"\<efficiency\>\""}], "}"}], ",", "10",
       ",", "35", ",", "1", ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.700918889800971*^9, 3.7009189248521423`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`e0$$ = 27, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`e0$$], 31, "efficiency"}, 10, 35, 1}}, 
    Typeset`size$$ = {42., {0., 8.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`e0$30524$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`e0$$ = 31}, 
      "ControllerVariables" :> {
        Hold[$CellContext`e0$$, $CellContext`e0$30524$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`P$, $CellContext`T$, $CellContext`LV$, \
$CellContext`Ea$, $CellContext`R$, $CellContext`H0$, $CellContext`HB$, \
$CellContext`\[Rho]$, $CellContext`MW$, $CellContext`\[Mu]$, \
$CellContext`X0$, $CellContext`Y1$, $CellContext`yn1$, $CellContext`Yeq$, \
$CellContext`YN1$, $CellContext`Yinlet$, $CellContext`sol$, \
$CellContext`check$, $CellContext`check2$, $CellContext`stage$, \
$CellContext`test$, $CellContext`n$, $CellContext`KN$, $CellContext`E0$, \
$CellContext`XN$}, $CellContext`P$ = 2.5; $CellContext`T$ = 
         25; $CellContext`LV$ = 100; $CellContext`Ea$ = 5000; $CellContext`R$ = 
         8.314; $CellContext`H0$ = ReplaceAll[$CellContext`Hi, 
           Part[
            Solve[
            211.19 == $CellContext`Hi 
              Exp[((-5000)/8.314)/298], $CellContext`Hi], 
            1]]; $CellContext`HB$ = $CellContext`H0$ 
          Exp[-($CellContext`Ea$/($CellContext`R$ ($CellContext`T$ + 
              273)))]; $CellContext`\[Rho]$ = 94.27; $CellContext`MW$ = 
         63.01; $CellContext`\[Mu]$ = Quiet[
           Interpolation[{{0, 3.5}, {20, 2.5}, {50, 1.4}, {
             100, 0.7}}][$CellContext`T$]]; $CellContext`X0$ = 
         0; $CellContext`Y1$ = 10; $CellContext`yn1$ = 100; $CellContext`Yeq$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := ($CellContext`HB$/$CellContext`P$) $CellContext`x$; \
$CellContext`YN1$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`LV$ ($CellContext`x$ - \
$CellContext`X0$) + $CellContext`Y1$; $CellContext`Yinlet$[
           Pattern[$CellContext`x$, 
            Blank[]]] := $CellContext`yn1$; $CellContext`sol$ = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`Yeq$[$CellContext`x] == \
$CellContext`Yinlet$[$CellContext`x], $CellContext`x], 
            1]]; $CellContext`check$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`YN1$[$CellContext`x] == \
$CellContext`Yinlet$[$CellContext`x], $CellContext`x], 
            1]]; $CellContext`check2$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`Yeq$[$CellContext`x] == \
$CellContext`YN1$[$CellContext`x], $CellContext`x], 1]]; $CellContext`stage$[
          1] = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`Yeq$[$CellContext`x] == $CellContext`Y1$, \
$CellContext`x], 1]]; 
        Do[$CellContext`stage$[$CellContext`i] = ReplaceAll[$CellContext`x, 
            Part[
             Solve[$CellContext`Yeq$[$CellContext`x] == $CellContext`YN1$[
                $CellContext`stage$[$CellContext`i - 1]], $CellContext`x], 
             1]], {$CellContext`i, 2, 50}]; $CellContext`test$ = Table[
           $CellContext`stage$[$CellContext`n$], {$CellContext`n$, 1, 
            50}]; $CellContext`n$ = 1; While[
          And[Part[$CellContext`test$, $CellContext`n$] < $CellContext`check$, 
           
           If[$CellContext`check2$ > 
            0, $CellContext`Yeq$[$CellContext`check2$] > \
$CellContext`Yinlet$[$CellContext`check2$], True]], 
          
          Increment[$CellContext`n$]]; $CellContext`KN$ = \
($CellContext`YN1$[$CellContext`n$]/(
           1 + $CellContext`YN1$[$CellContext`n$]))/($CellContext`xn/(
          1 + $CellContext`xn)); $CellContext`E0$ = 
         10^(1.597 - 0.199 
           Log10[$CellContext`KN$ $CellContext`MW$ \
$CellContext`\[Mu]$/$CellContext`\[Rho]$] - 0.0896 
           Log10[$CellContext`KN$ $CellContext`MW$ \
$CellContext`\[Mu]$/$CellContext`\[Rho]$]^2); $CellContext`XN$ = 
         ReplaceAll[$CellContext`xn, 
           
           FindRoot[$CellContext`E0$ == $CellContext`e0$$, {$CellContext`xn, 
             0.1}]]], 
      "Specifications" :> {{{$CellContext`e0$$, 31, "efficiency"}, 10, 35, 1, 
         Appearance -> "Labeled"}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{346., {51., 58.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.7009188868339653`*^9, 3.700918926538161*^9}]
}, Open  ]]
},
WindowSize->{667, 670},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 6391, 168, 373, "Input"],
Cell[6974, 192, 1730, 45, 415, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8741, 242, 14200, 363, 1373, "Input"],
Cell[22944, 607, 9093, 180, 150, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32074, 792, 9677, 246, 989, "Input"],
Cell[41754, 1040, 7110, 145, 150, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48901, 1190, 7531, 198, 837, "Input"],
Cell[56435, 1390, 5433, 110, 126, "Output"]
}, Open  ]]
}
]
*)

