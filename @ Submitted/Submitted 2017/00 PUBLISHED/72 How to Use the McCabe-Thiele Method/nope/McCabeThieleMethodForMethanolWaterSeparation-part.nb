(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='WolframCDFPlayer 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       163,          7]
NotebookDataLength[    221225,       5178]
NotebookOptionsPosition[    214737,       4981]
NotebookOutlinePosition[    216350,       5031]
CellTagsIndexPosition[    216014,       5019]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["McCabe-Thiele Method for Methanol/Water Separation", "DemoTitle",
 CellChangeTimes->{3.68158362762429*^9}],

Cell["", "InitializationSection"],

Cell[CellGroupData[{

Cell["", "ManipulateSection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "cond", ",", "zf", ",", "q", ",", "P", ",", "Psat1", ",", "Psat2", ",", 
       "A12", ",", "A21", ",", "\[Gamma]1", ",", "\[Gamma]2", ",", "i", ",", 
       "x1", ",", "T", ",", "y1", ",", "equilb", ",", "feed", ",", "xpinch", 
       ",", "ypinch", ",", "opertRect", ",", "opertStrp", ",", "Rmin", ",", 
       "R", ",", "OpRect", ",", "xinters", ",", "yinters", ",", "OpStrp", ",",
        "yr", ",", "xr", ",", "v", ",", "t", ",", "ir", ",", "ys", ",", "xs", 
       ",", "imax", ",", "tbl1", ",", "tbl2", ",", "tbl3", ",", "tbl4", ",", 
       "it", ",", "distflow", ",", "botflow", ",", "xybase", ",", "xyadd", 
       ",", "plot"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cond", "=", 
       RowBox[{"yinters", "\[GreaterEqual]", 
        RowBox[{"equilb", "[", "xinters", "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"zf", "=", "0.5"}], ";", 
      RowBox[{"q", "=", "0.5"}], ";", 
      RowBox[{"P", "=", "760"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Psat1", "[", "temp_", "]"}], ":=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"8.08097", "-", 
          FractionBox["1582.271", 
           RowBox[{"239.726", "+", "temp"}]]}], ")"}]}]}], ";", 
      RowBox[{"(*", "methanol", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Psat2", "[", "temp_", "]"}], ":=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"8.07131", "-", 
          FractionBox["1730.63", 
           RowBox[{"233.426", "+", "temp"}]]}], ")"}]}]}], ";", 
      RowBox[{"(*", "water", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"A12", "=", "0.7923"}], ";", 
      RowBox[{"A21", "=", "0.5434"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Gamma]1", "[", "i_", "]"}], ":=", 
       RowBox[{"Exp", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"x1", "[", "i", "]"}]}], ")"}], "2"], "*", 
         RowBox[{"(", 
          RowBox[{"A12", "+", 
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"A21", "-", "A12"}], ")"}], "*", 
            RowBox[{"x1", "[", "i", "]"}]}]}], ")"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Gamma]2", "[", "i_", "]"}], ":=", 
       RowBox[{"Exp", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"x1", "[", "i", "]"}], "2"], "*", 
         RowBox[{"(", 
          RowBox[{"A21", "+", 
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"A12", "-", "A21"}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"x1", "[", "i", "]"}]}], ")"}]}]}], ")"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Iteration", " ", "to", " ", "create", " ", "curve"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"i", "<", "101"}], ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"x1", "[", "i", "]"}], "=", 
           RowBox[{"0.01", "*", "i"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"T", "[", "i", "]"}], "=", 
           RowBox[{"temp", "/.", 
            RowBox[{"Quiet", "@", 
             RowBox[{"FindRoot", "[", 
              RowBox[{
               RowBox[{"P", "\[Equal]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"x1", "[", "i", "]"}], "*", 
                  RowBox[{"\[Gamma]1", "[", "i", "]"}], "*", 
                  RowBox[{"Psat1", "[", "temp", "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{"x1", "[", "i", "]"}]}], ")"}], "*", 
                  RowBox[{"\[Gamma]2", "[", "i", "]"}], "*", 
                  RowBox[{"Psat2", "[", "temp", "]"}]}]}]}], ",", 
               RowBox[{"{", 
                RowBox[{"temp", ",", "60"}], "}"}]}], "]"}]}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"y1", "[", "i", "]"}], "=", 
           FractionBox[
            RowBox[{
             RowBox[{"x1", "[", "i", "]"}], "*", 
             RowBox[{"\[Gamma]1", "[", "i", "]"}], "*", 
             RowBox[{"Psat1", "[", 
              RowBox[{"T", "[", "i", "]"}], "]"}]}], "P"]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"i", "++"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"equilb", "=", 
       RowBox[{"Interpolation", "@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x1", "[", "i", "]"}], ",", 
            RowBox[{"y1", "[", "i", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "100"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Feed", " ", "line"}], ",", " ", 
        RowBox[{
        "operating", " ", "lines", " ", "and", " ", "mass", " ", "balances", 
         " ", "get", " ", "calculated", " ", "here"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"feed", "[", "x_", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"q", "\[NotEqual]", "1"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q", "*", 
            RowBox[{"x", "/", 
             RowBox[{"(", 
              RowBox[{"q", "-", "1"}], ")"}]}]}], "-", 
           RowBox[{"zf", "/", 
            RowBox[{"(", 
             RowBox[{"q", "-", "1"}], ")"}]}]}], ")"}], ",", 
         RowBox[{
          RowBox[{"1000000", "*", 
           RowBox[{"(", 
            RowBox[{"x", "-", "zf"}], ")"}]}], "+", "zf"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"xpinch", "=", 
       RowBox[{"x", "/.", 
        RowBox[{"Quiet", "@", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"feed", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"equilb", "[", "x", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0.5"}], "}"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ypinch", "=", 
       RowBox[{"feed", "[", "xpinch", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"opertRect", "[", "x_", "]"}], ":=", 
       RowBox[{"ypinch", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x", "-", "xpinch"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"xd", "-", "xpinch"}], ")"}]}], "*", 
         RowBox[{"(", 
          RowBox[{"xd", "-", "ypinch"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"opertStrp", "[", "x_", "]"}], ":=", 
       RowBox[{"ypinch", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x", "-", "xpinch"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"xb", "-", "xpinch"}], ")"}]}], "*", 
         RowBox[{"(", 
          RowBox[{"xb", "-", "ypinch"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Rmin", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"xd", "-", "ypinch"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"xd", "-", "xpinch"}], ")"}]}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"xd", "-", "ypinch"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"xd", "-", "xpinch"}], ")"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"R", "=", "lvmult"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"OpRect", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"R", "/", 
          RowBox[{"(", 
           RowBox[{"R", "+", "1"}], ")"}]}], "*", "x"}], "+", 
        RowBox[{"xd", "/", 
         RowBox[{"(", 
          RowBox[{"R", "+", "1"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xinters", "=", 
       RowBox[{"x", "/.", 
        RowBox[{"Quiet", "@", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"feed", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"OpRect", "[", "x", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0.7"}], "}"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"yinters", "=", 
       RowBox[{"OpRect", "[", "xinters", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"cond", ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"OpStrp", "[", "x_", "]"}], ":=", 
           RowBox[{"opertStrp", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"yr", "[", "0", "]"}], "=", "xd"}], ";", 
          RowBox[{
           RowBox[{"xr", "[", "0", "]"}], "=", "xd"}], ";", 
          RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"i", "<", "25"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"v", "=", 
               RowBox[{"u", "/.", 
                RowBox[{"Quiet", "[", 
                 RowBox[{"FindRoot", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"yr", "[", "i", "]"}], "\[Equal]", 
                    RowBox[{"equilb", "[", "u", "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"u", ",", "0.5"}], "}"}]}], "]"}], "]"}]}]}], ",", 
              RowBox[{"t", "=", 
               RowBox[{"opertRect", "[", "v", "]"}]}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"v", ">", "xpinch"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"xr", "[", 
                    RowBox[{"i", "+", "1"}], "]"}], "=", "v"}], ",", 
                  RowBox[{
                   RowBox[{"yr", "[", 
                    RowBox[{"i", "+", "1"}], "]"}], "=", "t"}]}], "}"}]}], 
               "]"}], ",", 
              RowBox[{"i", "++"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ir", "=", 
           RowBox[{"i", "-", "1"}]}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ir", "\[GreaterEqual]", " ", "0"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"ys", "[", "0", "]"}], "=", 
               RowBox[{"yr", "[", "ir", "]"}]}], ";", 
              RowBox[{
               RowBox[{"xs", "[", "0", "]"}], "=", 
               RowBox[{"xr", "[", "ir", "]"}]}]}], "}"}]}], "]"}], ";", 
          RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"i", "<", "20"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"v", "=", 
               RowBox[{"u", "/.", 
                RowBox[{"Quiet", "@", 
                 RowBox[{"FindRoot", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ys", "[", "i", "]"}], "\[Equal]", 
                    RowBox[{"equilb", "[", "u", "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"u", ",", "0.5"}], "}"}]}], "]"}]}]}]}], ",", 
              RowBox[{"t", "=", 
               RowBox[{"opertStrp", "[", "v", "]"}]}], ",", 
              RowBox[{
               RowBox[{"xs", "[", 
                RowBox[{"i", "+", "1"}], "]"}], "=", "v"}], ",", 
              RowBox[{
               RowBox[{"ys", "[", 
                RowBox[{"i", "+", "1"}], "]"}], "=", "t"}], ",", 
              RowBox[{"i", "++"}]}], "}"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", "THIS", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"OpStrp", "[", "x_", "]"}], ":=", 
           RowBox[{"yinters", "+", 
            RowBox[{
             FractionBox[
              RowBox[{"x", "-", "xinters"}], 
              RowBox[{"xb", "-", "xinters"}]], "*", 
             RowBox[{"(", 
              RowBox[{"xb", "-", "yinters"}], ")"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", "RECTIFYING", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"yr", "[", "0", "]"}], "=", "xd"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"xr", "[", "0", "]"}], "=", "xd"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"xr", "[", "i", "]"}], ">", "xinters"}], ",", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"v", "=", 
               RowBox[{"u", "/.", 
                RowBox[{"Quiet", "@", 
                 RowBox[{"FindRoot", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"yr", "[", "i", "]"}], "\[Equal]", 
                    RowBox[{"equilb", "[", "u", "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"u", ",", "0.7"}], "}"}]}], "]"}]}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"t", "=", 
               RowBox[{"OpRect", "[", "v", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"v", ">", "xinters"}], ",", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"xr", "[", 
                    RowBox[{"i", "+", "1"}], "]"}], "=", "v"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"yr", "[", 
                    RowBox[{"i", "+", "1"}], "]"}], "=", "t"}]}], "}"}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"i", "++"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ir", "=", 
           RowBox[{"i", "-", "1"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", "STRIPPING", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"ir", "\[GreaterEqual]", "0"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"ys", "[", "0", "]"}], "=", 
                RowBox[{"yr", "[", "ir", "]"}]}], ";", 
               RowBox[{
                RowBox[{"xs", "[", "0", "]"}], "=", 
                RowBox[{"xr", "[", "ir", "]"}]}]}]}], "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ys", "[", "0", "]"}], "=", 
           RowBox[{"yr", "[", "ir", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"xs", "[", "0", "]"}], "=", 
           RowBox[{"xr", "[", "ir", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"xs", "[", "i", "]"}], ">", "xb"}], ",", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"v", "=", 
               RowBox[{"u", "/.", 
                RowBox[{"Quiet", "@", 
                 RowBox[{"FindRoot", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ys", "[", "i", "]"}], "\[Equal]", 
                    RowBox[{"equilb", "[", "u", "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"u", ",", "0.5"}], "}"}]}], "]"}]}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"t", "=", 
               RowBox[{"OpStrp", "[", "v", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"xs", "[", 
                RowBox[{"i", "+", "1"}], "]"}], "=", "v"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"ys", "[", 
                RowBox[{"i", "+", "1"}], "]"}], "=", "t"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"i", "++"}]}], "}"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"imax", "=", 
       RowBox[{"i", "-", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"R", " ", "STAGES"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"tbl1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xr", "[", "#", "]"}], ",", 
              RowBox[{"yr", "[", 
               RowBox[{"#", "-", "1"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xr", "[", "#", "]"}], ",", 
              RowBox[{"yr", "[", "#", "]"}]}], "}"}]}], "}"}], "]"}], "&"}], "/@", 
        RowBox[{"Range", "@", "ir"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tbl2", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xr", "[", "#", "]"}], ",", 
              RowBox[{"yr", "[", "#", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xr", "[", 
               RowBox[{"#", "+", "1"}], "]"}], ",", 
              RowBox[{"yr", "[", "#", "]"}]}], "}"}]}], "}"}], "]"}], "&"}], "/@", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ir", "\[GreaterEqual]", "1"}], ",", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{"ir", "-", "1"}]}], "]"}], ",", 
          RowBox[{"{", "0", "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"tbl3", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xs", "[", 
               RowBox[{"i", "+", "1"}], "]"}], ",", 
              RowBox[{"ys", "[", "i", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xs", "[", 
               RowBox[{"i", "+", "1"}], "]"}], ",", 
              RowBox[{"ys", "[", 
               RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"imax", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tbl4", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xs", "[", 
               RowBox[{"i", "-", "1"}], "]"}], ",", 
              RowBox[{"ys", "[", 
               RowBox[{"i", "-", "1"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xs", "[", "i", "]"}], ",", 
              RowBox[{"ys", "[", 
               RowBox[{"i", "-", "1"}], "]"}]}], "}"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"imax", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"it", "=", 
       RowBox[{"imax", "+", "ir", "+", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"distflow", "=", 
       FractionBox[
        RowBox[{"zf", "-", 
         RowBox[{"xs", "[", 
          RowBox[{"imax", "+", "1"}], "]"}]}], "xd"]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"botflow", "=", 
       RowBox[{"1", "-", "distflow"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
         "**", "**", "**", "**"}], "*****)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"xybase", "=", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"equilb", "[", "x", "]"}], ",", "x"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"Thick", ",", "Black"}], "}"}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"cond", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"feed", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "xpinch", ",", "zf"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", "Black"}], "}"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"opertRect", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "xpinch", ",", "xd"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", "Black"}], "}"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"opertStrp", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "xb", ",", "xpinch"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", "Black"}], "}"}]}]}], "]"}]}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"feed", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "xinters", ",", "zf"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", "Black"}], "}"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"OpRect", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "xinters", ",", "xd"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", "Black"}], "}"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"OpStrp", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "xb", ",", "xinters"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", "Black"}], "}"}]}]}], "]"}]}], "}"}]}],
           "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics", "@", 
          RowBox[{"{", 
           RowBox[{
           "Thick", ",", "Red", ",", "tbl1", ",", "Blue", ",", "tbl2"}], 
           RowBox[{"(*", 
            RowBox[{",", "Green", ",", "tblih", ",", "Orange", ",", "tbliv"}],
             "*)"}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{"\"\<liquid mole fraction \>\"", ",", 
               RowBox[{"Subscript", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                 "\"\<meth\>\""}], "]"}]}], "}"}]}], ",", 
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{"\"\<vapor mole fraction \>\"", ",", 
               RowBox[{"Subscript", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
                 "\"\<meth\>\""}], "]"}]}], "}"}]}]}], "}"}]}], ",", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"17", ",", "Black"}], "}"}]}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
         RowBox[{"PlotRangePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0.02", ",", 
            RowBox[{"{", 
             RowBox[{"None", ",", "0.05"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"55", ",", "10"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"xyadd", "=", 
       RowBox[{"Graphics", "@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "Thick", ",", "Dashed", ",", "Purple", ",", "tbl3", ",", "Magenta",
             ",", "tbl4"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"ir", "+", "1", "+", "imax", "-", "f"}], ",", "18"}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xr", "[", "f", "]"}], ",", 
                RowBox[{"yr", "[", 
                 RowBox[{"f", "-", "1"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"f", ",", "1", ",", "ir"}], "}"}]}], "]"}], ",", 
          RowBox[{"(*", 
           RowBox[{"R", " ", "stage"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"imax", "+", "1", "-", "f"}], ",", "18", ",", "Red"}],
                "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xs", "[", "f", "]"}], ",", 
                RowBox[{"ys", "[", 
                 RowBox[{"f", "-", "1"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"f", ",", "1", ",", "imax"}], "}"}]}], "]"}], ","}], 
         RowBox[{"(*", 
          RowBox[{"S", " ", "stage"}], "*)"}], "\[IndentingNewLine]", 
         "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"plot", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"yinters", "<", 
          RowBox[{"equilb", "[", "xinters", "]"}]}], ",", 
         RowBox[{"Show", "[", 
          RowBox[{"xybase", ",", "xyadd"}], "]"}], ",", "xybase"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Grid", "@", 
       RowBox[{"{", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"plot", ",", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"600", ",", "400"}], "}"}]}], ",", 
            RowBox[{"PlotLabel", "\[Rule]", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"yinters", "<", 
                  RowBox[{"equilb", "[", "xinters", "]"}]}], ",", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<equilibrium stages needed = \>\"", ",", "it", ",", 
                    " ", "\"\< (including reboiler)\>\""}], "}"}]}], ",", 
                 "\"\<equilibrium stages needed = infinite (pinch \
point)\>\""}], "]"}], ",", "17"}], "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Text", "@", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Grid", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"\"\<R stages ir =\>\"", ",", "ir"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\"\<S stages imax =\>\"", ",", "imax"}], "}"}]}], 
               "}"}], "]"}], ",", "18"}], "]"}]}]}], "\[IndentingNewLine]", 
         "}"}], "}"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lvmult", ",", "0.75", ",", 
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{"\"\<external reflux ratio \>\"", ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<L\>\"", ",", "Italic"}], "]"}], ",", 
                 "\"\</\>\"", ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<D\>\"", ",", "Italic"}], "]"}]}], "}"}]}]}], 
             "}"}], ",", "0.25", ",", "10", ",", "0.25", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
          "]"}], ",", "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<mole fractions:\>\"", ",", "Bold"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xd", ",", "0.85", ",", 
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{"\"\<distillate \>\"", ",", 
                 RowBox[{"Subscript", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                   "\"\<d\>\""}], "]"}]}], "}"}]}]}], "}"}], ",", "0.8", ",", 
            "0.98", ",", "0.01", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}], ",", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xb", ",", "0.15", ",", 
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{"\"\<desired bottoms \>\"", ",", 
                 RowBox[{"Subscript", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                   "\"\<b\>\""}], "]"}]}], "}"}]}]}], "}"}], ",", "0.05", ",",
             "0.2", ",", "0.01", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}]}], 
        "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.6815830468892994`*^9, 3.6815830481285167`*^9}, {
   3.6815830790853896`*^9, 3.6815834135163836`*^9}, {3.6815834443954415`*^9, 
   3.681583516109177*^9}, {3.68158359402418*^9, 3.6815835941645803`*^9}, {
   3.6815845264236884`*^9, 3.6815845268130894`*^9}, {3.681584615595088*^9, 
   3.681584624241583*^9}, {3.6815851982341137`*^9, 3.6815851983901143`*^9}, {
   3.6816538710587635`*^9, 3.6816538729073687`*^9}, 3.6816539044010525`*^9, {
   3.6816540401427794`*^9, 3.6816540671230464`*^9}, {3.681654145080206*^9, 
   3.681654217474326*^9}, {3.681654248422186*^9, 3.6816542788154573`*^9}, {
   3.6816543384380255`*^9, 3.681654358496669*^9}, {3.681654425439421*^9, 
   3.6816544263598228`*^9}, {3.6816544648843126`*^9, 
   3.6816544808081512`*^9}, {3.6816545215206456`*^9, 3.681654523209449*^9}, {
   3.681654556132145*^9, 3.681654565448163*^9}, {3.681654603421238*^9, 
   3.6816546335076556`*^9}, {3.6816550035681477`*^9, 
   3.6816550209799943`*^9}, {3.6816550679595003`*^9, 3.6816550694415035`*^9}, 
   3.6816559552021756`*^9, {3.6816560376573687`*^9, 3.6816560911722946`*^9}, {
   3.681656160285658*^9, 3.681656201054556*^9}, {3.6816562770559454`*^9, 
   3.6816563129176283`*^9}, 3.682796427866624*^9, {3.6827964650998974`*^9, 
   3.6827965485591354`*^9}, 3.682796603144343*^9, {3.68279664842737*^9, 
   3.6827966605174*^9}, {3.6827966949402695`*^9, 3.6827967177103176`*^9}, {
   3.682796754407406*^9, 3.6827967744612474`*^9}, {3.682796806582553*^9, 
   3.6827969213854136`*^9}, {3.682797677790183*^9, 3.682797742584403*^9}, {
   3.682797869272153*^9, 3.6827979361943264`*^9}, {3.6827980152777624`*^9, 
   3.682798015698963*^9}, {3.6827980769679008`*^9, 3.682798084791524*^9}, {
   3.6827981201782265`*^9, 3.6827981431552825`*^9}, {3.682798323189557*^9, 
   3.6827983335744853`*^9}, {3.6827983986021547`*^9, 
   3.6827983994329567`*^9}, {3.6827985076142373`*^9, 
   3.6827985740052385`*^9}, {3.6827986298030233`*^9, 
   3.6827986554051085`*^9}, {3.6827987125008855`*^9, 3.682798776712853*^9}, {
   3.6827988715920734`*^9, 3.6827989111508636`*^9}, {3.6828002378206415`*^9, 
   3.6828002388668437`*^9}, {3.684002986729734*^9, 3.6840030127507825`*^9}, {
   3.684003043357239*^9, 3.6840030916127615`*^9}, {3.6840031956196394`*^9, 
   3.6840031958380394`*^9}, {3.6840032459985332`*^9, 
   3.6840032802831993`*^9}, {3.6840033941398506`*^9, 
   3.6840034325111294`*^9}, {3.68400349880106*^9, 3.6840035589697795`*^9}, {
   3.684003596995655*^9, 3.6840036099148784`*^9}, {3.6840036938626347`*^9, 
   3.684003722790491*^9}, {3.684003847049369*^9, 3.6840039573377914`*^9}, {
   3.6840071851513267`*^9, 3.6840072107331734`*^9}, {3.6840072513988543`*^9, 
   3.6840072521516557`*^9}, {3.6840073175400047`*^9, 3.684007353017083*^9}, {
   3.684007397122387*^9, 3.6840074381302943`*^9}, {3.6840076582534056`*^9, 
   3.684007781574093*^9}, {3.684007813170752*^9, 3.684007845220631*^9}, {
   3.684007916740782*^9, 3.684007950519449*^9}, {3.6840079912188416`*^9, 
   3.6840081644957404`*^9}, {3.6840081954722137`*^9, 3.684008230301109*^9}, {
   3.684008275024206*^9, 3.6840082832046213`*^9}, {3.684008383364026*^9, 
   3.684008418978307*^9}, {3.6840084938120995`*^9, 3.6840085705712433`*^9}, {
   3.684008627477169*^9, 3.6840086765770764`*^9}, {3.6840703572369576`*^9, 
   3.6840703886170177`*^9}, {3.6840704212524953`*^9, 
   3.6840706833685007`*^9}, {3.68407079251589*^9, 3.684070804871914*^9}, {
   3.684070855811599*^9, 3.684070857757908*^9}, {3.684070891777917*^9, 
   3.6840709597514915`*^9}, {3.6840710322286587`*^9, 3.684071046195084*^9}, {
   3.6840711954189763`*^9, 3.6840712235296307`*^9}, {3.6840735973235636`*^9, 
   3.6840736480855055`*^9}, {3.6840746410562677`*^9, 
   3.6840746415262685`*^9}, {3.68423982162836*^9, 3.68423983979889*^9}, {
   3.6842408476292877`*^9, 3.684240859136389*^9}, {3.684276179806287*^9, 
   3.684276186608646*^9}, {3.684512033593381*^9, 3.6845120355277843`*^9}, {
   3.6869345044175873`*^9, 3.686934526002822*^9}, {3.6870124339684*^9, 
   3.6870124617247458`*^9}, {3.687012493035096*^9, 3.6870125367579174`*^9}, {
   3.6870125801353264`*^9, 3.687012669854391*^9}, {3.687012706098781*^9, 
   3.687012844072089*^9}, {3.6870129043722005`*^9, 3.6870129971556683`*^9}, {
   3.6870130284828215`*^9, 3.6870131420443616`*^9}, {3.687013240672405*^9, 
   3.687013274740395*^9}, {3.6870133304870696`*^9, 3.6870133411371384`*^9}, {
   3.6870133725073023`*^9, 3.6870134587883477`*^9}, {3.687013507586398*^9, 
   3.687013577724962*^9}, {3.687013626262196*^9, 3.687013663965006*^9}, {
   3.687013711885251*^9, 3.687013712712053*^9}, {3.687013745773408*^9, 
   3.6870139196147227`*^9}, 3.6870147842393465`*^9, {3.687014993283454*^9, 
   3.687015018753191*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`lvmult$$ = 0.75, $CellContext`xb$$ = 
    0.15, $CellContext`xd$$ = 0.85, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lvmult$$], 0.75, 
       Row[{"external reflux ratio ", 
         Style["L", Italic], "/", 
         Style["D", Italic]}]}, 0.25, 10, 0.25}, {{
       Hold[$CellContext`xd$$], 0.85, 
       Row[{"distillate ", 
         Subscript[
          Style["x", Italic], "d"]}]}, 0.8, 0.98, 0.01}, {{
       Hold[$CellContext`xb$$], 0.15, 
       Row[{"desired bottoms ", 
         Subscript[
          Style["x", Italic], "b"]}]}, 0.05, 0.2, 0.01}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], SpanFromLeft}, {
          Style["mole fractions:", Bold], 
          Manipulate`Place[2], 
          Manipulate`Place[3]}}, Alignment -> Left]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    744., {196.5, 203.5}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lvmult$52523$$ = 
    0, $CellContext`xd$52524$$ = 0, $CellContext`xb$52525$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`lvmult$$ = 0.75, $CellContext`xb$$ = 
        0.15, $CellContext`xd$$ = 0.85}, "ControllerVariables" :> {
        Hold[$CellContext`lvmult$$, $CellContext`lvmult$52523$$, 0], 
        Hold[$CellContext`xd$$, $CellContext`xd$52524$$, 0], 
        Hold[$CellContext`xb$$, $CellContext`xb$52525$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`cond$, $CellContext`zf$, $CellContext`q$, \
$CellContext`P$, $CellContext`Psat1$, $CellContext`Psat2$, $CellContext`A12$, \
$CellContext`A21$, $CellContext`\[Gamma]1$, $CellContext`\[Gamma]2$, \
$CellContext`i$, $CellContext`x1$, $CellContext`T$, $CellContext`y1$, \
$CellContext`equilb$, $CellContext`feed$, $CellContext`xpinch$, \
$CellContext`ypinch$, $CellContext`opertRect$, $CellContext`opertStrp$, \
$CellContext`Rmin$, $CellContext`R$, $CellContext`OpRect$, \
$CellContext`xinters$, $CellContext`yinters$, $CellContext`OpStrp$, \
$CellContext`yr$, $CellContext`xr$, $CellContext`v$, $CellContext`t$, \
$CellContext`ir$, $CellContext`ys$, $CellContext`xs$, $CellContext`imax$, \
$CellContext`tbl1$, $CellContext`tbl2$, $CellContext`tbl3$, \
$CellContext`tbl4$, $CellContext`it$, $CellContext`distflow$, \
$CellContext`botflow$, $CellContext`xybase$, $CellContext`xyadd$, \
$CellContext`plot$}, $CellContext`cond$ = $CellContext`yinters$ >= \
$CellContext`equilb$[$CellContext`xinters$]; $CellContext`zf$ = 
         0.5; $CellContext`q$ = 0.5; $CellContext`P$ = 
         760; $CellContext`Psat1$[
           Pattern[$CellContext`temp, 
            Blank[]]] := 
         10^(8.08097 - 1582.271/(
           239.726 + $CellContext`temp)); $CellContext`Psat2$[
           Pattern[$CellContext`temp, 
            Blank[]]] := 
         10^(8.07131 - 1730.63/(
           233.426 + $CellContext`temp)); $CellContext`A12$ = 
         0.7923; $CellContext`A21$ = 0.5434; $CellContext`\[Gamma]1$[
           Pattern[$CellContext`i$, 
            Blank[]]] := 
         Exp[(1 - $CellContext`x1$[$CellContext`i$])^2 ($CellContext`A12$ + 
            2 ($CellContext`A21$ - $CellContext`A12$) \
$CellContext`x1$[$CellContext`i$])]; $CellContext`\[Gamma]2$[
           Pattern[$CellContext`i$, 
            Blank[]]] := 
         Exp[$CellContext`x1$[$CellContext`i$]^2 ($CellContext`A21$ + 
            2 ($CellContext`A12$ - $CellContext`A21$) (
              1 - $CellContext`x1$[$CellContext`i$]))]; $CellContext`i$ = 0; 
        While[$CellContext`i$ < 
          101, {$CellContext`x1$[$CellContext`i$] = 
           0.01 $CellContext`i$, $CellContext`T$[$CellContext`i$] = 
           ReplaceAll[$CellContext`temp, 
             Quiet[
              
              FindRoot[$CellContext`P$ == $CellContext`x1$[$CellContext`i$] \
$CellContext`\[Gamma]1$[$CellContext`i$] \
$CellContext`Psat1$[$CellContext`temp] + (
                  1 - $CellContext`x1$[$CellContext`i$]) \
$CellContext`\[Gamma]2$[$CellContext`i$] \
$CellContext`Psat2$[$CellContext`temp], {$CellContext`temp, 
                60}]]], $CellContext`y1$[$CellContext`i$] = \
$CellContext`x1$[$CellContext`i$] $CellContext`\[Gamma]1$[$CellContext`i$] \
$CellContext`Psat1$[
              $CellContext`T$[$CellContext`i$]]/$CellContext`P$, 
           Increment[$CellContext`i$]}]; $CellContext`equilb$ = Interpolation[
           Table[{
             $CellContext`x1$[$CellContext`i$], 
             $CellContext`y1$[$CellContext`i$]}, {$CellContext`i$, 0, 
             100}]]; $CellContext`feed$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         If[$CellContext`q$ != 
           1, $CellContext`q$ ($CellContext`x$/($CellContext`q$ - 
             1)) - $CellContext`zf$/($CellContext`q$ - 1), 
           1000000 ($CellContext`x$ - $CellContext`zf$) + $CellContext`zf$]; \
$CellContext`xpinch$ = ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`feed$[$CellContext`x] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
              0.5}]]]; $CellContext`ypinch$ = \
$CellContext`feed$[$CellContext`xpinch$]; $CellContext`opertRect$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`ypinch$ + (($CellContext`x$ - \
$CellContext`xpinch$)/($CellContext`xd$$ - $CellContext`xpinch$)) \
($CellContext`xd$$ - $CellContext`ypinch$); $CellContext`opertStrp$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`ypinch$ + (($CellContext`x$ - \
$CellContext`xpinch$)/($CellContext`xb$$ - $CellContext`xpinch$)) \
($CellContext`xb$$ - $CellContext`ypinch$); $CellContext`Rmin$ = \
(($CellContext`xd$$ - $CellContext`ypinch$)/($CellContext`xd$$ - \
$CellContext`xpinch$))/(
          1 - ($CellContext`xd$$ - $CellContext`ypinch$)/($CellContext`xd$$ - \
$CellContext`xpinch$)); $CellContext`R$ = $CellContext`lvmult$$; \
$CellContext`OpRect$[
           Pattern[$CellContext`x$, 
            Blank[]]] := ($CellContext`R$/($CellContext`R$ + 
            1)) $CellContext`x$ + $CellContext`xd$$/($CellContext`R$ + 
           1); $CellContext`xinters$ = ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`feed$[$CellContext`x] == \
$CellContext`OpRect$[$CellContext`x], {$CellContext`x, 
              0.7}]]]; $CellContext`yinters$ = \
$CellContext`OpRect$[$CellContext`xinters$]; 
        If[$CellContext`cond$, {$CellContext`OpStrp$[
              Pattern[$CellContext`x$, 
               
               Blank[]]] := $CellContext`opertStrp$[$CellContext`x$]; \
$CellContext`yr$[0] = $CellContext`xd$$; $CellContext`xr$[
             0] = $CellContext`xd$$; $CellContext`i$ = 0; 
           While[$CellContext`i$ < 
             25, {$CellContext`v$ = ReplaceAll[$CellContext`u, 
                Quiet[
                 
                 FindRoot[$CellContext`yr$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`u], {$CellContext`u, 
                   0.5}]]], $CellContext`t$ = \
$CellContext`opertRect$[$CellContext`v$], 
              
              If[$CellContext`v$ > $CellContext`xpinch$, \
{$CellContext`xr$[$CellContext`i$ + 
                  1] = $CellContext`v$, $CellContext`yr$[$CellContext`i$ + 
                  1] = $CellContext`t$}], 
              
              Increment[$CellContext`i$]}]; $CellContext`ir$ = \
$CellContext`i$ - 1; 
           If[$CellContext`ir$ >= 
             0, {$CellContext`ys$[
                0] = $CellContext`yr$[$CellContext`ir$]; $CellContext`xs$[
                0] = $CellContext`xr$[$CellContext`ir$]}]; $CellContext`i$ = 
            0; While[$CellContext`i$ < 
             20, {$CellContext`v$ = ReplaceAll[$CellContext`u, 
                Quiet[
                 
                 FindRoot[$CellContext`ys$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`u], {$CellContext`u, 
                   0.5}]]], $CellContext`t$ = \
$CellContext`opertStrp$[$CellContext`v$], $CellContext`xs$[$CellContext`i$ + 
                1] = $CellContext`v$, $CellContext`ys$[$CellContext`i$ + 
                1] = $CellContext`t$, 
              Increment[$CellContext`i$]}]; Null}, {$CellContext`OpStrp$[
              Pattern[$CellContext`x$, 
               
               Blank[]]] := $CellContext`yinters$ + (($CellContext`x$ - \
$CellContext`xinters$)/($CellContext`xb$$ - $CellContext`xinters$)) \
($CellContext`xb$$ - $CellContext`yinters$); $CellContext`yr$[
             0] = $CellContext`xd$$; $CellContext`xr$[
             0] = $CellContext`xd$$; $CellContext`i$ = 0; 
           While[$CellContext`xr$[$CellContext`i$] > $CellContext`xinters$, \
{$CellContext`v$ = ReplaceAll[$CellContext`u, 
                Quiet[
                 
                 FindRoot[$CellContext`yr$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`u], {$CellContext`u, 
                   0.7}]]], $CellContext`t$ = \
$CellContext`OpRect$[$CellContext`v$], 
              
              If[$CellContext`v$ > $CellContext`xinters$, \
{$CellContext`xr$[$CellContext`i$ + 
                  1] = $CellContext`v$, $CellContext`yr$[$CellContext`i$ + 
                  1] = $CellContext`t$}], 
              
              Increment[$CellContext`i$]}]; $CellContext`ir$ = \
$CellContext`i$ - 1; $CellContext`i$ = 
            0; $CellContext`ys$[
             0] = $CellContext`yr$[$CellContext`ir$]; $CellContext`xs$[
             0] = $CellContext`xr$[$CellContext`ir$]; 
           While[$CellContext`xs$[$CellContext`i$] > $CellContext`xb$$, \
{$CellContext`v$ = ReplaceAll[$CellContext`u, 
                Quiet[
                 
                 FindRoot[$CellContext`ys$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`u], {$CellContext`u, 
                   0.5}]]], $CellContext`t$ = \
$CellContext`OpStrp$[$CellContext`v$], $CellContext`xs$[$CellContext`i$ + 
                1] = $CellContext`v$, $CellContext`ys$[$CellContext`i$ + 
                1] = $CellContext`t$, 
              Increment[$CellContext`i$]}]; 
           Null}]; $CellContext`imax$ = $CellContext`i$ - 
          1; $CellContext`tbl1$ = Map[Line[{{
              $CellContext`xr$[#], 
              $CellContext`yr$[# - 1]}, {
              $CellContext`xr$[#], 
              $CellContext`yr$[#]}}]& , 
           Range[$CellContext`ir$]]; $CellContext`tbl2$ = Map[Line[{{
              $CellContext`xr$[#], 
              $CellContext`yr$[#]}, {
              $CellContext`xr$[# + 1], 
              $CellContext`yr$[#]}}]& , 
           If[$CellContext`ir$ >= 1, 
            Range[0, $CellContext`ir$ - 1], {0}]]; $CellContext`tbl3$ = Table[
           Line[{{
              $CellContext`xs$[$CellContext`i$ + 1], 
              $CellContext`ys$[$CellContext`i$]}, {
              $CellContext`xs$[$CellContext`i$ + 1], 
              $CellContext`ys$[$CellContext`i$ + 1]}}], {$CellContext`i$, 
            0, $CellContext`imax$ - 1}]; $CellContext`tbl4$ = Table[
           Line[{{
              $CellContext`xs$[$CellContext`i$ - 1], 
              $CellContext`ys$[$CellContext`i$ - 1]}, {
              $CellContext`xs$[$CellContext`i$], 
              $CellContext`ys$[$CellContext`i$ - 1]}}], {$CellContext`i$, 
            1, $CellContext`imax$ + 
            1}]; $CellContext`it$ = $CellContext`imax$ + $CellContext`ir$ + 
          1; $CellContext`distflow$ = ($CellContext`zf$ - \
$CellContext`xs$[$CellContext`imax$ + 
            1])/$CellContext`xd$$; $CellContext`botflow$ = 
         1 - $CellContext`distflow$; $CellContext`xybase$ = Show[
           Plot[{
             $CellContext`equilb$[$CellContext`x], $CellContext`x}, \
{$CellContext`x, 0, 1}, PlotStyle -> {{Thick, Black}}, 
            PlotRange -> {{0, 1}, {0, 1}}], 
           If[$CellContext`cond$, {
             Plot[
              $CellContext`feed$[$CellContext`x], {$CellContext`x, \
$CellContext`xpinch$, $CellContext`zf$}, PlotStyle -> {Thick, Black}], 
             Plot[
              $CellContext`opertRect$[$CellContext`x], {$CellContext`x, \
$CellContext`xpinch$, $CellContext`xd$$}, PlotStyle -> {Thick, Black}], 
             Plot[
              $CellContext`opertStrp$[$CellContext`x], {$CellContext`x, \
$CellContext`xb$$, $CellContext`xpinch$}, PlotStyle -> {Thick, Black}]}, {
             Plot[
              $CellContext`feed$[$CellContext`x], {$CellContext`x, \
$CellContext`xinters$, $CellContext`zf$}, PlotStyle -> {Thick, Black}], 
             Plot[
              $CellContext`OpRect$[$CellContext`x], {$CellContext`x, \
$CellContext`xinters$, $CellContext`xd$$}, PlotStyle -> {Thick, Black}], 
             Plot[
              $CellContext`OpStrp$[$CellContext`x], {$CellContext`x, \
$CellContext`xb$$, $CellContext`xinters$}, PlotStyle -> {Thick, Black}]}], 
           
           Graphics[{
            Thick, Red, $CellContext`tbl1$, Blue, $CellContext`tbl2$}], Frame -> 
           True, FrameLabel -> {
             Row[{"liquid mole fraction ", 
               Subscript[
                Style["x", Italic], "meth"]}], 
             Row[{"vapor mole fraction ", 
               Subscript[
                Style["y", Italic], "meth"]}]}, LabelStyle -> {17, Black}, 
           AspectRatio -> Full, PlotRangePadding -> {0.02, {None, 0.05}}, 
           ImagePadding -> {{55, 10}, {50, 10}}]; $CellContext`xyadd$ = 
         Graphics[{{
            Thick, Dashed, Purple, $CellContext`tbl3$, 
             Magenta, $CellContext`tbl4$}, 
            Table[
             Text[
              
              Style[$CellContext`ir$ + 
               1 + $CellContext`imax$ - $CellContext`f, 18], {
               $CellContext`xr$[$CellContext`f], 
               $CellContext`yr$[$CellContext`f - 1]}, {
              1, -1}], {$CellContext`f, 1, $CellContext`ir$}], 
            Table[
             Text[
              Style[$CellContext`imax$ + 1 - $CellContext`f, 18, Red], {
               $CellContext`xs$[$CellContext`f], 
               $CellContext`ys$[$CellContext`f - 1]}, {
              1, -1}], {$CellContext`f, 1, $CellContext`imax$}], 
            Null}]; $CellContext`plot$ = 
         If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
           
           Show[$CellContext`xybase$, $CellContext`xyadd$], \
$CellContext`xybase$]; Grid[{{
            
            Show[$CellContext`plot$, ImageSize -> {600, 400}, PlotLabel -> 
             Style[
               
               If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
                
                Row[{"equilibrium stages needed = ", $CellContext`it$, 
                  " (including reboiler)"}], 
                "equilibrium stages needed = infinite (pinch point)"], 17]], 
            Text[
             Style[
              
              Grid[{{"R stages ir =", $CellContext`ir$}, {
                "S stages imax =", $CellContext`imax$}}], 18]]}}]], 
      "Specifications" :> {{{$CellContext`lvmult$$, 0.75, 
          Row[{"external reflux ratio ", 
            Style["L", Italic], "/", 
            Style["D", Italic]}]}, 0.25, 10, 0.25, Appearance -> "Labeled", 
         ControlPlacement -> 1}, {{$CellContext`xd$$, 0.85, 
          Row[{"distillate ", 
            Subscript[
             Style["x", Italic], "d"]}]}, 0.8, 0.98, 0.01, Appearance -> 
         "Labeled", ImageSize -> Small, ControlPlacement -> 
         2}, {{$CellContext`xb$$, 0.15, 
          Row[{"desired bottoms ", 
            Subscript[
             Style["x", Italic], "b"]}]}, 0.05, 0.2, 0.01, Appearance -> 
         "Labeled", ImageSize -> Small, ControlPlacement -> 3}, 
        Grid[{{
           Manipulate`Place[1], SpanFromLeft}, {
           Style["mole fractions:", Bold], 
           Manipulate`Place[2], 
           Manipulate`Place[3]}}, Alignment -> Left]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{793., {255., 262.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.686934520502507*^9, 3.6869345263818436`*^9}, 
   3.6870124626149473`*^9, {3.6870127533220263`*^9, 3.687012758810451*^9}, 
   3.687012833116439*^9, 3.687012864496004*^9, {3.6870129757131567`*^9, 
   3.6870130629058104`*^9}, 3.6870131427139645`*^9, {3.687013189052349*^9, 
   3.687013208924853*^9}, 3.6870132564390965`*^9, {3.687013303785741*^9, 
   3.6870133324275036`*^9}, 3.6870134265439916`*^9, 3.687013462969573*^9, {
   3.687013511461813*^9, 3.687013583949589*^9}, {3.687013629836219*^9, 
   3.687013639953283*^9}, 3.6870137154294577`*^9, 3.6870137823976173`*^9, 
   3.687013901290824*^9, 3.68701478844757*^9, {3.687014994292468*^9, 
   3.687015026600621*^9}},
 CellID->60536661]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"xybase", "=", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"equilb", "[", "x", "]"}], ",", "x"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Red"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"RGBColor", "[", 
             RowBox[{"0", ",", "0.6", ",", "0"}], "]"}]}], "}"}]}], "}"}]}], 
       ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"cond", ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"feed", "[", "x", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "xpinch", ",", "zf"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Blue"}], "}"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"opertRect", "[", "x", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "xpinch", ",", "xd"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Thick", ",", 
              RowBox[{"RGBColor", "[", 
               RowBox[{"1", ",", "0.4", ",", "0"}], "]"}]}], "}"}]}]}], "]"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"opertStrp", "[", "x", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "xb", ",", "xpinch"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Thick", ",", 
              RowBox[{"Hue", "@", "0.9"}]}], "}"}]}]}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"feed", "[", "x", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "xinters", ",", "zf"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Blue"}], "}"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"OpRect", "[", "x", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "xinters", ",", "xd"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Thick", ",", 
              RowBox[{"RGBColor", "[", 
               RowBox[{"1", ",", "0.4", ",", "0"}], "]"}]}], "}"}]}]}], "]"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"OpStrp", "[", "x", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "xb", ",", "xinters"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Thick", ",", 
              RowBox[{"Hue", "@", "0.9"}]}], "}"}]}]}], "]"}]}], "}"}]}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Graphics", "@", 
      RowBox[{"{", 
       RowBox[{
       "Thick", ",", "tbl1", ",", "tbl2", ",", "tblih", ",", "tbliv"}], 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Row", "@", 
         RowBox[{"{", 
          RowBox[{"\"\<liquid mole fraction \>\"", ",", 
           RowBox[{"Subscript", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
             "\"\<meth\>\""}], "]"}]}], "}"}]}], ",", 
        RowBox[{"Row", "@", 
         RowBox[{"{", 
          RowBox[{"\"\<vapor mole fraction \>\"", ",", 
           RowBox[{"Subscript", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
             "\"\<meth\>\""}], "]"}]}], "}"}]}]}], "}"}]}], ",", 
     RowBox[{"LabelStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"17", ",", "Black"}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.02", ",", 
        RowBox[{"{", 
         RowBox[{"None", ",", "0.05"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"ImagePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"55", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellID->752167533],

Cell[BoxData[
 RowBox[{
  RowBox[{"xyadd", "=", 
   RowBox[{"Graphics", "@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Thick", ",", "tbl3", ",", "tbl4"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"ir", "+", "1", "+", "imax", "-", "f"}], ",", "18"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xr", "[", "f", "]"}], ",", 
            RowBox[{"yr", "[", 
             RowBox[{"f", "-", "1"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", "1", ",", "ir"}], "}"}]}], "]"}], ",", 
      RowBox[{"(*", 
       RowBox[{"R", " ", "stage"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"imax", "+", "1", "-", "f"}], ",", "18"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xs", "[", "f", "]"}], ",", 
            RowBox[{"ys", "[", 
             RowBox[{"f", "-", "1"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", "1", ",", "imax"}], "}"}]}], "]"}], ",", 
      RowBox[{"(*", 
       RowBox[{"S", " ", "stage"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Dashed", ",", "\[IndentingNewLine]", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"xs", "[", 
              RowBox[{"imax", "+", "1"}], "]"}], ",", 
             RowBox[{"ys", "[", "imax", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"xs", "[", 
              RowBox[{"imax", "+", "1"}], "]"}], ",", "0"}], "}"}]}], "}"}], 
         "]"}], ",", 
        RowBox[{"(*", "bottoms", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"xr", "[", "0", "]"}], ",", 
             RowBox[{"yr", "[", "0", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"xr", "[", "0", "]"}], ",", "0"}], "}"}]}], "}"}], "]"}],
         ",", 
        RowBox[{"(*", "distill", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.5", ",", "0.5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.5", ",", "0"}], "}"}]}], "}"}], "]"}]}], 
       RowBox[{"(*", "feed", "*)"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                 "\"\<b\>\""}], "]"}], ",", "\"\< = \>\"", ",", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"xs", "[", 
                  RowBox[{"imax", "+", "1"}], "]"}], ",", "2"}], "]"}]}], 
              "}"}]}], ",", "17", ",", 
            RowBox[{"Hue", "@", "0.9"}], ",", 
            RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#", "<", "0.06"}], ",", "0", ",", "#"}], "]"}], ",", 
            "0.05"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#", "<", "0.06"}], ",", 
              RowBox[{"-", "1"}], ",", "0"}], "]"}], ",", "0"}], "}"}]}], 
         "]"}], "&"}], "@", 
       RowBox[{"xs", "[", 
        RowBox[{"imax", "+", "1"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                 "\"\<d\>\""}], "]"}], ",", "\"\< = \>\"", ",", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"xr", "[", "0", "]"}], ",", "2"}], "]"}]}], "}"}]}], 
            ",", "17", ",", 
            RowBox[{"RGBColor", "[", 
             RowBox[{"1", ",", "0.4", ",", "0"}], "]"}], ",", 
            RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#", ">", "0.94"}], ",", "1", ",", "#"}], "]"}], ",", 
            "0.05"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#", ">", "0.94"}], ",", "1", ",", "0"}], "]"}], ",", 
            "0"}], "}"}]}], "]"}], "&"}], "@", 
       RowBox[{"xr", "[", "0", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<R\>\"", ",", "18", ",", "Italic", ",", 
          RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xs", "[", 
           RowBox[{"imax", "+", "1"}], "]"}], ",", 
          RowBox[{"ys", "[", "imax", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Row", "@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Subscript", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<z\>\"", ",", "Italic"}], "]"}], ",", 
               "\"\<f\>\""}], "]"}], ",", "\"\< = 0.5\>\""}], "}"}]}], ",", 
          "17", ",", "Blue", ",", 
          RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", "0.15"}], "}"}]}], "]"}]}], 
     RowBox[{"(*", "feed", "*)"}], "\[IndentingNewLine]", "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6870135964748464`*^9, 3.687013606550102*^9}},
 CellID->494835141],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Grid", "@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Text", "@", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"yinters", "<", 
              RowBox[{"equilb", "[", "xinters", "]"}]}], ",", 
             RowBox[{"Row", "@", 
              RowBox[{"{", 
               RowBox[{
               "\"\<equilibrium stages needed = \>\"", ",", "it", ",", " ", 
                "\"\< (including reboiler)\>\""}], "}"}]}], ",", 
             "\"\<equilibrium stages needed = infinite (pinch point)\>\""}], 
            "]"}], ",", "17"}], "]"}]}], ",", "SpanFromLeft"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Show", "[", 
        RowBox[{"plot", ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{".95", 
           RowBox[{"{", 
            RowBox[{"596", ",", "375"}], "}"}]}]}]}], "]"}], "}"}]}], "}"}]}],
    ";"}], "*)"}]], "Input",
 CellID->240604102]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ManipulateCaptionSection"],

Cell[TextData[{
 "This Demonstration shows how to determine the number of equilibrium stages \
needed for a two-component (methanol/water) separation in a counter-current \
distillation column. It also shows the optimal location to feed the binary \
mixture into the column. Check \"view process flow diagram\" to show the ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]], "InlineMath"],
 "-",
 Cell[BoxData[
  FormBox["y", TraditionalForm]], "InlineMath"],
 " diagram on the left and the process flow diagram on the right. When that \
box is not checked, a larger ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]], "InlineMath"],
 "-",
 Cell[BoxData[
  FormBox["y", TraditionalForm]], "InlineMath"],
 " diagram is shown. The column feed has a methanol mole fraction of 0.5 and \
a quality of 0.5. The condenser is a complete condenser. Set the external \
reflux ratio ",
 Cell[BoxData[
  FormBox[
   RowBox[{"L", "/", "D"}], TraditionalForm]], "InlineMath"],
 ", as well as the methanol mole fractions in the distillate ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    StyleBox["d",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " and bottoms ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    StyleBox["b",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " streams, with sliders. When the \"view process flow diagram\" box is not \
checked, you can move the cursor over the ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]], "InlineMath"],
 "-",
 Cell[BoxData[
  FormBox["y", TraditionalForm]], "InlineMath"],
 " diagram to see the curve labels. The number of stages is determined by \
stepping off stages starting at the top of the column; the reboiler is an \
equilibrium stage. The number of equilibrium stages depends on the \
compositions of the exiting streams and the reflux ratio. "
}], "ManipulateCaption",
 CellChangeTimes->{{3.681654792044061*^9, 3.681654792465262*^9}, {
   3.6816548284511285`*^9, 3.6816549656646767`*^9}, {3.6816550995597763`*^9, 
   3.681655122816831*^9}, {3.6826930818587174`*^9, 3.682693166118923*^9}, {
   3.6826932047245*^9, 3.6826932072281704`*^9}, {3.6826932435307317`*^9, 
   3.682693247372942*^9}, {3.682694112760173*^9, 3.682694205058524*^9}, {
   3.6827989925658765`*^9, 3.68279900205731*^9}, 3.6827990586800904`*^9, {
   3.6839995911895523`*^9, 3.6839998295666265`*^9}, {3.6840712689999304`*^9, 
   3.6840714073630047`*^9}, {3.684240104257368*^9, 3.684240154108141*^9}, {
   3.684266439898534*^9, 3.6842665101165543`*^9}, {3.684276283952468*^9, 
   3.684276352407652*^9}, {3.684496153013041*^9, 3.684496161141451*^9}, {
   3.6844961995085*^9, 3.684496199572199*^9}, {3.684511347426283*^9, 
   3.684511368354951*^9}, 3.684512578331046*^9, {3.684512654081831*^9, 
   3.684512654378232*^9}, {3.684514094174843*^9, 3.684514130221065*^9}, {
   3.684514792495256*^9, 3.6845147939883623`*^9}},
 CellID->921506457]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ThumbnailSection"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`lvmult$$ = 3.25, $CellContext`pt$$ = {1.02, 
    0.184}, $CellContext`window$$ = True, $CellContext`xb$$ = 
    0.15, $CellContext`xd$$ = 0.85, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lvmult$$], 3.25, 
       Row[{"external reflux ratio ", 
         Style["L", Italic], "/", 
         Style["D", Italic]}]}, 0.25, 10, 0.25}, {{
       Hold[$CellContext`window$$], True, "view process flow diagram"}, {
      True, False}}, {{
       Hold[$CellContext`xd$$], 0.85, 
       Row[{"distillate ", 
         Subscript[
          Style["x", Italic], "d"]}]}, 0.8, 0.98, 0.01}, {{
       Hold[$CellContext`xb$$], 0.15, 
       Row[{"desired bottoms ", 
         Subscript[
          Style["x", Italic], "b"]}]}, 0.05, 0.2, 0.01}, {{
       Hold[$CellContext`pt$$], {1.02, 1.05}}, Automatic}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], SpanFromLeft, SpanFromLeft, 
          Manipulate`Place[2]}, {
          Style["mole fractions:", Bold], 
          Manipulate`Place[3], 
          Manipulate`Place[4], SpanFromLeft, 
          Manipulate`Place[5]}}, Alignment -> Left]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    579., {186.5, 193.5}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lvmult$3853$$ = 
    0, $CellContext`window$3854$$ = False, $CellContext`xd$3855$$ = 
    0, $CellContext`xb$3856$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`lvmult$$ = 
        3.25, $CellContext`pt$$ = {1.02, 1.05}, $CellContext`window$$ = 
        True, $CellContext`xb$$ = 0.15, $CellContext`xd$$ = 0.85}, 
      "ControllerVariables" :> {
        Hold[$CellContext`lvmult$$, $CellContext`lvmult$3853$$, 0], 
        Hold[$CellContext`window$$, $CellContext`window$3854$$, False], 
        Hold[$CellContext`xd$$, $CellContext`xd$3855$$, 0], 
        Hold[$CellContext`xb$$, $CellContext`xb$3856$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`cond$, $CellContext`zf$, $CellContext`q$, \
$CellContext`P$, $CellContext`Psat1$, $CellContext`Psat2$, $CellContext`A12$, \
$CellContext`A21$, $CellContext`\[Gamma]1$, $CellContext`\[Gamma]2$, \
$CellContext`i$, $CellContext`x1$, $CellContext`T$, $CellContext`y1$, \
$CellContext`equilb$, $CellContext`feed$, $CellContext`xpinch$, \
$CellContext`ypinch$, $CellContext`opertRect$, $CellContext`opertStrp$, \
$CellContext`Rmin$, $CellContext`R$, $CellContext`OpRect$, \
$CellContext`xinters$, $CellContext`yinters$, $CellContext`OpStrp$, \
$CellContext`yr$, $CellContext`xr$, $CellContext`v$, $CellContext`t$, \
$CellContext`ir$, $CellContext`ys$, $CellContext`xs$, $CellContext`imax$, \
$CellContext`tbl1$, $CellContext`tbl2$, $CellContext`tbl3$, \
$CellContext`tbl4$, $CellContext`tblih$, $CellContext`tbliv$, \
$CellContext`it$, $CellContext`distflow$, $CellContext`botflow$, \
$CellContext`xybase$, $CellContext`xyadd$, $CellContext`plot$, \
$CellContext`mouse$, $CellContext`diagram$}, $CellContext`cond$ = \
$CellContext`yinters$ >= $CellContext`equilb$[$CellContext`xinters$]; \
$CellContext`zf$ = 0.5; $CellContext`q$ = 0.5; $CellContext`P$ = 
         760; $CellContext`Psat1$[
           Pattern[$CellContext`temp, 
            Blank[]]] := 
         10^(8.08097 - 1582.271/(
           239.726 + $CellContext`temp)); $CellContext`Psat2$[
           Pattern[$CellContext`temp, 
            Blank[]]] := 
         10^(8.07131 - 1730.63/(
           233.426 + $CellContext`temp)); $CellContext`A12$ = 
         0.7923; $CellContext`A21$ = 0.5434; $CellContext`\[Gamma]1$[
           Pattern[$CellContext`i$, 
            Blank[]]] := 
         Exp[(1 - $CellContext`x1$[$CellContext`i$])^2 ($CellContext`A12$ + (
              2 ($CellContext`A21$ - $CellContext`A12$)) \
$CellContext`x1$[$CellContext`i$])]; $CellContext`\[Gamma]2$[
           Pattern[$CellContext`i$, 
            Blank[]]] := 
         Exp[$CellContext`x1$[$CellContext`i$]^2 ($CellContext`A21$ + (
              2 ($CellContext`A12$ - $CellContext`A21$)) (
              1 - $CellContext`x1$[$CellContext`i$]))]; $CellContext`i$ = 0; 
        While[$CellContext`i$ < 
          101, {$CellContext`x1$[$CellContext`i$] = 
           0.01 $CellContext`i$, $CellContext`T$[$CellContext`i$] = 
           ReplaceAll[$CellContext`temp, 
             Quiet[
              
              FindRoot[$CellContext`P$ == ($CellContext`x1$[$CellContext`i$] \
$CellContext`\[Gamma]1$[$CellContext`i$]) \
$CellContext`Psat1$[$CellContext`temp] + ((
                   1 - $CellContext`x1$[$CellContext`i$]) $CellContext`\
\[Gamma]2$[$CellContext`i$]) $CellContext`Psat2$[$CellContext`temp], \
{$CellContext`temp, 
                60}]]], $CellContext`y1$[$CellContext`i$] = \
($CellContext`x1$[$CellContext`i$] $CellContext`\[Gamma]1$[$CellContext`i$]) \
($CellContext`Psat1$[
               $CellContext`T$[$CellContext`i$]]/$CellContext`P$), 
           Increment[$CellContext`i$]}]; $CellContext`equilb$ = Interpolation[
           Table[{
             $CellContext`x1$[$CellContext`i$], 
             $CellContext`y1$[$CellContext`i$]}, {$CellContext`i$, 0, 
             100}]]; $CellContext`feed$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         If[$CellContext`q$ != 
           1, $CellContext`q$ ($CellContext`x$/($CellContext`q$ - 
             1)) - $CellContext`zf$/($CellContext`q$ - 1), 
           1000000 ($CellContext`x$ - $CellContext`zf$) + $CellContext`zf$]; \
$CellContext`xpinch$ = ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`feed$[$CellContext`x] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
              0.5}]]]; $CellContext`ypinch$ = \
$CellContext`feed$[$CellContext`xpinch$]; $CellContext`opertRect$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`ypinch$ + (($CellContext`x$ - \
$CellContext`xpinch$)/($CellContext`xd$$ - $CellContext`xpinch$)) \
($CellContext`xd$$ - $CellContext`ypinch$); $CellContext`opertStrp$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`ypinch$ + (($CellContext`x$ - \
$CellContext`xpinch$)/($CellContext`xb$$ - $CellContext`xpinch$)) \
($CellContext`xb$$ - $CellContext`ypinch$); $CellContext`Rmin$ = \
(($CellContext`xd$$ - $CellContext`ypinch$)/($CellContext`xd$$ - \
$CellContext`xpinch$))/(
          1 - ($CellContext`xd$$ - $CellContext`ypinch$)/($CellContext`xd$$ - \
$CellContext`xpinch$)); $CellContext`R$ = $CellContext`lvmult$$; \
$CellContext`OpRect$[
           Pattern[$CellContext`x$, 
            Blank[]]] := ($CellContext`R$/($CellContext`R$ + 
            1)) $CellContext`x$ + $CellContext`xd$$/($CellContext`R$ + 
           1); $CellContext`xinters$ = ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`feed$[$CellContext`x] == \
$CellContext`OpRect$[$CellContext`x], {$CellContext`x, 
              0.7}]]]; $CellContext`yinters$ = \
$CellContext`OpRect$[$CellContext`xinters$]; 
        If[$CellContext`cond$, {$CellContext`OpStrp$[
              Pattern[$CellContext`x$, 
               
               Blank[]]] := $CellContext`opertStrp$[$CellContext`x$]; \
$CellContext`yr$[0] = $CellContext`xd$$; $CellContext`xr$[
             0] = $CellContext`xd$$; $CellContext`i$ = 0; 
           While[$CellContext`i$ < 
             25, {$CellContext`v$ = ReplaceAll[$CellContext`u, 
                Quiet[
                 
                 FindRoot[$CellContext`yr$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`u], {$CellContext`u, 
                   0.5}]]], $CellContext`t$ = \
$CellContext`opertRect$[$CellContext`v$], 
              
              If[$CellContext`v$ > $CellContext`xpinch$, \
{$CellContext`xr$[$CellContext`i$ + 
                  1] = $CellContext`v$, $CellContext`yr$[$CellContext`i$ + 
                  1] = $CellContext`t$}], 
              
              Increment[$CellContext`i$]}]; $CellContext`ir$ = \
$CellContext`i$ - 1; 
           If[$CellContext`ir$ >= 
             0, {$CellContext`ys$[
                0] = $CellContext`yr$[$CellContext`ir$]; $CellContext`xs$[
                0] = $CellContext`xr$[$CellContext`ir$]}]; $CellContext`i$ = 
            0; While[$CellContext`i$ < 
             20, {$CellContext`v$ = ReplaceAll[$CellContext`u, 
                Quiet[
                 
                 FindRoot[$CellContext`ys$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`u], {$CellContext`u, 
                   0.5}]]], $CellContext`t$ = \
$CellContext`opertStrp$[$CellContext`v$], $CellContext`xs$[$CellContext`i$ + 
                1] = $CellContext`v$, $CellContext`ys$[$CellContext`i$ + 
                1] = $CellContext`t$, 
              Increment[$CellContext`i$]}]; Null}, {$CellContext`OpStrp$[
              Pattern[$CellContext`x$, 
               
               Blank[]]] := $CellContext`yinters$ + (($CellContext`x$ - \
$CellContext`xinters$)/($CellContext`xb$$ - $CellContext`xinters$)) \
($CellContext`xb$$ - $CellContext`yinters$); $CellContext`yr$[
             0] = $CellContext`xd$$; $CellContext`xr$[
             0] = $CellContext`xd$$; $CellContext`i$ = 0; 
           While[$CellContext`xr$[$CellContext`i$] > $CellContext`xinters$, \
{$CellContext`v$ = ReplaceAll[$CellContext`u, 
                Quiet[
                 
                 FindRoot[$CellContext`yr$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`u], {$CellContext`u, 
                   0.7}]]], $CellContext`t$ = \
$CellContext`OpRect$[$CellContext`v$], 
              
              If[$CellContext`v$ > $CellContext`xinters$, \
{$CellContext`xr$[$CellContext`i$ + 
                  1] = $CellContext`v$, $CellContext`yr$[$CellContext`i$ + 
                  1] = $CellContext`t$}], 
              
              Increment[$CellContext`i$]}]; $CellContext`ir$ = \
$CellContext`i$ - 1; $CellContext`i$ = 0; 
           If[$CellContext`ir$ >= 
             0, $CellContext`ys$[
               0] = $CellContext`yr$[$CellContext`ir$]; $CellContext`xs$[
               0] = $CellContext`xr$[$CellContext`ir$]]; 
           While[$CellContext`xs$[$CellContext`i$] > $CellContext`xb$$, \
{$CellContext`v$ = ReplaceAll[$CellContext`u, 
                Quiet[
                 
                 FindRoot[$CellContext`ys$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`u], {$CellContext`u, 
                   0.5}]]], $CellContext`t$ = \
$CellContext`OpStrp$[$CellContext`v$], $CellContext`xs$[$CellContext`i$ + 
                1] = $CellContext`v$, $CellContext`ys$[$CellContext`i$ + 
                1] = $CellContext`t$, 
              Increment[$CellContext`i$]}]; 
           Null}]; $CellContext`imax$ = $CellContext`i$ - 
          1; $CellContext`tbl1$ = Table[
           Line[{{
              $CellContext`xr$[$CellContext`i$], 
              $CellContext`yr$[$CellContext`i$ - 1]}, {
              $CellContext`xr$[$CellContext`i$], 
              $CellContext`yr$[$CellContext`i$]}}], {$CellContext`i$, 
            1, $CellContext`ir$}]; $CellContext`tbl2$ = 
         If[$CellContext`ir$ >= 1, 
           Table[
            Line[{{
               $CellContext`xr$[$CellContext`i$], 
               $CellContext`yr$[$CellContext`i$]}, {
               $CellContext`xr$[$CellContext`i$ + 1], 
               $CellContext`yr$[$CellContext`i$]}}], {$CellContext`i$, 
             0, $CellContext`ir$ - 1}], 
           Table[
            Line[{{
               $CellContext`xr$[$CellContext`i$], 
               $CellContext`yr$[$CellContext`i$]}, {
               $CellContext`xr$[$CellContext`i$ + 1], 
               $CellContext`yr$[$CellContext`i$]}}], {$CellContext`i$, 0, 
             0}]]; $CellContext`tbl3$ = Table[
           Line[{{
              $CellContext`xs$[$CellContext`i$ + 1], 
              $CellContext`ys$[$CellContext`i$]}, {
              $CellContext`xs$[$CellContext`i$ + 1], 
              $CellContext`ys$[$CellContext`i$ + 1]}}], {$CellContext`i$, 
            0, $CellContext`imax$ - 1}]; $CellContext`tbl4$ = Table[
           Line[{{
              $CellContext`xs$[$CellContext`i$ - 1], 
              $CellContext`ys$[$CellContext`i$ - 1]}, {
              $CellContext`xs$[$CellContext`i$], 
              $CellContext`ys$[$CellContext`i$ - 1]}}], {$CellContext`i$, 
            1, $CellContext`imax$ + 1}]; $CellContext`tblih$ = Line[{{
             $CellContext`xs$[1], 
             $CellContext`ys$[0]}, {
             $CellContext`xr$[$CellContext`ir$], 
             $CellContext`ys$[0]}}]; $CellContext`tbliv$ = Line[{{
             $CellContext`xs$[1], 
             $CellContext`ys$[0]}, {
             $CellContext`xs$[1], 
             $CellContext`ys$[
             1]}}]; $CellContext`it$ = $CellContext`imax$ + $CellContext`ir$ + 
          1; $CellContext`distflow$ = ($CellContext`zf$ - \
$CellContext`xs$[$CellContext`imax$ + 
            1])/$CellContext`xd$$; $CellContext`botflow$ = 
         1 - $CellContext`distflow$; $CellContext`xybase$ = Show[
           Plot[{
             $CellContext`equilb$[$CellContext`x], $CellContext`x}, \
{$CellContext`x, 0, 1}, PlotStyle -> {{Thick, Red}, {Thick, 
               RGBColor[0, 0.6, 0]}}, PlotRange -> {{0, 1}, {0, 1}}], 
           If[$CellContext`cond$, {
             Plot[
              $CellContext`feed$[$CellContext`x], {$CellContext`x, \
$CellContext`xpinch$, $CellContext`zf$}, PlotStyle -> {Thick, Blue}], 
             Plot[
              $CellContext`opertRect$[$CellContext`x], {$CellContext`x, \
$CellContext`xpinch$, $CellContext`xd$$}, PlotStyle -> {Thick, 
                RGBColor[1, 0.4, 0]}], 
             Plot[
              $CellContext`opertStrp$[$CellContext`x], {$CellContext`x, \
$CellContext`xb$$, $CellContext`xpinch$}, PlotStyle -> {Thick, 
                Hue[0.9]}]}, {
             Plot[
              $CellContext`feed$[$CellContext`x], {$CellContext`x, \
$CellContext`xinters$, $CellContext`zf$}, PlotStyle -> {Thick, Blue}], 
             Plot[
              $CellContext`OpRect$[$CellContext`x], {$CellContext`x, \
$CellContext`xinters$, $CellContext`xd$$}, PlotStyle -> {Thick, 
                RGBColor[1, 0.4, 0]}], 
             Plot[
              $CellContext`OpStrp$[$CellContext`x], {$CellContext`x, \
$CellContext`xb$$, $CellContext`xinters$}, PlotStyle -> {Thick, 
                Hue[0.9]}]}], 
           
           Graphics[{
            Thick, $CellContext`tbl1$, $CellContext`tbl2$, \
$CellContext`tblih$, $CellContext`tbliv$}], Frame -> True, FrameLabel -> {
             Row[{"liquid mole fraction ", 
               Subscript[
                Style["x", Italic], "meth"]}], 
             Row[{"vapor mole fraction ", 
               Subscript[
                Style["y", Italic], "meth"]}]}, LabelStyle -> {17, Black}, 
           AspectRatio -> Full, PlotRangePadding -> {0.02, {None, 0.05}}, 
           ImagePadding -> {{55, 10}, {50, 10}}]; $CellContext`xyadd$ = 
         Graphics[{{Thick, $CellContext`tbl3$, $CellContext`tbl4$}, 
            Table[
             Text[
              
              Style[$CellContext`ir$ + 
               1 + $CellContext`imax$ - $CellContext`f, 18], {
               $CellContext`xr$[$CellContext`f], 
               $CellContext`yr$[$CellContext`f - 1]}, {
              1, -1}], {$CellContext`f, 1, $CellContext`ir$}], 
            Table[
             Text[
              Style[$CellContext`imax$ + 1 - $CellContext`f, 18], {
               $CellContext`xs$[$CellContext`f], 
               $CellContext`ys$[$CellContext`f - 1]}, {
              1, -1}], {$CellContext`f, 1, $CellContext`imax$}], {Dashed, 
             Line[{{
                $CellContext`xs$[$CellContext`imax$ + 1], 
                $CellContext`ys$[$CellContext`imax$]}, {
                $CellContext`xs$[$CellContext`imax$ + 1], 0}}], 
             Line[{{
                $CellContext`xr$[0], 
                $CellContext`yr$[0]}, {
                $CellContext`xr$[0], 0}}], 
             Line[{{0.5, 0.5}, {0.5, 0}}]}, 
            (ReplaceAll[
             Text[
              Style[
               Row[{
                 Subscript[
                  Style["x", Italic], "b"], " = ", 
                 NumberForm[
                  $CellContext`xs$[$CellContext`imax$ + 1], 2]}], 17, 
               Hue[0.9], Background -> White], {
               If[# < $CellContext`test, 0, #], 0.05}, {
               If[# < $CellContext`test, -1, 0], 0}], $CellContext`test -> 
             If[$CellContext`window$$, 0.15, 0.06]]& )[
             $CellContext`xs$[$CellContext`imax$ + 1]], 
            (ReplaceAll[
             Text[
              Style[
               Row[{
                 Subscript[
                  Style["x", Italic], "d"], " = ", 
                 NumberForm[
                  $CellContext`xr$[0], 2]}], 17, 
               RGBColor[1, 0.4, 0], Background -> White], {
               If[# > $CellContext`test, 1, #], 0.05}, {
               If[# > $CellContext`test, 1, 0], 0}], $CellContext`test -> 
             If[$CellContext`window$$, 0.86, 0.94]]& )[
             $CellContext`xr$[0]], 
            Text[
             Style["R", 18, Italic, Background -> White], {
              $CellContext`xs$[$CellContext`imax$ + 1], 
              $CellContext`ys$[$CellContext`imax$]}, {0, -1}], 
            Text[
             Style[
              Row[{
                Subscript[
                 Style["z", Italic], "f"], " = 0.5"}], 17, Blue, Background -> 
              White], {0.5, 0.15}]}]; $CellContext`plot$ = 
         If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
           
           Show[$CellContext`xybase$, $CellContext`xyadd$], \
$CellContext`xybase$]; $CellContext`mouse$ = Graphics[{
            Apply[Mouseover[{
               Thickness[0.02], Transparent, 
               Line[
                Table[#, 
                 Evaluate[
                  Flatten[{$CellContext`x, #2, 0.05}]]]]}, 
              Text[
               Framed[
                Style[#3, 18, #4], Background -> LightYellow], {0.15, 
               0.9}]]& , {{{$CellContext`x, $CellContext`x}, {0, 1}, 
               Row[{
                 Style["x", Italic], " = ", 
                 Style["y", Italic], " line"}], 
               RGBColor[0, 0.6, 0]}, {{$CellContext`x, 
                $CellContext`equilb$[$CellContext`x]}, {0, 1}, 
               "equilibrium curve", Red}, {{$CellContext`x, 
                $CellContext`feed$[$CellContext`x]}, {
                
                If[$CellContext`cond$, $CellContext`xpinch$, \
$CellContext`xinters$], $CellContext`zf$}, 
               Row[{
                 Style["q", Italic], "-line"}], Blue}, {{$CellContext`x, 
                If[$CellContext`cond$, 
                 $CellContext`opertRect$[$CellContext`x], 
                 $CellContext`OpRect$[$CellContext`x]]}, {
                
                If[$CellContext`cond$, $CellContext`xpinch$, \
$CellContext`xinters$], $CellContext`xd$$}, "rectifying section", 
               RGBColor[1, 0.4, 0]}, {{$CellContext`x, 
                If[$CellContext`cond$, 
                 $CellContext`opertStrp$[$CellContext`x], 
                 $CellContext`OpStrp$[$CellContext`x]]}, {$CellContext`xb$$, 
                
                If[$CellContext`cond$, $CellContext`xpinch$, \
$CellContext`xinters$]}, "stripping section", 
               Hue[0.9]}}, {1}], 
            Apply[Mouseover[{
               Thickness[0.02], Transparent, #}, 
              Text[
               Framed[
                Style[#2, 18], Background -> LightYellow], {0.15, 
               0.9}]]& , {{{$CellContext`tbl1$, $CellContext`tbl2$, \
$CellContext`tblih$, $CellContext`tbliv$, 
                
                If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], {$CellContext`tbl3$, \
$CellContext`tbl4$}]}, "equilibrium stages"}, {
               Line[{{
                  $CellContext`xs$[$CellContext`imax$ + 1], 
                  $CellContext`ys$[$CellContext`imax$]}, {
                  $CellContext`xs$[$CellContext`imax$ + 1], 0}}], "bottoms"}, {
               Line[{{
                  $CellContext`xr$[0], 
                  $CellContext`yr$[0]}, {
                  $CellContext`xr$[0], 0}}], "distillate"}, {
               Line[{{0.5, 0.5}, {0.5, 0}}], "feed"}}, {
             1}]}]; $CellContext`diagram$ = Graphics[{{
             EdgeForm[Thick], 
             FaceForm[None], 
             Rectangle[{0, 0}, {1, 3}], 
             Disk[{0.75, -0.5}, 1.1 {0.25, 0.15}], 
             Disk[{1.75, 2.8}, 1.1 {0.25, 0.15}]}, {Thick, 
             Arrowheads[0.07], 
             Arrow[{{0.5, -0.5}, {0.25, -0.5}, {0.25, 0}}], 
             Arrow[{{0.75, 0}, {0.75, -0.32}}], {
              Hue[0.9], 
              Arrow[{{1.05, -0.5}, {3, -0.5}}]}, 
             Arrow[{{0.25, 3}, {0.25, 3.4}, {1.75, 3.4}, {1.75, 2.95}}], 
             Arrow[{{1.5, 2.8}, {1, 2.8}}], {
              RGBColor[1, 0.4, 0], 
              Arrow[{{2.05, 2.8}, {3, 2.8}}]}, 
             
             If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], {{Blue, 
                
                Arrow[{{-1.5, 
                   3 ((2 $CellContext`imax$ + 1)/(2 $CellContext`it$))}, {
                  0, 3 ((2 $CellContext`imax$ + 1)/(2 $CellContext`it$))}}]}, 
               Map[{
                 Text[
                  Style[#, 17], {0.5, 3 (#/$CellContext`it$)}, {0, -1.1}], 
                 
                 Line[{{0, 3 (#/$CellContext`it$)}, {
                   1, 3 (#/$CellContext`it$)}}]}& , 
                Range[$CellContext`it$ - 1]]}, 
              Arrow[{{-1.5, 1.5}, {0, 1.5}}]]}, 
            Apply[Text[
              Style[#, 17, Italic], #2]& , {{"R", {0.75, -0.5}}, {
              "C", {1.75, 2.8}}}, {1}], 
            Text[
             Style[
              Column[{"feed rate", "1.00 kmol/h", 
                Spacer[1], 
                Row[{
                  Subscript[
                   Style["z", Italic], "f"], " = 0.5"}], "quality = 0.5"}, 
               Center], 17, Blue], {-0.85, 
              
              If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
               3 ((2 $CellContext`imax$ + 1)/(2 $CellContext`it$)), 1.5]}, {
             0, 0.05}], 
            Text[
             Style[
              Column[{"reflux ratio", 
                Row[{
                  Style["L", Italic], "/", 
                  Style["D", Italic], " = ", 
                  NumberForm[$CellContext`R$, {3, 2}]}]}, Center], 17], {1.95,
              2.17}], 
            Text[
             Style[
              Column[{
                Column[{"distillate flow", 
                  
                  If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
                   Row[{
                    NumberForm[$CellContext`distflow$, {2, 2}], " kmol/h"}], 
                   "N/A"]}, Center], 
                Row[{
                  Subscript[
                   Style["x", Italic], "d"], " = ", 
                  $CellContext`xr$[0]}]}, Center, Spacings -> 1], 17, 
              RGBColor[1, 0.4, 0]], {2.8, 2.91}], 
            Text[
             Style[
              Column[{
                Column[{"bottoms flow", 
                  
                  If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
                   Row[{
                    NumberForm[$CellContext`botflow$, {2, 2}], " kmol/h"}], 
                   "N/A"]}, Center], 
                Row[{
                  Subscript[
                   Style["x", Italic], "b"], " = ", 
                  NumberForm[
                   $CellContext`xs$[$CellContext`imax$ + 1], 2]}]}, Center, 
               Spacings -> 1], 17, 
              Hue[0.9]], {2.8, -0.39}]}, ImageSize -> 0.95 {290, 375}, 
           AspectRatio -> Full]; Switch[$CellContext`window$$, True, 
          Grid[{{
             Text[
              Style[
               
               If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
                
                Row[{"equilibrium stages needed = ", $CellContext`it$, 
                  " (including reboiler)"}], 
                "equilibrium stages needed = infinite (pinch point)"], 17]], 
             SpanFromLeft}, {
             
             Show[$CellContext`plot$, ImageSize -> 
              0.95 {310, 375}], $CellContext`diagram$}}], False, 
          Grid[{{
             Text[
              Style[
               
               If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
                
                Row[{"equilibrium stages needed = ", $CellContext`it$, 
                  " (including reboiler)"}], 
                "equilibrium stages needed = infinite (pinch point)"], 17]], 
             SpanFromLeft}, {
             
             Show[$CellContext`plot$, $CellContext`mouse$, ImageSize -> 
              0.95 {596, 375}]}}]]], 
      "Specifications" :> {{{$CellContext`lvmult$$, 3.25, 
          Row[{"external reflux ratio ", 
            Style["L", Italic], "/", 
            Style["D", Italic]}]}, 0.25, 10, 0.25, Appearance -> "Labeled", 
         ControlPlacement -> 
         1}, {{$CellContext`window$$, True, "view process flow diagram"}, {
         True, False}, ControlPlacement -> 2}, {{$CellContext`xd$$, 0.85, 
          Row[{"distillate ", 
            Subscript[
             Style["x", Italic], "d"]}]}, 0.8, 0.98, 0.01, Appearance -> 
         "Labeled", ImageSize -> Small, ControlPlacement -> 
         3}, {{$CellContext`xb$$, 0.15, 
          Row[{"desired bottoms ", 
            Subscript[
             Style["x", Italic], "b"]}]}, 0.05, 0.2, 0.01, Appearance -> 
         "Labeled", ImageSize -> Small, ControlPlacement -> 
         4}, {{$CellContext`pt$$, {1.02, 1.05}}, Automatic, ControlType -> 
         Locator, Appearance -> None, AutoAction -> True, ControlPlacement -> 
         5}, 
        Grid[{{
           Manipulate`Place[1], SpanFromLeft, SpanFromLeft, 
           Manipulate`Place[2]}, {
           Style["mole fractions:", Bold], 
           Manipulate`Place[3], 
           Manipulate`Place[4], SpanFromLeft, 
           Manipulate`Place[5]}}, Alignment -> Left]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{634., {248., 255.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->450018725]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SnapshotsSection"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`lvmult$$ = 3, $CellContext`pt$$ = {
    0.39999999999999997`, 1.026}, $CellContext`window$$ = 
    False, $CellContext`xb$$ = 0.15, $CellContext`xd$$ = 0.85, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lvmult$$], 3, 
       Row[{"external reflux ratio ", 
         Style["L", Italic], "/", 
         Style["D", Italic]}]}, 0.25, 10, 0.25}, {{
       Hold[$CellContext`window$$], False, "view process flow diagram"}, {
      True, False}}, {{
       Hold[$CellContext`xd$$], 0.85, 
       Row[{"distillate ", 
         Subscript[
          Style["x", Italic], "d"]}]}, 0.8, 0.98, 0.01}, {{
       Hold[$CellContext`xb$$], 0.15, 
       Row[{"desired bottoms ", 
         Subscript[
          Style["x", Italic], "b"]}]}, 0.05, 0.2, 0.01}, {{
       Hold[$CellContext`pt$$], {0.39999999999999997`, 1.026}}, Automatic}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], SpanFromLeft, SpanFromLeft, 
          Manipulate`Place[2]}, {
          Style["mole fractions:", Bold], 
          Manipulate`Place[3], 
          Manipulate`Place[4], SpanFromLeft, 
          Manipulate`Place[5]}}, Alignment -> Left]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    578., {186.5, 193.5}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lvmult$3925$$ = 
    0, $CellContext`window$3926$$ = False, $CellContext`xd$3927$$ = 
    0, $CellContext`xb$3928$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`lvmult$$ = 
        3, $CellContext`pt$$ = {0.39999999999999997`, 
         1.026}, $CellContext`window$$ = False, $CellContext`xb$$ = 
        0.15, $CellContext`xd$$ = 0.85}, "ControllerVariables" :> {
        Hold[$CellContext`lvmult$$, $CellContext`lvmult$3925$$, 0], 
        Hold[$CellContext`window$$, $CellContext`window$3926$$, False], 
        Hold[$CellContext`xd$$, $CellContext`xd$3927$$, 0], 
        Hold[$CellContext`xb$$, $CellContext`xb$3928$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`cond$, $CellContext`zf$, $CellContext`q$, \
$CellContext`P$, $CellContext`Psat1$, $CellContext`Psat2$, $CellContext`A12$, \
$CellContext`A21$, $CellContext`\[Gamma]1$, $CellContext`\[Gamma]2$, \
$CellContext`i$, $CellContext`x1$, $CellContext`T$, $CellContext`y1$, \
$CellContext`equilb$, $CellContext`feed$, $CellContext`xpinch$, \
$CellContext`ypinch$, $CellContext`opertRect$, $CellContext`opertStrp$, \
$CellContext`Rmin$, $CellContext`R$, $CellContext`OpRect$, \
$CellContext`xinters$, $CellContext`yinters$, $CellContext`OpStrp$, \
$CellContext`yr$, $CellContext`xr$, $CellContext`v$, $CellContext`t$, \
$CellContext`ir$, $CellContext`ys$, $CellContext`xs$, $CellContext`imax$, \
$CellContext`tbl1$, $CellContext`tbl2$, $CellContext`tbl3$, \
$CellContext`tbl4$, $CellContext`tblih$, $CellContext`tbliv$, \
$CellContext`it$, $CellContext`distflow$, $CellContext`botflow$, \
$CellContext`xybase$, $CellContext`xyadd$, $CellContext`plot$, \
$CellContext`mouse$, $CellContext`diagram$}, $CellContext`cond$ = \
$CellContext`yinters$ >= $CellContext`equilb$[$CellContext`xinters$]; \
$CellContext`zf$ = 0.5; $CellContext`q$ = 0.5; $CellContext`P$ = 
         760; $CellContext`Psat1$[
           Pattern[$CellContext`temp, 
            Blank[]]] := 
         10^(8.08097 - 1582.271/(
           239.726 + $CellContext`temp)); $CellContext`Psat2$[
           Pattern[$CellContext`temp, 
            Blank[]]] := 
         10^(8.07131 - 1730.63/(
           233.426 + $CellContext`temp)); $CellContext`A12$ = 
         0.7923; $CellContext`A21$ = 0.5434; $CellContext`\[Gamma]1$[
           Pattern[$CellContext`i$, 
            Blank[]]] := 
         Exp[(1 - $CellContext`x1$[$CellContext`i$])^2 ($CellContext`A12$ + (
              2 ($CellContext`A21$ - $CellContext`A12$)) \
$CellContext`x1$[$CellContext`i$])]; $CellContext`\[Gamma]2$[
           Pattern[$CellContext`i$, 
            Blank[]]] := 
         Exp[$CellContext`x1$[$CellContext`i$]^2 ($CellContext`A21$ + (
              2 ($CellContext`A12$ - $CellContext`A21$)) (
              1 - $CellContext`x1$[$CellContext`i$]))]; $CellContext`i$ = 0; 
        While[$CellContext`i$ < 
          101, {$CellContext`x1$[$CellContext`i$] = 
           0.01 $CellContext`i$, $CellContext`T$[$CellContext`i$] = 
           ReplaceAll[$CellContext`temp, 
             Quiet[
              
              FindRoot[$CellContext`P$ == ($CellContext`x1$[$CellContext`i$] \
$CellContext`\[Gamma]1$[$CellContext`i$]) \
$CellContext`Psat1$[$CellContext`temp] + ((
                   1 - $CellContext`x1$[$CellContext`i$]) $CellContext`\
\[Gamma]2$[$CellContext`i$]) $CellContext`Psat2$[$CellContext`temp], \
{$CellContext`temp, 
                60}]]], $CellContext`y1$[$CellContext`i$] = \
($CellContext`x1$[$CellContext`i$] $CellContext`\[Gamma]1$[$CellContext`i$]) \
($CellContext`Psat1$[
               $CellContext`T$[$CellContext`i$]]/$CellContext`P$), 
           Increment[$CellContext`i$]}]; $CellContext`equilb$ = Interpolation[
           Table[{
             $CellContext`x1$[$CellContext`i$], 
             $CellContext`y1$[$CellContext`i$]}, {$CellContext`i$, 0, 
             100}]]; $CellContext`feed$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         If[$CellContext`q$ != 
           1, $CellContext`q$ ($CellContext`x$/($CellContext`q$ - 
             1)) - $CellContext`zf$/($CellContext`q$ - 1), 
           1000000 ($CellContext`x$ - $CellContext`zf$) + $CellContext`zf$]; \
$CellContext`xpinch$ = ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`feed$[$CellContext`x] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
              0.5}]]]; $CellContext`ypinch$ = \
$CellContext`feed$[$CellContext`xpinch$]; $CellContext`opertRect$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`ypinch$ + (($CellContext`x$ - \
$CellContext`xpinch$)/($CellContext`xd$$ - $CellContext`xpinch$)) \
($CellContext`xd$$ - $CellContext`ypinch$); $CellContext`opertStrp$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`ypinch$ + (($CellContext`x$ - \
$CellContext`xpinch$)/($CellContext`xb$$ - $CellContext`xpinch$)) \
($CellContext`xb$$ - $CellContext`ypinch$); $CellContext`Rmin$ = \
(($CellContext`xd$$ - $CellContext`ypinch$)/($CellContext`xd$$ - \
$CellContext`xpinch$))/(
          1 - ($CellContext`xd$$ - $CellContext`ypinch$)/($CellContext`xd$$ - \
$CellContext`xpinch$)); $CellContext`R$ = $CellContext`lvmult$$; \
$CellContext`OpRect$[
           Pattern[$CellContext`x$, 
            Blank[]]] := ($CellContext`R$/($CellContext`R$ + 
            1)) $CellContext`x$ + $CellContext`xd$$/($CellContext`R$ + 
           1); $CellContext`xinters$ = ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`feed$[$CellContext`x] == \
$CellContext`OpRect$[$CellContext`x], {$CellContext`x, 
              0.7}]]]; $CellContext`yinters$ = \
$CellContext`OpRect$[$CellContext`xinters$]; 
        If[$CellContext`cond$, {$CellContext`OpStrp$[
              Pattern[$CellContext`x$, 
               
               Blank[]]] := $CellContext`opertStrp$[$CellContext`x$]; \
$CellContext`yr$[0] = $CellContext`xd$$; $CellContext`xr$[
             0] = $CellContext`xd$$; $CellContext`i$ = 0; 
           While[$CellContext`i$ < 
             25, {$CellContext`v$ = ReplaceAll[$CellContext`u, 
                Quiet[
                 
                 FindRoot[$CellContext`yr$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`u], {$CellContext`u, 
                   0.5}]]], $CellContext`t$ = \
$CellContext`opertRect$[$CellContext`v$], 
              
              If[$CellContext`v$ > $CellContext`xpinch$, \
{$CellContext`xr$[$CellContext`i$ + 
                  1] = $CellContext`v$, $CellContext`yr$[$CellContext`i$ + 
                  1] = $CellContext`t$}], 
              
              Increment[$CellContext`i$]}]; $CellContext`ir$ = \
$CellContext`i$ - 1; 
           If[$CellContext`ir$ >= 
             0, {$CellContext`ys$[
                0] = $CellContext`yr$[$CellContext`ir$]; $CellContext`xs$[
                0] = $CellContext`xr$[$CellContext`ir$]}]; $CellContext`i$ = 
            0; While[$CellContext`i$ < 
             20, {$CellContext`v$ = ReplaceAll[$CellContext`u, 
                Quiet[
                 
                 FindRoot[$CellContext`ys$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`u], {$CellContext`u, 
                   0.5}]]], $CellContext`t$ = \
$CellContext`opertStrp$[$CellContext`v$], $CellContext`xs$[$CellContext`i$ + 
                1] = $CellContext`v$, $CellContext`ys$[$CellContext`i$ + 
                1] = $CellContext`t$, 
              Increment[$CellContext`i$]}]; Null}, {$CellContext`OpStrp$[
              Pattern[$CellContext`x$, 
               
               Blank[]]] := $CellContext`yinters$ + (($CellContext`x$ - \
$CellContext`xinters$)/($CellContext`xb$$ - $CellContext`xinters$)) \
($CellContext`xb$$ - $CellContext`yinters$); $CellContext`yr$[
             0] = $CellContext`xd$$; $CellContext`xr$[
             0] = $CellContext`xd$$; $CellContext`i$ = 0; 
           While[$CellContext`xr$[$CellContext`i$] > $CellContext`xinters$, \
{$CellContext`v$ = ReplaceAll[$CellContext`u, 
                Quiet[
                 
                 FindRoot[$CellContext`yr$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`u], {$CellContext`u, 
                   0.7}]]], $CellContext`t$ = \
$CellContext`OpRect$[$CellContext`v$], 
              
              If[$CellContext`v$ > $CellContext`xinters$, \
{$CellContext`xr$[$CellContext`i$ + 
                  1] = $CellContext`v$, $CellContext`yr$[$CellContext`i$ + 
                  1] = $CellContext`t$}], 
              
              Increment[$CellContext`i$]}]; $CellContext`ir$ = \
$CellContext`i$ - 1; $CellContext`i$ = 0; 
           If[$CellContext`ir$ >= 
             0, $CellContext`ys$[
               0] = $CellContext`yr$[$CellContext`ir$]; $CellContext`xs$[
               0] = $CellContext`xr$[$CellContext`ir$]]; 
           While[$CellContext`xs$[$CellContext`i$] > $CellContext`xb$$, \
{$CellContext`v$ = ReplaceAll[$CellContext`u, 
                Quiet[
                 
                 FindRoot[$CellContext`ys$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`u], {$CellContext`u, 
                   0.5}]]], $CellContext`t$ = \
$CellContext`OpStrp$[$CellContext`v$], $CellContext`xs$[$CellContext`i$ + 
                1] = $CellContext`v$, $CellContext`ys$[$CellContext`i$ + 
                1] = $CellContext`t$, 
              Increment[$CellContext`i$]}]; 
           Null}]; $CellContext`imax$ = $CellContext`i$ - 
          1; $CellContext`tbl1$ = Table[
           Line[{{
              $CellContext`xr$[$CellContext`i$], 
              $CellContext`yr$[$CellContext`i$ - 1]}, {
              $CellContext`xr$[$CellContext`i$], 
              $CellContext`yr$[$CellContext`i$]}}], {$CellContext`i$, 
            1, $CellContext`ir$}]; $CellContext`tbl2$ = 
         If[$CellContext`ir$ >= 1, 
           Table[
            Line[{{
               $CellContext`xr$[$CellContext`i$], 
               $CellContext`yr$[$CellContext`i$]}, {
               $CellContext`xr$[$CellContext`i$ + 1], 
               $CellContext`yr$[$CellContext`i$]}}], {$CellContext`i$, 
             0, $CellContext`ir$ - 1}], 
           Table[
            Line[{{
               $CellContext`xr$[$CellContext`i$], 
               $CellContext`yr$[$CellContext`i$]}, {
               $CellContext`xr$[$CellContext`i$ + 1], 
               $CellContext`yr$[$CellContext`i$]}}], {$CellContext`i$, 0, 
             0}]]; $CellContext`tbl3$ = Table[
           Line[{{
              $CellContext`xs$[$CellContext`i$ + 1], 
              $CellContext`ys$[$CellContext`i$]}, {
              $CellContext`xs$[$CellContext`i$ + 1], 
              $CellContext`ys$[$CellContext`i$ + 1]}}], {$CellContext`i$, 
            0, $CellContext`imax$ - 1}]; $CellContext`tbl4$ = Table[
           Line[{{
              $CellContext`xs$[$CellContext`i$ - 1], 
              $CellContext`ys$[$CellContext`i$ - 1]}, {
              $CellContext`xs$[$CellContext`i$], 
              $CellContext`ys$[$CellContext`i$ - 1]}}], {$CellContext`i$, 
            1, $CellContext`imax$ + 1}]; $CellContext`tblih$ = Line[{{
             $CellContext`xs$[1], 
             $CellContext`ys$[0]}, {
             $CellContext`xr$[$CellContext`ir$], 
             $CellContext`ys$[0]}}]; $CellContext`tbliv$ = Line[{{
             $CellContext`xs$[1], 
             $CellContext`ys$[0]}, {
             $CellContext`xs$[1], 
             $CellContext`ys$[
             1]}}]; $CellContext`it$ = $CellContext`imax$ + $CellContext`ir$ + 
          1; $CellContext`distflow$ = ($CellContext`zf$ - \
$CellContext`xs$[$CellContext`imax$ + 
            1])/$CellContext`xd$$; $CellContext`botflow$ = 
         1 - $CellContext`distflow$; $CellContext`xybase$ = Show[
           Plot[{
             $CellContext`equilb$[$CellContext`x], $CellContext`x}, \
{$CellContext`x, 0, 1}, PlotStyle -> {{Thick, Red}, {Thick, 
               RGBColor[0, 0.6, 0]}}, PlotRange -> {{0, 1}, {0, 1}}], 
           If[$CellContext`cond$, {
             Plot[
              $CellContext`feed$[$CellContext`x], {$CellContext`x, \
$CellContext`xpinch$, $CellContext`zf$}, PlotStyle -> {Thick, Blue}], 
             Plot[
              $CellContext`opertRect$[$CellContext`x], {$CellContext`x, \
$CellContext`xpinch$, $CellContext`xd$$}, PlotStyle -> {Thick, 
                RGBColor[1, 0.4, 0]}], 
             Plot[
              $CellContext`opertStrp$[$CellContext`x], {$CellContext`x, \
$CellContext`xb$$, $CellContext`xpinch$}, PlotStyle -> {Thick, 
                Hue[0.9]}]}, {
             Plot[
              $CellContext`feed$[$CellContext`x], {$CellContext`x, \
$CellContext`xinters$, $CellContext`zf$}, PlotStyle -> {Thick, Blue}], 
             Plot[
              $CellContext`OpRect$[$CellContext`x], {$CellContext`x, \
$CellContext`xinters$, $CellContext`xd$$}, PlotStyle -> {Thick, 
                RGBColor[1, 0.4, 0]}], 
             Plot[
              $CellContext`OpStrp$[$CellContext`x], {$CellContext`x, \
$CellContext`xb$$, $CellContext`xinters$}, PlotStyle -> {Thick, 
                Hue[0.9]}]}], 
           
           Graphics[{
            Thick, $CellContext`tbl1$, $CellContext`tbl2$, \
$CellContext`tblih$, $CellContext`tbliv$}], Frame -> True, FrameLabel -> {
             Row[{"liquid mole fraction ", 
               Subscript[
                Style["x", Italic], "meth"]}], 
             Row[{"vapor mole fraction ", 
               Subscript[
                Style["y", Italic], "meth"]}]}, LabelStyle -> {17, Black}, 
           AspectRatio -> Full, PlotRangePadding -> {0.02, {None, 0.05}}, 
           ImagePadding -> {{55, 10}, {50, 10}}]; $CellContext`xyadd$ = 
         Graphics[{{Thick, $CellContext`tbl3$, $CellContext`tbl4$}, 
            Table[
             Text[
              
              Style[$CellContext`ir$ + 
               1 + $CellContext`imax$ - $CellContext`f, 18], {
               $CellContext`xr$[$CellContext`f], 
               $CellContext`yr$[$CellContext`f - 1]}, {
              1, -1}], {$CellContext`f, 1, $CellContext`ir$}], 
            Table[
             Text[
              Style[$CellContext`imax$ + 1 - $CellContext`f, 18], {
               $CellContext`xs$[$CellContext`f], 
               $CellContext`ys$[$CellContext`f - 1]}, {
              1, -1}], {$CellContext`f, 1, $CellContext`imax$}], {Dashed, 
             Line[{{
                $CellContext`xs$[$CellContext`imax$ + 1], 
                $CellContext`ys$[$CellContext`imax$]}, {
                $CellContext`xs$[$CellContext`imax$ + 1], 0}}], 
             Line[{{
                $CellContext`xr$[0], 
                $CellContext`yr$[0]}, {
                $CellContext`xr$[0], 0}}], 
             Line[{{0.5, 0.5}, {0.5, 0}}]}, 
            (ReplaceAll[
             Text[
              Style[
               Row[{
                 Subscript[
                  Style["x", Italic], "b"], " = ", 
                 NumberForm[
                  $CellContext`xs$[$CellContext`imax$ + 1], 2]}], 17, 
               Hue[0.9], Background -> White], {
               If[# < $CellContext`test, 0, #], 0.05}, {
               If[# < $CellContext`test, -1, 0], 0}], $CellContext`test -> 
             If[$CellContext`window$$, 0.15, 0.06]]& )[
             $CellContext`xs$[$CellContext`imax$ + 1]], 
            (ReplaceAll[
             Text[
              Style[
               Row[{
                 Subscript[
                  Style["x", Italic], "d"], " = ", 
                 NumberForm[
                  $CellContext`xr$[0], 2]}], 17, 
               RGBColor[1, 0.4, 0], Background -> White], {
               If[# > $CellContext`test, 1, #], 0.05}, {
               If[# > $CellContext`test, 1, 0], 0}], $CellContext`test -> 
             If[$CellContext`window$$, 0.86, 0.94]]& )[
             $CellContext`xr$[0]], 
            Text[
             Style["R", 18, Italic, Background -> White], {
              $CellContext`xs$[$CellContext`imax$ + 1], 
              $CellContext`ys$[$CellContext`imax$]}, {0, -1}], 
            Text[
             Style[
              Row[{
                Subscript[
                 Style["z", Italic], "f"], " = 0.5"}], 17, Blue, Background -> 
              White], {0.5, 0.15}]}]; $CellContext`plot$ = 
         If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
           
           Show[$CellContext`xybase$, $CellContext`xyadd$], \
$CellContext`xybase$]; $CellContext`mouse$ = Graphics[{
            Apply[Mouseover[{
               Thickness[0.02], Transparent, 
               Line[
                Table[#, 
                 Evaluate[
                  Flatten[{$CellContext`x, #2, 0.05}]]]]}, 
              Text[
               Framed[
                Style[#3, 18, #4], Background -> LightYellow], {0.15, 
               0.9}]]& , {{{$CellContext`x, $CellContext`x}, {0, 1}, 
               Row[{
                 Style["x", Italic], " = ", 
                 Style["y", Italic], " line"}], 
               RGBColor[0, 0.6, 0]}, {{$CellContext`x, 
                $CellContext`equilb$[$CellContext`x]}, {0, 1}, 
               "equilibrium curve", Red}, {{$CellContext`x, 
                $CellContext`feed$[$CellContext`x]}, {
                
                If[$CellContext`cond$, $CellContext`xpinch$, \
$CellContext`xinters$], $CellContext`zf$}, 
               Row[{
                 Style["q", Italic], "-line"}], Blue}, {{$CellContext`x, 
                If[$CellContext`cond$, 
                 $CellContext`opertRect$[$CellContext`x], 
                 $CellContext`OpRect$[$CellContext`x]]}, {
                
                If[$CellContext`cond$, $CellContext`xpinch$, \
$CellContext`xinters$], $CellContext`xd$$}, "rectifying section", 
               RGBColor[1, 0.4, 0]}, {{$CellContext`x, 
                If[$CellContext`cond$, 
                 $CellContext`opertStrp$[$CellContext`x], 
                 $CellContext`OpStrp$[$CellContext`x]]}, {$CellContext`xb$$, 
                
                If[$CellContext`cond$, $CellContext`xpinch$, \
$CellContext`xinters$]}, "stripping section", 
               Hue[0.9]}}, {1}], 
            Apply[Mouseover[{
               Thickness[0.02], Transparent, #}, 
              Text[
               Framed[
                Style[#2, 18], Background -> LightYellow], {0.15, 
               0.9}]]& , {{{$CellContext`tbl1$, $CellContext`tbl2$, \
$CellContext`tblih$, $CellContext`tbliv$, 
                
                If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], {$CellContext`tbl3$, \
$CellContext`tbl4$}]}, "equilibrium stages"}, {
               Line[{{
                  $CellContext`xs$[$CellContext`imax$ + 1], 
                  $CellContext`ys$[$CellContext`imax$]}, {
                  $CellContext`xs$[$CellContext`imax$ + 1], 0}}], "bottoms"}, {
               Line[{{
                  $CellContext`xr$[0], 
                  $CellContext`yr$[0]}, {
                  $CellContext`xr$[0], 0}}], "distillate"}, {
               Line[{{0.5, 0.5}, {0.5, 0}}], "feed"}}, {
             1}]}]; $CellContext`diagram$ = Graphics[{{
             EdgeForm[Thick], 
             FaceForm[None], 
             Rectangle[{0, 0}, {1, 3}], 
             Disk[{0.75, -0.5}, 1.1 {0.25, 0.15}], 
             Disk[{1.75, 2.8}, 1.1 {0.25, 0.15}]}, {Thick, 
             Arrowheads[0.07], 
             Arrow[{{0.5, -0.5}, {0.25, -0.5}, {0.25, 0}}], 
             Arrow[{{0.75, 0}, {0.75, -0.32}}], {
              Hue[0.9], 
              Arrow[{{1.05, -0.5}, {3, -0.5}}]}, 
             Arrow[{{0.25, 3}, {0.25, 3.4}, {1.75, 3.4}, {1.75, 2.95}}], 
             Arrow[{{1.5, 2.8}, {1, 2.8}}], {
              RGBColor[1, 0.4, 0], 
              Arrow[{{2.05, 2.8}, {3, 2.8}}]}, 
             
             If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], {{Blue, 
                
                Arrow[{{-1.5, 
                   3 ((2 $CellContext`imax$ + 1)/(2 $CellContext`it$))}, {
                  0, 3 ((2 $CellContext`imax$ + 1)/(2 $CellContext`it$))}}]}, 
               Map[{
                 Text[
                  Style[#, 17], {0.5, 3 (#/$CellContext`it$)}, {0, -1.1}], 
                 
                 Line[{{0, 3 (#/$CellContext`it$)}, {
                   1, 3 (#/$CellContext`it$)}}]}& , 
                Range[$CellContext`it$ - 1]]}, 
              Arrow[{{-1.5, 1.5}, {0, 1.5}}]]}, 
            Apply[Text[
              Style[#, 17, Italic], #2]& , {{"R", {0.75, -0.5}}, {
              "C", {1.75, 2.8}}}, {1}], 
            Text[
             Style[
              Column[{"feed rate", "1.00 kmol/h", 
                Spacer[1], 
                Row[{
                  Subscript[
                   Style["z", Italic], "f"], " = 0.5"}], "quality = 0.5"}, 
               Center], 17, Blue], {-0.85, 
              
              If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
               3 ((2 $CellContext`imax$ + 1)/(2 $CellContext`it$)), 1.5]}, {
             0, 0.05}], 
            Text[
             Style[
              Column[{"reflux ratio", 
                Row[{
                  Style["L", Italic], "/", 
                  Style["D", Italic], " = ", 
                  NumberForm[$CellContext`R$, {3, 2}]}]}, Center], 17], {1.95,
              2.17}], 
            Text[
             Style[
              Column[{
                Column[{"distillate flow", 
                  
                  If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
                   Row[{
                    NumberForm[$CellContext`distflow$, {2, 2}], " kmol/h"}], 
                   "N/A"]}, Center], 
                Row[{
                  Subscript[
                   Style["x", Italic], "d"], " = ", 
                  $CellContext`xr$[0]}]}, Center, Spacings -> 1], 17, 
              RGBColor[1, 0.4, 0]], {2.8, 2.91}], 
            Text[
             Style[
              Column[{
                Column[{"bottoms flow", 
                  
                  If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
                   Row[{
                    NumberForm[$CellContext`botflow$, {2, 2}], " kmol/h"}], 
                   "N/A"]}, Center], 
                Row[{
                  Subscript[
                   Style["x", Italic], "b"], " = ", 
                  NumberForm[
                   $CellContext`xs$[$CellContext`imax$ + 1], 2]}]}, Center, 
               Spacings -> 1], 17, 
              Hue[0.9]], {2.8, -0.39}]}, ImageSize -> 0.95 {290, 375}, 
           AspectRatio -> Full]; Switch[$CellContext`window$$, True, 
          Grid[{{
             Text[
              Style[
               
               If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
                
                Row[{"equilibrium stages needed = ", $CellContext`it$, 
                  " (including reboiler)"}], 
                "equilibrium stages needed = infinite (pinch point)"], 17]], 
             SpanFromLeft}, {
             
             Show[$CellContext`plot$, ImageSize -> 
              0.95 {310, 375}], $CellContext`diagram$}}], False, 
          Grid[{{
             Text[
              Style[
               
               If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
                
                Row[{"equilibrium stages needed = ", $CellContext`it$, 
                  " (including reboiler)"}], 
                "equilibrium stages needed = infinite (pinch point)"], 17]], 
             SpanFromLeft}, {
             
             Show[$CellContext`plot$, $CellContext`mouse$, ImageSize -> 
              0.95 {596, 375}]}}]]], 
      "Specifications" :> {{{$CellContext`lvmult$$, 3, 
          Row[{"external reflux ratio ", 
            Style["L", Italic], "/", 
            Style["D", Italic]}]}, 0.25, 10, 0.25, Appearance -> "Labeled", 
         ControlPlacement -> 
         1}, {{$CellContext`window$$, False, "view process flow diagram"}, {
         True, False}, ControlPlacement -> 2}, {{$CellContext`xd$$, 0.85, 
          Row[{"distillate ", 
            Subscript[
             Style["x", Italic], "d"]}]}, 0.8, 0.98, 0.01, Appearance -> 
         "Labeled", ImageSize -> Small, ControlPlacement -> 
         3}, {{$CellContext`xb$$, 0.15, 
          Row[{"desired bottoms ", 
            Subscript[
             Style["x", Italic], "b"]}]}, 0.05, 0.2, 0.01, Appearance -> 
         "Labeled", ImageSize -> Small, ControlPlacement -> 
         4}, {{$CellContext`pt$$, {0.39999999999999997`, 1.026}}, Automatic, 
         ControlType -> Locator, Appearance -> None, AutoAction -> True, 
         ControlPlacement -> 5}, 
        Grid[{{
           Manipulate`Place[1], SpanFromLeft, SpanFromLeft, 
           Manipulate`Place[2]}, {
           Style["mole fractions:", Bold], 
           Manipulate`Place[3], 
           Manipulate`Place[4], SpanFromLeft, 
           Manipulate`Place[5]}}, Alignment -> Left]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{633., {248., 255.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->164622179],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`lvmult$$ = 1.5, $CellContext`pt$$ = {0.8885,
     0.686}, $CellContext`window$$ = True, $CellContext`xb$$ = 
    0.1, $CellContext`xd$$ = 0.92, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lvmult$$], 1.5, 
       Row[{"external reflux ratio ", 
         Style["L", Italic], "/", 
         Style["D", Italic]}]}, 0.25, 10, 0.25}, {{
       Hold[$CellContext`window$$], True, "view process flow diagram"}, {
      True, False}}, {{
       Hold[$CellContext`xd$$], 0.92, 
       Row[{"distillate ", 
         Subscript[
          Style["x", Italic], "d"]}]}, 0.8, 0.98, 0.01}, {{
       Hold[$CellContext`xb$$], 0.1, 
       Row[{"desired bottoms ", 
         Subscript[
          Style["x", Italic], "b"]}]}, 0.05, 0.2, 0.01}, {{
       Hold[$CellContext`pt$$], {0.8885, 0.686}}, Automatic}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], SpanFromLeft, SpanFromLeft, 
          Manipulate`Place[2]}, {
          Style["mole fractions:", Bold], 
          Manipulate`Place[3], 
          Manipulate`Place[4], SpanFromLeft, 
          Manipulate`Place[5]}}, Alignment -> Left]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    579., {186.5, 193.5}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lvmult$3997$$ = 
    0, $CellContext`window$3998$$ = False, $CellContext`xd$3999$$ = 
    0, $CellContext`xb$4000$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`lvmult$$ = 
        1.5, $CellContext`pt$$ = {0.8885, 0.686}, $CellContext`window$$ = 
        True, $CellContext`xb$$ = 0.1, $CellContext`xd$$ = 0.92}, 
      "ControllerVariables" :> {
        Hold[$CellContext`lvmult$$, $CellContext`lvmult$3997$$, 0], 
        Hold[$CellContext`window$$, $CellContext`window$3998$$, False], 
        Hold[$CellContext`xd$$, $CellContext`xd$3999$$, 0], 
        Hold[$CellContext`xb$$, $CellContext`xb$4000$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`cond$, $CellContext`zf$, $CellContext`q$, \
$CellContext`P$, $CellContext`Psat1$, $CellContext`Psat2$, $CellContext`A12$, \
$CellContext`A21$, $CellContext`\[Gamma]1$, $CellContext`\[Gamma]2$, \
$CellContext`i$, $CellContext`x1$, $CellContext`T$, $CellContext`y1$, \
$CellContext`equilb$, $CellContext`feed$, $CellContext`xpinch$, \
$CellContext`ypinch$, $CellContext`opertRect$, $CellContext`opertStrp$, \
$CellContext`Rmin$, $CellContext`R$, $CellContext`OpRect$, \
$CellContext`xinters$, $CellContext`yinters$, $CellContext`OpStrp$, \
$CellContext`yr$, $CellContext`xr$, $CellContext`v$, $CellContext`t$, \
$CellContext`ir$, $CellContext`ys$, $CellContext`xs$, $CellContext`imax$, \
$CellContext`tbl1$, $CellContext`tbl2$, $CellContext`tbl3$, \
$CellContext`tbl4$, $CellContext`tblih$, $CellContext`tbliv$, \
$CellContext`it$, $CellContext`distflow$, $CellContext`botflow$, \
$CellContext`xybase$, $CellContext`xyadd$, $CellContext`plot$, \
$CellContext`mouse$, $CellContext`diagram$}, $CellContext`cond$ = \
$CellContext`yinters$ >= $CellContext`equilb$[$CellContext`xinters$]; \
$CellContext`zf$ = 0.5; $CellContext`q$ = 0.5; $CellContext`P$ = 
         760; $CellContext`Psat1$[
           Pattern[$CellContext`temp, 
            Blank[]]] := 
         10^(8.08097 - 1582.271/(
           239.726 + $CellContext`temp)); $CellContext`Psat2$[
           Pattern[$CellContext`temp, 
            Blank[]]] := 
         10^(8.07131 - 1730.63/(
           233.426 + $CellContext`temp)); $CellContext`A12$ = 
         0.7923; $CellContext`A21$ = 0.5434; $CellContext`\[Gamma]1$[
           Pattern[$CellContext`i$, 
            Blank[]]] := 
         Exp[(1 - $CellContext`x1$[$CellContext`i$])^2 ($CellContext`A12$ + (
              2 ($CellContext`A21$ - $CellContext`A12$)) \
$CellContext`x1$[$CellContext`i$])]; $CellContext`\[Gamma]2$[
           Pattern[$CellContext`i$, 
            Blank[]]] := 
         Exp[$CellContext`x1$[$CellContext`i$]^2 ($CellContext`A21$ + (
              2 ($CellContext`A12$ - $CellContext`A21$)) (
              1 - $CellContext`x1$[$CellContext`i$]))]; $CellContext`i$ = 0; 
        While[$CellContext`i$ < 
          101, {$CellContext`x1$[$CellContext`i$] = 
           0.01 $CellContext`i$, $CellContext`T$[$CellContext`i$] = 
           ReplaceAll[$CellContext`temp, 
             Quiet[
              
              FindRoot[$CellContext`P$ == ($CellContext`x1$[$CellContext`i$] \
$CellContext`\[Gamma]1$[$CellContext`i$]) \
$CellContext`Psat1$[$CellContext`temp] + ((
                   1 - $CellContext`x1$[$CellContext`i$]) $CellContext`\
\[Gamma]2$[$CellContext`i$]) $CellContext`Psat2$[$CellContext`temp], \
{$CellContext`temp, 
                60}]]], $CellContext`y1$[$CellContext`i$] = \
($CellContext`x1$[$CellContext`i$] $CellContext`\[Gamma]1$[$CellContext`i$]) \
($CellContext`Psat1$[
               $CellContext`T$[$CellContext`i$]]/$CellContext`P$), 
           Increment[$CellContext`i$]}]; $CellContext`equilb$ = Interpolation[
           Table[{
             $CellContext`x1$[$CellContext`i$], 
             $CellContext`y1$[$CellContext`i$]}, {$CellContext`i$, 0, 
             100}]]; $CellContext`feed$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         If[$CellContext`q$ != 
           1, $CellContext`q$ ($CellContext`x$/($CellContext`q$ - 
             1)) - $CellContext`zf$/($CellContext`q$ - 1), 
           1000000 ($CellContext`x$ - $CellContext`zf$) + $CellContext`zf$]; \
$CellContext`xpinch$ = ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`feed$[$CellContext`x] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
              0.5}]]]; $CellContext`ypinch$ = \
$CellContext`feed$[$CellContext`xpinch$]; $CellContext`opertRect$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`ypinch$ + (($CellContext`x$ - \
$CellContext`xpinch$)/($CellContext`xd$$ - $CellContext`xpinch$)) \
($CellContext`xd$$ - $CellContext`ypinch$); $CellContext`opertStrp$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`ypinch$ + (($CellContext`x$ - \
$CellContext`xpinch$)/($CellContext`xb$$ - $CellContext`xpinch$)) \
($CellContext`xb$$ - $CellContext`ypinch$); $CellContext`Rmin$ = \
(($CellContext`xd$$ - $CellContext`ypinch$)/($CellContext`xd$$ - \
$CellContext`xpinch$))/(
          1 - ($CellContext`xd$$ - $CellContext`ypinch$)/($CellContext`xd$$ - \
$CellContext`xpinch$)); $CellContext`R$ = $CellContext`lvmult$$; \
$CellContext`OpRect$[
           Pattern[$CellContext`x$, 
            Blank[]]] := ($CellContext`R$/($CellContext`R$ + 
            1)) $CellContext`x$ + $CellContext`xd$$/($CellContext`R$ + 
           1); $CellContext`xinters$ = ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`feed$[$CellContext`x] == \
$CellContext`OpRect$[$CellContext`x], {$CellContext`x, 
              0.7}]]]; $CellContext`yinters$ = \
$CellContext`OpRect$[$CellContext`xinters$]; 
        If[$CellContext`cond$, {$CellContext`OpStrp$[
              Pattern[$CellContext`x$, 
               
               Blank[]]] := $CellContext`opertStrp$[$CellContext`x$]; \
$CellContext`yr$[0] = $CellContext`xd$$; $CellContext`xr$[
             0] = $CellContext`xd$$; $CellContext`i$ = 0; 
           While[$CellContext`i$ < 
             25, {$CellContext`v$ = ReplaceAll[$CellContext`u, 
                Quiet[
                 
                 FindRoot[$CellContext`yr$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`u], {$CellContext`u, 
                   0.5}]]], $CellContext`t$ = \
$CellContext`opertRect$[$CellContext`v$], 
              
              If[$CellContext`v$ > $CellContext`xpinch$, \
{$CellContext`xr$[$CellContext`i$ + 
                  1] = $CellContext`v$, $CellContext`yr$[$CellContext`i$ + 
                  1] = $CellContext`t$}], 
              
              Increment[$CellContext`i$]}]; $CellContext`ir$ = \
$CellContext`i$ - 1; 
           If[$CellContext`ir$ >= 
             0, {$CellContext`ys$[
                0] = $CellContext`yr$[$CellContext`ir$]; $CellContext`xs$[
                0] = $CellContext`xr$[$CellContext`ir$]}]; $CellContext`i$ = 
            0; While[$CellContext`i$ < 
             20, {$CellContext`v$ = ReplaceAll[$CellContext`u, 
                Quiet[
                 
                 FindRoot[$CellContext`ys$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`u], {$CellContext`u, 
                   0.5}]]], $CellContext`t$ = \
$CellContext`opertStrp$[$CellContext`v$], $CellContext`xs$[$CellContext`i$ + 
                1] = $CellContext`v$, $CellContext`ys$[$CellContext`i$ + 
                1] = $CellContext`t$, 
              Increment[$CellContext`i$]}]; Null}, {$CellContext`OpStrp$[
              Pattern[$CellContext`x$, 
               
               Blank[]]] := $CellContext`yinters$ + (($CellContext`x$ - \
$CellContext`xinters$)/($CellContext`xb$$ - $CellContext`xinters$)) \
($CellContext`xb$$ - $CellContext`yinters$); $CellContext`yr$[
             0] = $CellContext`xd$$; $CellContext`xr$[
             0] = $CellContext`xd$$; $CellContext`i$ = 0; 
           While[$CellContext`xr$[$CellContext`i$] > $CellContext`xinters$, \
{$CellContext`v$ = ReplaceAll[$CellContext`u, 
                Quiet[
                 
                 FindRoot[$CellContext`yr$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`u], {$CellContext`u, 
                   0.7}]]], $CellContext`t$ = \
$CellContext`OpRect$[$CellContext`v$], 
              
              If[$CellContext`v$ > $CellContext`xinters$, \
{$CellContext`xr$[$CellContext`i$ + 
                  1] = $CellContext`v$, $CellContext`yr$[$CellContext`i$ + 
                  1] = $CellContext`t$}], 
              
              Increment[$CellContext`i$]}]; $CellContext`ir$ = \
$CellContext`i$ - 1; $CellContext`i$ = 0; 
           If[$CellContext`ir$ >= 
             0, $CellContext`ys$[
               0] = $CellContext`yr$[$CellContext`ir$]; $CellContext`xs$[
               0] = $CellContext`xr$[$CellContext`ir$]]; 
           While[$CellContext`xs$[$CellContext`i$] > $CellContext`xb$$, \
{$CellContext`v$ = ReplaceAll[$CellContext`u, 
                Quiet[
                 
                 FindRoot[$CellContext`ys$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`u], {$CellContext`u, 
                   0.5}]]], $CellContext`t$ = \
$CellContext`OpStrp$[$CellContext`v$], $CellContext`xs$[$CellContext`i$ + 
                1] = $CellContext`v$, $CellContext`ys$[$CellContext`i$ + 
                1] = $CellContext`t$, 
              Increment[$CellContext`i$]}]; 
           Null}]; $CellContext`imax$ = $CellContext`i$ - 
          1; $CellContext`tbl1$ = Table[
           Line[{{
              $CellContext`xr$[$CellContext`i$], 
              $CellContext`yr$[$CellContext`i$ - 1]}, {
              $CellContext`xr$[$CellContext`i$], 
              $CellContext`yr$[$CellContext`i$]}}], {$CellContext`i$, 
            1, $CellContext`ir$}]; $CellContext`tbl2$ = 
         If[$CellContext`ir$ >= 1, 
           Table[
            Line[{{
               $CellContext`xr$[$CellContext`i$], 
               $CellContext`yr$[$CellContext`i$]}, {
               $CellContext`xr$[$CellContext`i$ + 1], 
               $CellContext`yr$[$CellContext`i$]}}], {$CellContext`i$, 
             0, $CellContext`ir$ - 1}], 
           Table[
            Line[{{
               $CellContext`xr$[$CellContext`i$], 
               $CellContext`yr$[$CellContext`i$]}, {
               $CellContext`xr$[$CellContext`i$ + 1], 
               $CellContext`yr$[$CellContext`i$]}}], {$CellContext`i$, 0, 
             0}]]; $CellContext`tbl3$ = Table[
           Line[{{
              $CellContext`xs$[$CellContext`i$ + 1], 
              $CellContext`ys$[$CellContext`i$]}, {
              $CellContext`xs$[$CellContext`i$ + 1], 
              $CellContext`ys$[$CellContext`i$ + 1]}}], {$CellContext`i$, 
            0, $CellContext`imax$ - 1}]; $CellContext`tbl4$ = Table[
           Line[{{
              $CellContext`xs$[$CellContext`i$ - 1], 
              $CellContext`ys$[$CellContext`i$ - 1]}, {
              $CellContext`xs$[$CellContext`i$], 
              $CellContext`ys$[$CellContext`i$ - 1]}}], {$CellContext`i$, 
            1, $CellContext`imax$ + 1}]; $CellContext`tblih$ = Line[{{
             $CellContext`xs$[1], 
             $CellContext`ys$[0]}, {
             $CellContext`xr$[$CellContext`ir$], 
             $CellContext`ys$[0]}}]; $CellContext`tbliv$ = Line[{{
             $CellContext`xs$[1], 
             $CellContext`ys$[0]}, {
             $CellContext`xs$[1], 
             $CellContext`ys$[
             1]}}]; $CellContext`it$ = $CellContext`imax$ + $CellContext`ir$ + 
          1; $CellContext`distflow$ = ($CellContext`zf$ - \
$CellContext`xs$[$CellContext`imax$ + 
            1])/$CellContext`xd$$; $CellContext`botflow$ = 
         1 - $CellContext`distflow$; $CellContext`xybase$ = Show[
           Plot[{
             $CellContext`equilb$[$CellContext`x], $CellContext`x}, \
{$CellContext`x, 0, 1}, PlotStyle -> {{Thick, Red}, {Thick, 
               RGBColor[0, 0.6, 0]}}, PlotRange -> {{0, 1}, {0, 1}}], 
           If[$CellContext`cond$, {
             Plot[
              $CellContext`feed$[$CellContext`x], {$CellContext`x, \
$CellContext`xpinch$, $CellContext`zf$}, PlotStyle -> {Thick, Blue}], 
             Plot[
              $CellContext`opertRect$[$CellContext`x], {$CellContext`x, \
$CellContext`xpinch$, $CellContext`xd$$}, PlotStyle -> {Thick, 
                RGBColor[1, 0.4, 0]}], 
             Plot[
              $CellContext`opertStrp$[$CellContext`x], {$CellContext`x, \
$CellContext`xb$$, $CellContext`xpinch$}, PlotStyle -> {Thick, 
                Hue[0.9]}]}, {
             Plot[
              $CellContext`feed$[$CellContext`x], {$CellContext`x, \
$CellContext`xinters$, $CellContext`zf$}, PlotStyle -> {Thick, Blue}], 
             Plot[
              $CellContext`OpRect$[$CellContext`x], {$CellContext`x, \
$CellContext`xinters$, $CellContext`xd$$}, PlotStyle -> {Thick, 
                RGBColor[1, 0.4, 0]}], 
             Plot[
              $CellContext`OpStrp$[$CellContext`x], {$CellContext`x, \
$CellContext`xb$$, $CellContext`xinters$}, PlotStyle -> {Thick, 
                Hue[0.9]}]}], 
           
           Graphics[{
            Thick, $CellContext`tbl1$, $CellContext`tbl2$, \
$CellContext`tblih$, $CellContext`tbliv$}], Frame -> True, FrameLabel -> {
             Row[{"liquid mole fraction ", 
               Subscript[
                Style["x", Italic], "meth"]}], 
             Row[{"vapor mole fraction ", 
               Subscript[
                Style["y", Italic], "meth"]}]}, LabelStyle -> {17, Black}, 
           AspectRatio -> Full, PlotRangePadding -> {0.02, {None, 0.05}}, 
           ImagePadding -> {{55, 10}, {50, 10}}]; $CellContext`xyadd$ = 
         Graphics[{{Thick, $CellContext`tbl3$, $CellContext`tbl4$}, 
            Table[
             Text[
              
              Style[$CellContext`ir$ + 
               1 + $CellContext`imax$ - $CellContext`f, 18], {
               $CellContext`xr$[$CellContext`f], 
               $CellContext`yr$[$CellContext`f - 1]}, {
              1, -1}], {$CellContext`f, 1, $CellContext`ir$}], 
            Table[
             Text[
              Style[$CellContext`imax$ + 1 - $CellContext`f, 18], {
               $CellContext`xs$[$CellContext`f], 
               $CellContext`ys$[$CellContext`f - 1]}, {
              1, -1}], {$CellContext`f, 1, $CellContext`imax$}], {Dashed, 
             Line[{{
                $CellContext`xs$[$CellContext`imax$ + 1], 
                $CellContext`ys$[$CellContext`imax$]}, {
                $CellContext`xs$[$CellContext`imax$ + 1], 0}}], 
             Line[{{
                $CellContext`xr$[0], 
                $CellContext`yr$[0]}, {
                $CellContext`xr$[0], 0}}], 
             Line[{{0.5, 0.5}, {0.5, 0}}]}, 
            (ReplaceAll[
             Text[
              Style[
               Row[{
                 Subscript[
                  Style["x", Italic], "b"], " = ", 
                 NumberForm[
                  $CellContext`xs$[$CellContext`imax$ + 1], 2]}], 17, 
               Hue[0.9], Background -> White], {
               If[# < $CellContext`test, 0, #], 0.05}, {
               If[# < $CellContext`test, -1, 0], 0}], $CellContext`test -> 
             If[$CellContext`window$$, 0.15, 0.06]]& )[
             $CellContext`xs$[$CellContext`imax$ + 1]], 
            (ReplaceAll[
             Text[
              Style[
               Row[{
                 Subscript[
                  Style["x", Italic], "d"], " = ", 
                 NumberForm[
                  $CellContext`xr$[0], 2]}], 17, 
               RGBColor[1, 0.4, 0], Background -> White], {
               If[# > $CellContext`test, 1, #], 0.05}, {
               If[# > $CellContext`test, 1, 0], 0}], $CellContext`test -> 
             If[$CellContext`window$$, 0.86, 0.94]]& )[
             $CellContext`xr$[0]], 
            Text[
             Style["R", 18, Italic, Background -> White], {
              $CellContext`xs$[$CellContext`imax$ + 1], 
              $CellContext`ys$[$CellContext`imax$]}, {0, -1}], 
            Text[
             Style[
              Row[{
                Subscript[
                 Style["z", Italic], "f"], " = 0.5"}], 17, Blue, Background -> 
              White], {0.5, 0.15}]}]; $CellContext`plot$ = 
         If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
           
           Show[$CellContext`xybase$, $CellContext`xyadd$], \
$CellContext`xybase$]; $CellContext`mouse$ = Graphics[{
            Apply[Mouseover[{
               Thickness[0.02], Transparent, 
               Line[
                Table[#, 
                 Evaluate[
                  Flatten[{$CellContext`x, #2, 0.05}]]]]}, 
              Text[
               Framed[
                Style[#3, 18, #4], Background -> LightYellow], {0.15, 
               0.9}]]& , {{{$CellContext`x, $CellContext`x}, {0, 1}, 
               Row[{
                 Style["x", Italic], " = ", 
                 Style["y", Italic], " line"}], 
               RGBColor[0, 0.6, 0]}, {{$CellContext`x, 
                $CellContext`equilb$[$CellContext`x]}, {0, 1}, 
               "equilibrium curve", Red}, {{$CellContext`x, 
                $CellContext`feed$[$CellContext`x]}, {
                
                If[$CellContext`cond$, $CellContext`xpinch$, \
$CellContext`xinters$], $CellContext`zf$}, 
               Row[{
                 Style["q", Italic], "-line"}], Blue}, {{$CellContext`x, 
                If[$CellContext`cond$, 
                 $CellContext`opertRect$[$CellContext`x], 
                 $CellContext`OpRect$[$CellContext`x]]}, {
                
                If[$CellContext`cond$, $CellContext`xpinch$, \
$CellContext`xinters$], $CellContext`xd$$}, "rectifying section", 
               RGBColor[1, 0.4, 0]}, {{$CellContext`x, 
                If[$CellContext`cond$, 
                 $CellContext`opertStrp$[$CellContext`x], 
                 $CellContext`OpStrp$[$CellContext`x]]}, {$CellContext`xb$$, 
                
                If[$CellContext`cond$, $CellContext`xpinch$, \
$CellContext`xinters$]}, "stripping section", 
               Hue[0.9]}}, {1}], 
            Apply[Mouseover[{
               Thickness[0.02], Transparent, #}, 
              Text[
               Framed[
                Style[#2, 18], Background -> LightYellow], {0.15, 
               0.9}]]& , {{{$CellContext`tbl1$, $CellContext`tbl2$, \
$CellContext`tblih$, $CellContext`tbliv$, 
                
                If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], {$CellContext`tbl3$, \
$CellContext`tbl4$}]}, "equilibrium stages"}, {
               Line[{{
                  $CellContext`xs$[$CellContext`imax$ + 1], 
                  $CellContext`ys$[$CellContext`imax$]}, {
                  $CellContext`xs$[$CellContext`imax$ + 1], 0}}], "bottoms"}, {
               Line[{{
                  $CellContext`xr$[0], 
                  $CellContext`yr$[0]}, {
                  $CellContext`xr$[0], 0}}], "distillate"}, {
               Line[{{0.5, 0.5}, {0.5, 0}}], "feed"}}, {
             1}]}]; $CellContext`diagram$ = Graphics[{{
             EdgeForm[Thick], 
             FaceForm[None], 
             Rectangle[{0, 0}, {1, 3}], 
             Disk[{0.75, -0.5}, 1.1 {0.25, 0.15}], 
             Disk[{1.75, 2.8}, 1.1 {0.25, 0.15}]}, {Thick, 
             Arrowheads[0.07], 
             Arrow[{{0.5, -0.5}, {0.25, -0.5}, {0.25, 0}}], 
             Arrow[{{0.75, 0}, {0.75, -0.32}}], {
              Hue[0.9], 
              Arrow[{{1.05, -0.5}, {3, -0.5}}]}, 
             Arrow[{{0.25, 3}, {0.25, 3.4}, {1.75, 3.4}, {1.75, 2.95}}], 
             Arrow[{{1.5, 2.8}, {1, 2.8}}], {
              RGBColor[1, 0.4, 0], 
              Arrow[{{2.05, 2.8}, {3, 2.8}}]}, 
             
             If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], {{Blue, 
                
                Arrow[{{-1.5, 
                   3 ((2 $CellContext`imax$ + 1)/(2 $CellContext`it$))}, {
                  0, 3 ((2 $CellContext`imax$ + 1)/(2 $CellContext`it$))}}]}, 
               Map[{
                 Text[
                  Style[#, 17], {0.5, 3 (#/$CellContext`it$)}, {0, -1.1}], 
                 
                 Line[{{0, 3 (#/$CellContext`it$)}, {
                   1, 3 (#/$CellContext`it$)}}]}& , 
                Range[$CellContext`it$ - 1]]}, 
              Arrow[{{-1.5, 1.5}, {0, 1.5}}]]}, 
            Apply[Text[
              Style[#, 17, Italic], #2]& , {{"R", {0.75, -0.5}}, {
              "C", {1.75, 2.8}}}, {1}], 
            Text[
             Style[
              Column[{"feed rate", "1.00 kmol/h", 
                Spacer[1], 
                Row[{
                  Subscript[
                   Style["z", Italic], "f"], " = 0.5"}], "quality = 0.5"}, 
               Center], 17, Blue], {-0.85, 
              
              If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
               3 ((2 $CellContext`imax$ + 1)/(2 $CellContext`it$)), 1.5]}, {
             0, 0.05}], 
            Text[
             Style[
              Column[{"reflux ratio", 
                Row[{
                  Style["L", Italic], "/", 
                  Style["D", Italic], " = ", 
                  NumberForm[$CellContext`R$, {3, 2}]}]}, Center], 17], {1.95,
              2.17}], 
            Text[
             Style[
              Column[{
                Column[{"distillate flow", 
                  
                  If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
                   Row[{
                    NumberForm[$CellContext`distflow$, {2, 2}], " kmol/h"}], 
                   "N/A"]}, Center], 
                Row[{
                  Subscript[
                   Style["x", Italic], "d"], " = ", 
                  $CellContext`xr$[0]}]}, Center, Spacings -> 1], 17, 
              RGBColor[1, 0.4, 0]], {2.8, 2.91}], 
            Text[
             Style[
              Column[{
                Column[{"bottoms flow", 
                  
                  If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
                   Row[{
                    NumberForm[$CellContext`botflow$, {2, 2}], " kmol/h"}], 
                   "N/A"]}, Center], 
                Row[{
                  Subscript[
                   Style["x", Italic], "b"], " = ", 
                  NumberForm[
                   $CellContext`xs$[$CellContext`imax$ + 1], 2]}]}, Center, 
               Spacings -> 1], 17, 
              Hue[0.9]], {2.8, -0.39}]}, ImageSize -> 0.95 {290, 375}, 
           AspectRatio -> Full]; Switch[$CellContext`window$$, True, 
          Grid[{{
             Text[
              Style[
               
               If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
                
                Row[{"equilibrium stages needed = ", $CellContext`it$, 
                  " (including reboiler)"}], 
                "equilibrium stages needed = infinite (pinch point)"], 17]], 
             SpanFromLeft}, {
             
             Show[$CellContext`plot$, ImageSize -> 
              0.95 {310, 375}], $CellContext`diagram$}}], False, 
          Grid[{{
             Text[
              Style[
               
               If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
                
                Row[{"equilibrium stages needed = ", $CellContext`it$, 
                  " (including reboiler)"}], 
                "equilibrium stages needed = infinite (pinch point)"], 17]], 
             SpanFromLeft}, {
             
             Show[$CellContext`plot$, $CellContext`mouse$, ImageSize -> 
              0.95 {596, 375}]}}]]], 
      "Specifications" :> {{{$CellContext`lvmult$$, 1.5, 
          Row[{"external reflux ratio ", 
            Style["L", Italic], "/", 
            Style["D", Italic]}]}, 0.25, 10, 0.25, Appearance -> "Labeled", 
         ControlPlacement -> 
         1}, {{$CellContext`window$$, True, "view process flow diagram"}, {
         True, False}, ControlPlacement -> 2}, {{$CellContext`xd$$, 0.92, 
          Row[{"distillate ", 
            Subscript[
             Style["x", Italic], "d"]}]}, 0.8, 0.98, 0.01, Appearance -> 
         "Labeled", ImageSize -> Small, ControlPlacement -> 
         3}, {{$CellContext`xb$$, 0.1, 
          Row[{"desired bottoms ", 
            Subscript[
             Style["x", Italic], "b"]}]}, 0.05, 0.2, 0.01, Appearance -> 
         "Labeled", ImageSize -> Small, ControlPlacement -> 
         4}, {{$CellContext`pt$$, {0.8885, 0.686}}, Automatic, ControlType -> 
         Locator, Appearance -> None, AutoAction -> True, ControlPlacement -> 
         5}, 
        Grid[{{
           Manipulate`Place[1], SpanFromLeft, SpanFromLeft, 
           Manipulate`Place[2]}, {
           Style["mole fractions:", Bold], 
           Manipulate`Place[3], 
           Manipulate`Place[4], SpanFromLeft, 
           Manipulate`Place[5]}}, Alignment -> Left]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{634., {248., 255.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->901985876],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`lvmult$$ = 0.25, $CellContext`pt$$ = {
    0.3855, 0.526}, $CellContext`window$$ = False, $CellContext`xb$$ = 
    0.2, $CellContext`xd$$ = 0.8, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lvmult$$], 0.25, 
       Row[{"external reflux ratio ", 
         Style["L", Italic], "/", 
         Style["D", Italic]}]}, 0.25, 10, 0.25}, {{
       Hold[$CellContext`window$$], False, "view process flow diagram"}, {
      True, False}}, {{
       Hold[$CellContext`xd$$], 0.8, 
       Row[{"distillate ", 
         Subscript[
          Style["x", Italic], "d"]}]}, 0.8, 0.98, 0.01}, {{
       Hold[$CellContext`xb$$], 0.2, 
       Row[{"desired bottoms ", 
         Subscript[
          Style["x", Italic], "b"]}]}, 0.05, 0.2, 0.01}, {{
       Hold[$CellContext`pt$$], {0.3855, 0.526}}, Automatic}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], SpanFromLeft, SpanFromLeft, 
          Manipulate`Place[2]}, {
          Style["mole fractions:", Bold], 
          Manipulate`Place[3], 
          Manipulate`Place[4], SpanFromLeft, 
          Manipulate`Place[5]}}, Alignment -> Left]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    578., {186.5, 193.5}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lvmult$4069$$ = 
    0, $CellContext`window$4070$$ = False, $CellContext`xd$4071$$ = 
    0, $CellContext`xb$4072$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`lvmult$$ = 
        0.25, $CellContext`pt$$ = {0.3855, 0.526}, $CellContext`window$$ = 
        False, $CellContext`xb$$ = 0.2, $CellContext`xd$$ = 0.8}, 
      "ControllerVariables" :> {
        Hold[$CellContext`lvmult$$, $CellContext`lvmult$4069$$, 0], 
        Hold[$CellContext`window$$, $CellContext`window$4070$$, False], 
        Hold[$CellContext`xd$$, $CellContext`xd$4071$$, 0], 
        Hold[$CellContext`xb$$, $CellContext`xb$4072$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`cond$, $CellContext`zf$, $CellContext`q$, \
$CellContext`P$, $CellContext`Psat1$, $CellContext`Psat2$, $CellContext`A12$, \
$CellContext`A21$, $CellContext`\[Gamma]1$, $CellContext`\[Gamma]2$, \
$CellContext`i$, $CellContext`x1$, $CellContext`T$, $CellContext`y1$, \
$CellContext`equilb$, $CellContext`feed$, $CellContext`xpinch$, \
$CellContext`ypinch$, $CellContext`opertRect$, $CellContext`opertStrp$, \
$CellContext`Rmin$, $CellContext`R$, $CellContext`OpRect$, \
$CellContext`xinters$, $CellContext`yinters$, $CellContext`OpStrp$, \
$CellContext`yr$, $CellContext`xr$, $CellContext`v$, $CellContext`t$, \
$CellContext`ir$, $CellContext`ys$, $CellContext`xs$, $CellContext`imax$, \
$CellContext`tbl1$, $CellContext`tbl2$, $CellContext`tbl3$, \
$CellContext`tbl4$, $CellContext`tblih$, $CellContext`tbliv$, \
$CellContext`it$, $CellContext`distflow$, $CellContext`botflow$, \
$CellContext`xybase$, $CellContext`xyadd$, $CellContext`plot$, \
$CellContext`mouse$, $CellContext`diagram$}, $CellContext`cond$ = \
$CellContext`yinters$ >= $CellContext`equilb$[$CellContext`xinters$]; \
$CellContext`zf$ = 0.5; $CellContext`q$ = 0.5; $CellContext`P$ = 
         760; $CellContext`Psat1$[
           Pattern[$CellContext`temp, 
            Blank[]]] := 
         10^(8.08097 - 1582.271/(
           239.726 + $CellContext`temp)); $CellContext`Psat2$[
           Pattern[$CellContext`temp, 
            Blank[]]] := 
         10^(8.07131 - 1730.63/(
           233.426 + $CellContext`temp)); $CellContext`A12$ = 
         0.7923; $CellContext`A21$ = 0.5434; $CellContext`\[Gamma]1$[
           Pattern[$CellContext`i$, 
            Blank[]]] := 
         Exp[(1 - $CellContext`x1$[$CellContext`i$])^2 ($CellContext`A12$ + (
              2 ($CellContext`A21$ - $CellContext`A12$)) \
$CellContext`x1$[$CellContext`i$])]; $CellContext`\[Gamma]2$[
           Pattern[$CellContext`i$, 
            Blank[]]] := 
         Exp[$CellContext`x1$[$CellContext`i$]^2 ($CellContext`A21$ + (
              2 ($CellContext`A12$ - $CellContext`A21$)) (
              1 - $CellContext`x1$[$CellContext`i$]))]; $CellContext`i$ = 0; 
        While[$CellContext`i$ < 
          101, {$CellContext`x1$[$CellContext`i$] = 
           0.01 $CellContext`i$, $CellContext`T$[$CellContext`i$] = 
           ReplaceAll[$CellContext`temp, 
             Quiet[
              
              FindRoot[$CellContext`P$ == ($CellContext`x1$[$CellContext`i$] \
$CellContext`\[Gamma]1$[$CellContext`i$]) \
$CellContext`Psat1$[$CellContext`temp] + ((
                   1 - $CellContext`x1$[$CellContext`i$]) $CellContext`\
\[Gamma]2$[$CellContext`i$]) $CellContext`Psat2$[$CellContext`temp], \
{$CellContext`temp, 
                60}]]], $CellContext`y1$[$CellContext`i$] = \
($CellContext`x1$[$CellContext`i$] $CellContext`\[Gamma]1$[$CellContext`i$]) \
($CellContext`Psat1$[
               $CellContext`T$[$CellContext`i$]]/$CellContext`P$), 
           Increment[$CellContext`i$]}]; $CellContext`equilb$ = Interpolation[
           Table[{
             $CellContext`x1$[$CellContext`i$], 
             $CellContext`y1$[$CellContext`i$]}, {$CellContext`i$, 0, 
             100}]]; $CellContext`feed$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         If[$CellContext`q$ != 
           1, $CellContext`q$ ($CellContext`x$/($CellContext`q$ - 
             1)) - $CellContext`zf$/($CellContext`q$ - 1), 
           1000000 ($CellContext`x$ - $CellContext`zf$) + $CellContext`zf$]; \
$CellContext`xpinch$ = ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`feed$[$CellContext`x] == \
$CellContext`equilb$[$CellContext`x], {$CellContext`x, 
              0.5}]]]; $CellContext`ypinch$ = \
$CellContext`feed$[$CellContext`xpinch$]; $CellContext`opertRect$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`ypinch$ + (($CellContext`x$ - \
$CellContext`xpinch$)/($CellContext`xd$$ - $CellContext`xpinch$)) \
($CellContext`xd$$ - $CellContext`ypinch$); $CellContext`opertStrp$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`ypinch$ + (($CellContext`x$ - \
$CellContext`xpinch$)/($CellContext`xb$$ - $CellContext`xpinch$)) \
($CellContext`xb$$ - $CellContext`ypinch$); $CellContext`Rmin$ = \
(($CellContext`xd$$ - $CellContext`ypinch$)/($CellContext`xd$$ - \
$CellContext`xpinch$))/(
          1 - ($CellContext`xd$$ - $CellContext`ypinch$)/($CellContext`xd$$ - \
$CellContext`xpinch$)); $CellContext`R$ = $CellContext`lvmult$$; \
$CellContext`OpRect$[
           Pattern[$CellContext`x$, 
            Blank[]]] := ($CellContext`R$/($CellContext`R$ + 
            1)) $CellContext`x$ + $CellContext`xd$$/($CellContext`R$ + 
           1); $CellContext`xinters$ = ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`feed$[$CellContext`x] == \
$CellContext`OpRect$[$CellContext`x], {$CellContext`x, 
              0.7}]]]; $CellContext`yinters$ = \
$CellContext`OpRect$[$CellContext`xinters$]; 
        If[$CellContext`cond$, {$CellContext`OpStrp$[
              Pattern[$CellContext`x$, 
               
               Blank[]]] := $CellContext`opertStrp$[$CellContext`x$]; \
$CellContext`yr$[0] = $CellContext`xd$$; $CellContext`xr$[
             0] = $CellContext`xd$$; $CellContext`i$ = 0; 
           While[$CellContext`i$ < 
             25, {$CellContext`v$ = ReplaceAll[$CellContext`u, 
                Quiet[
                 
                 FindRoot[$CellContext`yr$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`u], {$CellContext`u, 
                   0.5}]]], $CellContext`t$ = \
$CellContext`opertRect$[$CellContext`v$], 
              
              If[$CellContext`v$ > $CellContext`xpinch$, \
{$CellContext`xr$[$CellContext`i$ + 
                  1] = $CellContext`v$, $CellContext`yr$[$CellContext`i$ + 
                  1] = $CellContext`t$}], 
              
              Increment[$CellContext`i$]}]; $CellContext`ir$ = \
$CellContext`i$ - 1; 
           If[$CellContext`ir$ >= 
             0, {$CellContext`ys$[
                0] = $CellContext`yr$[$CellContext`ir$]; $CellContext`xs$[
                0] = $CellContext`xr$[$CellContext`ir$]}]; $CellContext`i$ = 
            0; While[$CellContext`i$ < 
             20, {$CellContext`v$ = ReplaceAll[$CellContext`u, 
                Quiet[
                 
                 FindRoot[$CellContext`ys$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`u], {$CellContext`u, 
                   0.5}]]], $CellContext`t$ = \
$CellContext`opertStrp$[$CellContext`v$], $CellContext`xs$[$CellContext`i$ + 
                1] = $CellContext`v$, $CellContext`ys$[$CellContext`i$ + 
                1] = $CellContext`t$, 
              Increment[$CellContext`i$]}]; Null}, {$CellContext`OpStrp$[
              Pattern[$CellContext`x$, 
               
               Blank[]]] := $CellContext`yinters$ + (($CellContext`x$ - \
$CellContext`xinters$)/($CellContext`xb$$ - $CellContext`xinters$)) \
($CellContext`xb$$ - $CellContext`yinters$); $CellContext`yr$[
             0] = $CellContext`xd$$; $CellContext`xr$[
             0] = $CellContext`xd$$; $CellContext`i$ = 0; 
           While[$CellContext`xr$[$CellContext`i$] > $CellContext`xinters$, \
{$CellContext`v$ = ReplaceAll[$CellContext`u, 
                Quiet[
                 
                 FindRoot[$CellContext`yr$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`u], {$CellContext`u, 
                   0.7}]]], $CellContext`t$ = \
$CellContext`OpRect$[$CellContext`v$], 
              
              If[$CellContext`v$ > $CellContext`xinters$, \
{$CellContext`xr$[$CellContext`i$ + 
                  1] = $CellContext`v$, $CellContext`yr$[$CellContext`i$ + 
                  1] = $CellContext`t$}], 
              
              Increment[$CellContext`i$]}]; $CellContext`ir$ = \
$CellContext`i$ - 1; $CellContext`i$ = 0; 
           If[$CellContext`ir$ >= 
             0, $CellContext`ys$[
               0] = $CellContext`yr$[$CellContext`ir$]; $CellContext`xs$[
               0] = $CellContext`xr$[$CellContext`ir$]]; 
           While[$CellContext`xs$[$CellContext`i$] > $CellContext`xb$$, \
{$CellContext`v$ = ReplaceAll[$CellContext`u, 
                Quiet[
                 
                 FindRoot[$CellContext`ys$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`u], {$CellContext`u, 
                   0.5}]]], $CellContext`t$ = \
$CellContext`OpStrp$[$CellContext`v$], $CellContext`xs$[$CellContext`i$ + 
                1] = $CellContext`v$, $CellContext`ys$[$CellContext`i$ + 
                1] = $CellContext`t$, 
              Increment[$CellContext`i$]}]; 
           Null}]; $CellContext`imax$ = $CellContext`i$ - 
          1; $CellContext`tbl1$ = Table[
           Line[{{
              $CellContext`xr$[$CellContext`i$], 
              $CellContext`yr$[$CellContext`i$ - 1]}, {
              $CellContext`xr$[$CellContext`i$], 
              $CellContext`yr$[$CellContext`i$]}}], {$CellContext`i$, 
            1, $CellContext`ir$}]; $CellContext`tbl2$ = 
         If[$CellContext`ir$ >= 1, 
           Table[
            Line[{{
               $CellContext`xr$[$CellContext`i$], 
               $CellContext`yr$[$CellContext`i$]}, {
               $CellContext`xr$[$CellContext`i$ + 1], 
               $CellContext`yr$[$CellContext`i$]}}], {$CellContext`i$, 
             0, $CellContext`ir$ - 1}], 
           Table[
            Line[{{
               $CellContext`xr$[$CellContext`i$], 
               $CellContext`yr$[$CellContext`i$]}, {
               $CellContext`xr$[$CellContext`i$ + 1], 
               $CellContext`yr$[$CellContext`i$]}}], {$CellContext`i$, 0, 
             0}]]; $CellContext`tbl3$ = Table[
           Line[{{
              $CellContext`xs$[$CellContext`i$ + 1], 
              $CellContext`ys$[$CellContext`i$]}, {
              $CellContext`xs$[$CellContext`i$ + 1], 
              $CellContext`ys$[$CellContext`i$ + 1]}}], {$CellContext`i$, 
            0, $CellContext`imax$ - 1}]; $CellContext`tbl4$ = Table[
           Line[{{
              $CellContext`xs$[$CellContext`i$ - 1], 
              $CellContext`ys$[$CellContext`i$ - 1]}, {
              $CellContext`xs$[$CellContext`i$], 
              $CellContext`ys$[$CellContext`i$ - 1]}}], {$CellContext`i$, 
            1, $CellContext`imax$ + 1}]; $CellContext`tblih$ = Line[{{
             $CellContext`xs$[1], 
             $CellContext`ys$[0]}, {
             $CellContext`xr$[$CellContext`ir$], 
             $CellContext`ys$[0]}}]; $CellContext`tbliv$ = Line[{{
             $CellContext`xs$[1], 
             $CellContext`ys$[0]}, {
             $CellContext`xs$[1], 
             $CellContext`ys$[
             1]}}]; $CellContext`it$ = $CellContext`imax$ + $CellContext`ir$ + 
          1; $CellContext`distflow$ = ($CellContext`zf$ - \
$CellContext`xs$[$CellContext`imax$ + 
            1])/$CellContext`xd$$; $CellContext`botflow$ = 
         1 - $CellContext`distflow$; $CellContext`xybase$ = Show[
           Plot[{
             $CellContext`equilb$[$CellContext`x], $CellContext`x}, \
{$CellContext`x, 0, 1}, PlotStyle -> {{Thick, Red}, {Thick, 
               RGBColor[0, 0.6, 0]}}, PlotRange -> {{0, 1}, {0, 1}}], 
           If[$CellContext`cond$, {
             Plot[
              $CellContext`feed$[$CellContext`x], {$CellContext`x, \
$CellContext`xpinch$, $CellContext`zf$}, PlotStyle -> {Thick, Blue}], 
             Plot[
              $CellContext`opertRect$[$CellContext`x], {$CellContext`x, \
$CellContext`xpinch$, $CellContext`xd$$}, PlotStyle -> {Thick, 
                RGBColor[1, 0.4, 0]}], 
             Plot[
              $CellContext`opertStrp$[$CellContext`x], {$CellContext`x, \
$CellContext`xb$$, $CellContext`xpinch$}, PlotStyle -> {Thick, 
                Hue[0.9]}]}, {
             Plot[
              $CellContext`feed$[$CellContext`x], {$CellContext`x, \
$CellContext`xinters$, $CellContext`zf$}, PlotStyle -> {Thick, Blue}], 
             Plot[
              $CellContext`OpRect$[$CellContext`x], {$CellContext`x, \
$CellContext`xinters$, $CellContext`xd$$}, PlotStyle -> {Thick, 
                RGBColor[1, 0.4, 0]}], 
             Plot[
              $CellContext`OpStrp$[$CellContext`x], {$CellContext`x, \
$CellContext`xb$$, $CellContext`xinters$}, PlotStyle -> {Thick, 
                Hue[0.9]}]}], 
           
           Graphics[{
            Thick, $CellContext`tbl1$, $CellContext`tbl2$, \
$CellContext`tblih$, $CellContext`tbliv$}], Frame -> True, FrameLabel -> {
             Row[{"liquid mole fraction ", 
               Subscript[
                Style["x", Italic], "meth"]}], 
             Row[{"vapor mole fraction ", 
               Subscript[
                Style["y", Italic], "meth"]}]}, LabelStyle -> {17, Black}, 
           AspectRatio -> Full, PlotRangePadding -> {0.02, {None, 0.05}}, 
           ImagePadding -> {{55, 10}, {50, 10}}]; $CellContext`xyadd$ = 
         Graphics[{{Thick, $CellContext`tbl3$, $CellContext`tbl4$}, 
            Table[
             Text[
              
              Style[$CellContext`ir$ + 
               1 + $CellContext`imax$ - $CellContext`f, 18], {
               $CellContext`xr$[$CellContext`f], 
               $CellContext`yr$[$CellContext`f - 1]}, {
              1, -1}], {$CellContext`f, 1, $CellContext`ir$}], 
            Table[
             Text[
              Style[$CellContext`imax$ + 1 - $CellContext`f, 18], {
               $CellContext`xs$[$CellContext`f], 
               $CellContext`ys$[$CellContext`f - 1]}, {
              1, -1}], {$CellContext`f, 1, $CellContext`imax$}], {Dashed, 
             Line[{{
                $CellContext`xs$[$CellContext`imax$ + 1], 
                $CellContext`ys$[$CellContext`imax$]}, {
                $CellContext`xs$[$CellContext`imax$ + 1], 0}}], 
             Line[{{
                $CellContext`xr$[0], 
                $CellContext`yr$[0]}, {
                $CellContext`xr$[0], 0}}], 
             Line[{{0.5, 0.5}, {0.5, 0}}]}, 
            (ReplaceAll[
             Text[
              Style[
               Row[{
                 Subscript[
                  Style["x", Italic], "b"], " = ", 
                 NumberForm[
                  $CellContext`xs$[$CellContext`imax$ + 1], 2]}], 17, 
               Hue[0.9], Background -> White], {
               If[# < $CellContext`test, 0, #], 0.05}, {
               If[# < $CellContext`test, -1, 0], 0}], $CellContext`test -> 
             If[$CellContext`window$$, 0.15, 0.06]]& )[
             $CellContext`xs$[$CellContext`imax$ + 1]], 
            (ReplaceAll[
             Text[
              Style[
               Row[{
                 Subscript[
                  Style["x", Italic], "d"], " = ", 
                 NumberForm[
                  $CellContext`xr$[0], 2]}], 17, 
               RGBColor[1, 0.4, 0], Background -> White], {
               If[# > $CellContext`test, 1, #], 0.05}, {
               If[# > $CellContext`test, 1, 0], 0}], $CellContext`test -> 
             If[$CellContext`window$$, 0.86, 0.94]]& )[
             $CellContext`xr$[0]], 
            Text[
             Style["R", 18, Italic, Background -> White], {
              $CellContext`xs$[$CellContext`imax$ + 1], 
              $CellContext`ys$[$CellContext`imax$]}, {0, -1}], 
            Text[
             Style[
              Row[{
                Subscript[
                 Style["z", Italic], "f"], " = 0.5"}], 17, Blue, Background -> 
              White], {0.5, 0.15}]}]; $CellContext`plot$ = 
         If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
           
           Show[$CellContext`xybase$, $CellContext`xyadd$], \
$CellContext`xybase$]; $CellContext`mouse$ = Graphics[{
            Apply[Mouseover[{
               Thickness[0.02], Transparent, 
               Line[
                Table[#, 
                 Evaluate[
                  Flatten[{$CellContext`x, #2, 0.05}]]]]}, 
              Text[
               Framed[
                Style[#3, 18, #4], Background -> LightYellow], {0.15, 
               0.9}]]& , {{{$CellContext`x, $CellContext`x}, {0, 1}, 
               Row[{
                 Style["x", Italic], " = ", 
                 Style["y", Italic], " line"}], 
               RGBColor[0, 0.6, 0]}, {{$CellContext`x, 
                $CellContext`equilb$[$CellContext`x]}, {0, 1}, 
               "equilibrium curve", Red}, {{$CellContext`x, 
                $CellContext`feed$[$CellContext`x]}, {
                
                If[$CellContext`cond$, $CellContext`xpinch$, \
$CellContext`xinters$], $CellContext`zf$}, 
               Row[{
                 Style["q", Italic], "-line"}], Blue}, {{$CellContext`x, 
                If[$CellContext`cond$, 
                 $CellContext`opertRect$[$CellContext`x], 
                 $CellContext`OpRect$[$CellContext`x]]}, {
                
                If[$CellContext`cond$, $CellContext`xpinch$, \
$CellContext`xinters$], $CellContext`xd$$}, "rectifying section", 
               RGBColor[1, 0.4, 0]}, {{$CellContext`x, 
                If[$CellContext`cond$, 
                 $CellContext`opertStrp$[$CellContext`x], 
                 $CellContext`OpStrp$[$CellContext`x]]}, {$CellContext`xb$$, 
                
                If[$CellContext`cond$, $CellContext`xpinch$, \
$CellContext`xinters$]}, "stripping section", 
               Hue[0.9]}}, {1}], 
            Apply[Mouseover[{
               Thickness[0.02], Transparent, #}, 
              Text[
               Framed[
                Style[#2, 18], Background -> LightYellow], {0.15, 
               0.9}]]& , {{{$CellContext`tbl1$, $CellContext`tbl2$, \
$CellContext`tblih$, $CellContext`tbliv$, 
                
                If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], {$CellContext`tbl3$, \
$CellContext`tbl4$}]}, "equilibrium stages"}, {
               Line[{{
                  $CellContext`xs$[$CellContext`imax$ + 1], 
                  $CellContext`ys$[$CellContext`imax$]}, {
                  $CellContext`xs$[$CellContext`imax$ + 1], 0}}], "bottoms"}, {
               Line[{{
                  $CellContext`xr$[0], 
                  $CellContext`yr$[0]}, {
                  $CellContext`xr$[0], 0}}], "distillate"}, {
               Line[{{0.5, 0.5}, {0.5, 0}}], "feed"}}, {
             1}]}]; $CellContext`diagram$ = Graphics[{{
             EdgeForm[Thick], 
             FaceForm[None], 
             Rectangle[{0, 0}, {1, 3}], 
             Disk[{0.75, -0.5}, 1.1 {0.25, 0.15}], 
             Disk[{1.75, 2.8}, 1.1 {0.25, 0.15}]}, {Thick, 
             Arrowheads[0.07], 
             Arrow[{{0.5, -0.5}, {0.25, -0.5}, {0.25, 0}}], 
             Arrow[{{0.75, 0}, {0.75, -0.32}}], {
              Hue[0.9], 
              Arrow[{{1.05, -0.5}, {3, -0.5}}]}, 
             Arrow[{{0.25, 3}, {0.25, 3.4}, {1.75, 3.4}, {1.75, 2.95}}], 
             Arrow[{{1.5, 2.8}, {1, 2.8}}], {
              RGBColor[1, 0.4, 0], 
              Arrow[{{2.05, 2.8}, {3, 2.8}}]}, 
             
             If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], {{Blue, 
                
                Arrow[{{-1.5, 
                   3 ((2 $CellContext`imax$ + 1)/(2 $CellContext`it$))}, {
                  0, 3 ((2 $CellContext`imax$ + 1)/(2 $CellContext`it$))}}]}, 
               Map[{
                 Text[
                  Style[#, 17], {0.5, 3 (#/$CellContext`it$)}, {0, -1.1}], 
                 
                 Line[{{0, 3 (#/$CellContext`it$)}, {
                   1, 3 (#/$CellContext`it$)}}]}& , 
                Range[$CellContext`it$ - 1]]}, 
              Arrow[{{-1.5, 1.5}, {0, 1.5}}]]}, 
            Apply[Text[
              Style[#, 17, Italic], #2]& , {{"R", {0.75, -0.5}}, {
              "C", {1.75, 2.8}}}, {1}], 
            Text[
             Style[
              Column[{"feed rate", "1.00 kmol/h", 
                Spacer[1], 
                Row[{
                  Subscript[
                   Style["z", Italic], "f"], " = 0.5"}], "quality = 0.5"}, 
               Center], 17, Blue], {-0.85, 
              
              If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
               3 ((2 $CellContext`imax$ + 1)/(2 $CellContext`it$)), 1.5]}, {
             0, 0.05}], 
            Text[
             Style[
              Column[{"reflux ratio", 
                Row[{
                  Style["L", Italic], "/", 
                  Style["D", Italic], " = ", 
                  NumberForm[$CellContext`R$, {3, 2}]}]}, Center], 17], {1.95,
              2.17}], 
            Text[
             Style[
              Column[{
                Column[{"distillate flow", 
                  
                  If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
                   Row[{
                    NumberForm[$CellContext`distflow$, {2, 2}], " kmol/h"}], 
                   "N/A"]}, Center], 
                Row[{
                  Subscript[
                   Style["x", Italic], "d"], " = ", 
                  $CellContext`xr$[0]}]}, Center, Spacings -> 1], 17, 
              RGBColor[1, 0.4, 0]], {2.8, 2.91}], 
            Text[
             Style[
              Column[{
                Column[{"bottoms flow", 
                  
                  If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
                   Row[{
                    NumberForm[$CellContext`botflow$, {2, 2}], " kmol/h"}], 
                   "N/A"]}, Center], 
                Row[{
                  Subscript[
                   Style["x", Italic], "b"], " = ", 
                  NumberForm[
                   $CellContext`xs$[$CellContext`imax$ + 1], 2]}]}, Center, 
               Spacings -> 1], 17, 
              Hue[0.9]], {2.8, -0.39}]}, ImageSize -> 0.95 {290, 375}, 
           AspectRatio -> Full]; Switch[$CellContext`window$$, True, 
          Grid[{{
             Text[
              Style[
               
               If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
                
                Row[{"equilibrium stages needed = ", $CellContext`it$, 
                  " (including reboiler)"}], 
                "equilibrium stages needed = infinite (pinch point)"], 17]], 
             SpanFromLeft}, {
             
             Show[$CellContext`plot$, ImageSize -> 
              0.95 {310, 375}], $CellContext`diagram$}}], False, 
          Grid[{{
             Text[
              Style[
               
               If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
                
                Row[{"equilibrium stages needed = ", $CellContext`it$, 
                  " (including reboiler)"}], 
                "equilibrium stages needed = infinite (pinch point)"], 17]], 
             SpanFromLeft}, {
             
             Show[$CellContext`plot$, $CellContext`mouse$, ImageSize -> 
              0.95 {596, 375}]}}]]], 
      "Specifications" :> {{{$CellContext`lvmult$$, 0.25, 
          Row[{"external reflux ratio ", 
            Style["L", Italic], "/", 
            Style["D", Italic]}]}, 0.25, 10, 0.25, Appearance -> "Labeled", 
         ControlPlacement -> 
         1}, {{$CellContext`window$$, False, "view process flow diagram"}, {
         True, False}, ControlPlacement -> 2}, {{$CellContext`xd$$, 0.8, 
          Row[{"distillate ", 
            Subscript[
             Style["x", Italic], "d"]}]}, 0.8, 0.98, 0.01, Appearance -> 
         "Labeled", ImageSize -> Small, ControlPlacement -> 
         3}, {{$CellContext`xb$$, 0.2, 
          Row[{"desired bottoms ", 
            Subscript[
             Style["x", Italic], "b"]}]}, 0.05, 0.2, 0.01, Appearance -> 
         "Labeled", ImageSize -> Small, ControlPlacement -> 
         4}, {{$CellContext`pt$$, {0.3855, 0.526}}, Automatic, ControlType -> 
         Locator, Appearance -> None, AutoAction -> True, ControlPlacement -> 
         5}, 
        Grid[{{
           Manipulate`Place[1], SpanFromLeft, SpanFromLeft, 
           Manipulate`Place[2]}, {
           Style["mole fractions:", Bold], 
           Manipulate`Place[3], 
           Manipulate`Place[4], SpanFromLeft, 
           Manipulate`Place[5]}}, Alignment -> Left]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{633., {248., 255.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->367986919]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "DetailsSection"],

Cell["\<\
The McCabe\[Dash]Thiele graphical solution method for binary distillation is \
used to determine the number of equilibrium stages needed to achieve a \
specified separation in a distillation column. This method assumes: \
\>", "DetailNotes",
 CellChangeTimes->{{3.6764836855195093`*^9, 3.676483686241996*^9}, {
   3.6764837229709883`*^9, 3.676483801144796*^9}, {3.676484208985889*^9, 
   3.676484292825663*^9}, {3.6764843498604507`*^9, 3.6764843504218388`*^9}, {
   3.679176590575749*^9, 3.679176597007991*^9}, {3.6796555622816963`*^9, 
   3.6796556032297564`*^9}, 3.6796556425293694`*^9, {3.6816551956197796`*^9, 
   3.6816552069514*^9}, {3.6826933175814285`*^9, 3.682693339472233*^9}, 
   3.684240336671339*^9, {3.684240375978819*^9, 3.684240377204012*^9}},
 CellID->1224384310],

Cell["1. The distillation column is adiabatic.", "DetailNotes",
 CellChangeTimes->{{3.6764836855195093`*^9, 3.676483686241996*^9}, {
  3.6764837229709883`*^9, 3.676483801144796*^9}, {3.676484208985889*^9, 
  3.676484295403784*^9}, {3.676484422381997*^9, 3.6764844523721724`*^9}, {
  3.679655607719017*^9, 3.6796556264626265`*^9}, {3.6826933476120467`*^9, 
  3.6826933483763857`*^9}, {3.684071917791325*^9, 3.684071922239135*^9}},
 CellID->2068001857],

Cell["\<\
2. Constant molar overflow (CMO), which means that for every mole of vapor \
condensed, one mole of liquid is vaporized. This results in constant liquid \
and vapor flow rates between stages (the exception being the flow rates of \
the stages above and below the feed stream, which are not equal). This \
assumption requires that:\
\>", "DetailNotes",
 CellChangeTimes->{{3.6764836855195093`*^9, 3.676483686241996*^9}, {
   3.6764837229709883`*^9, 3.676483801144796*^9}, {3.676484208985889*^9, 
   3.676484295403784*^9}, {3.676484422381997*^9, 3.676484456276331*^9}, {
   3.676484503206237*^9, 3.67648451246283*^9}, {3.676484550067234*^9, 
   3.676484732401277*^9}, {3.676484794407113*^9, 3.676484958034377*^9}, {
   3.676485023568264*^9, 3.676485111254067*^9}, {3.676485187148814*^9, 
   3.6764852239547787`*^9}, {3.676485264176264*^9, 3.676485264181322*^9}, 
   3.6791767043551984`*^9, {3.6791768909036303`*^9, 3.67917690897907*^9}, 
   3.679655705263569*^9, {3.6796557543353004`*^9, 3.679655790623124*^9}, {
   3.681583750678505*^9, 3.6815837531629095`*^9}, {3.6816552433509064`*^9, 
   3.681655269890976*^9}, {3.6842403952605953`*^9, 3.6842404203259363`*^9}},
 CellID->1246656247],

Cell[TextData[{
 "2a. Specific heat changes are small compared to latent heat changes between \
stages ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[LeftBracketingBar]", 
     RowBox[{
      SubscriptBox["H", 
       RowBox[{"i", "+", "1"}]], "-", 
      SubscriptBox["H", "i"]}], "\[RightBracketingBar]"}], "\[LessLess]", 
    SubscriptBox["\[Lambda]", "vap"]}], TraditionalForm]], "InlineMath"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[LeftBracketingBar]", 
     RowBox[{
      SubscriptBox["h", 
       RowBox[{"i", "+", "1"}]], "-", 
      SubscriptBox["h", "i"]}], "\[RightBracketingBar]"}], "\[LessLess]", 
    SubscriptBox["\[Lambda]", "vap"]}], TraditionalForm]], "InlineMath"],
 "."
}], "DetailNotes",
 CellChangeTimes->{{3.6764836855195093`*^9, 3.676483686241996*^9}, {
   3.6764837229709883`*^9, 3.676483801144796*^9}, {3.676484208985889*^9, 
   3.676484295403784*^9}, {3.676484422381997*^9, 3.676484456276331*^9}, {
   3.676484503206237*^9, 3.67648451246283*^9}, {3.676484550067234*^9, 
   3.676484732401277*^9}, {3.676484794407113*^9, 3.676484958034377*^9}, {
   3.676485023568264*^9, 3.676485111254067*^9}, {3.676485187148814*^9, 
   3.6764852239547787`*^9}, {3.676485264176264*^9, 3.676485264181322*^9}, 
   3.6791767043551984`*^9, {3.6791768909036303`*^9, 3.67917690897907*^9}, 
   3.679655705263569*^9, {3.6796557543353004`*^9, 3.679655790623124*^9}, {
   3.681583750678505*^9, 3.6815837531629095`*^9}, {3.6816552433509064`*^9, 
   3.681655269890976*^9}, {3.6842403952605953`*^9, 3.684240469275427*^9}, 
   3.684240947696431*^9},
 CellID->1894578964],

Cell[TextData[{
 "2b. Heat of vaporization ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Lambda]", "vap"], TraditionalForm]], "InlineMath"],
 " is the same for both components and thus independent of concentration."
}], "DetailNotes",
 CellChangeTimes->{{3.6764836855195093`*^9, 3.676483686241996*^9}, {
   3.6764837229709883`*^9, 3.676483801144796*^9}, {3.676484208985889*^9, 
   3.676484295403784*^9}, {3.676484422381997*^9, 3.676484456276331*^9}, {
   3.676484503206237*^9, 3.67648451246283*^9}, {3.676484550067234*^9, 
   3.676484732401277*^9}, {3.676484794407113*^9, 3.676484958034377*^9}, {
   3.676485023568264*^9, 3.676485111254067*^9}, {3.676485187148814*^9, 
   3.6764852239547787`*^9}, {3.676485264176264*^9, 3.676485264181322*^9}, 
   3.6791767043551984`*^9, {3.6791768909036303`*^9, 3.67917690897907*^9}, 
   3.679655705263569*^9, {3.6796557543353004`*^9, 3.679655790623124*^9}, {
   3.681583750678505*^9, 3.6815837531629095`*^9}, {3.6816552433509064`*^9, 
   3.681655269890976*^9}, {3.6842403952605953`*^9, 3.684240427582086*^9}, 
   3.684240475990819*^9, 3.684240949731552*^9},
 CellID->1110576016],

Cell["3. Heat of mixing is negligible.", "DetailNotes",
 CellChangeTimes->{{3.6828001348411045`*^9, 3.6828001351687055`*^9}, 
   3.682800215259367*^9},
 CellID->372290207],

Cell["\<\
The equilibrium curve was calculated using the modified Raoult's law:\
\>", "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
  3.681583821108074*^9, 3.681583838668726*^9}},
 CellID->613959288],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"P", "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      SubscriptBox["\[Gamma]", "1"], " ", 
      SubsuperscriptBox["P", "1", "sat"]}], "+", 
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["\[Gamma]", "2"], " ", 
      SubsuperscriptBox["P", "2", "sat"]}]}]}], TraditionalForm]], 
  "InlineMath"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
  3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
  3.6815839032701855`*^9}, {3.6815840680532017`*^9, 3.6815840722496095`*^9}, {
  3.681655317914464*^9, 3.6816553192716665`*^9}},
 CellID->182840712],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["y", "i"], " ", "P"}], "=", 
    RowBox[{
     SubscriptBox["x", "i"], " ", 
     SubscriptBox["\[Gamma]", "i"], " ", 
     SubsuperscriptBox["P", "i", "sat"]}]}], TraditionalForm]], "InlineMath"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
  3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
  3.681583930637638*^9}, {3.6815840748276143`*^9, 3.6815840778570194`*^9}, {
  3.6816554094474764`*^9, 3.681655415703087*^9}, {3.6816557436751423`*^9, 
  3.6816557458299465`*^9}},
 CellID->171734077],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "i"], TraditionalForm]], "InlineMath"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", "i"], TraditionalForm]], "InlineMath"],
 " are the liquid and vapor mole fractions (",
 Cell[BoxData[
  FormBox[
   RowBox[{"i", "=", "1"}], TraditionalForm]], "InlineMath"],
 " for methanol, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"i", "=", "2"}], TraditionalForm]], "InlineMath"],
 " for water), ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["x", "1"], "+", 
     SubscriptBox["x", "2"]}], "=", "1"}], TraditionalForm]], "InlineMath"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["y", "1"], "+", 
     SubscriptBox["y", "2"]}], "=", "1"}], TraditionalForm]], "InlineMath"],
 ", ",
 Cell[BoxData[
  FormBox["P", TraditionalForm]], "InlineMath"],
 " is total pressure and ",
 Cell[BoxData[
  FormBox[Cell[TextData[Cell[BoxData[
    FormBox[
     SubsuperscriptBox["P", "i", "sat"], TraditionalForm]], "InlineMath"]], 
    "InlineMath"], TraditionalForm]], "InlineMath"],
 " is the saturation pressure, which is calculated using the Antoine equation:"
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
   3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
   3.6815839580785046`*^9}, {3.681655335263298*^9, 3.681655470192815*^9}, {
   3.681655757198767*^9, 3.6816557706083937`*^9}, {3.682693436044643*^9, 
   3.6826934831779604`*^9}, 3.684240507255883*^9},
 CellID->417910946],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["P", "i", "sat"], "=", 
    SuperscriptBox["10", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["A", "i"], "-", 
       FractionBox[
        SubscriptBox["B", "i"], 
        RowBox[{"T", "+", 
         SubscriptBox["C", "i"]}]]}], ")"}]]}], TraditionalForm]], 
  "InlineMath"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
  3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
  3.6815839823271804`*^9}, {3.684514154179325*^9, 3.68451416745365*^9}},
 CellID->142476940],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]], "InlineMath"],
 " is temperature, and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["A", "i"], TraditionalForm]], "InlineMath"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["B", "i"], TraditionalForm]], "InlineMath"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["C", "i"], TraditionalForm]], "InlineMath"],
 " are Antoine constants."
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
   3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
   3.681584029688101*^9}, {3.6816554767358475`*^9, 3.681655495344495*^9}, 
   3.6842405324548597`*^9},
 CellID->174539008],

Cell[TextData[{
 "The activity coefficients ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Gamma]", "i"], TraditionalForm]], "InlineMath"],
 " are calculated using the two-parameter Margules model:"
}], "DetailNotes",
 CellChangeTimes->{{3.6840720617602453`*^9, 3.684072069829464*^9}},
 CellID->421570329],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"ln", " ", 
     SubscriptBox["\[Gamma]", "1"]}], "=", 
    RowBox[{
     SubsuperscriptBox["x", "2", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["A", "12"], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["A", "21"], "-", 
          SubscriptBox["A", "12"]}], ")"}], " ", 
        SubscriptBox["x", "1"]}]}]}]}]}], TraditionalForm]], "InlineMath"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
  3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
  3.681584029688101*^9}, {3.6815840851456337`*^9, 3.6815841678462195`*^9}, {
  3.6816555125553427`*^9, 3.681655514162145*^9}, {3.6816556476592155`*^9, 
  3.681655653125225*^9}},
 CellID->678020050],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"ln", " ", 
     SubscriptBox["\[Gamma]", "2"]}], "=", 
    RowBox[{
     SubsuperscriptBox["x", "1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["A", "21"], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["A", "12"], "-", 
          SubscriptBox["A", "21"]}], ")"}], " ", 
        SubscriptBox["x", "2"]}]}]}]}]}], TraditionalForm]], "InlineMath"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
  3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
  3.681584029688101*^9}, {3.6815840851456337`*^9, 3.681584207665309*^9}, {
  3.6816555193137627`*^9, 3.6816555220265675`*^9}, {3.6816555919459515`*^9, 
  3.681655608015385*^9}, {3.6816556987927303`*^9, 3.6816557031083384`*^9}},
 CellID->1041801],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["A", "12"], "=", "0.7923"}], TraditionalForm]], "InlineMath"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["A", "21"], "=", "0.5434"}], TraditionalForm]], "InlineMath"],
 " are the Margules parameters for a methanol/water mixture."
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
   3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
   3.681584029688101*^9}, {3.6815840851456337`*^9, 3.681584244382209*^9}, {
   3.68165556187547*^9, 3.6816555810349073`*^9}, {3.6827990733635483`*^9, 
   3.6827990733635483`*^9}, {3.6828001676766496`*^9, 3.6828001687842517`*^9}, 
   3.6828002144325657`*^9, {3.684072081997102*^9, 3.684072105127761*^9}},
 CellID->248628401],

Cell["\<\
The operating lines for the rectifying and stripping sections are used to \
determine the number of stages. First the feed and rectifying operating lines \
are calculated:\
\>", "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
   3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
   3.681584029688101*^9}, {3.6815840851456337`*^9, 3.681584244382209*^9}, {
   3.68165556187547*^9, 3.6816555810349073`*^9}, 3.6827990733635483`*^9, {
   3.682799568245634*^9, 3.682799632861493*^9}},
 CellID->214837423],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", 
     StyleBox["f",
      FontSlant->"Plain"]], "=", 
    RowBox[{
     RowBox[{
      FractionBox["q", 
       RowBox[{"q", "-", "1"}]], " ", "x"}], "-", 
     FractionBox[
      SubscriptBox["z", 
       StyleBox["f",
        FontSlant->"Plain"]], 
      RowBox[{"q", "-", "1"}]]}]}], TraditionalForm]], "InlineMath"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
   3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
   3.681584029688101*^9}, {3.6815840851456337`*^9, 3.681584244382209*^9}, {
   3.68165556187547*^9, 3.6816555810349073`*^9}, 3.6827990733635483`*^9, {
   3.682799568245634*^9, 3.682799633360694*^9}, {3.6827996977626524`*^9, 
   3.6827997503852453`*^9}},
 CellID->62774028],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", 
     StyleBox["r",
      FontSlant->"Plain"]], "=", 
    RowBox[{
     RowBox[{
      FractionBox["R", 
       RowBox[{"R", "+", "1"}]], " ", "x"}], "+", 
     FractionBox[
      SubscriptBox["x", 
       StyleBox["d",
        FontSlant->"Plain"]], 
      RowBox[{"R", "+", "1"}]]}]}], TraditionalForm]], "InlineMath"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
   3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
   3.681584029688101*^9}, {3.6815840851456337`*^9, 3.681584244382209*^9}, {
   3.68165556187547*^9, 3.6816555810349073`*^9}, 3.6827990733635483`*^9, {
   3.682799568245634*^9, 3.682799633360694*^9}, {3.6827996977626524`*^9, 
   3.682799789102975*^9}},
 CellID->489852983],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox["q", TraditionalForm]], "InlineMath"],
 " is the vapor quality of the feed, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", 
    StyleBox["f",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " is the mole fraction of methanol in the feed, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    StyleBox["d",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " is the liquid mole fraction of methanol in the distillate and ",
 Cell[BoxData[
  FormBox["R", TraditionalForm]], "InlineMath"],
 " is the reflux ratio."
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
   3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
   3.681584029688101*^9}, {3.6815840851456337`*^9, 3.681584244382209*^9}, {
   3.68165556187547*^9, 3.6816555810349073`*^9}, 3.6827990733635483`*^9, {
   3.682799568245634*^9, 3.682799633360694*^9}, {3.6827996977626524`*^9, 
   3.682799871664054*^9}, 3.684240588751419*^9},
 CellID->338672037],

Cell[TextData[{
 "The operating line for the stripping section ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", 
    StyleBox["s",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " is found by drawing a line through the bottoms composition ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    StyleBox["b",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " on the ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]], "InlineMath"],
 "\[Dash]",
 Cell[BoxData[
  FormBox["y", TraditionalForm]], "InlineMath"],
 " line and the intersection of the feed line (also called the ",
 Cell[BoxData[
  FormBox["q", TraditionalForm]], "InlineMath"],
 " line) ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", 
    StyleBox["f",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 " and rectifying line ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", 
    StyleBox["r",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath"],
 ". The feed line intersects the rectifying line at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["x", "int"], ",", 
     SubscriptBox["y", "int"]}], ")"}], TraditionalForm]], "InlineMath"],
 ":"
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
   3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
   3.681584029688101*^9}, {3.6815840851456337`*^9, 3.681584244382209*^9}, {
   3.68165556187547*^9, 3.6816555810349073`*^9}, 3.6827990733635483`*^9, {
   3.682799568245634*^9, 3.682799633360694*^9}, {3.6827996977626524`*^9, 
   3.6828000315514946`*^9}, {3.6840723035832105`*^9, 3.68407231916284*^9}, {
   3.6840731130768075`*^9, 3.6840731893141804`*^9}, {3.68407341784453*^9, 
   3.684073419375333*^9}, {3.684240598889564*^9, 3.684240605639069*^9}, 
   3.6842666604852467`*^9, {3.6844964772022753`*^9, 3.684496477314076*^9}},
 CellID->579065947],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "int"], "=", 
    FractionBox[
     RowBox[{
      RowBox[{
       SubscriptBox["x", 
        StyleBox["d",
         FontSlant->"Plain"]], " ", 
       RowBox[{"(", 
        RowBox[{"q", "-", "1"}], ")"}]}], "+", 
      RowBox[{
       SubscriptBox["z", 
        StyleBox["f",
         FontSlant->"Plain"]], " ", 
       RowBox[{"(", 
        RowBox[{"R", "+", "1"}], ")"}]}]}], 
     RowBox[{"q", "+", "R"}]]}], TraditionalForm]], "InlineMath"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
   3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
   3.681584029688101*^9}, {3.6815840851456337`*^9, 3.681584244382209*^9}, {
   3.68165556187547*^9, 3.6816555810349073`*^9}, 3.6827990733635483`*^9, {
   3.682799568245634*^9, 3.682799633360694*^9}, {3.6827996977626524`*^9, 
   3.6828000315514946`*^9}, {3.6840723035832105`*^9, 3.68407231916284*^9}, {
   3.6840731130768075`*^9, 3.684073229331272*^9}},
 CellID->17178618],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "int"], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["y", 
       StyleBox["f",
        FontSlant->"Plain"]], "(", 
      SubscriptBox["x", "int"], ")"}], "=", 
     RowBox[{
      SubscriptBox["y", 
       StyleBox["r",
        FontSlant->"Plain"]], "(", 
      SubscriptBox["x", "int"], ")"}]}]}], TraditionalForm]], "InlineMath"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
   3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
   3.681584029688101*^9}, {3.6815840851456337`*^9, 3.681584244382209*^9}, {
   3.68165556187547*^9, 3.6816555810349073`*^9}, 3.6827990733635483`*^9, {
   3.682799568245634*^9, 3.682799633360694*^9}, {3.6827996977626524`*^9, 
   3.6828000315514946`*^9}, {3.6840723035832105`*^9, 3.68407231916284*^9}, {
   3.6840731130768075`*^9, 3.6840732856888266`*^9}},
 CellID->109690074],

Cell[TextData[{
 "the slope of the stripping line is calculated from ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["x", "int"], ",", 
     SubscriptBox["y", "int"]}], ")"}], TraditionalForm]], "InlineMath"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["x", 
      StyleBox["b",
       FontSlant->"Plain"]], ",", 
     SubscriptBox["x", 
      StyleBox["b",
       FontSlant->"Plain"]]}], ")"}], TraditionalForm]], "InlineMath"],
 " and the ",
 Cell[BoxData[
  FormBox["y", TraditionalForm]], "InlineMath"],
 " intercept is found:"
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
   3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
   3.681584029688101*^9}, {3.6815840851456337`*^9, 3.681584244382209*^9}, {
   3.68165556187547*^9, 3.6816555810349073`*^9}, 3.6827990733635483`*^9, {
   3.682799568245634*^9, 3.682799633360694*^9}, {3.6827996977626524`*^9, 
   3.6828000315514946`*^9}, {3.6840723035832105`*^9, 3.68407231916284*^9}, {
   3.6840731130768075`*^9, 3.6840733817924614`*^9}, {3.684266680057167*^9, 
   3.6842666801670637`*^9}},
 CellID->26165156],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", 
     StyleBox["s",
      FontSlant->"Plain"]], "=", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        SubscriptBox["y", "int"], "-", 
        SubscriptBox["x", 
         StyleBox["b",
          FontSlant->"Plain"]]}], 
       RowBox[{
        SubscriptBox["x", "int"], "-", 
        SubscriptBox["x", 
         StyleBox["b",
          FontSlant->"Plain"]]}]], " ", 
      RowBox[{"(", 
       RowBox[{"x", "-", 
        SubscriptBox["x", 
         StyleBox["b",
          FontSlant->"Plain"]]}], ")"}]}], "+", 
     SubscriptBox["x", 
      StyleBox["b",
       FontSlant->"Plain"]]}]}], TraditionalForm]], "InlineMath"],
 "."
}], "DetailNotes",
 CellChangeTimes->{{3.681583763492934*^9, 3.6815837770741696`*^9}, {
   3.681583821108074*^9, 3.681583838668726*^9}, {3.681583873968316*^9, 
   3.681584029688101*^9}, {3.6815840851456337`*^9, 3.681584244382209*^9}, {
   3.68165556187547*^9, 3.6816555810349073`*^9}, 3.6827990733635483`*^9, {
   3.682799568245634*^9, 3.682799633360694*^9}, {3.6827996977626524`*^9, 
   3.6828000315514946`*^9}, {3.6840723035832105`*^9, 3.68407231916284*^9}, {
   3.6840731130768075`*^9, 3.6840734255891438`*^9}},
 CellID->106093502],

Cell["\<\
View the screencast videos at [1] and [2] for a step-by-step explanation of \
the McCabe\[Dash]Thiele method.\
\>", "DetailNotes",
 CellChangeTimes->{{3.6815848382518215`*^9, 3.6815849073777747`*^9}, {
  3.681655831996743*^9, 3.681655831996743*^9}, {3.684240647646414*^9, 
  3.684240647824456*^9}},
 CellID->566652879],

Cell["References", "DetailNotes",
 CellChangeTimes->{{3.6815848382518215`*^9, 3.6815849073777747`*^9}, {
  3.681655831996743*^9, 3.681655834169548*^9}},
 CellID->122990324],

Cell[TextData[{
 "[1] ",
 StyleBox["McCabe\[Dash]Thiele Graphical Method Example Part 1",
  FontSlant->"Italic"],
 " [Video]. (Mar 6, 2014) ",
 ButtonBox["www.youtube.com/watch?v=Cv4KjY2BJTA",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://www.youtube.com/watch?v=Cv4KjY2BJTA"], None},
  ButtonNote->"https://www.youtube.com/watch?v=Cv4KjY2BJTA"],
 "."
}], "DetailNotes",
 CellChangeTimes->{{3.681584915459237*^9, 3.6815849172683406`*^9}, {
  3.681584978673853*^9, 3.6815850242984624`*^9}, {3.68424066059481*^9, 
  3.684240660796167*^9}},
 CellID->91303191],

Cell[TextData[{
 "[2] ",
 StyleBox["McCabe-Thiele Graphical Method Example Part 2",
  FontSlant->"Italic"],
 " [Video]. (Mar 6, 2014) ",
 ButtonBox["www.youtube.com/watch?v=eIJk5uXmBRc",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://www.youtube.com/watch?v=eIJk5uXmBRc"], None},
  ButtonNote->"https://www.youtube.com/watch?v=eIJk5uXmBRc"],
 "."
}], "DetailNotes",
 CellChangeTimes->{{3.6815850442426033`*^9, 3.6815850813847275`*^9}},
 CellID->882520694]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ControlSuggestionsSection"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[" Resize Images"]}],
  "\"Click inside an image to reveal its orange resize frame.\\nDrag any of \
the orange resize handles to resize the image.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.6815836498389316`*^9},
 FontFamily->"Verdana",
 CellTags->"ResizeImages"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Rotate and Zoom in 3D"]}],
  RowBox[{
   "\"Drag a 3D graphic to rotate it. Starting the drag near the center \
tumbles\\nthe graphic; starting near a corner turns it parallel to the plane \
of the screen.\\nHold down \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" (or \"", 
    FrameBox[
    "Cmd", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" on Mac) and drag up and down to zoom.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"RotateAndZoomIn3D"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[" Drag Locators"]}],
  RowBox[{"\"Drag any locator (\"", 
    GraphicsBox[
     LocatorBox[
      Scaled[{0.5, 0.5}]], ImageSize -> 20], 
    "\", etc.) to move it around.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.6815836511337337`*^9},
 FontFamily->"Verdana",
 CellTags->"DragLocators"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Create and Delete Locators"]}],
  RowBox[{"\"Insert a new locator in the graphic by holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key\\nand clicking where you want it to be. Delete a locator by \
clicking it\\nwhile holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" key.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"CreateAndDeleteLocators"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[" Slider Zoom"]}],
  RowBox[{"\"Hold down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key while moving a slider to make fine adjustments in the slider \
value.\\nHold \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" and/or \"", 
    FrameBox[
    "Shift", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" at the same time as \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" to make ever finer adjustments.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.681583652791337*^9},
 FontFamily->"Verdana",
 CellTags->"SliderZoom"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[" Gamepad Controls"]}],
  "\"Control this Demonstration with a gamepad or other\\nhuman interface \
device connected to your computer.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.35696210375764*^9, 3.3895522232313623`*^9, 
  3.681583653384138*^9},
 FontFamily->"Verdana",
 CellTags->"GamepadControls"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[" Automatic Animation"]}],
  RowBox[{"\"Animate a slider in this Demonstration by clicking the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJzzTSzJSM1NLMlMTlRwL0osyMhMLlZwyy8CCjEzMjAwcIKwAgOI/R/IhBKc\n\
/4EAyGAG0f+nTZsGwgysIJIRKsWKLAXGIHFmEpUgLADxWUAkI24jZs+eTaEt\n\
IG+wQKRmzJgBlYf5lhEA30OqWA=="], "Graphics", ImageSize -> {9, 9}, ImageMargins -> 
      0, CellBaseline -> Baseline], BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"button\\nnext to the slider, and then clicking the play button that \
appears.\\nAnimate all controls by selecting \"", 
    StyleBox["Autorun", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.681583653886339*^9},
 FontFamily->"Verdana",
 CellTags->"AutomaticAnimation"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Bookmark Animation"]}],
  RowBox[{
   "\"See a prepared animation of this Demonstration by selecting\\n\"", 
    StyleBox["Animate Bookmarks", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"BookmarkAnimation"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SearchTermsSection"],

Cell["distillation", "SearchTerms",
 CellChangeTimes->{{3.6764858546888638`*^9, 3.676485855389348*^9}, {
   3.679655477543532*^9, 3.679655478133607*^9}, 3.682693293771456*^9},
 CellID->881704250],

Cell["separations", "SearchTerms",
 CellChangeTimes->{{3.676485858442082*^9, 3.6764858593483553`*^9}, {
   3.6796554571590257`*^9, 3.6796554813905163`*^9}, 3.6816558439969664`*^9, 
   3.6826932767378488`*^9},
 CellID->1806955628],

Cell["chemical engineering", "SearchTerms",
 CellChangeTimes->{{3.676485858442082*^9, 3.6764858593483553`*^9}, {
  3.6796554571590257`*^9, 3.679655488168081*^9}},
 CellID->274039471],

Cell["phase equilibrium", "SearchTerms",
 CellChangeTimes->{{3.676485858442082*^9, 3.6764858593483553`*^9}, {
  3.6796554571590257`*^9, 3.679655492205284*^9}},
 CellID->256725449],

Cell["distillation column", "SearchTerms",
 CellChangeTimes->{{3.681655846446171*^9, 3.6816558515191793`*^9}},
 CellID->219566529],

Cell["thermodynamics", "SearchTerms",
 CellChangeTimes->{{3.681655846446171*^9, 3.681655856263588*^9}},
 CellID->654425661],

Cell["equilibrium", "SearchTerms",
 CellChangeTimes->{{3.681655846446171*^9, 3.6816558684154105`*^9}},
 CellID->106196522],

Cell["binary mixture", "SearchTerms",
 CellChangeTimes->{{3.681655846446171*^9, 3.6816558721708183`*^9}},
 CellID->237275068]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "RelatedLinksSection"],

Cell[TextData[ButtonBox["McCabe & Thiele Graphical Method",
 BaseStyle->"Hyperlink",
 ButtonData->{
   URL["http://demonstrations.wolfram.com/McCabeThieleGraphicalMethod/"], 
   None},
 ButtonNote->
  "http://demonstrations.wolfram.com/McCabeThieleGraphicalMethod/"]], \
"RelatedLinks",
 CellChangeTimes->{{3.6791769453657017`*^9, 3.679176967385561*^9}},
 CellID->70716352]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "AuthorSection"],

Cell[TextData[{
 "Contributed by: ",
 ButtonBox["Neil Hendren",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=Neil+Hendren"], 
    None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=Neil+Hendren"]
}], "Author",
 CellChangeTimes->{3.6791736512483034`*^9, 3.6791769778452263`*^9},
 CellID->310068220],

Cell[TextData[{
 "Additional contributions by: ",
 ButtonBox["Rachael L. Baumann",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=Rachael+L.+\
Baumann"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=Rachael+L.+Baumann"],
 ", ",
 ButtonBox["John L. Falconer",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=John+L.+\
Falconer"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=John+L.+Falconer"],
 " and ",
 ButtonBox["Thomas Belval",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=Thomas+Belval"],
     None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=Thomas+Belval"]
}], "Author",
 CellChangeTimes->{{3.6791736529049067`*^9, 3.679173698861251*^9}, {
  3.679173744864237*^9, 3.6791737586000977`*^9}, {3.6841676499960833`*^9, 
  3.684167649997083*^9}},
 CellID->377872580],

Cell["\<\
University of Colorado Boulder, Department of Chemical and Biological \
Engineering\
\>", "Author",
 CellChangeTimes->{{3.6791737377464213`*^9, 3.679173753097685*^9}, {
  3.68424073143681*^9, 3.684240733673936*^9}},
 CellID->466519130]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1366, 686},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (April 11, 2016)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "Demonstration.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "ResizeImages"->{
  Cell[205387, 4711, 355, 9, 29, "ControlSuggestions",
   CellTags->"ResizeImages"]},
 "RotateAndZoomIn3D"->{
  Cell[205745, 4722, 678, 16, 29, "ControlSuggestions",
   CellTags->"RotateAndZoomIn3D"]},
 "DragLocators"->{
  Cell[206426, 4740, 383, 12, 29, "ControlSuggestions",
   CellTags->"DragLocators"]},
 "CreateAndDeleteLocators"->{
  Cell[206812, 4754, 637, 15, 29, "ControlSuggestions",
   CellTags->"CreateAndDeleteLocators"]},
 "SliderZoom"->{
  Cell[207452, 4771, 885, 22, 29, "ControlSuggestions",
   CellTags->"SliderZoom"]},
 "GamepadControls"->{
  Cell[208340, 4795, 393, 10, 29, "ControlSuggestions",
   CellTags->"GamepadControls"]},
 "AutomaticAnimation"->{
  Cell[208736, 4807, 1505, 32, 29, "ControlSuggestions",
   CellTags->"AutomaticAnimation"]},
 "BookmarkAnimation"->{
  Cell[210244, 4841, 908, 21, 29, "ControlSuggestions",
   CellTags->"BookmarkAnimation"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"ResizeImages", 215106, 4992},
 {"RotateAndZoomIn3D", 215216, 4995},
 {"DragLocators", 215327, 4998},
 {"CreateAndDeleteLocators", 215444, 5001},
 {"SliderZoom", 215559, 5004},
 {"GamepadControls", 215666, 5007},
 {"AutomaticAnimation", 215781, 5010},
 {"BookmarkAnimation", 215899, 5013}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[585, 22, 112, 1, 74, "DemoTitle"],
Cell[700, 25, 33, 0, 287, "InitializationSection"],
Cell[CellGroupData[{
Cell[758, 29, 29, 0, 192, "ManipulateSection"],
Cell[CellGroupData[{
Cell[812, 33, 37290, 870, 2540, "Input"],
Cell[38105, 905, 17514, 355, 529, "Output",
 CellID->60536661]
}, Open  ]],
Cell[55634, 1263, 5170, 138, 248, "Input",
 CellID->752167533],
Cell[60807, 1403, 6945, 186, 308, "Input",
 CellID->494835141],
Cell[67755, 1591, 1104, 31, 68, "Input",
 CellID->240604102]
}, Open  ]],
Cell[CellGroupData[{
Cell[68896, 1627, 36, 0, 169, "ManipulateCaptionSection"],
Cell[68935, 1629, 2894, 61, 100, "ManipulateCaption",
 CellID->921506457]
}, Open  ]],
Cell[CellGroupData[{
Cell[71866, 1695, 28, 0, 173, "ThumbnailSection"],
Cell[71897, 1697, 27323, 584, 515, "Output",
 CellID->450018725]
}, Open  ]],
Cell[CellGroupData[{
Cell[99257, 2286, 28, 0, 143, "SnapshotsSection"],
Cell[99288, 2288, 27385, 584, 515, "Output",
 CellID->164622179],
Cell[126676, 2874, 27326, 584, 498, "Output",
 CellID->901985876],
Cell[154005, 3460, 27330, 584, 498, "Output",
 CellID->367986919]
}, Open  ]],
Cell[CellGroupData[{
Cell[181372, 4049, 26, 0, 343, "DetailsSection"],
Cell[181401, 4051, 790, 12, 40, "DetailNotes",
 CellID->1224384310],
Cell[182194, 4065, 450, 6, 23, "DetailNotes",
 CellID->2068001857],
Cell[182647, 4073, 1194, 18, 56, "DetailNotes",
 CellID->1246656247],
Cell[183844, 4093, 1600, 36, 46, "DetailNotes",
 CellID->1894578964],
Cell[185447, 4131, 1115, 19, 26, "DetailNotes",
 CellID->1110576016],
Cell[186565, 4152, 171, 3, 23, "DetailNotes",
 CellID->372290207],
Cell[186739, 4157, 237, 5, 23, "DetailNotes",
 CellID->613959288],
Cell[186979, 4164, 710, 20, 25, "DetailNotes",
 CellID->182840712],
Cell[187692, 4186, 646, 17, 24, "DetailNotes",
 CellID->171734077],
Cell[188341, 4205, 1560, 47, 44, "DetailNotes",
 CellID->417910946],
Cell[189904, 4254, 618, 19, 36, "DetailNotes",
 CellID->142476940],
Cell[190525, 4275, 704, 22, 23, "DetailNotes",
 CellID->174539008],
Cell[191232, 4299, 306, 8, 23, "DetailNotes",
 CellID->421570329],
Cell[191541, 4309, 846, 24, 25, "DetailNotes",
 CellID->678020050],
Cell[192390, 4335, 894, 24, 25, "DetailNotes",
 CellID->1041801],
Cell[193287, 4361, 818, 19, 23, "DetailNotes",
 CellID->248628401],
Cell[194108, 4382, 563, 10, 39, "DetailNotes",
 CellID->214837423],
Cell[194674, 4394, 834, 24, 31, "DetailNotes",
 CellID->62774028],
Cell[195511, 4420, 833, 24, 30, "DetailNotes",
 CellID->489852983],
Cell[196347, 4446, 1047, 27, 39, "DetailNotes",
 CellID->338672037],
Cell[197397, 4475, 1892, 52, 39, "DetailNotes",
 CellID->579065947],
Cell[199292, 4529, 1059, 29, 33, "DetailNotes",
 CellID->17178618],
Cell[200354, 4560, 956, 25, 23, "DetailNotes",
 CellID->109690074],
Cell[201313, 4587, 1187, 32, 23, "DetailNotes",
 CellID->26165156],
Cell[202503, 4621, 1259, 37, 32, "DetailNotes",
 CellID->106093502],
Cell[203765, 4660, 328, 7, 23, "DetailNotes",
 CellID->566652879],
Cell[204096, 4669, 172, 3, 23, "DetailNotes",
 CellID->122990324],
Cell[204271, 4674, 569, 15, 23, "DetailNotes",
 CellID->91303191],
Cell[204843, 4691, 467, 13, 23, "DetailNotes",
 CellID->882520694]
}, Open  ]],
Cell[CellGroupData[{
Cell[205347, 4709, 37, 0, 131, "ControlSuggestionsSection"],
Cell[205387, 4711, 355, 9, 29, "ControlSuggestions",
 CellTags->"ResizeImages"],
Cell[205745, 4722, 678, 16, 29, "ControlSuggestions",
 CellTags->"RotateAndZoomIn3D"],
Cell[206426, 4740, 383, 12, 29, "ControlSuggestions",
 CellTags->"DragLocators"],
Cell[206812, 4754, 637, 15, 29, "ControlSuggestions",
 CellTags->"CreateAndDeleteLocators"],
Cell[207452, 4771, 885, 22, 29, "ControlSuggestions",
 CellTags->"SliderZoom"],
Cell[208340, 4795, 393, 10, 29, "ControlSuggestions",
 CellTags->"GamepadControls"],
Cell[208736, 4807, 1505, 32, 29, "ControlSuggestions",
 CellTags->"AutomaticAnimation"],
Cell[210244, 4841, 908, 21, 29, "ControlSuggestions",
 CellTags->"BookmarkAnimation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[211189, 4867, 30, 0, 165, "SearchTermsSection"],
Cell[211222, 4869, 195, 3, 23, "SearchTerms",
 CellID->881704250],
Cell[211420, 4874, 229, 4, 23, "SearchTerms",
 CellID->1806955628],
Cell[211652, 4880, 182, 3, 23, "SearchTerms",
 CellID->274039471],
Cell[211837, 4885, 179, 3, 23, "SearchTerms",
 CellID->256725449],
Cell[212019, 4890, 130, 2, 23, "SearchTerms",
 CellID->219566529],
Cell[212152, 4894, 123, 2, 23, "SearchTerms",
 CellID->654425661],
Cell[212278, 4898, 122, 2, 23, "SearchTerms",
 CellID->106196522],
Cell[212403, 4902, 125, 2, 23, "SearchTerms",
 CellID->237275068]
}, Open  ]],
Cell[CellGroupData[{
Cell[212565, 4909, 31, 0, 149, "RelatedLinksSection"],
Cell[212599, 4911, 373, 9, 23, "RelatedLinks",
 CellID->70716352]
}, Open  ]],
Cell[CellGroupData[{
Cell[213009, 4925, 25, 0, 149, "AuthorSection"],
Cell[213037, 4927, 384, 11, 23, "Author",
 CellID->310068220],
Cell[213424, 4940, 1037, 29, 23, "Author",
 CellID->377872580],
Cell[214464, 4971, 245, 6, 23, "Author",
 CellID->466519130]
}, Open  ]]
}, Open  ]]
}
]
*)

