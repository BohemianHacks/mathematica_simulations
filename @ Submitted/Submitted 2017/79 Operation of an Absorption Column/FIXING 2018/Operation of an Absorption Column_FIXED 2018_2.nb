(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    295507,       6546]
NotebookOptionsPosition[    287061,       6388]
NotebookOutlinePosition[    289116,       6438]
CellTagsIndexPosition[    288780,       6426]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Operation of an Absorption Column", "DemoTitle",
 CellChangeTimes->{
  3.713707243545464*^9},ExpressionUUID->"5f7a0c1f-f8a5-4441-bfb6-\
2a930302f635"],

Cell["", "InitializationSection",ExpressionUUID->"0eb0a201-9e6b-43ce-9a4c-dfc84ab069eb"],

Cell[CellGroupData[{

Cell["", "ManipulateSection",ExpressionUUID->"134c66fa-d8fc-4608-a960-59a3d076fc5e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Ea", ",", "R", ",", "T0", ",", "H0", ",", "HB", ",", "V", ",", "YN1", 
       ",", "yeq", ",", "xeq", ",", "check", ",", "yLVmin", ",", "xN", ",", 
       "X", ",", "Y", ",", "n0", ",", "n", ",", "colL", ",", "colV", ",", "h",
        ",", "w", ",", "ry", ",", "tank", ",", "plot", ",", "column", ",", 
       "stages"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"HTS", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"yN1", "=", "59"}], ";", 
          RowBox[{"T", "=", "25"}], ";", 
          RowBox[{"P", "=", "2.5"}], ";", 
          RowBox[{"L", "=", "100"}], ";", 
          RowBox[{"y1", "=", "10"}], ";", 
          RowBox[{"x0", "=", "0.05"}], ";", 
          RowBox[{"LoVmin", "=", "False"}], ";"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Ea", "=", "5000"}], ";", 
      RowBox[{"R", "=", "8.314"}], ";", 
      RowBox[{"T0", "=", "298"}], ";", 
      RowBox[{"H0", "=", "211.19"}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"atm", "/", "mole"}], " ", 
        RowBox[{"frac", "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"HB", "=", 
       RowBox[{"H0", "*", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["Ea", "R"]}], "*", 
          RowBox[{"(", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"T", "+", "273"}]], "-", 
            FractionBox["1", "T0"]}], ")"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"V", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"YN1", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         FractionBox["L", "V"], "*", 
         RowBox[{"(", 
          RowBox[{"x", "-", "x0"}], ")"}]}], "+", "y1"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yeq", "[", "x_", "]"}], ":=", 
       RowBox[{
        FractionBox["HB", "P"], "*", "x"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xeq", "=", 
       RowBox[{"x", "/.", 
        RowBox[{"Quiet", "@", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", "yN1"}], ",", "x"}], 
           "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"check", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"YN1", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yLVmin", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"yeq", "[", "xeq", "]"}], "-", "y1"}], 
          RowBox[{"xeq", "-", "x0"}]], "*", 
         RowBox[{"(", 
          RowBox[{"x", "-", "x0"}], ")"}]}], "+", "y1"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"xN", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"yN1", "-", "y1"}], 
         RowBox[{"L", "/", "V"}]], "+", "x0"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"X", "[", "0", "]"}], "=", "xN"}], ";", 
      RowBox[{
       RowBox[{"Y", "[", "0", "]"}], "=", 
       RowBox[{"yeq", "[", "xN", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"X", "[", "i", "]"}], "=", 
           RowBox[{"x", "/.", 
            RowBox[{"Quiet", "@", 
             RowBox[{
              RowBox[{"Solve", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"YN1", "[", "x", "]"}], "\[Equal]", 
                 RowBox[{"Y", "[", 
                  RowBox[{"i", "-", "1"}], "]"}]}], ",", "x"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}]}], ",", 
          RowBox[{
           RowBox[{"Y", "[", "i", "]"}], "=", 
           RowBox[{"yeq", "[", 
            RowBox[{"X", "[", "i", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "50"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"X", "[", "#", "]"}], "<", "x0"}], ",", "0", ",", "#"}],
             "]"}], "&"}], "/@", 
          RowBox[{"Range", "@", "50"}]}], ",", "0"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "n0"}], "\[Equal]", "0"}], ",", "1", ",", 
         RowBox[{"1", "+", 
          RowBox[{"n0", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"colV", "=", 
       RowBox[{"RGBColor", "[", 
        RowBox[{"0", ",", "0.5", ",", "0"}], "]"}]}], ";", 
      RowBox[{"colL", "=", 
       RowBox[{"RGBColor", "[", 
        RowBox[{"0", ",", "0", ",", "0.75"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"h", "=", "13"}], ";", 
      RowBox[{"w", "=", "12"}], ";", 
      RowBox[{"ry", "=", "2"}], ";", "\[IndentingNewLine]", 
      RowBox[{"tank", "=", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Thick", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"#", ",", "ry"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"#", ",", 
                  RowBox[{"h", "-", "ry"}]}], "}"}]}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"{", 
             RowBox[{"0", ",", "w"}], "}"}]}], ",", 
           RowBox[{"Circle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"w", "/", "2"}], ",", "ry"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"w", "/", "2"}], ",", "ry"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Pi]", ",", 
               RowBox[{"2", "*", "\[Pi]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Circle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"w", "/", "2"}], ",", 
               RowBox[{"h", "-", "ry"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"w", "/", "2"}], ",", "ry"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Arrowheads", "@", "0.1"}], ",", "\[IndentingNewLine]", 
             "colV", ",", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "w"}], "/", "2"}], ",", 
                  RowBox[{
                   RowBox[{"-", "h"}], "/", "4"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.25", "*", "w"}], ",", 
                  RowBox[{
                   RowBox[{"-", "h"}], "/", "4"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.25", "*", "w"}], ",", 
                  RowBox[{"ry", "/", "10"}]}], "}"}]}], "}"}], "]"}], ",", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.25", "*", "w"}], ",", 
                  RowBox[{"h", "-", 
                   RowBox[{"ry", "/", "10"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.25", "*", "w"}], ",", 
                  RowBox[{"h", "+", 
                   RowBox[{"h", "/", "4"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "w"}], "/", "2"}], ",", 
                  RowBox[{"h", "+", 
                   RowBox[{"h", "/", "4"}]}]}], "}"}]}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", "colL", ",", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.75", "*", "w"}], ",", 
                  RowBox[{"ry", "/", "10"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.75", "*", "w"}], ",", 
                  RowBox[{
                   RowBox[{"-", "h"}], "/", "4"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"w", "+", 
                   RowBox[{"w", "/", "2.3"}]}], ",", 
                  RowBox[{
                   RowBox[{"-", "h"}], "/", "4"}]}], "}"}]}], "}"}], "]"}], 
             ",", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"w", "+", 
                   RowBox[{"w", "/", "2.3"}]}], ",", 
                  RowBox[{"h", "+", 
                   RowBox[{"h", "/", "4"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.75", "*", "w"}], ",", 
                  RowBox[{"h", "+", 
                   RowBox[{"h", "/", "4"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.75", "*", "w"}], ",", 
                  RowBox[{"h", "-", 
                   RowBox[{"ry", "/", "10"}]}]}], "}"}]}], "}"}], "]"}]}], 
            "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"230", ",", "390"}], "}"}]}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "w"}], "/", "2.13"}], ",", 
              RowBox[{"w", "+", 
               RowBox[{"w", "/", "2.3"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "h"}], "/", "5"}], ",", 
              RowBox[{"h", "+", 
               RowBox[{"h", "/", "7"}]}]}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotRangePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"None", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Scaled", "@", "0.15"}], ",", 
              RowBox[{"Scaled", "@", "0.17"}]}], "}"}]}], "}"}]}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"plot", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"YN1", "[", "x", "]"}], ",", 
           RowBox[{"yeq", "[", "x", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", "xeq"}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Thick", ",", 
              RowBox[{"If", "[", 
               RowBox[{"LoVmin", ",", "Transparent", ",", "Magenta"}], 
               "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Thick", ",", 
              RowBox[{"RGBColor", "[", 
               RowBox[{"1", ",", "0.4", ",", "0"}], "]"}]}], "}"}]}], "}"}]}],
          ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"yN1", "+", "5"}]}], "}"}]}], ",", 
         RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
         RowBox[{"PlotRangeClipping", "\[Rule]", "False"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{"\"\<solute/(solute-free liquid) \>\"", ",", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", " ", 
               "\"\< (ppm)\>\""}], "}"}]}], ",", 
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{"\"\<solute/(solute-free vapor) \>\"", ",", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
               "\"\< (ppm)\>\""}], "}"}]}]}], "}"}]}], ",", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"17", ",", "Black"}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"370", ",", "370"}], "}"}]}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"55", ",", "25"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"50", ",", "5"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Epilog", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"LoVmin", ",", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"L", "/", "V"}], ")"}], "min", " ", "LINE"}], "*)"}],
               "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"Thick", ",", "Magenta", ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"yLVmin", "[", "0", "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"xeq", ",", 
                    RowBox[{"yLVmin", "[", "xeq", "]"}]}], "}"}]}], "}"}], 
                 "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"yeq", "[", "check", "]"}], "<", "yN1"}], "\[And]", 
                 RowBox[{"check", ">", "0"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{"FOR", " ", "INFINITE", " ", "STAGES"}], "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"Text", "[", 
                 RowBox[{
                  RowBox[{"Framed", "[", 
                   RowBox[{
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<separation not possible\>\"", ",", "20", ",", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.85", ",", "0", ",", "0"}], "]"}]}], "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<\[Star]infinite stages needed\[Star]\>\"", ",", 
                    "17"}], "]"}]}], "}"}], ",", "Center"}], "]"}], ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"0.55", "*", "xeq"}], ",", 
                    RowBox[{"0.6", "*", "yN1"}]}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"FOR", " ", "NON"}], "-", 
                   RowBox[{"INFINITE", " ", "STAGES"}]}], ",", " ", 
                  RowBox[{"SEPARATION", " ", "IS", " ", "POSSIBLE"}]}], 
                 "*)"}], "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"#", "-", "1"}], "]"}], ",", 
                    RowBox[{"Y", "[", 
                    RowBox[{"#", "-", "1"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "#", "]"}], ",", 
                    RowBox[{"Y", "[", 
                    RowBox[{"#", "-", "1"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "#", "]"}], ",", 
                    RowBox[{"Y", "[", "#", "]"}]}], "}"}]}], "}"}], "]"}], 
                    "&"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{"n", "-", "1"}], "]"}]}], ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "0", "]"}], ",", 
                    RowBox[{"Y", "[", "0", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "0", "]"}], ",", 
                    RowBox[{"YN1", "[", "xN", "]"}]}], "}"}]}], "}"}], "]"}], 
                  ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"n", "-", "1"}], "]"}], ",", 
                    RowBox[{"Y", "[", 
                    RowBox[{"n", "-", "1"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x0", ",", 
                    RowBox[{"Y", "[", 
                    RowBox[{"n", "-", "1"}], "]"}]}], "}"}]}], "}"}], "]"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{"SHOW", " ", "n", " ", "STAGES"}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"HTS", "\[Equal]", "False"}], ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"(*", "STAGES", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"n", "<", "30"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", ",", 
                    RowBox[{"n", "+", "1", "-", "#"}], ",", "\"\< \>\""}], 
                    "}"}]}], ",", "17", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"#", "-", "1"}], "]"}], ",", 
                    RowBox[{"Y", "[", 
                    RowBox[{"#", "-", "1"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], "&"}], "/@", 
                    RowBox[{"Range", "@", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"n", "\[LessEqual]", "8"}], ",", "n", ",", "8"}], 
                    "]"}]}]}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"n", ">", "8"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", ",", "1", ",", "\"\< \>\""}], 
                    "}"}]}], ",", "17", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"n", "-", "1"}], "]"}], ",", 
                    RowBox[{"Y", "[", 
                    RowBox[{"n", "-", "1"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"x0", " ", "AND", " ", "y1", " ", "LINES"}], ",", 
                    " ", "POINTS", ",", " ", 
                    RowBox[{"AND", " ", "LABELS"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"colL", ",", "Dashed", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x0", ",", "y1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x0", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
                    "colV", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "y1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x0", ",", "y1"}], "}"}]}], "}"}], "]"}]}], "}"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", "1"}], 
                    "]"}], ",", "17", ",", "colV", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "y1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1.2", ",", "0"}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", "0"}], 
                    "]"}], ",", "17", ",", "colL", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1.2"}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"PointSize", "@", "0.025"}], ",", "colL", ",", 
                    RowBox[{"Point", "@", 
                    RowBox[{"{", 
                    RowBox[{"x0", ",", "0"}], "}"}]}], ",", "colV", ",", 
                    RowBox[{"Point", "@", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "y1"}], "}"}]}], ",", "colL", ",", 
                    RowBox[{"Point", "@", 
                    RowBox[{"{", 
                    RowBox[{"xN", ",", 
                    RowBox[{"yeq", "[", "xN", "]"}]}], "}"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"xN", " ", "LINE"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Dashed", ",", "colL", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"xN", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xN", ",", 
                    RowBox[{"yeq", "[", "xN", "]"}]}], "}"}]}], "}"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Framed", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<x\>\"", ",", "n"}], "]"}], ",", "18", ",", 
                    "Italic"}], "]"}], ",", 
                    RowBox[{"Background", "\[Rule]", "White"}], ",", 
                    RowBox[{"FrameStyle", "\[Rule]", "None"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xN", ",", 
                    RowBox[{"0.25", "*", "yN1"}]}], "}"}]}], "]"}]}], "}"}]}],
                     "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{"yN", "+", 
                    RowBox[{"1", " ", "LINE", " ", "AND", " ", "LABEL"}]}], 
                   "*)"}], "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"Dashed", ",", "colV", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "yN1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xeq", ",", "yN1"}], "}"}]}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Framed", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
                    RowBox[{"n", "+", "1"}]}], "]"}], ",", "18"}], "]"}], ",", 
                    RowBox[{"Background", "\[Rule]", "White"}], ",", 
                    RowBox[{"FrameStyle", "\[Rule]", "None"}], ",", 
                    RowBox[{"FrameMargins", "\[Rule]", "Tiny"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.15", ",", "yN1"}], "}"}]}], "]"}]}], "}"}], 
                  ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{"SHOW", " ", "5", " ", "STAGES"}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{"HTS", ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"POINTS", " ", "ON", " ", "x"}], "-", 
                    RowBox[{"y", " ", "DIAGRAM"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"PointSize", "@", "0.025"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"colL", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Point", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "#", "]"}], ",", 
                    RowBox[{"yeq", "[", 
                    RowBox[{"X", "[", "#", "]"}], "]"}]}], "}"}]}], "&"}], "/@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"n", "-", "1"}]}], "]"}]}], ",", 
                    RowBox[{"Point", "@", 
                    RowBox[{"{", 
                    RowBox[{"x0", ",", "0"}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"colV", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Point", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", "#", "]"}], ",", 
                    RowBox[{"YN1", "[", 
                    RowBox[{"X", "[", "#", "]"}], "]"}]}], "}"}]}], "&"}], "/@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", "n"}], "]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "x", " ", "AND", " ", "y", " ", "LABELS", " ", "ON", " ", 
                    "STAGES"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"n", "+", "1", "-", "#"}], ",", "\"\<, \>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                    RowBox[{"n", "+", "1", "-", "#"}]}], "]"}], ",", "colL"}],
                     "]"}], ",", "\"\<, \>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
                    RowBox[{"n", "+", "1", "-", "#"}]}], "]"}], ",", "colV"}],
                     "]"}]}], "}"}]}], ",", "17"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"#", "-", "1"}], "]"}], ",", 
                    RowBox[{"yeq", "@", 
                    RowBox[{"X", "[", 
                    RowBox[{"#", "-", "1"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.2"}], ",", "1"}], "}"}]}], "]"}], "&"}], "/@", 
                    RowBox[{"Range", "@", "n"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", "0"}], 
                    "]"}], ",", "17", ",", "colL"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.2"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<y\>\"", ",", "\"\<n\>\""}], "]"}], ",", 
                    "Italic", ",", "colV"}], "]"}], ",", 
                    "\"\< is in equilibrium with \>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<x\>\"", ",", "\"\<n\>\""}], "]"}], ",", 
                    "Italic", ",", "colL"}], "]"}]}], "}"}]}], ",", "17"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.4", ",", "3"}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "INLET", " ", "AND", " ", "OUTLET", " ", "STAGE", " ", 
                    "BALANCES"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<stage \>\"", ",", "tray", ",", 
                    "\"\< solute fluxes:\>\""}], "}"}]}], ",", 
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<in: \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"n", "+", "1", "-", "tray"}], "]"}], "*", "L"}], 
                    "+", 
                    RowBox[{
                    RowBox[{"YN1", "[", 
                    RowBox[{"X", "[", 
                    RowBox[{"n", "+", "1", "-", "tray", "-", "1"}], "]"}], 
                    "]"}], "*", "V"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "1"}], "}"}]}], "]"}], ",", 
                    "\"\< mol/h\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<out: \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"n", "+", "1", "-", "tray", "-", "1"}], "]"}], 
                    "*", "L"}], "+", 
                    RowBox[{
                    RowBox[{"YN1", "[", 
                    RowBox[{"X", "[", 
                    RowBox[{"n", "+", "1", "-", "tray"}], "]"}], "]"}], "*", 
                    "V"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "1"}], "}"}]}], "]"}], ",", 
                    "\"\< mol/h\>\""}], "}"}]}]}], "\[IndentingNewLine]", 
                    "}"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", "\"\<:\>\""}]}], "]"}]}], 
                    "}"}], ",", "Center"}], "]"}], ",", "17"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.2", ",", "48"}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<top\>\"", ",", "17", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.04", ",", "6"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<bottom\>\"", ",", "17", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.63", ",", "61.1"}], "}"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}]}], "]"}]}], 
                 "\[IndentingNewLine]", "}"}]}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "EQUILIBRIUM", " ", "AND", " ", "OPERATING", " ", "LINE", " ", 
              "LABELS"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"Mouseover", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Transparent", ",", 
                RowBox[{"Thickness", "@", "0.04"}], ",", 
                RowBox[{"CapForm", "@", "None"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{"LoVmin", ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"yLVmin", "[", "0", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xeq", ",", 
                    RowBox[{"yLVmin", "[", "xeq", "]"}]}], "}"}]}], "}"}], 
                   "]"}], ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"YN1", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", "xeq", ",", "0.01"}], "]"}]}], "]"}]}], 
                 "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Thickness", "@", "0.02"}], ",", "Magenta", ",", 
                RowBox[{"If", "[", 
                 RowBox[{"LoVmin", ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"yLVmin", "[", "0", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"xeq", ",", 
                    RowBox[{"yLVmin", "[", "xeq", "]"}]}], "}"}]}], "}"}], 
                   "]"}], ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"YN1", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"x", "/.", 
                    RowBox[{
                    RowBox[{"Solve", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"YN1", "[", "x", "]"}], "\[Equal]", 
                    RowBox[{"yN1", "+", "5"}]}], ",", "x"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", "0.01"}], "]"}]}], 
                   "]"}]}], "]"}], ",", 
                RowBox[{"Text", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<operating line\>\"", ",", "\"\<(mass balance)\>\""}],
                     "}"}], ",", "Center"}], "]"}], ",", "17", ",", 
                    "Magenta"}], "]"}], ",", 
                  RowBox[{"If", "[", 
                   RowBox[{"HTS", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.75", "*", "xeq"}], ",", 
                    RowBox[{"0.25", "*", "yN1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.25", "*", "xeq"}], ",", 
                    RowBox[{"0.7", "*", "yN1"}]}], "}"}]}], "]"}]}], "]"}]}], 
               "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"Mouseover", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Transparent", ",", 
                RowBox[{"Thickness", "@", "0.04"}], ",", 
                RowBox[{"CapForm", "@", "None"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"yeq", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
                  RowBox[{"Range", "[", 
                   RowBox[{"0", ",", "xeq", ",", "0.01"}], "]"}]}], "]"}]}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Thickness", "@", "0.02"}], ",", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{"1", ",", "0.4", ",", "0"}], "]"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"yeq", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
                  RowBox[{"Range", "[", 
                   RowBox[{"0", ",", "xeq", ",", "0.01"}], "]"}]}], "]"}], 
                ",", 
                RowBox[{"Text", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<equilibrium line\>\"", ",", "17", ",", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"1", ",", "0.4", ",", "0"}], "]"}]}], "]"}], ",", 
                  RowBox[{"If", "[", 
                   RowBox[{"HTS", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.75", "*", "xeq"}], ",", 
                    RowBox[{"0.25", "*", "yN1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.25", "*", "xeq"}], ",", 
                    RowBox[{"0.7", "*", "yN1"}]}], "}"}]}], "]"}]}], "]"}]}], 
               "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"column", "=", 
       RowBox[{"Show", "[", 
        RowBox[{"tank", ",", 
         RowBox[{"Epilog", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "\[IndentingNewLine]", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"Column", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<liquid solvent feed\>\"", ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<L\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"L", ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "0"}], "}"}]}], "]"}], ",", 
                    "\"\< Mmol/h\>\""}], "}"}]}]}], "}"}], ",", "Right"}], 
                 "]"}], ",", "17", ",", "colL"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"w", ",", 
                RowBox[{"h", "+", 
                 RowBox[{"h", "/", "4"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.2", ",", 
                RowBox[{"-", "1.2"}]}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"Column", "[", 
                 RowBox[{"{", 
                  RowBox[{"\"\<vapor feed\>\"", ",", 
                   RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<V\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"V", ",", "2"}], "]"}], ",", "\"\< Mmol/h\>\""}], 
                    "}"}]}]}], "}"}], "]"}], ",", "17", ",", "colV"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{
                 RowBox[{"-", "h"}], "/", "4"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1.4"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"Row", "@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", "#2"}], 
                    "]"}], ",", "\"\< = \>\"", ",", "#1", ",", 
                    "\"\< ppm\>\""}], "}"}]}], ",", "17", ",", "colV", ",", 
                  RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "#3"}], "}"}]}], "]"}], "&"}], "@@@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"y1", ",", "1", ",", 
                 RowBox[{"h", "+", "2"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"yN1", ",", 
                 RowBox[{"n", "+", "1"}], ",", 
                 RowBox[{"-", "2"}]}], "}"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"Row", "@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", "#2"}], 
                    "]"}], ",", "\"\< = \>\"", ",", "#1", ",", 
                    "\"\< ppm\>\""}], "}"}]}], ",", "17", ",", "colL", ",", 
                  RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"w", ",", "#3"}], "}"}]}], "]"}], "&"}], "@@@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x0", ",", "0", ",", 
                 RowBox[{"h", "+", "2.25"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"NumberForm", "[", 
                  RowBox[{"xN", ",", "2"}], "]"}], ",", "n", ",", 
                 RowBox[{"-", "2"}]}], "}"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"Row", "@", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<L\>\"", ",", "Italic"}], "]"}], ",", 
                   "\"\</\>\"", ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<V\>\"", ",", "Italic"}], "]"}], ",", 
                   "\"\< = \>\"", ",", 
                   RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"L", "/", "V"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "0"}], "}"}]}], "]"}]}], "}"}]}], ",", 
                "17"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"w", "/", "2"}], ",", 
                RowBox[{"0.33", "*", "h"}]}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{"LoVmin", ",", "\[IndentingNewLine]", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(\>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<L\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\</\>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<V\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<)\>\""}], "}"}]}], ",", "\"\<min\>\""}], "]"}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"yeq", "[", "xeq", "]"}], "-", "y1"}], 
                    RowBox[{"xeq", "-", "x0"}]], ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "1"}], "}"}]}], "]"}]}], "}"}]}], ",", 
                    "17", ",", "Purple"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Row", "@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"yeq", "[", "check", "]"}], "<", "yN1"}], 
                    "\[And]", 
                    RowBox[{"check", ">", "0"}]}], ",", "\[Infinity]", ",", 
                    "n"}], "]"}], ",", "\"\< stages needed\>\""}], "}"}]}]}], 
                 "\[IndentingNewLine]", "]"}], ",", "17"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"w", "/", "2"}], ",", 
                RowBox[{"0.66", "*", "h"}]}], "}"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"230", ",", "370"}], "}"}]}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "w"}], "/", "2.13"}], ",", 
              RowBox[{"w", "+", 
               RowBox[{"w", "/", "2.3"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "h"}], "/", "5"}], ",", 
              RowBox[{"h", "+", 
               RowBox[{"h", "/", "7"}]}]}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotRangePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"None", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Scaled", "@", "0.15"}], ",", 
              RowBox[{"Scaled", "@", "0.2"}]}], "}"}]}], "}"}]}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"stages", "=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"w0", ",", "h0"}], "}"}], ",", 
         RowBox[{
          RowBox[{"w0", "=", "1"}], ";", 
          RowBox[{"h0", "=", "0.5"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Graphics", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Thick", ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"EdgeForm", "@", "Thick"}], ",", 
                RowBox[{"FaceForm", "@", "None"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Rectangle", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "#"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"w0", ",", 
                    RowBox[{"#", "+", "h0"}]}], "}"}]}], "]"}], "&"}], "/@", 
                 RowBox[{"Range", "@", "5"}]}]}], "}"}], ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Arrowheads", "@", "0.22"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"colV", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.25", "*", "w0"}], ",", 
                    RowBox[{"#", "-", "h0"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.25", "*", "w0"}], ",", "#"}], "}"}]}], "}"}], 
                    "]"}], "&"}], "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{"2", ",", "5"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Arrow", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"1", "-", "h0"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.25", "*", "w0"}], ",", 
                    RowBox[{"1", "-", "h0"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.25", "*", "w0"}], ",", "1"}], "}"}]}], "}"}], 
                   "]"}], ",", 
                  RowBox[{"Arrow", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.25", "*", "w0"}], ",", 
                    RowBox[{"6", "-", "h0"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.25", "*", "w0"}], ",", "6"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "0.1"}], "*", "w0"}], ",", "6"}], "}"}]}], 
                    "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"colL", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.75", "*", "w0"}], ",", "#"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.75", "*", "w0"}], ",", 
                    RowBox[{"#", "-", "h0"}]}], "}"}]}], "}"}], "]"}], "&"}], 
                   "/@", 
                   RowBox[{"Range", "[", 
                    RowBox[{"2", ",", "5"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Arrow", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.75", "*", "w0"}], ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.75", "*", "w0"}], ",", 
                    RowBox[{"1", "-", "h0"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1.1", "*", "w0"}], ",", 
                    RowBox[{"1", "-", "h0"}]}], "}"}]}], "}"}], "]"}], ",", 
                  RowBox[{"Arrow", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"w0", ",", "6"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.75", "*", "w0"}], ",", "6"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.75", "*", "w0"}], ",", 
                    RowBox[{"6", "-", "h0"}]}], "}"}]}], "}"}], "]"}]}], 
                 "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Text", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"n", "+", "1", "-", "#"}], ",", "17", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"0.5", "*", "w0"}], ",", 
                    RowBox[{
                    RowBox[{"0.5", "*", "h0"}], "+", "#"}]}], "}"}]}], "]"}], 
                "&"}], "/@", 
               RowBox[{"Range", "@", "5"}]}], ",", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Text", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
                    RowBox[{"6", "-", "#"}]}], "]"}], ",", "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"YN1", "@", 
                    RowBox[{"X", "[", "#", "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "0"}], "}"}]}], "]"}]}], "}"}]}], ",", 
                    "17", ",", "colV", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"0.25", "*", "w0"}], ",", 
                    RowBox[{"#", "+", "1", "-", 
                    RowBox[{"0.5", "*", "h0"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"1.2", ",", "0"}], "}"}]}], "]"}], "&"}], "/@", 
               RowBox[{"Range", "@", "4"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"Column", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"V", ",", "\"\< Mmol/h\>\""}], "}"}]}], ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", "1"}], 
                    "]"}], ",", "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"YN1", "@", 
                    RowBox[{"X", "[", "n", "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "0"}], "}"}]}], "]"}]}], "}"}]}]}], 
                    "}"}], ",", "Center"}], "]"}], ",", "17", ",", "colV"}], 
                 "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.25", "*", "w0"}], ",", 
                  RowBox[{"6", "-", 
                   RowBox[{"0.5", "*", "h0"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1.5", ",", 
                  RowBox[{"-", "0.75"}]}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"Column", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", "6"}], 
                    "]"}], ",", "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"YN1", "@", 
                    RowBox[{"X", "[", "0", "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "0"}], "}"}]}], "]"}]}], "}"}]}], ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"V", ",", "\"\< Mmol/h\>\""}], "}"}]}]}], "}"}], 
                    ",", "Center"}], "]"}], ",", "17", ",", "colV"}], "]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.25", "*", "w0"}], ",", "0.5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1.25", ",", "0.4"}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Text", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                    RowBox[{"6", "-", "#"}]}], "]"}], ",", "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"#", "-", "1"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "}"}]}], ",", 
                    "17", ",", "colL", ",", 
                    RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"0.75", "*", "w0"}], ",", 
                    RowBox[{"#", "-", 
                    RowBox[{"0.5", "*", "h0"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1.5"}], ",", "0"}], "}"}]}], "]"}], "&"}], "/@", 
               RowBox[{"Range", "[", 
                RowBox[{"2", ",", "5"}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"Column", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"L", ",", "\"\< Mmol/h\>\""}], "}"}]}], ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", "0"}], 
                    "]"}], ",", "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"X", "[", "n", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "}"}]}]}], 
                    "}"}], ",", "Center"}], "]"}], ",", "17", ",", "colL"}], 
                 "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"w0", ",", 
                  RowBox[{"6", "-", 
                   RowBox[{"0.5", "*", "h0"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", 
                  RowBox[{"-", "0.75"}]}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"Column", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", "n"}], 
                    "]"}], ",", "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"X", "[", "0", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "}"}]}], ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"L", ",", "\"\< Mmol/h\>\""}], "}"}]}]}], "}"}], 
                    ",", "Center"}], "]"}], ",", "17", ",", "colL"}], "]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"w0", ",", "0.5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "0.4"}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Arrowheads", "@", "0.22"}], ",", 
                RowBox[{"Which", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"tray", "\[Equal]", "5"}], ",", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"colV", ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"1", "-", "h0"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.25", "*", "w0"}], ",", 
                    RowBox[{"1", "-", "h0"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.25", "*", "w0"}], ",", "1"}], "}"}]}], "}"}], 
                    "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.25", "*", "w0"}], ",", 
                    RowBox[{"2", "-", "h0"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.25", "*", "w0"}], ",", "2"}], "}"}]}], "}"}], 
                    "]"}], ",", "\[IndentingNewLine]", "colL", ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.75", "*", "w0"}], ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.75", "*", "w0"}], ",", 
                    RowBox[{"1", "-", "h0"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1.1", "*", "w0"}], ",", 
                    RowBox[{"1", "-", "h0"}]}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.75", "*", "w0"}], ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.75", "*", "w0"}], ",", 
                    RowBox[{"2", "-", "h0"}]}], "}"}]}], "}"}], "]"}]}], 
                   "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"tray", "\[Equal]", "1"}], ",", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"colV", ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.25", "*", "w0"}], ",", 
                    RowBox[{"6", "-", "h0"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.25", "*", "w0"}], ",", "6"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "0.1"}], "*", "w0"}], ",", "6"}], "}"}]}], 
                    "}"}], "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.25", "*", "w0"}], ",", 
                    RowBox[{"5", "-", "h0"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.25", "*", "w0"}], ",", "5"}], "}"}]}], "}"}], 
                    "]"}], ",", "\[IndentingNewLine]", "colL", ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"w0", ",", "6"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.75", "*", "w0"}], ",", "6"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.75", "*", "w0"}], ",", 
                    RowBox[{"6", "-", "h0"}]}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.75", "*", "w0"}], ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.75", "*", "w0"}], ",", 
                    RowBox[{"5", "-", "h0"}]}], "}"}]}], "}"}], "]"}]}], 
                   "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"1", "<", "tray", "<", "5"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"colV", ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.25", "*", "w0"}], ",", 
                    RowBox[{
                    "n", "+", "1", "-", "tray", "+", "#", "-", "h0"}]}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.25", "*", "w0"}], ",", 
                    RowBox[{"n", "+", "1", "-", "tray", "+", "#"}]}], "}"}]}],
                     "}"}], "]"}], ",", "\[IndentingNewLine]", "colL", ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.75", "*", "w0"}], ",", 
                    RowBox[{"n", "+", "1", "-", "tray", "+", "#"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0.75", "*", "w0"}], ",", 
                    RowBox[{
                    "n", "+", "1", "-", "tray", "+", "#", "-", "h0"}]}], 
                    "}"}]}], "}"}], "]"}]}], "}"}], "&"}], "/@", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}]}], "\[IndentingNewLine]",
                  "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"EdgeForm", "@", 
                 RowBox[{"Thickness", "@", "0.05"}]}], ",", 
                RowBox[{"FaceForm", "@", 
                 RowBox[{"RGBColor", "[", 
                  RowBox[{"1", ",", "1", ",", "0.25"}], "]"}]}], ",", 
                RowBox[{"Rectangle", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"n", "+", "1", "-", "tray"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"w0", ",", 
                    RowBox[{"n", "+", "1", "-", "tray", "+", "h0"}]}], 
                   "}"}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"tray", ",", "17", ",", "Bold"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"0.5", "*", "w0"}], ",", 
                  RowBox[{
                   RowBox[{"0.5", "*", "h0"}], "+", "n", "+", "1", "-", 
                   "tray"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}],
             ",", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"230", ",", "370"}], "}"}]}], ",", 
            RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "6.6"}], "}"}]}], ",", 
            RowBox[{"PlotLabel", "\[Rule]", 
             RowBox[{"Style", "[", 
              RowBox[{
              "\"\<mole ratios are in ppm\>\"", ",", "17", ",", "Black"}], 
              "]"}]}]}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Grid", "@", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"plot", ",", 
          RowBox[{"If", "[", 
           RowBox[{"HTS", ",", "stages", ",", "column"}], "]"}]}], "}"}], 
        "}"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Grid", "@", 
    RowBox[{"{", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"yN1", ",", "100", ",", 
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{"\"\<inlet vapor mole ratio \>\"", ",", 
               RowBox[{"Subscript", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<N\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< + 1\>\""}], "}"}]}]}], "]"}], ",", 
               "\"\< (ppm)\>\""}], "}"}]}]}], "}"}], ",", "40", ",", "120", 
          ",", "1", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
          RowBox[{"Enabled", "\[Rule]", 
           RowBox[{"If", "[", 
            RowBox[{"HTS", ",", "False", ",", "True"}], "]"}]}]}], "}"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"T", ",", "25", ",", "\"\<temperature (\[Degree]C)\>\""}], 
           "}"}], ",", "10", ",", "80", ",", "5", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
          RowBox[{"Enabled", "\[Rule]", 
           RowBox[{"If", "[", 
            RowBox[{"HTS", ",", "False", ",", "True"}], "]"}]}]}], "}"}], 
        "]"}]}], "}"}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"Grid", "@", 
    RowBox[{"{", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"P", ",", "2.5", ",", "\"\<pressure (atm)\>\""}], "}"}], 
          ",", "1.5", ",", "3", ",", "0.1", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
          RowBox[{"Enabled", "\[Rule]", 
           RowBox[{"If", "[", 
            RowBox[{"HTS", ",", "False", ",", "True"}], "]"}]}]}], "}"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "L", ",", "100", ",", "\"\<solvent flow rate (Mmol/h)\>\""}], 
           "}"}], ",", "50", ",", "300", ",", "5", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
          RowBox[{"Enabled", "\[Rule]", 
           RowBox[{"If", "[", 
            RowBox[{"HTS", ",", "False", ",", "True"}], "]"}]}]}], "}"}], 
        "]"}]}], "}"}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"Grid", "@", 
    RowBox[{"{", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"\"\<mole ratios (ppm):\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"y1", ",", "10", ",", 
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{"\"\<outlet vapor \>\"", ",", 
               RowBox[{"Subscript", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", "1"}], 
                "]"}]}], "}"}]}]}], "}"}], ",", "10", ",", "25", ",", "1", 
          ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
          RowBox[{"Enabled", "\[Rule]", 
           RowBox[{"If", "[", 
            RowBox[{"HTS", ",", "False", ",", "True"}], "]"}]}]}], "}"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x0", ",", "0.05", ",", 
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{"\"\<inlet liquid \>\"", ",", 
               RowBox[{"Subscript", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", "0"}], 
                "]"}]}], "}"}]}]}], "}"}], ",", "0", ",", "0.25", ",", "0.01",
           ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
          RowBox[{"Enabled", "\[Rule]", 
           RowBox[{"If", "[", 
            RowBox[{"HTS", ",", "False", ",", "True"}], "]"}]}]}], "}"}], 
        "]"}]}], "}"}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"Grid", "@", 
    RowBox[{"{", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"LoVmin", ",", "False", ",", 
            RowBox[{"Subscript", "[", 
             RowBox[{
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{"\"\<(\>\"", ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<L\>\"", ",", "Italic"}], "]"}], ",", 
                 "\"\</\>\"", ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<V\>\"", ",", "Italic"}], "]"}], ",", 
                 "\"\<)\>\""}], "}"}]}], ",", "\"\<min\>\""}], "]"}]}], "}"}],
           ",", 
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}], ",", 
          RowBox[{"Enabled", "\[Rule]", 
           RowBox[{"If", "[", 
            RowBox[{"HTS", ",", "False", ",", "True"}], "]"}]}]}], "}"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "HTS", ",", "False", ",", "\"\<show diagram with 5 stages\>\""}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PaneSelector", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"True", "\[Rule]", 
           RowBox[{"Control", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"tray", ",", "1", ",", "\"\<stage\>\""}], "}"}], ",", 
              "1", ",", "5", ",", "1", ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"Dynamic", "@", "HTS"}]}], "]"}]}], "\[IndentingNewLine]", 
      "}"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7136221976186323`*^9, 3.7136223132162447`*^9}, {
   3.713626221745928*^9, 3.7136264127822666`*^9}, {3.713626444403849*^9, 
   3.71362662678164*^9}, {3.7136266604797087`*^9, 3.7136266614469104`*^9}, {
   3.7136267011058064`*^9, 3.713626723370408*^9}, {3.713626760480398*^9, 
   3.7136267642414103`*^9}, {3.713626886812995*^9, 3.713626889856906*^9}, {
   3.7136315433601775`*^9, 3.713631582413965*^9}, {3.713633560124503*^9, 
   3.713633563879321*^9}, {3.713637708942608*^9, 3.713637734883333*^9}, {
   3.713705799228575*^9, 3.713705885050229*^9}, {3.713706652653322*^9, 
   3.7137066652675934`*^9}, {3.7137067047049975`*^9, 3.713706707097802*^9}, {
   3.7137067687014627`*^9, 3.713706792865802*^9}, {3.713706849318711*^9, 
   3.713706850105713*^9}, {3.713706888785104*^9, 3.713706896745346*^9}, 
   3.7137069281261015`*^9, {3.713706983147584*^9, 3.7137070476779327`*^9}, {
   3.713707078601161*^9, 3.7137071763143063`*^9}, {3.713707211852286*^9, 
   3.7137072122110863`*^9}, {3.713707424050405*^9, 3.713707457180583*^9}, {
   3.7137077186468163`*^9, 3.7137077205980353`*^9}, {3.7137077908220015`*^9, 
   3.7137078268171835`*^9}, {3.7142418974111395`*^9, 3.714241919547209*^9}, {
   3.714309467759035*^9, 3.7143095299277883`*^9}, {3.714309772209843*^9, 
   3.7143098772868147`*^9}, {3.7143156085615025`*^9, 
   3.7143156241743884`*^9}, {3.714315656589164*^9, 3.714315749969239*^9}, {
   3.714315780252591*^9, 3.714315944179203*^9}, {3.714315991269453*^9, 
   3.7143160277120314`*^9}, {3.714316146532838*^9, 3.714316156266487*^9}, {
   3.714316195785871*^9, 3.714316209359326*^9}, {3.7143162569579887`*^9, 
   3.7143162584565916`*^9}, {3.714316374805513*^9, 3.7143164008504553`*^9}, {
   3.714316446017893*^9, 3.7143165046412196`*^9}, {3.7143165388943887`*^9, 
   3.714316570781759*^9}, {3.7143166126993604`*^9, 3.7143166364884844`*^9}, {
   3.714316667536251*^9, 3.714316735634591*^9}, {3.7143167764890027`*^9, 
   3.714316814818198*^9}, {3.714316852638997*^9, 3.7143169153753204`*^9}, {
   3.7143169601051426`*^9, 3.714317154880786*^9}, {3.714317187688157*^9, 
   3.714317252381678*^9}, {3.714317355315996*^9, 3.714317373113494*^9}, {
   3.714317555245036*^9, 3.7143175870662174`*^9}, {3.714317625101404*^9, 
   3.714317713986676*^9}, {3.7143178502543526`*^9, 3.7143178829679203`*^9}, {
   3.7143179656707315`*^9, 3.7143180334619694`*^9}, 3.714324605112314*^9, {
   3.714395070402301*^9, 3.7143951099945655`*^9}, {3.7143964365004373`*^9, 
   3.7143964575806427`*^9}, {3.7143965218703203`*^9, 
   3.7143965640337315`*^9}, {3.7143974517055035`*^9, 
   3.7143975774566965`*^9}, {3.714397611717656*^9, 3.7143977111083407`*^9}, {
   3.7143977516296587`*^9, 3.714397805317729*^9}, {3.714397883449198*^9, 
   3.714397977795594*^9}, {3.714398064205537*^9, 3.714398092225139*^9}, {
   3.714398638763854*^9, 3.7143987721557283`*^9}, {3.714398805539701*^9, 
   3.7143988060389023`*^9}, {3.714398845930108*^9, 3.7143988867339616`*^9}, {
   3.7143989188149505`*^9, 3.714398936301245*^9}, {3.714398978991464*^9, 
   3.7143991767584925`*^9}, {3.7143992115146604`*^9, 
   3.7143992271827393`*^9}, {3.714399263101719*^9, 3.7143994978436546`*^9}, {
   3.7143995507547283`*^9, 3.7143995988321595`*^9}, {3.7143997410487137`*^9, 
   3.7143998706638174`*^9}, {3.714399904655985*^9, 3.714400073343639*^9}, {
   3.714400105800228*^9, 3.7144001378857985`*^9}, {3.7144004003352966`*^9, 
   3.7144004714339466`*^9}, {3.7144005344348793`*^9, 
   3.7144007379393783`*^9}, {3.7144007771869955`*^9, 
   3.7144008248832417`*^9}, {3.7144008578600144`*^9, 3.71440086089542*^9}, {
   3.714400962028524*^9, 3.714401010931158*^9}, {3.7144010726070766`*^9, 
   3.714401168957157*^9}, {3.714401202095129*^9, 3.7144013315990067`*^9}, {
   3.714401403292599*^9, 3.714401443561016*^9}, {3.7144018231284323`*^9, 
   3.7144018246262503`*^9}, {3.7144018649784517`*^9, 3.714402053177017*^9}, {
   3.7144021653622036`*^9, 3.714402170524231*^9}, {3.7144026317166843`*^9, 
   3.7144026977092104`*^9}, {3.7144027396538267`*^9, 
   3.7144029004870296`*^9}, {3.714409054203708*^9, 3.714409114476016*^9}, {
   3.7144105026329775`*^9, 3.7144105599740667`*^9}, {3.7144118850457697`*^9, 
   3.714411979727652*^9}, {3.7144131198786793`*^9, 3.7144131600964775`*^9}, {
   3.7144138319937525`*^9, 3.7144138502764506`*^9}, {3.714414413619357*^9, 
   3.7144144275000324`*^9}, 3.71441448682675*^9, {3.7144171730040665`*^9, 
   3.7144171737198706`*^9}, {3.714483266397855*^9, 3.714483553465274*^9}, {
   3.7144838936457314`*^9, 3.7144839715111847`*^9}, {3.7144840065201874`*^9, 
   3.71448401408062*^9}, 3.7144851610121036`*^9, {3.7144851939646897`*^9, 
   3.7144853965711718`*^9}, {3.714485449083093*^9, 3.7144857943443055`*^9}, {
   3.7144858352229176`*^9, 3.7144859557433805`*^9}, {3.7144860823544292`*^9, 
   3.7144861854648013`*^9}, {3.7144863030676465`*^9, 3.714486332098815*^9}, {
   3.714500866198888*^9, 3.714500954431777*^9}, {3.714500996896186*^9, 
   3.714501066168365*^9}, {3.714501882524223*^9, 3.714502024698378*^9}, {
   3.714749411328501*^9, 3.714749411714903*^9}, {3.714829051400626*^9, 
   3.7148290558408804`*^9}, {3.714829089510806*^9, 3.714829272061247*^9}, {
   3.714829313564621*^9, 3.714829470182579*^9}, {3.7148295374914293`*^9, 
   3.714829597409856*^9}, {3.714829629263678*^9, 3.7148296441015267`*^9}, {
   3.714829694439406*^9, 3.7148297975333023`*^9}, {3.7148298296441393`*^9, 
   3.7148299256976333`*^9}, {3.714830059417857*^9, 3.714830489861827*^9}, {
   3.7148305198625765`*^9, 3.7148305204085774`*^9}, {3.7148305507879305`*^9, 
   3.7148307594213934`*^9}, {3.7148308176560936`*^9, 
   3.7148313900103765`*^9}, {3.7148314233281517`*^9, 
   3.7148315853333597`*^9}, {3.714831620467937*^9, 3.714831635239611*^9}, {
   3.7148317061889634`*^9, 3.71483188848989*^9}, {3.7148319488313866`*^9, 
   3.714831956980218*^9}, {3.7148325641566205`*^9, 3.714832564816628*^9}, {
   3.7148371351936445`*^9, 3.714837141263672*^9}, {3.714843698913702*^9, 
   3.7148437027235184`*^9}, {3.714845058630097*^9, 3.7148450794576035`*^9}, {
   3.714845110214366*^9, 3.714845253913475*^9}, {3.7148463256360364`*^9, 
   3.714846332935082*^9}, {3.7148463636666317`*^9, 3.714846407817857*^9}, {
   3.7148471940771914`*^9, 3.714847194717792*^9}, {3.714847234017391*^9, 
   3.714847270707966*^9}, {3.7149130516253147`*^9, 3.7149130529153886`*^9}, {
   3.714914817855172*^9, 3.7149148184957733`*^9}, {3.714922743343567*^9, 
   3.714922744436569*^9}, {3.7149227804367476`*^9, 3.714922784962372*^9}, {
   3.7149228172217455`*^9, 3.7149231713109217`*^9}, {3.7154505711088066`*^9, 
   3.715450646609991*^9}, {3.7154517520706277`*^9, 3.7154517664363003`*^9}, {
   3.7155174399932756`*^9, 3.71551752347305*^9}, {3.7155193931746745`*^9, 
   3.7155194484891267`*^9}, {3.715519499640915*^9, 3.715519606771754*^9}, {
   3.715519642288025*^9, 3.7155196637021775`*^9}, {3.715519721569418*^9, 
   3.7155199435444965`*^9}, 3.715520117683259*^9, {3.7155201522487354`*^9, 
   3.7155202685974274`*^9}, {3.715520484836212*^9, 3.7155205643004117`*^9}, {
   3.715520597091381*^9, 3.715520816221084*^9}, {3.7155208624175334`*^9, 
   3.7155208879722667`*^9}, {3.7155209307000694`*^9, 3.7155209677496653`*^9}, 
   3.715521015977105*^9, {3.7155222563904657`*^9, 3.715522257014467*^9}, {
   3.715610607846635*^9, 3.7156106089728374`*^9}, {3.715696894696198*^9, 
   3.715696895086199*^9}, {3.7157028650960007`*^9, 3.7157029020159807`*^9}, {
   3.715951285278155*^9, 3.7159513295614395`*^9}, {3.715951400001465*^9, 
   3.7159514656604753`*^9}, {3.7159515128217683`*^9, 
   3.7159515448877783`*^9}, {3.7159681878699408`*^9, 
   3.7159682792274046`*^9}, {3.73418549145673*^9, 3.734185494057353*^9}, {
   3.7341855260542603`*^9, 3.734185570391344*^9}, {3.7341856047493563`*^9, 
   3.7341856343534107`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"85909ef7-6667-4d2d-9fd5-a413d70132db"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`HTS$$ = False, $CellContext`L$$ = 
    100, $CellContext`LoVmin$$ = False, $CellContext`P$$ = 
    2.5, $CellContext`T$$ = 25, $CellContext`tray$$ = 1, $CellContext`x0$$ = 
    0.05, $CellContext`y1$$ = 10, $CellContext`yN1$$ = 100, Typeset`show$$ = 
    True, Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`yN1$$], 100, 
       Row[{"inlet vapor mole ratio ", 
         Subscript[
          Style["y", Italic], 
          Row[{
            Style["N", Italic], " + 1"}]], " (ppm)"}]}, 40, 120, 1}, {{
       Hold[$CellContext`T$$], 25, "temperature (\[Degree]C)"}, 10, 80, 5}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], 
          Manipulate`Place[2]}}]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`P$$], 2.5, "pressure (atm)"}, 1.5, 3, 0.1}, {{
       Hold[$CellContext`L$$], 100, "solvent flow rate (Mmol/h)"}, 50, 300, 
      5}, {
      Hold[
       Grid[{{
          Manipulate`Place[3], 
          Manipulate`Place[4]}}]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`y1$$], 10, 
       Row[{"outlet vapor ", 
         Subscript[
          Style["y", Italic], 1]}]}, 10, 25, 1}, {{
       Hold[$CellContext`x0$$], 0.05, 
       Row[{"inlet liquid ", 
         Subscript[
          Style["x", Italic], 0]}]}, 0, 0.25, 0.01}, {
      Hold[
       Grid[{{"mole ratios (ppm):", 
          Manipulate`Place[5], 
          Manipulate`Place[6]}}]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`LoVmin$$], False, 
       Subscript[
        Row[{"(", 
          Style["L", Italic], "/", 
          Style["V", Italic], ")"}], "min"]}, {True, False}}, {{
       Hold[$CellContext`HTS$$], False, "show diagram with 5 stages"}, {
      True, False}}, {{
       Hold[$CellContext`tray$$], 1, "stage"}, 1, 5, 1}, {
      Hold[
       Grid[{{
          Manipulate`Place[7], 
          Manipulate`Place[8], 
          Spacer[10], 
          PaneSelector[{True -> Manipulate`Place[9]}, 
           Dynamic[$CellContext`HTS$$]]}}]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    608., {182., 188.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`yN1$25736$$ = 
    0, $CellContext`T$25737$$ = 0, $CellContext`P$25738$$ = 
    0, $CellContext`L$25739$$ = 0, $CellContext`y1$25740$$ = 
    0, $CellContext`x0$25741$$ = 0, $CellContext`LoVmin$25742$$ = 
    False, $CellContext`HTS$25743$$ = False, $CellContext`tray$25744$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`HTS$$ = False, $CellContext`L$$ = 
        100, $CellContext`LoVmin$$ = False, $CellContext`P$$ = 
        2.5, $CellContext`T$$ = 25, $CellContext`tray$$ = 
        1, $CellContext`x0$$ = 0.05, $CellContext`y1$$ = 
        10, $CellContext`yN1$$ = 100}, "ControllerVariables" :> {
        Hold[$CellContext`yN1$$, $CellContext`yN1$25736$$, 0], 
        Hold[$CellContext`T$$, $CellContext`T$25737$$, 0], 
        Hold[$CellContext`P$$, $CellContext`P$25738$$, 0], 
        Hold[$CellContext`L$$, $CellContext`L$25739$$, 0], 
        Hold[$CellContext`y1$$, $CellContext`y1$25740$$, 0], 
        Hold[$CellContext`x0$$, $CellContext`x0$25741$$, 0], 
        Hold[$CellContext`LoVmin$$, $CellContext`LoVmin$25742$$, False], 
        Hold[$CellContext`HTS$$, $CellContext`HTS$25743$$, False], 
        Hold[$CellContext`tray$$, $CellContext`tray$25744$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`Ea$, $CellContext`R$, $CellContext`T0$, \
$CellContext`H0$, $CellContext`HB$, $CellContext`V$, $CellContext`YN1$, \
$CellContext`yeq$, $CellContext`xeq$, $CellContext`check$, \
$CellContext`yLVmin$, $CellContext`xN$, $CellContext`X$, $CellContext`Y$, \
$CellContext`n0$, $CellContext`n$, $CellContext`colL$, $CellContext`colV$, \
$CellContext`h$, $CellContext`w$, $CellContext`ry$, $CellContext`tank$, \
$CellContext`plot$, $CellContext`column$, $CellContext`stages$}, 
        If[$CellContext`HTS$$, {$CellContext`yN1$$ = 59; $CellContext`T$$ = 
            25; $CellContext`P$$ = 2.5; $CellContext`L$$ = 
            100; $CellContext`y1$$ = 10; $CellContext`x0$$ = 
            0.05; $CellContext`LoVmin$$ = False; Null}]; $CellContext`Ea$ = 
         5000; $CellContext`R$ = 8.314; $CellContext`T0$ = 
         298; $CellContext`H0$ = 
         211.19; $CellContext`HB$ = $CellContext`H0$ 
          Exp[(-($CellContext`Ea$/$CellContext`R$)) (
             1/($CellContext`T$$ + 273) - 
             1/$CellContext`T0$)]; $CellContext`V$ = 1; $CellContext`YN1$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := ($CellContext`L$$/$CellContext`V$) ($CellContext`x$ - \
$CellContext`x0$$) + $CellContext`y1$$; $CellContext`yeq$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := ($CellContext`HB$/$CellContext`P$$) $CellContext`x$; \
$CellContext`xeq$ = ReplaceAll[$CellContext`x, 
           Quiet[
            Part[
             
             Solve[$CellContext`yeq$[$CellContext`x] == $CellContext`yN1$$, \
$CellContext`x], 1]]]; $CellContext`check$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yeq$[$CellContext`x] == \
$CellContext`YN1$[$CellContext`x], $CellContext`x], 1]]; $CellContext`yLVmin$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yeq$[$CellContext`xeq$] - \
$CellContext`y1$$)/($CellContext`xeq$ - $CellContext`x0$$)) ($CellContext`x$ - \
$CellContext`x0$$) + $CellContext`y1$$; $CellContext`xN$ = \
($CellContext`yN1$$ - $CellContext`y1$$)/($CellContext`L$$/$CellContext`V$) + \
$CellContext`x0$$; $CellContext`X$[0] = $CellContext`xN$; $CellContext`Y$[
          0] = $CellContext`yeq$[$CellContext`xN$]; 
        Do[{$CellContext`X$[$CellContext`i] = ReplaceAll[$CellContext`x, 
             Quiet[
              Part[
               
               Solve[$CellContext`YN1$[$CellContext`x] == \
$CellContext`Y$[$CellContext`i - 1], $CellContext`x], 
               1]]], $CellContext`Y$[$CellContext`i] = $CellContext`yeq$[
             $CellContext`X$[$CellContext`i]]}, {$CellContext`i, 1, 
           50}]; $CellContext`n0$ = DeleteCases[
           Map[If[$CellContext`X$[#] < $CellContext`x0$$, 0, #]& , 
            Range[50]], 0]; $CellContext`n$ = 
         If[Length[$CellContext`n0$] == 0, 1, 1 + 
           Part[$CellContext`n0$, -1]]; $CellContext`colV$ = 
         RGBColor[0, 0.5, 0]; $CellContext`colL$ = 
         RGBColor[0, 0, 0.75]; $CellContext`h$ = 13; $CellContext`w$ = 
         12; $CellContext`ry$ = 2; $CellContext`tank$ = Graphics[{Thick, 
            Map[
            Line[{{#, $CellContext`ry$}, {#, $CellContext`h$ - \
$CellContext`ry$}}]& , {0, $CellContext`w$}], 
            
            Circle[{$CellContext`w$/2, $CellContext`ry$}, {$CellContext`w$/
              2, $CellContext`ry$}, {Pi, 2 Pi}], 
            
            Circle[{$CellContext`w$/
              2, $CellContext`h$ - $CellContext`ry$}, {$CellContext`w$/
              2, $CellContext`ry$}, {0, Pi}], {
             Arrowheads[0.1], $CellContext`colV$, 
             
             Arrow[{{(-$CellContext`w$)/2, (-$CellContext`h$)/4}, {
               0.25 $CellContext`w$, (-$CellContext`h$)/4}, {
               0.25 $CellContext`w$, $CellContext`ry$/10}}], 
             
             Arrow[{{0.25 $CellContext`w$, $CellContext`h$ - $CellContext`ry$/
                10}, {0.25 $CellContext`w$, $CellContext`h$ + $CellContext`h$/
                 4}, {(-$CellContext`w$)/
                2, $CellContext`h$ + $CellContext`h$/4}}], $CellContext`colL$, 
             
             Arrow[{{0.75 $CellContext`w$, $CellContext`ry$/10}, {
               0.75 $CellContext`w$, (-$CellContext`h$)/
                4}, {$CellContext`w$ + $CellContext`w$/
                 2.3, (-$CellContext`h$)/4}}], 
             
             Arrow[{{$CellContext`w$ + $CellContext`w$/
                 2.3, $CellContext`h$ + $CellContext`h$/4}, {
               0.75 $CellContext`w$, $CellContext`h$ + $CellContext`h$/4}, {
               0.75 $CellContext`w$, $CellContext`h$ - $CellContext`ry$/
                10}}]}}, ImageSize -> {230, 390}, AspectRatio -> Full, 
           PlotRange -> {{(-$CellContext`w$)/
              2.13, $CellContext`w$ + $CellContext`w$/
               2.3}, {(-$CellContext`h$)/
              5, $CellContext`h$ + $CellContext`h$/7}}, 
           PlotRangePadding -> {None, {
              Scaled[0.15], 
              Scaled[0.17]}}]; $CellContext`plot$ = Plot[{
            $CellContext`YN1$[$CellContext`x], 
            $CellContext`yeq$[$CellContext`x]}, {$CellContext`x, 
            0, $CellContext`xeq$}, PlotStyle -> {{Thick, 
              If[$CellContext`LoVmin$$, Transparent, Magenta]}, {Thick, 
              RGBColor[1, 0.4, 0]}}, PlotRange -> {0, $CellContext`yN1$$ + 5},
            PlotRangePadding -> None, PlotRangeClipping -> False, Frame -> 
           True, FrameLabel -> {
             Row[{"solute/(solute-free liquid) ", 
               Style["x", Italic], " (ppm)"}], 
             Row[{"solute/(solute-free vapor) ", 
               Style["y", Italic], " (ppm)"}]}, LabelStyle -> {17, Black}, 
           ImageSize -> {370, 370}, AspectRatio -> Full, 
           ImagePadding -> {{55, 25}, {50, 5}}, Epilog -> {Thick, 
             If[$CellContext`LoVmin$$, {Thick, Magenta, 
               Line[{{0, 
                  $CellContext`yLVmin$[0]}, {$CellContext`xeq$, 
                  $CellContext`yLVmin$[$CellContext`xeq$]}}]}, 
              If[
               
               And[$CellContext`yeq$[$CellContext`check$] < \
$CellContext`yN1$$, $CellContext`check$ > 0], 
               Text[
                Framed[
                 Column[{
                   Style["separation not possible", 20, 
                    RGBColor[0.85, 0, 0]], 
                   Style["\[Star]infinite stages needed\[Star]", 17]}, 
                  Center], Background -> White], {
                0.55 $CellContext`xeq$, 0.6 $CellContext`yN1$$}], {
                Map[Line[{{
                    $CellContext`X$[# - 1], 
                    $CellContext`Y$[# - 1]}, {
                    $CellContext`X$[#], 
                    $CellContext`Y$[# - 1]}, {
                    $CellContext`X$[#], 
                    $CellContext`Y$[#]}}]& , 
                 Range[$CellContext`n$ - 1]], 
                Line[{{
                   $CellContext`X$[0], 
                   $CellContext`Y$[0]}, {
                   $CellContext`X$[0], 
                   $CellContext`YN1$[$CellContext`xN$]}}], 
                Line[{{
                   $CellContext`X$[$CellContext`n$ - 1], 
                   $CellContext`Y$[$CellContext`n$ - 1]}, {$CellContext`x0$$, 
                   $CellContext`Y$[$CellContext`n$ - 1]}}], 
                If[$CellContext`HTS$$ == False, {
                  If[$CellContext`n$ < 30, 
                   Map[Text[
                    Style[
                    Row[{" ", $CellContext`n$ + 1 - #, " "}], 17, Background -> 
                    White], {
                    $CellContext`X$[# - 1], 
                    $CellContext`Y$[# - 1]}, {-1, 1}]& , 
                    Range[
                    If[$CellContext`n$ <= 8, $CellContext`n$, 8]]]], 
                  If[$CellContext`n$ > 8, 
                   Text[
                    Style[
                    Row[{" ", 1, " "}], 17, Background -> White], {
                    $CellContext`X$[$CellContext`n$ - 1], 
                    $CellContext`Y$[$CellContext`n$ - 1]}, {-1, 
                    1}]], {$CellContext`colL$, Dashed, 
                   
                   Line[{{$CellContext`x0$$, $CellContext`y1$$}, \
{$CellContext`x0$$, 0}}], $CellContext`colV$, 
                   Line[{{
                    0, $CellContext`y1$$}, {$CellContext`x0$$, \
$CellContext`y1$$}}]}, 
                  Text[
                   Style[
                    Subscript[
                    Style["y", Italic], 1], 17, $CellContext`colV$, 
                    Background -> White], {0, $CellContext`y1$$}, {1.2, 0}], 
                  Text[
                   Style[
                    Subscript[
                    Style["x", Italic], 0], 17, $CellContext`colL$, 
                    Background -> White], {$CellContext`x0$$, 0}, {0, 1.2}], {
                   PointSize[0.025], $CellContext`colL$, 
                   Point[{$CellContext`x0$$, 0}], $CellContext`colV$, 
                   Point[{0, $CellContext`y1$$}], $CellContext`colL$, 
                   Point[{$CellContext`xN$, 
                    $CellContext`yeq$[$CellContext`xN$]}]}, {
                  Dashed, $CellContext`colL$, 
                   Line[{{$CellContext`xN$, 0}, {$CellContext`xN$, 
                    $CellContext`yeq$[$CellContext`xN$]}}], 
                   Text[
                    Framed[
                    Style[
                    Subscript["x", $CellContext`n$], 18, Italic], Background -> 
                    White, FrameStyle -> None, FrameMargins -> 
                    Tiny], {$CellContext`xN$, 0.25 $CellContext`yN1$$}]}}], {
                Dashed, $CellContext`colV$, 
                 
                 Line[{{0, $CellContext`yN1$$}, {$CellContext`xeq$, \
$CellContext`yN1$$}}], 
                 Text[
                  Framed[
                   Style[
                    Subscript[
                    Style["y", Italic], $CellContext`n$ + 1], 18], Background -> 
                   White, FrameStyle -> None, FrameMargins -> Tiny], {
                  0.15, $CellContext`yN1$$}]}, 
                If[$CellContext`HTS$$, {
                  PointSize[0.025], {$CellContext`colL$, 
                   Map[Point[{
                    $CellContext`X$[#], 
                    $CellContext`yeq$[
                    $CellContext`X$[#]]}]& , 
                    Range[0, $CellContext`n$ - 1]], 
                   Point[{$CellContext`x0$$, 0}]}, {$CellContext`colV$, 
                   Map[Point[{
                    $CellContext`X$[#], 
                    $CellContext`YN1$[
                    $CellContext`X$[#]]}]& , 
                    Range[0, $CellContext`n$]]}, 
                  Map[Text[
                    Style[
                    Row[{$CellContext`n$ + 1 - #, ", ", 
                    Style[
                    Subscript[
                    Style["x", Italic], $CellContext`n$ + 
                    1 - #], $CellContext`colL$], ", ", 
                    Style[
                    Subscript[
                    Style["y", Italic], $CellContext`n$ + 
                    1 - #], $CellContext`colV$]}], 17], {
                    $CellContext`X$[# - 1], 
                    $CellContext`yeq$[
                    $CellContext`X$[# - 1]]}, {-1.2, 1}]& , 
                   Range[$CellContext`n$]], 
                  Text[
                   Style[
                    Subscript[
                    Style["x", Italic], 0], 
                    17, $CellContext`colL$], {$CellContext`x0$$, 
                    0}, {-1.2, -1}], 
                  Text[
                   Style[
                    Row[{
                    Style[
                    Subscript["y", "n"], Italic, $CellContext`colV$], 
                    " is in equilibrium with ", 
                    Style[
                    Subscript["x", "n"], Italic, $CellContext`colL$]}], 17], {
                   0.4, 3}], 
                  Text[
                   Style[
                    Column[{
                    Row[{"stage ", $CellContext`tray$$, " solute fluxes:"}], 
                    Column[{
                    Row[{"in: ", 
                    
                    NumberForm[$CellContext`X$[$CellContext`n$ + 
                    1 - $CellContext`tray$$] $CellContext`L$$ + \
$CellContext`YN1$[
                    $CellContext`X$[$CellContext`n$ + 1 - $CellContext`tray$$ - 
                    1]] $CellContext`V$, {4, 1}], " mol/h"}], 
                    Row[{"out: ", 
                    
                    NumberForm[$CellContext`X$[$CellContext`n$ + 
                    1 - $CellContext`tray$$ - 
                    1] $CellContext`L$$ + $CellContext`YN1$[
                    $CellContext`X$[$CellContext`n$ + 
                    1 - $CellContext`tray$$]] $CellContext`V$, {4, 1}], 
                    " mol/h"}]}, Alignment -> ":"]}, Center], 17], {0.2, 48}], 
                  Text[
                   Style["top", 17, Background -> White], {0.04, 6}], 
                  Text[
                   Style["bottom", 17, Background -> White], {0.63, 
                   61.1}]}]}]], 
             Mouseover[{Transparent, 
               Thickness[0.04], 
               CapForm[None], 
               If[$CellContext`LoVmin$$, 
                Line[{{0, 
                   $CellContext`yLVmin$[0]}, {$CellContext`xeq$, 
                   $CellContext`yLVmin$[$CellContext`xeq$]}}], 
                Line[
                 Map[{#, 
                   $CellContext`YN1$[#]}& , 
                  Range[0, $CellContext`xeq$, 0.01]]]]}, {
               Thickness[0.02], Magenta, 
               If[$CellContext`LoVmin$$, 
                Line[{{0, 
                   $CellContext`yLVmin$[0]}, {$CellContext`xeq$, 
                   $CellContext`yLVmin$[$CellContext`xeq$]}}], 
                Line[
                 Map[{#, 
                   $CellContext`YN1$[#]}& , 
                  Range[0, 
                   ReplaceAll[$CellContext`x, 
                    Part[
                    
                    Solve[$CellContext`YN1$[$CellContext`x] == \
$CellContext`yN1$$ + 5, $CellContext`x], 1]], 0.01]]]], 
               Text[
                Style[
                 Column[{"operating line", "(mass balance)"}, Center], 17, 
                 Magenta], 
                If[$CellContext`HTS$$, {
                 0.75 $CellContext`xeq$, 0.25 $CellContext`yN1$$}, {
                 0.25 $CellContext`xeq$, 0.7 $CellContext`yN1$$}]]}], 
             Mouseover[{Transparent, 
               Thickness[0.04], 
               CapForm[None], 
               Line[
                Map[{#, 
                  $CellContext`yeq$[#]}& , 
                 Range[0, $CellContext`xeq$, 0.01]]]}, {
               Thickness[0.02], 
               RGBColor[1, 0.4, 0], 
               Line[
                Map[{#, 
                  $CellContext`yeq$[#]}& , 
                 Range[0, $CellContext`xeq$, 0.01]]], 
               Text[
                Style["equilibrium line", 17, 
                 RGBColor[1, 0.4, 0]], 
                
                If[$CellContext`HTS$$, {
                 0.75 $CellContext`xeq$, 0.25 $CellContext`yN1$$}, {
                 0.25 $CellContext`xeq$, 
                  0.7 $CellContext`yN1$$}]]}]}]; $CellContext`column$ = 
         Show[$CellContext`tank$, Epilog -> {Thick, 
             Text[
              Style[
               Column[{"liquid solvent feed", 
                 Row[{
                   Style["L", Italic], " = ", 
                   NumberForm[$CellContext`L$$, {4, 0}], " Mmol/h"}]}, Right],
                17, $CellContext`colL$], {$CellContext`w$, $CellContext`h$ + \
$CellContext`h$/4}, {0.2, -1.2}], 
             Text[
              Style[
               Column[{"vapor feed", 
                 Row[{
                   Style["V", Italic], " = ", 
                   NumberForm[$CellContext`V$, 2], " Mmol/h"}]}], 
               17, $CellContext`colV$], {0, (-$CellContext`h$)/4}, {0, 1.4}], 
             Apply[Text[
               Style[
                Row[{
                  Subscript[
                   Style["y", Italic], #2], " = ", #, " ppm"}], 
                17, $CellContext`colV$, Background -> White], {
               0, #3}]& , {{$CellContext`y1$$, 1, $CellContext`h$ + 
                2}, {$CellContext`yN1$$, $CellContext`n$ + 1, -2}}, {1}], 
             Apply[Text[
               Style[
                Row[{
                  Subscript[
                   Style["x", Italic], #2], " = ", #, " ppm"}], 
                17, $CellContext`colL$, Background -> 
                White], {$CellContext`w$, #3}]& , {{$CellContext`x0$$, 
                0, $CellContext`h$ + 2.25}, {
                NumberForm[$CellContext`xN$, 2], $CellContext`n$, -2}}, {1}], 
             Text[
              Style[
               Row[{
                 Style["L", Italic], "/", 
                 Style["V", Italic], " = ", 
                 NumberForm[$CellContext`L$$/$CellContext`V$, {4, 0}]}], 
               17], {$CellContext`w$/2, 0.33 $CellContext`h$}], 
             Text[
              Style[
               If[$CellContext`LoVmin$$, 
                Style[
                 Row[{
                   Subscript[
                    Row[{"(", 
                    Style["L", Italic], "/", 
                    Style["V", Italic], ")"}], "min"], " = ", 
                   
                   NumberForm[($CellContext`yeq$[$CellContext`xeq$] - \
$CellContext`y1$$)/($CellContext`xeq$ - $CellContext`x0$$), {5, 1}]}], 17, 
                 Purple], 
                Row[{
                  If[
                   
                   And[$CellContext`yeq$[$CellContext`check$] < \
$CellContext`yN1$$, $CellContext`check$ > 0], Infinity, $CellContext`n$], 
                  " stages needed"}]], 17], {$CellContext`w$/2, 
               0.66 $CellContext`h$}]}, ImageSize -> {230, 370}, AspectRatio -> 
           Full, PlotRange -> {{(-$CellContext`w$)/
              2.13, $CellContext`w$ + $CellContext`w$/
               2.3}, {(-$CellContext`h$)/
              5, $CellContext`h$ + $CellContext`h$/7}}, 
           PlotRangePadding -> {None, {
              Scaled[0.15], 
              Scaled[0.2]}}]; $CellContext`stages$ = 
         Module[{$CellContext`w0$, $CellContext`h0$}, $CellContext`w0$ = 
            1; $CellContext`h0$ = 0.5; Graphics[{Thick, {
               EdgeForm[Thick], 
               FaceForm[None], 
               Map[
               Rectangle[{0, #}, {$CellContext`w0$, # + $CellContext`h0$}]& , 
                Range[5]]}, {
               Arrowheads[0.22], {$CellContext`colV$, 
                Map[
                Arrow[{{0.25 $CellContext`w0$, # - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, #}}]& , 
                 Range[2, 5]], 
                
                Arrow[{{0, 1 - $CellContext`h0$}, {
                  0.25 $CellContext`w0$, 1 - $CellContext`h0$}, {
                  0.25 $CellContext`w0$, 1}}], 
                
                Arrow[{{0.25 $CellContext`w0$, 6 - $CellContext`h0$}, {
                  0.25 $CellContext`w0$, 6}, {(-0.1) $CellContext`w0$, 
                   6}}]}, {$CellContext`colL$, 
                Map[
                Arrow[{{0.75 $CellContext`w0$, #}, {
                   0.75 $CellContext`w0$, # - $CellContext`h0$}}]& , 
                 Range[2, 5]], 
                
                Arrow[{{0.75 $CellContext`w0$, 1}, {
                  0.75 $CellContext`w0$, 1 - $CellContext`h0$}, {
                  1.1 $CellContext`w0$, 1 - $CellContext`h0$}}], 
                
                Arrow[{{$CellContext`w0$, 6}, {0.75 $CellContext`w0$, 6}, {
                  0.75 $CellContext`w0$, 6 - $CellContext`h0$}}]}}, 
              Map[Text[
                Style[$CellContext`n$ + 1 - #, 17, Background -> White], {
                0.5 $CellContext`w0$, 0.5 $CellContext`h0$ + #}]& , 
               Range[5]], 
              Map[Text[
                Style[
                 Row[{
                   Subscript[
                    Style["y", Italic], 6 - #], " = ", 
                   NumberForm[
                    $CellContext`YN1$[
                    $CellContext`X$[#]], {2, 0}]}], 17, $CellContext`colV$, 
                 Background -> White], {
                0.25 $CellContext`w0$, # + 1 - 0.5 $CellContext`h0$}, {
                1.2, 0}]& , 
               Range[4]], 
              Text[
               Style[
                Column[{
                  Row[{$CellContext`V$, " Mmol/h"}], 
                  Row[{
                    Subscript[
                    Style["y", Italic], 1], " = ", 
                    NumberForm[
                    $CellContext`YN1$[
                    $CellContext`X$[$CellContext`n$]], {2, 0}]}]}, Center], 
                17, $CellContext`colV$], {
               0.25 $CellContext`w0$, 6 - 0.5 $CellContext`h0$}, {
               1.5, -0.75}], 
              Text[
               Style[
                Column[{
                  Row[{
                    Subscript[
                    Style["y", Italic], 6], " = ", 
                    NumberForm[
                    $CellContext`YN1$[
                    $CellContext`X$[0]], {2, 0}]}], 
                  Row[{$CellContext`V$, " Mmol/h"}]}, Center], 
                17, $CellContext`colV$], {0.25 $CellContext`w0$, 0.5}, {1.25, 
               0.4}], 
              Map[Text[
                Style[
                 Row[{
                   Subscript[
                    Style["x", Italic], 6 - #], " = ", 
                   NumberForm[
                    $CellContext`X$[# - 1], {2, 2}]}], 17, $CellContext`colL$,
                  Background -> White], {
                0.75 $CellContext`w0$, # - 0.5 $CellContext`h0$}, {-1.5, 
                 0}]& , 
               Range[2, 5]], 
              Text[
               Style[
                Column[{
                  Row[{$CellContext`L$$, " Mmol/h"}], 
                  Row[{
                    Subscript[
                    Style["x", Italic], 0], " = ", 
                    NumberForm[
                    $CellContext`X$[$CellContext`n$], {2, 2}]}]}, Center], 
                17, $CellContext`colL$], {$CellContext`w0$, 6 - 
                0.5 $CellContext`h0$}, {-1, -0.75}], 
              Text[
               Style[
                Column[{
                  Row[{
                    Subscript[
                    Style["x", Italic], $CellContext`n$], " = ", 
                    NumberForm[
                    $CellContext`X$[0], {2, 2}]}], 
                  Row[{$CellContext`L$$, " Mmol/h"}]}, Center], 
                17, $CellContext`colL$], {$CellContext`w0$, 0.5}, {-1, 0.4}], {
               Arrowheads[0.22], 
               Which[$CellContext`tray$$ == 5, {$CellContext`colV$, 
                 
                 Arrow[{{0, 1 - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, 1 - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, 1}}], 
                 
                 Arrow[{{0.25 $CellContext`w0$, 2 - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, 2}}], $CellContext`colL$, 
                 
                 Arrow[{{0.75 $CellContext`w0$, 1}, {
                   0.75 $CellContext`w0$, 1 - $CellContext`h0$}, {
                   1.1 $CellContext`w0$, 1 - $CellContext`h0$}}], 
                 
                 Arrow[{{0.75 $CellContext`w0$, 2}, {
                   0.75 $CellContext`w0$, 
                    2 - $CellContext`h0$}}]}, $CellContext`tray$$ == 
                1, {$CellContext`colV$, 
                 
                 Arrow[{{0.25 $CellContext`w0$, 6 - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, 6}, {(-0.1) $CellContext`w0$, 6}}], 
                 
                 Arrow[{{0.25 $CellContext`w0$, 5 - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, 5}}], $CellContext`colL$, 
                 
                 Arrow[{{$CellContext`w0$, 6}, {0.75 $CellContext`w0$, 6}, {
                   0.75 $CellContext`w0$, 6 - $CellContext`h0$}}], 
                 
                 Arrow[{{0.75 $CellContext`w0$, 5}, {
                   0.75 $CellContext`w0$, 5 - $CellContext`h0$}}]}, 
                1 < $CellContext`tray$$ < 5, 
                Map[{$CellContext`colV$, 
                  
                  Arrow[{{
                    0.25 $CellContext`w0$, $CellContext`n$ + 
                    1 - $CellContext`tray$$ + # - $CellContext`h0$}, {
                    0.25 $CellContext`w0$, $CellContext`n$ + 
                    1 - $CellContext`tray$$ + #}}], $CellContext`colL$, 
                  
                  Arrow[{{
                    0.75 $CellContext`w0$, $CellContext`n$ + 
                    1 - $CellContext`tray$$ + #}, {
                    0.75 $CellContext`w0$, $CellContext`n$ + 
                    1 - $CellContext`tray$$ + # - $CellContext`h0$}}]}& , {0, 
                 1}]]}, {
               EdgeForm[
                Thickness[0.05]], 
               FaceForm[
                RGBColor[1, 1, 0.25]], 
               
               Rectangle[{
                0, $CellContext`n$ + 
                 1 - $CellContext`tray$$}, {$CellContext`w0$, $CellContext`n$ + 
                 1 - $CellContext`tray$$ + $CellContext`h0$}]}, 
              Text[
               Style[$CellContext`tray$$, 17, Bold], {
               0.5 $CellContext`w0$, 0.5 $CellContext`h0$ + $CellContext`n$ + 
                1 - $CellContext`tray$$}]}, ImageSize -> {230, 370}, 
             AspectRatio -> Full, PlotRange -> {0, 6.6}, PlotLabel -> 
             Style["mole ratios are in ppm", 17, Black]]]; 
        Grid[{{$CellContext`plot$, 
            
            If[$CellContext`HTS$$, $CellContext`stages$, \
$CellContext`column$]}}]], "Specifications" :> {{{$CellContext`yN1$$, 100, 
          Row[{"inlet vapor mole ratio ", 
            Subscript[
             Style["y", Italic], 
             Row[{
               Style["N", Italic], " + 1"}]], " (ppm)"}]}, 40, 120, 1, 
         Appearance -> "Labeled", ImageSize -> Small, Enabled -> Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 
         1}, {{$CellContext`T$$, 25, "temperature (\[Degree]C)"}, 10, 80, 5, 
         Appearance -> "Labeled", ImageSize -> Small, Enabled -> Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 2}, 
        Grid[{{
           Manipulate`Place[1], 
           Manipulate`Place[2]}}], {{$CellContext`P$$, 2.5, "pressure (atm)"},
          1.5, 3, 0.1, Appearance -> "Labeled", ImageSize -> Small, Enabled -> 
         Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 
         3}, {{$CellContext`L$$, 100, "solvent flow rate (Mmol/h)"}, 50, 300, 
         5, Appearance -> "Labeled", ImageSize -> Small, Enabled -> Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 4}, 
        Grid[{{
           Manipulate`Place[3], 
           Manipulate`Place[4]}}], {{$CellContext`y1$$, 10, 
          Row[{"outlet vapor ", 
            Subscript[
             Style["y", Italic], 1]}]}, 10, 25, 1, Appearance -> "Labeled", 
         ImageSize -> Small, Enabled -> Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 
         5}, {{$CellContext`x0$$, 0.05, 
          Row[{"inlet liquid ", 
            Subscript[
             Style["x", Italic], 0]}]}, 0, 0.25, 0.01, Appearance -> 
         "Labeled", ImageSize -> Small, Enabled -> Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 6}, 
        Grid[{{"mole ratios (ppm):", 
           Manipulate`Place[5], 
           Manipulate`Place[6]}}], {{$CellContext`LoVmin$$, False, 
          Subscript[
           Row[{"(", 
             Style["L", Italic], "/", 
             Style["V", Italic], ")"}], "min"]}, {True, False}, Enabled -> 
         Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 
         7}, {{$CellContext`HTS$$, False, "show diagram with 5 stages"}, {
         True, False}, ControlPlacement -> 
         8}, {{$CellContext`tray$$, 1, "stage"}, 1, 5, 1, Appearance -> 
         "Labeled", ControlPlacement -> 9}, 
        Grid[{{
           Manipulate`Place[7], 
           Manipulate`Place[8], 
           Spacer[10], 
           PaneSelector[{True -> Manipulate`Place[9]}, 
            Dynamic[$CellContext`HTS$$]]}}]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{657., {261., 267.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.73418591084803*^9},
 CellLabel->"Out[2]=",
 CellID->193540993,ExpressionUUID->"0bde5a57-b441-4da2-866c-94a037f5454d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ManipulateCaptionSection",ExpressionUUID->"e8baaa75-4d3d-412a-8294-27c77d0d679a"],

Cell[TextData[{
 "In this Demonstration, a trayed absorption column is used to remove an \
impurity solute (chloroform) from a gas feed by absorbing the impurity in a \
liquid solvent. The number of trays/stages needed to obtain an outlet solute \
mole ratio of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", "1"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "375c6562-a9f6-4861-ba4b-24e1aa9c170d"],
 " ppm in the gas stream (set with a slider) is calculated. A stage is a \
plate that contacts the liquid solvent and the gas to promote mass transfer. \
Use a slider to set the solute mole ratio ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "0"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "f9803e92-bbf8-4c8e-87b4-8ff44671bbf4"],
 " of the liquid feed stream. When a partial stage is calculated, the number \
of stages is rounded down to the nearest full stage. Use sliders to change \
the pressure and temperature in the column, the solvent flow rate ",
 Cell[BoxData[
  FormBox["L", TraditionalForm]], "InlineMath",ExpressionUUID->
  "9d657f3e-1fc6-4f3d-a23d-b0001f7427fa"],
 " and the solute mole ratio in the gas feed, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", 
    RowBox[{"N", "+", "1"}]], TraditionalForm]], "InlineMath",ExpressionUUID->
  "b810c1ea-b3eb-452e-a69a-48519025ba60"],
 ". The slope of the pink operating line, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"L", "/", "V"}], TraditionalForm]], "InlineMath",ExpressionUUID->
  "26e1cade-520a-4a4b-8331-02a661062239"],
 ", is shown on the column on the right. Checking the \"",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"(", 
     RowBox[{"L", "/", "V"}], ")"}], "min"], TraditionalForm]], "InlineMath",
  ExpressionUUID->"da0c4f5b-5022-429b-8989-cd266caab5e7"],
 "\" box shows the minimum slope for the operating line; the desired \
separation would require an infinite number of stages at a lower slope. The \
equilibrium line is orange. Check \"show diagram with 5 stages\" to set \
conditions that require 5 stages and display the mole ratios entering and \
leaving each stage. Move your mouse over the pink and orange lines on the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "-", "y"}], TraditionalForm]], "InlineMath",ExpressionUUID->
  "2a8eff0a-8065-4b2a-9ca5-af5cd8cc0109"],
 " diagram to see their labels."
}], "ManipulateCaption",
 CellChangeTimes->{
  3.7137072550611334`*^9, {3.713707539155889*^9, 3.71370754188451*^9}, {
   3.713707580166314*^9, 3.713707581011716*^9}, {3.713707614161675*^9, 
   3.713707620932518*^9}, {3.7143982157842064`*^9, 3.7143983185650854`*^9}, {
   3.7144835911804314`*^9, 3.714483617095914*^9}, {3.7145009083829403`*^9, 
   3.7145009090537415`*^9}, {3.714556231656449*^9, 3.7145562991076546`*^9}, {
   3.714556443684404*^9, 3.7145565246335573`*^9}, {3.714556555066489*^9, 
   3.714556645749499*^9}, {3.7145630837689056`*^9, 3.7145631286416035`*^9}, {
   3.7145635976034718`*^9, 3.714563602374417*^9}, {3.714563805460873*^9, 
   3.714563812554653*^9}, {3.714563855295904*^9, 3.714563870955558*^9}, {
   3.7145639438651433`*^9, 3.714563951787136*^9}, {3.7145641378562183`*^9, 
   3.714564152928872*^9}, {3.7145644053500214`*^9, 3.7145644607670918`*^9}, {
   3.714749354887968*^9, 3.714749406969076*^9}, {3.715696479762139*^9, 
   3.7156964877295847`*^9}, {3.715951738255005*^9, 3.715951763876552*^9}, {
   3.7159517959011497`*^9, 
   3.715951815756472*^9}},ExpressionUUID->"39a84f1b-94ff-46d6-af87-\
d8177c58a60a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ThumbnailSection",ExpressionUUID->"d04f8fda-d55e-4668-b008-802146f562b2"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`HTS$$ = False, $CellContext`L$$ = 
    100, $CellContext`LoVmin$$ = False, $CellContext`P$$ = 
    2.5, $CellContext`T$$ = 25, $CellContext`tray$$ = 1, $CellContext`x0$$ = 
    0.05, $CellContext`y1$$ = 10, $CellContext`yN1$$ = 100, Typeset`show$$ = 
    True, Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`yN1$$], 100, 
       Row[{"inlet vapor mole ratio ", 
         Subscript[
          Style["y", Italic], 
          Row[{
            Style["N", Italic], " + 1"}]], " (ppm)"}]}, 40, 120, 1}, {{
       Hold[$CellContext`T$$], 25, "temperature (\[Degree]C)"}, 10, 80, 5}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], 
          Manipulate`Place[2]}}]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`P$$], 2.5, "pressure (atm)"}, 1.5, 3, 0.1}, {{
       Hold[$CellContext`L$$], 100, "solvent flow rate (Mmol/h)"}, 50, 300, 
      5}, {
      Hold[
       Grid[{{
          Manipulate`Place[3], 
          Manipulate`Place[4]}}]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`y1$$], 10, 
       Row[{"outlet vapor ", 
         Subscript[
          Style["y", Italic], 1]}]}, 10, 25, 1}, {{
       Hold[$CellContext`x0$$], 0.05, 
       Row[{"inlet liquid ", 
         Subscript[
          Style["x", Italic], 0]}]}, 0, 0.25, 0.01}, {
      Hold[
       Grid[{{"mole ratios (ppm):", 
          Manipulate`Place[5], 
          Manipulate`Place[6]}}]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`LoVmin$$], False, 
       Subscript[
        Row[{"(", 
          Style["L", Italic], "/", 
          Style["V", Italic], ")"}], "min"]}, {True, False}}, {{
       Hold[$CellContext`HTS$$], False, "show diagram with 5 stages"}, {
      True, False}}, {{
       Hold[$CellContext`tray$$], 1, "stage"}, 1, 5, 1}, {
      Hold[
       Grid[{{
          Manipulate`Place[7], 
          Manipulate`Place[8], 
          Spacer[10], 
          PaneSelector[{True -> Manipulate`Place[9]}, 
           Dynamic[$CellContext`HTS$$]]}}]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    608., {182., 188.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`yN1$19838$$ = 
    0, $CellContext`T$19839$$ = 0, $CellContext`P$19840$$ = 
    0, $CellContext`L$19841$$ = 0, $CellContext`y1$19842$$ = 
    0, $CellContext`x0$19843$$ = 0, $CellContext`LoVmin$19844$$ = 
    False, $CellContext`HTS$19845$$ = False, $CellContext`tray$19846$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`HTS$$ = False, $CellContext`L$$ = 
        100, $CellContext`LoVmin$$ = False, $CellContext`P$$ = 
        2.5, $CellContext`T$$ = 25, $CellContext`tray$$ = 
        1, $CellContext`x0$$ = 0.05, $CellContext`y1$$ = 
        10, $CellContext`yN1$$ = 100}, "ControllerVariables" :> {
        Hold[$CellContext`yN1$$, $CellContext`yN1$19838$$, 0], 
        Hold[$CellContext`T$$, $CellContext`T$19839$$, 0], 
        Hold[$CellContext`P$$, $CellContext`P$19840$$, 0], 
        Hold[$CellContext`L$$, $CellContext`L$19841$$, 0], 
        Hold[$CellContext`y1$$, $CellContext`y1$19842$$, 0], 
        Hold[$CellContext`x0$$, $CellContext`x0$19843$$, 0], 
        Hold[$CellContext`LoVmin$$, $CellContext`LoVmin$19844$$, False], 
        Hold[$CellContext`HTS$$, $CellContext`HTS$19845$$, False], 
        Hold[$CellContext`tray$$, $CellContext`tray$19846$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`Ea$, $CellContext`R$, $CellContext`T0$, \
$CellContext`H0$, $CellContext`HB$, $CellContext`V$, $CellContext`YN1$, \
$CellContext`yeq$, $CellContext`xeq$, $CellContext`check$, \
$CellContext`yLVmin$, $CellContext`xN$, $CellContext`X$, $CellContext`Y$, \
$CellContext`n0$, $CellContext`n$, $CellContext`colL$, $CellContext`colV$, \
$CellContext`h$, $CellContext`w$, $CellContext`ry$, $CellContext`tank$, \
$CellContext`plot$, $CellContext`column$, $CellContext`stages$}, 
        If[$CellContext`HTS$$, {$CellContext`yN1$$ = 59; $CellContext`T$$ = 
            25; $CellContext`P$$ = 2.5; $CellContext`L$$ = 
            100; $CellContext`y1$$ = 10; $CellContext`x0$$ = 
            0.05; $CellContext`LoVmin$$ = False; Null}]; $CellContext`Ea$ = 
         5000; $CellContext`R$ = 8.314; $CellContext`T0$ = 
         298; $CellContext`H0$ = 
         211.19; $CellContext`HB$ = $CellContext`H0$ 
          Exp[(-($CellContext`Ea$/$CellContext`R$)) (
             1/($CellContext`T$$ + 273) - 
             1/$CellContext`T0$)]; $CellContext`V$ = 1; $CellContext`YN1$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := ($CellContext`L$$/$CellContext`V$) ($CellContext`x$ - \
$CellContext`x0$$) + $CellContext`y1$$; $CellContext`yeq$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := ($CellContext`HB$/$CellContext`P$$) $CellContext`x$; \
$CellContext`xeq$ = ReplaceAll[$CellContext`x, 
           Quiet[
            Part[
             
             Solve[$CellContext`yeq$[$CellContext`x] == $CellContext`yN1$$, \
$CellContext`x], 1]]]; $CellContext`check$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yeq$[$CellContext`x] == \
$CellContext`YN1$[$CellContext`x], $CellContext`x], 1]]; $CellContext`yLVmin$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yeq$[$CellContext`xeq$] - \
$CellContext`y1$$)/($CellContext`xeq$ - $CellContext`x0$$)) ($CellContext`x$ - \
$CellContext`x0$$) + $CellContext`y1$$; $CellContext`xN$ = \
($CellContext`yN1$$ - $CellContext`y1$$)/($CellContext`L$$/$CellContext`V$) + \
$CellContext`x0$$; $CellContext`X$[0] = $CellContext`xN$; $CellContext`Y$[
          0] = $CellContext`yeq$[$CellContext`xN$]; 
        Do[{$CellContext`X$[$CellContext`i] = ReplaceAll[$CellContext`x, 
             Quiet[
              Part[
               
               Solve[$CellContext`YN1$[$CellContext`x] == \
$CellContext`Y$[$CellContext`i - 1], $CellContext`x], 
               1]]], $CellContext`Y$[$CellContext`i] = $CellContext`yeq$[
             $CellContext`X$[$CellContext`i]]}, {$CellContext`i, 1, 
           50}]; $CellContext`n0$ = DeleteCases[
           Map[If[$CellContext`X$[#] < $CellContext`x0$$, 0, #]& , 
            Range[50]], 0]; $CellContext`n$ = 
         If[Length[$CellContext`n0$] == 0, 1, 1 + 
           Part[$CellContext`n0$, -1]]; $CellContext`colV$ = 
         RGBColor[0, 0.5, 0]; $CellContext`colL$ = 
         RGBColor[0, 0, 0.75]; $CellContext`h$ = 13; $CellContext`w$ = 
         12; $CellContext`ry$ = 2; $CellContext`tank$ = Graphics[{Thick, 
            Map[
            Line[{{#, $CellContext`ry$}, {#, $CellContext`h$ - \
$CellContext`ry$}}]& , {0, $CellContext`w$}], 
            
            Circle[{$CellContext`w$/2, $CellContext`ry$}, {$CellContext`w$/
              2, $CellContext`ry$}, {Pi, 2 Pi}], 
            
            Circle[{$CellContext`w$/
              2, $CellContext`h$ - $CellContext`ry$}, {$CellContext`w$/
              2, $CellContext`ry$}, {0, Pi}], {
             Arrowheads[0.1], $CellContext`colV$, 
             
             Arrow[{{(-$CellContext`w$)/2, (-$CellContext`h$)/4}, {
               0.25 $CellContext`w$, (-$CellContext`h$)/4}, {
               0.25 $CellContext`w$, $CellContext`ry$/10}}], 
             
             Arrow[{{0.25 $CellContext`w$, $CellContext`h$ - $CellContext`ry$/
                10}, {0.25 $CellContext`w$, $CellContext`h$ + $CellContext`h$/
                 4}, {(-$CellContext`w$)/
                2, $CellContext`h$ + $CellContext`h$/4}}], $CellContext`colL$, 
             
             Arrow[{{0.75 $CellContext`w$, $CellContext`ry$/10}, {
               0.75 $CellContext`w$, (-$CellContext`h$)/
                4}, {$CellContext`w$ + $CellContext`w$/
                 2.3, (-$CellContext`h$)/4}}], 
             
             Arrow[{{$CellContext`w$ + $CellContext`w$/
                 2.3, $CellContext`h$ + $CellContext`h$/4}, {
               0.75 $CellContext`w$, $CellContext`h$ + $CellContext`h$/4}, {
               0.75 $CellContext`w$, $CellContext`h$ - $CellContext`ry$/
                10}}]}}, ImageSize -> {230, 390}, AspectRatio -> Full, 
           PlotRange -> {{(-$CellContext`w$)/
              2.13, $CellContext`w$ + $CellContext`w$/
               2.3}, {(-$CellContext`h$)/
              5, $CellContext`h$ + $CellContext`h$/7}}, 
           PlotRangePadding -> {None, {
              Scaled[0.15], 
              Scaled[0.17]}}]; $CellContext`plot$ = Plot[{
            $CellContext`YN1$[$CellContext`x], 
            $CellContext`yeq$[$CellContext`x]}, {$CellContext`x, 
            0, $CellContext`xeq$}, PlotStyle -> {{Thick, 
              If[$CellContext`LoVmin$$, Transparent, Magenta]}, {Thick, 
              RGBColor[1, 0.4, 0]}}, PlotRange -> {0, $CellContext`yN1$$ + 5},
            PlotRangePadding -> None, PlotRangeClipping -> False, Frame -> 
           True, FrameLabel -> {
             Row[{"solute/(solute-free liquid) ", 
               Style["x", Italic], " (ppm)"}], 
             Row[{"solute/(solute-free vapor) ", 
               Style["y", Italic], " (ppm)"}]}, LabelStyle -> {17, Black}, 
           ImageSize -> {370, 370}, AspectRatio -> Full, 
           ImagePadding -> {{55, 25}, {50, 5}}, Epilog -> {Thick, 
             If[$CellContext`LoVmin$$, {Thick, Magenta, 
               Line[{{0, 
                  $CellContext`yLVmin$[0]}, {$CellContext`xeq$, 
                  $CellContext`yLVmin$[$CellContext`xeq$]}}]}, 
              If[
               
               And[$CellContext`yeq$[$CellContext`check$] < \
$CellContext`yN1$$, $CellContext`check$ > 0], 
               Text[
                Framed[
                 Column[{
                   Style["separation not possible", 20, 
                    RGBColor[0.85, 0, 0]], 
                   Style["\[Star]infinite stages needed\[Star]", 17]}, 
                  Center], Background -> White], {
                0.55 $CellContext`xeq$, 0.6 $CellContext`yN1$$}], {
                Map[Line[{{
                    $CellContext`X$[# - 1], 
                    $CellContext`Y$[# - 1]}, {
                    $CellContext`X$[#], 
                    $CellContext`Y$[# - 1]}, {
                    $CellContext`X$[#], 
                    $CellContext`Y$[#]}}]& , 
                 Range[$CellContext`n$ - 1]], 
                Line[{{
                   $CellContext`X$[0], 
                   $CellContext`Y$[0]}, {
                   $CellContext`X$[0], 
                   $CellContext`YN1$[$CellContext`xN$]}}], 
                Line[{{
                   $CellContext`X$[$CellContext`n$ - 1], 
                   $CellContext`Y$[$CellContext`n$ - 1]}, {$CellContext`x0$$, 
                   $CellContext`Y$[$CellContext`n$ - 1]}}], 
                If[$CellContext`HTS$$ == False, {
                  If[$CellContext`n$ < 30, 
                   Map[Text[
                    Style[
                    Row[{" ", $CellContext`n$ + 1 - #, " "}], 17, Background -> 
                    White], {
                    $CellContext`X$[# - 1], 
                    $CellContext`Y$[# - 1]}, {-1, 1}]& , 
                    Range[
                    If[$CellContext`n$ <= 8, $CellContext`n$, 8]]]], 
                  If[$CellContext`n$ > 8, 
                   Text[
                    Style[
                    Row[{" ", 1, " "}], 17, Background -> White], {
                    $CellContext`X$[$CellContext`n$ - 1], 
                    $CellContext`Y$[$CellContext`n$ - 1]}, {-1, 
                    1}]], {$CellContext`colL$, Dashed, 
                   
                   Line[{{$CellContext`x0$$, $CellContext`y1$$}, \
{$CellContext`x0$$, 0}}], $CellContext`colV$, 
                   Line[{{
                    0, $CellContext`y1$$}, {$CellContext`x0$$, \
$CellContext`y1$$}}]}, 
                  Text[
                   Style[
                    Subscript[
                    Style["y", Italic], 1], 17, $CellContext`colV$, 
                    Background -> White], {0, $CellContext`y1$$}, {1.2, 0}], 
                  Text[
                   Style[
                    Subscript[
                    Style["x", Italic], 0], 17, $CellContext`colL$, 
                    Background -> White], {$CellContext`x0$$, 0}, {0, 1.2}], {
                   PointSize[0.025], $CellContext`colL$, 
                   Point[{$CellContext`x0$$, 0}], $CellContext`colV$, 
                   Point[{0, $CellContext`y1$$}], $CellContext`colL$, 
                   Point[{$CellContext`xN$, 
                    $CellContext`yeq$[$CellContext`xN$]}]}, {
                  Dashed, $CellContext`colL$, 
                   Line[{{$CellContext`xN$, 0}, {$CellContext`xN$, 
                    $CellContext`yeq$[$CellContext`xN$]}}], 
                   Text[
                    Framed[
                    Style[
                    Subscript["x", $CellContext`n$], 18, Italic], Background -> 
                    White, FrameStyle -> None, FrameMargins -> 
                    Tiny], {$CellContext`xN$, 0.25 $CellContext`yN1$$}]}}], {
                Dashed, $CellContext`colV$, 
                 
                 Line[{{0, $CellContext`yN1$$}, {$CellContext`xeq$, \
$CellContext`yN1$$}}], 
                 Text[
                  Framed[
                   Style[
                    Subscript[
                    Style["y", Italic], $CellContext`n$ + 1], 18], Background -> 
                   White, FrameStyle -> None, FrameMargins -> Tiny], {
                  0.15, $CellContext`yN1$$}]}, 
                If[$CellContext`HTS$$, {
                  PointSize[0.025], {$CellContext`colL$, 
                   Map[Point[{
                    $CellContext`X$[#], 
                    $CellContext`yeq$[
                    $CellContext`X$[#]]}]& , 
                    Range[0, $CellContext`n$ - 1]], 
                   Point[{$CellContext`x0$$, 0}]}, {$CellContext`colV$, 
                   Map[Point[{
                    $CellContext`X$[#], 
                    $CellContext`YN1$[
                    $CellContext`X$[#]]}]& , 
                    Range[0, $CellContext`n$]]}, 
                  Map[Text[
                    Style[
                    Row[{$CellContext`n$ + 1 - #, ", ", 
                    Style[
                    Subscript[
                    Style["x", Italic], $CellContext`n$ + 
                    1 - #], $CellContext`colL$], ", ", 
                    Style[
                    Subscript[
                    Style["y", Italic], $CellContext`n$ + 
                    1 - #], $CellContext`colV$]}], 17], {
                    $CellContext`X$[# - 1], 
                    $CellContext`yeq$[
                    $CellContext`X$[# - 1]]}, {-1.2, 1}]& , 
                   Range[$CellContext`n$]], 
                  Text[
                   Style[
                    Subscript[
                    Style["x", Italic], 0], 
                    17, $CellContext`colL$], {$CellContext`x0$$, 
                    0}, {-1.2, -1}], 
                  Text[
                   Style[
                    Row[{
                    Style[
                    Subscript["y", "n"], Italic, $CellContext`colV$], 
                    " is in equilibrium with ", 
                    Style[
                    Subscript["x", "n"], Italic, $CellContext`colL$]}], 17], {
                   0.4, 3}], 
                  Text[
                   Style[
                    Column[{
                    Row[{"stage ", $CellContext`tray$$, " solute fluxes:"}], 
                    Column[{
                    Row[{"in: ", 
                    
                    NumberForm[$CellContext`X$[$CellContext`n$ + 
                    1 - $CellContext`tray$$] $CellContext`L$$ + \
$CellContext`YN1$[
                    $CellContext`X$[$CellContext`n$ + 1 - $CellContext`tray$$ - 
                    1]] $CellContext`V$, {4, 1}], " mol/h"}], 
                    Row[{"out: ", 
                    
                    NumberForm[$CellContext`X$[$CellContext`n$ + 
                    1 - $CellContext`tray$$ - 
                    1] $CellContext`L$$ + $CellContext`YN1$[
                    $CellContext`X$[$CellContext`n$ + 
                    1 - $CellContext`tray$$]] $CellContext`V$, {4, 1}], 
                    " mol/h"}]}, Alignment -> ":"]}, Center], 17], {0.2, 48}], 
                  Text[
                   Style["top", 17, Background -> White], {0.04, 6}], 
                  Text[
                   Style["bottom", 17, Background -> White], {0.63, 
                   61.1}]}]}]], 
             Mouseover[{Transparent, 
               Thickness[0.04], 
               CapForm[None], 
               If[$CellContext`LoVmin$$, 
                Line[{{0, 
                   $CellContext`yLVmin$[0]}, {$CellContext`xeq$, 
                   $CellContext`yLVmin$[$CellContext`xeq$]}}], 
                Line[
                 Map[{#, 
                   $CellContext`YN1$[#]}& , 
                  Range[0, $CellContext`xeq$, 0.01]]]]}, {
               Thickness[0.02], Magenta, 
               If[$CellContext`LoVmin$$, 
                Line[{{0, 
                   $CellContext`yLVmin$[0]}, {$CellContext`xeq$, 
                   $CellContext`yLVmin$[$CellContext`xeq$]}}], 
                Line[
                 Map[{#, 
                   $CellContext`YN1$[#]}& , 
                  Range[0, 
                   ReplaceAll[$CellContext`x, 
                    Part[
                    
                    Solve[$CellContext`YN1$[$CellContext`x] == \
$CellContext`yN1$$ + 5, $CellContext`x], 1]], 0.01]]]], 
               Text[
                Style[
                 Column[{"operating line", "(mass balance)"}, Center], 17, 
                 Magenta], 
                If[$CellContext`HTS$$, {
                 0.75 $CellContext`xeq$, 0.25 $CellContext`yN1$$}, {
                 0.25 $CellContext`xeq$, 0.7 $CellContext`yN1$$}]]}], 
             Mouseover[{Transparent, 
               Thickness[0.04], 
               CapForm[None], 
               Line[
                Map[{#, 
                  $CellContext`yeq$[#]}& , 
                 Range[0, $CellContext`xeq$, 0.01]]]}, {
               Thickness[0.02], 
               RGBColor[1, 0.4, 0], 
               Line[
                Map[{#, 
                  $CellContext`yeq$[#]}& , 
                 Range[0, $CellContext`xeq$, 0.01]]], 
               Text[
                Style["equilibrium line", 17, 
                 RGBColor[1, 0.4, 0]], 
                
                If[$CellContext`HTS$$, {
                 0.75 $CellContext`xeq$, 0.25 $CellContext`yN1$$}, {
                 0.25 $CellContext`xeq$, 
                  0.7 $CellContext`yN1$$}]]}]}]; $CellContext`column$ = 
         Show[$CellContext`tank$, Epilog -> {Thick, 
             Text[
              Style[
               Column[{"liquid solvent feed", 
                 Row[{
                   Style["L", Italic], " = ", 
                   NumberForm[$CellContext`L$$, {4, 0}], " Mmol/h"}]}, Right],
                17, $CellContext`colL$], {$CellContext`w$, $CellContext`h$ + \
$CellContext`h$/4}, {0.2, -1.2}], 
             Text[
              Style[
               Column[{"vapor feed", 
                 Row[{
                   Style["V", Italic], " = ", 
                   NumberForm[$CellContext`V$, 2], " Mmol/h"}]}], 
               17, $CellContext`colV$], {0, (-$CellContext`h$)/4}, {0, 1.4}], 
             Apply[Text[
               Style[
                Row[{
                  Subscript[
                   Style["y", Italic], #2], " = ", #, " ppm"}], 
                17, $CellContext`colV$, Background -> White], {
               0, #3}]& , {{$CellContext`y1$$, 1, $CellContext`h$ + 
                2}, {$CellContext`yN1$$, $CellContext`n$ + 1, -2}}, {1}], 
             Apply[Text[
               Style[
                Row[{
                  Subscript[
                   Style["x", Italic], #2], " = ", #, " ppm"}], 
                17, $CellContext`colL$, Background -> 
                White], {$CellContext`w$, #3}]& , {{$CellContext`x0$$, 
                0, $CellContext`h$ + 2.25}, {
                NumberForm[$CellContext`xN$, 2], $CellContext`n$, -2}}, {1}], 
             Text[
              Style[
               Row[{
                 Style["L", Italic], "/", 
                 Style["V", Italic], " = ", 
                 NumberForm[$CellContext`L$$/$CellContext`V$, {4, 0}]}], 
               17], {$CellContext`w$/2, 0.33 $CellContext`h$}], 
             Text[
              Style[
               If[$CellContext`LoVmin$$, 
                Style[
                 Row[{
                   Subscript[
                    Row[{"(", 
                    Style["L", Italic], "/", 
                    Style["V", Italic], ")"}], "min"], " = ", 
                   
                   NumberForm[($CellContext`yeq$[$CellContext`xeq$] - \
$CellContext`y1$$)/($CellContext`xeq$ - $CellContext`x0$$), {5, 1}]}], 17, 
                 Purple], 
                Row[{
                  If[
                   
                   And[$CellContext`yeq$[$CellContext`check$] < \
$CellContext`yN1$$, $CellContext`check$ > 0], Infinity, $CellContext`n$], 
                  " stages needed"}]], 17], {$CellContext`w$/2, 
               0.66 $CellContext`h$}]}, ImageSize -> {230, 370}, AspectRatio -> 
           Full, PlotRange -> {{(-$CellContext`w$)/
              2.13, $CellContext`w$ + $CellContext`w$/
               2.3}, {(-$CellContext`h$)/
              5, $CellContext`h$ + $CellContext`h$/7}}, 
           PlotRangePadding -> {None, {
              Scaled[0.15], 
              Scaled[0.2]}}]; $CellContext`stages$ = 
         Module[{$CellContext`w0$, $CellContext`h0$}, $CellContext`w0$ = 
            1; $CellContext`h0$ = 0.5; Graphics[{Thick, {
               EdgeForm[Thick], 
               FaceForm[None], 
               Map[
               Rectangle[{0, #}, {$CellContext`w0$, # + $CellContext`h0$}]& , 
                Range[5]]}, {
               Arrowheads[0.22], {$CellContext`colV$, 
                Map[
                Arrow[{{0.25 $CellContext`w0$, # - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, #}}]& , 
                 Range[2, 5]], 
                
                Arrow[{{0, 1 - $CellContext`h0$}, {
                  0.25 $CellContext`w0$, 1 - $CellContext`h0$}, {
                  0.25 $CellContext`w0$, 1}}], 
                
                Arrow[{{0.25 $CellContext`w0$, 6 - $CellContext`h0$}, {
                  0.25 $CellContext`w0$, 6}, {(-0.1) $CellContext`w0$, 
                   6}}]}, {$CellContext`colL$, 
                Map[
                Arrow[{{0.75 $CellContext`w0$, #}, {
                   0.75 $CellContext`w0$, # - $CellContext`h0$}}]& , 
                 Range[2, 5]], 
                
                Arrow[{{0.75 $CellContext`w0$, 1}, {
                  0.75 $CellContext`w0$, 1 - $CellContext`h0$}, {
                  1.1 $CellContext`w0$, 1 - $CellContext`h0$}}], 
                
                Arrow[{{$CellContext`w0$, 6}, {0.75 $CellContext`w0$, 6}, {
                  0.75 $CellContext`w0$, 6 - $CellContext`h0$}}]}}, 
              Map[Text[
                Style[$CellContext`n$ + 1 - #, 17, Background -> White], {
                0.5 $CellContext`w0$, 0.5 $CellContext`h0$ + #}]& , 
               Range[5]], 
              Map[Text[
                Style[
                 Row[{
                   Subscript[
                    Style["y", Italic], 6 - #], " = ", 
                   NumberForm[
                    $CellContext`YN1$[
                    $CellContext`X$[#]], {2, 0}]}], 17, $CellContext`colV$, 
                 Background -> White], {
                0.25 $CellContext`w0$, # + 1 - 0.5 $CellContext`h0$}, {
                1.2, 0}]& , 
               Range[4]], 
              Text[
               Style[
                Column[{
                  Row[{$CellContext`V$, " Mmol/h"}], 
                  Row[{
                    Subscript[
                    Style["y", Italic], 1], " = ", 
                    NumberForm[
                    $CellContext`YN1$[
                    $CellContext`X$[$CellContext`n$]], {2, 0}]}]}, Center], 
                17, $CellContext`colV$], {
               0.25 $CellContext`w0$, 6 - 0.5 $CellContext`h0$}, {
               1.5, -0.75}], 
              Text[
               Style[
                Column[{
                  Row[{
                    Subscript[
                    Style["y", Italic], 6], " = ", 
                    NumberForm[
                    $CellContext`YN1$[
                    $CellContext`X$[0]], {2, 0}]}], 
                  Row[{$CellContext`V$, " Mmol/h"}]}, Center], 
                17, $CellContext`colV$], {0.25 $CellContext`w0$, 0.5}, {1.25, 
               0.4}], 
              Map[Text[
                Style[
                 Row[{
                   Subscript[
                    Style["x", Italic], 6 - #], " = ", 
                   NumberForm[
                    $CellContext`X$[# - 1], {2, 2}]}], 17, $CellContext`colL$,
                  Background -> White], {
                0.75 $CellContext`w0$, # - 0.5 $CellContext`h0$}, {-1.5, 
                 0}]& , 
               Range[2, 5]], 
              Text[
               Style[
                Column[{
                  Row[{$CellContext`L$$, " Mmol/h"}], 
                  Row[{
                    Subscript[
                    Style["x", Italic], 0], " = ", 
                    NumberForm[
                    $CellContext`X$[$CellContext`n$], {2, 2}]}]}, Center], 
                17, $CellContext`colL$], {$CellContext`w0$, 6 - 
                0.5 $CellContext`h0$}, {-1, -0.75}], 
              Text[
               Style[
                Column[{
                  Row[{
                    Subscript[
                    Style["x", Italic], $CellContext`n$], " = ", 
                    NumberForm[
                    $CellContext`X$[0], {2, 2}]}], 
                  Row[{$CellContext`L$$, " Mmol/h"}]}, Center], 
                17, $CellContext`colL$], {$CellContext`w0$, 0.5}, {-1, 0.4}], {
               Arrowheads[0.22], 
               Which[$CellContext`tray$$ == 5, {$CellContext`colV$, 
                 
                 Arrow[{{0, 1 - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, 1 - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, 1}}], 
                 
                 Arrow[{{0.25 $CellContext`w0$, 2 - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, 2}}], $CellContext`colL$, 
                 
                 Arrow[{{0.75 $CellContext`w0$, 1}, {
                   0.75 $CellContext`w0$, 1 - $CellContext`h0$}, {
                   1.1 $CellContext`w0$, 1 - $CellContext`h0$}}], 
                 
                 Arrow[{{0.75 $CellContext`w0$, 2}, {
                   0.75 $CellContext`w0$, 
                    2 - $CellContext`h0$}}]}, $CellContext`tray$$ == 
                1, {$CellContext`colV$, 
                 
                 Arrow[{{0.25 $CellContext`w0$, 6 - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, 6}, {(-0.1) $CellContext`w0$, 6}}], 
                 
                 Arrow[{{0.25 $CellContext`w0$, 5 - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, 5}}], $CellContext`colL$, 
                 
                 Arrow[{{$CellContext`w0$, 6}, {0.75 $CellContext`w0$, 6}, {
                   0.75 $CellContext`w0$, 6 - $CellContext`h0$}}], 
                 
                 Arrow[{{0.75 $CellContext`w0$, 5}, {
                   0.75 $CellContext`w0$, 5 - $CellContext`h0$}}]}, 
                1 < $CellContext`tray$$ < 5, 
                Map[{$CellContext`colV$, 
                  
                  Arrow[{{
                    0.25 $CellContext`w0$, $CellContext`n$ + 
                    1 - $CellContext`tray$$ + # - $CellContext`h0$}, {
                    0.25 $CellContext`w0$, $CellContext`n$ + 
                    1 - $CellContext`tray$$ + #}}], $CellContext`colL$, 
                  
                  Arrow[{{
                    0.75 $CellContext`w0$, $CellContext`n$ + 
                    1 - $CellContext`tray$$ + #}, {
                    0.75 $CellContext`w0$, $CellContext`n$ + 
                    1 - $CellContext`tray$$ + # - $CellContext`h0$}}]}& , {0, 
                 1}]]}, {
               EdgeForm[
                Thickness[0.05]], 
               FaceForm[
                RGBColor[1, 1, 0.25]], 
               
               Rectangle[{
                0, $CellContext`n$ + 
                 1 - $CellContext`tray$$}, {$CellContext`w0$, $CellContext`n$ + 
                 1 - $CellContext`tray$$ + $CellContext`h0$}]}, 
              Text[
               Style[$CellContext`tray$$, 17, Bold], {
               0.5 $CellContext`w0$, 0.5 $CellContext`h0$ + $CellContext`n$ + 
                1 - $CellContext`tray$$}]}, ImageSize -> {230, 370}, 
             AspectRatio -> Full, PlotRange -> {0, 6.6}, PlotLabel -> 
             Style["mole ratios are in ppm", 17, Black]]]; 
        Grid[{{$CellContext`plot$, 
            
            If[$CellContext`HTS$$, $CellContext`stages$, \
$CellContext`column$]}}]], "Specifications" :> {{{$CellContext`yN1$$, 100, 
          Row[{"inlet vapor mole ratio ", 
            Subscript[
             Style["y", Italic], 
             Row[{
               Style["N", Italic], " + 1"}]], " (ppm)"}]}, 40, 120, 1, 
         Appearance -> "Labeled", ImageSize -> Small, Enabled -> Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 
         1}, {{$CellContext`T$$, 25, "temperature (\[Degree]C)"}, 10, 80, 5, 
         Appearance -> "Labeled", ImageSize -> Small, Enabled -> Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 2}, 
        Grid[{{
           Manipulate`Place[1], 
           Manipulate`Place[2]}}], {{$CellContext`P$$, 2.5, "pressure (atm)"},
          1.5, 3, 0.1, Appearance -> "Labeled", ImageSize -> Small, Enabled -> 
         Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 
         3}, {{$CellContext`L$$, 100, "solvent flow rate (Mmol/h)"}, 50, 300, 
         5, Appearance -> "Labeled", ImageSize -> Small, Enabled -> Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 4}, 
        Grid[{{
           Manipulate`Place[3], 
           Manipulate`Place[4]}}], {{$CellContext`y1$$, 10, 
          Row[{"outlet vapor ", 
            Subscript[
             Style["y", Italic], 1]}]}, 10, 25, 1, Appearance -> "Labeled", 
         ImageSize -> Small, Enabled -> Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 
         5}, {{$CellContext`x0$$, 0.05, 
          Row[{"inlet liquid ", 
            Subscript[
             Style["x", Italic], 0]}]}, 0, 0.25, 0.01, Appearance -> 
         "Labeled", ImageSize -> Small, Enabled -> Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 6}, 
        Grid[{{"mole ratios (ppm):", 
           Manipulate`Place[5], 
           Manipulate`Place[6]}}], {{$CellContext`LoVmin$$, False, 
          Subscript[
           Row[{"(", 
             Style["L", Italic], "/", 
             Style["V", Italic], ")"}], "min"]}, {True, False}, Enabled -> 
         Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 
         7}, {{$CellContext`HTS$$, False, "show diagram with 5 stages"}, {
         True, False}, ControlPlacement -> 
         8}, {{$CellContext`tray$$, 1, "stage"}, 1, 5, 1, Appearance -> 
         "Labeled", ControlPlacement -> 9}, 
        Grid[{{
           Manipulate`Place[7], 
           Manipulate`Place[8], 
           Spacer[10], 
           PaneSelector[{True -> Manipulate`Place[9]}, 
            Dynamic[$CellContext`HTS$$]]}}]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{657., {261., 267.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->139225698,ExpressionUUID->"315712ff-b166-402d-8446-f83bd80c0221"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SnapshotsSection",ExpressionUUID->"d6da989e-d615-4027-9845-3dc29f6d97e9"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`HTS$$ = False, $CellContext`L$$ = 
    150, $CellContext`LoVmin$$ = False, $CellContext`P$$ = 
    2.5, $CellContext`T$$ = 55, $CellContext`tray$$ = 1, $CellContext`x0$$ = 
    0.05, $CellContext`y1$$ = 18, $CellContext`yN1$$ = 58, Typeset`show$$ = 
    True, Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`yN1$$], 58, 
       Row[{"inlet vapor mole ratio ", 
         Subscript[
          Style["y", Italic], 
          Row[{
            Style["N", Italic], " + 1"}]], " (ppm)"}]}, 40, 120, 1}, {{
       Hold[$CellContext`T$$], 55, "temperature (\[Degree]C)"}, 10, 80, 5}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], 
          Manipulate`Place[2]}}]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`P$$], 2.5, "pressure (atm)"}, 1.5, 3, 0.1}, {{
       Hold[$CellContext`L$$], 150, "solvent flow rate (Mmol/h)"}, 50, 300, 
      5}, {
      Hold[
       Grid[{{
          Manipulate`Place[3], 
          Manipulate`Place[4]}}]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`y1$$], 18, 
       Row[{"outlet vapor ", 
         Subscript[
          Style["y", Italic], 1]}]}, 10, 25, 1}, {{
       Hold[$CellContext`x0$$], 0.05, 
       Row[{"inlet liquid ", 
         Subscript[
          Style["x", Italic], 0]}]}, 0, 0.25, 0.01}, {
      Hold[
       Grid[{{"mole ratios (ppm):", 
          Manipulate`Place[5], 
          Manipulate`Place[6]}}]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`LoVmin$$], False, 
       Subscript[
        Row[{"(", 
          Style["L", Italic], "/", 
          Style["V", Italic], ")"}], "min"]}, {True, False}}, {{
       Hold[$CellContext`HTS$$], False, "show diagram with 5 stages"}, {
      True, False}}, {{
       Hold[$CellContext`tray$$], 1, "stage"}, 1, 5, 1}, {
      Hold[
       Grid[{{
          Manipulate`Place[7], 
          Manipulate`Place[8], 
          Spacer[10], 
          PaneSelector[{True -> Manipulate`Place[9]}, 
           Dynamic[$CellContext`HTS$$]]}}]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = Automatic, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`yN1$19942$$ = 0, $CellContext`T$19943$$ = 
    0, $CellContext`P$19944$$ = 0, $CellContext`L$19945$$ = 
    0, $CellContext`y1$19946$$ = 0, $CellContext`x0$19947$$ = 
    0, $CellContext`LoVmin$19948$$ = False, $CellContext`HTS$19949$$ = 
    False, $CellContext`tray$19950$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`HTS$$ = False, $CellContext`L$$ = 
        150, $CellContext`LoVmin$$ = False, $CellContext`P$$ = 
        2.5, $CellContext`T$$ = 55, $CellContext`tray$$ = 
        1, $CellContext`x0$$ = 0.05, $CellContext`y1$$ = 
        18, $CellContext`yN1$$ = 58}, "ControllerVariables" :> {
        Hold[$CellContext`yN1$$, $CellContext`yN1$19942$$, 0], 
        Hold[$CellContext`T$$, $CellContext`T$19943$$, 0], 
        Hold[$CellContext`P$$, $CellContext`P$19944$$, 0], 
        Hold[$CellContext`L$$, $CellContext`L$19945$$, 0], 
        Hold[$CellContext`y1$$, $CellContext`y1$19946$$, 0], 
        Hold[$CellContext`x0$$, $CellContext`x0$19947$$, 0], 
        Hold[$CellContext`LoVmin$$, $CellContext`LoVmin$19948$$, False], 
        Hold[$CellContext`HTS$$, $CellContext`HTS$19949$$, False], 
        Hold[$CellContext`tray$$, $CellContext`tray$19950$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`Ea$, $CellContext`R$, $CellContext`T0$, \
$CellContext`H0$, $CellContext`HB$, $CellContext`V$, $CellContext`YN1$, \
$CellContext`yeq$, $CellContext`xeq$, $CellContext`check$, \
$CellContext`yLVmin$, $CellContext`xN$, $CellContext`X$, $CellContext`Y$, \
$CellContext`n0$, $CellContext`n$, $CellContext`colL$, $CellContext`colV$, \
$CellContext`h$, $CellContext`w$, $CellContext`ry$, $CellContext`tank$, \
$CellContext`plot$, $CellContext`column$, $CellContext`stages$}, 
        If[$CellContext`HTS$$, {$CellContext`yN1$$ = 59; $CellContext`T$$ = 
            25; $CellContext`P$$ = 2.5; $CellContext`L$$ = 
            100; $CellContext`y1$$ = 10; $CellContext`x0$$ = 
            0.05; $CellContext`LoVmin$$ = False; Null}]; $CellContext`Ea$ = 
         5000; $CellContext`R$ = 8.314; $CellContext`T0$ = 
         298; $CellContext`H0$ = 
         211.19; $CellContext`HB$ = $CellContext`H0$ 
          Exp[(-($CellContext`Ea$/$CellContext`R$)) (
             1/($CellContext`T$$ + 273) - 
             1/$CellContext`T0$)]; $CellContext`V$ = 1; $CellContext`YN1$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := ($CellContext`L$$/$CellContext`V$) ($CellContext`x$ - \
$CellContext`x0$$) + $CellContext`y1$$; $CellContext`yeq$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := ($CellContext`HB$/$CellContext`P$$) $CellContext`x$; \
$CellContext`xeq$ = ReplaceAll[$CellContext`x, 
           Quiet[
            Part[
             
             Solve[$CellContext`yeq$[$CellContext`x] == $CellContext`yN1$$, \
$CellContext`x], 1]]]; $CellContext`check$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yeq$[$CellContext`x] == \
$CellContext`YN1$[$CellContext`x], $CellContext`x], 1]]; $CellContext`yLVmin$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yeq$[$CellContext`xeq$] - \
$CellContext`y1$$)/($CellContext`xeq$ - $CellContext`x0$$)) ($CellContext`x$ - \
$CellContext`x0$$) + $CellContext`y1$$; $CellContext`xN$ = \
($CellContext`yN1$$ - $CellContext`y1$$)/($CellContext`L$$/$CellContext`V$) + \
$CellContext`x0$$; $CellContext`X$[0] = $CellContext`xN$; $CellContext`Y$[
          0] = $CellContext`yeq$[$CellContext`xN$]; 
        Do[{$CellContext`X$[$CellContext`i] = ReplaceAll[$CellContext`x, 
             Quiet[
              Part[
               
               Solve[$CellContext`YN1$[$CellContext`x] == \
$CellContext`Y$[$CellContext`i - 1], $CellContext`x], 
               1]]], $CellContext`Y$[$CellContext`i] = $CellContext`yeq$[
             $CellContext`X$[$CellContext`i]]}, {$CellContext`i, 1, 
           50}]; $CellContext`n0$ = DeleteCases[
           Map[If[$CellContext`X$[#] < $CellContext`x0$$, 0, #]& , 
            Range[50]], 0]; $CellContext`n$ = 
         If[Length[$CellContext`n0$] == 0, 1, 1 + 
           Part[$CellContext`n0$, -1]]; $CellContext`colV$ = 
         RGBColor[0, 0.5, 0]; $CellContext`colL$ = 
         RGBColor[0, 0, 0.75]; $CellContext`h$ = 13; $CellContext`w$ = 
         12; $CellContext`ry$ = 2; $CellContext`tank$ = Graphics[{Thick, 
            Map[
            Line[{{#, $CellContext`ry$}, {#, $CellContext`h$ - \
$CellContext`ry$}}]& , {0, $CellContext`w$}], 
            
            Circle[{$CellContext`w$/2, $CellContext`ry$}, {$CellContext`w$/
              2, $CellContext`ry$}, {Pi, 2 Pi}], 
            
            Circle[{$CellContext`w$/
              2, $CellContext`h$ - $CellContext`ry$}, {$CellContext`w$/
              2, $CellContext`ry$}, {0, Pi}], {
             Arrowheads[0.1], $CellContext`colV$, 
             
             Arrow[{{(-$CellContext`w$)/2, (-$CellContext`h$)/4}, {
               0.25 $CellContext`w$, (-$CellContext`h$)/4}, {
               0.25 $CellContext`w$, $CellContext`ry$/10}}], 
             
             Arrow[{{0.25 $CellContext`w$, $CellContext`h$ - $CellContext`ry$/
                10}, {0.25 $CellContext`w$, $CellContext`h$ + $CellContext`h$/
                 4}, {(-$CellContext`w$)/
                2, $CellContext`h$ + $CellContext`h$/4}}], $CellContext`colL$, 
             
             Arrow[{{0.75 $CellContext`w$, $CellContext`ry$/10}, {
               0.75 $CellContext`w$, (-$CellContext`h$)/
                4}, {$CellContext`w$ + $CellContext`w$/
                 2.3, (-$CellContext`h$)/4}}], 
             
             Arrow[{{$CellContext`w$ + $CellContext`w$/
                 2.3, $CellContext`h$ + $CellContext`h$/4}, {
               0.75 $CellContext`w$, $CellContext`h$ + $CellContext`h$/4}, {
               0.75 $CellContext`w$, $CellContext`h$ - $CellContext`ry$/
                10}}]}}, ImageSize -> {230, 390}, AspectRatio -> Full, 
           PlotRange -> {{(-$CellContext`w$)/
              2.13, $CellContext`w$ + $CellContext`w$/
               2.3}, {(-$CellContext`h$)/
              5, $CellContext`h$ + $CellContext`h$/7}}, 
           PlotRangePadding -> {None, {
              Scaled[0.15], 
              Scaled[0.17]}}]; $CellContext`plot$ = Plot[{
            $CellContext`YN1$[$CellContext`x], 
            $CellContext`yeq$[$CellContext`x]}, {$CellContext`x, 
            0, $CellContext`xeq$}, PlotStyle -> {{Thick, 
              If[$CellContext`LoVmin$$, Transparent, Magenta]}, {Thick, 
              RGBColor[1, 0.4, 0]}}, PlotRange -> {0, $CellContext`yN1$$ + 5},
            PlotRangePadding -> None, PlotRangeClipping -> False, Frame -> 
           True, FrameLabel -> {
             Row[{"solute/(solute-free liquid) ", 
               Style["x", Italic], " (ppm)"}], 
             Row[{"solute/(solute-free vapor) ", 
               Style["y", Italic], " (ppm)"}]}, LabelStyle -> {17, Black}, 
           ImageSize -> {370, 370}, AspectRatio -> Full, 
           ImagePadding -> {{55, 25}, {50, 5}}, Epilog -> {Thick, 
             If[$CellContext`LoVmin$$, {Thick, Magenta, 
               Line[{{0, 
                  $CellContext`yLVmin$[0]}, {$CellContext`xeq$, 
                  $CellContext`yLVmin$[$CellContext`xeq$]}}]}, 
              If[
               
               And[$CellContext`yeq$[$CellContext`check$] < \
$CellContext`yN1$$, $CellContext`check$ > 0], 
               Text[
                Framed[
                 Column[{
                   Style["separation not possible", 20, 
                    RGBColor[0.85, 0, 0]], 
                   Style["\[Star]infinite stages needed\[Star]", 17]}, 
                  Center], Background -> White], {
                0.55 $CellContext`xeq$, 0.6 $CellContext`yN1$$}], {
                Map[Line[{{
                    $CellContext`X$[# - 1], 
                    $CellContext`Y$[# - 1]}, {
                    $CellContext`X$[#], 
                    $CellContext`Y$[# - 1]}, {
                    $CellContext`X$[#], 
                    $CellContext`Y$[#]}}]& , 
                 Range[$CellContext`n$ - 1]], 
                Line[{{
                   $CellContext`X$[0], 
                   $CellContext`Y$[0]}, {
                   $CellContext`X$[0], 
                   $CellContext`YN1$[$CellContext`xN$]}}], 
                Line[{{
                   $CellContext`X$[$CellContext`n$ - 1], 
                   $CellContext`Y$[$CellContext`n$ - 1]}, {$CellContext`x0$$, 
                   $CellContext`Y$[$CellContext`n$ - 1]}}], 
                If[$CellContext`HTS$$ == False, {
                  If[$CellContext`n$ < 30, 
                   Map[Text[
                    Style[
                    Row[{" ", $CellContext`n$ + 1 - #, " "}], 17, Background -> 
                    White], {
                    $CellContext`X$[# - 1], 
                    $CellContext`Y$[# - 1]}, {-1, 1}]& , 
                    Range[
                    If[$CellContext`n$ <= 8, $CellContext`n$, 8]]]], 
                  If[$CellContext`n$ > 8, 
                   Text[
                    Style[
                    Row[{" ", 1, " "}], 17, Background -> White], {
                    $CellContext`X$[$CellContext`n$ - 1], 
                    $CellContext`Y$[$CellContext`n$ - 1]}, {-1, 
                    1}]], {$CellContext`colL$, Dashed, 
                   
                   Line[{{$CellContext`x0$$, $CellContext`y1$$}, \
{$CellContext`x0$$, 0}}], $CellContext`colV$, 
                   
                   Line[{{0, $CellContext`y1$$}, {$CellContext`x0$$, \
$CellContext`y1$$}}]}, 
                  Text[
                   Style[
                    Subscript[
                    Style["y", Italic], 1], 17, $CellContext`colV$, 
                    Background -> White], {0, $CellContext`y1$$}, {1.2, 0}], 
                  Text[
                   Style[
                    Subscript[
                    Style["x", Italic], 0], 17, $CellContext`colL$, 
                    Background -> White], {$CellContext`x0$$, 0}, {0, 1.2}], {
                   PointSize[0.025], $CellContext`colL$, 
                   Point[{$CellContext`x0$$, 0}], $CellContext`colV$, 
                   Point[{0, $CellContext`y1$$}], $CellContext`colL$, 
                   Point[{$CellContext`xN$, 
                    $CellContext`yeq$[$CellContext`xN$]}]}, {
                  Dashed, $CellContext`colL$, 
                   Line[{{$CellContext`xN$, 0}, {$CellContext`xN$, 
                    $CellContext`yeq$[$CellContext`xN$]}}], 
                   Text[
                    Framed[
                    Style[
                    Subscript["x", $CellContext`n$], 18, Italic], Background -> 
                    White, FrameStyle -> None, FrameMargins -> 
                    Tiny], {$CellContext`xN$, 0.25 $CellContext`yN1$$}]}}], {
                Dashed, $CellContext`colV$, 
                 
                 Line[{{0, $CellContext`yN1$$}, {$CellContext`xeq$, \
$CellContext`yN1$$}}], 
                 Text[
                  Framed[
                   Style[
                    Subscript[
                    Style["y", Italic], $CellContext`n$ + 1], 18], Background -> 
                   White, FrameStyle -> None, FrameMargins -> Tiny], {
                  0.15, $CellContext`yN1$$}]}, 
                If[$CellContext`HTS$$, {
                  PointSize[0.025], {$CellContext`colL$, 
                   Map[Point[{
                    $CellContext`X$[#], 
                    $CellContext`yeq$[
                    $CellContext`X$[#]]}]& , 
                    Range[0, $CellContext`n$ - 1]], 
                   Point[{$CellContext`x0$$, 0}]}, {$CellContext`colV$, 
                   Map[Point[{
                    $CellContext`X$[#], 
                    $CellContext`YN1$[
                    $CellContext`X$[#]]}]& , 
                    Range[0, $CellContext`n$]]}, 
                  Map[Text[
                    Style[
                    Row[{$CellContext`n$ + 1 - #, ", ", 
                    Style[
                    Subscript[
                    Style["x", Italic], $CellContext`n$ + 
                    1 - #], $CellContext`colL$], ", ", 
                    Style[
                    Subscript[
                    Style["y", Italic], $CellContext`n$ + 
                    1 - #], $CellContext`colV$]}], 17], {
                    $CellContext`X$[# - 1], 
                    $CellContext`yeq$[
                    $CellContext`X$[# - 1]]}, {-1.2, 1}]& , 
                   Range[$CellContext`n$]], 
                  Text[
                   Style[
                    Subscript[
                    Style["x", Italic], 0], 
                    17, $CellContext`colL$], {$CellContext`x0$$, 
                    0}, {-1.2, -1}], 
                  Text[
                   Style[
                    Row[{
                    Style[
                    Subscript["y", "n"], Italic, $CellContext`colV$], 
                    " is in equilibrium with ", 
                    Style[
                    Subscript["x", "n"], Italic, $CellContext`colL$]}], 17], {
                   0.4, 3}], 
                  Text[
                   Style[
                    Column[{
                    Row[{"stage ", $CellContext`tray$$, " solute fluxes:"}], 
                    Column[{
                    Row[{"in: ", 
                    
                    NumberForm[$CellContext`X$[$CellContext`n$ + 
                    1 - $CellContext`tray$$] $CellContext`L$$ + \
$CellContext`YN1$[
                    $CellContext`X$[$CellContext`n$ + 1 - $CellContext`tray$$ - 
                    1]] $CellContext`V$, {4, 1}], " mol/h"}], 
                    Row[{"out: ", 
                    
                    NumberForm[$CellContext`X$[$CellContext`n$ + 
                    1 - $CellContext`tray$$ - 
                    1] $CellContext`L$$ + $CellContext`YN1$[
                    $CellContext`X$[$CellContext`n$ + 
                    1 - $CellContext`tray$$]] $CellContext`V$, {4, 1}], 
                    " mol/h"}]}, Alignment -> ":"]}, Center], 17], {0.2, 48}], 
                  Text[
                   Style["top", 17, Background -> White], {0.04, 6}], 
                  Text[
                   Style["bottom", 17, Background -> White], {0.63, 
                   61.1}]}]}]], 
             Mouseover[{Transparent, 
               Thickness[0.04], 
               CapForm[None], 
               If[$CellContext`LoVmin$$, 
                Line[{{0, 
                   $CellContext`yLVmin$[0]}, {$CellContext`xeq$, 
                   $CellContext`yLVmin$[$CellContext`xeq$]}}], 
                Line[
                 Map[{#, 
                   $CellContext`YN1$[#]}& , 
                  Range[0, $CellContext`xeq$, 0.01]]]]}, {
               Thickness[0.02], Magenta, 
               If[$CellContext`LoVmin$$, 
                Line[{{0, 
                   $CellContext`yLVmin$[0]}, {$CellContext`xeq$, 
                   $CellContext`yLVmin$[$CellContext`xeq$]}}], 
                Line[
                 Map[{#, 
                   $CellContext`YN1$[#]}& , 
                  Range[0, 
                   ReplaceAll[$CellContext`x, 
                    Part[
                    
                    Solve[$CellContext`YN1$[$CellContext`x] == \
$CellContext`yN1$$ + 5, $CellContext`x], 1]], 0.01]]]], 
               Text[
                Style[
                 Column[{"operating line", "(mass balance)"}, Center], 17, 
                 Magenta], 
                
                If[$CellContext`HTS$$, {
                 0.75 $CellContext`xeq$, 0.25 $CellContext`yN1$$}, {
                 0.25 $CellContext`xeq$, 0.7 $CellContext`yN1$$}]]}], 
             Mouseover[{Transparent, 
               Thickness[0.04], 
               CapForm[None], 
               Line[
                Map[{#, 
                  $CellContext`yeq$[#]}& , 
                 Range[0, $CellContext`xeq$, 0.01]]]}, {
               Thickness[0.02], 
               RGBColor[1, 0.4, 0], 
               Line[
                Map[{#, 
                  $CellContext`yeq$[#]}& , 
                 Range[0, $CellContext`xeq$, 0.01]]], 
               Text[
                Style["equilibrium line", 17, 
                 RGBColor[1, 0.4, 0]], 
                
                If[$CellContext`HTS$$, {
                 0.75 $CellContext`xeq$, 0.25 $CellContext`yN1$$}, {
                 0.25 $CellContext`xeq$, 
                  0.7 $CellContext`yN1$$}]]}]}]; $CellContext`column$ = 
         Show[$CellContext`tank$, Epilog -> {Thick, 
             Text[
              Style[
               Column[{"liquid solvent feed", 
                 Row[{
                   Style["L", Italic], " = ", 
                   NumberForm[$CellContext`L$$, {4, 0}], " Mmol/h"}]}, Right],
                17, $CellContext`colL$], {$CellContext`w$, $CellContext`h$ + \
$CellContext`h$/4}, {0.2, -1.2}], 
             Text[
              Style[
               Column[{"vapor feed", 
                 Row[{
                   Style["V", Italic], " = ", 
                   NumberForm[$CellContext`V$, 2], " Mmol/h"}]}], 
               17, $CellContext`colV$], {0, (-$CellContext`h$)/4}, {0, 1.4}], 
             Apply[Text[
               Style[
                Row[{
                  Subscript[
                   Style["y", Italic], #2], " = ", #, " ppm"}], 
                17, $CellContext`colV$, Background -> White], {
               0, #3}]& , {{$CellContext`y1$$, 1, $CellContext`h$ + 
                2}, {$CellContext`yN1$$, $CellContext`n$ + 1, -2}}, {1}], 
             Apply[Text[
               Style[
                Row[{
                  Subscript[
                   Style["x", Italic], #2], " = ", #, " ppm"}], 
                17, $CellContext`colL$, Background -> 
                White], {$CellContext`w$, #3}]& , {{$CellContext`x0$$, 
                0, $CellContext`h$ + 2.25}, {
                NumberForm[$CellContext`xN$, 2], $CellContext`n$, -2}}, {1}], 
             Text[
              Style[
               Row[{
                 Style["L", Italic], "/", 
                 Style["V", Italic], " = ", 
                 NumberForm[$CellContext`L$$/$CellContext`V$, {4, 0}]}], 
               17], {$CellContext`w$/2, 0.33 $CellContext`h$}], 
             Text[
              Style[
               If[$CellContext`LoVmin$$, 
                Style[
                 Row[{
                   Subscript[
                    Row[{"(", 
                    Style["L", Italic], "/", 
                    Style["V", Italic], ")"}], "min"], " = ", 
                   
                   NumberForm[($CellContext`yeq$[$CellContext`xeq$] - \
$CellContext`y1$$)/($CellContext`xeq$ - $CellContext`x0$$), {5, 1}]}], 17, 
                 Purple], 
                Row[{
                  If[
                   
                   And[$CellContext`yeq$[$CellContext`check$] < \
$CellContext`yN1$$, $CellContext`check$ > 0], Infinity, $CellContext`n$], 
                  " stages needed"}]], 17], {$CellContext`w$/2, 
               0.66 $CellContext`h$}]}, ImageSize -> {230, 370}, AspectRatio -> 
           Full, PlotRange -> {{(-$CellContext`w$)/
              2.13, $CellContext`w$ + $CellContext`w$/
               2.3}, {(-$CellContext`h$)/
              5, $CellContext`h$ + $CellContext`h$/7}}, 
           PlotRangePadding -> {None, {
              Scaled[0.15], 
              Scaled[0.2]}}]; $CellContext`stages$ = 
         Module[{$CellContext`w0$, $CellContext`h0$}, $CellContext`w0$ = 
            1; $CellContext`h0$ = 0.5; Graphics[{Thick, {
               EdgeForm[Thick], 
               FaceForm[None], 
               Map[
               Rectangle[{0, #}, {$CellContext`w0$, # + $CellContext`h0$}]& , 
                Range[5]]}, {
               Arrowheads[0.22], {$CellContext`colV$, 
                Map[
                Arrow[{{0.25 $CellContext`w0$, # - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, #}}]& , 
                 Range[2, 5]], 
                
                Arrow[{{0, 1 - $CellContext`h0$}, {
                  0.25 $CellContext`w0$, 1 - $CellContext`h0$}, {
                  0.25 $CellContext`w0$, 1}}], 
                
                Arrow[{{0.25 $CellContext`w0$, 6 - $CellContext`h0$}, {
                  0.25 $CellContext`w0$, 6}, {(-0.1) $CellContext`w0$, 
                   6}}]}, {$CellContext`colL$, 
                Map[
                Arrow[{{0.75 $CellContext`w0$, #}, {
                   0.75 $CellContext`w0$, # - $CellContext`h0$}}]& , 
                 Range[2, 5]], 
                
                Arrow[{{0.75 $CellContext`w0$, 1}, {
                  0.75 $CellContext`w0$, 1 - $CellContext`h0$}, {
                  1.1 $CellContext`w0$, 1 - $CellContext`h0$}}], 
                
                Arrow[{{$CellContext`w0$, 6}, {0.75 $CellContext`w0$, 6}, {
                  0.75 $CellContext`w0$, 6 - $CellContext`h0$}}]}}, 
              Map[Text[
                Style[$CellContext`n$ + 1 - #, 17, Background -> White], {
                0.5 $CellContext`w0$, 0.5 $CellContext`h0$ + #}]& , 
               Range[5]], 
              Map[Text[
                Style[
                 Row[{
                   Subscript[
                    Style["y", Italic], 6 - #], " = ", 
                   NumberForm[
                    $CellContext`YN1$[
                    $CellContext`X$[#]], {2, 0}]}], 17, $CellContext`colV$, 
                 Background -> White], {
                0.25 $CellContext`w0$, # + 1 - 0.5 $CellContext`h0$}, {
                1.2, 0}]& , 
               Range[4]], 
              Text[
               Style[
                Column[{
                  Row[{$CellContext`V$, " Mmol/h"}], 
                  Row[{
                    Subscript[
                    Style["y", Italic], 1], " = ", 
                    NumberForm[
                    $CellContext`YN1$[
                    $CellContext`X$[$CellContext`n$]], {2, 0}]}]}, Center], 
                17, $CellContext`colV$], {
               0.25 $CellContext`w0$, 6 - 0.5 $CellContext`h0$}, {
               1.5, -0.75}], 
              Text[
               Style[
                Column[{
                  Row[{
                    Subscript[
                    Style["y", Italic], 6], " = ", 
                    NumberForm[
                    $CellContext`YN1$[
                    $CellContext`X$[0]], {2, 0}]}], 
                  Row[{$CellContext`V$, " Mmol/h"}]}, Center], 
                17, $CellContext`colV$], {0.25 $CellContext`w0$, 0.5}, {1.25, 
               0.4}], 
              Map[Text[
                Style[
                 Row[{
                   Subscript[
                    Style["x", Italic], 6 - #], " = ", 
                   NumberForm[
                    $CellContext`X$[# - 1], {2, 2}]}], 17, $CellContext`colL$,
                  Background -> White], {
                0.75 $CellContext`w0$, # - 0.5 $CellContext`h0$}, {-1.5, 
                 0}]& , 
               Range[2, 5]], 
              Text[
               Style[
                Column[{
                  Row[{$CellContext`L$$, " Mmol/h"}], 
                  Row[{
                    Subscript[
                    Style["x", Italic], 0], " = ", 
                    NumberForm[
                    $CellContext`X$[$CellContext`n$], {2, 2}]}]}, Center], 
                17, $CellContext`colL$], {$CellContext`w0$, 6 - 
                0.5 $CellContext`h0$}, {-1, -0.75}], 
              Text[
               Style[
                Column[{
                  Row[{
                    Subscript[
                    Style["x", Italic], $CellContext`n$], " = ", 
                    NumberForm[
                    $CellContext`X$[0], {2, 2}]}], 
                  Row[{$CellContext`L$$, " Mmol/h"}]}, Center], 
                17, $CellContext`colL$], {$CellContext`w0$, 0.5}, {-1, 0.4}], {
               Arrowheads[0.22], 
               Which[$CellContext`tray$$ == 5, {$CellContext`colV$, 
                 
                 Arrow[{{0, 1 - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, 1 - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, 1}}], 
                 
                 Arrow[{{0.25 $CellContext`w0$, 2 - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, 2}}], $CellContext`colL$, 
                 
                 Arrow[{{0.75 $CellContext`w0$, 1}, {
                   0.75 $CellContext`w0$, 1 - $CellContext`h0$}, {
                   1.1 $CellContext`w0$, 1 - $CellContext`h0$}}], 
                 
                 Arrow[{{0.75 $CellContext`w0$, 2}, {
                   0.75 $CellContext`w0$, 
                    2 - $CellContext`h0$}}]}, $CellContext`tray$$ == 
                1, {$CellContext`colV$, 
                 
                 Arrow[{{0.25 $CellContext`w0$, 6 - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, 6}, {(-0.1) $CellContext`w0$, 6}}], 
                 
                 Arrow[{{0.25 $CellContext`w0$, 5 - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, 5}}], $CellContext`colL$, 
                 
                 Arrow[{{$CellContext`w0$, 6}, {0.75 $CellContext`w0$, 6}, {
                   0.75 $CellContext`w0$, 6 - $CellContext`h0$}}], 
                 
                 Arrow[{{0.75 $CellContext`w0$, 5}, {
                   0.75 $CellContext`w0$, 5 - $CellContext`h0$}}]}, 
                1 < $CellContext`tray$$ < 5, 
                Map[{$CellContext`colV$, 
                  
                  Arrow[{{
                    0.25 $CellContext`w0$, $CellContext`n$ + 
                    1 - $CellContext`tray$$ + # - $CellContext`h0$}, {
                    0.25 $CellContext`w0$, $CellContext`n$ + 
                    1 - $CellContext`tray$$ + #}}], $CellContext`colL$, 
                  
                  Arrow[{{
                    0.75 $CellContext`w0$, $CellContext`n$ + 
                    1 - $CellContext`tray$$ + #}, {
                    0.75 $CellContext`w0$, $CellContext`n$ + 
                    1 - $CellContext`tray$$ + # - $CellContext`h0$}}]}& , {0, 
                 1}]]}, {
               EdgeForm[
                Thickness[0.05]], 
               FaceForm[
                RGBColor[1, 1, 0.25]], 
               
               Rectangle[{
                0, $CellContext`n$ + 
                 1 - $CellContext`tray$$}, {$CellContext`w0$, $CellContext`n$ + 
                 1 - $CellContext`tray$$ + $CellContext`h0$}]}, 
              Text[
               Style[$CellContext`tray$$, 17, Bold], {
               0.5 $CellContext`w0$, 0.5 $CellContext`h0$ + $CellContext`n$ + 
                1 - $CellContext`tray$$}]}, ImageSize -> {230, 370}, 
             AspectRatio -> Full, PlotRange -> {0, 6.6}, PlotLabel -> 
             Style["mole ratios are in ppm", 17, Black]]]; 
        Grid[{{$CellContext`plot$, 
            
            If[$CellContext`HTS$$, $CellContext`stages$, \
$CellContext`column$]}}]], "Specifications" :> {{{$CellContext`yN1$$, 58, 
          Row[{"inlet vapor mole ratio ", 
            Subscript[
             Style["y", Italic], 
             Row[{
               Style["N", Italic], " + 1"}]], " (ppm)"}]}, 40, 120, 1, 
         Appearance -> "Labeled", ImageSize -> Small, Enabled -> Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 
         1}, {{$CellContext`T$$, 55, "temperature (\[Degree]C)"}, 10, 80, 5, 
         Appearance -> "Labeled", ImageSize -> Small, Enabled -> Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 2}, 
        Grid[{{
           Manipulate`Place[1], 
           Manipulate`Place[2]}}], {{$CellContext`P$$, 2.5, "pressure (atm)"},
          1.5, 3, 0.1, Appearance -> "Labeled", ImageSize -> Small, Enabled -> 
         Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 
         3}, {{$CellContext`L$$, 150, "solvent flow rate (Mmol/h)"}, 50, 300, 
         5, Appearance -> "Labeled", ImageSize -> Small, Enabled -> Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 4}, 
        Grid[{{
           Manipulate`Place[3], 
           Manipulate`Place[4]}}], {{$CellContext`y1$$, 18, 
          Row[{"outlet vapor ", 
            Subscript[
             Style["y", Italic], 1]}]}, 10, 25, 1, Appearance -> "Labeled", 
         ImageSize -> Small, Enabled -> Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 
         5}, {{$CellContext`x0$$, 0.05, 
          Row[{"inlet liquid ", 
            Subscript[
             Style["x", Italic], 0]}]}, 0, 0.25, 0.01, Appearance -> 
         "Labeled", ImageSize -> Small, Enabled -> Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 6}, 
        Grid[{{"mole ratios (ppm):", 
           Manipulate`Place[5], 
           Manipulate`Place[6]}}], {{$CellContext`LoVmin$$, False, 
          Subscript[
           Row[{"(", 
             Style["L", Italic], "/", 
             Style["V", Italic], ")"}], "min"]}, {True, False}, Enabled -> 
         Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 
         7}, {{$CellContext`HTS$$, False, "show diagram with 5 stages"}, {
         True, False}, ControlPlacement -> 
         8}, {{$CellContext`tray$$, 1, "stage"}, 1, 5, 1, Appearance -> 
         "Labeled", ControlPlacement -> 9}, 
        Grid[{{
           Manipulate`Place[7], 
           Manipulate`Place[8], 
           Spacer[10], 
           PaneSelector[{True -> Manipulate`Place[9]}, 
            Dynamic[$CellContext`HTS$$]]}}]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->860087793,ExpressionUUID->"bb7d482c-6459-42b6-9200-fe4ec1c06b3f"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`HTS$$ = True, $CellContext`L$$ = 
    100, $CellContext`LoVmin$$ = False, $CellContext`P$$ = 
    2.5, $CellContext`T$$ = 25, $CellContext`tray$$ = 1, $CellContext`x0$$ = 
    0.05, $CellContext`y1$$ = 10, $CellContext`yN1$$ = 59, Typeset`show$$ = 
    True, Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`yN1$$], 59, 
       Row[{"inlet vapor mole ratio ", 
         Subscript[
          Style["y", Italic], 
          Row[{
            Style["N", Italic], " + 1"}]], " (ppm)"}]}, 40, 120, 1}, {{
       Hold[$CellContext`T$$], 25, "temperature (\[Degree]C)"}, 10, 80, 5}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], 
          Manipulate`Place[2]}}]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`P$$], 2.5, "pressure (atm)"}, 1.5, 3, 0.1}, {{
       Hold[$CellContext`L$$], 100, "solvent flow rate (Mmol/h)"}, 50, 300, 
      5}, {
      Hold[
       Grid[{{
          Manipulate`Place[3], 
          Manipulate`Place[4]}}]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`y1$$], 10, 
       Row[{"outlet vapor ", 
         Subscript[
          Style["y", Italic], 1]}]}, 10, 25, 1}, {{
       Hold[$CellContext`x0$$], 0.05, 
       Row[{"inlet liquid ", 
         Subscript[
          Style["x", Italic], 0]}]}, 0, 0.25, 0.01}, {
      Hold[
       Grid[{{"mole ratios (ppm):", 
          Manipulate`Place[5], 
          Manipulate`Place[6]}}]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`LoVmin$$], False, 
       Subscript[
        Row[{"(", 
          Style["L", Italic], "/", 
          Style["V", Italic], ")"}], "min"]}, {True, False}}, {{
       Hold[$CellContext`HTS$$], True, "show diagram with 5 stages"}, {
      True, False}}, {{
       Hold[$CellContext`tray$$], 1, "stage"}, 1, 5, 1}, {
      Hold[
       Grid[{{
          Manipulate`Place[7], 
          Manipulate`Place[8], 
          Spacer[10], 
          PaneSelector[{True -> Manipulate`Place[9]}, 
           Dynamic[$CellContext`HTS$$]]}}]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = Automatic, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`yN1$20046$$ = 0, $CellContext`T$20047$$ = 
    0, $CellContext`P$20048$$ = 0, $CellContext`L$20049$$ = 
    0, $CellContext`y1$20050$$ = 0, $CellContext`x0$20051$$ = 
    0, $CellContext`LoVmin$20052$$ = False, $CellContext`HTS$20053$$ = 
    False, $CellContext`tray$20054$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`HTS$$ = True, $CellContext`L$$ = 
        100, $CellContext`LoVmin$$ = False, $CellContext`P$$ = 
        2.5, $CellContext`T$$ = 25, $CellContext`tray$$ = 
        1, $CellContext`x0$$ = 0.05, $CellContext`y1$$ = 
        10, $CellContext`yN1$$ = 59}, "ControllerVariables" :> {
        Hold[$CellContext`yN1$$, $CellContext`yN1$20046$$, 0], 
        Hold[$CellContext`T$$, $CellContext`T$20047$$, 0], 
        Hold[$CellContext`P$$, $CellContext`P$20048$$, 0], 
        Hold[$CellContext`L$$, $CellContext`L$20049$$, 0], 
        Hold[$CellContext`y1$$, $CellContext`y1$20050$$, 0], 
        Hold[$CellContext`x0$$, $CellContext`x0$20051$$, 0], 
        Hold[$CellContext`LoVmin$$, $CellContext`LoVmin$20052$$, False], 
        Hold[$CellContext`HTS$$, $CellContext`HTS$20053$$, False], 
        Hold[$CellContext`tray$$, $CellContext`tray$20054$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`Ea$, $CellContext`R$, $CellContext`T0$, \
$CellContext`H0$, $CellContext`HB$, $CellContext`V$, $CellContext`YN1$, \
$CellContext`yeq$, $CellContext`xeq$, $CellContext`check$, \
$CellContext`yLVmin$, $CellContext`xN$, $CellContext`X$, $CellContext`Y$, \
$CellContext`n0$, $CellContext`n$, $CellContext`colL$, $CellContext`colV$, \
$CellContext`h$, $CellContext`w$, $CellContext`ry$, $CellContext`tank$, \
$CellContext`plot$, $CellContext`column$, $CellContext`stages$}, 
        If[$CellContext`HTS$$, {$CellContext`yN1$$ = 59; $CellContext`T$$ = 
            25; $CellContext`P$$ = 2.5; $CellContext`L$$ = 
            100; $CellContext`y1$$ = 10; $CellContext`x0$$ = 
            0.05; $CellContext`LoVmin$$ = False; Null}]; $CellContext`Ea$ = 
         5000; $CellContext`R$ = 8.314; $CellContext`T0$ = 
         298; $CellContext`H0$ = 
         211.19; $CellContext`HB$ = $CellContext`H0$ 
          Exp[(-($CellContext`Ea$/$CellContext`R$)) (
             1/($CellContext`T$$ + 273) - 
             1/$CellContext`T0$)]; $CellContext`V$ = 1; $CellContext`YN1$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := ($CellContext`L$$/$CellContext`V$) ($CellContext`x$ - \
$CellContext`x0$$) + $CellContext`y1$$; $CellContext`yeq$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := ($CellContext`HB$/$CellContext`P$$) $CellContext`x$; \
$CellContext`xeq$ = ReplaceAll[$CellContext`x, 
           Quiet[
            Part[
             
             Solve[$CellContext`yeq$[$CellContext`x] == $CellContext`yN1$$, \
$CellContext`x], 1]]]; $CellContext`check$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yeq$[$CellContext`x] == \
$CellContext`YN1$[$CellContext`x], $CellContext`x], 1]]; $CellContext`yLVmin$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yeq$[$CellContext`xeq$] - \
$CellContext`y1$$)/($CellContext`xeq$ - $CellContext`x0$$)) ($CellContext`x$ - \
$CellContext`x0$$) + $CellContext`y1$$; $CellContext`xN$ = \
($CellContext`yN1$$ - $CellContext`y1$$)/($CellContext`L$$/$CellContext`V$) + \
$CellContext`x0$$; $CellContext`X$[0] = $CellContext`xN$; $CellContext`Y$[
          0] = $CellContext`yeq$[$CellContext`xN$]; 
        Do[{$CellContext`X$[$CellContext`i] = ReplaceAll[$CellContext`x, 
             Quiet[
              Part[
               
               Solve[$CellContext`YN1$[$CellContext`x] == \
$CellContext`Y$[$CellContext`i - 1], $CellContext`x], 
               1]]], $CellContext`Y$[$CellContext`i] = $CellContext`yeq$[
             $CellContext`X$[$CellContext`i]]}, {$CellContext`i, 1, 
           50}]; $CellContext`n0$ = DeleteCases[
           Map[If[$CellContext`X$[#] < $CellContext`x0$$, 0, #]& , 
            Range[50]], 0]; $CellContext`n$ = 
         If[Length[$CellContext`n0$] == 0, 1, 1 + 
           Part[$CellContext`n0$, -1]]; $CellContext`colV$ = 
         RGBColor[0, 0.5, 0]; $CellContext`colL$ = 
         RGBColor[0, 0, 0.75]; $CellContext`h$ = 13; $CellContext`w$ = 
         12; $CellContext`ry$ = 2; $CellContext`tank$ = Graphics[{Thick, 
            Map[
            Line[{{#, $CellContext`ry$}, {#, $CellContext`h$ - \
$CellContext`ry$}}]& , {0, $CellContext`w$}], 
            
            Circle[{$CellContext`w$/2, $CellContext`ry$}, {$CellContext`w$/
              2, $CellContext`ry$}, {Pi, 2 Pi}], 
            
            Circle[{$CellContext`w$/
              2, $CellContext`h$ - $CellContext`ry$}, {$CellContext`w$/
              2, $CellContext`ry$}, {0, Pi}], {
             Arrowheads[0.1], $CellContext`colV$, 
             
             Arrow[{{(-$CellContext`w$)/2, (-$CellContext`h$)/4}, {
               0.25 $CellContext`w$, (-$CellContext`h$)/4}, {
               0.25 $CellContext`w$, $CellContext`ry$/10}}], 
             
             Arrow[{{0.25 $CellContext`w$, $CellContext`h$ - $CellContext`ry$/
                10}, {0.25 $CellContext`w$, $CellContext`h$ + $CellContext`h$/
                 4}, {(-$CellContext`w$)/
                2, $CellContext`h$ + $CellContext`h$/4}}], $CellContext`colL$, 
             
             Arrow[{{0.75 $CellContext`w$, $CellContext`ry$/10}, {
               0.75 $CellContext`w$, (-$CellContext`h$)/
                4}, {$CellContext`w$ + $CellContext`w$/
                 2.3, (-$CellContext`h$)/4}}], 
             
             Arrow[{{$CellContext`w$ + $CellContext`w$/
                 2.3, $CellContext`h$ + $CellContext`h$/4}, {
               0.75 $CellContext`w$, $CellContext`h$ + $CellContext`h$/4}, {
               0.75 $CellContext`w$, $CellContext`h$ - $CellContext`ry$/
                10}}]}}, ImageSize -> {230, 390}, AspectRatio -> Full, 
           PlotRange -> {{(-$CellContext`w$)/
              2.13, $CellContext`w$ + $CellContext`w$/
               2.3}, {(-$CellContext`h$)/
              5, $CellContext`h$ + $CellContext`h$/7}}, 
           PlotRangePadding -> {None, {
              Scaled[0.15], 
              Scaled[0.17]}}]; $CellContext`plot$ = Plot[{
            $CellContext`YN1$[$CellContext`x], 
            $CellContext`yeq$[$CellContext`x]}, {$CellContext`x, 
            0, $CellContext`xeq$}, PlotStyle -> {{Thick, 
              If[$CellContext`LoVmin$$, Transparent, Magenta]}, {Thick, 
              RGBColor[1, 0.4, 0]}}, PlotRange -> {0, $CellContext`yN1$$ + 5},
            PlotRangePadding -> None, PlotRangeClipping -> False, Frame -> 
           True, FrameLabel -> {
             Row[{"solute/(solute-free liquid) ", 
               Style["x", Italic], " (ppm)"}], 
             Row[{"solute/(solute-free vapor) ", 
               Style["y", Italic], " (ppm)"}]}, LabelStyle -> {17, Black}, 
           ImageSize -> {370, 370}, AspectRatio -> Full, 
           ImagePadding -> {{55, 25}, {50, 5}}, Epilog -> {Thick, 
             If[$CellContext`LoVmin$$, {Thick, Magenta, 
               Line[{{0, 
                  $CellContext`yLVmin$[0]}, {$CellContext`xeq$, 
                  $CellContext`yLVmin$[$CellContext`xeq$]}}]}, 
              If[
               
               And[$CellContext`yeq$[$CellContext`check$] < \
$CellContext`yN1$$, $CellContext`check$ > 0], 
               Text[
                Framed[
                 Column[{
                   Style["separation not possible", 20, 
                    RGBColor[0.85, 0, 0]], 
                   Style["\[Star]infinite stages needed\[Star]", 17]}, 
                  Center], Background -> White], {
                0.55 $CellContext`xeq$, 0.6 $CellContext`yN1$$}], {
                Map[Line[{{
                    $CellContext`X$[# - 1], 
                    $CellContext`Y$[# - 1]}, {
                    $CellContext`X$[#], 
                    $CellContext`Y$[# - 1]}, {
                    $CellContext`X$[#], 
                    $CellContext`Y$[#]}}]& , 
                 Range[$CellContext`n$ - 1]], 
                Line[{{
                   $CellContext`X$[0], 
                   $CellContext`Y$[0]}, {
                   $CellContext`X$[0], 
                   $CellContext`YN1$[$CellContext`xN$]}}], 
                Line[{{
                   $CellContext`X$[$CellContext`n$ - 1], 
                   $CellContext`Y$[$CellContext`n$ - 1]}, {$CellContext`x0$$, 
                   $CellContext`Y$[$CellContext`n$ - 1]}}], 
                If[$CellContext`HTS$$ == False, {
                  If[$CellContext`n$ < 30, 
                   Map[Text[
                    Style[
                    Row[{" ", $CellContext`n$ + 1 - #, " "}], 17, Background -> 
                    White], {
                    $CellContext`X$[# - 1], 
                    $CellContext`Y$[# - 1]}, {-1, 1}]& , 
                    Range[
                    If[$CellContext`n$ <= 8, $CellContext`n$, 8]]]], 
                  If[$CellContext`n$ > 8, 
                   Text[
                    Style[
                    Row[{" ", 1, " "}], 17, Background -> White], {
                    $CellContext`X$[$CellContext`n$ - 1], 
                    $CellContext`Y$[$CellContext`n$ - 1]}, {-1, 
                    1}]], {$CellContext`colL$, Dashed, 
                   
                   Line[{{$CellContext`x0$$, $CellContext`y1$$}, \
{$CellContext`x0$$, 0}}], $CellContext`colV$, 
                   
                   Line[{{0, $CellContext`y1$$}, {$CellContext`x0$$, \
$CellContext`y1$$}}]}, 
                  Text[
                   Style[
                    Subscript[
                    Style["y", Italic], 1], 17, $CellContext`colV$, 
                    Background -> White], {0, $CellContext`y1$$}, {1.2, 0}], 
                  Text[
                   Style[
                    Subscript[
                    Style["x", Italic], 0], 17, $CellContext`colL$, 
                    Background -> White], {$CellContext`x0$$, 0}, {0, 1.2}], {
                   PointSize[0.025], $CellContext`colL$, 
                   Point[{$CellContext`x0$$, 0}], $CellContext`colV$, 
                   Point[{0, $CellContext`y1$$}], $CellContext`colL$, 
                   Point[{$CellContext`xN$, 
                    $CellContext`yeq$[$CellContext`xN$]}]}, {
                  Dashed, $CellContext`colL$, 
                   Line[{{$CellContext`xN$, 0}, {$CellContext`xN$, 
                    $CellContext`yeq$[$CellContext`xN$]}}], 
                   Text[
                    Framed[
                    Style[
                    Subscript["x", $CellContext`n$], 18, Italic], Background -> 
                    White, FrameStyle -> None, FrameMargins -> 
                    Tiny], {$CellContext`xN$, 0.25 $CellContext`yN1$$}]}}], {
                Dashed, $CellContext`colV$, 
                 
                 Line[{{0, $CellContext`yN1$$}, {$CellContext`xeq$, \
$CellContext`yN1$$}}], 
                 Text[
                  Framed[
                   Style[
                    Subscript[
                    Style["y", Italic], $CellContext`n$ + 1], 18], Background -> 
                   White, FrameStyle -> None, FrameMargins -> Tiny], {
                  0.15, $CellContext`yN1$$}]}, 
                If[$CellContext`HTS$$, {
                  PointSize[0.025], {$CellContext`colL$, 
                   Map[Point[{
                    $CellContext`X$[#], 
                    $CellContext`yeq$[
                    $CellContext`X$[#]]}]& , 
                    Range[0, $CellContext`n$ - 1]], 
                   Point[{$CellContext`x0$$, 0}]}, {$CellContext`colV$, 
                   Map[Point[{
                    $CellContext`X$[#], 
                    $CellContext`YN1$[
                    $CellContext`X$[#]]}]& , 
                    Range[0, $CellContext`n$]]}, 
                  Map[Text[
                    Style[
                    Row[{$CellContext`n$ + 1 - #, ", ", 
                    Style[
                    Subscript[
                    Style["x", Italic], $CellContext`n$ + 
                    1 - #], $CellContext`colL$], ", ", 
                    Style[
                    Subscript[
                    Style["y", Italic], $CellContext`n$ + 
                    1 - #], $CellContext`colV$]}], 17], {
                    $CellContext`X$[# - 1], 
                    $CellContext`yeq$[
                    $CellContext`X$[# - 1]]}, {-1.2, 1}]& , 
                   Range[$CellContext`n$]], 
                  Text[
                   Style[
                    Subscript[
                    Style["x", Italic], 0], 
                    17, $CellContext`colL$], {$CellContext`x0$$, 
                    0}, {-1.2, -1}], 
                  Text[
                   Style[
                    Row[{
                    Style[
                    Subscript["y", "n"], Italic, $CellContext`colV$], 
                    " is in equilibrium with ", 
                    Style[
                    Subscript["x", "n"], Italic, $CellContext`colL$]}], 17], {
                   0.4, 3}], 
                  Text[
                   Style[
                    Column[{
                    Row[{"stage ", $CellContext`tray$$, " solute fluxes:"}], 
                    Column[{
                    Row[{"in: ", 
                    
                    NumberForm[$CellContext`X$[$CellContext`n$ + 
                    1 - $CellContext`tray$$] $CellContext`L$$ + \
$CellContext`YN1$[
                    $CellContext`X$[$CellContext`n$ + 1 - $CellContext`tray$$ - 
                    1]] $CellContext`V$, {4, 1}], " mol/h"}], 
                    Row[{"out: ", 
                    
                    NumberForm[$CellContext`X$[$CellContext`n$ + 
                    1 - $CellContext`tray$$ - 
                    1] $CellContext`L$$ + $CellContext`YN1$[
                    $CellContext`X$[$CellContext`n$ + 
                    1 - $CellContext`tray$$]] $CellContext`V$, {4, 1}], 
                    " mol/h"}]}, Alignment -> ":"]}, Center], 17], {0.2, 48}], 
                  Text[
                   Style["top", 17, Background -> White], {0.04, 6}], 
                  Text[
                   Style["bottom", 17, Background -> White], {0.63, 
                   61.1}]}]}]], 
             Mouseover[{Transparent, 
               Thickness[0.04], 
               CapForm[None], 
               If[$CellContext`LoVmin$$, 
                Line[{{0, 
                   $CellContext`yLVmin$[0]}, {$CellContext`xeq$, 
                   $CellContext`yLVmin$[$CellContext`xeq$]}}], 
                Line[
                 Map[{#, 
                   $CellContext`YN1$[#]}& , 
                  Range[0, $CellContext`xeq$, 0.01]]]]}, {
               Thickness[0.02], Magenta, 
               If[$CellContext`LoVmin$$, 
                Line[{{0, 
                   $CellContext`yLVmin$[0]}, {$CellContext`xeq$, 
                   $CellContext`yLVmin$[$CellContext`xeq$]}}], 
                Line[
                 Map[{#, 
                   $CellContext`YN1$[#]}& , 
                  Range[0, 
                   ReplaceAll[$CellContext`x, 
                    Part[
                    
                    Solve[$CellContext`YN1$[$CellContext`x] == \
$CellContext`yN1$$ + 5, $CellContext`x], 1]], 0.01]]]], 
               Text[
                Style[
                 Column[{"operating line", "(mass balance)"}, Center], 17, 
                 Magenta], 
                
                If[$CellContext`HTS$$, {
                 0.75 $CellContext`xeq$, 0.25 $CellContext`yN1$$}, {
                 0.25 $CellContext`xeq$, 0.7 $CellContext`yN1$$}]]}], 
             Mouseover[{Transparent, 
               Thickness[0.04], 
               CapForm[None], 
               Line[
                Map[{#, 
                  $CellContext`yeq$[#]}& , 
                 Range[0, $CellContext`xeq$, 0.01]]]}, {
               Thickness[0.02], 
               RGBColor[1, 0.4, 0], 
               Line[
                Map[{#, 
                  $CellContext`yeq$[#]}& , 
                 Range[0, $CellContext`xeq$, 0.01]]], 
               Text[
                Style["equilibrium line", 17, 
                 RGBColor[1, 0.4, 0]], 
                
                If[$CellContext`HTS$$, {
                 0.75 $CellContext`xeq$, 0.25 $CellContext`yN1$$}, {
                 0.25 $CellContext`xeq$, 
                  0.7 $CellContext`yN1$$}]]}]}]; $CellContext`column$ = 
         Show[$CellContext`tank$, Epilog -> {Thick, 
             Text[
              Style[
               Column[{"liquid solvent feed", 
                 Row[{
                   Style["L", Italic], " = ", 
                   NumberForm[$CellContext`L$$, {4, 0}], " Mmol/h"}]}, Right],
                17, $CellContext`colL$], {$CellContext`w$, $CellContext`h$ + \
$CellContext`h$/4}, {0.2, -1.2}], 
             Text[
              Style[
               Column[{"vapor feed", 
                 Row[{
                   Style["V", Italic], " = ", 
                   NumberForm[$CellContext`V$, 2], " Mmol/h"}]}], 
               17, $CellContext`colV$], {0, (-$CellContext`h$)/4}, {0, 1.4}], 
             Apply[Text[
               Style[
                Row[{
                  Subscript[
                   Style["y", Italic], #2], " = ", #, " ppm"}], 
                17, $CellContext`colV$, Background -> White], {
               0, #3}]& , {{$CellContext`y1$$, 1, $CellContext`h$ + 
                2}, {$CellContext`yN1$$, $CellContext`n$ + 1, -2}}, {1}], 
             Apply[Text[
               Style[
                Row[{
                  Subscript[
                   Style["x", Italic], #2], " = ", #, " ppm"}], 
                17, $CellContext`colL$, Background -> 
                White], {$CellContext`w$, #3}]& , {{$CellContext`x0$$, 
                0, $CellContext`h$ + 2.25}, {
                NumberForm[$CellContext`xN$, 2], $CellContext`n$, -2}}, {1}], 
             Text[
              Style[
               Row[{
                 Style["L", Italic], "/", 
                 Style["V", Italic], " = ", 
                 NumberForm[$CellContext`L$$/$CellContext`V$, {4, 0}]}], 
               17], {$CellContext`w$/2, 0.33 $CellContext`h$}], 
             Text[
              Style[
               If[$CellContext`LoVmin$$, 
                Style[
                 Row[{
                   Subscript[
                    Row[{"(", 
                    Style["L", Italic], "/", 
                    Style["V", Italic], ")"}], "min"], " = ", 
                   
                   NumberForm[($CellContext`yeq$[$CellContext`xeq$] - \
$CellContext`y1$$)/($CellContext`xeq$ - $CellContext`x0$$), {5, 1}]}], 17, 
                 Purple], 
                Row[{
                  If[
                   
                   And[$CellContext`yeq$[$CellContext`check$] < \
$CellContext`yN1$$, $CellContext`check$ > 0], Infinity, $CellContext`n$], 
                  " stages needed"}]], 17], {$CellContext`w$/2, 
               0.66 $CellContext`h$}]}, ImageSize -> {230, 370}, AspectRatio -> 
           Full, PlotRange -> {{(-$CellContext`w$)/
              2.13, $CellContext`w$ + $CellContext`w$/
               2.3}, {(-$CellContext`h$)/
              5, $CellContext`h$ + $CellContext`h$/7}}, 
           PlotRangePadding -> {None, {
              Scaled[0.15], 
              Scaled[0.2]}}]; $CellContext`stages$ = 
         Module[{$CellContext`w0$, $CellContext`h0$}, $CellContext`w0$ = 
            1; $CellContext`h0$ = 0.5; Graphics[{Thick, {
               EdgeForm[Thick], 
               FaceForm[None], 
               Map[
               Rectangle[{0, #}, {$CellContext`w0$, # + $CellContext`h0$}]& , 
                Range[5]]}, {
               Arrowheads[0.22], {$CellContext`colV$, 
                Map[
                Arrow[{{0.25 $CellContext`w0$, # - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, #}}]& , 
                 Range[2, 5]], 
                
                Arrow[{{0, 1 - $CellContext`h0$}, {
                  0.25 $CellContext`w0$, 1 - $CellContext`h0$}, {
                  0.25 $CellContext`w0$, 1}}], 
                
                Arrow[{{0.25 $CellContext`w0$, 6 - $CellContext`h0$}, {
                  0.25 $CellContext`w0$, 6}, {(-0.1) $CellContext`w0$, 
                   6}}]}, {$CellContext`colL$, 
                Map[
                Arrow[{{0.75 $CellContext`w0$, #}, {
                   0.75 $CellContext`w0$, # - $CellContext`h0$}}]& , 
                 Range[2, 5]], 
                
                Arrow[{{0.75 $CellContext`w0$, 1}, {
                  0.75 $CellContext`w0$, 1 - $CellContext`h0$}, {
                  1.1 $CellContext`w0$, 1 - $CellContext`h0$}}], 
                
                Arrow[{{$CellContext`w0$, 6}, {0.75 $CellContext`w0$, 6}, {
                  0.75 $CellContext`w0$, 6 - $CellContext`h0$}}]}}, 
              Map[Text[
                Style[$CellContext`n$ + 1 - #, 17, Background -> White], {
                0.5 $CellContext`w0$, 0.5 $CellContext`h0$ + #}]& , 
               Range[5]], 
              Map[Text[
                Style[
                 Row[{
                   Subscript[
                    Style["y", Italic], 6 - #], " = ", 
                   NumberForm[
                    $CellContext`YN1$[
                    $CellContext`X$[#]], {2, 0}]}], 17, $CellContext`colV$, 
                 Background -> White], {
                0.25 $CellContext`w0$, # + 1 - 0.5 $CellContext`h0$}, {
                1.2, 0}]& , 
               Range[4]], 
              Text[
               Style[
                Column[{
                  Row[{$CellContext`V$, " Mmol/h"}], 
                  Row[{
                    Subscript[
                    Style["y", Italic], 1], " = ", 
                    NumberForm[
                    $CellContext`YN1$[
                    $CellContext`X$[$CellContext`n$]], {2, 0}]}]}, Center], 
                17, $CellContext`colV$], {
               0.25 $CellContext`w0$, 6 - 0.5 $CellContext`h0$}, {
               1.5, -0.75}], 
              Text[
               Style[
                Column[{
                  Row[{
                    Subscript[
                    Style["y", Italic], 6], " = ", 
                    NumberForm[
                    $CellContext`YN1$[
                    $CellContext`X$[0]], {2, 0}]}], 
                  Row[{$CellContext`V$, " Mmol/h"}]}, Center], 
                17, $CellContext`colV$], {0.25 $CellContext`w0$, 0.5}, {1.25, 
               0.4}], 
              Map[Text[
                Style[
                 Row[{
                   Subscript[
                    Style["x", Italic], 6 - #], " = ", 
                   NumberForm[
                    $CellContext`X$[# - 1], {2, 2}]}], 17, $CellContext`colL$,
                  Background -> White], {
                0.75 $CellContext`w0$, # - 0.5 $CellContext`h0$}, {-1.5, 
                 0}]& , 
               Range[2, 5]], 
              Text[
               Style[
                Column[{
                  Row[{$CellContext`L$$, " Mmol/h"}], 
                  Row[{
                    Subscript[
                    Style["x", Italic], 0], " = ", 
                    NumberForm[
                    $CellContext`X$[$CellContext`n$], {2, 2}]}]}, Center], 
                17, $CellContext`colL$], {$CellContext`w0$, 6 - 
                0.5 $CellContext`h0$}, {-1, -0.75}], 
              Text[
               Style[
                Column[{
                  Row[{
                    Subscript[
                    Style["x", Italic], $CellContext`n$], " = ", 
                    NumberForm[
                    $CellContext`X$[0], {2, 2}]}], 
                  Row[{$CellContext`L$$, " Mmol/h"}]}, Center], 
                17, $CellContext`colL$], {$CellContext`w0$, 0.5}, {-1, 0.4}], {
               Arrowheads[0.22], 
               Which[$CellContext`tray$$ == 5, {$CellContext`colV$, 
                 
                 Arrow[{{0, 1 - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, 1 - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, 1}}], 
                 
                 Arrow[{{0.25 $CellContext`w0$, 2 - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, 2}}], $CellContext`colL$, 
                 
                 Arrow[{{0.75 $CellContext`w0$, 1}, {
                   0.75 $CellContext`w0$, 1 - $CellContext`h0$}, {
                   1.1 $CellContext`w0$, 1 - $CellContext`h0$}}], 
                 
                 Arrow[{{0.75 $CellContext`w0$, 2}, {
                   0.75 $CellContext`w0$, 
                    2 - $CellContext`h0$}}]}, $CellContext`tray$$ == 
                1, {$CellContext`colV$, 
                 
                 Arrow[{{0.25 $CellContext`w0$, 6 - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, 6}, {(-0.1) $CellContext`w0$, 6}}], 
                 
                 Arrow[{{0.25 $CellContext`w0$, 5 - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, 5}}], $CellContext`colL$, 
                 
                 Arrow[{{$CellContext`w0$, 6}, {0.75 $CellContext`w0$, 6}, {
                   0.75 $CellContext`w0$, 6 - $CellContext`h0$}}], 
                 
                 Arrow[{{0.75 $CellContext`w0$, 5}, {
                   0.75 $CellContext`w0$, 5 - $CellContext`h0$}}]}, 
                1 < $CellContext`tray$$ < 5, 
                Map[{$CellContext`colV$, 
                  
                  Arrow[{{
                    0.25 $CellContext`w0$, $CellContext`n$ + 
                    1 - $CellContext`tray$$ + # - $CellContext`h0$}, {
                    0.25 $CellContext`w0$, $CellContext`n$ + 
                    1 - $CellContext`tray$$ + #}}], $CellContext`colL$, 
                  
                  Arrow[{{
                    0.75 $CellContext`w0$, $CellContext`n$ + 
                    1 - $CellContext`tray$$ + #}, {
                    0.75 $CellContext`w0$, $CellContext`n$ + 
                    1 - $CellContext`tray$$ + # - $CellContext`h0$}}]}& , {0, 
                 1}]]}, {
               EdgeForm[
                Thickness[0.05]], 
               FaceForm[
                RGBColor[1, 1, 0.25]], 
               
               Rectangle[{
                0, $CellContext`n$ + 
                 1 - $CellContext`tray$$}, {$CellContext`w0$, $CellContext`n$ + 
                 1 - $CellContext`tray$$ + $CellContext`h0$}]}, 
              Text[
               Style[$CellContext`tray$$, 17, Bold], {
               0.5 $CellContext`w0$, 0.5 $CellContext`h0$ + $CellContext`n$ + 
                1 - $CellContext`tray$$}]}, ImageSize -> {230, 370}, 
             AspectRatio -> Full, PlotRange -> {0, 6.6}, PlotLabel -> 
             Style["mole ratios are in ppm", 17, Black]]]; 
        Grid[{{$CellContext`plot$, 
            
            If[$CellContext`HTS$$, $CellContext`stages$, \
$CellContext`column$]}}]], "Specifications" :> {{{$CellContext`yN1$$, 59, 
          Row[{"inlet vapor mole ratio ", 
            Subscript[
             Style["y", Italic], 
             Row[{
               Style["N", Italic], " + 1"}]], " (ppm)"}]}, 40, 120, 1, 
         Appearance -> "Labeled", ImageSize -> Small, Enabled -> Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 
         1}, {{$CellContext`T$$, 25, "temperature (\[Degree]C)"}, 10, 80, 5, 
         Appearance -> "Labeled", ImageSize -> Small, Enabled -> Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 2}, 
        Grid[{{
           Manipulate`Place[1], 
           Manipulate`Place[2]}}], {{$CellContext`P$$, 2.5, "pressure (atm)"},
          1.5, 3, 0.1, Appearance -> "Labeled", ImageSize -> Small, Enabled -> 
         Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 
         3}, {{$CellContext`L$$, 100, "solvent flow rate (Mmol/h)"}, 50, 300, 
         5, Appearance -> "Labeled", ImageSize -> Small, Enabled -> Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 4}, 
        Grid[{{
           Manipulate`Place[3], 
           Manipulate`Place[4]}}], {{$CellContext`y1$$, 10, 
          Row[{"outlet vapor ", 
            Subscript[
             Style["y", Italic], 1]}]}, 10, 25, 1, Appearance -> "Labeled", 
         ImageSize -> Small, Enabled -> Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 
         5}, {{$CellContext`x0$$, 0.05, 
          Row[{"inlet liquid ", 
            Subscript[
             Style["x", Italic], 0]}]}, 0, 0.25, 0.01, Appearance -> 
         "Labeled", ImageSize -> Small, Enabled -> Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 6}, 
        Grid[{{"mole ratios (ppm):", 
           Manipulate`Place[5], 
           Manipulate`Place[6]}}], {{$CellContext`LoVmin$$, False, 
          Subscript[
           Row[{"(", 
             Style["L", Italic], "/", 
             Style["V", Italic], ")"}], "min"]}, {True, False}, Enabled -> 
         Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 
         7}, {{$CellContext`HTS$$, True, "show diagram with 5 stages"}, {
         True, False}, ControlPlacement -> 
         8}, {{$CellContext`tray$$, 1, "stage"}, 1, 5, 1, Appearance -> 
         "Labeled", ControlPlacement -> 9}, 
        Grid[{{
           Manipulate`Place[7], 
           Manipulate`Place[8], 
           Spacer[10], 
           PaneSelector[{True -> Manipulate`Place[9]}, 
            Dynamic[$CellContext`HTS$$]]}}]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->172181689,ExpressionUUID->"5db2f06f-c8e6-4c90-988a-26559a645002"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`HTS$$ = False, $CellContext`L$$ = 
    100, $CellContext`LoVmin$$ = True, $CellContext`P$$ = 
    2.5, $CellContext`T$$ = 25, $CellContext`tray$$ = 1, $CellContext`x0$$ = 
    0.05, $CellContext`y1$$ = 10, $CellContext`yN1$$ = 59, Typeset`show$$ = 
    True, Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`yN1$$], 59, 
       Row[{"inlet vapor mole ratio ", 
         Subscript[
          Style["y", Italic], 
          Row[{
            Style["N", Italic], " + 1"}]], " (ppm)"}]}, 40, 120, 1}, {{
       Hold[$CellContext`T$$], 25, "temperature (\[Degree]C)"}, 10, 80, 5}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], 
          Manipulate`Place[2]}}]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`P$$], 2.5, "pressure (atm)"}, 1.5, 3, 0.1}, {{
       Hold[$CellContext`L$$], 100, "solvent flow rate (Mmol/h)"}, 50, 300, 
      5}, {
      Hold[
       Grid[{{
          Manipulate`Place[3], 
          Manipulate`Place[4]}}]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`y1$$], 10, 
       Row[{"outlet vapor ", 
         Subscript[
          Style["y", Italic], 1]}]}, 10, 25, 1}, {{
       Hold[$CellContext`x0$$], 0.05, 
       Row[{"inlet liquid ", 
         Subscript[
          Style["x", Italic], 0]}]}, 0, 0.25, 0.01}, {
      Hold[
       Grid[{{"mole ratios (ppm):", 
          Manipulate`Place[5], 
          Manipulate`Place[6]}}]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`LoVmin$$], True, 
       Subscript[
        Row[{"(", 
          Style["L", Italic], "/", 
          Style["V", Italic], ")"}], "min"]}, {True, False}}, {{
       Hold[$CellContext`HTS$$], False, "show diagram with 5 stages"}, {
      True, False}}, {{
       Hold[$CellContext`tray$$], 1, "stage"}, 1, 5, 1}, {
      Hold[
       Grid[{{
          Manipulate`Place[7], 
          Manipulate`Place[8], 
          Spacer[10], 
          PaneSelector[{True -> Manipulate`Place[9]}, 
           Dynamic[$CellContext`HTS$$]]}}]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = Automatic, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`yN1$20150$$ = 0, $CellContext`T$20151$$ = 
    0, $CellContext`P$20152$$ = 0, $CellContext`L$20153$$ = 
    0, $CellContext`y1$20154$$ = 0, $CellContext`x0$20155$$ = 
    0, $CellContext`LoVmin$20156$$ = False, $CellContext`HTS$20157$$ = 
    False, $CellContext`tray$20158$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`HTS$$ = False, $CellContext`L$$ = 
        100, $CellContext`LoVmin$$ = True, $CellContext`P$$ = 
        2.5, $CellContext`T$$ = 25, $CellContext`tray$$ = 
        1, $CellContext`x0$$ = 0.05, $CellContext`y1$$ = 
        10, $CellContext`yN1$$ = 59}, "ControllerVariables" :> {
        Hold[$CellContext`yN1$$, $CellContext`yN1$20150$$, 0], 
        Hold[$CellContext`T$$, $CellContext`T$20151$$, 0], 
        Hold[$CellContext`P$$, $CellContext`P$20152$$, 0], 
        Hold[$CellContext`L$$, $CellContext`L$20153$$, 0], 
        Hold[$CellContext`y1$$, $CellContext`y1$20154$$, 0], 
        Hold[$CellContext`x0$$, $CellContext`x0$20155$$, 0], 
        Hold[$CellContext`LoVmin$$, $CellContext`LoVmin$20156$$, False], 
        Hold[$CellContext`HTS$$, $CellContext`HTS$20157$$, False], 
        Hold[$CellContext`tray$$, $CellContext`tray$20158$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`Ea$, $CellContext`R$, $CellContext`T0$, \
$CellContext`H0$, $CellContext`HB$, $CellContext`V$, $CellContext`YN1$, \
$CellContext`yeq$, $CellContext`xeq$, $CellContext`check$, \
$CellContext`yLVmin$, $CellContext`xN$, $CellContext`X$, $CellContext`Y$, \
$CellContext`n0$, $CellContext`n$, $CellContext`colL$, $CellContext`colV$, \
$CellContext`h$, $CellContext`w$, $CellContext`ry$, $CellContext`tank$, \
$CellContext`plot$, $CellContext`column$, $CellContext`stages$}, 
        If[$CellContext`HTS$$, {$CellContext`yN1$$ = 59; $CellContext`T$$ = 
            25; $CellContext`P$$ = 2.5; $CellContext`L$$ = 
            100; $CellContext`y1$$ = 10; $CellContext`x0$$ = 
            0.05; $CellContext`LoVmin$$ = False; Null}]; $CellContext`Ea$ = 
         5000; $CellContext`R$ = 8.314; $CellContext`T0$ = 
         298; $CellContext`H0$ = 
         211.19; $CellContext`HB$ = $CellContext`H0$ 
          Exp[(-($CellContext`Ea$/$CellContext`R$)) (
             1/($CellContext`T$$ + 273) - 
             1/$CellContext`T0$)]; $CellContext`V$ = 1; $CellContext`YN1$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := ($CellContext`L$$/$CellContext`V$) ($CellContext`x$ - \
$CellContext`x0$$) + $CellContext`y1$$; $CellContext`yeq$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := ($CellContext`HB$/$CellContext`P$$) $CellContext`x$; \
$CellContext`xeq$ = ReplaceAll[$CellContext`x, 
           Quiet[
            Part[
             
             Solve[$CellContext`yeq$[$CellContext`x] == $CellContext`yN1$$, \
$CellContext`x], 1]]]; $CellContext`check$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yeq$[$CellContext`x] == \
$CellContext`YN1$[$CellContext`x], $CellContext`x], 1]]; $CellContext`yLVmin$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := (($CellContext`yeq$[$CellContext`xeq$] - \
$CellContext`y1$$)/($CellContext`xeq$ - $CellContext`x0$$)) ($CellContext`x$ - \
$CellContext`x0$$) + $CellContext`y1$$; $CellContext`xN$ = \
($CellContext`yN1$$ - $CellContext`y1$$)/($CellContext`L$$/$CellContext`V$) + \
$CellContext`x0$$; $CellContext`X$[0] = $CellContext`xN$; $CellContext`Y$[
          0] = $CellContext`yeq$[$CellContext`xN$]; 
        Do[{$CellContext`X$[$CellContext`i] = ReplaceAll[$CellContext`x, 
             Quiet[
              Part[
               
               Solve[$CellContext`YN1$[$CellContext`x] == \
$CellContext`Y$[$CellContext`i - 1], $CellContext`x], 
               1]]], $CellContext`Y$[$CellContext`i] = $CellContext`yeq$[
             $CellContext`X$[$CellContext`i]]}, {$CellContext`i, 1, 
           50}]; $CellContext`n0$ = DeleteCases[
           Map[If[$CellContext`X$[#] < $CellContext`x0$$, 0, #]& , 
            Range[50]], 0]; $CellContext`n$ = 
         If[Length[$CellContext`n0$] == 0, 1, 1 + 
           Part[$CellContext`n0$, -1]]; $CellContext`colV$ = 
         RGBColor[0, 0.5, 0]; $CellContext`colL$ = 
         RGBColor[0, 0, 0.75]; $CellContext`h$ = 13; $CellContext`w$ = 
         12; $CellContext`ry$ = 2; $CellContext`tank$ = Graphics[{Thick, 
            Map[
            Line[{{#, $CellContext`ry$}, {#, $CellContext`h$ - \
$CellContext`ry$}}]& , {0, $CellContext`w$}], 
            
            Circle[{$CellContext`w$/2, $CellContext`ry$}, {$CellContext`w$/
              2, $CellContext`ry$}, {Pi, 2 Pi}], 
            
            Circle[{$CellContext`w$/
              2, $CellContext`h$ - $CellContext`ry$}, {$CellContext`w$/
              2, $CellContext`ry$}, {0, Pi}], {
             Arrowheads[0.1], $CellContext`colV$, 
             
             Arrow[{{(-$CellContext`w$)/2, (-$CellContext`h$)/4}, {
               0.25 $CellContext`w$, (-$CellContext`h$)/4}, {
               0.25 $CellContext`w$, $CellContext`ry$/10}}], 
             
             Arrow[{{0.25 $CellContext`w$, $CellContext`h$ - $CellContext`ry$/
                10}, {0.25 $CellContext`w$, $CellContext`h$ + $CellContext`h$/
                 4}, {(-$CellContext`w$)/
                2, $CellContext`h$ + $CellContext`h$/4}}], $CellContext`colL$, 
             
             Arrow[{{0.75 $CellContext`w$, $CellContext`ry$/10}, {
               0.75 $CellContext`w$, (-$CellContext`h$)/
                4}, {$CellContext`w$ + $CellContext`w$/
                 2.3, (-$CellContext`h$)/4}}], 
             
             Arrow[{{$CellContext`w$ + $CellContext`w$/
                 2.3, $CellContext`h$ + $CellContext`h$/4}, {
               0.75 $CellContext`w$, $CellContext`h$ + $CellContext`h$/4}, {
               0.75 $CellContext`w$, $CellContext`h$ - $CellContext`ry$/
                10}}]}}, ImageSize -> {230, 390}, AspectRatio -> Full, 
           PlotRange -> {{(-$CellContext`w$)/
              2.13, $CellContext`w$ + $CellContext`w$/
               2.3}, {(-$CellContext`h$)/
              5, $CellContext`h$ + $CellContext`h$/7}}, 
           PlotRangePadding -> {None, {
              Scaled[0.15], 
              Scaled[0.17]}}]; $CellContext`plot$ = Plot[{
            $CellContext`YN1$[$CellContext`x], 
            $CellContext`yeq$[$CellContext`x]}, {$CellContext`x, 
            0, $CellContext`xeq$}, PlotStyle -> {{Thick, 
              If[$CellContext`LoVmin$$, Transparent, Magenta]}, {Thick, 
              RGBColor[1, 0.4, 0]}}, PlotRange -> {0, $CellContext`yN1$$ + 5},
            PlotRangePadding -> None, PlotRangeClipping -> False, Frame -> 
           True, FrameLabel -> {
             Row[{"solute/(solute-free liquid) ", 
               Style["x", Italic], " (ppm)"}], 
             Row[{"solute/(solute-free vapor) ", 
               Style["y", Italic], " (ppm)"}]}, LabelStyle -> {17, Black}, 
           ImageSize -> {370, 370}, AspectRatio -> Full, 
           ImagePadding -> {{55, 25}, {50, 5}}, Epilog -> {Thick, 
             If[$CellContext`LoVmin$$, {Thick, Magenta, 
               Line[{{0, 
                  $CellContext`yLVmin$[0]}, {$CellContext`xeq$, 
                  $CellContext`yLVmin$[$CellContext`xeq$]}}]}, 
              If[
               
               And[$CellContext`yeq$[$CellContext`check$] < \
$CellContext`yN1$$, $CellContext`check$ > 0], 
               Text[
                Framed[
                 Column[{
                   Style["separation not possible", 20, 
                    RGBColor[0.85, 0, 0]], 
                   Style["\[Star]infinite stages needed\[Star]", 17]}, 
                  Center], Background -> White], {
                0.55 $CellContext`xeq$, 0.6 $CellContext`yN1$$}], {
                Map[Line[{{
                    $CellContext`X$[# - 1], 
                    $CellContext`Y$[# - 1]}, {
                    $CellContext`X$[#], 
                    $CellContext`Y$[# - 1]}, {
                    $CellContext`X$[#], 
                    $CellContext`Y$[#]}}]& , 
                 Range[$CellContext`n$ - 1]], 
                Line[{{
                   $CellContext`X$[0], 
                   $CellContext`Y$[0]}, {
                   $CellContext`X$[0], 
                   $CellContext`YN1$[$CellContext`xN$]}}], 
                Line[{{
                   $CellContext`X$[$CellContext`n$ - 1], 
                   $CellContext`Y$[$CellContext`n$ - 1]}, {$CellContext`x0$$, 
                   $CellContext`Y$[$CellContext`n$ - 1]}}], 
                If[$CellContext`HTS$$ == False, {
                  If[$CellContext`n$ < 30, 
                   Map[Text[
                    Style[
                    Row[{" ", $CellContext`n$ + 1 - #, " "}], 17, Background -> 
                    White], {
                    $CellContext`X$[# - 1], 
                    $CellContext`Y$[# - 1]}, {-1, 1}]& , 
                    Range[
                    If[$CellContext`n$ <= 8, $CellContext`n$, 8]]]], 
                  If[$CellContext`n$ > 8, 
                   Text[
                    Style[
                    Row[{" ", 1, " "}], 17, Background -> White], {
                    $CellContext`X$[$CellContext`n$ - 1], 
                    $CellContext`Y$[$CellContext`n$ - 1]}, {-1, 
                    1}]], {$CellContext`colL$, Dashed, 
                   
                   Line[{{$CellContext`x0$$, $CellContext`y1$$}, \
{$CellContext`x0$$, 0}}], $CellContext`colV$, 
                   
                   Line[{{0, $CellContext`y1$$}, {$CellContext`x0$$, \
$CellContext`y1$$}}]}, 
                  Text[
                   Style[
                    Subscript[
                    Style["y", Italic], 1], 17, $CellContext`colV$, 
                    Background -> White], {0, $CellContext`y1$$}, {1.2, 0}], 
                  Text[
                   Style[
                    Subscript[
                    Style["x", Italic], 0], 17, $CellContext`colL$, 
                    Background -> White], {$CellContext`x0$$, 0}, {0, 1.2}], {
                   PointSize[0.025], $CellContext`colL$, 
                   Point[{$CellContext`x0$$, 0}], $CellContext`colV$, 
                   Point[{0, $CellContext`y1$$}], $CellContext`colL$, 
                   Point[{$CellContext`xN$, 
                    $CellContext`yeq$[$CellContext`xN$]}]}, {
                  Dashed, $CellContext`colL$, 
                   Line[{{$CellContext`xN$, 0}, {$CellContext`xN$, 
                    $CellContext`yeq$[$CellContext`xN$]}}], 
                   Text[
                    Framed[
                    Style[
                    Subscript["x", $CellContext`n$], 18, Italic], Background -> 
                    White, FrameStyle -> None, FrameMargins -> 
                    Tiny], {$CellContext`xN$, 0.25 $CellContext`yN1$$}]}}], {
                Dashed, $CellContext`colV$, 
                 
                 Line[{{0, $CellContext`yN1$$}, {$CellContext`xeq$, \
$CellContext`yN1$$}}], 
                 Text[
                  Framed[
                   Style[
                    Subscript[
                    Style["y", Italic], $CellContext`n$ + 1], 18], Background -> 
                   White, FrameStyle -> None, FrameMargins -> Tiny], {
                  0.15, $CellContext`yN1$$}]}, 
                If[$CellContext`HTS$$, {
                  PointSize[0.025], {$CellContext`colL$, 
                   Map[Point[{
                    $CellContext`X$[#], 
                    $CellContext`yeq$[
                    $CellContext`X$[#]]}]& , 
                    Range[0, $CellContext`n$ - 1]], 
                   Point[{$CellContext`x0$$, 0}]}, {$CellContext`colV$, 
                   Map[Point[{
                    $CellContext`X$[#], 
                    $CellContext`YN1$[
                    $CellContext`X$[#]]}]& , 
                    Range[0, $CellContext`n$]]}, 
                  Map[Text[
                    Style[
                    Row[{$CellContext`n$ + 1 - #, ", ", 
                    Style[
                    Subscript[
                    Style["x", Italic], $CellContext`n$ + 
                    1 - #], $CellContext`colL$], ", ", 
                    Style[
                    Subscript[
                    Style["y", Italic], $CellContext`n$ + 
                    1 - #], $CellContext`colV$]}], 17], {
                    $CellContext`X$[# - 1], 
                    $CellContext`yeq$[
                    $CellContext`X$[# - 1]]}, {-1.2, 1}]& , 
                   Range[$CellContext`n$]], 
                  Text[
                   Style[
                    Subscript[
                    Style["x", Italic], 0], 
                    17, $CellContext`colL$], {$CellContext`x0$$, 
                    0}, {-1.2, -1}], 
                  Text[
                   Style[
                    Row[{
                    Style[
                    Subscript["y", "n"], Italic, $CellContext`colV$], 
                    " is in equilibrium with ", 
                    Style[
                    Subscript["x", "n"], Italic, $CellContext`colL$]}], 17], {
                   0.4, 3}], 
                  Text[
                   Style[
                    Column[{
                    Row[{"stage ", $CellContext`tray$$, " solute fluxes:"}], 
                    Column[{
                    Row[{"in: ", 
                    
                    NumberForm[$CellContext`X$[$CellContext`n$ + 
                    1 - $CellContext`tray$$] $CellContext`L$$ + \
$CellContext`YN1$[
                    $CellContext`X$[$CellContext`n$ + 1 - $CellContext`tray$$ - 
                    1]] $CellContext`V$, {4, 1}], " mol/h"}], 
                    Row[{"out: ", 
                    
                    NumberForm[$CellContext`X$[$CellContext`n$ + 
                    1 - $CellContext`tray$$ - 
                    1] $CellContext`L$$ + $CellContext`YN1$[
                    $CellContext`X$[$CellContext`n$ + 
                    1 - $CellContext`tray$$]] $CellContext`V$, {4, 1}], 
                    " mol/h"}]}, Alignment -> ":"]}, Center], 17], {0.2, 48}], 
                  Text[
                   Style["top", 17, Background -> White], {0.04, 6}], 
                  Text[
                   Style["bottom", 17, Background -> White], {0.63, 
                   61.1}]}]}]], 
             Mouseover[{Transparent, 
               Thickness[0.04], 
               CapForm[None], 
               If[$CellContext`LoVmin$$, 
                Line[{{0, 
                   $CellContext`yLVmin$[0]}, {$CellContext`xeq$, 
                   $CellContext`yLVmin$[$CellContext`xeq$]}}], 
                Line[
                 Map[{#, 
                   $CellContext`YN1$[#]}& , 
                  Range[0, $CellContext`xeq$, 0.01]]]]}, {
               Thickness[0.02], Magenta, 
               If[$CellContext`LoVmin$$, 
                Line[{{0, 
                   $CellContext`yLVmin$[0]}, {$CellContext`xeq$, 
                   $CellContext`yLVmin$[$CellContext`xeq$]}}], 
                Line[
                 Map[{#, 
                   $CellContext`YN1$[#]}& , 
                  Range[0, 
                   ReplaceAll[$CellContext`x, 
                    Part[
                    
                    Solve[$CellContext`YN1$[$CellContext`x] == \
$CellContext`yN1$$ + 5, $CellContext`x], 1]], 0.01]]]], 
               Text[
                Style[
                 Column[{"operating line", "(mass balance)"}, Center], 17, 
                 Magenta], 
                
                If[$CellContext`HTS$$, {
                 0.75 $CellContext`xeq$, 0.25 $CellContext`yN1$$}, {
                 0.25 $CellContext`xeq$, 0.7 $CellContext`yN1$$}]]}], 
             Mouseover[{Transparent, 
               Thickness[0.04], 
               CapForm[None], 
               Line[
                Map[{#, 
                  $CellContext`yeq$[#]}& , 
                 Range[0, $CellContext`xeq$, 0.01]]]}, {
               Thickness[0.02], 
               RGBColor[1, 0.4, 0], 
               Line[
                Map[{#, 
                  $CellContext`yeq$[#]}& , 
                 Range[0, $CellContext`xeq$, 0.01]]], 
               Text[
                Style["equilibrium line", 17, 
                 RGBColor[1, 0.4, 0]], 
                
                If[$CellContext`HTS$$, {
                 0.75 $CellContext`xeq$, 0.25 $CellContext`yN1$$}, {
                 0.25 $CellContext`xeq$, 
                  0.7 $CellContext`yN1$$}]]}]}]; $CellContext`column$ = 
         Show[$CellContext`tank$, Epilog -> {Thick, 
             Text[
              Style[
               Column[{"liquid solvent feed", 
                 Row[{
                   Style["L", Italic], " = ", 
                   NumberForm[$CellContext`L$$, {4, 0}], " Mmol/h"}]}, Right],
                17, $CellContext`colL$], {$CellContext`w$, $CellContext`h$ + \
$CellContext`h$/4}, {0.2, -1.2}], 
             Text[
              Style[
               Column[{"vapor feed", 
                 Row[{
                   Style["V", Italic], " = ", 
                   NumberForm[$CellContext`V$, 2], " Mmol/h"}]}], 
               17, $CellContext`colV$], {0, (-$CellContext`h$)/4}, {0, 1.4}], 
             Apply[Text[
               Style[
                Row[{
                  Subscript[
                   Style["y", Italic], #2], " = ", #, " ppm"}], 
                17, $CellContext`colV$, Background -> White], {
               0, #3}]& , {{$CellContext`y1$$, 1, $CellContext`h$ + 
                2}, {$CellContext`yN1$$, $CellContext`n$ + 1, -2}}, {1}], 
             Apply[Text[
               Style[
                Row[{
                  Subscript[
                   Style["x", Italic], #2], " = ", #, " ppm"}], 
                17, $CellContext`colL$, Background -> 
                White], {$CellContext`w$, #3}]& , {{$CellContext`x0$$, 
                0, $CellContext`h$ + 2.25}, {
                NumberForm[$CellContext`xN$, 2], $CellContext`n$, -2}}, {1}], 
             Text[
              Style[
               Row[{
                 Style["L", Italic], "/", 
                 Style["V", Italic], " = ", 
                 NumberForm[$CellContext`L$$/$CellContext`V$, {4, 0}]}], 
               17], {$CellContext`w$/2, 0.33 $CellContext`h$}], 
             Text[
              Style[
               If[$CellContext`LoVmin$$, 
                Style[
                 Row[{
                   Subscript[
                    Row[{"(", 
                    Style["L", Italic], "/", 
                    Style["V", Italic], ")"}], "min"], " = ", 
                   
                   NumberForm[($CellContext`yeq$[$CellContext`xeq$] - \
$CellContext`y1$$)/($CellContext`xeq$ - $CellContext`x0$$), {5, 1}]}], 17, 
                 Purple], 
                Row[{
                  If[
                   
                   And[$CellContext`yeq$[$CellContext`check$] < \
$CellContext`yN1$$, $CellContext`check$ > 0], Infinity, $CellContext`n$], 
                  " stages needed"}]], 17], {$CellContext`w$/2, 
               0.66 $CellContext`h$}]}, ImageSize -> {230, 370}, AspectRatio -> 
           Full, PlotRange -> {{(-$CellContext`w$)/
              2.13, $CellContext`w$ + $CellContext`w$/
               2.3}, {(-$CellContext`h$)/
              5, $CellContext`h$ + $CellContext`h$/7}}, 
           PlotRangePadding -> {None, {
              Scaled[0.15], 
              Scaled[0.2]}}]; $CellContext`stages$ = 
         Module[{$CellContext`w0$, $CellContext`h0$}, $CellContext`w0$ = 
            1; $CellContext`h0$ = 0.5; Graphics[{Thick, {
               EdgeForm[Thick], 
               FaceForm[None], 
               Map[
               Rectangle[{0, #}, {$CellContext`w0$, # + $CellContext`h0$}]& , 
                Range[5]]}, {
               Arrowheads[0.22], {$CellContext`colV$, 
                Map[
                Arrow[{{0.25 $CellContext`w0$, # - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, #}}]& , 
                 Range[2, 5]], 
                
                Arrow[{{0, 1 - $CellContext`h0$}, {
                  0.25 $CellContext`w0$, 1 - $CellContext`h0$}, {
                  0.25 $CellContext`w0$, 1}}], 
                
                Arrow[{{0.25 $CellContext`w0$, 6 - $CellContext`h0$}, {
                  0.25 $CellContext`w0$, 6}, {(-0.1) $CellContext`w0$, 
                   6}}]}, {$CellContext`colL$, 
                Map[
                Arrow[{{0.75 $CellContext`w0$, #}, {
                   0.75 $CellContext`w0$, # - $CellContext`h0$}}]& , 
                 Range[2, 5]], 
                
                Arrow[{{0.75 $CellContext`w0$, 1}, {
                  0.75 $CellContext`w0$, 1 - $CellContext`h0$}, {
                  1.1 $CellContext`w0$, 1 - $CellContext`h0$}}], 
                
                Arrow[{{$CellContext`w0$, 6}, {0.75 $CellContext`w0$, 6}, {
                  0.75 $CellContext`w0$, 6 - $CellContext`h0$}}]}}, 
              Map[Text[
                Style[$CellContext`n$ + 1 - #, 17, Background -> White], {
                0.5 $CellContext`w0$, 0.5 $CellContext`h0$ + #}]& , 
               Range[5]], 
              Map[Text[
                Style[
                 Row[{
                   Subscript[
                    Style["y", Italic], 6 - #], " = ", 
                   NumberForm[
                    $CellContext`YN1$[
                    $CellContext`X$[#]], {2, 0}]}], 17, $CellContext`colV$, 
                 Background -> White], {
                0.25 $CellContext`w0$, # + 1 - 0.5 $CellContext`h0$}, {
                1.2, 0}]& , 
               Range[4]], 
              Text[
               Style[
                Column[{
                  Row[{$CellContext`V$, " Mmol/h"}], 
                  Row[{
                    Subscript[
                    Style["y", Italic], 1], " = ", 
                    NumberForm[
                    $CellContext`YN1$[
                    $CellContext`X$[$CellContext`n$]], {2, 0}]}]}, Center], 
                17, $CellContext`colV$], {
               0.25 $CellContext`w0$, 6 - 0.5 $CellContext`h0$}, {
               1.5, -0.75}], 
              Text[
               Style[
                Column[{
                  Row[{
                    Subscript[
                    Style["y", Italic], 6], " = ", 
                    NumberForm[
                    $CellContext`YN1$[
                    $CellContext`X$[0]], {2, 0}]}], 
                  Row[{$CellContext`V$, " Mmol/h"}]}, Center], 
                17, $CellContext`colV$], {0.25 $CellContext`w0$, 0.5}, {1.25, 
               0.4}], 
              Map[Text[
                Style[
                 Row[{
                   Subscript[
                    Style["x", Italic], 6 - #], " = ", 
                   NumberForm[
                    $CellContext`X$[# - 1], {2, 2}]}], 17, $CellContext`colL$,
                  Background -> White], {
                0.75 $CellContext`w0$, # - 0.5 $CellContext`h0$}, {-1.5, 
                 0}]& , 
               Range[2, 5]], 
              Text[
               Style[
                Column[{
                  Row[{$CellContext`L$$, " Mmol/h"}], 
                  Row[{
                    Subscript[
                    Style["x", Italic], 0], " = ", 
                    NumberForm[
                    $CellContext`X$[$CellContext`n$], {2, 2}]}]}, Center], 
                17, $CellContext`colL$], {$CellContext`w0$, 6 - 
                0.5 $CellContext`h0$}, {-1, -0.75}], 
              Text[
               Style[
                Column[{
                  Row[{
                    Subscript[
                    Style["x", Italic], $CellContext`n$], " = ", 
                    NumberForm[
                    $CellContext`X$[0], {2, 2}]}], 
                  Row[{$CellContext`L$$, " Mmol/h"}]}, Center], 
                17, $CellContext`colL$], {$CellContext`w0$, 0.5}, {-1, 0.4}], {
               Arrowheads[0.22], 
               Which[$CellContext`tray$$ == 5, {$CellContext`colV$, 
                 
                 Arrow[{{0, 1 - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, 1 - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, 1}}], 
                 
                 Arrow[{{0.25 $CellContext`w0$, 2 - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, 2}}], $CellContext`colL$, 
                 
                 Arrow[{{0.75 $CellContext`w0$, 1}, {
                   0.75 $CellContext`w0$, 1 - $CellContext`h0$}, {
                   1.1 $CellContext`w0$, 1 - $CellContext`h0$}}], 
                 
                 Arrow[{{0.75 $CellContext`w0$, 2}, {
                   0.75 $CellContext`w0$, 
                    2 - $CellContext`h0$}}]}, $CellContext`tray$$ == 
                1, {$CellContext`colV$, 
                 
                 Arrow[{{0.25 $CellContext`w0$, 6 - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, 6}, {(-0.1) $CellContext`w0$, 6}}], 
                 
                 Arrow[{{0.25 $CellContext`w0$, 5 - $CellContext`h0$}, {
                   0.25 $CellContext`w0$, 5}}], $CellContext`colL$, 
                 
                 Arrow[{{$CellContext`w0$, 6}, {0.75 $CellContext`w0$, 6}, {
                   0.75 $CellContext`w0$, 6 - $CellContext`h0$}}], 
                 
                 Arrow[{{0.75 $CellContext`w0$, 5}, {
                   0.75 $CellContext`w0$, 5 - $CellContext`h0$}}]}, 
                1 < $CellContext`tray$$ < 5, 
                Map[{$CellContext`colV$, 
                  
                  Arrow[{{
                    0.25 $CellContext`w0$, $CellContext`n$ + 
                    1 - $CellContext`tray$$ + # - $CellContext`h0$}, {
                    0.25 $CellContext`w0$, $CellContext`n$ + 
                    1 - $CellContext`tray$$ + #}}], $CellContext`colL$, 
                  
                  Arrow[{{
                    0.75 $CellContext`w0$, $CellContext`n$ + 
                    1 - $CellContext`tray$$ + #}, {
                    0.75 $CellContext`w0$, $CellContext`n$ + 
                    1 - $CellContext`tray$$ + # - $CellContext`h0$}}]}& , {0, 
                 1}]]}, {
               EdgeForm[
                Thickness[0.05]], 
               FaceForm[
                RGBColor[1, 1, 0.25]], 
               
               Rectangle[{
                0, $CellContext`n$ + 
                 1 - $CellContext`tray$$}, {$CellContext`w0$, $CellContext`n$ + 
                 1 - $CellContext`tray$$ + $CellContext`h0$}]}, 
              Text[
               Style[$CellContext`tray$$, 17, Bold], {
               0.5 $CellContext`w0$, 0.5 $CellContext`h0$ + $CellContext`n$ + 
                1 - $CellContext`tray$$}]}, ImageSize -> {230, 370}, 
             AspectRatio -> Full, PlotRange -> {0, 6.6}, PlotLabel -> 
             Style["mole ratios are in ppm", 17, Black]]]; 
        Grid[{{$CellContext`plot$, 
            
            If[$CellContext`HTS$$, $CellContext`stages$, \
$CellContext`column$]}}]], "Specifications" :> {{{$CellContext`yN1$$, 59, 
          Row[{"inlet vapor mole ratio ", 
            Subscript[
             Style["y", Italic], 
             Row[{
               Style["N", Italic], " + 1"}]], " (ppm)"}]}, 40, 120, 1, 
         Appearance -> "Labeled", ImageSize -> Small, Enabled -> Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 
         1}, {{$CellContext`T$$, 25, "temperature (\[Degree]C)"}, 10, 80, 5, 
         Appearance -> "Labeled", ImageSize -> Small, Enabled -> Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 2}, 
        Grid[{{
           Manipulate`Place[1], 
           Manipulate`Place[2]}}], {{$CellContext`P$$, 2.5, "pressure (atm)"},
          1.5, 3, 0.1, Appearance -> "Labeled", ImageSize -> Small, Enabled -> 
         Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 
         3}, {{$CellContext`L$$, 100, "solvent flow rate (Mmol/h)"}, 50, 300, 
         5, Appearance -> "Labeled", ImageSize -> Small, Enabled -> Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 4}, 
        Grid[{{
           Manipulate`Place[3], 
           Manipulate`Place[4]}}], {{$CellContext`y1$$, 10, 
          Row[{"outlet vapor ", 
            Subscript[
             Style["y", Italic], 1]}]}, 10, 25, 1, Appearance -> "Labeled", 
         ImageSize -> Small, Enabled -> Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 
         5}, {{$CellContext`x0$$, 0.05, 
          Row[{"inlet liquid ", 
            Subscript[
             Style["x", Italic], 0]}]}, 0, 0.25, 0.01, Appearance -> 
         "Labeled", ImageSize -> Small, Enabled -> Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 6}, 
        Grid[{{"mole ratios (ppm):", 
           Manipulate`Place[5], 
           Manipulate`Place[6]}}], {{$CellContext`LoVmin$$, True, 
          Subscript[
           Row[{"(", 
             Style["L", Italic], "/", 
             Style["V", Italic], ")"}], "min"]}, {True, False}, Enabled -> 
         Dynamic[
           If[$CellContext`HTS$$, False, True]], ControlPlacement -> 
         7}, {{$CellContext`HTS$$, False, "show diagram with 5 stages"}, {
         True, False}, ControlPlacement -> 
         8}, {{$CellContext`tray$$, 1, "stage"}, 1, 5, 1, Appearance -> 
         "Labeled", ControlPlacement -> 9}, 
        Grid[{{
           Manipulate`Place[7], 
           Manipulate`Place[8], 
           Spacer[10], 
           PaneSelector[{True -> Manipulate`Place[9]}, 
            Dynamic[$CellContext`HTS$$]]}}]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->3282822,ExpressionUUID->"d8a3cf34-8bff-4590-b0bd-ac712a3863d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "DetailsSection",ExpressionUUID->"f58cb129-e576-4fee-bec9-cbf9ca274a51"],

Cell["\<\
A mole balance on the absorption column for the impurity species gives:\
\>", "DetailNotes",
 CellChangeTimes->{{3.6998804127279234`*^9, 3.699880430499605*^9}, {
  3.7001369614656963`*^9, 3.7001369778002777`*^9}, {3.7001370198403435`*^9, 
  3.7001370738968396`*^9}, {3.700137108803808*^9, 3.700137111040738*^9}, {
  3.700137195409094*^9, 3.7001371973300543`*^9}, {3.703544325755578*^9, 
  3.703544336888629*^9}},
 CellID->237613890,
 $CellContext`ExpressionUUID -> 
 "116c72b8-a797-4df6-9fbf-8dd5342d46f9",ExpressionUUID->"7f94770f-6493-480b-\
81a2-9fc6a76c1e46"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["x", "0"], " ", "L"}], "+", 
     RowBox[{
      SubscriptBox["y", 
       RowBox[{"N", "+", "1"}]], " ", "V"}]}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["x", "N"], " ", "L"}], "+", 
     RowBox[{
      SubscriptBox["y", "1"], " ", "V"}]}]}], TraditionalForm]], "InlineMath",
  $CellContext`ExpressionUUID -> "333c75ea-58c2-4908-bf18-4d6c1f70b70f",
  ExpressionUUID->"b22f78d1-8f45-4ab1-8b37-767a68fe5f21"],
 "."
}], "DetailNotes",
 CellChangeTimes->{{3.6998804127279234`*^9, 3.6998804311880064`*^9}, {
  3.699880465322937*^9, 3.699880489403638*^9}, {3.6999633576500015`*^9, 
  3.69996336746085*^9}, {3.7017774522743163`*^9, 3.701777455769339*^9}, {
  3.702145365146268*^9, 3.7021453657135134`*^9}},
 CellID->237742517,
 $CellContext`ExpressionUUID -> 
 "370e01f5-f99c-4d36-9ad8-d2f497c2f2cb",ExpressionUUID->"76dc9c8c-b251-4401-\
8ba7-f133cae123b9"],

Cell["Rearranging this yields the operating line for the absorber:", \
"DetailNotes",
 CellChangeTimes->{{3.6998804127279234`*^9, 3.6998804311880064`*^9}, {
   3.699880465322937*^9, 3.6998805034135237`*^9}, {3.7001370829928675`*^9, 
   3.7001370992465425`*^9}, 3.700220887212827*^9, {3.7021453611378527`*^9, 
   3.7021453616791553`*^9}},
 CellID->106309455,
 $CellContext`ExpressionUUID -> 
 "c7578e09-8bed-48b1-ac11-48c50a0b6f17",ExpressionUUID->"aceed9e4-a9af-4657-\
99c7-6c663ca0eb68"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", 
     RowBox[{"N", "+", "1"}]], "=", 
    RowBox[{
     RowBox[{
      FractionBox["L", "V"], " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["x", "N"], "-", 
        SubscriptBox["x", "0"]}], ")"}]}], "+", 
     SubscriptBox["y", "1"]}]}], TraditionalForm]], "InlineMath",
  $CellContext`ExpressionUUID -> "ed4f3166-ecca-4bd4-a95b-0b2f0dcd0139",
  ExpressionUUID->"6f540520-46fe-4e94-b0e1-8d8db6d088ea"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.6998804127279234`*^9, 3.6998804311880064`*^9}, {
  3.699880465322937*^9, 3.6998805384342966`*^9}, {3.699963373142876*^9, 
  3.6999633834583263`*^9}, {3.701777461453767*^9, 3.7017774650519896`*^9}},
 CellID->676069286,
 $CellContext`ExpressionUUID -> 
 "e0230e96-2db6-4c0b-bc0d-c35ef71d21d8",ExpressionUUID->"e0eb7908-439c-47ad-\
8c22-f9605cf52249"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox["L", TraditionalForm]], "InlineMath",
  $CellContext`ExpressionUUID -> "4d842be5-97e4-4718-b135-e4a54b1bce71",
  ExpressionUUID->"0e5cbd6f-c17a-4fd3-9a75-9d2e8843c352"],
 " is the solvent liquid flow rate (Mmol/h), ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]], "InlineMath",
  $CellContext`ExpressionUUID -> "af3b76e5-29dc-4802-bfd6-dbe932c7125b",
  ExpressionUUID->"0be8ecf8-67ef-4067-b8ec-370173547b4b"],
 " is the gas molar flow rate (Mmol/h), ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "n"], TraditionalForm]], "InlineMath",
  $CellContext`ExpressionUUID -> "32f78043-89e1-4670-9a7a-3dbe46fab412",
  ExpressionUUID->"10dc6dc9-41af-4f59-9205-4db3444b0784"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", "n"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "02af5ec5-591f-461c-beac-65fa332898af"],
 " are the mole ratios of the impurity (ppm) in the liquid and gas streams \
leaving stage ",
 StyleBox["n",
  FontSlant->"Italic"],
 " (these streams leaving stage ",
 StyleBox["n",
  FontSlant->"Italic"],
 " are in equilibrium), ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "0"], TraditionalForm]], "InlineMath",
  $CellContext`ExpressionUUID -> "2d738142-5806-4532-9953-72b568937f68",
  ExpressionUUID->"e0120093-55b9-4ba8-82b8-3409a9a6e2b8"],
 " is the mole ratio of impurity in the inlet solvent stream, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", 
    RowBox[{"N", "+", "1"}]], TraditionalForm]], "InlineMath",
  $CellContext`ExpressionUUID -> "d5dcf51e-07ef-40db-bb71-429952d5732b",
  ExpressionUUID->"b1fa3ba9-60ae-4ea7-ba19-223f1292c988"],
 " is the mole ratio of impurity in the feed gas stream, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "N"], TraditionalForm]], "InlineMath",
  $CellContext`ExpressionUUID -> "3e6f8021-439a-44aa-97d2-319930971d83",
  ExpressionUUID->"39f6fff3-1bd5-4271-bf08-80ac78e9c6f8"],
 " is the mole ratio of impurity in the outlet solvent stream, and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", "1"], TraditionalForm]], "InlineMath",
  $CellContext`ExpressionUUID -> "7f4a5b96-9b92-489a-9ab3-e6935c718d14",
  ExpressionUUID->"0e2559e4-4984-4b91-b102-e8679b50968b"],
 " is the mole ratio of impurity in the treated gas stream."
}], "DetailNotes",
 CellChangeTimes->{{3.699964540871102*^9, 3.6999645887458973`*^9}, {
   3.7000808268957453`*^9, 3.700080884181126*^9}, {3.700080964094964*^9, 
   3.7000810995223093`*^9}, {3.700081171719821*^9, 3.70008131493888*^9}, {
   3.700081464020712*^9, 3.700081492192492*^9}, {3.700137123859003*^9, 
   3.70013719145253*^9}, {3.7001372231862454`*^9, 3.700137291081329*^9}, {
   3.7001373350429363`*^9, 3.7001373997937927`*^9}, {3.700170254973234*^9, 
   3.700170268116138*^9}, {3.7002209025987215`*^9, 3.700220926409248*^9}, {
   3.700396018810774*^9, 3.700396025035017*^9}, {3.7017774707900143`*^9, 
   3.7017774803712635`*^9}, {3.702303628829676*^9, 3.702303631384697*^9}, 
   3.7035234873083687`*^9, 3.703600055663301*^9, {3.7145628115058074`*^9, 
   3.714562844487651*^9}, {3.7145628909777145`*^9, 3.714562918521016*^9}, {
   3.7145630364832315`*^9, 3.7145630410053177`*^9}, {3.714563525158337*^9, 
   3.7145635570100975`*^9}},
 CellID->40320643,
 $CellContext`ExpressionUUID -> 
 "9abc16d5-4f92-445e-bc81-4a9db1b3a5d2",ExpressionUUID->"2c60ec08-0d5e-4b9a-\
8764-24d6e6ab80a6"],

Cell["The equilibrium line is calculated using Henry's law:", "DetailNotes",
 CellChangeTimes->{{3.6998804127279234`*^9, 3.6998804311880064`*^9}, {
   3.699880465322937*^9, 3.6998806131298795`*^9}, {3.6998806508195305`*^9, 
   3.6998807497052393`*^9}, {3.6998808118456755`*^9, 3.6998808276079535`*^9}, 
   3.69996346544836*^9, {3.700080387110372*^9, 3.7000804113163853`*^9}, {
   3.7001374122170563`*^9, 3.700137426123855*^9}, 3.703523492345813*^9},
 CellID->1035463846,
 $CellContext`ExpressionUUID -> 
 "8e60a821-aeec-45fc-a012-d7ceaef3f957",ExpressionUUID->"ce1b470d-4269-4612-\
9b66-53bf19b4e8bc"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "eq"], "=", 
    RowBox[{
     FractionBox["H", "P"], " ", 
     SubscriptBox["x", "N"]}]}], TraditionalForm]], "InlineMath",
  $CellContext`ExpressionUUID -> "de25d7b8-fe96-45a1-866c-514e356e5220",
  ExpressionUUID->"e2bfa027-4bec-48fa-99e2-bbbd5c5b340e"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.6998804127279234`*^9, 3.6998804311880064`*^9}, {
  3.699880465322937*^9, 3.6998806131298795`*^9}, {3.6998806508195305`*^9, 
  3.6998807497052393`*^9}, {3.6998808118456755`*^9, 3.699880844262244*^9}, {
  3.699963469846184*^9, 3.69996347320319*^9}, {3.701777487157293*^9, 
  3.701777487157293*^9}},
 CellID->306537432,
 $CellContext`ExpressionUUID -> 
 "4b3cc464-d3f6-478c-b30b-e1a1981ab310",ExpressionUUID->"1a94da9e-b58e-4fbe-\
80b7-b8e667c43391"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"H", "=", 
    RowBox[{
     SuperscriptBox["H", "0"], " ", 
     SuperscriptBox["e", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["E", "R"]}], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "T"], "-", 
         FractionBox["1", 
          SubscriptBox["T", "0"]]}], ")"}]}]]}]}], TraditionalForm]], 
  "InlineMath",
  $CellContext`ExpressionUUID -> "792044f9-4170-481c-86e7-1476c4558742",
  ExpressionUUID->"1252f82a-77f5-4da9-b7f1-7b88281d75a2"],
 ","
}], "DetailNotes",
 CellChangeTimes->{{3.6998804127279234`*^9, 3.6998804311880064`*^9}, {
  3.699880465322937*^9, 3.6998806131298795`*^9}, {3.6998806508195305`*^9, 
  3.6998807497052393`*^9}, {3.6998808118456755`*^9, 3.6998809374903193`*^9}, {
  3.699881023332361*^9, 3.699881023691162*^9}, {3.6999634863490605`*^9, 
  3.699963495743109*^9}, {3.70008034043487*^9, 3.700080343681065*^9}, {
  3.700220944147544*^9, 3.700220951232586*^9}, {3.7137074760268993`*^9, 
  3.713707487864152*^9}},
 CellID->723145271,
 $CellContext`ExpressionUUID -> 
 "8ef179aa-aba8-4185-b43c-f878794d74e8",ExpressionUUID->"0ac866a3-ce3e-4b7d-\
a923-62cae86034b4"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox["H", TraditionalForm]], "InlineMath",
  $CellContext`ExpressionUUID -> "64883d02-de4d-42b5-936b-56f83fa3170c",
  ExpressionUUID->"f3027ced-488b-4702-a6ea-b666e7e49331"],
 " is Henry's constant (atm), ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["H", "0"], TraditionalForm]], "InlineMath",
  $CellContext`ExpressionUUID -> "6656f137-b357-4c1e-8fd5-3a99885b928e",
  ExpressionUUID->"2d223b65-f519-4449-baa3-39e5d401498c"],
 " is Henry's constant at ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "0"], "=", 
    RowBox[{"298", " ", 
     StyleBox["K",
      FontSlant->"Plain"]}]}], TraditionalForm]], "InlineMath",
  $CellContext`ExpressionUUID -> "22f30b92-7fe3-409a-9083-b42f10c4f5bf",
  ExpressionUUID->"5f499d2b-c211-4cf5-9269-d4a08acfb3c2"],
 ", ",
 Cell[BoxData[
  FormBox["P", TraditionalForm]], "InlineMath",
  $CellContext`ExpressionUUID -> "2e0f4705-a5b1-422b-8f99-c9e186e0f0a2",
  ExpressionUUID->"7d3787e5-63fd-4757-9f36-c72a0171397b"],
 " is pressure (atm), ",
 Cell[BoxData[
  FormBox["E", TraditionalForm]], "InlineMath",
  $CellContext`ExpressionUUID -> "f6c410d7-1803-4ee0-b20f-6df80565c99c",
  ExpressionUUID->"851fcf3d-7e1b-4ebd-93f2-b545b02047e3"],
 " is the activation energy (J/mol), ",
 Cell[BoxData[
  FormBox["R", TraditionalForm]], "InlineMath",
  $CellContext`ExpressionUUID -> "60228386-45d8-434f-8429-74e88fd12aa2",
  ExpressionUUID->"b164ea92-11a0-4913-9cf5-d6341df47cc6"],
 " is the ideal gas constant (J/mol K), and ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]], "InlineMath",
  $CellContext`ExpressionUUID -> "f8a75fdd-daba-4243-b1bf-8d3bb2bb2dc3",
  ExpressionUUID->"93ae4e41-d129-4509-952d-8e300633053e"],
 " is temperature (K)."
}], "DetailNotes",
 CellChangeTimes->{{3.700080616089089*^9, 3.7000806176863337`*^9}, 
   3.700220880765994*^9, {3.700220960487239*^9, 3.7002210166095343`*^9}, {
   3.70039603926529*^9, 3.7003960714864635`*^9}, {3.7003961084795704`*^9, 
   3.7003961282072687`*^9}, {3.703523514156954*^9, 3.703523521206698*^9}, 
   3.703524114552186*^9, {3.7035443887908688`*^9, 3.7035443925908823`*^9}, 
   3.703600074406185*^9, {3.7156931804563828`*^9, 3.7156931859972205`*^9}},
 CellID->113387733,
 $CellContext`ExpressionUUID -> 
 "f08d7b9f-c6d0-4ec5-a936-ba12c882ae4d",ExpressionUUID->"5ba8f4e2-7f6e-42bf-\
9358-1418e7678e0f"],

Cell[TextData[{
 "Stages are counted by locating ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", 
    RowBox[{"N", "+", "1"}]], TraditionalForm]], "InlineMath",ExpressionUUID->
  "8934b032-ddf8-465a-8616-a4a77e294951"],
 " on the operating line. The corresponding ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "N"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "452d7384-6f2b-42b2-a33a-8ab94b200f4d"],
 " value on the operating line is from the mass balance:"
}], "DetailNotes",
 CellChangeTimes->{{3.7156934811130934`*^9, 3.7156934814641094`*^9}, {
  3.7156960983070354`*^9, 3.7156961093390875`*^9}, {3.7157120379006944`*^9, 
  3.7157120800275254`*^9}, {3.7157121284417496`*^9, 3.715712135216875*^9}, {
  3.715712174256791*^9, 3.7157122147839994`*^9}},
 CellID->531280496,ExpressionUUID->"db706999-eaf2-4435-b1d4-add9147566f8"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "N"], "=", 
    RowBox[{
     SubscriptBox["x", "0"], "+", 
     FractionBox[
      RowBox[{
       SubscriptBox["y", 
        RowBox[{"N", "+", "1"}]], "-", 
       SubscriptBox["y", "1"]}], 
      RowBox[{"L", "/", "V"}]]}]}], TraditionalForm]], "InlineMath",
  ExpressionUUID->"8f7254ea-fff3-42cc-a8ff-e0401fef7db5"],
 "."
}], "DetailNotes",
 CellChangeTimes->{{3.7156934811130934`*^9, 3.7156934814641094`*^9}, {
  3.7156960983070354`*^9, 3.715696114377314*^9}, {3.715696158749737*^9, 
  3.71569617108241*^9}},
 CellID->628231243,ExpressionUUID->"06bbff96-f8eb-43fc-8a1a-aa13680d112c"],

Cell[TextData[{
 "A vertical line is then drawn from (",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "N"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "217209eb-0f59-4988-beea-7c903ae1149d"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", 
    RowBox[{"N", "+", "1"}]], TraditionalForm]],ExpressionUUID->
  "4c997fc3-f9f3-4654-ba72-825f2439f2de"],
 ") to the equilibrium line. These values (",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "N"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "730dfa6d-3016-46a7-b63a-3a74440c0a15"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", "N"], TraditionalForm]],ExpressionUUID->
  "8c7a7938-760c-4648-89ab-4c4a9e19ace4"],
 ") are the equilibrium mole fractions leaving stage ",
 Cell[BoxData[
  FormBox["N", TraditionalForm]], "InlineMath",ExpressionUUID->
  "955a78f8-87f9-42de-8acd-babd19be9dbb"],
 ". Next draw an horizontal line from (",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "N"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "e20885f3-1d22-44c8-89ce-d6e2bcdc029b"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", "N"], TraditionalForm]],ExpressionUUID->
  "2284d175-feaa-4e37-856d-6dc238f80684"],
 ") to the operating line. From this point (",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    RowBox[{"N", "-", "1"}]], TraditionalForm]], "InlineMath",ExpressionUUID->
  "4aac9c0c-82ee-4bc3-9e10-31d960cbbb2e"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", "N"], TraditionalForm]],ExpressionUUID->
  "8f3a49c6-65c2-4e5e-96f2-5ffee4a68da9"],
 ") on the operating line, a vertical line is drawn to the equilibrium line, \
and this process is repeated until ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "1"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "b530e440-7469-4bbb-a3a6-49a807809e00"],
 " is reached."
}], "DetailNotes",
 CellChangeTimes->{{3.7156934811130934`*^9, 3.7156934814641094`*^9}, 
   3.7156960983070354`*^9, {3.7157119356825542`*^9, 3.7157119398531933`*^9}, {
   3.715712236360504*^9, 3.7157125990230618`*^9}, 3.715951593307876*^9},
 CellID->30972495,ExpressionUUID->"f110e247-739b-4cfd-83a6-e94d838f23b5"],

Cell["Reference", "DetailNotes",
 CellChangeTimes->{{3.700080616089089*^9, 3.700080620869473*^9}, {
  3.7002210497359147`*^9, 3.7002210499553156`*^9}},
 CellID->359414663,
 $CellContext`ExpressionUUID -> 
 "fb4d39f9-5bac-44ca-ab62-8780064af81e",ExpressionUUID->"6b219465-ad9f-47b4-\
ade6-9a5b52e8bacf"],

Cell[TextData[{
 "[1] P.C. Wankat,",
 StyleBox[" Separation Process Engineering: Includes Mass Transfer Analysis",
  FontSlant->"Italic"],
 ", 3rd ed., Upper Saddle River, NJ: Prentice Hall, 2012."
}], "DetailNotes",
 CellChangeTimes->{{3.7000806326022177`*^9, 3.700080658235621*^9}, {
  3.7000807420163927`*^9, 3.70008078191269*^9}, {3.7002210411464643`*^9, 
  3.7002210600179667`*^9}, {3.703523576809187*^9, 3.70352363025762*^9}},
 CellID->1027769137,
 $CellContext`ExpressionUUID -> 
 "51f3289b-98e7-4b7b-b134-a4a9bc9f8f2c",ExpressionUUID->"080e04db-d1cd-41a2-\
b11e-9380683e0125"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ControlSuggestionsSection",ExpressionUUID->"da12d1be-1e9f-4aa7-8b0d-26dd927e7cc1"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[
   " Resize Images",ExpressionUUID->"2f151c15-6b6f-4cc1-9c4a-5af35d0fbc4b"]}],
  "\"Click inside an image to reveal its orange resize frame.\\nDrag any of \
the orange resize handles to resize the image.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.7137072659493885`*^9},
 FontFamily->"Verdana",
 CellTags->
  "ResizeImages",ExpressionUUID->"73fbd87b-1397-40f5-9ef4-ea71f8fe2aa0"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Rotate and Zoom in 3D",ExpressionUUID->
    "d5c8b582-df21-4309-84d5-d0fc55ab265a"]}],
  RowBox[{
   "\"Drag a 3D graphic to rotate it. Starting the drag near the center \
tumbles\\nthe graphic; starting near a corner turns it parallel to the plane \
of the screen.\\nHold down \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" (or \"", 
    FrameBox[
    "Cmd", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" on Mac) and drag up and down to zoom.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->
  "RotateAndZoomIn3D",ExpressionUUID->"10acbb6f-91cf-49fb-aa0c-31bab4e4b320"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Drag Locators",ExpressionUUID->"48b04a44-55d8-47b2-96e8-bfbcb52f4180"]}],
  RowBox[{"\"Drag any locator (\"", 
    GraphicsBox[
     LocatorBox[
      Scaled[{0.5, 0.5}]], ImageSize -> 20], 
    "\", etc.) to move it around.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->
  "DragLocators",ExpressionUUID->"22c4c987-b6de-48ee-81f1-738812a47f17"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Create and Delete Locators",ExpressionUUID->
    "b28a6269-0b58-488a-8b0c-91d7edff0baf"]}],
  RowBox[{"\"Insert a new locator in the graphic by holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key\\nand clicking where you want it to be. Delete a locator by \
clicking it\\nwhile holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" key.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->
  "CreateAndDeleteLocators",ExpressionUUID->"b88c44ac-805f-4112-af95-\
94e04235d323"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[
   " Slider Zoom",ExpressionUUID->"00ef6394-09ac-404f-8dc7-14c1b3138cfd"]}],
  RowBox[{"\"Hold down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key while moving a slider to make fine adjustments in the slider \
value.\\nHold \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" and/or \"", 
    FrameBox[
    "Shift", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" at the same time as \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" to make ever finer adjustments.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.7137072673377905`*^9},
 FontFamily->"Verdana",
 CellTags->
  "SliderZoom",ExpressionUUID->"b64827f0-90a2-46c4-8909-85e24d7ee88a"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[
   " Gamepad Controls",ExpressionUUID->
    "32e4c060-0668-49ef-b12b-7e2038547bbb"]}],
  "\"Control this Demonstration with a gamepad or other\\nhuman interface \
device connected to your computer.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.35696210375764*^9, 3.3895522232313623`*^9, 
  3.7137072678223915`*^9},
 FontFamily->"Verdana",
 CellTags->
  "GamepadControls",ExpressionUUID->"2cec08fd-1a44-4089-a97e-a8b499ffd4b9"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[
   " Automatic Animation",ExpressionUUID->
    "7d879f0b-6f05-4b6b-b822-b41fb4680ba0"]}],
  RowBox[{"\"Animate a slider in this Demonstration by clicking the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJzzTSzJSM1NLMlMTlRwL0osyMhMLlZwyy8CCjEzMjAwcIKwAgOI/R/IhBKc\n\
/4EAyGAG0f+nTZsGwgysIJIRKsWKLAXGIHFmEpUgLADxWUAkI24jZs+eTaEt\n\
IG+wQKRmzJgBlYf5lhEA30OqWA=="], "Graphics", ImageSize -> {9, 9}, ImageMargins -> 
      0, CellBaseline -> Baseline], BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"button\\nnext to the slider, and then clicking the play button that \
appears.\\nAnimate all controls by selecting \"", 
    StyleBox["Autorun", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.713707268305992*^9},
 FontFamily->"Verdana",
 CellTags->
  "AutomaticAnimation",ExpressionUUID->"66d13574-c10a-4077-95c5-43d3a6af0abf"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[
   " Bookmark Animation",ExpressionUUID->
    "e527e3b8-c2c7-4f7e-a47b-447182d6d82e"]}],
  RowBox[{
   "\"See a prepared animation of this Demonstration by selecting\\n\"", 
    StyleBox["Animate Bookmarks", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->
  "BookmarkAnimation",ExpressionUUID->"82cada34-0119-4ebf-b18f-889442542368"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SearchTermsSection",ExpressionUUID->"f99aa2f8-8ea2-4051-b7e2-919cf9b59928"],

Cell["absorber", "SearchTerms",
 CellChangeTimes->{{3.699963554258198*^9, 3.699963561136628*^9}, {
  3.7001325362287984`*^9, 3.7001325366462665`*^9}},
 CellID->571419602,
 $CellContext`ExpressionUUID -> 
 "b2c8ddd3-7f4e-433d-9397-c2b33a4bd411",ExpressionUUID->"065cb831-ecf8-4850-\
abc9-753533dabcec"],

Cell["separations", "SearchTerms",
 CellChangeTimes->{{3.699963554258198*^9, 3.69996356452505*^9}},
 CellID->10476732,
 $CellContext`ExpressionUUID -> 
 "13806975-af8e-493c-b9cd-47cb17e887a6",ExpressionUUID->"1b4b0548-bede-4f7e-\
a649-4ccb4e3f789b"],

Cell["thermodynamics", "SearchTerms",
 CellChangeTimes->{{3.699963554258198*^9, 3.6999635674638557`*^9}},
 CellID->136327104,
 $CellContext`ExpressionUUID -> 
 "214dee35-2053-4e64-99ba-7ec73be8b140",ExpressionUUID->"33f9dad0-76f6-47c4-\
b823-635e8fb6705c"],

Cell["chemical engineering", "SearchTerms",
 CellChangeTimes->{{3.701777496969943*^9, 3.701777512560342*^9}, {
  3.702145335168208*^9, 3.7021453361507998`*^9}},
 CellID->376250675,
 $CellContext`ExpressionUUID -> 
 "6f806c31-7c26-4356-92cf-9457a9b2ca22",ExpressionUUID->"969e10fa-ae7e-4eab-\
bb96-75bc77d181d2"],

Cell["absorption", "SearchTerms",
 CellChangeTimes->{{3.702303715059513*^9, 3.702303725408763*^9}},
 CellID->569941490,
 $CellContext`ExpressionUUID -> 
 "bbd83a2b-2a68-45c4-b85c-c2442a61bfc5",ExpressionUUID->"50e77731-44f2-427b-\
8161-36b1fe7212ad"],

Cell["equilibrium stages", "SearchTerms",
 CellChangeTimes->{{3.702303715059513*^9, 3.702303729081808*^9}},
 CellID->5285287,
 $CellContext`ExpressionUUID -> 
 "6ebc6e57-0928-4706-a9cb-8ce2db3feb09",ExpressionUUID->"8d29e81d-efb5-43de-\
93af-1f02118d3ca6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "RelatedLinksSection",ExpressionUUID->"25eb2a4e-2777-4569-8258-fb7daffd970f"],

Cell[TextData[ButtonBox["Carbon Dioxide Absorption in Water",
 BaseStyle->"Hyperlink",
 ButtonData->{
   URL["http://demonstrations.wolfram.com/CarbonDioxideAbsorptionInWater/"], 
   None},
 ButtonNote->
  "http://demonstrations.wolfram.com/CarbonDioxideAbsorptionInWater/"]], \
"RelatedLinks",
 CellID->1872135986,ExpressionUUID->"c4d8aaae-2184-4fb3-81c2-67df74dcb4a6"],

Cell[TextData[ButtonBox["McCabe-Thiele Method for Methanol/Water Separation",
 BaseStyle->"Hyperlink",
 ButtonData->{
   URL["http://demonstrations.wolfram.com/\
McCabeThieleMethodForMethanolWaterSeparation/"], None},
 ButtonNote->
  "http://demonstrations.wolfram.com/\
McCabeThieleMethodForMethanolWaterSeparation/"]], "RelatedLinks",
 CellChangeTimes->{{3.699963664517885*^9, 3.6999636839361696`*^9}},
 CellID->42471128,
 $CellContext`ExpressionUUID -> 
 "cdb3e69b-81ad-4695-af41-15af7c7555b8",ExpressionUUID->"23edcb86-2282-4d17-\
9b06-6aba137422ac"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "AuthorSection",ExpressionUUID->"71688775-4ce9-4ab1-a7f0-0a0bcb290570"],

Cell[TextData[{
 "Contributed by: ",
 ButtonBox["Adam J. Johnston",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=Adam%20J.%\
20Johnston"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=Adam%20J.%\
20Johnston"],
 " and ",
 ButtonBox["Rachael L. Baumann",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=Rachael%20L.%\
20Baumann"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=Rachael%20L.%\
20Baumann"]
}], "Author",
 CellChangeTimes->{{3.699712700400914*^9, 3.699712711250766*^9}, {
  3.699712766442687*^9, 3.699712785590452*^9}, {3.6999636023826447`*^9, 
  3.699963604458664*^9}},
 CellID->347156356,
 $CellContext`ExpressionUUID -> 
 "ca47b61e-38b9-408d-afda-95466a86c7d6",ExpressionUUID->"1376aec1-d9a8-4934-\
83b3-b12c5a53734e"],

Cell[TextData[{
 "Additional contributions by: ",
 ButtonBox["John L. Falconer",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=John%20L.%\
20Falconer"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=John%20L.%20Falconer"]
}], "Author",
 CellChangeTimes->{{3.699712700400914*^9, 3.699712728131461*^9}, {
  3.6997128004249277`*^9, 3.6997128004249277`*^9}},
 CellID->373235529,
 $CellContext`ExpressionUUID -> 
 "39baa6b7-bfbd-410e-bf32-1c17245b691c",ExpressionUUID->"a529c17b-6829-478f-\
b6ca-70895ef52e1e"],

Cell["\<\
(University of Colorado Boulder, Department of Chemical and Biological \
Engineering)\
\>", "Author",
 CellChangeTimes->{{3.699712700400914*^9, 3.699712739137374*^9}},
 CellID->77347031,
 $CellContext`ExpressionUUID -> 
 "b8d8f6e5-3037-4f01-8c69-0946d1ec77a0",ExpressionUUID->"94c052aa-afe2-4b65-\
8688-1f0c578f5c33"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1366, 685},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "Demonstration.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "ResizeImages"->{
  Cell[275565, 6074, 472, 11, 22, "ControlSuggestions",ExpressionUUID->"73fbd87b-1397-40f5-9ef4-ea71f8fe2aa0",
   CellTags->"ResizeImages"]},
 "RotateAndZoomIn3D"->{
  Cell[276040, 6087, 800, 19, 22, "ControlSuggestions",ExpressionUUID->"10acbb6f-91cf-49fb-aa0c-31bab4e4b320",
   CellTags->"RotateAndZoomIn3D"]},
 "DragLocators"->{
  Cell[276843, 6108, 457, 13, 22, "ControlSuggestions",ExpressionUUID->"22c4c987-b6de-48ee-81f1-738812a47f17",
   CellTags->"DragLocators"]},
 "CreateAndDeleteLocators"->{
  Cell[277303, 6123, 761, 19, 22, "ControlSuggestions",ExpressionUUID->"b88c44ac-805f-4112-af95-94e04235d323",
   CellTags->"CreateAndDeleteLocators"]},
 "SliderZoom"->{
  Cell[278067, 6144, 1004, 24, 22, "ControlSuggestions",ExpressionUUID->"b64827f0-90a2-46c4-8909-85e24d7ee88a",
   CellTags->"SliderZoom"]},
 "GamepadControls"->{
  Cell[279074, 6170, 517, 13, 22, "ControlSuggestions",ExpressionUUID->"2cec08fd-1a44-4089-a97e-a8b499ffd4b9",
   CellTags->"GamepadControls"]},
 "AutomaticAnimation"->{
  Cell[279594, 6185, 1627, 35, 22, "ControlSuggestions",ExpressionUUID->"66d13574-c10a-4077-95c5-43d3a6af0abf",
   CellTags->"AutomaticAnimation"]},
 "BookmarkAnimation"->{
  Cell[281224, 6222, 1030, 24, 22, "ControlSuggestions",ExpressionUUID->"82cada34-0119-4ebf-b18f-889442542368",
   CellTags->"BookmarkAnimation"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"ResizeImages", 287429, 6399},
 {"RotateAndZoomIn3D", 287595, 6402},
 {"DragLocators", 287761, 6405},
 {"CreateAndDeleteLocators", 287933, 6408},
 {"SliderZoom", 288103, 6411},
 {"GamepadControls", 288266, 6414},
 {"AutomaticAnimation", 288436, 6417},
 {"BookmarkAnimation", 288609, 6420}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 156, 3, 74, "DemoTitle",ExpressionUUID->"5f7a0c1f-f8a5-4441-bfb6-2a930302f635"],
Cell[739, 27, 88, 0, 275, "InitializationSection",ExpressionUUID->"0eb0a201-9e6b-43ce-9a4c-dfc84ab069eb"],
Cell[CellGroupData[{
Cell[852, 31, 84, 0, 189, "ManipulateSection",ExpressionUUID->"134c66fa-d8fc-4608-a960-59a3d076fc5e"],
Cell[CellGroupData[{
Cell[961, 35, 90225, 2020, 3325, "Input",ExpressionUUID->"85909ef7-6667-4d2d-9fd5-a413d70132db"],
Cell[91189, 2057, 32971, 705, 573, "Output",ExpressionUUID->"0bde5a57-b441-4da2-866c-94a037f5454d",
 CellID->193540993]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[124209, 2768, 91, 0, 169, "ManipulateCaptionSection",ExpressionUUID->"e8baaa75-4d3d-412a-8294-27c77d0d679a"],
Cell[124303, 2770, 3458, 67, 117, "ManipulateCaption",ExpressionUUID->"39a84f1b-94ff-46d6-af87-d8177c58a60a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[127798, 2842, 83, 0, 172, "ThumbnailSection",ExpressionUUID->"d04f8fda-d55e-4668-b008-802146f562b2"],
Cell[127884, 2844, 32907, 703, 540, "Output",ExpressionUUID->"315712ff-b166-402d-8446-f83bd80c0221",
 CellID->139225698]
}, Open  ]],
Cell[CellGroupData[{
Cell[160828, 3552, 83, 0, 142, "SnapshotsSection",ExpressionUUID->"d6da989e-d615-4027-9845-3dc29f6d97e9"],
Cell[160914, 3554, 32865, 703, 38, "Output",ExpressionUUID->"bb7d482c-6459-42b6-9200-fe4ec1c06b3f",
 CellID->860087793],
Cell[193782, 4259, 32861, 703, 38, "Output",ExpressionUUID->"5db2f06f-c8e6-4c90-988a-26559a645002",
 CellID->172181689],
Cell[226646, 4964, 32859, 703, 38, "Output",ExpressionUUID->"d8a3cf34-8bff-4590-b0bd-ac712a3863d9",
 CellID->3282822]
}, Open  ]],
Cell[CellGroupData[{
Cell[259542, 5672, 81, 0, 339, "DetailsSection",ExpressionUUID->"f58cb129-e576-4fee-bec9-cbf9ca274a51"],
Cell[259626, 5674, 573, 11, 22, "DetailNotes",ExpressionUUID->"7f94770f-6493-480b-81a2-9fc6a76c1e46",
 CellID->237613890],
Cell[260202, 5687, 963, 26, 23, "DetailNotes",ExpressionUUID->"76dc9c8c-b251-4401-8ba7-f133cae123b9",
 CellID->237742517],
Cell[261168, 5715, 488, 9, 22, "DetailNotes",ExpressionUUID->"aceed9e4-a9af-4657-99c7-6c663ca0eb68",
 CellID->106309455],
Cell[261659, 5726, 891, 24, 36, "DetailNotes",ExpressionUUID->"e0eb7908-439c-47ad-8c22-f9605cf52249",
 CellID->676069286],
Cell[262553, 5752, 3358, 72, 55, "DetailNotes",ExpressionUUID->"2c60ec08-0d5e-4b9a-8764-24d6e6ab80a6",
 CellID->40320643],
Cell[265914, 5826, 601, 9, 22, "DetailNotes",ExpressionUUID->"ce1b470d-4269-4612-9b66-53bf19b4e8bc",
 CellID->1035463846],
Cell[266518, 5837, 827, 20, 36, "DetailNotes",ExpressionUUID->"1a94da9e-b58e-4fbe-80b7-b8e667c43391",
 CellID->306537432],
Cell[267348, 5859, 1180, 30, 37, "DetailNotes",ExpressionUUID->"0ac866a3-ce3e-4b7d-a923-62cae86034b4",
 CellID->723145271],
Cell[268531, 5891, 2353, 53, 23, "DetailNotes",ExpressionUUID->"5ba8f4e2-7f6e-42bf-9358-1418e7678e0f",
 CellID->113387733],
Cell[270887, 5946, 840, 18, 23, "DetailNotes",ExpressionUUID->"db706999-eaf2-4435-b1d4-add9147566f8",
 CellID->531280496],
Cell[271730, 5966, 664, 19, 37, "DetailNotes",ExpressionUUID->"06bbff96-f8eb-43fc-8a1a-aa13680d112c",
 CellID->628231243],
Cell[272397, 5987, 2144, 58, 41, "DetailNotes",ExpressionUUID->"f110e247-739b-4cfd-83a6-e94d838f23b5",
 CellID->30972495],
Cell[274544, 6047, 302, 6, 22, "DetailNotes",ExpressionUUID->"6b219465-ad9f-47b4-ade6-9a5b52e8bacf",
 CellID->359414663],
Cell[274849, 6055, 584, 12, 22, "DetailNotes",ExpressionUUID->"080e04db-d1cd-41a2-b11e-9380683e0125",
 CellID->1027769137]
}, Open  ]],
Cell[CellGroupData[{
Cell[275470, 6072, 92, 0, 126, "ControlSuggestionsSection",ExpressionUUID->"da12d1be-1e9f-4aa7-8b0d-26dd927e7cc1"],
Cell[275565, 6074, 472, 11, 22, "ControlSuggestions",ExpressionUUID->"73fbd87b-1397-40f5-9ef4-ea71f8fe2aa0",
 CellTags->"ResizeImages"],
Cell[276040, 6087, 800, 19, 22, "ControlSuggestions",ExpressionUUID->"10acbb6f-91cf-49fb-aa0c-31bab4e4b320",
 CellTags->"RotateAndZoomIn3D"],
Cell[276843, 6108, 457, 13, 22, "ControlSuggestions",ExpressionUUID->"22c4c987-b6de-48ee-81f1-738812a47f17",
 CellTags->"DragLocators"],
Cell[277303, 6123, 761, 19, 22, "ControlSuggestions",ExpressionUUID->"b88c44ac-805f-4112-af95-94e04235d323",
 CellTags->"CreateAndDeleteLocators"],
Cell[278067, 6144, 1004, 24, 22, "ControlSuggestions",ExpressionUUID->"b64827f0-90a2-46c4-8909-85e24d7ee88a",
 CellTags->"SliderZoom"],
Cell[279074, 6170, 517, 13, 22, "ControlSuggestions",ExpressionUUID->"2cec08fd-1a44-4089-a97e-a8b499ffd4b9",
 CellTags->"GamepadControls"],
Cell[279594, 6185, 1627, 35, 22, "ControlSuggestions",ExpressionUUID->"66d13574-c10a-4077-95c5-43d3a6af0abf",
 CellTags->"AutomaticAnimation"],
Cell[281224, 6222, 1030, 24, 22, "ControlSuggestions",ExpressionUUID->"82cada34-0119-4ebf-b18f-889442542368",
 CellTags->"BookmarkAnimation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[282291, 6251, 85, 0, 158, "SearchTermsSection",ExpressionUUID->"f99aa2f8-8ea2-4051-b7e2-919cf9b59928"],
Cell[282379, 6253, 301, 6, 22, "SearchTerms",ExpressionUUID->"065cb831-ecf8-4850-abc9-753533dabcec",
 CellID->571419602],
Cell[282683, 6261, 249, 5, 22, "SearchTerms",ExpressionUUID->"1b4b0548-bede-4f7e-a649-4ccb4e3f789b",
 CellID->10476732],
Cell[282935, 6268, 256, 5, 22, "SearchTerms",ExpressionUUID->"33f9dad0-76f6-47c4-b823-635e8fb6705c",
 CellID->136327104],
Cell[283194, 6275, 311, 6, 22, "SearchTerms",ExpressionUUID->"969e10fa-ae7e-4eab-bb96-75bc77d181d2",
 CellID->376250675],
Cell[283508, 6283, 250, 5, 22, "SearchTerms",ExpressionUUID->"50e77731-44f2-427b-8161-36b1fe7212ad",
 CellID->569941490],
Cell[283761, 6290, 256, 5, 22, "SearchTerms",ExpressionUUID->"8d29e81d-efb5-43de-93af-1f02118d3ca6",
 CellID->5285287]
}, Open  ]],
Cell[CellGroupData[{
Cell[284054, 6300, 86, 0, 143, "RelatedLinksSection",ExpressionUUID->"25eb2a4e-2777-4569-8258-fb7daffd970f"],
Cell[284143, 6302, 370, 8, 22, "RelatedLinks",ExpressionUUID->"c4d8aaae-2184-4fb3-81c2-67df74dcb4a6",
 CellID->1872135986],
Cell[284516, 6312, 554, 12, 22, "RelatedLinks",ExpressionUUID->"23edcb86-2282-4d17-9b06-6aba137422ac",
 CellID->42471128]
}, Open  ]],
Cell[CellGroupData[{
Cell[285107, 6329, 80, 0, 141, "AuthorSection",ExpressionUUID->"71688775-4ce9-4ab1-a7f0-0a0bcb290570"],
Cell[285190, 6331, 914, 26, 22, "Author",ExpressionUUID->"1376aec1-d9a8-4934-83b3-b12c5a53734e",
 CellID->347156356],
Cell[286107, 6359, 596, 15, 22, "Author",ExpressionUUID->"a529c17b-6829-478f-b6ca-70895ef52e1e",
 CellID->373235529],
Cell[286706, 6376, 327, 8, 22, "Author",ExpressionUUID->"94c052aa-afe2-4b65-8688-1f0c578f5c33",
 CellID->77347031]
}, Open  ]]
}, Open  ]]
}
]
*)

