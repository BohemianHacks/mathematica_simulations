(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     76783,       1911]
NotebookOptionsPosition[     75790,       1872]
NotebookOutlinePosition[     76138,       1887]
CellTagsIndexPosition[     76095,       1884]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "y1", ",", "x0", ",", "yN1", ",", "yeq", ",", "yinlet", ",", "sol", ",",
        "check", ",", "check2", ",", "stage", ",", "test", ",", "n", ",", 
       "steps", ",", "stepping", ",", "points", ",", "subtract", ",", "data", 
       ",", "skip"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"y1", "=", "10"}], ";", 
      RowBox[{"x0", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yN1", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{"m2", "*", "x"}], "+", "y1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yeq", "[", "x_", "]"}], ":=", 
       RowBox[{"m1", "*", "x"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"yinlet", ":=", "C0"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", "yinlet"}], ",", 
           "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"check", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yN1", "[", "x", "]"}], "\[Equal]", "yinlet"}], ",", 
           "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"check2", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"yN1", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"stage", "[", "1", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", "y1"}], ",", "x"}], 
          "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"stage", "[", "i", "]"}], "=", 
         RowBox[{"x", "/.", 
          RowBox[{
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", 
              RowBox[{"yN1", "[", 
               RowBox[{"stage", "[", 
                RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ",", "x"}], "]"}], 
           "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", "100"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"test", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"stage", "[", "n", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", "50"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"n", "=", "1"}], ";", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"test", "[", 
           RowBox[{"[", "n", "]"}], "]"}], "<", "check"}], "\[And]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"check2", ">", "0"}], ",", 
           RowBox[{
            RowBox[{"yeq", "[", "check2", "]"}], ">", "yinlet"}], ",", 
           "True"}], "]"}]}], ",", 
        RowBox[{"n", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"test", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"yeq", "[", 
                RowBox[{"test", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"test", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"yN1", "[", 
                RowBox[{"test", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "1"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"stepping", "=", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", "y1"}], "}"}], "}"}], ",", "steps"}], "]"}], 
         ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"2", "*", "n"}], "+", "1"}], ",", "2"}], "}"}], 
          "\[Rule]", "C0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"points", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"N", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"stage", "[", "#", "]"}], ",", 
            RowBox[{"yeq", "[", 
             RowBox[{"stage", "[", "#", "]"}], "]"}]}], "}"}]}], "&"}], "/@", 
        RowBox[{"Range", "@", "n"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"subtract", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"points", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "}"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"points", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"#", "+", "1"}], ",", "2"}], "]"}], "]"}], "-", 
               RowBox[{"points", "[", 
                RowBox[{"[", 
                 RowBox[{"#", ",", "2"}], "]"}], "]"}]}], ")"}], "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", 
              RowBox[{
               RowBox[{"Length", "@", "points"}], "-", "1"}]}], "]"}]}]}], 
          "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"subtract", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"points", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"#", "+", "1"}], ",", "2"}], "]"}], "]"}], "-", 
           RowBox[{"points", "[", 
            RowBox[{"[", 
             RowBox[{"#", ",", "2"}], "]"}], "]"}]}], ")"}], "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", 
          RowBox[{
           RowBox[{"Length", "@", "points"}], "-", "1"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"subtract", "[", 
            RowBox[{"[", "#", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"points", "[", 
              RowBox[{"[", "#", "]"}], "]"}], ",", 
             RowBox[{"points", "[", 
              RowBox[{"[", 
               RowBox[{"#", "+", "1"}], "]"}], "]"}]}], "}"}]}], "}"}], "&"}],
         "/@", 
        RowBox[{"Range", "@", 
         RowBox[{"Length", "@", "subtract"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"skip", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[GreaterEqual]", "3.5"}], 
              ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}], "&"}], "/@", 
           "data"}], "]"}], ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"yN1", "[", "x", "]"}], ",", 
              RowBox[{"yeq", "[", "x", "]"}], ",", "yinlet"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", "1.3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"Thick", ",", "Dashed", ",", 
                 RowBox[{"RGBColor", "[", 
                  RowBox[{"0", ",", "0.7", ",", "0"}], "]"}]}], "}"}]}], 
              "}"}]}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "1.3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "120"}], "}"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", 
            RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"17", ",", "Black"}], "}"}]}], ",", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"450", ",", "425"}], "}"}]}], ",", 
            RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Epilog", "\[Rule]", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"yN1", "[", "check2", "]"}], ">", "yinlet"}], 
                  "\[Or]", 
                  RowBox[{"check2", "<", "0"}]}], ",", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Line", "@", "stepping"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"#", ",", "16"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"stage", "[", "#", "]"}], "+", "0.025"}], ",", 
                    RowBox[{
                    RowBox[{"yeq", "[", 
                    RowBox[{"stage", "[", "#", "]"}], "]"}], "-", "3"}]}], 
                    "}"}]}], "]"}], "&"}], "/@", 
                    RowBox[{"Range", "@", "n"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"#", ",", "16"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"skip", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "1"}], "]"}], "]"}], "+", "0.025"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"skip", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "2"}], "]"}], "]"}], "-", "3"}]}], 
                    "}"}]}], "]"}], "&"}], "/@", 
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "@", "skip"}]}]}], ","}], "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{"PointSize", "@", "0.015"}], ",", "Red", ",", 
                   RowBox[{"Point", "@", "points"}]}], "}"}]}], "]"}], ",", 
               "Green", ",", 
               RowBox[{"(*", 
                RowBox[{"Point", "@", "skip"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"Point", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"skip", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
                 RowBox[{"Range", "[", 
                  RowBox[{"1", ",", 
                   RowBox[{"Length", "@", "skip"}], ",", "2"}], "]"}]}], 
                "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", "points", ",", "subtract", ",", "data", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[GreaterEqual]", "3.5"}], 
              ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}], "&"}], "/@", 
           "data"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"skip", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", 
             RowBox[{"Length", "@", "skip"}], ",", "2"}], "]"}]}]}], 
         "\[IndentingNewLine]", "}"}], ",", 
        RowBox[{"Spacings", "\[Rule]", "1.5"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "C0", ",", "99", ",", "\"\<inlet concentration (ppm)\>\""}], 
             "}"}], ",", "40", ",", "120", ",", "1", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
          "]"}], ",", "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"m1", ",", "84"}], "}"}], ",", "84", ",", "108", ",", 
            "1", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"m2", ",", "77"}], "}"}], ",", "50", ",", "300", ",", 
            "1", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}]}], 
        "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.700568401159401*^9, 3.7005685408536572`*^9}, {
  3.700568579585452*^9, 3.700568579647852*^9}, {3.7005686220254583`*^9, 
  3.7005689899951415`*^9}, {3.700569027313722*^9, 3.7005691226581984`*^9}, {
  3.7005691752778845`*^9, 3.7005692282544403`*^9}, {3.7005694688736205`*^9, 
  3.7005695437366095`*^9}, {3.70056978598905*^9, 3.700569815159381*^9}, {
  3.700569922567136*^9, 3.7005699324759855`*^9}, {3.7005702124205027`*^9, 
  3.7005702204701347`*^9}, {3.7005703818235703`*^9, 3.700570530066718*^9}, {
  3.7008233501307187`*^9, 3.700823353796941*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`C0$$ = 99, $CellContext`m1$$ = 
    84, $CellContext`m2$$ = 77, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`C0$$], 99, "inlet concentration (ppm)"}, 40, 120, 
      1}, {{
       Hold[$CellContext`m1$$], 84}, 84, 108, 1}, {{
       Hold[$CellContext`m2$$], 77}, 50, 300, 1}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], SpanFromLeft}, {
          Manipulate`Place[2], 
          Manipulate`Place[3]}}, Alignment -> Left]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    1167., {390., 397.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`C0$4727$$ = 
    0, $CellContext`m1$4728$$ = 0, $CellContext`m2$4729$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`C0$$ = 99, $CellContext`m1$$ = 
        84, $CellContext`m2$$ = 77}, "ControllerVariables" :> {
        Hold[$CellContext`C0$$, $CellContext`C0$4727$$, 0], 
        Hold[$CellContext`m1$$, $CellContext`m1$4728$$, 0], 
        Hold[$CellContext`m2$$, $CellContext`m2$4729$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`y1$, $CellContext`x0$, $CellContext`yN1$, \
$CellContext`yeq$, $CellContext`yinlet$, $CellContext`sol$, \
$CellContext`check$, $CellContext`check2$, $CellContext`stage$, \
$CellContext`test$, $CellContext`n$, $CellContext`steps$, \
$CellContext`stepping$, $CellContext`points$, $CellContext`subtract$, \
$CellContext`data$, $CellContext`skip$}, $CellContext`y1$ = 
         10; $CellContext`x0$ = 0; $CellContext`yN1$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`m2$$ $CellContext`x$ + $CellContext`y1$; \
$CellContext`yeq$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`m1$$ $CellContext`x$; \
$CellContext`yinlet$ := $CellContext`C0$$; $CellContext`sol$ = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yeq$[$CellContext`x] == $CellContext`yinlet$, \
$CellContext`x], 1]]; $CellContext`check$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yN1$[$CellContext`x] == $CellContext`yinlet$, \
$CellContext`x], 1]]; $CellContext`check2$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yeq$[$CellContext`x] == \
$CellContext`yN1$[$CellContext`x], $CellContext`x], 1]]; $CellContext`stage$[
          1] = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yeq$[$CellContext`x] == $CellContext`y1$, \
$CellContext`x], 1]]; 
        Do[$CellContext`stage$[$CellContext`i] = ReplaceAll[$CellContext`x, 
            Part[
             Solve[$CellContext`yeq$[$CellContext`x] == $CellContext`yN1$[
                $CellContext`stage$[$CellContext`i - 1]], $CellContext`x], 
             1]], {$CellContext`i, 2, 100}]; $CellContext`test$ = Table[
           $CellContext`stage$[$CellContext`n$], {$CellContext`n$, 1, 
            50}]; $CellContext`n$ = 1; While[
          And[Part[$CellContext`test$, $CellContext`n$] < $CellContext`check$, 
           
           If[$CellContext`check2$ > 
            0, $CellContext`yeq$[$CellContext`check2$] > $CellContext`yinlet$,
             True]], 
          Increment[$CellContext`n$]]; $CellContext`steps$ = Flatten[
           Table[{{
              Part[$CellContext`test$, $CellContext`i], 
              $CellContext`yeq$[
               Part[$CellContext`test$, $CellContext`i]]}, {
              Part[$CellContext`test$, $CellContext`i], 
              $CellContext`yN1$[
               Part[$CellContext`test$, $CellContext`i]]}}, {$CellContext`i, 
             1, $CellContext`n$}], 1]; $CellContext`stepping$ = ReplacePart[
           
           Join[{{0, $CellContext`y1$}}, $CellContext`steps$], {
            2 $CellContext`n$ + 1, 
             2} -> $CellContext`C0$$]; $CellContext`points$ = Map[N[{
             $CellContext`stage$[#], 
             $CellContext`yeq$[
              $CellContext`stage$[#]]}]& , 
           Range[$CellContext`n$]]; $CellContext`subtract$ = 
         Map[Part[$CellContext`points$, # + 1, 2] - 
           Part[$CellContext`points$, #, 2]& , 
           Range[1, Length[$CellContext`points$] - 1]]; $CellContext`data$ = 
         Map[{
            Part[$CellContext`subtract$, #], {
             Part[$CellContext`points$, #], 
             Part[$CellContext`points$, # + 1]}}& , 
           Range[
            Length[$CellContext`subtract$]]]; $CellContext`skip$ = Partition[
           Flatten[
            Map[If[Part[#, 1] >= 3.5, 
              Part[#, 2], 
              Part[#, 2, 2]]& , $CellContext`data$]], 2]; Column[{
           Plot[{
             $CellContext`yN1$[$CellContext`x], 
             $CellContext`yeq$[$CellContext`x], $CellContext`yinlet$}, \
{$CellContext`x, 0, 1.3}, 
            PlotStyle -> {{Thick, Black}, {Thick, Blue}, {Thick, Dashed, 
               RGBColor[0, 0.7, 0]}}, PlotRange -> {{0, 1.3}, {0, 120}}, 
            Frame -> True, LabelStyle -> {17, Black}, ImageSize -> {450, 425},
             AspectRatio -> Full, Epilog -> {
              If[
               
               Or[$CellContext`yN1$[$CellContext`check2$] > \
$CellContext`yinlet$, $CellContext`check2$ < 0], {
                Line[$CellContext`stepping$], 
                Map[Text[
                  
                  Style[#, 16], {$CellContext`stage$[#] + 
                   0.025, $CellContext`yeq$[
                    $CellContext`stage$[#]] - 3}]& , 
                 Range[$CellContext`n$]], 
                PointSize[0.015], Red, 
                Point[$CellContext`points$]}], Green, 
              Point[
               Map[Part[$CellContext`skip$, #]& , 
                Range[1, 
                 Length[$CellContext`skip$], 
                 2]]]}], $CellContext`points$, $CellContext`subtract$, \
$CellContext`data$, 
           Map[If[Part[#, 1] >= 3.5, 
             Part[#, 2], 
             Part[#, 2, 2]]& , $CellContext`data$], 
           Map[Part[$CellContext`skip$, #]& , 
            Range[1, 
             Length[$CellContext`skip$], 2]]}, Spacings -> 1.5]], 
      "Specifications" :> {{{$CellContext`C0$$, 99, 
          "inlet concentration (ppm)"}, 40, 120, 1, Appearance -> "Labeled", 
         ControlPlacement -> 1}, {{$CellContext`m1$$, 84}, 84, 108, 1, 
         Appearance -> "Labeled", ImageSize -> Small, ControlPlacement -> 
         2}, {{$CellContext`m2$$, 77}, 50, 300, 1, Appearance -> "Labeled", 
         ImageSize -> Small, ControlPlacement -> 3}, 
        Grid[{{
           Manipulate`Place[1], SpanFromLeft}, {
           Manipulate`Place[2], 
           Manipulate`Place[3]}}, Alignment -> Left]}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{1218., {449., 456.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.700568380497701*^9, {3.7005684327699537`*^9, 3.7005685423572598`*^9}, {
   3.700568580330654*^9, 3.700568586595481*^9}, 3.7005686277004848`*^9, 
   3.7005686893816013`*^9, {3.7005687356528435`*^9, 3.700568768243198*^9}, {
   3.7005688183502626`*^9, 3.700568822969487*^9}, {3.700568857275874*^9, 
   3.700568865318919*^9}, 3.700568933314051*^9, 3.7005689904631424`*^9, {
   3.700569044478606*^9, 3.700569079201776*^9}, 3.700569124379202*^9, 
   3.7005692088654547`*^9, {3.7005694983865833`*^9, 3.7005695452464237`*^9}, {
   3.700569792127076*^9, 3.700569817457202*^9}, 3.7005699340203876`*^9, 
   3.7005702225605555`*^9, {3.7005704155055256`*^9, 3.7005704303524027`*^9}, 
   3.700570484140478*^9, 3.700570532079337*^9, {3.700823332848216*^9, 
   3.700823354171342*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Partition", "[", 
  RowBox[{
   RowBox[{"Flatten", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"4", ",", "5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"6", ",", "7"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"8", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"10", ",", "11"}], "}"}]}], "}"}]}], ",", "2"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.700569837216501*^9, 3.700569910361858*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "11"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7005698471237516`*^9, 3.700569910993084*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "C0", ",", "100", ",", "\"\<inlet concentration (ppm)\>\""}], 
           "}"}], ",", "40", ",", "120", ",", "1", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
        "]"}], ",", "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m1", ",", "85"}], "}"}], ",", "84", ",", "108", ",", "1", 
          ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m2", ",", "100"}], "}"}], ",", "50", ",", "300", ",", "1",
           ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}]}], 
      "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
   RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell["For picture", "Section",
 CellChangeTimes->{{3.700571195821023*^9, 3.700571198452643*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "yeq", ",", "yN1", ",", "yi", ",", "sol", ",", "check1", ",", "check2", 
       ",", "stage", ",", "test", ",", "n", ",", "steps", ",", "stepping"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"yeq", "[", "x_", "]"}], ":=", 
       RowBox[{"m1", "*", "x"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yN1", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{"m2", "*", "x"}], "+", "10"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"yi", "=", "C0"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", "yi"}], ",", "x"}], 
          "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"check1", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yN1", "[", "x", "]"}], "\[Equal]", "yi"}], ",", "x"}], 
          "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"check2", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"yN1", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"stage", "[", "1", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", "10"}], ",", "x"}], 
          "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"stage", "[", "i", "]"}], "=", 
         RowBox[{"x", "/.", 
          RowBox[{
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", 
              RowBox[{"yN1", "@", 
               RowBox[{"stage", "[", 
                RowBox[{"i", "-", "1"}], "]"}]}]}], ",", "x"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", "100"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"test", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"stage", "[", "n", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", "50"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"n", "=", "1"}], ";", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"test", "[", 
           RowBox[{"[", "n", "]"}], "]"}], "<", "check1"}], "\[And]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"check2", ">", "0"}], ",", 
           RowBox[{
            RowBox[{"yeq", "[", "check2", "]"}], ">", "yi"}], ",", "True"}], 
          "]"}]}], ",", 
        RowBox[{"n", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"test", "[", 
                RowBox[{"[", "#", "]"}], "]"}], ",", 
               RowBox[{"yeq", "@", 
                RowBox[{"test", "[", 
                 RowBox[{"[", "#", "]"}], "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"test", "[", 
                RowBox[{"[", "#", "]"}], "]"}], ",", 
               RowBox[{"yN1", "@", 
                RowBox[{"test", "[", 
                 RowBox[{"[", "#", "]"}], "]"}]}]}], "}"}]}], "}"}], "&"}], "/@", 
          RowBox[{"Range", "@", "n"}]}], ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"stepping", "=", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", "10"}], "}"}], "}"}], ",", "steps"}], "]"}], 
         ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"2", "*", "n"}], "+", "1"}], ",", "2"}], "}"}], 
          "\[Rule]", "C0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"yN1", "[", "x", "]"}], ",", 
          RowBox[{"yeq", "[", "x", "]"}], ",", "yi"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", "1.3"}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Dashed", ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "0.7", ",", "0"}], "]"}]}], "}"}]}], "}"}]}], 
        ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1.3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "120"}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<solute/(solute-free liquid)\>\"", ",", 
           "\"\<solute/(solute-free vapor)\>\""}], "}"}]}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"17", ",", "Black"}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"550", ",", "425"}], "}"}]}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"yN1", "[", "check2", "]"}], ">", "yi"}], "\[Or]", 
            RowBox[{"check2", "<", "0"}]}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Line", "@", "stepping"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"#", ",", "16"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"stage", "[", "#", "]"}], "+", "0.025"}], ",", 
                   RowBox[{
                    RowBox[{"yeq", "[", 
                    RowBox[{"stage", "[", "#", "]"}], "]"}], "-", "3"}]}], 
                  "}"}]}], "]"}], "&"}], "/@", 
              RowBox[{"Range", "@", "n"}]}]}], "}"}]}], "]"}]}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "C0", ",", "99", ",", "\"\<inlet concentration (ppm)\>\""}], 
             "}"}], ",", "40", ",", "120", ",", "1", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
          "]"}], ",", "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<slopes:\>\"", ",", "Bold"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"m1", ",", "84", ",", 
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{"\"\<equiibrium line \>\"", ",", 
                 RowBox[{"Subscript", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
                   "\"\<eq\>\""}], "]"}]}], "}"}]}]}], "}"}], ",", "84", ",", 
            "108", ",", "1", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"m2", ",", "77", ",", 
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{"\"\<operating line \>\"", ",", 
                 RowBox[{"Subscript", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
                   RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<N\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\< + 1\>\""}], "}"}]}]}], "]"}]}], "}"}]}]}], "}"}], 
            ",", "50", ",", "300", ",", "1", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}]}], 
        "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.700570566268895*^9, 3.700570648319518*^9}, {
  3.7005706810514755`*^9, 3.700571170161133*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`C0$$ = 99, $CellContext`m1$$ = 
    84, $CellContext`m2$$ = 77, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`C0$$], 99, "inlet concentration (ppm)"}, 40, 120, 
      1}, {{
       Hold[$CellContext`m1$$], 84, 
       Row[{"equiibrium line ", 
         Subscript[
          Style["y", Italic], "eq"]}]}, 84, 108, 1}, {{
       Hold[$CellContext`m2$$], 77, 
       Row[{"operating line ", 
         Subscript[
          Style["y", Italic], 
          Row[{
            Style["N", Italic], " + 1"}]]}]}, 50, 300, 1}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], SpanFromLeft}, {
          Style["slopes:", Bold], 
          Manipulate`Place[2], 
          Manipulate`Place[3]}}, Alignment -> Left]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    550., {209., 216.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`C0$54701$$ = 
    0, $CellContext`m1$54702$$ = 0, $CellContext`m2$54703$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`C0$$ = 99, $CellContext`m1$$ = 
        84, $CellContext`m2$$ = 77}, "ControllerVariables" :> {
        Hold[$CellContext`C0$$, $CellContext`C0$54701$$, 0], 
        Hold[$CellContext`m1$$, $CellContext`m1$54702$$, 0], 
        Hold[$CellContext`m2$$, $CellContext`m2$54703$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`yeq$, $CellContext`yN1$, $CellContext`yi$, \
$CellContext`sol$, $CellContext`check1$, $CellContext`check2$, \
$CellContext`stage$, $CellContext`test$, $CellContext`n$, \
$CellContext`steps$, $CellContext`stepping$}, $CellContext`yeq$[
           Pattern[$CellContext`x$, 
            Blank[]]] := $CellContext`m1$$ $CellContext`x$; $CellContext`yN1$[
           Pattern[$CellContext`x$, 
            Blank[]]] := $CellContext`m2$$ $CellContext`x$ + 
          10; $CellContext`yi$ = $CellContext`C0$$; $CellContext`sol$ = 
         ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yeq$[$CellContext`x] == $CellContext`yi$, \
$CellContext`x], 1]]; $CellContext`check1$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yN1$[$CellContext`x] == $CellContext`yi$, \
$CellContext`x], 1]]; $CellContext`check2$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yeq$[$CellContext`x] == \
$CellContext`yN1$[$CellContext`x], $CellContext`x], 1]]; $CellContext`stage$[
          1] = ReplaceAll[$CellContext`x, 
           Part[
            Solve[$CellContext`yeq$[$CellContext`x] == 10, $CellContext`x], 
            1]]; Do[$CellContext`stage$[$CellContext`i] = 
          ReplaceAll[$CellContext`x, 
            Part[
             Solve[$CellContext`yeq$[$CellContext`x] == $CellContext`yN1$[
                $CellContext`stage$[$CellContext`i - 1]], $CellContext`x], 
             1]], {$CellContext`i, 2, 100}]; $CellContext`test$ = Table[
           $CellContext`stage$[$CellContext`n$], {$CellContext`n$, 1, 
            50}]; $CellContext`n$ = 1; While[
          And[
          Part[$CellContext`test$, $CellContext`n$] < $CellContext`check1$, 
           
           If[$CellContext`check2$ > 
            0, $CellContext`yeq$[$CellContext`check2$] > $CellContext`yi$, 
            True]], 
          Increment[$CellContext`n$]]; $CellContext`steps$ = Flatten[
           Map[{{
              Part[$CellContext`test$, #], 
              $CellContext`yeq$[
               Part[$CellContext`test$, #]]}, {
              Part[$CellContext`test$, #], 
              $CellContext`yN1$[
               Part[$CellContext`test$, #]]}}& , 
            Range[$CellContext`n$]], 1]; $CellContext`stepping$ = ReplacePart[
           
           Join[{{0, 10}}, $CellContext`steps$], {
            2 $CellContext`n$ + 1, 2} -> $CellContext`C0$$]; Plot[{
           $CellContext`yN1$[$CellContext`x], 
           $CellContext`yeq$[$CellContext`x], $CellContext`yi$}, \
{$CellContext`x, 0, 1.3}, 
          PlotStyle -> {{Thick, Black}, {Thick, Blue}, {Thick, Dashed, 
             RGBColor[0, 0.7, 0]}}, PlotRange -> {{0, 1.3}, {0, 120}}, Frame -> 
          True, FrameLabel -> {
           "solute/(solute-free liquid)", "solute/(solute-free vapor)"}, 
          LabelStyle -> {17, Black}, ImageSize -> {550, 425}, AspectRatio -> 
          Full, Epilog -> If[
            
            Or[$CellContext`yN1$[$CellContext`check2$] > $CellContext`yi$, \
$CellContext`check2$ < 0], {
             Line[$CellContext`stepping$], 
             Map[Text[
               
               Style[#, 16], {$CellContext`stage$[#] + 
                0.025, $CellContext`yeq$[
                  $CellContext`stage$[#]] - 3}]& , 
              Range[$CellContext`n$]]}]]], 
      "Specifications" :> {{{$CellContext`C0$$, 99, 
          "inlet concentration (ppm)"}, 40, 120, 1, Appearance -> "Labeled", 
         ControlPlacement -> 1}, {{$CellContext`m1$$, 84, 
          Row[{"equiibrium line ", 
            Subscript[
             Style["y", Italic], "eq"]}]}, 84, 108, 1, Appearance -> 
         "Labeled", ImageSize -> Small, ControlPlacement -> 
         2}, {{$CellContext`m2$$, 77, 
          Row[{"operating line ", 
            Subscript[
             Style["y", Italic], 
             Row[{
               Style["N", Italic], " + 1"}]]}]}, 50, 300, 1, Appearance -> 
         "Labeled", ImageSize -> Small, ControlPlacement -> 3}, 
        Grid[{{
           Manipulate`Place[1], SpanFromLeft}, {
           Style["slopes:", Bold], 
           Manipulate`Place[2], 
           Manipulate`Place[3]}}, Alignment -> Left]}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{621., {268., 275.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.700570578021763*^9, {3.70057064211769*^9, 3.700570650567922*^9}, {
   3.7005707058909993`*^9, 3.7005707761023655`*^9}, {3.7005708177645864`*^9, 
   3.7005708464187202`*^9}, 3.700570923954918*^9, {3.700571010312765*^9, 
   3.700571032218157*^9}, 3.7005711092230067`*^9, {3.700571165179508*^9, 
   3.700571170642544*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["For code", "Section",
 CellChangeTimes->{{3.7005712057248726`*^9, 3.7005712074406857`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "yeq", ",", "yN1", ",", "sol", ",", "check1", ",", "check2", ",", 
       "stage", ",", "test", ",", "n", ",", "steps", ",", "stepping"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"yeq", "[", "x_", "]"}], ":=", 
       RowBox[{"m1", "*", "x"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yN1", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{"m2", "*", "x"}], "+", "10"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", "yi"}], ",", "x"}], 
          "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"check1", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yN1", "[", "x", "]"}], "\[Equal]", "yi"}], ",", "x"}], 
          "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"check2", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"yN1", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"stage", "[", "1", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", "10"}], ",", "x"}], 
          "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"stage", "[", "i", "]"}], "=", 
         RowBox[{"x", "/.", 
          RowBox[{
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", 
              RowBox[{"yN1", "@", 
               RowBox[{"stage", "[", 
                RowBox[{"i", "-", "1"}], "]"}]}]}], ",", "x"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", "100"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"test", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"stage", "[", "n", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", "50"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"n", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"test", "[", 
           RowBox[{"[", "n", "]"}], "]"}], "<", "check1"}], "\[And]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"check2", ">", "0"}], ",", 
           RowBox[{
            RowBox[{"yeq", "[", "check2", "]"}], ">", "yi"}], ",", "True"}], 
          "]"}]}], ",", 
        RowBox[{"n", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"test", "[", 
                RowBox[{"[", "#", "]"}], "]"}], ",", 
               RowBox[{"yeq", "@", 
                RowBox[{"test", "[", 
                 RowBox[{"[", "#", "]"}], "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"test", "[", 
                RowBox[{"[", "#", "]"}], "]"}], ",", 
               RowBox[{"yN1", "@", 
                RowBox[{"test", "[", 
                 RowBox[{"[", "#", "]"}], "]"}]}]}], "}"}]}], "}"}], "&"}], "/@", 
          RowBox[{"Range", "@", "n"}]}], ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"stepping", "=", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", "10"}], "}"}], "}"}], ",", "steps"}], "]"}], 
         ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"2", "*", "n"}], "+", "1"}], ",", "2"}], "}"}], 
          "\[Rule]", "yi"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"yN1", "[", "x", "]"}], ",", 
          RowBox[{"yeq", "[", "x", "]"}], ",", "yi"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", "1.3"}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Dashed", ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "0.7", ",", "0"}], "]"}]}], "}"}]}], "}"}]}], 
        ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1.3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "120"}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"550", ",", "425"}], "}"}]}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"yN1", "[", "check2", "]"}], ">", "yi"}], "\[Or]", 
            RowBox[{"check2", "<", "0"}]}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Line", "@", "stepping"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"#", ",", "16"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"stage", "[", "#", "]"}], "+", "0.025"}], ",", 
                   RowBox[{
                    RowBox[{"yeq", "[", 
                    RowBox[{"stage", "[", "#", "]"}], "]"}], "-", "3"}]}], 
                  "}"}]}], "]"}], "&"}], "/@", 
              RowBox[{"Range", "@", "n"}]}]}], "}"}]}], "]"}]}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "yi", ",", "99", ",", "\"\<inlet concentration (ppm)\>\""}], 
             "}"}], ",", "40", ",", "120", ",", "1", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
          "]"}], ",", "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<slopes:\>\"", ",", "Bold"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "m1", ",", "84", ",", 
              "\"\<\!\(\*SubscriptBox[\(y\), \(eq\)]\)\>\""}], "}"}], ",", 
            "84", ",", "108", ",", "1", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "m2", ",", "77", ",", 
              "\"\<\!\(\*SubscriptBox[\(y\), \(N + 1\)]\)\>\""}], "}"}], ",", 
            "50", ",", "300", ",", "1", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}]}], 
        "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.70057122048155*^9, 3.7005712628349695`*^9}, {
  3.7005712962857437`*^9, 3.7005713468785987`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`m1$$ = 84, $CellContext`m2$$ = 
    77, $CellContext`yi$$ = 99, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`yi$$], 99, "inlet concentration (ppm)"}, 40, 120, 
      1}, {{
       Hold[$CellContext`m1$$], 84, "\!\(\*SubscriptBox[\(y\), \(eq\)]\)"}, 
      84, 108, 1}, {{
       Hold[$CellContext`m2$$], 77, "\!\(\*SubscriptBox[\(y\), \(N + 1\)]\)"},
       50, 300, 1}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], SpanFromLeft}, {
          Style["slopes:", Bold], 
          Manipulate`Place[2], 
          Manipulate`Place[3]}}, Alignment -> Left]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    550., {209., 216.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`yi$56519$$ = 
    0, $CellContext`m1$56520$$ = 0, $CellContext`m2$56521$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`m1$$ = 84, $CellContext`m2$$ = 
        77, $CellContext`yi$$ = 99}, "ControllerVariables" :> {
        Hold[$CellContext`yi$$, $CellContext`yi$56519$$, 0], 
        Hold[$CellContext`m1$$, $CellContext`m1$56520$$, 0], 
        Hold[$CellContext`m2$$, $CellContext`m2$56521$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`yeq$, $CellContext`yN1$, $CellContext`sol$, \
$CellContext`check1$, $CellContext`check2$, $CellContext`stage$, \
$CellContext`test$, $CellContext`n$, $CellContext`steps$, \
$CellContext`stepping$}, $CellContext`yeq$[
           Pattern[$CellContext`x$, 
            Blank[]]] := $CellContext`m1$$ $CellContext`x$; $CellContext`yN1$[
           Pattern[$CellContext`x$, 
            Blank[]]] := $CellContext`m2$$ $CellContext`x$ + 
          10; $CellContext`sol$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yeq$[$CellContext`x] == $CellContext`yi$$, \
$CellContext`x], 1]]; $CellContext`check1$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yN1$[$CellContext`x] == $CellContext`yi$$, \
$CellContext`x], 1]]; $CellContext`check2$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yeq$[$CellContext`x] == \
$CellContext`yN1$[$CellContext`x], $CellContext`x], 1]]; $CellContext`stage$[
          1] = ReplaceAll[$CellContext`x, 
           Part[
            Solve[$CellContext`yeq$[$CellContext`x] == 10, $CellContext`x], 
            1]]; Do[$CellContext`stage$[$CellContext`i] = 
          ReplaceAll[$CellContext`x, 
            Part[
             Solve[$CellContext`yeq$[$CellContext`x] == $CellContext`yN1$[
                $CellContext`stage$[$CellContext`i - 1]], $CellContext`x], 
             1]], {$CellContext`i, 2, 100}]; $CellContext`test$ = Table[
           $CellContext`stage$[$CellContext`n$], {$CellContext`n$, 1, 
            50}]; $CellContext`n$ = 1; While[
          And[
          Part[$CellContext`test$, $CellContext`n$] < $CellContext`check1$, 
           
           If[$CellContext`check2$ > 
            0, $CellContext`yeq$[$CellContext`check2$] > $CellContext`yi$$, 
            True]], 
          Increment[$CellContext`n$]]; $CellContext`steps$ = Flatten[
           Map[{{
              Part[$CellContext`test$, #], 
              $CellContext`yeq$[
               Part[$CellContext`test$, #]]}, {
              Part[$CellContext`test$, #], 
              $CellContext`yN1$[
               Part[$CellContext`test$, #]]}}& , 
            Range[$CellContext`n$]], 1]; $CellContext`stepping$ = ReplacePart[
           Join[{{0, 10}}, $CellContext`steps$], {
            2 $CellContext`n$ + 1, 2} -> $CellContext`yi$$]; Plot[{
           $CellContext`yN1$[$CellContext`x], 
           $CellContext`yeq$[$CellContext`x], $CellContext`yi$$}, \
{$CellContext`x, 0, 1.3}, 
          PlotStyle -> {{Thick, Black}, {Thick, Blue}, {Thick, Dashed, 
             RGBColor[0, 0.7, 0]}}, PlotRange -> {{0, 1.3}, {0, 120}}, Frame -> 
          True, ImageSize -> {550, 425}, AspectRatio -> Full, Epilog -> If[
            
            Or[$CellContext`yN1$[$CellContext`check2$] > $CellContext`yi$$, \
$CellContext`check2$ < 0], {
             Line[$CellContext`stepping$], 
             Map[Text[
               
               Style[#, 16], {$CellContext`stage$[#] + 
                0.025, $CellContext`yeq$[
                  $CellContext`stage$[#]] - 3}]& , 
              Range[$CellContext`n$]]}]]], 
      "Specifications" :> {{{$CellContext`yi$$, 99, 
          "inlet concentration (ppm)"}, 40, 120, 1, Appearance -> "Labeled", 
         ControlPlacement -> 
         1}, {{$CellContext`m1$$, 84, "\!\(\*SubscriptBox[\(y\), \(eq\)]\)"}, 
         84, 108, 1, Appearance -> "Labeled", ImageSize -> Small, 
         ControlPlacement -> 
         2}, {{$CellContext`m2$$, 77, 
          "\!\(\*SubscriptBox[\(y\), \(N + 1\)]\)"}, 50, 300, 1, Appearance -> 
         "Labeled", ImageSize -> Small, ControlPlacement -> 3}, 
        Grid[{{
           Manipulate`Place[1], SpanFromLeft}, {
           Style["slopes:", Bold], 
           Manipulate`Place[2], 
           Manipulate`Place[3]}}, Alignment -> Left]}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{601., {268., 275.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.7005712100014954`*^9, 3.700571275164423*^9}, {
  3.7005713398055706`*^9, 3.70057135029122*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "yeq", ",", "yN1", ",", "sol", ",", "check1", ",", "check2", ",", 
       "stage", ",", "test", ",", "n", ",", "steps", ",", "stepping"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"yeq", "[", "x_", "]"}], ":=", 
       RowBox[{"m1", "*", "x"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yN1", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{"m2", "*", "x"}], "+", "10"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", "yi"}], ",", "x"}], 
          "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"check1", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yN1", "[", "x", "]"}], "\[Equal]", "yi"}], ",", "x"}], 
          "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"check2", "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"yN1", "[", "x", "]"}]}], ",", "x"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"stage", "[", "1", "]"}], "=", 
       RowBox[{"x", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", "10"}], ",", "x"}], 
          "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"stage", "[", "i", "]"}], "=", 
         RowBox[{"x", "/.", 
          RowBox[{
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"yeq", "[", "x", "]"}], "\[Equal]", 
              RowBox[{"yN1", "@", 
               RowBox[{"stage", "[", 
                RowBox[{"i", "-", "1"}], "]"}]}]}], ",", "x"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", "100"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"test", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"stage", "[", "n", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", "50"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"n", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"test", "[", 
           RowBox[{"[", "n", "]"}], "]"}], "<", "check1"}], "&&", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"check2", ">", "0"}], ",", 
           RowBox[{
            RowBox[{"yeq", "[", "check2", "]"}], ">", "yi"}], ",", "True"}], 
          "]"}]}], ",", 
        RowBox[{"n", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"test", "[", 
                RowBox[{"[", "#", "]"}], "]"}], ",", 
               RowBox[{"yeq", "@", 
                RowBox[{"test", "[", 
                 RowBox[{"[", "#", "]"}], "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"test", "[", 
                RowBox[{"[", "#", "]"}], "]"}], ",", 
               RowBox[{"yN1", "@", 
                RowBox[{"test", "[", 
                 RowBox[{"[", "#", "]"}], "]"}]}]}], "}"}]}], "}"}], "&"}], "/@", 
          RowBox[{"Range", "@", "n"}]}], ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"stepping", "=", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", "10"}], "}"}], "}"}], ",", "steps"}], "]"}], 
         ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"2", "*", "n"}], "+", "1"}], ",", "2"}], "}"}], 
          "\[Rule]", "yi"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"yN1", "[", "x", "]"}], ",", 
          RowBox[{"yeq", "[", "x", "]"}], ",", "yi"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", "1.3"}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Dashed", ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "0.7", ",", "0"}], "]"}]}], "}"}]}], "}"}]}], 
        ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1.3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "120"}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"550", ",", "425"}], "}"}]}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Or", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"yN1", "[", "check2", "]"}], ">", "yi"}], ",", 
             RowBox[{"check2", "<", "0"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Line", "@", "stepping"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"#", ",", "16"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"stage", "[", "#", "]"}], "+", "0.025"}], ",", 
                   RowBox[{
                    RowBox[{"yeq", "[", 
                    RowBox[{"stage", "[", "#", "]"}], "]"}], "-", "3"}]}], 
                  "}"}]}], "]"}], "&"}], "/@", 
              RowBox[{"Range", "@", "n"}]}]}], "}"}]}], "]"}]}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "yi", ",", "99", ",", "\"\<inlet concentration (ppm)\>\""}], 
             "}"}], ",", "40", ",", "120", ",", "1", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
          "]"}], ",", "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<slopes:\>\"", ",", "Bold"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "m1", ",", "84", ",", 
              "\"\<\!\(\*SubscriptBox[\(y\), \(eq\)]\)\>\""}], "}"}], ",", 
            "84", ",", "108", ",", "1", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "m2", ",", "77", ",", 
              "\"\<\!\(\*SubscriptBox[\(y\), \(N + 1\)]\)\>\""}], "}"}], ",", 
            "50", ",", "300", ",", "1", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}]}], 
        "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7005719179998837`*^9, 3.700571946965066*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`m1$$ = 84, $CellContext`m2$$ = 
    77, $CellContext`yi$$ = 99, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`yi$$], 99, "inlet concentration (ppm)"}, 40, 120, 
      1}, {{
       Hold[$CellContext`m1$$], 84, "\!\(\*SubscriptBox[\(y\), \(eq\)]\)"}, 
      84, 108, 1}, {{
       Hold[$CellContext`m2$$], 77, "\!\(\*SubscriptBox[\(y\), \(N + 1\)]\)"},
       50, 300, 1}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], SpanFromLeft}, {
          Style["slopes:", Bold], 
          Manipulate`Place[2], 
          Manipulate`Place[3]}}, Alignment -> Left]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    550., {209., 216.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`yi$57576$$ = 
    0, $CellContext`m1$57577$$ = 0, $CellContext`m2$57578$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`m1$$ = 84, $CellContext`m2$$ = 
        77, $CellContext`yi$$ = 99}, "ControllerVariables" :> {
        Hold[$CellContext`yi$$, $CellContext`yi$57576$$, 0], 
        Hold[$CellContext`m1$$, $CellContext`m1$57577$$, 0], 
        Hold[$CellContext`m2$$, $CellContext`m2$57578$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`yeq$, $CellContext`yN1$, $CellContext`sol$, \
$CellContext`check1$, $CellContext`check2$, $CellContext`stage$, \
$CellContext`test$, $CellContext`n$, $CellContext`steps$, \
$CellContext`stepping$}, $CellContext`yeq$[
           Pattern[$CellContext`x$, 
            Blank[]]] := $CellContext`m1$$ $CellContext`x$; $CellContext`yN1$[
           Pattern[$CellContext`x$, 
            Blank[]]] := $CellContext`m2$$ $CellContext`x$ + 
          10; $CellContext`sol$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yeq$[$CellContext`x] == $CellContext`yi$$, \
$CellContext`x], 1]]; $CellContext`check1$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yN1$[$CellContext`x] == $CellContext`yi$$, \
$CellContext`x], 1]]; $CellContext`check2$ = ReplaceAll[$CellContext`x, 
           Part[
            
            Solve[$CellContext`yeq$[$CellContext`x] == \
$CellContext`yN1$[$CellContext`x], $CellContext`x], 1]]; $CellContext`stage$[
          1] = ReplaceAll[$CellContext`x, 
           Part[
            Solve[$CellContext`yeq$[$CellContext`x] == 10, $CellContext`x], 
            1]]; Do[$CellContext`stage$[$CellContext`i] = 
          ReplaceAll[$CellContext`x, 
            Part[
             Solve[$CellContext`yeq$[$CellContext`x] == $CellContext`yN1$[
                $CellContext`stage$[$CellContext`i - 1]], $CellContext`x], 
             1]], {$CellContext`i, 2, 100}]; $CellContext`test$ = Table[
           $CellContext`stage$[$CellContext`n$], {$CellContext`n$, 1, 
            50}]; $CellContext`n$ = 1; While[
          And[
          Part[$CellContext`test$, $CellContext`n$] < $CellContext`check1$, 
           
           If[$CellContext`check2$ > 
            0, $CellContext`yeq$[$CellContext`check2$] > $CellContext`yi$$, 
            True]], 
          Increment[$CellContext`n$]]; $CellContext`steps$ = Flatten[
           Map[{{
              Part[$CellContext`test$, #], 
              $CellContext`yeq$[
               Part[$CellContext`test$, #]]}, {
              Part[$CellContext`test$, #], 
              $CellContext`yN1$[
               Part[$CellContext`test$, #]]}}& , 
            Range[$CellContext`n$]], 1]; $CellContext`stepping$ = ReplacePart[
           Join[{{0, 10}}, $CellContext`steps$], {
            2 $CellContext`n$ + 1, 2} -> $CellContext`yi$$]; Plot[{
           $CellContext`yN1$[$CellContext`x], 
           $CellContext`yeq$[$CellContext`x], $CellContext`yi$$}, \
{$CellContext`x, 0, 1.3}, 
          PlotStyle -> {{Thick, Black}, {Thick, Blue}, {Thick, Dashed, 
             RGBColor[0, 0.7, 0]}}, PlotRange -> {{0, 1.3}, {0, 120}}, Frame -> 
          True, ImageSize -> {550, 425}, AspectRatio -> Full, Epilog -> If[
            
            Or[$CellContext`yN1$[$CellContext`check2$] > $CellContext`yi$$, \
$CellContext`check2$ < 0], {
             Line[$CellContext`stepping$], 
             Map[Text[
               
               Style[#, 16], {$CellContext`stage$[#] + 
                0.025, $CellContext`yeq$[
                  $CellContext`stage$[#]] - 3}]& , 
              Range[$CellContext`n$]]}]]], 
      "Specifications" :> {{{$CellContext`yi$$, 99, 
          "inlet concentration (ppm)"}, 40, 120, 1, Appearance -> "Labeled", 
         ControlPlacement -> 
         1}, {{$CellContext`m1$$, 84, "\!\(\*SubscriptBox[\(y\), \(eq\)]\)"}, 
         84, 108, 1, Appearance -> "Labeled", ImageSize -> Small, 
         ControlPlacement -> 
         2}, {{$CellContext`m2$$, 77, 
          "\!\(\*SubscriptBox[\(y\), \(N + 1\)]\)"}, 50, 300, 1, Appearance -> 
         "Labeled", ImageSize -> Small, ControlPlacement -> 3}, 
        Grid[{{
           Manipulate`Place[1], SpanFromLeft}, {
           Style["slopes:", Bold], 
           Manipulate`Place[2], 
           Manipulate`Place[3]}}, Alignment -> Left]}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{601., {268., 275.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.7005718941123405`*^9, 3.7005719197349267`*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1366, 686},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 15982, 406, 905, "Input"],
Cell[16565, 430, 8520, 174, 922, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25122, 609, 713, 23, 30, "Input"],
Cell[25838, 634, 477, 15, 30, "Output"]
}, Open  ]],
Cell[26330, 652, 1379, 36, 107, "Input"],
Cell[CellGroupData[{
Cell[27734, 692, 96, 1, 70, "Section"],
Cell[CellGroupData[{
Cell[27855, 697, 10218, 266, 582, "Input"],
Cell[38076, 965, 6966, 148, 560, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[45091, 1119, 97, 1, 70, "Section"],
Cell[CellGroupData[{
Cell[45213, 1124, 9050, 240, 583, "Input"],
Cell[54266, 1366, 6236, 128, 560, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60539, 1499, 9032, 240, 583, "Input"],
Cell[69574, 1741, 6188, 127, 560, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

