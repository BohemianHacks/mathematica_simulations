(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     57002,       1349]
NotebookOptionsPosition[     56679,       1333]
NotebookOutlinePosition[     57023,       1348]
CellTagsIndexPosition[     56980,       1345]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "cond", ",", "zf", ",", "q", ",", "mve", ",", "P", ",", "VPMet", ",", 
       "VPWat", ",", "A12", ",", "A21", ",", "\[Gamma]1", ",", "\[Gamma]2", 
       ",", "i", ",", "x2", ",", "T", ",", "y2", ",", "equilb", ",", 
       "equilb2", ",", "feed", ",", "xpinch", ",", "ypinch", ",", "opertRect",
        ",", "opertStrp", ",", "Rmin", ",", "R", ",", "OpRect", ",", 
       "xinters", ",", "yinters", ",", "OpStrp", ",", "yr", ",", "xr", ",", 
       "v", ",", "t", ",", "ir", ",", "ys", ",", "xs", ",", "imax", ",", 
       "tbl1", ",", "tbl2", ",", "tbl3", ",", "tbl4", ",", "tblih", ",", 
       "tbliv", ",", "it", ",", "distflow", ",", "botflow", ",", "xybase", 
       ",", "mouse"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cond", "=", 
       RowBox[{"yinters", "\[GreaterEqual]", 
        RowBox[{"equilb", "[", "xinters", "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"zf", "=", "0.5"}], ";", 
      RowBox[{"q", "=", "0.5"}], ";", 
      RowBox[{"mve", "=", "1"}], ";", 
      RowBox[{"P", "=", "760"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"VPMet", "[", "T_", "]"}], ":=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"8.08097", "-", 
          FractionBox["1582.271", 
           RowBox[{"239.726", "+", "T"}]]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"VPWat", "[", "T_", "]"}], ":=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"8.07131", "-", 
          FractionBox["1730.63", 
           RowBox[{"233.426", "+", "T"}]]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"A12", "=", "0.5434"}], ";", 
      RowBox[{"A21", "=", "0.7923"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Gamma]1", "[", "i_", "]"}], "=", 
       RowBox[{"Exp", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"x2", "[", "i", "]"}], "2"], "*", 
         RowBox[{"(", 
          RowBox[{"A12", "+", 
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"A21", "-", "A12"}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"x2", "[", "i", "]"}]}], ")"}]}]}], ")"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Gamma]2", "[", "i_", "]"}], "=", 
       RowBox[{"Exp", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"x2", "[", "i", "]"}]}], ")"}], "2"], "*", 
         RowBox[{"(", 
          RowBox[{"A21", "+", 
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"A12", "-", "A21"}], ")"}], "*", 
            RowBox[{"x2", "[", "i", "]"}]}]}], ")"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Iteration", " ", "to", " ", "creat", " ", "curve"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"i", "<", "101"}], ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"x2", "[", "i", "]"}], "=", 
           RowBox[{"i", "*", "0.01"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"T", "[", "i", "]"}], "=", 
           RowBox[{"T", "/.", 
            RowBox[{"Quiet", "@", 
             RowBox[{"FindRoot", "[", 
              RowBox[{
               RowBox[{"P", "\[Equal]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"VPWat", "[", "T", "]"}], "*", 
                  RowBox[{"\[Gamma]1", "[", "i", "]"}], "*", 
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{"x2", "[", "i", "]"}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"VPMet", "[", "T", "]"}], "*", 
                  RowBox[{"\[Gamma]2", "[", "i", "]"}], "*", 
                  RowBox[{"x2", "[", "i", "]"}]}]}]}], ",", 
               RowBox[{"{", 
                RowBox[{"T", ",", "60"}], "}"}], ",", 
               RowBox[{"AccuracyGoal", "\[Rule]", " ", "5"}]}], "]"}]}]}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"y2", "[", "i", "]"}], "=", 
           RowBox[{
            RowBox[{"x2", "[", "i", "]"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"VPMet", "[", 
                  RowBox[{"T", "[", "i", "]"}], "]"}], "*", " ", 
                 RowBox[{"\[Gamma]2", "[", "i", "]"}], "*", " ", 
                 RowBox[{
                  RowBox[{"x2", "[", "i", "]"}], "/", "P"}]}], ")"}], "-", 
               RowBox[{"x2", "[", "i", "]"}]}], ")"}], "*", "mve"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"i", "++"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"equilb", "=", 
       RowBox[{"Interpolation", "@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x2", "[", "i", "]"}], ",", 
            RowBox[{"y2", "[", "i", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "100"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Extra", " ", "equation", " ", "to", " ", "incorporate", " ", 
        "murphree", " ", "vapor", " ", "efficiency", " ", "if", " ", 
        "desired"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"equilb2", "[", "m_", "]"}], "=", 
       RowBox[{"m", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"equilb", "[", "m", "]"}], "-", "m"}], ")"}], "*", 
         FractionBox["1", "mve"]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Feed", " ", "line"}], ",", " ", 
        RowBox[{"operating", " ", "lines"}], ",", " ", 
        RowBox[{
        "and", " ", "mass", " ", "balances", " ", "get", " ", "calculated", 
         " ", "here"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"feed", "[", "x_", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"q", "\[NotEqual]", "1"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q", " ", 
            RowBox[{"x", "/", 
             RowBox[{"(", 
              RowBox[{"q", "-", "1"}], ")"}]}]}], "-", 
           RowBox[{"zf", "/", 
            RowBox[{"(", 
             RowBox[{"q", "-", "1"}], ")"}]}]}], ")"}], ",", 
         RowBox[{
          RowBox[{"1000000", "*", 
           RowBox[{"(", 
            RowBox[{"x", "-", "zf"}], ")"}]}], "+", "zf"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"xpinch", "=", 
       RowBox[{"x", "/.", 
        RowBox[{"Quiet", "@", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"feed", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"equilb2", "[", "x", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0.5"}], "}"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ypinch", "=", 
       RowBox[{"feed", "[", "xpinch", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"opertRect", "[", "x_", "]"}], ":=", 
       RowBox[{"ypinch", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x", "-", "xpinch"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"xd", "-", "xpinch"}], ")"}]}], "*", 
         RowBox[{"(", 
          RowBox[{"xd", "-", "ypinch"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"opertStrp", "[", "x_", "]"}], ":=", 
       RowBox[{"ypinch", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x", "-", "xpinch"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"xb", "-", "xpinch"}], ")"}]}], "*", 
         RowBox[{"(", 
          RowBox[{"xb", "-", "ypinch"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Rmin", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"xd", "-", "ypinch"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"xd", "-", "xpinch"}], ")"}]}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"xd", "-", "ypinch"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"xd", "-", "xpinch"}], ")"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"R", "=", "lvmult"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"OpRect", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"R", "/", 
          RowBox[{"(", 
           RowBox[{"R", "+", "1"}], ")"}]}], "*", "x"}], "+", 
        RowBox[{"xd", "/", 
         RowBox[{"(", 
          RowBox[{"R", "+", "1"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xinters", "=", 
       RowBox[{"x", "/.", 
        RowBox[{"Quiet", "@", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"feed", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"OpRect", "[", "x", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0.7"}], "}"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"yinters", "=", 
       RowBox[{"OpRect", "[", "xinters", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"cond", ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"OpStrp", "[", "x_", "]"}], ":=", 
           RowBox[{"opertStrp", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"yr", "[", "0", "]"}], "=", "xd"}], ";", 
          RowBox[{
           RowBox[{"xr", "[", "0", "]"}], "=", "xd"}], ";", 
          RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"i", "<", "25"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"v", "=", 
               RowBox[{"u", "/.", 
                RowBox[{"Quiet", "[", 
                 RowBox[{"FindRoot", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"yr", "[", "i", "]"}], "\[Equal]", 
                    RowBox[{"equilb", "[", "u", "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"u", ",", "0.5"}], "}"}]}], "]"}], "]"}]}]}], ",", 
              RowBox[{"t", "=", 
               RowBox[{"opertRect", "[", "v", "]"}]}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"v", ">", "xpinch"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"xr", "[", 
                    RowBox[{"i", "+", "1"}], "]"}], "=", "v"}], ",", 
                  RowBox[{
                   RowBox[{"yr", "[", 
                    RowBox[{"i", "+", "1"}], "]"}], "=", "t"}]}], "}"}]}], 
               "]"}], ",", 
              RowBox[{"i", "++"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ir", "=", 
           RowBox[{"i", "-", "1"}]}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ir", "\[GreaterEqual]", " ", "0"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"ys", "[", "0", "]"}], "=", 
               RowBox[{"yr", "[", "ir", "]"}]}], ";", 
              RowBox[{
               RowBox[{"xs", "[", "0", "]"}], "=", 
               RowBox[{"xr", "[", "ir", "]"}]}]}], "}"}]}], "]"}], ";", 
          RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"i", "<", "20"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"v", "=", 
               RowBox[{"u", "/.", 
                RowBox[{"Quiet", "@", 
                 RowBox[{"FindRoot", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ys", "[", "i", "]"}], "\[Equal]", 
                    RowBox[{"equilb", "[", "u", "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"u", ",", "0.5"}], "}"}]}], "]"}]}]}]}], ",", 
              RowBox[{"t", "=", 
               RowBox[{"opertStrp", "[", "v", "]"}]}], ",", 
              RowBox[{
               RowBox[{"xs", "[", 
                RowBox[{"i", "+", "1"}], "]"}], "=", "v"}], ",", 
              RowBox[{
               RowBox[{"ys", "[", 
                RowBox[{"i", "+", "1"}], "]"}], "=", "t"}], ",", 
              RowBox[{"i", "++"}]}], "}"}]}], "]"}], ";"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"OpStrp", "[", "x_", "]"}], ":=", 
           RowBox[{"yinters", "+", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x", "-", "xinters"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"xb", "-", "xinters"}], ")"}]}], "*", 
             RowBox[{"(", 
              RowBox[{"xb", "-", "yinters"}], ")"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"yr", "[", "0", "]"}], "=", "xd"}], ";", 
          RowBox[{
           RowBox[{"xr", "[", "0", "]"}], "=", "xd"}], ";", 
          RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"xr", "[", "i", "]"}], ">", "xinters"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"v", "=", 
               RowBox[{"u", "/.", 
                RowBox[{"Quiet", "@", 
                 RowBox[{"FindRoot", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"yr", "[", "i", "]"}], "\[Equal]", 
                    RowBox[{"equilb", "[", "u", "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"u", ",", "0.7"}], "}"}]}], "]"}]}]}]}], ",", 
              RowBox[{"t", "=", 
               RowBox[{"OpRect", "[", "v", "]"}]}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"v", ">", "xinters"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"xr", "[", 
                    RowBox[{"i", "+", "1"}], "]"}], "=", "v"}], ",", 
                  RowBox[{
                   RowBox[{"yr", "[", 
                    RowBox[{"i", "+", "1"}], "]"}], "=", "t"}]}], "}"}]}], 
               "]"}], ",", 
              RowBox[{"i", "++"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ir", "=", 
           RowBox[{"i", "-", "1"}]}], ";", 
          RowBox[{"i", "=", "0"}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ir", "\[GreaterEqual]", "0"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"ys", "[", "0", "]"}], "=", 
              RowBox[{"yr", "[", "ir", "]"}]}], ";", 
             RowBox[{
              RowBox[{"xs", "[", "0", "]"}], "=", 
              RowBox[{"xr", "[", "ir", "]"}]}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"xs", "[", "i", "]"}], ">", "xb"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"v", "=", 
               RowBox[{"u", "/.", 
                RowBox[{"Quiet", "@", 
                 RowBox[{"FindRoot", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ys", "[", "i", "]"}], "\[Equal]", 
                    RowBox[{"equilb", "[", "u", "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"u", ",", "0.5"}], "}"}]}], "]"}]}]}]}], ",", 
              RowBox[{"t", "=", 
               RowBox[{"OpStrp", "[", "v", "]"}]}], ",", 
              RowBox[{
               RowBox[{"xs", "[", 
                RowBox[{"i", "+", "1"}], "]"}], "=", "v"}], ",", 
              RowBox[{
               RowBox[{"ys", "[", 
                RowBox[{"i", "+", "1"}], "]"}], "=", "t"}], ",", 
              RowBox[{"i", "++"}]}], "}"}]}], "]"}], ";"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"imax", "=", 
       RowBox[{"i", "-", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tbl1", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xr", "[", "i", "]"}], ",", 
              RowBox[{"yr", "[", 
               RowBox[{"i", "-", "1"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xr", "[", "i", "]"}], ",", 
              RowBox[{"yr", "[", "i", "]"}]}], "}"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "ir"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tbl2", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ir", "\[GreaterEqual]", " ", "1"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xr", "[", "i", "]"}], ",", 
                RowBox[{"yr", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xr", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], ",", 
                RowBox[{"yr", "[", "i", "]"}]}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", 
             RowBox[{"ir", "-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xr", "[", "i", "]"}], ",", 
                RowBox[{"yr", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xr", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], ",", 
                RowBox[{"yr", "[", "i", "]"}]}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "0"}], "}"}]}], "]"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"tbl3", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xs", "[", 
               RowBox[{"i", "+", "1"}], "]"}], ",", 
              RowBox[{"ys", "[", "i", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xs", "[", 
               RowBox[{"i", "+", "1"}], "]"}], ",", 
              RowBox[{"ys", "[", 
               RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"imax", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tbl4", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xs", "[", 
               RowBox[{"i", "-", "1"}], "]"}], ",", 
              RowBox[{"ys", "[", 
               RowBox[{"i", "-", "1"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xs", "[", "i", "]"}], ",", 
              RowBox[{"ys", "[", 
               RowBox[{"i", "-", "1"}], "]"}]}], "}"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"imax", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tblih", "=", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xs", "[", "1", "]"}], ",", 
            RowBox[{"ys", "[", "0", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xr", "[", "ir", "]"}], ",", 
            RowBox[{"ys", "[", "0", "]"}]}], "}"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tbliv", "=", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xs", "[", "1", "]"}], ",", 
            RowBox[{"ys", "[", "0", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xs", "[", "1", "]"}], ",", 
            RowBox[{"ys", "[", "1", "]"}]}], "}"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"it", "=", 
       RowBox[{"imax", "+", "ir", "+", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"distflow", "=", 
       FractionBox[
        RowBox[{"zf", "-", 
         RowBox[{"xs", "[", 
          RowBox[{"imax", "+", "1"}], "]"}]}], "xd"]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"botflow", "=", 
       RowBox[{"1", "-", "distflow"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"xybase", "=", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"equilb2", "[", "x", "]"}], ",", "x"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Thick", ",", "Red"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Thick", ",", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{"0", ",", "0.6", ",", "0"}], "]"}]}], "}"}]}], 
             "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"cond", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"feed", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "xpinch", ",", "zf"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", "Blue"}], "}"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"opertRect", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "xpinch", ",", "xd"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", 
                  RowBox[{"RGBColor", "[", 
                   RowBox[{"0", ",", "0.85", ",", "1"}], "]"}]}], "}"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"opertStrp", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "xb", ",", "xpinch"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", "Magenta"}], "}"}]}]}], "]"}]}], "}"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"feed", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "xinters", ",", "zf"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", "Blue"}], "}"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"OpRect", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "xinters", ",", "xd"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", 
                  RowBox[{"RGBColor", "[", 
                   RowBox[{"0", ",", "0.85", ",", "1"}], "]"}]}], "}"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"OpStrp", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "xb", ",", "xinters"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", "Magenta"}], "}"}]}]}], "]"}]}], 
            "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics", "@", 
          RowBox[{"{", 
           RowBox[{
           "Thick", ",", "tbl1", ",", "tbl2", ",", "tblih", ",", "tbliv"}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{"\"\<liquid mole fraction \>\"", ",", 
               RowBox[{"Subscript", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                 "\"\<met\>\""}], "]"}]}], "}"}]}], ",", 
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{"\"\<vapor mole fraction \>\"", ",", 
               RowBox[{"Subscript", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
                 "\"\<met\>\""}], "]"}]}], "}"}]}]}], "}"}]}], ",", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"17", ",", "Black"}], "}"}]}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
         RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"55", ",", "10"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"mouse", "=", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Mouseover", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Thickness", "@", "0.015"}], ",", "Transparent", ",", 
                RowBox[{"Line", "@", 
                 RowBox[{"Table", "[", 
                  RowBox[{"#1", ",", 
                   RowBox[{"Evaluate", "@", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "#2", ",", "0.05"}], "}"}]}]}]}], 
                  "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"#3", ",", "18", ",", "#4", ",", 
                  RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                RowBox[{"Dynamic", "@", "pt"}], ",", "#5"}], "]"}]}], "]"}], 
            "&"}], "@@@", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "x"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], ",", 
               RowBox[{"Row", "@", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                  "\"\< = \>\"", ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
                  "\"\< line\>\""}], "}"}]}], ",", 
               RowBox[{"RGBColor", "[", 
                RowBox[{"0", ",", "0.6", ",", "0"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"equilb2", "[", "x", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], ",", 
               "\"\<equilibrium curve\>\"", ",", "Red", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"feed", "[", "x", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{"cond", ",", "xpinch", ",", "xinters"}], "]"}], ",",
                  "zf"}], "}"}], ",", 
               RowBox[{"Row", "@", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<q\>\"", ",", "Italic"}], "]"}], ",", 
                  "\"\<-line\>\""}], "}"}]}], ",", "Blue", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{"cond", ",", 
                   RowBox[{"opertRect", "[", "x", "]"}], ",", 
                   RowBox[{"OpRect", "[", "x", "]"}]}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{"cond", ",", "xpinch", ",", "xinters"}], "]"}], ",",
                  "xd"}], "}"}], ",", "\"\<rectifying section\>\"", ",", 
               RowBox[{"RGBColor", "[", 
                RowBox[{"0", ",", "0.85", ",", "1"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{"cond", ",", 
                   RowBox[{"opertStrp", "[", "x", "]"}], ",", 
                   RowBox[{"OpStrp", "[", "x", "]"}]}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"xb", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{"cond", ",", "xpinch", ",", "xinters"}], "]"}]}], 
                "}"}], ",", "\"\<stripping section\>\"", ",", "Magenta", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], 
            "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Mouseover", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Thickness", "@", "0.015"}], ",", "Transparent", ",", 
              "tbl1", ",", "tbl2", ",", "tblih", ",", "tbliv"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<stages\>\"", ",", "18", ",", 
                RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
              RowBox[{"Dynamic", "@", "pt"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{"xybase", ",", "mouse", ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"600", ",", "375"}], "}"}]}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lvmult", ",", "3", ",", 
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{"\"\<external reflux ratio \>\"", ",", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<L\>\"", ",", "Italic"}], "]"}], "/", 
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<D\>\"", ",", "Italic"}], "]"}]}]}], "}"}]}]}],
              "}"}], ",", "0.25", ",", "10", ",", "0.25", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
          "]"}], ",", "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<mole fractions:\>\"", ",", "Bold"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xd", ",", "0.85", ",", 
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{"\"\<distillate \>\"", ",", 
                 RowBox[{"Subscript", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                   "\"\<d\>\""}], "]"}]}], "}"}]}]}], "}"}], ",", "0.8", ",", 
            "0.98", ",", "0.01", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}], ",", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xb", ",", "0.15", ",", 
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{"\"\<bottoms \>\"", ",", 
                 RowBox[{"Subscript", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                   "\"\<b\>\""}], "]"}]}], "}"}]}]}], "}"}], ",", "0.05", ",",
             "0.2", ",", "0.01", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"pt", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "Locator", ",", 
            RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
            RowBox[{"AutoAction", "\[Rule]", "True"}]}], "}"}], "]"}]}], 
        "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.681231088846168*^9, 3.681231109262608*^9}, {
  3.681231144359687*^9, 3.6812312241742334`*^9}, {3.6812312566272945`*^9, 
  3.6812313057827873`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`lvmult$$ = 3, $CellContext`pt$$ = {0.3895, 
    0.592}, $CellContext`xb$$ = 0.15, $CellContext`xd$$ = 0.85, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lvmult$$], 3, 
       Row[{
        "external reflux ratio ", Style["D", Italic]^(-1) 
         Style["L", Italic]}]}, 0.25, 10, 0.25}, {{
       Hold[$CellContext`xd$$], 0.85, 
       Row[{"distillate ", 
         Subscript[
          Style["x", Italic], "d"]}]}, 0.8, 0.98, 0.01}, {{
       Hold[$CellContext`xb$$], 0.15, 
       Row[{"bottoms ", 
         Subscript[
          Style["x", Italic], "b"]}]}, 0.05, 0.2, 0.01}, {{
       Hold[$CellContext`pt$$], {0, 0}}, Automatic}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], SpanFromLeft}, {
          Style["mole fractions:", Bold], 
          Manipulate`Place[2], 
          Manipulate`Place[3], 
          Manipulate`Place[4]}}, Alignment -> Left]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    600., {184., 191.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lvmult$86233$$ = 
    0, $CellContext`xd$86234$$ = 0, $CellContext`xb$86235$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`lvmult$$ = 
        3, $CellContext`pt$$ = {0, 0}, $CellContext`xb$$ = 
        0.15, $CellContext`xd$$ = 0.85}, "ControllerVariables" :> {
        Hold[$CellContext`lvmult$$, $CellContext`lvmult$86233$$, 0], 
        Hold[$CellContext`xd$$, $CellContext`xd$86234$$, 0], 
        Hold[$CellContext`xb$$, $CellContext`xb$86235$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`cond$, $CellContext`zf$, $CellContext`q$, \
$CellContext`mve$, $CellContext`P$, $CellContext`VPMet$, $CellContext`VPWat$, \
$CellContext`A12$, $CellContext`A21$, $CellContext`\[Gamma]1$, $CellContext`\
\[Gamma]2$, $CellContext`i$, $CellContext`x2$, $CellContext`T$, \
$CellContext`y2$, $CellContext`equilb$, $CellContext`equilb2$, \
$CellContext`feed$, $CellContext`xpinch$, $CellContext`ypinch$, \
$CellContext`opertRect$, $CellContext`opertStrp$, $CellContext`Rmin$, \
$CellContext`R$, $CellContext`OpRect$, $CellContext`xinters$, \
$CellContext`yinters$, $CellContext`OpStrp$, $CellContext`yr$, \
$CellContext`xr$, $CellContext`v$, $CellContext`t$, $CellContext`ir$, \
$CellContext`ys$, $CellContext`xs$, $CellContext`imax$, $CellContext`tbl1$, \
$CellContext`tbl2$, $CellContext`tbl3$, $CellContext`tbl4$, \
$CellContext`tblih$, $CellContext`tbliv$, $CellContext`it$, \
$CellContext`distflow$, $CellContext`botflow$, $CellContext`xybase$, \
$CellContext`mouse$}, $CellContext`cond$ = $CellContext`yinters$ >= \
$CellContext`equilb$[$CellContext`xinters$]; $CellContext`zf$ = 
         0.5; $CellContext`q$ = 0.5; $CellContext`mve$ = 1; $CellContext`P$ = 
         760; $CellContext`VPMet$[
           Pattern[$CellContext`T, 
            Blank[]]] := 
         10^(8.08097 - 1582.271/(
           239.726 + $CellContext`T)); $CellContext`VPWat$[
           Pattern[$CellContext`T, 
            Blank[]]] := 
         10^(8.07131 - 1730.63/(233.426 + $CellContext`T)); $CellContext`A12$ = 
         0.5434; $CellContext`A21$ = 0.7923; $CellContext`\[Gamma]1$[
           Pattern[$CellContext`i$, 
            Blank[]]] = 
         Exp[$CellContext`x2$[$CellContext`i$]^2 ($CellContext`A12$ + 
            2 ($CellContext`A21$ - $CellContext`A12$) (
              1 - $CellContext`x2$[$CellContext`i$]))]; \
$CellContext`\[Gamma]2$[
           Pattern[$CellContext`i$, 
            Blank[]]] = 
         Exp[(1 - $CellContext`x2$[$CellContext`i$])^2 ($CellContext`A21$ + 
            2 ($CellContext`A12$ - $CellContext`A21$) \
$CellContext`x2$[$CellContext`i$])]; $CellContext`i$ = 0; 
        While[$CellContext`i$ < 
          101, {$CellContext`x2$[$CellContext`i$] = $CellContext`i$ 
            0.01, $CellContext`T$[$CellContext`i$] = 
           ReplaceAll[$CellContext`T$, 
             Quiet[
              
              FindRoot[$CellContext`P$ == \
$CellContext`VPWat$[$CellContext`T$] $CellContext`\[Gamma]1$[$CellContext`i$] \
(1 - $CellContext`x2$[$CellContext`i$]) + \
$CellContext`VPMet$[$CellContext`T$] $CellContext`\[Gamma]2$[$CellContext`i$] \
$CellContext`x2$[$CellContext`i$], {$CellContext`T$, 60}, AccuracyGoal -> 
               5]]], $CellContext`y2$[$CellContext`i$] = \
$CellContext`x2$[$CellContext`i$] + ($CellContext`VPMet$[
                 $CellContext`T$[$CellContext`i$]] \
$CellContext`\[Gamma]2$[$CellContext`i$] \
($CellContext`x2$[$CellContext`i$]/$CellContext`P$) - \
$CellContext`x2$[$CellContext`i$]) $CellContext`mve$, 
           Increment[$CellContext`i$]}]; $CellContext`equilb$ = Interpolation[
           Table[{
             $CellContext`x2$[$CellContext`i$], 
             $CellContext`y2$[$CellContext`i$]}, {$CellContext`i$, 0, 
             100}]]; $CellContext`equilb2$[
           Pattern[$CellContext`m$, 
            
            Blank[]]] = $CellContext`m$ + \
($CellContext`equilb$[$CellContext`m$] - $CellContext`m$) (
            1/$CellContext`mve$); $CellContext`feed$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         If[$CellContext`q$ != 
           1, $CellContext`q$ ($CellContext`x$/($CellContext`q$ - 
             1)) - $CellContext`zf$/($CellContext`q$ - 1), 
           1000000 ($CellContext`x$ - $CellContext`zf$) + $CellContext`zf$]; \
$CellContext`xpinch$ = ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`feed$[$CellContext`x] == \
$CellContext`equilb2$[$CellContext`x], {$CellContext`x, 
              0.5}]]]; $CellContext`ypinch$ = \
$CellContext`feed$[$CellContext`xpinch$]; $CellContext`opertRect$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`ypinch$ + (($CellContext`x$ - \
$CellContext`xpinch$)/($CellContext`xd$$ - $CellContext`xpinch$)) \
($CellContext`xd$$ - $CellContext`ypinch$); $CellContext`opertStrp$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`ypinch$ + (($CellContext`x$ - \
$CellContext`xpinch$)/($CellContext`xb$$ - $CellContext`xpinch$)) \
($CellContext`xb$$ - $CellContext`ypinch$); $CellContext`Rmin$ = \
(($CellContext`xd$$ - $CellContext`ypinch$)/($CellContext`xd$$ - \
$CellContext`xpinch$))/(
          1 - ($CellContext`xd$$ - $CellContext`ypinch$)/($CellContext`xd$$ - \
$CellContext`xpinch$)); $CellContext`R$ = $CellContext`lvmult$$; \
$CellContext`OpRect$[
           Pattern[$CellContext`x$, 
            Blank[]]] := ($CellContext`R$/($CellContext`R$ + 
            1)) $CellContext`x$ + $CellContext`xd$$/($CellContext`R$ + 
           1); $CellContext`xinters$ = ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`feed$[$CellContext`x] == \
$CellContext`OpRect$[$CellContext`x], {$CellContext`x, 
              0.7}]]]; $CellContext`yinters$ = \
$CellContext`OpRect$[$CellContext`xinters$]; 
        If[$CellContext`cond$, {$CellContext`OpStrp$[
              Pattern[$CellContext`x$, 
               
               Blank[]]] := $CellContext`opertStrp$[$CellContext`x$]; \
$CellContext`yr$[0] = $CellContext`xd$$; $CellContext`xr$[
             0] = $CellContext`xd$$; $CellContext`i$ = 0; 
           While[$CellContext`i$ < 
             25, {$CellContext`v$ = ReplaceAll[$CellContext`u, 
                Quiet[
                 
                 FindRoot[$CellContext`yr$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`u], {$CellContext`u, 
                   0.5}]]], $CellContext`t$ = \
$CellContext`opertRect$[$CellContext`v$], 
              
              If[$CellContext`v$ > $CellContext`xpinch$, \
{$CellContext`xr$[$CellContext`i$ + 
                  1] = $CellContext`v$, $CellContext`yr$[$CellContext`i$ + 
                  1] = $CellContext`t$}], 
              
              Increment[$CellContext`i$]}]; $CellContext`ir$ = \
$CellContext`i$ - 1; 
           If[$CellContext`ir$ >= 
             0, {$CellContext`ys$[
                0] = $CellContext`yr$[$CellContext`ir$]; $CellContext`xs$[
                0] = $CellContext`xr$[$CellContext`ir$]}]; $CellContext`i$ = 
            0; While[$CellContext`i$ < 
             20, {$CellContext`v$ = ReplaceAll[$CellContext`u, 
                Quiet[
                 
                 FindRoot[$CellContext`ys$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`u], {$CellContext`u, 
                   0.5}]]], $CellContext`t$ = \
$CellContext`opertStrp$[$CellContext`v$], $CellContext`xs$[$CellContext`i$ + 
                1] = $CellContext`v$, $CellContext`ys$[$CellContext`i$ + 
                1] = $CellContext`t$, 
              Increment[$CellContext`i$]}]; Null}, {$CellContext`OpStrp$[
              Pattern[$CellContext`x$, 
               
               Blank[]]] := $CellContext`yinters$ + (($CellContext`x$ - \
$CellContext`xinters$)/($CellContext`xb$$ - $CellContext`xinters$)) \
($CellContext`xb$$ - $CellContext`yinters$); $CellContext`yr$[
             0] = $CellContext`xd$$; $CellContext`xr$[
             0] = $CellContext`xd$$; $CellContext`i$ = 0; 
           While[$CellContext`xr$[$CellContext`i$] > $CellContext`xinters$, \
{$CellContext`v$ = ReplaceAll[$CellContext`u, 
                Quiet[
                 
                 FindRoot[$CellContext`yr$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`u], {$CellContext`u, 
                   0.7}]]], $CellContext`t$ = \
$CellContext`OpRect$[$CellContext`v$], 
              
              If[$CellContext`v$ > $CellContext`xinters$, \
{$CellContext`xr$[$CellContext`i$ + 
                  1] = $CellContext`v$, $CellContext`yr$[$CellContext`i$ + 
                  1] = $CellContext`t$}], 
              
              Increment[$CellContext`i$]}]; $CellContext`ir$ = \
$CellContext`i$ - 1; $CellContext`i$ = 0; 
           If[$CellContext`ir$ >= 
             0, $CellContext`ys$[
               0] = $CellContext`yr$[$CellContext`ir$]; $CellContext`xs$[
               0] = $CellContext`xr$[$CellContext`ir$]]; 
           While[$CellContext`xs$[$CellContext`i$] > $CellContext`xb$$, \
{$CellContext`v$ = ReplaceAll[$CellContext`u, 
                Quiet[
                 
                 FindRoot[$CellContext`ys$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`u], {$CellContext`u, 
                   0.5}]]], $CellContext`t$ = \
$CellContext`OpStrp$[$CellContext`v$], $CellContext`xs$[$CellContext`i$ + 
                1] = $CellContext`v$, $CellContext`ys$[$CellContext`i$ + 
                1] = $CellContext`t$, 
              Increment[$CellContext`i$]}]; 
           Null}]; $CellContext`imax$ = $CellContext`i$ - 
          1; $CellContext`tbl1$ = Table[
           Line[{{
              $CellContext`xr$[$CellContext`i$], 
              $CellContext`yr$[$CellContext`i$ - 1]}, {
              $CellContext`xr$[$CellContext`i$], 
              $CellContext`yr$[$CellContext`i$]}}], {$CellContext`i$, 
            1, $CellContext`ir$}]; $CellContext`tbl2$ = 
         If[$CellContext`ir$ >= 1, 
           Table[
            Line[{{
               $CellContext`xr$[$CellContext`i$], 
               $CellContext`yr$[$CellContext`i$]}, {
               $CellContext`xr$[$CellContext`i$ + 1], 
               $CellContext`yr$[$CellContext`i$]}}], {$CellContext`i$, 
             0, $CellContext`ir$ - 1}], 
           Table[
            Line[{{
               $CellContext`xr$[$CellContext`i$], 
               $CellContext`yr$[$CellContext`i$]}, {
               $CellContext`xr$[$CellContext`i$ + 1], 
               $CellContext`yr$[$CellContext`i$]}}], {$CellContext`i$, 0, 
             0}]]; $CellContext`tbl3$ = Table[
           Line[{{
              $CellContext`xs$[$CellContext`i$ + 1], 
              $CellContext`ys$[$CellContext`i$]}, {
              $CellContext`xs$[$CellContext`i$ + 1], 
              $CellContext`ys$[$CellContext`i$ + 1]}}], {$CellContext`i$, 
            0, $CellContext`imax$ - 1}]; $CellContext`tbl4$ = Table[
           Line[{{
              $CellContext`xs$[$CellContext`i$ - 1], 
              $CellContext`ys$[$CellContext`i$ - 1]}, {
              $CellContext`xs$[$CellContext`i$], 
              $CellContext`ys$[$CellContext`i$ - 1]}}], {$CellContext`i$, 
            1, $CellContext`imax$ + 1}]; $CellContext`tblih$ = Line[{{
             $CellContext`xs$[1], 
             $CellContext`ys$[0]}, {
             $CellContext`xr$[$CellContext`ir$], 
             $CellContext`ys$[0]}}]; $CellContext`tbliv$ = Line[{{
             $CellContext`xs$[1], 
             $CellContext`ys$[0]}, {
             $CellContext`xs$[1], 
             $CellContext`ys$[
             1]}}]; $CellContext`it$ = $CellContext`imax$ + $CellContext`ir$ + 
          1; $CellContext`distflow$ = ($CellContext`zf$ - \
$CellContext`xs$[$CellContext`imax$ + 
            1])/$CellContext`xd$$; $CellContext`botflow$ = 
         1 - $CellContext`distflow$; $CellContext`xybase$ = Show[
           Plot[{
             $CellContext`equilb2$[$CellContext`x], $CellContext`x}, \
{$CellContext`x, 0, 1}, PlotStyle -> {{Thick, Red}, {Thick, 
               RGBColor[0, 0.6, 0]}}, PlotRange -> {{0, 1}, {0, 1}}], 
           If[$CellContext`cond$, {
             Plot[
              $CellContext`feed$[$CellContext`x], {$CellContext`x, \
$CellContext`xpinch$, $CellContext`zf$}, PlotStyle -> {Thick, Blue}], 
             Plot[
              $CellContext`opertRect$[$CellContext`x], {$CellContext`x, \
$CellContext`xpinch$, $CellContext`xd$$}, PlotStyle -> {Thick, 
                RGBColor[0, 0.85, 1]}], 
             Plot[
              $CellContext`opertStrp$[$CellContext`x], {$CellContext`x, \
$CellContext`xb$$, $CellContext`xpinch$}, PlotStyle -> {Thick, Magenta}]}, {
             Plot[
              $CellContext`feed$[$CellContext`x], {$CellContext`x, \
$CellContext`xinters$, $CellContext`zf$}, PlotStyle -> {Thick, Blue}], 
             Plot[
              $CellContext`OpRect$[$CellContext`x], {$CellContext`x, \
$CellContext`xinters$, $CellContext`xd$$}, PlotStyle -> {Thick, 
                RGBColor[0, 0.85, 1]}], 
             Plot[
              $CellContext`OpStrp$[$CellContext`x], {$CellContext`x, \
$CellContext`xb$$, $CellContext`xinters$}, PlotStyle -> {Thick, Magenta}]}], 
           
           Graphics[{
            Thick, $CellContext`tbl1$, $CellContext`tbl2$, \
$CellContext`tblih$, $CellContext`tbliv$}], Frame -> True, FrameLabel -> {
             Row[{"liquid mole fraction ", 
               Subscript[
                Style["x", Italic], "met"]}], 
             Row[{"vapor mole fraction ", 
               Subscript[
                Style["y", Italic], "met"]}]}, LabelStyle -> {17, Black}, 
           AspectRatio -> Full, PlotRangePadding -> None, 
           ImagePadding -> {{55, 10}, {50, 10}}]; $CellContext`mouse$ = 
         Graphics[{
            Apply[Mouseover[{
               Thickness[0.015], Transparent, 
               Line[
                Table[#, 
                 Evaluate[
                  Flatten[{$CellContext`x, #2, 0.05}]]]]}, 
              Text[
               Style[#3, 18, #4, Background -> White], 
               
               Dynamic[$CellContext`pt$$], #5]]& , {{{$CellContext`x, \
$CellContext`x}, {0, 1}, 
               Row[{
                 Style["x", Italic], " = ", 
                 Style["y", Italic], " line"}], 
               RGBColor[0, 0.6, 0], {-1, -1}}, {{$CellContext`x, 
                $CellContext`equilb2$[$CellContext`x]}, {0, 1}, 
               "equilibrium curve", Red, {1, -1}}, {{$CellContext`x, 
                $CellContext`feed$[$CellContext`x]}, {
                
                If[$CellContext`cond$, $CellContext`xpinch$, \
$CellContext`xinters$], $CellContext`zf$}, 
               Row[{
                 Style["q", Italic], "-line"}], 
               Blue, {-1, -1}}, {{$CellContext`x, 
                If[$CellContext`cond$, 
                 $CellContext`opertRect$[$CellContext`x], 
                 $CellContext`OpRect$[$CellContext`x]]}, {
                
                If[$CellContext`cond$, $CellContext`xpinch$, \
$CellContext`xinters$], $CellContext`xd$$}, "rectifying section", 
               RGBColor[0, 0.85, 1], {-1, -1}}, {{$CellContext`x, 
                If[$CellContext`cond$, 
                 $CellContext`opertStrp$[$CellContext`x], 
                 $CellContext`OpStrp$[$CellContext`x]]}, {$CellContext`xb$$, 
                
                If[$CellContext`cond$, $CellContext`xpinch$, \
$CellContext`xinters$]}, "stripping section", Magenta, {1, -1}}}, {1}], 
            Mouseover[{
              Thickness[0.015], 
              Transparent, $CellContext`tbl1$, $CellContext`tbl2$, \
$CellContext`tblih$, $CellContext`tbliv$}, 
             Text[
              Style["stages", 18, Background -> White], 
              Dynamic[$CellContext`pt$$], {-1, -1}]]}]; 
        Show[$CellContext`xybase$, $CellContext`mouse$, 
          ImageSize -> {600, 375}]], 
      "Specifications" :> {{{$CellContext`lvmult$$, 3, 
          
          Row[{"external reflux ratio ", Style["D", Italic]^(-1) 
            Style["L", Italic]}]}, 0.25, 10, 0.25, Appearance -> "Labeled", 
         ControlPlacement -> 1}, {{$CellContext`xd$$, 0.85, 
          Row[{"distillate ", 
            Subscript[
             Style["x", Italic], "d"]}]}, 0.8, 0.98, 0.01, Appearance -> 
         "Labeled", ImageSize -> Small, ControlPlacement -> 
         2}, {{$CellContext`xb$$, 0.15, 
          Row[{"bottoms ", 
            Subscript[
             Style["x", Italic], "b"]}]}, 0.05, 0.2, 0.01, Appearance -> 
         "Labeled", ImageSize -> Small, ControlPlacement -> 
         3}, {{$CellContext`pt$$, {0, 0}}, Automatic, ControlType -> Locator, 
         Appearance -> None, AutoAction -> True, ControlPlacement -> 4}, 
        Grid[{{
           Manipulate`Place[1], SpanFromLeft}, {
           Style["mole fractions:", Bold], 
           Manipulate`Place[2], 
           Manipulate`Place[3], 
           Manipulate`Place[4]}}, Alignment -> Left]}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{657., {247., 254.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.6812309660633135`*^9, 3.6812311101830096`*^9, 3.681231215547418*^9, {
   3.681231265451311*^9, 3.681231306188388*^9}, 3.681231383269546*^9}]
}, Open  ]]
},
WindowSize->{1366, 686},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (April 11, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 36911, 916, 2172, "Input"],
Cell[37494, 940, 19169, 390, 518, "Output"]
}, Open  ]]
}
]
*)

