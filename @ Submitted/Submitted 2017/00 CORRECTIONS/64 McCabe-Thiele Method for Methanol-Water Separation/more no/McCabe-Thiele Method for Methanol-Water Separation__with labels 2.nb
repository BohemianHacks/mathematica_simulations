(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    117743,       2805]
NotebookOptionsPosition[    113464,       2675]
NotebookOutlinePosition[    115074,       2725]
CellTagsIndexPosition[    114738,       2713]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["McCabe-Thiele Method for Methanol/Water Separation", "DemoTitle",
 CellChangeTimes->{3.679173601030182*^9}],

Cell["", "InitializationSection"],

Cell[CellGroupData[{

Cell["", "ManipulateSection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "cond", ",", "zf", ",", "q", ",", "mve", ",", "P", ",", "VPMet", ",", 
       "VPWat", ",", "A12", ",", "A21", ",", "\[Gamma]1", ",", "\[Gamma]2", 
       ",", "i", ",", "x2", ",", "T", ",", "y2", ",", "equilb", ",", 
       "equilb2", ",", "feed", ",", "xpinch", ",", "ypinch", ",", "opertRect",
        ",", "opertStrp", ",", "Rmin", ",", "R", ",", "OpRect", ",", 
       "xinters", ",", "yinters", ",", "OpStrp", ",", "yr", ",", "xr", ",", 
       "v", ",", "t", ",", "ir", ",", "ys", ",", "xs", ",", "imax", ",", 
       "tbl1", ",", "tbl2", ",", "tbl3", ",", "tbl4", ",", "tblih", ",", 
       "tbliv", ",", "it", ",", "distflow", ",", "botflow", ",", "xybase", 
       ",", "xyadd", ",", "plot", ",", "diagram", ",", "mouse"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cond", "=", 
       RowBox[{"yinters", "\[GreaterEqual]", 
        RowBox[{"equilb", "[", "xinters", "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"zf", "=", "0.5"}], ";", 
      RowBox[{"q", "=", "0.5"}], ";", 
      RowBox[{"mve", "=", "1"}], ";", 
      RowBox[{"P", "=", "760"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"VPMet", "[", "T_", "]"}], ":=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"8.08097", "-", 
          FractionBox["1582.271", 
           RowBox[{"239.726", "+", "T"}]]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"VPWat", "[", "T_", "]"}], ":=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"8.07131", "-", 
          FractionBox["1730.63", 
           RowBox[{"233.426", "+", "T"}]]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"A12", "=", "0.5434"}], ";", 
      RowBox[{"A21", "=", "0.7923"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Gamma]1", "[", "i_", "]"}], ":=", 
       RowBox[{"Exp", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"x2", "[", "i", "]"}], "2"], "*", 
         RowBox[{"(", 
          RowBox[{"A12", "+", 
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"A21", "-", "A12"}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"x2", "[", "i", "]"}]}], ")"}]}]}], ")"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Gamma]2", "[", "i_", "]"}], ":=", 
       RowBox[{"Exp", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"x2", "[", "i", "]"}]}], ")"}], "2"], "*", 
         RowBox[{"(", 
          RowBox[{"A21", "+", 
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"A12", "-", "A21"}], ")"}], "*", 
            RowBox[{"x2", "[", "i", "]"}]}]}], ")"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Iteration", " ", "to", " ", "creat", " ", "curve"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"i", "<", "101"}], ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"x2", "[", "i", "]"}], "=", 
           RowBox[{"i", "*", "0.01"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"T", "[", "i", "]"}], "=", 
           RowBox[{"T", "/.", 
            RowBox[{"Quiet", "@", 
             RowBox[{"FindRoot", "[", 
              RowBox[{
               RowBox[{"P", "\[Equal]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"VPWat", "[", "T", "]"}], "*", 
                  RowBox[{"\[Gamma]1", "[", "i", "]"}], "*", 
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{"x2", "[", "i", "]"}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"VPMet", "[", "T", "]"}], "*", 
                  RowBox[{"\[Gamma]2", "[", "i", "]"}], "*", 
                  RowBox[{"x2", "[", "i", "]"}]}]}]}], ",", 
               RowBox[{"{", 
                RowBox[{"T", ",", "60"}], "}"}], ",", 
               RowBox[{"AccuracyGoal", "\[Rule]", " ", "5"}]}], "]"}]}]}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"y2", "[", "i", "]"}], "=", 
           RowBox[{
            RowBox[{"x2", "[", "i", "]"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"VPMet", "[", 
                  RowBox[{"T", "[", "i", "]"}], "]"}], "*", " ", 
                 RowBox[{"\[Gamma]2", "[", "i", "]"}], "*", " ", 
                 RowBox[{
                  RowBox[{"x2", "[", "i", "]"}], "/", "P"}]}], ")"}], "-", 
               RowBox[{"x2", "[", "i", "]"}]}], ")"}], "*", "mve"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"i", "++"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"equilb", "=", 
       RowBox[{"Interpolation", "@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x2", "[", "i", "]"}], ",", 
            RowBox[{"y2", "[", "i", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "100"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Extra", " ", "equation", " ", "to", " ", "incorporate", " ", 
        "murphree", " ", "vapor", " ", "efficiency", " ", "if", " ", 
        "desired"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"equilb2", "[", "m_", "]"}], ":=", 
       RowBox[{"m", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"equilb", "[", "m", "]"}], "-", "m"}], ")"}], "*", 
         FractionBox["1", "mve"]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Feed", " ", "line"}], ",", " ", 
        RowBox[{"operating", " ", "lines"}], ",", " ", 
        RowBox[{
        "and", " ", "mass", " ", "balances", " ", "get", " ", "calculated", 
         " ", "here"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"feed", "[", "x_", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"q", "\[NotEqual]", "1"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q", " ", 
            RowBox[{"x", "/", 
             RowBox[{"(", 
              RowBox[{"q", "-", "1"}], ")"}]}]}], "-", 
           RowBox[{"zf", "/", 
            RowBox[{"(", 
             RowBox[{"q", "-", "1"}], ")"}]}]}], ")"}], ",", 
         RowBox[{
          RowBox[{"1000000", "*", 
           RowBox[{"(", 
            RowBox[{"x", "-", "zf"}], ")"}]}], "+", "zf"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"xpinch", "=", 
       RowBox[{"x", "/.", 
        RowBox[{"Quiet", "@", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"feed", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"equilb2", "[", "x", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0.5"}], "}"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ypinch", "=", 
       RowBox[{"feed", "[", "xpinch", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"opertRect", "[", "x_", "]"}], ":=", 
       RowBox[{"ypinch", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x", "-", "xpinch"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"xd", "-", "xpinch"}], ")"}]}], "*", 
         RowBox[{"(", 
          RowBox[{"xd", "-", "ypinch"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"opertStrp", "[", "x_", "]"}], ":=", 
       RowBox[{"ypinch", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x", "-", "xpinch"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"xb", "-", "xpinch"}], ")"}]}], "*", 
         RowBox[{"(", 
          RowBox[{"xb", "-", "ypinch"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Rmin", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"xd", "-", "ypinch"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"xd", "-", "xpinch"}], ")"}]}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"xd", "-", "ypinch"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"xd", "-", "xpinch"}], ")"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"R", "=", "lvmult"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"OpRect", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"R", "/", 
          RowBox[{"(", 
           RowBox[{"R", "+", "1"}], ")"}]}], "*", "x"}], "+", 
        RowBox[{"xd", "/", 
         RowBox[{"(", 
          RowBox[{"R", "+", "1"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xinters", "=", 
       RowBox[{"x", "/.", 
        RowBox[{"Quiet", "@", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"feed", "[", "x", "]"}], "\[Equal]", 
            RowBox[{"OpRect", "[", "x", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0.7"}], "}"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"yinters", "=", 
       RowBox[{"OpRect", "[", "xinters", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"cond", ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"OpStrp", "[", "x_", "]"}], ":=", 
           RowBox[{"opertStrp", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"yr", "[", "0", "]"}], "=", "xd"}], ";", 
          RowBox[{
           RowBox[{"xr", "[", "0", "]"}], "=", "xd"}], ";", 
          RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"i", "<", "25"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"v", "=", 
               RowBox[{"u", "/.", 
                RowBox[{"Quiet", "[", 
                 RowBox[{"FindRoot", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"yr", "[", "i", "]"}], "\[Equal]", 
                    RowBox[{"equilb", "[", "u", "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"u", ",", "0.5"}], "}"}]}], "]"}], "]"}]}]}], ",", 
              RowBox[{"t", "=", 
               RowBox[{"opertRect", "[", "v", "]"}]}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"v", ">", "xpinch"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"xr", "[", 
                    RowBox[{"i", "+", "1"}], "]"}], "=", "v"}], ",", 
                  RowBox[{
                   RowBox[{"yr", "[", 
                    RowBox[{"i", "+", "1"}], "]"}], "=", "t"}]}], "}"}]}], 
               "]"}], ",", 
              RowBox[{"i", "++"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ir", "=", 
           RowBox[{"i", "-", "1"}]}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ir", "\[GreaterEqual]", " ", "0"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"ys", "[", "0", "]"}], "=", 
               RowBox[{"yr", "[", "ir", "]"}]}], ";", 
              RowBox[{
               RowBox[{"xs", "[", "0", "]"}], "=", 
               RowBox[{"xr", "[", "ir", "]"}]}]}], "}"}]}], "]"}], ";", 
          RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"i", "<", "20"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"v", "=", 
               RowBox[{"u", "/.", 
                RowBox[{"Quiet", "@", 
                 RowBox[{"FindRoot", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ys", "[", "i", "]"}], "\[Equal]", 
                    RowBox[{"equilb", "[", "u", "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"u", ",", "0.5"}], "}"}]}], "]"}]}]}]}], ",", 
              RowBox[{"t", "=", 
               RowBox[{"opertStrp", "[", "v", "]"}]}], ",", 
              RowBox[{
               RowBox[{"xs", "[", 
                RowBox[{"i", "+", "1"}], "]"}], "=", "v"}], ",", 
              RowBox[{
               RowBox[{"ys", "[", 
                RowBox[{"i", "+", "1"}], "]"}], "=", "t"}], ",", 
              RowBox[{"i", "++"}]}], "}"}]}], "]"}], ";"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"OpStrp", "[", "x_", "]"}], ":=", 
           RowBox[{"yinters", "+", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x", "-", "xinters"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"xb", "-", "xinters"}], ")"}]}], "*", 
             RowBox[{"(", 
              RowBox[{"xb", "-", "yinters"}], ")"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"yr", "[", "0", "]"}], "=", "xd"}], ";", 
          RowBox[{
           RowBox[{"xr", "[", "0", "]"}], "=", "xd"}], ";", 
          RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"xr", "[", "i", "]"}], ">", "xinters"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"v", "=", 
               RowBox[{"u", "/.", 
                RowBox[{"Quiet", "@", 
                 RowBox[{"FindRoot", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"yr", "[", "i", "]"}], "\[Equal]", 
                    RowBox[{"equilb", "[", "u", "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"u", ",", "0.7"}], "}"}]}], "]"}]}]}]}], ",", 
              RowBox[{"t", "=", 
               RowBox[{"OpRect", "[", "v", "]"}]}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"v", ">", "xinters"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"xr", "[", 
                    RowBox[{"i", "+", "1"}], "]"}], "=", "v"}], ",", 
                  RowBox[{
                   RowBox[{"yr", "[", 
                    RowBox[{"i", "+", "1"}], "]"}], "=", "t"}]}], "}"}]}], 
               "]"}], ",", 
              RowBox[{"i", "++"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ir", "=", 
           RowBox[{"i", "-", "1"}]}], ";", 
          RowBox[{"i", "=", "0"}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ir", "\[GreaterEqual]", "0"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"ys", "[", "0", "]"}], "=", 
              RowBox[{"yr", "[", "ir", "]"}]}], ";", 
             RowBox[{
              RowBox[{"xs", "[", "0", "]"}], "=", 
              RowBox[{"xr", "[", "ir", "]"}]}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"xs", "[", "i", "]"}], ">", "xb"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"v", "=", 
               RowBox[{"u", "/.", 
                RowBox[{"Quiet", "@", 
                 RowBox[{"FindRoot", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ys", "[", "i", "]"}], "\[Equal]", 
                    RowBox[{"equilb", "[", "u", "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"u", ",", "0.5"}], "}"}]}], "]"}]}]}]}], ",", 
              RowBox[{"t", "=", 
               RowBox[{"OpStrp", "[", "v", "]"}]}], ",", 
              RowBox[{
               RowBox[{"xs", "[", 
                RowBox[{"i", "+", "1"}], "]"}], "=", "v"}], ",", 
              RowBox[{
               RowBox[{"ys", "[", 
                RowBox[{"i", "+", "1"}], "]"}], "=", "t"}], ",", 
              RowBox[{"i", "++"}]}], "}"}]}], "]"}], ";"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"imax", "=", 
       RowBox[{"i", "-", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tbl1", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xr", "[", "i", "]"}], ",", 
              RowBox[{"yr", "[", 
               RowBox[{"i", "-", "1"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xr", "[", "i", "]"}], ",", 
              RowBox[{"yr", "[", "i", "]"}]}], "}"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "ir"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tbl2", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ir", "\[GreaterEqual]", " ", "1"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xr", "[", "i", "]"}], ",", 
                RowBox[{"yr", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xr", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], ",", 
                RowBox[{"yr", "[", "i", "]"}]}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", 
             RowBox[{"ir", "-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xr", "[", "i", "]"}], ",", 
                RowBox[{"yr", "[", "i", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xr", "[", 
                 RowBox[{"i", "+", "1"}], "]"}], ",", 
                RowBox[{"yr", "[", "i", "]"}]}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "0"}], "}"}]}], "]"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"tbl3", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xs", "[", 
               RowBox[{"i", "+", "1"}], "]"}], ",", 
              RowBox[{"ys", "[", "i", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xs", "[", 
               RowBox[{"i", "+", "1"}], "]"}], ",", 
              RowBox[{"ys", "[", 
               RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"imax", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tbl4", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xs", "[", 
               RowBox[{"i", "-", "1"}], "]"}], ",", 
              RowBox[{"ys", "[", 
               RowBox[{"i", "-", "1"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xs", "[", "i", "]"}], ",", 
              RowBox[{"ys", "[", 
               RowBox[{"i", "-", "1"}], "]"}]}], "}"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"imax", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tblih", "=", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xs", "[", "1", "]"}], ",", 
            RowBox[{"ys", "[", "0", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xr", "[", "ir", "]"}], ",", 
            RowBox[{"ys", "[", "0", "]"}]}], "}"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tbliv", "=", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xs", "[", "1", "]"}], ",", 
            RowBox[{"ys", "[", "0", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xs", "[", "1", "]"}], ",", 
            RowBox[{"ys", "[", "1", "]"}]}], "}"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"it", "=", 
       RowBox[{"imax", "+", "ir", "+", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"distflow", "=", 
       FractionBox[
        RowBox[{"zf", "-", 
         RowBox[{"xs", "[", 
          RowBox[{"imax", "+", "1"}], "]"}]}], "xd"]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"botflow", "=", 
       RowBox[{"1", "-", "distflow"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"xybase", "=", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"equilb2", "[", "x", "]"}], ",", "x"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Thick", ",", "Red"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Thick", ",", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{"0", ",", "0.6", ",", "0"}], "]"}]}], "}"}]}], 
             "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"cond", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"feed", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "xpinch", ",", "zf"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", "Blue"}], "}"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"opertRect", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "xpinch", ",", "xd"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", 
                  RowBox[{"RGBColor", "[", 
                   RowBox[{"0", ",", "0.65", ",", "1"}], "]"}]}], "}"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"opertStrp", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "xb", ",", "xpinch"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", "Magenta"}], "}"}]}]}], "]"}]}], "}"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"feed", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "xinters", ",", "zf"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", "Blue"}], "}"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"OpRect", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "xinters", ",", "xd"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", 
                  RowBox[{"RGBColor", "[", 
                   RowBox[{"0", ",", "0.65", ",", "1"}], "]"}]}], "}"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"OpStrp", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "xb", ",", "xinters"}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", "Magenta"}], "}"}]}]}], "]"}]}], 
            "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Graphics", "@", 
          RowBox[{"{", 
           RowBox[{
           "Thick", ",", "tbl1", ",", "tbl2", ",", "tblih", ",", "tbliv"}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{"\"\<liquid mole fraction \>\"", ",", 
               RowBox[{"Subscript", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                 "\"\<met\>\""}], "]"}]}], "}"}]}], ",", 
            RowBox[{"Row", "@", 
             RowBox[{"{", 
              RowBox[{"\"\<vapor mole fraction \>\"", ",", 
               RowBox[{"Subscript", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
                 "\"\<met\>\""}], "]"}]}], "}"}]}]}], "}"}]}], ",", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"17", ",", "Black"}], "}"}]}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
         RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"55", ",", "10"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"xyadd", "=", 
       RowBox[{"Graphics", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Thick", ",", "tbl3", ",", "tbl4"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"ir", "+", "1", "+", "imax", "-", "f"}], ",", "17"}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xr", "[", "f", "]"}], ",", 
                RowBox[{"yr", "[", 
                 RowBox[{"f", "-", "1"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"f", ",", "1", ",", "ir"}], "}"}]}], "]"}], ",", 
          RowBox[{"(*", 
           RowBox[{"R", " ", "stage"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"imax", "+", "1", "-", "f"}], ",", "17"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xs", "[", "f", "]"}], ",", 
                RowBox[{"ys", "[", 
                 RowBox[{"f", "-", "1"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"f", ",", "1", ",", "imax"}], "}"}]}], "]"}], ",", 
          RowBox[{"(*", 
           RowBox[{"S", " ", "stage"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Dashed", ",", "\[IndentingNewLine]", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xs", "[", 
                  RowBox[{"imax", "+", "1"}], "]"}], ",", 
                 RowBox[{"ys", "[", "imax", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xs", "[", 
                  RowBox[{"imax", "+", "1"}], "]"}], ",", "0"}], "}"}]}], 
              "}"}], "]"}], ",", 
            RowBox[{"(*", "bottoms", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xr", "[", "0", "]"}], ",", 
                 RowBox[{"yr", "[", "0", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xr", "[", "0", "]"}], ",", "0"}], "}"}]}], "}"}], 
             "]"}], ",", 
            RowBox[{"(*", "distill", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0.5", ",", "0.5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.5", ",", "0"}], "}"}]}], "}"}], "]"}]}], 
           RowBox[{"(*", "feed", "*)"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"Row", "@", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", "#1"}], 
                    "]"}], ",", "\"\< = \>\"", ",", 
                   RowBox[{"SetPrecision", "[", 
                    RowBox[{"#2", ",", "2"}], "]"}]}], "}"}]}], ",", "17", 
                ",", 
                RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"#2", ",", "0.05"}], "}"}], ",", 
              RowBox[{"1.1", "*", 
               RowBox[{"{", 
                RowBox[{"#3", ",", "0"}], "}"}]}]}], "]"}], "&"}], "@@@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<b\>\"", ",", 
               RowBox[{"(*", "xb", "*)"}], 
               RowBox[{"xs", "[", 
                RowBox[{"imax", "+", "1"}], "]"}], ",", 
               RowBox[{"-", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<d\>\"", ",", 
               RowBox[{"xr", "[", "0", "]"}], ",", "1"}], "}"}]}], "}"}]}], 
          ",", 
          RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<R\>\"", ",", "17", ",", "Italic", ",", 
              RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xs", "[", 
               RowBox[{"imax", "+", "1"}], "]"}], ",", 
              RowBox[{"ys", "[", "imax", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Subscript", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<z\>\"", ",", "Italic"}], "]"}], ",", 
                   "\"\<f\>\""}], "]"}], ",", "\"\< = 0.5\>\""}], "}"}]}], 
              ",", "17", ",", 
              RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "0.15"}], "}"}]}], "]"}]}], 
         RowBox[{"(*", "feed", "*)"}], "\[IndentingNewLine]", "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"plot", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"yinters", "<", 
          RowBox[{"equilb", "[", "xinters", "]"}]}], ",", 
         RowBox[{"Show", "[", 
          RowBox[{"xybase", ",", "xyadd"}], "]"}], ",", "xybase"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"diagram", "=", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"EdgeForm", "@", "Thick"}], ",", 
             RowBox[{"FaceForm", "@", "None"}], ",", 
             RowBox[{"Rectangle", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "3"}], "}"}]}], "]"}], ",", 
             RowBox[{"Disk", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0.75", ",", 
                 RowBox[{"-", "0.5"}]}], "}"}], ",", 
               RowBox[{"1.1", "*", 
                RowBox[{"{", 
                 RowBox[{"0.25", ",", "0.15"}], "}"}]}]}], "]"}], ",", 
             RowBox[{"Disk", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1.75", ",", "2.8"}], "}"}], ",", 
               RowBox[{"1.1", "*", 
                RowBox[{"{", 
                 RowBox[{"0.25", ",", "0.15"}], "}"}]}]}], "]"}]}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", 
             RowBox[{"Arrowheads", "@", "0.06"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0.5", ",", 
                  RowBox[{"-", "0.5"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0.25", ",", 
                  RowBox[{"-", "0.5"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0.25", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0.75", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0.75", ",", 
                  RowBox[{"-", "0.32"}]}], "}"}]}], "}"}], "]"}], ",", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1.05", ",", 
                  RowBox[{"-", "0.5"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", 
                  RowBox[{"-", "0.5"}]}], "}"}]}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0.25", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0.25", ",", "3.4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1.75", ",", "3.4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1.75", ",", "2.95"}], "}"}]}], "}"}], "]"}], ",", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1.5", ",", "2.8"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2.8"}], "}"}]}], "}"}], "]"}], ",", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"2.05", ",", "2.8"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"3", ",", "2.8"}], "}"}]}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"yinters", "<", 
                RowBox[{"equilb", "[", "xinters", "]"}]}], ",", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Arrow", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1.5"}], ",", 
                    FractionBox[
                    RowBox[{"3", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "imax"}], "+", "1"}], ")"}]}], 
                    RowBox[{"2", "*", "it"}]]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    FractionBox[
                    RowBox[{"3", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "imax"}], "+", "1"}], ")"}]}], 
                    RowBox[{"2", "*", "it"}]]}], "}"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<stage \>\"", ",", "#"}], "}"}]}], ",", 
                    "17"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", 
                    RowBox[{"3", "*", 
                    RowBox[{"#", "/", "it"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1.1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"3", "*", 
                    RowBox[{"#", "/", "it"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"3", "*", 
                    RowBox[{"#", "/", "it"}]}]}], "}"}]}], "}"}], "]"}]}], 
                    "}"}], "&"}], "/@", 
                  RowBox[{"Range", "@", 
                   RowBox[{"(", 
                    RowBox[{"it", "-", "1"}], ")"}]}]}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Arrow", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1.5"}], ",", "1.5"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1.5"}], "}"}]}], "}"}], "]"}]}], 
              "\[IndentingNewLine]", "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"#", ",", "17", ",", "Italic"}], "]"}], ",", "#2"}], 
              "]"}], "&"}], "@@@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<R\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"0.75", ",", 
                  RowBox[{"-", "0.5"}]}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<C\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"1.75", ",", "2.8"}], "}"}]}], "}"}]}], "}"}]}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Column", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<feed rate\>\"", ",", "\"\<1 kmol/h\>\"", ",", 
                   RowBox[{"Spacer", "@", "1"}], ",", 
                   RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<z\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<f\>\""}], "]"}], ",", "\"\< = 0.5\>\""}], "}"}]}], 
                   ",", "\"\<quality = 0.5\>\"", ",", "\"\<VLE\>\""}], "}"}], 
                 ",", "Center"}], "]"}], ",", "17"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.85"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"yinters", "<", 
                  RowBox[{"equilb", "[", "xinters", "]"}]}], ",", 
                 FractionBox[
                  RowBox[{"3", "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "imax"}], "+", "1"}], ")"}]}], 
                  RowBox[{"2", "*", "it"}]], ",", "1.5"}], "]"}]}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.2"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Column", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<reflux ratio\>\"", ",", 
                   RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<L\>\"", ",", "Italic"}], "]"}], "/", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<D\>\"", ",", "Italic"}], "]"}]}], ",", 
                    "\"\< = \>\"", ",", 
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{"R", ",", "3"}], "]"}]}], "}"}]}]}], "}"}], ",", 
                 "Center"}], "]"}], ",", "17"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"1.85", ",", "2.15"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Column", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<distillate flow\>\"", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"yinters", "<", 
                    RowBox[{"equilb", "[", "xinters", "]"}]}], ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{"distflow", ",", "2"}], "]"}], ",", 
                    "\"\< kmol/h\>\""}], "}"}]}], ",", "\"\<N/A\>\""}], 
                    "]"}]}], "}"}], ",", "Center"}], "]"}], ",", "17"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"2.8", ",", "3.1"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Column", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<bottoms flow\>\"", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"yinters", "<", 
                    RowBox[{"equilb", "[", "xinters", "]"}]}], ",", 
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{"botflow", ",", "2"}], "]"}], ",", 
                    "\"\< kmol/h\>\""}], "}"}]}], ",", "\"\<N/A\>\""}], 
                    "]"}]}], "}"}], ",", "Center"}], "]"}], ",", "17"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"2.8", ",", 
               RowBox[{"-", "0.5"}]}], "}"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"290", ",", "375"}], "}"}]}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", "Full"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"mouse", "=", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Mouseover", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Thickness", "@", "0.015"}], ",", "Transparent", ",", 
                RowBox[{"Line", "@", 
                 RowBox[{"Table", "[", 
                  RowBox[{"#1", ",", 
                   RowBox[{"Evaluate", "@", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "#2", ",", "0.05"}], "}"}]}]}]}], 
                  "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"#3", ",", "18", ",", "#4", ",", 
                  RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                RowBox[{"Dynamic", "@", "pt"}], ",", "#5"}], "]"}]}], "]"}], 
            "&"}], "@@@", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "x"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], ",", 
               RowBox[{"Row", "@", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                  "\"\< = \>\"", ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
                  "\"\< line\>\""}], "}"}]}], ",", 
               RowBox[{"RGBColor", "[", 
                RowBox[{"0", ",", "0.6", ",", "0"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"equilb2", "[", "x", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], ",", 
               "\"\<equilibrium curve\>\"", ",", "Red", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"feed", "[", "x", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{"cond", ",", "xpinch", ",", "xinters"}], "]"}], ",",
                  "zf"}], "}"}], ",", 
               RowBox[{"Row", "@", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<q\>\"", ",", "Italic"}], "]"}], ",", 
                  "\"\<-line\>\""}], "}"}]}], ",", "Blue", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{"cond", ",", 
                   RowBox[{"opertRect", "[", "x", "]"}], ",", 
                   RowBox[{"OpRect", "[", "x", "]"}]}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{"cond", ",", "xpinch", ",", "xinters"}], "]"}], ",",
                  "xd"}], "}"}], ",", "\"\<rectifying section\>\"", ",", 
               RowBox[{"RGBColor", "[", 
                RowBox[{"0", ",", "0.65", ",", "1"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{"cond", ",", 
                   RowBox[{"opertStrp", "[", "x", "]"}], ",", 
                   RowBox[{"OpStrp", "[", "x", "]"}]}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"xb", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{"cond", ",", "xpinch", ",", "xinters"}], "]"}]}], 
                "}"}], ",", "\"\<stripping section\>\"", ",", "Magenta", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], 
            "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Mouseover", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Thickness", "@", "0.015"}], ",", "Transparent", ",", 
              "tbl1", ",", "tbl2", ",", "tblih", ",", "tbliv"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<equilibrium stages\>\"", ",", "18", ",", 
                RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
              RowBox[{"Dynamic", "@", "pt"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Mouseover", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Thickness", "@", "0.015"}], ",", "Transparent", ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"xs", "[", 
                    RowBox[{"imax", "+", "1"}], "]"}], ",", 
                   RowBox[{"ys", "[", "imax", "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"xs", "[", 
                    RowBox[{"imax", "+", "1"}], "]"}], ",", "0"}], "}"}]}], 
                "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<bottoms\>\"", ",", "18", ",", 
                RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
              RowBox[{"Dynamic", "@", "pt"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"(*", "bottoms", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Mouseover", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Thickness", "@", "0.015"}], ",", "Transparent", ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"xr", "[", "0", "]"}], ",", 
                   RowBox[{"yr", "[", "0", "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"xr", "[", "0", "]"}], ",", "0"}], "}"}]}], "}"}], 
               "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<distillate\>\"", ",", "18", ",", 
                RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
              RowBox[{"Dynamic", "@", "pt"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"(*", "distill", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Mouseover", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Thickness", "@", "0.015"}], ",", "Transparent", ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0.5", ",", "0.5"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0.5", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<feed\>\"", ",", "18", ",", 
                RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
              RowBox[{"Dynamic", "@", "pt"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], 
         RowBox[{"(*", "feed", "*)"}], "\[IndentingNewLine]", "}"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{"window", ",", "True", ",", 
        RowBox[{"Grid", "@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Text", "@", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"yinters", "<", 
                   RowBox[{"equilb", "[", "xinters", "]"}]}], ",", 
                  RowBox[{"Row", "@", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<equilibrium stages needed = \>\"", ",", "it", ",", 
                    " ", "\"\< (including reboiler)\>\""}], "}"}]}], ",", 
                  "\"\<equilibrium stages needed = infinite (pinch \
point)\>\""}], "]"}], ",", "17"}], "]"}]}], ",", "SpanFromLeft"}], "}"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Show", "[", 
              RowBox[{"plot", ",", 
               RowBox[{"ImageSize", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"310", ",", "375"}], "}"}]}]}], "]"}], ",", 
             "diagram"}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
        "False", ",", 
        RowBox[{"Grid", "@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Text", "@", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"yinters", "<", 
                   RowBox[{"equilb", "[", "xinters", "]"}]}], ",", 
                  RowBox[{"Row", "@", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<equilibrium stages needed = \>\"", ",", "it", ",", 
                    " ", "\"\< (including reboiler)\>\""}], "}"}]}], ",", 
                  "\"\<equilibrium stages needed = infinite (pinch \
point)\>\""}], "]"}], ",", "17"}], "]"}]}], ",", "SpanFromLeft"}], "}"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"Show", "[", 
             RowBox[{"plot", ",", "mouse", ",", 
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"600", ",", "375"}], "}"}]}]}], "]"}], "}"}]}], 
          "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lvmult", ",", "3", ",", 
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{"\"\<external reflux ratio \>\"", ",", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<L\>\"", ",", "Italic"}], "]"}], "/", 
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<D\>\"", ",", "Italic"}], "]"}]}]}], "}"}]}]}],
              "}"}], ",", "0.25", ",", "10", ",", "0.25", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
          "]"}], ",", "SpanFromLeft", ",", "SpanFromLeft", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "window", ",", "True", ",", 
              "\"\<view process flow diagram\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<mole fractions:\>\"", ",", "Bold"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xd", ",", "0.85", ",", 
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{"\"\<distillate \>\"", ",", 
                 RowBox[{"Subscript", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                   "\"\<d\>\""}], "]"}]}], "}"}]}]}], "}"}], ",", "0.8", ",", 
            "0.98", ",", "0.01", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}], ",", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xb", ",", "0.15", ",", 
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{"\"\<bottoms \>\"", ",", 
                 RowBox[{"Subscript", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                   "\"\<b\>\""}], "]"}]}], "}"}]}]}], "}"}], ",", "0.05", ",",
             "0.2", ",", "0.01", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}], ",", 
         "SpanFromLeft", ",", "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"pt", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "Locator", ",", 
            RowBox[{"Appearance", "\[Rule]", "None"}], ",", 
            RowBox[{"AutoAction", "\[Rule]", "True"}]}], "}"}], "]"}]}], 
        "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.6791553254791594`*^9, 3.679155329873468*^9}, {
   3.6791556001387033`*^9, 3.6791557614649463`*^9}, {3.67915581248167*^9, 
   3.6791561007419863`*^9}, {3.679156141457693*^9, 3.679156344368431*^9}, {
   3.6791564900867343`*^9, 3.679156512954076*^9}, {3.6791565807912645`*^9, 
   3.679156649708645*^9}, {3.6791567123587446`*^9, 3.679156794934859*^9}, {
   3.679156833796861*^9, 3.6791569957658396`*^9}, {3.6791570604285636`*^9, 
   3.6791572218508306`*^9}, {3.679157525461012*^9, 3.679157655789405*^9}, {
   3.67915770730994*^9, 3.679157716477666*^9}, {3.679157747764924*^9, 
   3.67915801972663*^9}, {3.679165905784717*^9, 3.6791659343246546`*^9}, {
   3.679165982227887*^9, 3.6791659828518887`*^9}, {3.6791660207080383`*^9, 
   3.6791660217412615`*^9}, 3.6791660737591677`*^9, {3.679166142700448*^9, 
   3.6791661996766667`*^9}, {3.679166386967787*^9, 3.679166412477315*^9}, {
   3.67916652547334*^9, 3.679166536217806*^9}, {3.6791665836363897`*^9, 
   3.6791667663531103`*^9}, {3.679166806818655*^9, 3.6791669105213413`*^9}, {
   3.6791669420458326`*^9, 3.679166952949855*^9}, {3.6791669913194265`*^9, 
   3.67916699526385*^9}, {3.6791670662025375`*^9, 3.679167108679714*^9}, {
   3.6791672701241446`*^9, 3.6791672712043486`*^9}, {3.679167433471369*^9, 
   3.6791675185796957`*^9}, {3.679167581806819*^9, 3.6791677888934994`*^9}, {
   3.6791678506201744`*^9, 3.679168049228289*^9}, {3.679168094480503*^9, 
   3.679168144272162*^9}, {3.6791681816773167`*^9, 3.6791682356947765`*^9}, {
   3.6791682714082785`*^9, 3.679168335759383*^9}, {3.6791683867127843`*^9, 
   3.67916840042745*^9}, {3.6791684612765408`*^9, 3.6791688598354297`*^9}, {
   3.6791690256285686`*^9, 3.679169090073037*^9}, {3.6791691235882025`*^9, 
   3.6791691373374653`*^9}, {3.6791691884383144`*^9, 
   3.6791692489081078`*^9}, {3.6791692846714573`*^9, 3.679169286722061*^9}, {
   3.6791693218766522`*^9, 3.6791694130028706`*^9}, {3.6791696317901793`*^9, 
   3.6791698389108047`*^9}, {3.679169871848765*^9, 3.6791698721295657`*^9}, {
   3.679169914913579*^9, 3.6791699338790956`*^9}, {3.6791699640042667`*^9, 
   3.6791703393924055`*^9}, {3.679170369578545*^9, 3.6791705964120755`*^9}, {
   3.6791706283046055`*^9, 3.6791706824684267`*^9}, {3.6791707867518263`*^9, 
   3.679170794513872*^9}, {3.6791708442270603`*^9, 3.6791710798377247`*^9}, {
   3.6791711242925315`*^9, 3.6791711701785145`*^9}, {3.6791712226749306`*^9, 
   3.6791714460550704`*^9}, {3.67917149427582*^9, 3.6791717125324383`*^9}, {
   3.6791717616904745`*^9, 3.6791718282379417`*^9}, {3.6791719058076277`*^9, 
   3.6791720945400496`*^9}, {3.679172137702261*^9, 3.679172144154276*^9}, {
   3.6791721841770535`*^9, 3.6791726172675524`*^9}, {3.6791726539498773`*^9, 
   3.6791727216635485`*^9}, {3.6791727533342466`*^9, 3.679172907231859*^9}, {
   3.6791729399814377`*^9, 3.6791731039974546`*^9}, {3.6791731352421675`*^9, 
   3.6791732809113665`*^9}, {3.679173515153974*^9, 3.6791735889043264`*^9}, {
   3.6791770963974514`*^9, 3.6791772120818415`*^9}, {3.6791773934402876`*^9, 
   3.6791774777596083`*^9}, {3.679177565339935*^9, 3.679177589510214*^9}, {
   3.6791777811296887`*^9, 3.6791777841580944`*^9}, {3.6791778539641485`*^9, 
   3.6791778824915037`*^9}, 3.679177970783986*^9, {3.6791780355379725`*^9, 
   3.679178036005973*^9}, 3.6791781369003525`*^9, {3.6792374078019032`*^9, 
   3.679237437508692*^9}, {3.67923751057416*^9, 3.679237523431884*^9}, 
   3.6792386328862534`*^9, {3.6793267918314295`*^9, 3.6793268231615047`*^9}, {
   3.6793268627247777`*^9, 3.6793269725677605`*^9}, {3.6793270379857626`*^9, 
   3.679327140248809*^9}, {3.6793272007235546`*^9, 3.6793272044413614`*^9}, {
   3.679327268733713*^9, 3.679327274627924*^9}, 3.67932737733476*^9, 
   3.679328406843904*^9, {3.679415058247796*^9, 3.679415140745966*^9}, {
   3.6812316041238327`*^9, 3.681231618558658*^9}, {3.681231657267513*^9, 
   3.6812316960787325`*^9}, {3.6812317269694996`*^9, 
   3.6812317522069426`*^9}, {3.6812321923001146`*^9, 
   3.6812321997875433`*^9}, {3.681232389222378*^9, 3.681232393993651*^9}, {
   3.68148115564466*^9, 3.681481158935066*^9}, {3.681482582124906*^9, 
   3.6814825824213066`*^9}, {3.681482613386963*^9, 3.6814826159347672`*^9}, {
   3.6814932121024837`*^9, 3.681493212835685*^9}, {3.681493318187679*^9, 
   3.6814933273813105`*^9}, {3.6814933624394045`*^9, 3.681493409219512*^9}, {
   3.6814934401963687`*^9, 3.6814934741984324`*^9}, {3.681493515796757*^9, 
   3.6814937068699317`*^9}, {3.6815799065542526`*^9, 3.681579917545487*^9}, {
   3.6815799648075914`*^9, 3.6815799669945955`*^9}, 3.6815800637071915`*^9},
 CellID->542361648],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`lvmult$$ = 3, $CellContext`pt$$ = {1., 
    0.215}, $CellContext`window$$ = True, $CellContext`xb$$ = 
    0.15, $CellContext`xd$$ = 0.85, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`lvmult$$], 3, 
       Row[{
        "external reflux ratio ", Style["D", Italic]^(-1) 
         Style["L", Italic]}]}, 0.25, 10, 0.25}, {{
       Hold[$CellContext`window$$], True, "view process flow diagram"}, {
      True, False}}, {{
       Hold[$CellContext`xd$$], 0.85, 
       Row[{"distillate ", 
         Subscript[
          Style["x", Italic], "d"]}]}, 0.8, 0.98, 0.01}, {{
       Hold[$CellContext`xb$$], 0.15, 
       Row[{"bottoms ", 
         Subscript[
          Style["x", Italic], "b"]}]}, 0.05, 0.2, 0.01}, {{
       Hold[$CellContext`pt$$], {0, 0}}, Automatic}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], SpanFromLeft, SpanFromLeft, 
          Manipulate`Place[2]}, {
          Style["mole fractions:", Bold], 
          Manipulate`Place[3], 
          Manipulate`Place[4], SpanFromLeft, 
          Manipulate`Place[5]}}, Alignment -> Left]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    608., {196., 203.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`lvmult$129256$$ = 
    0, $CellContext`window$129257$$ = False, $CellContext`xd$129258$$ = 
    0, $CellContext`xb$129259$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`lvmult$$ = 
        3, $CellContext`pt$$ = {0, 0}, $CellContext`window$$ = 
        True, $CellContext`xb$$ = 0.15, $CellContext`xd$$ = 0.85}, 
      "ControllerVariables" :> {
        Hold[$CellContext`lvmult$$, $CellContext`lvmult$129256$$, 0], 
        Hold[$CellContext`window$$, $CellContext`window$129257$$, False], 
        Hold[$CellContext`xd$$, $CellContext`xd$129258$$, 0], 
        Hold[$CellContext`xb$$, $CellContext`xb$129259$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`cond$, $CellContext`zf$, $CellContext`q$, \
$CellContext`mve$, $CellContext`P$, $CellContext`VPMet$, $CellContext`VPWat$, \
$CellContext`A12$, $CellContext`A21$, $CellContext`\[Gamma]1$, $CellContext`\
\[Gamma]2$, $CellContext`i$, $CellContext`x2$, $CellContext`T$, \
$CellContext`y2$, $CellContext`equilb$, $CellContext`equilb2$, \
$CellContext`feed$, $CellContext`xpinch$, $CellContext`ypinch$, \
$CellContext`opertRect$, $CellContext`opertStrp$, $CellContext`Rmin$, \
$CellContext`R$, $CellContext`OpRect$, $CellContext`xinters$, \
$CellContext`yinters$, $CellContext`OpStrp$, $CellContext`yr$, \
$CellContext`xr$, $CellContext`v$, $CellContext`t$, $CellContext`ir$, \
$CellContext`ys$, $CellContext`xs$, $CellContext`imax$, $CellContext`tbl1$, \
$CellContext`tbl2$, $CellContext`tbl3$, $CellContext`tbl4$, \
$CellContext`tblih$, $CellContext`tbliv$, $CellContext`it$, \
$CellContext`distflow$, $CellContext`botflow$, $CellContext`xybase$, \
$CellContext`xyadd$, $CellContext`plot$, $CellContext`diagram$, \
$CellContext`mouse$}, $CellContext`cond$ = $CellContext`yinters$ >= \
$CellContext`equilb$[$CellContext`xinters$]; $CellContext`zf$ = 
         0.5; $CellContext`q$ = 0.5; $CellContext`mve$ = 1; $CellContext`P$ = 
         760; $CellContext`VPMet$[
           Pattern[$CellContext`T, 
            Blank[]]] := 
         10^(8.08097 - 1582.271/(
           239.726 + $CellContext`T)); $CellContext`VPWat$[
           Pattern[$CellContext`T, 
            Blank[]]] := 
         10^(8.07131 - 1730.63/(233.426 + $CellContext`T)); $CellContext`A12$ = 
         0.5434; $CellContext`A21$ = 0.7923; $CellContext`\[Gamma]1$[
           Pattern[$CellContext`i$, 
            Blank[]]] := 
         Exp[$CellContext`x2$[$CellContext`i$]^2 ($CellContext`A12$ + 
            2 ($CellContext`A21$ - $CellContext`A12$) (
              1 - $CellContext`x2$[$CellContext`i$]))]; \
$CellContext`\[Gamma]2$[
           Pattern[$CellContext`i$, 
            Blank[]]] := 
         Exp[(1 - $CellContext`x2$[$CellContext`i$])^2 ($CellContext`A21$ + 
            2 ($CellContext`A12$ - $CellContext`A21$) \
$CellContext`x2$[$CellContext`i$])]; $CellContext`i$ = 0; 
        While[$CellContext`i$ < 
          101, {$CellContext`x2$[$CellContext`i$] = $CellContext`i$ 
            0.01, $CellContext`T$[$CellContext`i$] = 
           ReplaceAll[$CellContext`T$, 
             Quiet[
              
              FindRoot[$CellContext`P$ == \
$CellContext`VPWat$[$CellContext`T$] $CellContext`\[Gamma]1$[$CellContext`i$] \
(1 - $CellContext`x2$[$CellContext`i$]) + \
$CellContext`VPMet$[$CellContext`T$] $CellContext`\[Gamma]2$[$CellContext`i$] \
$CellContext`x2$[$CellContext`i$], {$CellContext`T$, 60}, AccuracyGoal -> 
               5]]], $CellContext`y2$[$CellContext`i$] = \
$CellContext`x2$[$CellContext`i$] + ($CellContext`VPMet$[
                 $CellContext`T$[$CellContext`i$]] \
$CellContext`\[Gamma]2$[$CellContext`i$] \
($CellContext`x2$[$CellContext`i$]/$CellContext`P$) - \
$CellContext`x2$[$CellContext`i$]) $CellContext`mve$, 
           Increment[$CellContext`i$]}]; $CellContext`equilb$ = Interpolation[
           Table[{
             $CellContext`x2$[$CellContext`i$], 
             $CellContext`y2$[$CellContext`i$]}, {$CellContext`i$, 0, 
             100}]]; $CellContext`equilb2$[
           Pattern[$CellContext`m$, 
            
            Blank[]]] := $CellContext`m$ + \
($CellContext`equilb$[$CellContext`m$] - $CellContext`m$) (
            1/$CellContext`mve$); $CellContext`feed$[
           Pattern[$CellContext`x$, 
            Blank[]]] := 
         If[$CellContext`q$ != 
           1, $CellContext`q$ ($CellContext`x$/($CellContext`q$ - 
             1)) - $CellContext`zf$/($CellContext`q$ - 1), 
           1000000 ($CellContext`x$ - $CellContext`zf$) + $CellContext`zf$]; \
$CellContext`xpinch$ = ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`feed$[$CellContext`x] == \
$CellContext`equilb2$[$CellContext`x], {$CellContext`x, 
              0.5}]]]; $CellContext`ypinch$ = \
$CellContext`feed$[$CellContext`xpinch$]; $CellContext`opertRect$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`ypinch$ + (($CellContext`x$ - \
$CellContext`xpinch$)/($CellContext`xd$$ - $CellContext`xpinch$)) \
($CellContext`xd$$ - $CellContext`ypinch$); $CellContext`opertStrp$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`ypinch$ + (($CellContext`x$ - \
$CellContext`xpinch$)/($CellContext`xb$$ - $CellContext`xpinch$)) \
($CellContext`xb$$ - $CellContext`ypinch$); $CellContext`Rmin$ = \
(($CellContext`xd$$ - $CellContext`ypinch$)/($CellContext`xd$$ - \
$CellContext`xpinch$))/(
          1 - ($CellContext`xd$$ - $CellContext`ypinch$)/($CellContext`xd$$ - \
$CellContext`xpinch$)); $CellContext`R$ = $CellContext`lvmult$$; \
$CellContext`OpRect$[
           Pattern[$CellContext`x$, 
            Blank[]]] := ($CellContext`R$/($CellContext`R$ + 
            1)) $CellContext`x$ + $CellContext`xd$$/($CellContext`R$ + 
           1); $CellContext`xinters$ = ReplaceAll[$CellContext`x, 
           Quiet[
            
            FindRoot[$CellContext`feed$[$CellContext`x] == \
$CellContext`OpRect$[$CellContext`x], {$CellContext`x, 
              0.7}]]]; $CellContext`yinters$ = \
$CellContext`OpRect$[$CellContext`xinters$]; 
        If[$CellContext`cond$, {$CellContext`OpStrp$[
              Pattern[$CellContext`x$, 
               
               Blank[]]] := $CellContext`opertStrp$[$CellContext`x$]; \
$CellContext`yr$[0] = $CellContext`xd$$; $CellContext`xr$[
             0] = $CellContext`xd$$; $CellContext`i$ = 0; 
           While[$CellContext`i$ < 
             25, {$CellContext`v$ = ReplaceAll[$CellContext`u, 
                Quiet[
                 
                 FindRoot[$CellContext`yr$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`u], {$CellContext`u, 
                   0.5}]]], $CellContext`t$ = \
$CellContext`opertRect$[$CellContext`v$], 
              
              If[$CellContext`v$ > $CellContext`xpinch$, \
{$CellContext`xr$[$CellContext`i$ + 
                  1] = $CellContext`v$, $CellContext`yr$[$CellContext`i$ + 
                  1] = $CellContext`t$}], 
              
              Increment[$CellContext`i$]}]; $CellContext`ir$ = \
$CellContext`i$ - 1; 
           If[$CellContext`ir$ >= 
             0, {$CellContext`ys$[
                0] = $CellContext`yr$[$CellContext`ir$]; $CellContext`xs$[
                0] = $CellContext`xr$[$CellContext`ir$]}]; $CellContext`i$ = 
            0; While[$CellContext`i$ < 
             20, {$CellContext`v$ = ReplaceAll[$CellContext`u, 
                Quiet[
                 
                 FindRoot[$CellContext`ys$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`u], {$CellContext`u, 
                   0.5}]]], $CellContext`t$ = \
$CellContext`opertStrp$[$CellContext`v$], $CellContext`xs$[$CellContext`i$ + 
                1] = $CellContext`v$, $CellContext`ys$[$CellContext`i$ + 
                1] = $CellContext`t$, 
              Increment[$CellContext`i$]}]; Null}, {$CellContext`OpStrp$[
              Pattern[$CellContext`x$, 
               
               Blank[]]] := $CellContext`yinters$ + (($CellContext`x$ - \
$CellContext`xinters$)/($CellContext`xb$$ - $CellContext`xinters$)) \
($CellContext`xb$$ - $CellContext`yinters$); $CellContext`yr$[
             0] = $CellContext`xd$$; $CellContext`xr$[
             0] = $CellContext`xd$$; $CellContext`i$ = 0; 
           While[$CellContext`xr$[$CellContext`i$] > $CellContext`xinters$, \
{$CellContext`v$ = ReplaceAll[$CellContext`u, 
                Quiet[
                 
                 FindRoot[$CellContext`yr$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`u], {$CellContext`u, 
                   0.7}]]], $CellContext`t$ = \
$CellContext`OpRect$[$CellContext`v$], 
              
              If[$CellContext`v$ > $CellContext`xinters$, \
{$CellContext`xr$[$CellContext`i$ + 
                  1] = $CellContext`v$, $CellContext`yr$[$CellContext`i$ + 
                  1] = $CellContext`t$}], 
              
              Increment[$CellContext`i$]}]; $CellContext`ir$ = \
$CellContext`i$ - 1; $CellContext`i$ = 0; 
           If[$CellContext`ir$ >= 
             0, $CellContext`ys$[
               0] = $CellContext`yr$[$CellContext`ir$]; $CellContext`xs$[
               0] = $CellContext`xr$[$CellContext`ir$]]; 
           While[$CellContext`xs$[$CellContext`i$] > $CellContext`xb$$, \
{$CellContext`v$ = ReplaceAll[$CellContext`u, 
                Quiet[
                 
                 FindRoot[$CellContext`ys$[$CellContext`i$] == \
$CellContext`equilb$[$CellContext`u], {$CellContext`u, 
                   0.5}]]], $CellContext`t$ = \
$CellContext`OpStrp$[$CellContext`v$], $CellContext`xs$[$CellContext`i$ + 
                1] = $CellContext`v$, $CellContext`ys$[$CellContext`i$ + 
                1] = $CellContext`t$, 
              Increment[$CellContext`i$]}]; 
           Null}]; $CellContext`imax$ = $CellContext`i$ - 
          1; $CellContext`tbl1$ = Table[
           Line[{{
              $CellContext`xr$[$CellContext`i$], 
              $CellContext`yr$[$CellContext`i$ - 1]}, {
              $CellContext`xr$[$CellContext`i$], 
              $CellContext`yr$[$CellContext`i$]}}], {$CellContext`i$, 
            1, $CellContext`ir$}]; $CellContext`tbl2$ = 
         If[$CellContext`ir$ >= 1, 
           Table[
            Line[{{
               $CellContext`xr$[$CellContext`i$], 
               $CellContext`yr$[$CellContext`i$]}, {
               $CellContext`xr$[$CellContext`i$ + 1], 
               $CellContext`yr$[$CellContext`i$]}}], {$CellContext`i$, 
             0, $CellContext`ir$ - 1}], 
           Table[
            Line[{{
               $CellContext`xr$[$CellContext`i$], 
               $CellContext`yr$[$CellContext`i$]}, {
               $CellContext`xr$[$CellContext`i$ + 1], 
               $CellContext`yr$[$CellContext`i$]}}], {$CellContext`i$, 0, 0}]]
          ; $CellContext`tbl3$ = Table[
           Line[{{
              $CellContext`xs$[$CellContext`i$ + 1], 
              $CellContext`ys$[$CellContext`i$]}, {
              $CellContext`xs$[$CellContext`i$ + 1], 
              $CellContext`ys$[$CellContext`i$ + 1]}}], {$CellContext`i$, 
            0, $CellContext`imax$ - 1}]; $CellContext`tbl4$ = Table[
           Line[{{
              $CellContext`xs$[$CellContext`i$ - 1], 
              $CellContext`ys$[$CellContext`i$ - 1]}, {
              $CellContext`xs$[$CellContext`i$], 
              $CellContext`ys$[$CellContext`i$ - 1]}}], {$CellContext`i$, 
            1, $CellContext`imax$ + 1}]; $CellContext`tblih$ = Line[{{
             $CellContext`xs$[1], 
             $CellContext`ys$[0]}, {
             $CellContext`xr$[$CellContext`ir$], 
             $CellContext`ys$[0]}}]; $CellContext`tbliv$ = Line[{{
             $CellContext`xs$[1], 
             $CellContext`ys$[0]}, {
             $CellContext`xs$[1], 
             $CellContext`ys$[
             1]}}]; $CellContext`it$ = $CellContext`imax$ + $CellContext`ir$ + 
          1; $CellContext`distflow$ = ($CellContext`zf$ - \
$CellContext`xs$[$CellContext`imax$ + 
            1])/$CellContext`xd$$; $CellContext`botflow$ = 
         1 - $CellContext`distflow$; $CellContext`xybase$ = Show[
           Plot[{
             $CellContext`equilb2$[$CellContext`x], $CellContext`x}, \
{$CellContext`x, 0, 1}, PlotStyle -> {{Thick, Red}, {Thick, 
               RGBColor[0, 0.6, 0]}}, PlotRange -> {{0, 1}, {0, 1}}], 
           If[$CellContext`cond$, {
             Plot[
              $CellContext`feed$[$CellContext`x], {$CellContext`x, \
$CellContext`xpinch$, $CellContext`zf$}, PlotStyle -> {Thick, Blue}], 
             Plot[
              $CellContext`opertRect$[$CellContext`x], {$CellContext`x, \
$CellContext`xpinch$, $CellContext`xd$$}, PlotStyle -> {Thick, 
                RGBColor[0, 0.65, 1]}], 
             Plot[
              $CellContext`opertStrp$[$CellContext`x], {$CellContext`x, \
$CellContext`xb$$, $CellContext`xpinch$}, PlotStyle -> {Thick, Magenta}]}, {
             Plot[
              $CellContext`feed$[$CellContext`x], {$CellContext`x, \
$CellContext`xinters$, $CellContext`zf$}, PlotStyle -> {Thick, Blue}], 
             Plot[
              $CellContext`OpRect$[$CellContext`x], {$CellContext`x, \
$CellContext`xinters$, $CellContext`xd$$}, PlotStyle -> {Thick, 
                RGBColor[0, 0.65, 1]}], 
             Plot[
              $CellContext`OpStrp$[$CellContext`x], {$CellContext`x, \
$CellContext`xb$$, $CellContext`xinters$}, PlotStyle -> {Thick, Magenta}]}], 
           
           Graphics[{
            Thick, $CellContext`tbl1$, $CellContext`tbl2$, \
$CellContext`tblih$, $CellContext`tbliv$}], Frame -> True, FrameLabel -> {
             Row[{"liquid mole fraction ", 
               Subscript[
                Style["x", Italic], "met"]}], 
             Row[{"vapor mole fraction ", 
               Subscript[
                Style["y", Italic], "met"]}]}, LabelStyle -> {17, Black}, 
           AspectRatio -> Full, PlotRangePadding -> None, 
           ImagePadding -> {{55, 10}, {50, 10}}]; $CellContext`xyadd$ = 
         Graphics[{{Thick, $CellContext`tbl3$, $CellContext`tbl4$}, 
            Table[
             Text[
              
              Style[$CellContext`ir$ + 
               1 + $CellContext`imax$ - $CellContext`f, 17], {
               $CellContext`xr$[$CellContext`f], 
               $CellContext`yr$[$CellContext`f - 1]}, {
              1, -1}], {$CellContext`f, 1, $CellContext`ir$}], 
            Table[
             Text[
              Style[$CellContext`imax$ + 1 - $CellContext`f, 17], {
               $CellContext`xs$[$CellContext`f], 
               $CellContext`ys$[$CellContext`f - 1]}, {
              1, -1}], {$CellContext`f, 1, $CellContext`imax$}], {Dashed, 
             Line[{{
                $CellContext`xs$[$CellContext`imax$ + 1], 
                $CellContext`ys$[$CellContext`imax$]}, {
                $CellContext`xs$[$CellContext`imax$ + 1], 0}}], 
             Line[{{
                $CellContext`xr$[0], 
                $CellContext`yr$[0]}, {
                $CellContext`xr$[0], 0}}], 
             Line[{{0.5, 0.5}, {0.5, 0}}]}, 
            Apply[Text[
              Style[
               Row[{
                 Subscript[
                  Style["x", Italic], #], " = ", 
                 SetPrecision[#2, 2]}], 17, Background -> White], {#2, 0.05}, 
              1.1 {#3, 0}]& , {{"b", 
               $CellContext`xs$[$CellContext`imax$ + 1], -1}, {"d", 
               $CellContext`xr$[0], 1}}, {1}], 
            Text[
             Style["R", 17, Italic, Background -> White], {
              $CellContext`xs$[$CellContext`imax$ + 1], 
              $CellContext`ys$[$CellContext`imax$]}, {0, -1}], 
            Text[
             Style[
              Row[{
                Subscript[
                 Style["z", Italic], "f"], " = 0.5"}], 17, Background -> 
              White], {0.5, 0.15}]}]; $CellContext`plot$ = 
         If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
           
           Show[$CellContext`xybase$, $CellContext`xyadd$], \
$CellContext`xybase$]; $CellContext`diagram$ = Graphics[{{
             EdgeForm[Thick], 
             FaceForm[None], 
             Rectangle[{0, 0}, {1, 3}], 
             Disk[{0.75, -0.5}, 1.1 {0.25, 0.15}], 
             Disk[{1.75, 2.8}, 1.1 {0.25, 0.15}]}, {Thick, 
             Arrowheads[0.06], 
             Arrow[{{0.5, -0.5}, {0.25, -0.5}, {0.25, 0}}], 
             Arrow[{{0.75, 0}, {0.75, -0.32}}], 
             Arrow[{{1.05, -0.5}, {2, -0.5}}], 
             Arrow[{{0.25, 3}, {0.25, 3.4}, {1.75, 3.4}, {1.75, 2.95}}], 
             Arrow[{{1.5, 2.8}, {1, 2.8}}], 
             Arrow[{{2.05, 2.8}, {3, 2.8}}], 
             
             If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], {
               
               Arrow[{{-1.5, 3 (2 $CellContext`imax$ + 1)/(
                  2 $CellContext`it$)}, {
                 0, 3 (2 $CellContext`imax$ + 1)/(2 $CellContext`it$)}}], 
               Map[{
                 Text[
                  Style[
                   Row[{"stage ", #}], 17], {0.5, 3 (#/$CellContext`it$)}, {
                  0, -1.1}], 
                 
                 Line[{{0, 3 (#/$CellContext`it$)}, {
                   1, 3 (#/$CellContext`it$)}}]}& , 
                Range[$CellContext`it$ - 1]]}, 
              Arrow[{{-1.5, 1.5}, {0, 1.5}}]]}, 
            Apply[Text[
              Style[#, 17, Italic], #2]& , {{"R", {0.75, -0.5}}, {
              "C", {1.75, 2.8}}}, {1}], 
            Text[
             Style[
              Column[{"feed rate", "1 kmol/h", 
                Spacer[1], 
                Row[{
                  Subscript[
                   Style["z", Italic], "f"], " = 0.5"}], "quality = 0.5", 
                "VLE"}, Center], 17], {-0.85, 
              
              If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 3 (2 $CellContext`imax$ + 1)/(
               2 $CellContext`it$), 1.5]}, {0, 0.2}], 
            Text[
             Style[
              Column[{"reflux ratio", 
                Row[{Style["L", Italic]/Style["D", Italic], " = ", 
                  SetPrecision[$CellContext`R$, 3]}]}, Center], 17], {1.85, 
             2.15}], 
            Text[
             Style[
              Column[{"distillate flow", 
                
                If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
                 Row[{
                   SetPrecision[$CellContext`distflow$, 2], " kmol/h"}], 
                 "N/A"]}, Center], 17], {2.8, 3.1}], 
            Text[
             Style[
              Column[{"bottoms flow", 
                
                If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
                 Row[{
                   SetPrecision[$CellContext`botflow$, 2], " kmol/h"}], 
                 "N/A"]}, Center], 17], {2.8, -0.5}]}, 
           ImageSize -> {290, 375}, AspectRatio -> Full]; $CellContext`mouse$ = 
         Graphics[{
            Apply[Mouseover[{
               Thickness[0.015], Transparent, 
               Line[
                Table[#, 
                 Evaluate[
                  Flatten[{$CellContext`x, #2, 0.05}]]]]}, 
              Text[
               Style[#3, 18, #4, Background -> White], 
               
               Dynamic[$CellContext`pt$$], #5]]& , {{{$CellContext`x, \
$CellContext`x}, {0, 1}, 
               Row[{
                 Style["x", Italic], " = ", 
                 Style["y", Italic], " line"}], 
               RGBColor[0, 0.6, 0], {-1, -1}}, {{$CellContext`x, 
                $CellContext`equilb2$[$CellContext`x]}, {0, 1}, 
               "equilibrium curve", Red, {1, -1}}, {{$CellContext`x, 
                $CellContext`feed$[$CellContext`x]}, {
                
                If[$CellContext`cond$, $CellContext`xpinch$, \
$CellContext`xinters$], $CellContext`zf$}, 
               Row[{
                 Style["q", Italic], "-line"}], 
               Blue, {-1, -1}}, {{$CellContext`x, 
                If[$CellContext`cond$, 
                 $CellContext`opertRect$[$CellContext`x], 
                 $CellContext`OpRect$[$CellContext`x]]}, {
                
                If[$CellContext`cond$, $CellContext`xpinch$, \
$CellContext`xinters$], $CellContext`xd$$}, "rectifying section", 
               RGBColor[0, 0.65, 1], {-1, -1}}, {{$CellContext`x, 
                If[$CellContext`cond$, 
                 $CellContext`opertStrp$[$CellContext`x], 
                 $CellContext`OpStrp$[$CellContext`x]]}, {$CellContext`xb$$, 
                
                If[$CellContext`cond$, $CellContext`xpinch$, \
$CellContext`xinters$]}, "stripping section", Magenta, {1, -1}}}, {1}], 
            Mouseover[{
              Thickness[0.015], 
              Transparent, $CellContext`tbl1$, $CellContext`tbl2$, \
$CellContext`tblih$, $CellContext`tbliv$}, 
             Text[
              Style["equilibrium stages", 18, Background -> White], 
              Dynamic[$CellContext`pt$$], {-1, -1}]], 
            Mouseover[{
              Thickness[0.015], Transparent, 
              Line[{{
                 $CellContext`xs$[$CellContext`imax$ + 1], 
                 $CellContext`ys$[$CellContext`imax$]}, {
                 $CellContext`xs$[$CellContext`imax$ + 1], 0}}]}, 
             Text[
              Style["bottoms", 18, Background -> White], 
              Dynamic[$CellContext`pt$$], {-1, -1}]], 
            Mouseover[{
              Thickness[0.015], Transparent, 
              Line[{{
                 $CellContext`xr$[0], 
                 $CellContext`yr$[0]}, {
                 $CellContext`xr$[0], 0}}]}, 
             Text[
              Style["distillate", 18, Background -> White], 
              Dynamic[$CellContext`pt$$], {-1, -1}]], 
            Mouseover[{
              Thickness[0.015], Transparent, 
              Line[{{0.5, 0.5}, {0.5, 0}}]}, 
             Text[
              Style["feed", 18, Background -> White], 
              Dynamic[$CellContext`pt$$], {-1, -1}]]}]; 
        Switch[$CellContext`window$$, True, 
          Grid[{{
             Text[
              Style[
               
               If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
                
                Row[{"equilibrium stages needed = ", $CellContext`it$, 
                  " (including reboiler)"}], 
                "equilibrium stages needed = infinite (pinch point)"], 17]], 
             SpanFromLeft}, {
             
             Show[$CellContext`plot$, 
              ImageSize -> {310, 375}], $CellContext`diagram$}}], False, 
          Grid[{{
             Text[
              Style[
               
               If[$CellContext`yinters$ < \
$CellContext`equilb$[$CellContext`xinters$], 
                
                Row[{"equilibrium stages needed = ", $CellContext`it$, 
                  " (including reboiler)"}], 
                "equilibrium stages needed = infinite (pinch point)"], 17]], 
             SpanFromLeft}, {
             
             Show[$CellContext`plot$, $CellContext`mouse$, 
              ImageSize -> {600, 375}]}}]]], 
      "Specifications" :> {{{$CellContext`lvmult$$, 3, 
          
          Row[{"external reflux ratio ", Style["D", Italic]^(-1) 
            Style["L", Italic]}]}, 0.25, 10, 0.25, Appearance -> "Labeled", 
         ControlPlacement -> 
         1}, {{$CellContext`window$$, True, "view process flow diagram"}, {
         True, False}, ControlPlacement -> 2}, {{$CellContext`xd$$, 0.85, 
          Row[{"distillate ", 
            Subscript[
             Style["x", Italic], "d"]}]}, 0.8, 0.98, 0.01, Appearance -> 
         "Labeled", ImageSize -> Small, ControlPlacement -> 
         3}, {{$CellContext`xb$$, 0.15, 
          Row[{"bottoms ", 
            Subscript[
             Style["x", Italic], "b"]}]}, 0.05, 0.2, 0.01, Appearance -> 
         "Labeled", ImageSize -> Small, ControlPlacement -> 
         4}, {{$CellContext`pt$$, {0, 0}}, Automatic, ControlType -> Locator, 
         Appearance -> None, AutoAction -> True, ControlPlacement -> 5}, 
        Grid[{{
           Manipulate`Place[1], SpanFromLeft, SpanFromLeft, 
           Manipulate`Place[2]}, {
           Style["mole fractions:", Bold], 
           Manipulate`Place[3], 
           Manipulate`Place[4], SpanFromLeft, 
           Manipulate`Place[5]}}, Alignment -> Left]}, "Options" :> {}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{663., {258., 265.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.679155844174895*^9, {3.679155951585746*^9, 3.6791560653654976`*^9}, 
   3.6791561906718097`*^9, {3.679156301205937*^9, 3.6791563246657877`*^9}, 
   3.679156798328865*^9, {3.67915684393948*^9, 3.6791568539007053`*^9}, {
   3.679156884362872*^9, 3.679156931513582*^9}, 3.6791569678860655`*^9, 
   3.6791570004958487`*^9, 3.679157031707881*^9, {3.67915718646062*^9, 
   3.6791572177691107`*^9}, {3.6791577575027494`*^9, 3.6791577761932936`*^9}, 
   3.6791578066549664`*^9, {3.6791578546174088`*^9, 3.6791578775416517`*^9}, {
   3.679157924888892*^9, 3.679157948766844*^9}, 3.679158020366232*^9, {
   3.679165900846078*^9, 3.6791659065813184`*^9}, 3.679165948839927*^9, 
   3.679166200191468*^9, {3.6791664008546476`*^9, 3.6791664057834716`*^9}, 
   3.6791671107705317`*^9, 3.6791672731533823`*^9, {3.679167480128568*^9, 
   3.679167492289796*^9}, 3.6791676858619766`*^9, 3.679167755834541*^9, 
   3.679168061842746*^9, {3.6791682990780115`*^9, 3.679168336529186*^9}, 
   3.679168500345748*^9, {3.679168540229065*^9, 3.6791685503691173`*^9}, {
   3.679168596629936*^9, 3.6791686547349834`*^9}, {3.67916870207045*^9, 
   3.679168776617447*^9}, 3.6791688159192057`*^9, 3.679168860961033*^9, 
   3.679169091071439*^9, 3.679169139569269*^9, 3.6791692503387103`*^9, {
   3.6791694167708783`*^9, 3.6791694220854917`*^9}, {3.6791696605562677`*^9, 
   3.679169690918603*^9}, {3.6791697379389906`*^9, 3.6791697534232965`*^9}, {
   3.6791698200911674`*^9, 3.6791698407838078`*^9}, 3.6791698732089677`*^9, {
   3.6791699268628635`*^9, 3.679169934971098*^9}, {3.6791699949939775`*^9, 
   3.67917002034266*^9}, {3.6791701078090487`*^9, 3.67917015582164*^9}, {
   3.679170221362748*^9, 3.679170245548429*^9}, 3.6791702763687515`*^9, 
   3.679170340234807*^9, 3.6791703714691486`*^9, {3.67917040727135*^9, 
   3.679170478644679*^9}, {3.6791705380679083`*^9, 3.679170559948552*^9}, 
   3.6791705968800764`*^9, {3.67917063025601*^9, 3.6791706834980288`*^9}, {
   3.679170890889118*^9, 3.679170958099761*^9}, {3.679170996366516*^9, 
   3.6791710103412056`*^9}, 3.6791710818345284`*^9, 3.6791711717203264`*^9, {
   3.6791713059632273`*^9, 3.6791713356879396`*^9}, 3.679171447586873*^9, {
   3.6791716658174596`*^9, 3.679171713776475*^9}, {3.679171781401749*^9, 
   3.6791718049000463`*^9}, 3.679171950275418*^9, {3.679172053368086*^9, 
   3.6791720948676505`*^9}, {3.679172139667865*^9, 3.679172145324278*^9}, 
   3.6791721845544543`*^9, {3.679172226124407*^9, 3.679172388139655*^9}, {
   3.6791724468570204`*^9, 3.6791724934241886`*^9}, 3.6791725632116814`*^9, {
   3.679172607056496*^9, 3.679172617862354*^9}, 3.67917266566533*^9, {
   3.6791727055408664`*^9, 3.6791727225133514`*^9}, {3.679172762051869*^9, 
   3.679172774928556*^9}, {3.6791728116078844`*^9, 3.679172869630491*^9}, 
   3.679172908476262*^9, {3.6791729652445383`*^9, 3.679172998432081*^9}, {
   3.6791730410366445`*^9, 3.6791731046994557`*^9}, {3.679173141005582*^9, 
   3.6791731652776217`*^9}, {3.6791732033214207`*^9, 3.6791732484871817`*^9}, 
   3.6791732875875797`*^9, 3.679173322366942*^9, {3.6791735416543217`*^9, 
   3.679173589356727*^9}, 3.679177108492878*^9, {3.6791771688889427`*^9, 
   3.6791771876322145`*^9}, 3.6791773119738584`*^9, 3.6791774813204155`*^9, 
   3.679177592099818*^9, 3.679177630664397*^9, 3.6791779202962456`*^9, 
   3.6791779733462143`*^9, 3.6791780629704895`*^9, 3.679178109614814*^9, 
   3.679178173710089*^9, 3.679237441569699*^9, {3.6792375192004757`*^9, 
   3.6792375240558853`*^9}, 3.679238634333956*^9, 3.679326825597109*^9, 
   3.679326867777587*^9, {3.6793269074902782`*^9, 3.6793269545314913`*^9}, 
   3.679327205845364*^9, 3.679327278597331*^9, 3.6793273794261637`*^9, 
   3.679328409109908*^9, 3.679415094217662*^9, 3.679415146036375*^9, {
   3.681231728761602*^9, 3.681231753077993*^9}, 3.681232195872319*^9, 
   3.681232395428733*^9, 3.681481160245468*^9, 3.68148261779117*^9, 
   3.6814932132256856`*^9, 3.681493328693713*^9, 3.681493443982576*^9, 
   3.6814934764312363`*^9, 3.6814936152567472`*^9, {3.681493685844293*^9, 
   3.6814937071663322`*^9}, 3.6815799211530933`*^9, 3.681579969084999*^9, 
   3.6815801030468655`*^9, 3.681583605985819*^9},
 CellID->831347655]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ManipulateCaptionSection"],

Cell[TextData[{
 "This Demonstration shows how to determine the number of equilibrium stages \
needed for a two-component separation in a countercurrent distillation \
column. The Demonstration also shows the optimal location on the column to \
feed the binary mixture. The number of equilibrium stages needed depends on \
the purity of the exiting streams as well as the reflux ratio. Set the \
distillate ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    StyleBox["d",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath",
  FormatType->"TraditionalForm"],
 " and bottoms ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    StyleBox["b",
     FontSlant->"Plain"]], TraditionalForm]], "InlineMath",
  FormatType->"TraditionalForm"],
 " compositions and the external reflux ratio with sliders. Check \"view \
diagram\" to view a diagram of the distillation column. When \"view diagram\" \
is not checked, you can move the cursor over parts of the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "-", "y"}], TraditionalForm]], "InlineMath",
  FormatType->"TraditionalForm"],
 " diagram to see the curve labels."
}], "ManipulateCaption",
 CellChangeTimes->{
  3.6791736212086253`*^9, {3.6812321057501645`*^9, 3.6812321672466817`*^9}, {
   3.681232215557445*^9, 3.681232311050907*^9}}],

Cell["\<\
This Demonstration shows how to determine the number of equilibrium stages \
needed for a two-component separation in a countercurrent distillation \
column. The Demonstration also shows the optimal location on the column to \
feed the binary mixture. The number of equilibrium stages needed depends on \
the purity of the exiting streams as well as the reflux ratio.\
\>", "ManipulateCaption",
 CellID->436798221]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ThumbnailSection"],

Cell[BoxData[
 GraphicsBox[
  {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], RectangleBox[{0, 0}], 
   InsetBox[
    StyleBox["\<\"Thumbnail Placeholder\"\>",
     StripOnInput->False,
     FontFamily->"Verdana",
     FontSize->14], {0.5, 0.6}], InsetBox[
    StyleBox["\<\"Replace this with your\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.45}], InsetBox[
    StyleBox["\<\"Manipulate at a particular setting.\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.39}], InsetBox[
    StyleBox["\<\"(Do not use a bitmap.)\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.315}]},
  ImageMargins->0.,
  ImageSize->220]], "Output",
 CellEditDuplicate->False]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SnapshotsSection"],

Cell[BoxData[
 GraphicsBox[
  {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], RectangleBox[{0, 0}], 
   InsetBox[
    StyleBox["\<\"Snapshot Placeholder\"\>",
     StripOnInput->False,
     FontFamily->"Verdana",
     FontSize->14], {0.5, 0.6}], InsetBox[
    StyleBox["\<\"Replace this with your\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.45}], InsetBox[
    StyleBox["\<\"Manipulate at a particular setting.\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.39}], InsetBox[
    StyleBox["\<\"(Do not use a bitmap.)\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.315}]},
  ImageMargins->0.,
  ImageSize->220]], "Output",
 CellEditDuplicate->False]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "DetailsSection"],

Cell["\<\
The McCabe-Thiele graphical solution method for binary distillation is used \
to determine the number of equilibrium stages needed to achieve a specified \
separation in a distillation column. This method assumes: \
\>", "DetailNotes",
 CellChangeTimes->{{3.6764836855195093`*^9, 3.676483686241996*^9}, {
   3.6764837229709883`*^9, 3.676483801144796*^9}, {3.676484208985889*^9, 
   3.676484292825663*^9}, {3.6764843498604507`*^9, 3.6764843504218388`*^9}, {
   3.679176590575749*^9, 3.679176597007991*^9}, {3.6796555622816963`*^9, 
   3.6796556032297564`*^9}, 3.6796556425293694`*^9},
 CellID->1224384310],

Cell["1. The distillation column is adiabatic ", "DetailNotes",
 CellChangeTimes->{{3.6764836855195093`*^9, 3.676483686241996*^9}, {
  3.6764837229709883`*^9, 3.676483801144796*^9}, {3.676484208985889*^9, 
  3.676484295403784*^9}, {3.676484422381997*^9, 3.6764844523721724`*^9}, {
  3.679655607719017*^9, 3.6796556264626265`*^9}},
 CellID->2068001857],

Cell[TextData[{
 "2. Constant molar overflow (CMO), which means that for every mole of vapor \
condensed, one mole of liquid is vaporized. This results in constant liquid \
and vapor flow rates between stages (the exception being the flow rates of \
the stages above and below the feed stream, which are unequal). This \
assumption requires that:\[LineSeparator]a. specific heat changes are small \
compared to latent heat changes between stages ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[LeftBracketingBar]", 
     RowBox[{
      SubscriptBox["H", 
       RowBox[{"i", "+", "1"}]], "-", 
      SubscriptBox["H", "i"]}], "\[RightBracketingBar]"}], 
    RowBox[{"<<", 
     SubscriptBox["\[Lambda]", "vap"]}]}], TraditionalForm]], "InlineMath"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[LeftBracketingBar]", 
     RowBox[{
      SubscriptBox["h", 
       RowBox[{"i", "+", "1"}]], "-", 
      SubscriptBox["h", "i"]}], "\[RightBracketingBar]"}], 
    RowBox[{"<<", 
     SubscriptBox["\[Lambda]", "vap"]}]}], TraditionalForm]], "InlineMath"],
 "\[LineSeparator]b. heat of vaporization ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Lambda]", "vap"], TraditionalForm]], "InlineMath"],
 " is the same for both components and thus independent of concentration"
}], "DetailNotes",
 CellChangeTimes->{{3.6764836855195093`*^9, 3.676483686241996*^9}, {
   3.6764837229709883`*^9, 3.676483801144796*^9}, {3.676484208985889*^9, 
   3.676484295403784*^9}, {3.676484422381997*^9, 3.676484456276331*^9}, {
   3.676484503206237*^9, 3.67648451246283*^9}, {3.676484550067234*^9, 
   3.676484732401277*^9}, {3.676484794407113*^9, 3.676484958034377*^9}, {
   3.676485023568264*^9, 3.676485111254067*^9}, {3.676485187148814*^9, 
   3.6764852239547787`*^9}, {3.676485264176264*^9, 3.676485264181322*^9}, 
   3.6791767043551984`*^9, {3.6791768909036303`*^9, 3.67917690897907*^9}, 
   3.679655705263569*^9, {3.6796557543353004`*^9, 3.679655790623124*^9}},
 CellID->1246656247],

Cell["3. Heat of mixing is negligible.", "DetailNotes",
 CellChangeTimes->{{3.67965576663626*^9, 3.6796557674119697`*^9}, {
  3.681481422606306*^9, 3.681481422614277*^9}},
 CellID->274256776]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ControlSuggestionsSection"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[" Resize Images"]}],
  "\"Click inside an image to reveal its orange resize frame.\\nDrag any of \
the orange resize handles to resize the image.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.679173630758463*^9},
 FontFamily->"Verdana",
 CellTags->"ResizeImages"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Rotate and Zoom in 3D"]}],
  RowBox[{
   "\"Drag a 3D graphic to rotate it. Starting the drag near the center \
tumbles\\nthe graphic; starting near a corner turns it parallel to the plane \
of the screen.\\nHold down \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" (or \"", 
    FrameBox[
    "Cmd", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" on Mac) and drag up and down to zoom.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"RotateAndZoomIn3D"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Drag Locators"]}],
  RowBox[{"\"Drag any locator (\"", 
    GraphicsBox[
     LocatorBox[
      Scaled[{0.5, 0.5}]], ImageSize -> 20], 
    "\", etc.) to move it around.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"DragLocators"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Create and Delete Locators"]}],
  RowBox[{"\"Insert a new locator in the graphic by holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key\\nand clicking where you want it to be. Delete a locator by \
clicking it\\nwhile holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" key.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"CreateAndDeleteLocators"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[" Slider Zoom"]}],
  RowBox[{"\"Hold down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key while moving a slider to make fine adjustments in the slider \
value.\\nHold \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" and/or \"", 
    FrameBox[
    "Shift", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" at the same time as \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" to make ever finer adjustments.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.6791736327718663`*^9},
 FontFamily->"Verdana",
 CellTags->"SliderZoom"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[" Gamepad Controls"]}],
  "\"Control this Demonstration with a gamepad or other\\nhuman interface \
device connected to your computer.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.35696210375764*^9, 3.3895522232313623`*^9, 
  3.6791736335538683`*^9},
 FontFamily->"Verdana",
 CellTags->"GamepadControls"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[" Automatic Animation"]}],
  RowBox[{"\"Animate a slider in this Demonstration by clicking the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJzzTSzJSM1NLMlMTlRwL0osyMhMLlZwyy8CCjEzMjAwcIKwAgOI/R/IhBKc\n\
/4EAyGAG0f+nTZsGwgysIJIRKsWKLAXGIHFmEpUgLADxWUAkI24jZs+eTaEt\n\
IG+wQKRmzJgBlYf5lhEA30OqWA=="], "Graphics", ImageSize -> {9, 9}, ImageMargins -> 
      0, CellBaseline -> Baseline], BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"button\\nnext to the slider, and then clicking the play button that \
appears.\\nAnimate all controls by selecting \"", 
    StyleBox["Autorun", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.679173633959469*^9},
 FontFamily->"Verdana",
 CellTags->"AutomaticAnimation"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Bookmark Animation"]}],
  RowBox[{
   "\"See a prepared animation of this Demonstration by selecting\\n\"", 
    StyleBox["Animate Bookmarks", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"BookmarkAnimation"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SearchTermsSection"],

Cell["McCabe-Thiele", "SearchTerms",
 CellChangeTimes->{{3.676485835516714*^9, 3.6764858376544237`*^9}, 
   3.679655474003722*^9, 3.6812323477120037`*^9},
 CellID->1540823896],

Cell["distillation", "SearchTerms",
 CellChangeTimes->{{3.6764858546888638`*^9, 3.676485855389348*^9}, {
  3.679655477543532*^9, 3.679655478133607*^9}},
 CellID->881704250],

Cell["separations", "SearchTerms",
 CellChangeTimes->{{3.676485858442082*^9, 3.6764858593483553`*^9}, {
  3.6796554571590257`*^9, 3.6796554813905163`*^9}},
 CellID->1806955628],

Cell["chemical engineering", "SearchTerms",
 CellChangeTimes->{{3.676485858442082*^9, 3.6764858593483553`*^9}, {
  3.6796554571590257`*^9, 3.679655488168081*^9}},
 CellID->274039471],

Cell["phase equilibrium", "SearchTerms",
 CellChangeTimes->{{3.676485858442082*^9, 3.6764858593483553`*^9}, {
  3.6796554571590257`*^9, 3.679655492205284*^9}},
 CellID->256725449]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "RelatedLinksSection"],

Cell[TextData[ButtonBox["McCabe & Thiele Graphical Method",
 BaseStyle->"Hyperlink",
 ButtonData->{
   URL["http://demonstrations.wolfram.com/McCabeThieleGraphicalMethod/"], 
   None},
 ButtonNote->
  "http://demonstrations.wolfram.com/McCabeThieleGraphicalMethod/"]], \
"RelatedLinks",
 CellChangeTimes->{{3.6791769453657017`*^9, 3.679176967385561*^9}},
 CellID->70716352]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "AuthorSection"],

Cell["Contributed by: Neil Hendren", "Author",
 CellChangeTimes->{3.6791736512483034`*^9, 3.6791769778452263`*^9}],

Cell[TextData[{
 "Additional contributions by: ",
 ButtonBox["Rachael L. Baumann",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=Rachael+L.+\
Baumann"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=Rachael+L.+Baumann"],
 ", ",
 ButtonBox["John L. Falconer",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=John+L.+\
Falconer"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=John+L.+Falconer"],
 ", and Thomas Belval"
}], "Author",
 CellChangeTimes->{{3.6791736529049067`*^9, 3.679173698861251*^9}, {
  3.679173744864237*^9, 3.6791737586000977`*^9}},
 CellID->377872580],

Cell["\<\
(University of Colorado Boulder, Department of Chemical and Biological \
Engineering)\
\>", "Author",
 CellChangeTimes->{{3.6791737377464213`*^9, 3.679173753097685*^9}},
 CellID->466519130]
}, Open  ]]
}, Open  ]]
},
WindowSize->{667, 670},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (April 11, 2016)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "Demonstration.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "ResizeImages"->{
  Cell[105168, 2437, 353, 9, 22, "ControlSuggestions",
   CellTags->"ResizeImages"]},
 "RotateAndZoomIn3D"->{
  Cell[105524, 2448, 678, 16, 22, "ControlSuggestions",
   CellTags->"RotateAndZoomIn3D"]},
 "DragLocators"->{
  Cell[106205, 2466, 340, 11, 22, "ControlSuggestions",
   CellTags->"DragLocators"]},
 "CreateAndDeleteLocators"->{
  Cell[106548, 2479, 637, 15, 22, "ControlSuggestions",
   CellTags->"CreateAndDeleteLocators"]},
 "SliderZoom"->{
  Cell[107188, 2496, 887, 22, 22, "ControlSuggestions",
   CellTags->"SliderZoom"]},
 "GamepadControls"->{
  Cell[108078, 2520, 395, 10, 22, "ControlSuggestions",
   CellTags->"GamepadControls"]},
 "AutomaticAnimation"->{
  Cell[108476, 2532, 1505, 32, 22, "ControlSuggestions",
   CellTags->"AutomaticAnimation"]},
 "BookmarkAnimation"->{
  Cell[109984, 2566, 908, 21, 22, "ControlSuggestions",
   CellTags->"BookmarkAnimation"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"ResizeImages", 113830, 2686},
 {"RotateAndZoomIn3D", 113940, 2689},
 {"DragLocators", 114051, 2692},
 {"CreateAndDeleteLocators", 114168, 2695},
 {"SliderZoom", 114283, 2698},
 {"GamepadControls", 114390, 2701},
 {"AutomaticAnimation", 114505, 2704},
 {"BookmarkAnimation", 114623, 2707}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 113, 1, 104, "DemoTitle"],
Cell[696, 25, 33, 0, 287, "InitializationSection"],
Cell[CellGroupData[{
Cell[754, 29, 29, 0, 192, "ManipulateSection"],
Cell[CellGroupData[{
Cell[808, 33, 65833, 1567, 4596, "Input",
 CellID->542361648],
Cell[66644, 1602, 30799, 624, 535, "Output",
 CellID->831347655]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[97492, 2232, 36, 0, 169, "ManipulateCaptionSection"],
Cell[97531, 2234, 1293, 31, 129, "ManipulateCaption"],
Cell[98827, 2267, 424, 7, 82, "ManipulateCaption",
 CellID->436798221]
}, Open  ]],
Cell[CellGroupData[{
Cell[99288, 2279, 28, 0, 173, "ThumbnailSection"],
Cell[99319, 2281, 1242, 34, 230, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100598, 2320, 28, 0, 143, "SnapshotsSection"],
Cell[100629, 2322, 1241, 34, 230, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[101907, 2361, 26, 0, 336, "DetailsSection"],
Cell[101936, 2363, 614, 10, 52, "DetailNotes",
 CellID->1224384310],
Cell[102553, 2375, 351, 5, 22, "DetailNotes",
 CellID->2068001857],
Cell[102907, 2382, 1990, 43, 135, "DetailNotes",
 CellID->1246656247],
Cell[104900, 2427, 191, 3, 22, "DetailNotes",
 CellID->274256776]
}, Open  ]],
Cell[CellGroupData[{
Cell[105128, 2435, 37, 0, 126, "ControlSuggestionsSection"],
Cell[105168, 2437, 353, 9, 22, "ControlSuggestions",
 CellTags->"ResizeImages"],
Cell[105524, 2448, 678, 16, 22, "ControlSuggestions",
 CellTags->"RotateAndZoomIn3D"],
Cell[106205, 2466, 340, 11, 22, "ControlSuggestions",
 CellTags->"DragLocators"],
Cell[106548, 2479, 637, 15, 22, "ControlSuggestions",
 CellTags->"CreateAndDeleteLocators"],
Cell[107188, 2496, 887, 22, 22, "ControlSuggestions",
 CellTags->"SliderZoom"],
Cell[108078, 2520, 395, 10, 22, "ControlSuggestions",
 CellTags->"GamepadControls"],
Cell[108476, 2532, 1505, 32, 22, "ControlSuggestions",
 CellTags->"AutomaticAnimation"],
Cell[109984, 2566, 908, 21, 22, "ControlSuggestions",
 CellTags->"BookmarkAnimation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110929, 2592, 30, 0, 155, "SearchTermsSection"],
Cell[110962, 2594, 175, 3, 22, "SearchTerms",
 CellID->1540823896],
Cell[111140, 2599, 172, 3, 22, "SearchTerms",
 CellID->881704250],
Cell[111315, 2604, 176, 3, 22, "SearchTerms",
 CellID->1806955628],
Cell[111494, 2609, 182, 3, 22, "SearchTerms",
 CellID->274039471],
Cell[111679, 2614, 179, 3, 22, "SearchTerms",
 CellID->256725449]
}, Open  ]],
Cell[CellGroupData[{
Cell[111895, 2622, 31, 0, 141, "RelatedLinksSection"],
Cell[111929, 2624, 373, 9, 22, "RelatedLinks",
 CellID->70716352]
}, Open  ]],
Cell[CellGroupData[{
Cell[112339, 2638, 25, 0, 141, "AuthorSection"],
Cell[112367, 2640, 114, 1, 22, "Author"],
Cell[112484, 2643, 750, 21, 22, "Author",
 CellID->377872580],
Cell[113237, 2666, 199, 5, 22, "Author",
 CellID->466519130]
}, Open  ]]
}, Open  ]]
}
]
*)

