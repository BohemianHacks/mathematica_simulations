(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    201776,       4515]
NotebookOptionsPosition[    197196,       4375]
NotebookOutlinePosition[    198819,       4426]
CellTagsIndexPosition[    198483,       4414]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["McCabe-Thiele Method for Methanol/Water Separation", "DemoTitle",
 CellChangeTimes->{3.6764830063076563`*^9}],

Cell[CellGroupData[{

Cell["", "InitializationSection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellID->229163725]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ManipulateSection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "ir", ",", "imax", ",", "it", ",", "xr", ",", "ys", ",", "yr", ",", 
       "xs", ",", "feed", ",", "plt0", ",", "pinch", ",", "xpinch", ",", 
       "ypinch", ",", "Rmin", ",", "R", ",", "OpRect", ",", "OpStrp", ",", 
       "inters", ",", "xinters", ",", "yinters", ",", "plt4", ",", "plt5", 
       ",", "plt6", ",", "plt7", ",", "rstagelbl", ",", "sstagelbl", ",", 
       "reboilerlbl", ",", "v", ",", "i", ",", "tbl1", ",", "tbl2", ",", 
       "tbl3", ",", "bottomsconc", ",", "distilconc", ",", "xblabel", ",", 
       "xdlabel", ",", "tbl4", ",", "tblih", ",", "tbliv", ",", "feedstate", 
       ",", "distflow", ",", "botflow", ",", "stagelines", ",", "feedline", 
       ",", "stagelabels", ",", "zlbl", ",", "legend"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Constants", " ", "needed", " ", "for", " ", "calculation", " ", "of", 
       " ", "equilibrium", " ", "curve"}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"zf", "=", ".5"}], ";", "\[IndentingNewLine]", 
      RowBox[{"q", "=", ".5"}], ";", "\[IndentingNewLine]", 
      RowBox[{"mve", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"P", "=", "760"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AMet", "=", "8.08097"}], ";", "\[IndentingNewLine]", 
      RowBox[{"BMet", "=", "1582.271"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CMet", "=", "239.726"}], ";", "\[IndentingNewLine]", 
      RowBox[{"VPMet", "=", 
       SuperscriptBox["10", 
        RowBox[{"AMet", "-", 
         FractionBox["BMet", 
          RowBox[{"CMet", "+", "T"}]]}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"VPWat", "=", 
       SuperscriptBox["10", 
        RowBox[{"AWat", "-", 
         FractionBox["BWat", 
          RowBox[{"CWat", "+", "T"}]]}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AWat", "=", "8.07131"}], ";", "\[IndentingNewLine]", 
      RowBox[{"BWat", "=", "1730.63"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CWat", "=", "233.426"}], ";", "\[IndentingNewLine]", 
      RowBox[{"A12", "=", ".5434"}], ";", "\[IndentingNewLine]", 
      RowBox[{"A21", "=", ".7923"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Activity", " ", "coefficient", " ", "calculation", " ", "for", " ", 
        "equilibrium", " ", "curve"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Gamma]1", "[", "i_", "]"}], "=", 
       RowBox[{"Exp", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"x2", "[", "i", "]"}], "2"], "*", 
         RowBox[{"(", 
          RowBox[{"A12", "+", 
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"A21", "-", "A12"}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"x2", "[", "i", "]"}]}], ")"}]}]}], ")"}]}], "]"}]}], 
      ";", " ", 
      RowBox[{
       RowBox[{"\[Gamma]2", "[", "i_", "]"}], "=", 
       RowBox[{"Exp", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"x2", "[", "i", "]"}]}], ")"}], "2"], "*", 
         RowBox[{"(", 
          RowBox[{"A21", "+", 
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"A12", "-", "A21"}], ")"}], "*", 
            RowBox[{"x2", "[", "i", "]"}]}]}], ")"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Iteration", " ", "to", " ", "creat", " ", "curve"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"i", "<", "101"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"x2", "[", "i", "]"}], "=", 
           RowBox[{"i", " ", "0.01"}]}], ",", 
          RowBox[{
           RowBox[{"T", "[", "i", "]"}], "=", 
           RowBox[{
            RowBox[{"FindRoot", "[", 
             RowBox[{
              RowBox[{"P", "\[Equal]", " ", 
               RowBox[{
                RowBox[{"VPWat", " ", "*", 
                 RowBox[{"\[Gamma]1", "[", "i", "]"}], "*", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"x2", "[", "i", "]"}]}], ")"}]}], "+", 
                RowBox[{"VPMet", "*", 
                 RowBox[{"\[Gamma]2", "[", "i", "]"}], " ", "*", 
                 RowBox[{"x2", "[", "i", "]"}]}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"T", ",", "60"}], "}"}], ",", 
              RowBox[{"AccuracyGoal", "\[Rule]", " ", "5"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"y2", "[", "i", "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"x2", "[", "i", "]"}], "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"VPMet", "*", " ", 
                   RowBox[{"\[Gamma]2", "[", "i", "]"}], "*", " ", 
                   RowBox[{
                    RowBox[{"x2", "[", "i", "]"}], "/", "P"}]}], ")"}], "-", 
                 RowBox[{"x2", "[", "i", "]"}]}], ")"}], "*", "mve"}], 
              ")"}]}], "/.", 
            RowBox[{"T", "\[Rule]", " ", 
             RowBox[{"T", "[", "i", "]"}]}]}]}], ",", 
          RowBox[{"i", "++"}]}], "}"}]}], "]"}], ";", "\n", 
      RowBox[{"tb", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x2", "[", "i", "]"}], ",", 
           RowBox[{"y2", "[", "i", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "100"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"equilb", "=", 
       RowBox[{"Interpolation", "[", "tb", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Extra", " ", "equation", " ", "to", " ", "incorporate", " ", 
        "murphree", " ", "vapor", " ", "efficiency", " ", "if", " ", 
        "desired"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"equilb2", "[", "m_", "]"}], "=", 
       RowBox[{"m", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"equilb", "[", "m", "]"}], "-", "m"}], ")"}], "*", 
         FractionBox["1", "mve"]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Feed", " ", "line"}], ",", " ", 
        RowBox[{"operating", " ", "lines"}], ",", " ", 
        RowBox[{
        "and", " ", "mass", " ", "balances", " ", "get", " ", "calculated", 
         " ", "here"}]}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"feed", "[", "x_", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"q", "\[NotEqual]", "1"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q", " ", 
            RowBox[{"x", "/", 
             RowBox[{"(", 
              RowBox[{"q", "-", "1"}], ")"}]}]}], "-", 
           RowBox[{"zf", "/", 
            RowBox[{"(", 
             RowBox[{"q", "-", "1"}], ")"}]}]}], ")"}], ",", 
         RowBox[{
          RowBox[{"1000000", 
           RowBox[{"(", 
            RowBox[{"x", "-", "zf"}], ")"}]}], "+", "zf"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plt0", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"equilb2", "[", "x", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
           "\"\<liquid mole fraction (\!\(\*SubscriptBox[\(x\), \(met\)]\))\>\
\"", ",", 
            "\"\<vapor mole fraction (\!\(\*SubscriptBox[\(y\), \(met\)]\))\>\
\""}], "}"}]}], ",", 
         RowBox[{"LabelStyle", "\[Rule]", "12"}], ",", 
         RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
         RowBox[{"AxesOrigin", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pinch", "=", 
       RowBox[{"Quiet", "[", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"feed", "[", "x", "]"}], "\[Equal]", " ", 
           RowBox[{"equilb2", "[", "x", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0.5"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xpinch", "=", 
       RowBox[{"pinch", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"ypinch", "=", 
       RowBox[{"feed", "[", "xpinch", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"opertRect", "[", "x_", "]"}], ":=", 
       RowBox[{"ypinch", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x", "-", "xpinch"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"xd", "-", "xpinch"}], ")"}]}], " ", 
         RowBox[{"(", 
          RowBox[{"xd", "-", "ypinch"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"opertStrp", "[", "x_", "]"}], ":=", 
       RowBox[{"ypinch", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x", "-", "xpinch"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"xb", "-", "xpinch"}], ")"}]}], " ", 
         RowBox[{"(", 
          RowBox[{"xb", "-", "ypinch"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Rmin", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"xd", "-", "ypinch"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"xd", "-", "xpinch"}], ")"}]}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"xd", "-", "ypinch"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"xd", "-", "xpinch"}], ")"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"R", "=", "lvmult"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"OpRect", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"R", "/", 
          RowBox[{"(", 
           RowBox[{"R", "+", "1"}], ")"}]}], " ", "x"}], "+", 
        RowBox[{"xd", "/", 
         RowBox[{"(", 
          RowBox[{"R", "+", "1"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"inters", "=", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"feed", "[", "x", "]"}], "\[Equal]", " ", 
          RowBox[{"OpRect", "[", "x", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0.7"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xinters", "=", 
       RowBox[{"inters", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"yinters", "=", 
       RowBox[{"OpRect", "[", "xinters", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "This", " ", "statement", " ", "plots", " ", "a", " ", 
        "\"\<pinch point\>\"", " ", "graph", " ", "if", " ", "the", " ", 
        "input", " ", "parameters", " ", "are", " ", "unreasonable"}], "*)"}],
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"yinters", "\[GreaterEqual]", 
         RowBox[{"equilb", "[", "xinters", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"OpStrp", "[", "x_", "]"}], ":=", 
          RowBox[{"opertStrp", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"plt4", "=", 
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"opertRect", "[", "x", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "xpinch", ",", "xd"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "1", ",", "1"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"plt5", "=", 
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"opertStrp", "[", "x", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "xb", ",", "xpinch"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"1", ",", "0", ",", "1"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"plt6", "=", 
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"feed", "[", "x", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "xpinch", ",", "zf"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"plt7", "=", 
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"equilb", "[", "m", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "0", ",", "1"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"RGBColor", "[", 
                RowBox[{".5", ",", ".5", ",", ".5"}], "]"}], ",", " ", 
               "Dashed"}], "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"yr", "[", "0", "]"}], "=", "xd"}], ";", 
         RowBox[{
          RowBox[{"xr", "[", "0", "]"}], "=", "xd"}], ";", 
         RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{"i", "<", "25"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"v", "=", 
              RowBox[{
               RowBox[{"Quiet", "[", 
                RowBox[{"FindRoot", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"yr", "[", "i", "]"}], "\[Equal]", " ", 
                   RowBox[{"equilb", "[", "u", "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"u", ",", "0.5"}], "}"}]}], "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
             RowBox[{"t", "=", 
              RowBox[{"opertRect", "[", "v", "]"}]}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"v", ">", "xpinch"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"xr", "[", 
                   RowBox[{"i", "+", "1"}], "]"}], "=", "v"}], ",", 
                 RowBox[{
                  RowBox[{"yr", "[", 
                   RowBox[{"i", "+", "1"}], "]"}], "=", "t"}]}], "}"}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"i", "++"}]}], "}"}]}], "]"}], ";", 
         RowBox[{"ir", "=", 
          RowBox[{"i", "-", "1"}]}], ";", 
         RowBox[{"i", "=", "0"}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ir", "\[GreaterEqual]", " ", "0"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"ys", "[", "0", "]"}], "=", 
             RowBox[{"yr", "[", "ir", "]"}]}], ";", 
            RowBox[{
             RowBox[{"xs", "[", "0", "]"}], "=", 
             RowBox[{"xr", "[", "ir", "]"}]}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{"i", "<", "20"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"v", "=", 
              RowBox[{
               RowBox[{"Quiet", "[", 
                RowBox[{"FindRoot", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ys", "[", "i", "]"}], "\[Equal]", " ", 
                   RowBox[{"equilb", "[", "u", "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"u", ",", "0.5"}], "}"}]}], "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
             RowBox[{"t", "=", 
              RowBox[{"opertStrp", "[", "v", "]"}]}], ",", 
             RowBox[{
              RowBox[{"xs", "[", 
               RowBox[{"i", "+", "1"}], "]"}], "=", "v"}], ",", 
             RowBox[{
              RowBox[{"ys", "[", 
               RowBox[{"i", "+", "1"}], "]"}], "=", "t"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"i", "++"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"imax", "=", 
          RowBox[{"i", "-", "1"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tbl1", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xr", "[", "i", "]"}], ",", 
                 RowBox[{"yr", "[", 
                  RowBox[{"i", "-", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xr", "[", "i", "]"}], ",", 
                 RowBox[{"yr", "[", "i", "]"}]}], "}"}]}], "}"}], "]"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "ir"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tbl2", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ir", "\[GreaterEqual]", " ", "1"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"xr", "[", "i", "]"}], ",", 
                   RowBox[{"yr", "[", "i", "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"xr", "[", 
                    RowBox[{"i", "+", "1"}], "]"}], ",", 
                   RowBox[{"yr", "[", "i", "]"}]}], "}"}]}], "}"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", 
                RowBox[{"ir", "-", "1"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"xr", "[", "i", "]"}], ",", 
                   RowBox[{"yr", "[", "i", "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"xr", "[", 
                    RowBox[{"i", "+", "1"}], "]"}], ",", 
                   RowBox[{"yr", "[", "i", "]"}]}], "}"}]}], "}"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", "0"}], "}"}]}], "]"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"tbl3", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xs", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"ys", "[", "i", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xs", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"ys", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", 
              RowBox[{"imax", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tbl4", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xs", "[", 
                  RowBox[{"i", "-", "1"}], "]"}], ",", 
                 RowBox[{"ys", "[", 
                  RowBox[{"i", "-", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xs", "[", "i", "]"}], ",", 
                 RowBox[{"ys", "[", 
                  RowBox[{"i", "-", "1"}], "]"}]}], "}"}]}], "}"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"imax", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tblih", "=", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xs", "[", "1", "]"}], ",", 
               RowBox[{"ys", "[", "0", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xr", "[", "ir", "]"}], ",", 
               RowBox[{"ys", "[", "0", "]"}]}], "}"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tbliv", "=", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xs", "[", "1", "]"}], ",", 
               RowBox[{"ys", "[", "0", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xs", "[", "1", "]"}], ",", 
               RowBox[{"ys", "[", "1", "]"}]}], "}"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"xblabel", "=", 
          RowBox[{"{", 
           RowBox[{"White", ",", 
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"xs", "[", 
                  RowBox[{"imax", "+", "1"}], "]"}], "+", ".045"}], ",", 
                "0.025"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"xs", "[", 
                  RowBox[{"imax", "+", "1"}], "]"}], "+", ".215"}], ",", 
                "0.085"}], "}"}]}], "]"}], ",", "Black", ",", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(x\), \(b\)]\)= \>\"", " ", "<>", 
                 " ", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"SetPrecision", "[", 
                   RowBox[{
                    RowBox[{"xs", "[", 
                    RowBox[{"imax", "+", "1"}], "]"}], ",", "2"}], "]"}], 
                  "]"}], "<>", "\"\<\>\""}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"xs", "[", 
                    RowBox[{"imax", "+", "1"}], "]"}], "+", ".135"}], ",", 
                  "0.05"}], "}"}]}], "]"}], ",", "12"}], "]"}]}], "}"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"xdlabel", "=", 
          RowBox[{"Graphics", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(x\), \(d\)]\)= \>\"", " ", "<>", 
                 " ", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"SetPrecision", "[", 
                   RowBox[{
                    RowBox[{"xr", "[", "0", "]"}], ",", "2"}], "]"}], "]"}], 
                 "<>", "\"\<\>\""}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"xr", "[", "0", "]"}], "-", ".1"}], ",", "0.05"}], 
                 "}"}]}], "]"}], ",", "12"}], "]"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"15", ",", "13"}], "}"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"zlbl", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{".5", ",", ".5"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{".5", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
              "Dashed"}], "]"}], ",", "White", ",", 
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{".45", ",", ".11"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{".55", ",", ".19"}], "}"}]}], "]"}], ",", "Black", ",", 
            RowBox[{"Text", "[", 
             RowBox[{"\"\<\!\(\*SubscriptBox[\(z\), \(f\)]\)= 0.5\>\"", ",", 
              RowBox[{"{", 
               RowBox[{".5", ",", ".15"}], "}"}]}], "]"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"PaneSelector", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"yinters", "<", 
                 RowBox[{"equilb", "[", "xinters", "]"}]}], ",", 
                RowBox[{"GraphicsRow", "[", 
                 RowBox[{
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Show", "[", 
                    RowBox[{
                    "plt0", ",", "plt6", ",", "plt4", ",", "plt5", ",", 
                    "rstagelbl", ",", "sstagelbl", ",", "bottomsconc", ",", 
                    "distilconc", ",", "xdlabel", ",", 
                    RowBox[{"Graphics", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "tbl1", ",", "tbl2", ",", "tbl3", ",", "tbl4", ",", 
                    "tblih", ",", "tbliv", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0", ",", "1", ",", "0"}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "]"}]}], "}"}]}],
                     "}"}], "]"}], ",", 
                    RowBox[{"PlotLabel", "\[Rule]", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<equilibrium stages needed = \>\"", "<>", 
                    RowBox[{"ToString", "[", "it", "]"}], "<>", 
                    "\"\< (including reboiler)\>\""}], "}"}], "]"}], ",", 
                    "12"}], "]"}]}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"330", ",", "300"}], "}"}]}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
                    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
                    RowBox[{"Epilog", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"xblabel", ",", "reboilerlbl", ",", "zlbl"}], 
                    "}"}]}]}], "]"}], ",", 
                    RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EdgeForm", "[", 
                    RowBox[{"{", 
                    RowBox[{"Black", ",", "Thick"}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", "White", ",", 
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"35", ",", "20"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"65", ",", "90"}], "}"}]}], "]"}], ",", "Black", 
                    ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"10", ",", 
                    RowBox[{"20", "+", 
                    FractionBox[
                    RowBox[{"70", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "imax"}], "+", "1"}], ")"}]}], 
                    RowBox[{"2", "*", "it"}]]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", 
                    RowBox[{"20", "+", 
                    FractionBox[
                    RowBox[{"70", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "imax"}], "+", "1"}], ")"}]}], 
                    RowBox[{"2", "*", "it"}]]}]}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"50", ",", "90"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "100"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"50", ",", "100"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"80", ",", "100"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"80", ",", "100"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"80", ",", "90"}], "}"}]}], "}"}], "]"}], ",", 
                    "White", ",", 
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"75", ",", "80"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"85", ",", "90"}], "}"}]}], "]"}], ",", "Black", 
                    ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"60", ",", "20"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"60", ",", "10"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"55", ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"45", ",", "5"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"45", ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"45", ",", "20"}], "}"}]}], "}"}], "]"}], ",", 
                    "White", ",", 
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"55", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"65", ",", "10"}], "}"}]}], "]"}], ",", "Black", 
                    ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"75", ",", "85"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"65", ",", "85"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"85", ",", "85"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"100", ",", "85"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"65", ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"100", ",", "5"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Feed rate: \\n1 kmol \!\(\*SuperscriptBox[\(h\), \
\(-1\)]\)\>\"", ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"23", ",", 
                    RowBox[{"12.5", "+", 
                    FractionBox[
                    RowBox[{"70", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "imax"}], "+", "1"}], ")"}]}], 
                    RowBox[{"2", "*", "it"}]]}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<\!\(\*SubscriptBox[\(z\), \(f\)]\): \>\"", "<>", 
                    RowBox[{"ToString", "[", "zf", "]"}], "<>", "\"\<\>\""}], 
                    ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"23", ",", 
                    RowBox[{"33", "+", 
                    FractionBox[
                    RowBox[{"70", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "imax"}], "+", "1"}], ")"}]}], 
                    RowBox[{"2", "*", "it"}]]}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<quality: \>\"", "<>", 
                    RowBox[{"ToString", "[", "q", "]"}], "<>", "\"\<\>\""}], 
                    ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"23", ",", 
                    RowBox[{"28", "+", 
                    FractionBox[
                    RowBox[{"70", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "imax"}], "+", "1"}], ")"}]}], 
                    RowBox[{"2", "*", "it"}]]}]}], "}"}]}], "]"}], ",", 
                    "feedstate", ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<distillate flow: \\n\>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{"distflow", ",", "2"}], "]"}], "]"}], "<>", 
                    "\"\< kmol \!\(\*SuperscriptBox[\(h\), \(-1\)]\)\>\""}], 
                    ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"95", ",", "96.5"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<bottoms flow: \\n\>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{"botflow", ",", "2"}], "]"}], "]"}], "<>", 
                    "\"\< kmol \!\(\*SuperscriptBox[\(h\), \(-1\)]\)\>\""}], 
                    ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"94", ",", "12"}], "}"}]}], "]"}], ",", 
                    "stagelines", ",", "stagelabels", ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<R\>\"", ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"60", ",", "5"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<C\>\"", ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"80", ",", "85"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{
                    "\"\<reflux ratio (\!\(\*FractionBox[\(L\), \(D\)]\)): \>\
\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{"R", ",", "3"}], "]"}], "]"}], "<>", "\"\<\>\""}],
                     ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"86", ",", "71"}], "}"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"10", ",", "107"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "107"}], "}"}]}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"280", ",", "300"}], "}"}]}]}], "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"Spacings", "\[Rule]", 
                   RowBox[{"-", "35"}]}], ",", 
                  RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"GraphicsRow", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Show", "[", 
                    RowBox[{
                    "plt0", ",", "plt6", ",", "plt4", ",", "plt5", ",", 
                    RowBox[{"Graphics", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "tbl1", ",", "tbl2", ",", "tblih", ",", "tbliv", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0", ",", "1", ",", "0"}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "]"}]}], "}"}]}],
                     "}"}], "]"}], ",", 
                    RowBox[{"PlotLabel", "\[Rule]", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{
                    "{", "\"\<equilibrium stages needed = infinite (pinch \
point)\>\"", "}"}], "]"}], ",", "12"}], "]"}]}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"330", ",", "300"}], "}"}]}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
                    RowBox[{"PlotRangePadding", "\[Rule]", "None"}]}], "]"}], 
                    ",", 
                    RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EdgeForm", "[", 
                    RowBox[{"{", 
                    RowBox[{"Black", ",", "Thick"}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", "White", ",", 
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"35", ",", "20"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"65", ",", "90"}], "}"}]}], "]"}], ",", "Black", 
                    ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"10", ",", "50"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "50"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"50", ",", "90"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "100"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"50", ",", "100"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"80", ",", "100"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"80", ",", "100"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"80", ",", "90"}], "}"}]}], "}"}], "]"}], ",", 
                    "White", ",", 
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"75", ",", "80"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"85", ",", "90"}], "}"}]}], "]"}], ",", "Black", 
                    ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"60", ",", "20"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"60", ",", "10"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"55", ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"45", ",", "5"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"45", ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"45", ",", "20"}], "}"}]}], "}"}], "]"}], ",", 
                    "White", ",", 
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"55", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"65", ",", "10"}], "}"}]}], "]"}], ",", "Black", 
                    ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"75", ",", "85"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"65", ",", "85"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"85", ",", "85"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"100", ",", "85"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"65", ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"100", ",", "5"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Feed rate: \\n1 kmol \!\(\*SuperscriptBox[\(h\), \
\(-1\)]\)\>\"", ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"23", ",", "42.5"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<\!\(\*SubscriptBox[\(z\), \(f\)]\): \>\"", "<>", 
                    RowBox[{"ToString", "[", "zf", "]"}], "<>", "\"\<\>\""}], 
                    ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"23", ",", "63"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<quality: \>\"", "<>", 
                    RowBox[{"ToString", "[", "q", "]"}], "<>", "\"\<\>\""}], 
                    ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"23", ",", "58"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<VLE\>\"", ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"23", ",", "53"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<distillate flow: \\n N/A kmol \
\!\(\*SuperscriptBox[\(h\), \(-1\)]\)\>\"", ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"95", ",", "96.5"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<bottoms flow: \\n N/A kmol \
\!\(\*SuperscriptBox[\(h\), \(-1\)]\)\>\"", ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"94", ",", "12"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<R\>\"", ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"60", ",", "5"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<C\>\"", ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"80", ",", "85"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{
                    "\"\<reflux ratio (\!\(\*FractionBox[\(L\), \(D\)]\)): \>\
\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{"R", ",", "3"}], "]"}], "]"}], "<>", "\"\<\>\""}],
                     ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"86", ",", "71"}], "}"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"10", ",", "107"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "107"}], "}"}]}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"280", ",", "300"}], "}"}]}]}], "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"Spacings", "\[Rule]", 
                   RowBox[{"-", "35"}]}], ",", 
                  RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], 
               "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"2", "\[Rule]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"yinters", "<", 
                 RowBox[{"equilb", "[", "xinters", "]"}]}], ",", 
                RowBox[{"Show", "[", 
                 RowBox[{
                 "plt0", ",", "plt6", ",", "plt4", ",", "plt5", ",", 
                  "rstagelbl", ",", "sstagelbl", ",", "bottomsconc", ",", 
                  "distilconc", ",", "xdlabel", ",", 
                  RowBox[{"Graphics", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "tbl1", ",", "tbl2", ",", "tbl3", ",", "tbl4", ",", 
                    "tblih", ",", "tbliv", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0", ",", "1", ",", "0"}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "]"}]}], "}"}]}],
                     "}"}], "]"}], ",", 
                  RowBox[{"PlotLabel", "\[Rule]", 
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<equilibrium stages needed = \>\"", "<>", 
                    RowBox[{"ToString", "[", "it", "]"}], "<>", 
                    "\"\< (including reboiler)\>\""}], "}"}], "]"}], ",", 
                    "14"}], "]"}]}], ",", 
                  RowBox[{"ImageSize", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"550", ",", "400"}], "}"}]}], ",", 
                  RowBox[{"Placed", "\[Rule]", "Center"}], ",", 
                  RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
                  RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
                  RowBox[{"Epilog", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"xblabel", ",", "reboilerlbl", ",", "zlbl"}], 
                    "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Show", "[", 
                 RowBox[{"plt0", ",", "plt6", ",", "plt4", ",", "plt5", ",", 
                  RowBox[{"Graphics", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "tbl1", ",", "tbl2", ",", "tblih", ",", "tbliv", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0", ",", "1", ",", "0"}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "]"}]}], "}"}]}],
                     "}"}], "]"}], ",", 
                  RowBox[{"PlotLabel", "\[Rule]", 
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{
                    "{", "\"\<equilibrium stages needed = infinite (pinch \
point)\>\"", "}"}], "]"}], ",", "14"}], "]"}]}], ",", 
                  RowBox[{"ImageSize", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"550", ",", "400"}], "}"}]}], ",", 
                  RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
                  RowBox[{"Placed", "\[Rule]", "Center"}], ",", 
                  RowBox[{"PlotRangePadding", "\[Rule]", "None"}]}], "]"}]}], 
               "]"}]}]}], "}"}], ",", "window"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"OpStrp", "[", "x_", "]"}], ":=", 
          RowBox[{"yinters", "+", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"x", "-", "xinters"}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"xb", "-", "xinters"}], ")"}]}], " ", 
            RowBox[{"(", 
             RowBox[{"xb", "-", "yinters"}], ")"}]}]}]}], ";", 
         RowBox[{"plt4", "=", 
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"OpRect", "[", "x", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "xinters", ",", "xd"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "1", ",", "1"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"plt5", "=", 
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"OpStrp", "[", "x", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "xb", ",", "xinters"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"1", ",", "0", ",", "1"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"plt6", "=", 
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"feed", "[", "x", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "xinters", ",", "zf"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "0", ",", "1"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"plt7", "=", 
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"equilb", "[", "m", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "0", ",", "1"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"RGBColor", "[", 
                RowBox[{".5", ",", ".5", ",", ".5"}], "]"}], ",", " ", 
               "Dashed"}], "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"yr", "[", "0", "]"}], "=", "xd"}], ";", 
         RowBox[{
          RowBox[{"xr", "[", "0", "]"}], "=", "xd"}], ";", 
         RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"xr", "[", "i", "]"}], ">", "xinters"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"v", "=", 
              RowBox[{
               RowBox[{"Quiet", "[", 
                RowBox[{"FindRoot", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"yr", "[", "i", "]"}], "\[Equal]", " ", 
                   RowBox[{"equilb", "[", "u", "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"u", ",", "0.7"}], "}"}]}], "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
             RowBox[{"t", "=", 
              RowBox[{"OpRect", "[", "v", "]"}]}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"v", ">", "xinters"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"xr", "[", 
                   RowBox[{"i", "+", "1"}], "]"}], "=", "v"}], ",", 
                 RowBox[{
                  RowBox[{"yr", "[", 
                   RowBox[{"i", "+", "1"}], "]"}], "=", "t"}]}], "}"}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"i", "++"}]}], "}"}]}], "]"}], ";", 
         RowBox[{"ir", "=", 
          RowBox[{"i", "-", "1"}]}], ";", 
         RowBox[{"i", "=", "0"}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ir", "\[GreaterEqual]", " ", "0"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"ys", "[", "0", "]"}], "=", 
             RowBox[{"yr", "[", "ir", "]"}]}], ";", 
            RowBox[{
             RowBox[{"xs", "[", "0", "]"}], "=", 
             RowBox[{"xr", "[", "ir", "]"}]}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"xs", "[", "i", "]"}], ">", "xb"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"v", "=", 
              RowBox[{
               RowBox[{"Quiet", "[", 
                RowBox[{"FindRoot", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ys", "[", "i", "]"}], "\[Equal]", " ", 
                   RowBox[{"equilb", "[", "u", "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"u", ",", "0.5"}], "}"}]}], "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
             RowBox[{"t", "=", 
              RowBox[{"OpStrp", "[", "v", "]"}]}], ",", 
             RowBox[{
              RowBox[{"xs", "[", 
               RowBox[{"i", "+", "1"}], "]"}], "=", "v"}], ",", 
             RowBox[{
              RowBox[{"ys", "[", 
               RowBox[{"i", "+", "1"}], "]"}], "=", "t"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"i", "++"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"imax", "=", 
          RowBox[{"i", "-", "1"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tbl1", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xr", "[", "i", "]"}], ",", 
                 RowBox[{"yr", "[", 
                  RowBox[{"i", "-", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xr", "[", "i", "]"}], ",", 
                 RowBox[{"yr", "[", "i", "]"}]}], "}"}]}], "}"}], "]"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "ir"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tbl2", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ir", "\[GreaterEqual]", " ", "1"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"xr", "[", "i", "]"}], ",", 
                   RowBox[{"yr", "[", "i", "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"xr", "[", 
                    RowBox[{"i", "+", "1"}], "]"}], ",", 
                   RowBox[{"yr", "[", "i", "]"}]}], "}"}]}], "}"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", 
                RowBox[{"ir", "-", "1"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"xr", "[", "i", "]"}], ",", 
                   RowBox[{"yr", "[", "i", "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"xr", "[", 
                    RowBox[{"i", "+", "1"}], "]"}], ",", 
                   RowBox[{"yr", "[", "i", "]"}]}], "}"}]}], "}"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", "0"}], "}"}]}], "]"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"tbl3", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xs", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"ys", "[", "i", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xs", "[", 
                  RowBox[{"i", "+", "1"}], "]"}], ",", 
                 RowBox[{"ys", "[", 
                  RowBox[{"i", "+", "1"}], "]"}]}], "}"}]}], "}"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", 
              RowBox[{"imax", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"bottomsconc", "=", 
          RowBox[{"Graphics", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"xs", "[", 
                   RowBox[{"imax", "+", "1"}], "]"}], ",", 
                  RowBox[{"ys", "[", "imax", "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"xs", "[", 
                   RowBox[{"imax", "+", "1"}], "]"}], ",", "0"}], "}"}]}], 
               "}"}], "]"}], ",", "Dashed"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"xblabel", "=", 
          RowBox[{"{", 
           RowBox[{"White", ",", 
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"xs", "[", 
                  RowBox[{"imax", "+", "1"}], "]"}], "+", ".045"}], ",", 
                "0.025"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"xs", "[", 
                  RowBox[{"imax", "+", "1"}], "]"}], "+", ".215"}], ",", 
                "0.085"}], "}"}]}], "]"}], ",", "Black", ",", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(x\), \(b\)]\)= \>\"", " ", "<>", 
                 " ", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"SetPrecision", "[", 
                   RowBox[{
                    RowBox[{"xs", "[", 
                    RowBox[{"imax", "+", "1"}], "]"}], ",", "2"}], "]"}], 
                  "]"}], "<>", "\"\<\>\""}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"xs", "[", 
                    RowBox[{"imax", "+", "1"}], "]"}], "+", ".135"}], ",", 
                  "0.05"}], "}"}]}], "]"}], ",", "12"}], "]"}]}], "}"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"xdlabel", "=", 
          RowBox[{"Graphics", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(x\), \(d\)]\)= \>\"", " ", "<>", 
                 " ", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"SetPrecision", "[", 
                   RowBox[{
                    RowBox[{"xr", "[", "0", "]"}], ",", "2"}], "]"}], "]"}], 
                 "<>", "\"\<\>\""}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"xr", "[", "0", "]"}], "-", ".1"}], ",", "0.05"}], 
                 "}"}]}], "]"}], ",", "12"}], "]"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"15", ",", "13"}], "}"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"distilconc", "=", 
          RowBox[{"Graphics", "[", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"xr", "[", "0", "]"}], ",", 
                  RowBox[{"yr", "[", "0", "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"xr", "[", "0", "]"}], ",", "0"}], "}"}]}], "}"}], 
              "]"}], ",", "Dashed"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tbl4", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xs", "[", 
                  RowBox[{"i", "-", "1"}], "]"}], ",", 
                 RowBox[{"ys", "[", 
                  RowBox[{"i", "-", "1"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"xs", "[", "i", "]"}], ",", 
                 RowBox[{"ys", "[", 
                  RowBox[{"i", "-", "1"}], "]"}]}], "}"}]}], "}"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"imax", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tblih", "=", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xs", "[", "1", "]"}], ",", 
               RowBox[{"ys", "[", "0", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xr", "[", "ir", "]"}], ",", 
               RowBox[{"ys", "[", "0", "]"}]}], "}"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tbliv", "=", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xs", "[", "1", "]"}], ",", 
               RowBox[{"ys", "[", "0", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xs", "[", "1", "]"}], ",", 
               RowBox[{"ys", "[", "1", "]"}]}], "}"}]}], "}"}], "]"}]}], ";", 
         
         RowBox[{"it", "=", 
          RowBox[{"imax", "+", "ir", "+", "1"}]}], ";", 
         RowBox[{"rstagelbl", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Graphics", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"Text", "[", 
                 RowBox[{
                  RowBox[{"\"\<\>\"", " ", "<>", " ", 
                   RowBox[{"ToString", "[", 
                    RowBox[{"ir", "+", "1", "+", "imax", "-", "f"}], "]"}], 
                   " ", "<>", " ", "\"\<\>\""}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"xr", "[", "f", "]"}], "-", ".0125"}], ",", 
                    RowBox[{
                    RowBox[{"yr", "[", 
                    RowBox[{"f", "-", "1"}], "]"}], "+", ".015"}]}], "}"}]}], 
                 "]"}], ",", "12"}], "]"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"20", ",", "10"}], "}"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"f", ",", "1", ",", "ir"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"sstagelbl", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Graphics", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"Text", "[", 
                 RowBox[{
                  RowBox[{"\"\<\>\"", " ", "<>", " ", 
                   RowBox[{"ToString", "[", 
                    RowBox[{"imax", "+", "1", "-", "f"}], "]"}], " ", "<>", 
                   " ", "\"\<\>\""}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"xs", "[", "f", "]"}], "-", ".0125"}], ",", 
                    RowBox[{
                    RowBox[{"ys", "[", 
                    RowBox[{"f", "-", "1"}], "]"}], "+", ".02"}]}], "}"}]}], 
                 "]"}], ",", "12"}], "]"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"20", ",", "10"}], "}"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"f", ",", "1", ",", "imax"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"reboilerlbl", "=", 
          RowBox[{"{", 
           RowBox[{"White", ",", 
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"xs", "[", 
                  RowBox[{"imax", "+", "1"}], "]"}], "-", ".015"}], ",", 
                RowBox[{"ys", "[", "imax", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"xs", "[", 
                  RowBox[{"imax", "+", "1"}], "]"}], "+", ".015"}], ",", 
                RowBox[{
                 RowBox[{"ys", "[", "imax", "]"}], "+", ".045"}]}], "}"}]}], 
             "]"}], ",", "Black", ",", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{"\"\<R\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"xs", "[", 
                   RowBox[{"imax", "+", "1"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"ys", "[", "imax", "]"}], "+", ".025"}]}], "}"}]}],
                "]"}], ",", "12"}], "]"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"feedstate", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"q", "<", "0"}], ",", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<subcooled liquid\>\"", ",", "10"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"23", ",", 
                RowBox[{"23", "+", 
                 FractionBox[
                  RowBox[{"70", "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "imax"}], "+", "1"}], ")"}]}], 
                  RowBox[{"2", "*", "it"}]]}]}], "}"}]}], "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"q", "==", "0"}], ",", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<saturated liquid\>\"", ",", "10"}], "]"}], ",", 
                
                RowBox[{"{", 
                 RowBox[{"23", ",", 
                  RowBox[{"23", "+", 
                   FractionBox[
                    RowBox[{"70", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "imax"}], "+", "1"}], ")"}]}], 
                    RowBox[{"2", "*", "it"}]]}]}], "}"}]}], "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"0", "<", "q", "<", "1"}], ",", 
                RowBox[{"Text", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<VLE\>\"", ",", "12"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"23", ",", 
                    RowBox[{"23", "+", 
                    FractionBox[
                    RowBox[{"70", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "imax"}], "+", "1"}], ")"}]}], 
                    RowBox[{"2", "*", "it"}]]}]}], "}"}]}], "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"q", "==", "1"}], ",", 
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<saturated vapor\>\"", ",", "10"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"23", ",", 
                    RowBox[{"23", "+", 
                    FractionBox[
                    RowBox[{"70", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "imax"}], "+", "1"}], ")"}]}], 
                    RowBox[{"2", "*", "it"}]]}]}], "}"}]}], "]"}], ",", 
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<superheated vapor\>\"", ",", "10"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"23", ",", 
                    RowBox[{"23", "+", 
                    FractionBox[
                    RowBox[{"70", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "imax"}], "+", "1"}], ")"}]}], 
                    RowBox[{"2", "*", "it"}]]}]}], "}"}]}], "]"}]}], "]"}]}], 
               "]"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"distflow", "=", 
          FractionBox[
           RowBox[{"zf", "-", 
            RowBox[{"xs", "[", 
             RowBox[{"imax", "+", "1"}], "]"}]}], "xd"]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"botflow", "=", 
          RowBox[{"1", "-", "distflow"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"stagelines", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"35", ",", 
                 RowBox[{"20", "+", 
                  RowBox[{
                   FractionBox["70", "it"], "i"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"65", ",", 
                 RowBox[{"20", "+", 
                  RowBox[{
                   FractionBox["70", "it"], "i"}]}]}], "}"}]}], "}"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"it", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"stagelabels", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"\"\<Stage \>\"", "<>", 
                 RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<\>\""}], ",", 
                RowBox[{"{", 
                 RowBox[{"50", ",", 
                  RowBox[{"22", "+", 
                   RowBox[{
                    FractionBox["70", "it"], "i"}]}]}], "}"}]}], "]"}], ",", 
              "12"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"it", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"feedline", "=", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"65", ",", 
               RowBox[{"20", "+", 
                FractionBox[
                 RowBox[{"70", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", "*", "imax"}], "+", "1"}], ")"}]}], 
                 RowBox[{"2", "*", "it"}]]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"85", ",", 
               RowBox[{"20", "+", 
                FractionBox[
                 RowBox[{"70", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", "*", "imax"}], "+", "1"}], ")"}]}], 
                 RowBox[{"2", "*", "it"}]]}]}], "}"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"zlbl", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{".5", ",", ".5"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{".5", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
              "Dashed"}], "]"}], ",", "White", ",", 
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{".45", ",", ".11"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{".55", ",", ".19"}], "}"}]}], "]"}], ",", "Black", ",", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{"\"\<\!\(\*SubscriptBox[\(z\), \(f\)]\)= 0.5\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{".5", ",", ".15"}], "}"}]}], "]"}], ",", "12"}], 
             "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"PaneSelector", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"yinters", "<", 
                 RowBox[{"equilb", "[", "xinters", "]"}]}], ",", 
                RowBox[{"GraphicsRow", "[", 
                 RowBox[{
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Show", "[", 
                    RowBox[{
                    "plt0", ",", "plt6", ",", "plt4", ",", "plt5", ",", 
                    "rstagelbl", ",", "sstagelbl", ",", "bottomsconc", ",", 
                    "distilconc", ",", "xdlabel", ",", 
                    RowBox[{"Graphics", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "tbl1", ",", "tbl2", ",", "tbl3", ",", "tbl4", ",", 
                    "tblih", ",", "tbliv", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0", ",", "1", ",", "0"}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "]"}]}], "}"}]}],
                     "}"}], "]"}], ",", 
                    RowBox[{"PlotLabel", "\[Rule]", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<equilibrium stages needed = \>\"", "<>", 
                    RowBox[{"ToString", "[", "it", "]"}], "<>", 
                    "\"\< (including reboiler)\>\""}], "}"}], "]"}], ",", 
                    "12"}], "]"}]}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"330", ",", "300"}], "}"}]}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
                    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
                    RowBox[{"Epilog", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"xblabel", ",", "reboilerlbl", ",", "zlbl"}], 
                    "}"}]}]}], "]"}], ",", 
                    RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EdgeForm", "[", 
                    RowBox[{"{", 
                    RowBox[{"Black", ",", "Thick"}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", "White", ",", 
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"35", ",", "20"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"65", ",", "90"}], "}"}]}], "]"}], ",", "Black", 
                    ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"10", ",", 
                    RowBox[{"20", "+", 
                    FractionBox[
                    RowBox[{"70", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "imax"}], "+", "1"}], ")"}]}], 
                    RowBox[{"2", "*", "it"}]]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", 
                    RowBox[{"20", "+", 
                    FractionBox[
                    RowBox[{"70", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "imax"}], "+", "1"}], ")"}]}], 
                    RowBox[{"2", "*", "it"}]]}]}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"50", ",", "90"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "100"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"50", ",", "100"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"80", ",", "100"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"80", ",", "100"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"80", ",", "90"}], "}"}]}], "}"}], "]"}], ",", 
                    "White", ",", 
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"75", ",", "80"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"85", ",", "90"}], "}"}]}], "]"}], ",", "Black", 
                    ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"60", ",", "20"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"60", ",", "10"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"55", ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"45", ",", "5"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"45", ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"45", ",", "20"}], "}"}]}], "}"}], "]"}], ",", 
                    "White", ",", 
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"55", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"65", ",", "10"}], "}"}]}], "]"}], ",", "Black", 
                    ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"75", ",", "85"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"65", ",", "85"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"85", ",", "85"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"100", ",", "85"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"65", ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"100", ",", "5"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Feed rate: \\n1 kmol \!\(\*SuperscriptBox[\(h\), \
\(-1\)]\)\>\"", ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"23", ",", 
                    RowBox[{"12.5", "+", 
                    FractionBox[
                    RowBox[{"70", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "imax"}], "+", "1"}], ")"}]}], 
                    RowBox[{"2", "*", "it"}]]}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<\!\(\*SubscriptBox[\(z\), \(f\)]\): \>\"", "<>", 
                    RowBox[{"ToString", "[", "zf", "]"}], "<>", "\"\<\>\""}], 
                    ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"23", ",", 
                    RowBox[{"33", "+", 
                    FractionBox[
                    RowBox[{"70", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "imax"}], "+", "1"}], ")"}]}], 
                    RowBox[{"2", "*", "it"}]]}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<quality: \>\"", "<>", 
                    RowBox[{"ToString", "[", "q", "]"}], "<>", "\"\<\>\""}], 
                    ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"23", ",", 
                    RowBox[{"28", "+", 
                    FractionBox[
                    RowBox[{"70", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "imax"}], "+", "1"}], ")"}]}], 
                    RowBox[{"2", "*", "it"}]]}]}], "}"}]}], "]"}], ",", 
                    "feedstate", ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<distillate flow: \\n\>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{"distflow", ",", "2"}], "]"}], "]"}], "<>", 
                    "\"\< kmol \!\(\*SuperscriptBox[\(h\), \(-1\)]\)\>\""}], 
                    ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"95", ",", "96.5"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<bottoms flow: \\n\>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{"botflow", ",", "2"}], "]"}], "]"}], "<>", 
                    "\"\< kmol \!\(\*SuperscriptBox[\(h\), \(-1\)]\)\>\""}], 
                    ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"94", ",", "12"}], "}"}]}], "]"}], ",", 
                    "stagelines", ",", "stagelabels", ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<R\>\"", ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"60", ",", "5"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<C\>\"", ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"80", ",", "85"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{
                    "\"\<reflux ratio (\!\(\*FractionBox[\(L\), \(D\)]\)): \>\
\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{"R", ",", "3"}], "]"}], "]"}], "<>", "\"\<\>\""}],
                     ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"86", ",", "71"}], "}"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"10", ",", "107"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "107"}], "}"}]}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"280", ",", "300"}], "}"}]}]}], "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"Spacings", "\[Rule]", 
                   RowBox[{"-", "35"}]}], ",", 
                  RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"GraphicsRow", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Show", "[", 
                    RowBox[{
                    "plt0", ",", "plt6", ",", "plt4", ",", "plt5", ",", 
                    RowBox[{"Graphics", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "tbl1", ",", "tbl2", ",", "tblih", ",", "tbliv", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0", ",", "1", ",", "0"}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "]"}]}], "}"}]}],
                     "}"}], "]"}], ",", 
                    RowBox[{"PlotLabel", "\[Rule]", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{
                    "{", "\"\<equilibrium stages needed = infinite (pinch \
point)\>\"", "}"}], "]"}], ",", "12"}], "]"}]}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"330", ",", "300"}], "}"}]}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
                    RowBox[{"PlotRangePadding", "\[Rule]", "None"}]}], "]"}], 
                    ",", 
                    RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EdgeForm", "[", 
                    RowBox[{"{", 
                    RowBox[{"Black", ",", "Thick"}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", "White", ",", 
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"35", ",", "20"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"65", ",", "90"}], "}"}]}], "]"}], ",", "Black", 
                    ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"10", ",", "50"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"35", ",", "50"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"50", ",", "90"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "100"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"50", ",", "100"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"80", ",", "100"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"80", ",", "100"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"80", ",", "90"}], "}"}]}], "}"}], "]"}], ",", 
                    "White", ",", 
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"75", ",", "80"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"85", ",", "90"}], "}"}]}], "]"}], ",", "Black", 
                    ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"60", ",", "20"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"60", ",", "10"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"55", ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"45", ",", "5"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"45", ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"45", ",", "20"}], "}"}]}], "}"}], "]"}], ",", 
                    "White", ",", 
                    RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"55", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"65", ",", "10"}], "}"}]}], "]"}], ",", "Black", 
                    ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"75", ",", "85"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"65", ",", "85"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"85", ",", "85"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"100", ",", "85"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"65", ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"100", ",", "5"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<Feed rate: \\n1 kmol \!\(\*SuperscriptBox[\(h\), \
\(-1\)]\)\>\"", ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"23", ",", "42.5"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<\!\(\*SubscriptBox[\(z\), \(f\)]\): \>\"", "<>", 
                    RowBox[{"ToString", "[", "zf", "]"}], "<>", "\"\<\>\""}], 
                    ",", "10"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"23", ",", "63"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<quality: \>\"", "<>", 
                    RowBox[{"ToString", "[", "q", "]"}], "<>", "\"\<\>\""}], 
                    ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"23", ",", "58"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<VLE\>\"", ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"23", ",", "53"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<distillate flow: \\n N/A kmol \
\!\(\*SuperscriptBox[\(h\), \(-1\)]\)\>\"", ",", "10"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"95", ",", "96.5"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<bottoms flow: \\n N/A kmol \
\!\(\*SuperscriptBox[\(h\), \(-1\)]\)\>\"", ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"94", ",", "12"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<R\>\"", ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"60", ",", "5"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<C\>\"", ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"80", ",", "85"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{
                    "\"\<reflux ratio (\!\(\*FractionBox[\(L\), \(D\)]\)): \>\
\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"SetPrecision", "[", 
                    RowBox[{"R", ",", "3"}], "]"}], "]"}], "<>", "\"\<\>\""}],
                     ",", "12"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"86", ",", "71"}], "}"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"10", ",", "107"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "107"}], "}"}]}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"280", ",", "300"}], "}"}]}]}], "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"Spacings", "\[Rule]", 
                   RowBox[{"-", "35"}]}], ",", 
                  RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], 
               "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"2", "\[Rule]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"yinters", "<", 
                 RowBox[{"equilb", "[", "xinters", "]"}]}], ",", 
                RowBox[{"Show", "[", 
                 RowBox[{
                 "plt0", ",", "plt6", ",", "plt4", ",", "plt5", ",", 
                  "rstagelbl", ",", "sstagelbl", ",", "bottomsconc", ",", 
                  "distilconc", ",", "xdlabel", ",", 
                  RowBox[{"Graphics", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "tbl1", ",", "tbl2", ",", "tbl3", ",", "tbl4", ",", 
                    "tblih", ",", "tbliv", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0", ",", "1", ",", "0"}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "]"}]}], "}"}]}],
                     "}"}], "]"}], ",", 
                  RowBox[{"PlotLabel", "\[Rule]", 
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<equilibrium stages needed = \>\"", "<>", 
                    RowBox[{"ToString", "[", "it", "]"}], "<>", 
                    "\"\< (including reboiler)\>\""}], "}"}], "]"}], ",", 
                    "14"}], "]"}]}], ",", 
                  RowBox[{"ImageSize", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"550", ",", "400"}], "}"}]}], ",", 
                  RowBox[{"Placed", "\[Rule]", "Center"}], ",", 
                  RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
                  RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
                  RowBox[{"Epilog", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"xblabel", ",", "reboilerlbl", ",", "zlbl"}], 
                    "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Show", "[", 
                 RowBox[{"plt0", ",", "plt6", ",", "plt4", ",", "plt5", ",", 
                  RowBox[{"Graphics", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "tbl1", ",", "tbl2", ",", "tblih", ",", "tbliv", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0", ",", "1", ",", "0"}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "]"}]}], "}"}]}],
                     "}"}], "]"}], ",", 
                  RowBox[{"PlotLabel", "\[Rule]", 
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{
                    "{", "\"\<equilibrium stages needed = infinite (pinch \
point)\>\"", "}"}], "]"}], ",", "14"}], "]"}]}], ",", 
                  RowBox[{"ImageSize", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"550", ",", "400"}], "}"}]}], ",", 
                  RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
                  RowBox[{"Placed", "\[Rule]", "Center"}], ",", " ", 
                  RowBox[{"PlotRangePadding", "\[Rule]", "None"}]}], "]"}]}], 
               "]"}]}]}], "}"}], ",", "window"}], "]"}]}]}], "]"}]}]}], "]"}],
    ",", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"window", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "\[Rule]", "\"\<show flow diagram\>\""}], ",", 
              RowBox[{"2", "\[Rule]", "\"\<hide flow diagram\>\""}]}], "}"}], 
            ",", "SetterBar"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xd", ",", ".85", ",", 
              RowBox[{"Row", "[", 
               RowBox[{
               "{", "\"\<distillate specification (\!\(\*SubscriptBox[\(x\), \
\(d\)]\))\>\"", "}"}], "]"}]}], "}"}], ",", ".8", ",", ".98", ",", ".01", ",", 
            RowBox[{"Appearance", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<Labeled\>\"", ",", "Small"}], "}"}]}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "xb", ",", "0.15", ",", 
              "\"\<bottoms specification (\!\(\*SubscriptBox[\(x\), \(b\)]\))\
\>\""}], "}"}], ",", "0.05", ",", "0.2", ",", "0.01", ",", 
            RowBox[{"Appearance", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<Labeled\>\"", ",", "Small"}], "}"}]}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "lvmult", ",", "3", ",", 
              "\"\<external reflux ratio (\!\(\*FractionBox[\(L\), \
\(D\)]\))\>\""}], "}"}], ",", ".25", ",", "10", ",", ".25", ",", 
            RowBox[{"Appearance", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<Labeled\>\"", ",", "Small"}], "}"}]}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "}"}], "]"}]}], 
        "}"}]}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"SaveDefinitions", "\[Rule]", " ", "True"}], ",", 
   RowBox[{"TrackedSymbols", "\[Rule]", "Manipulate"}], ",", 
   RowBox[{"SynchronousUpdating", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.6764831553526363`*^9, {3.67713776911479*^9, 3.677137784629904*^9}, {
   3.6771378335249147`*^9, 3.677137844057869*^9}, {3.6771378994458733`*^9, 
   3.677137928836268*^9}, {3.677137983829995*^9, 3.6771380367693977`*^9}, {
   3.677138067779531*^9, 3.677138108452976*^9}, {3.6771381569738617`*^9, 
   3.6771382154961233`*^9}, {3.677192552234428*^9, 3.6771925531816874`*^9}, {
   3.6771926173906*^9, 3.677192618616501*^9}, {3.677192658497238*^9, 
   3.677192659508932*^9}, {3.677360350876362*^9, 3.6773603606627407`*^9}, {
   3.6773604851080637`*^9, 3.677360497560704*^9}, {3.677360605222649*^9, 
   3.677360608300625*^9}, {3.6773606548534822`*^9, 3.677360726909746*^9}, 
   3.677360761875629*^9, {3.677360878715581*^9, 3.677360884088238*^9}, {
   3.677360915601275*^9, 3.677360996094965*^9}, {3.6773610376228027`*^9, 
   3.677361040303056*^9}, {3.677361111214302*^9, 3.677361125304281*^9}, {
   3.677361156715835*^9, 3.677361211446823*^9}, {3.677361287902945*^9, 
   3.677361293189609*^9}, {3.67736134180943*^9, 3.677361371734302*^9}, {
   3.6773614227438717`*^9, 3.677361447739698*^9}, {3.677361628554673*^9, 
   3.6773616620250063`*^9}, 3.677361709281148*^9, {3.677361923967836*^9, 
   3.677361932924571*^9}, {3.677362049205978*^9, 3.67736205533251*^9}, {
   3.677362087007813*^9, 3.677362093274851*^9}, {3.6773621277861843`*^9, 
   3.67736219988242*^9}, {3.677362624863895*^9, 3.677362660151537*^9}, {
   3.677362726751536*^9, 3.677362775433689*^9}, {3.677362816117878*^9, 
   3.677362850032258*^9}, {3.6773629229630127`*^9, 3.677362940549172*^9}, {
   3.67736300430474*^9, 3.6773630541825323`*^9}, {3.677363090759108*^9, 
   3.6773631126557217`*^9}, {3.677363427755348*^9, 3.677363540416133*^9}, {
   3.67736358433596*^9, 3.6773636173674603`*^9}, {3.677363712713243*^9, 
   3.677363745542534*^9}, {3.677363787848632*^9, 3.6773638478508253`*^9}, {
   3.677363896012808*^9, 3.6773639080836267`*^9}, {3.6773639759792557`*^9, 
   3.677364015893759*^9}, {3.6773640898221617`*^9, 3.677364199487753*^9}, {
   3.6773642490172377`*^9, 3.677364251454919*^9}, {3.6773642816021147`*^9, 
   3.677364412338379*^9}, {3.677364507689582*^9, 3.677364509543765*^9}, {
   3.6773645544871397`*^9, 3.677364586596221*^9}, {3.677364631726108*^9, 
   3.6773646355538893`*^9}, {3.6773646962443933`*^9, 3.67736470112156*^9}, {
   3.6773647640905457`*^9, 3.677364794681172*^9}, {3.6773648635003777`*^9, 
   3.677364940786908*^9}, {3.6773649953663807`*^9, 3.6773650318339233`*^9}, {
   3.6773650627185507`*^9, 3.67736508222441*^9}, {3.6773651263687057`*^9, 
   3.677365138535212*^9}, {3.677365178572977*^9, 3.677365290649376*^9}, {
   3.677365414875367*^9, 3.6773654736293983`*^9}, {3.67736841850343*^9, 
   3.6773685028304*^9}, {3.6773685429540462`*^9, 3.6773685620544*^9}, {
   3.677413660479744*^9, 3.6774136630067663`*^9}, {3.677413731426731*^9, 
   3.677413732594542*^9}, {3.677413927150713*^9, 3.677413982265007*^9}, {
   3.677414015931868*^9, 3.677414030263401*^9}, {3.677414070667272*^9, 
   3.677414080304653*^9}, {3.677414111724744*^9, 3.6774141141175327`*^9}, {
   3.677414355879923*^9, 3.677414371415682*^9}, {3.677414514895718*^9, 
   3.677414560236599*^9}, {3.677414607968706*^9, 3.677414621146916*^9}, {
   3.677414657838323*^9, 3.677414660764513*^9}, {3.677414693050728*^9, 
   3.6774147011903152`*^9}, {3.6774147951297073`*^9, 3.677414799378661*^9}, {
   3.677414865722567*^9, 3.677414886351862*^9}, {3.677414932527418*^9, 
   3.6774149373408957`*^9}, {3.677415108663228*^9, 3.677415123483708*^9}, {
   3.677415185142723*^9, 3.677415226514929*^9}, {3.677415269806892*^9, 
   3.677415353865638*^9}, {3.677415482586631*^9, 3.677415506466954*^9}, {
   3.677415596288892*^9, 3.6774156407790318`*^9}, {3.677415746376671*^9, 
   3.6774158082927713`*^9}, {3.677415843925255*^9, 3.677415849863161*^9}, {
   3.677416240621647*^9, 3.677416253972283*^9}, {3.677416288256118*^9, 
   3.677416290950068*^9}, {3.677416323723426*^9, 3.67741639296994*^9}, {
   3.67741659769064*^9, 3.677416764578103*^9}, {3.677416831586741*^9, 
   3.677416836089752*^9}, {3.6774168893601294`*^9, 3.6774168981228523`*^9}, {
   3.677863457427835*^9, 3.677863612367138*^9}, {3.677863643831394*^9, 
   3.677863672356752*^9}, {3.677863717527121*^9, 3.677863729556222*^9}, {
   3.6778637928401613`*^9, 3.677863965650446*^9}, {3.6778640013898897`*^9, 
   3.677864071858457*^9}, {3.677864142881071*^9, 3.6778641429706287`*^9}, {
   3.6780304471780567`*^9, 3.678030448679977*^9}, {3.6780304928677588`*^9, 
   3.6780304931087112`*^9}, {3.678030651410349*^9, 3.678030656501679*^9}, {
   3.678030701002988*^9, 3.6780307043387423`*^9}, {3.678030749860957*^9, 
   3.678030751252195*^9}, {3.678030950841255*^9, 3.678030951811207*^9}, {
   3.678031024425668*^9, 3.678031041968046*^9}, {3.678109565227097*^9, 
   3.6781096728643103`*^9}, {3.67810972020494*^9, 3.678109862574913*^9}, {
   3.6781102569458857`*^9, 3.6781102896786346`*^9}, {3.678110380350916*^9, 
   3.678110539498927*^9}, {3.678110583851038*^9, 3.678110589007617*^9}, {
   3.678110717770215*^9, 3.67811075446017*^9}, {3.678110851486445*^9, 
   3.678110885435575*^9}, {3.6781109168072557`*^9, 3.678110951039762*^9}, {
   3.6781110472358513`*^9, 3.678111049601287*^9}, {3.678111120023095*^9, 
   3.678111139977029*^9}, {3.678135419614923*^9, 3.678135446982366*^9}, {
   3.678135545197798*^9, 3.678135623740553*^9}, {3.678135673376259*^9, 
   3.678135760809341*^9}, {3.678135834274*^9, 3.678135841090786*^9}, {
   3.678135920832955*^9, 3.6781359397717524`*^9}, {3.678135971269802*^9, 
   3.6781361233083477`*^9}, {3.678136252626975*^9, 3.6781362872701607`*^9}, {
   3.6781363338208323`*^9, 3.6781363379530363`*^9}, {3.678136372141127*^9, 
   3.6781363741656218`*^9}, 3.678136426404489*^9, {3.678136601131682*^9, 
   3.678136606544776*^9}, {3.678136677481282*^9, 3.678136695834838*^9}, {
   3.6781367950763607`*^9, 3.678136825025326*^9}, {3.678136926372939*^9, 
   3.678137012066441*^9}, {3.6781370907621107`*^9, 3.6781370969035*^9}, {
   3.6781371747168207`*^9, 3.6781371916584597`*^9}, {3.6781375306087418`*^9, 
   3.678137591317202*^9}, 3.678137745711556*^9, {3.678137823696666*^9, 
   3.678137897426461*^9}, {3.678137928914604*^9, 3.678137930335174*^9}, {
   3.678137975249774*^9, 3.6781380378770847`*^9}, {3.678138073785009*^9, 
   3.6781380921930103`*^9}, {3.678138122741642*^9, 3.678138126293974*^9}, {
   3.678138301129777*^9, 3.678138307637076*^9}, {3.678138383598773*^9, 
   3.6781384611084414`*^9}, {3.679185812765538*^9, 3.679185881541251*^9}, {
   3.6791859625564632`*^9, 3.679186103382661*^9}, {3.6791862555936604`*^9, 
   3.679186256083808*^9}, {3.679186289888217*^9, 3.679186290729044*^9}, {
   3.67918650021618*^9, 3.679186641352108*^9}, {3.6791866721867733`*^9, 
   3.679186711485264*^9}, {3.6791868025791492`*^9, 3.679186814163144*^9}, {
   3.6791868837011833`*^9, 3.679186923140524*^9}, {3.6791870359819*^9, 
   3.679187086546865*^9}, {3.679187160019784*^9, 3.67918718622327*^9}, {
   3.679187220374023*^9, 3.679187220555663*^9}, {3.679187263048819*^9, 
   3.679187302658306*^9}, {3.679187333035857*^9, 3.679187335855053*^9}, {
   3.679187382482465*^9, 3.6791874192693644`*^9}, {3.6791874583316393`*^9, 
   3.6791874599520063`*^9}, {3.679187515340179*^9, 3.6791875873127937`*^9}, {
   3.679187696709622*^9, 3.679187714351754*^9}, {3.679187764073432*^9, 
   3.6791878057737627`*^9}, {3.679187850362543*^9, 3.679187874148697*^9}, {
   3.6791879060701437`*^9, 3.679187946686233*^9}, {3.6791879805687037`*^9, 
   3.679187986363336*^9}, {3.679188083289813*^9, 3.679188104460896*^9}, {
   3.6791881426574697`*^9, 3.679188148778228*^9}, {3.679188240136998*^9, 
   3.679188281471712*^9}, {3.679188373781815*^9, 3.6791884907824802`*^9}, {
   3.6791885349582767`*^9, 3.679188569019953*^9}, {3.679188631314077*^9, 
   3.679188666021809*^9}, {3.679188700683827*^9, 3.679188774081121*^9}, {
   3.679188866949428*^9, 3.679188931460494*^9}, {3.6791890107383747`*^9, 
   3.679189112857238*^9}, {3.679189181633664*^9, 3.679189297996189*^9}, {
   3.6791893448049297`*^9, 3.679189390410035*^9}, {3.679189443937262*^9, 
   3.67918949222687*^9}, {3.67918955004606*^9, 3.6791896292804728`*^9}, {
   3.679189686416319*^9, 3.679189773820998*^9}, {3.6791898947880087`*^9, 
   3.679189895084134*^9}, {3.679189996423554*^9, 3.6791900966661663`*^9}, {
   3.6791901347828836`*^9, 3.679190155906118*^9}, {3.6791901909946737`*^9, 
   3.6791901912696342`*^9}, {3.6791902438091*^9, 3.679190431875093*^9}, {
   3.679190464191826*^9, 3.679190469758782*^9}, {3.6791905054254436`*^9, 
   3.6791906232795267`*^9}, {3.679190686570285*^9, 3.6791908309132442`*^9}, {
   3.6791908757081337`*^9, 3.679190875802141*^9}, {3.6791909133327923`*^9, 
   3.6791909134234457`*^9}, {3.679190979746643*^9, 3.679191076889421*^9}, {
   3.679191122998106*^9, 3.6791911322375402`*^9}, {3.679191178861709*^9, 
   3.679191196436122*^9}, {3.679191257206358*^9, 3.67919131785885*^9}, {
   3.679191415357354*^9, 3.6791914638582077`*^9}, {3.6791915389867907`*^9, 
   3.679191564349695*^9}, {3.679191603883363*^9, 3.6791916471362762`*^9}, {
   3.679191689650855*^9, 3.6791917026397047`*^9}, {3.679191743134625*^9, 
   3.679191778269692*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`lvmult$$ = 0.25, $CellContext`window$$ = 
    1, $CellContext`xb$$ = 0.15, $CellContext`xd$$ = 0.85, Typeset`show$$ = 
    True, Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`window$$], 1}, {
      1 -> "show flow diagram", 2 -> "hide flow diagram"}}, {{
       Hold[$CellContext`xd$$], 0.85, 
       Row[{
        "distillate specification (\!\(\*SubscriptBox[\(x\), \(d\)]\))"}]}, 
      0.8, 0.98, 0.01}, {{
       Hold[$CellContext`xb$$], 0.15, 
       "bottoms specification (\!\(\*SubscriptBox[\(x\), \(b\)]\))"}, 0.05, 
      0.2, 0.01}, {{
       Hold[$CellContext`lvmult$$], 3, 
       "external reflux ratio (\!\(\*FractionBox[\(L\), \(D\)]\))"}, 0.25, 10,
       0.25}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], 
          Manipulate`Place[2]}, {
          Manipulate`Place[3], 
          Manipulate`Place[4]}}, Alignment -> Center]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    602., {234., 166.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`window$173968$$ = 
    False, $CellContext`xd$173969$$ = 0, $CellContext`xb$173970$$ = 
    0, $CellContext`lvmult$173971$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`lvmult$$ = 3, $CellContext`window$$ = 
        1, $CellContext`xb$$ = 0.15, $CellContext`xd$$ = 0.85}, 
      "ControllerVariables" :> {
        Hold[$CellContext`window$$, $CellContext`window$173968$$, False], 
        Hold[$CellContext`xd$$, $CellContext`xd$173969$$, 0], 
        Hold[$CellContext`xb$$, $CellContext`xb$173970$$, 0], 
        Hold[$CellContext`lvmult$$, $CellContext`lvmult$173971$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`ir$, $CellContext`imax$, $CellContext`it$, \
$CellContext`xr$, $CellContext`ys$, $CellContext`yr$, $CellContext`xs$, \
$CellContext`feed$, $CellContext`plt0$, $CellContext`pinch$, \
$CellContext`xpinch$, $CellContext`ypinch$, $CellContext`Rmin$, \
$CellContext`R$, $CellContext`OpRect$, $CellContext`OpStrp$, \
$CellContext`inters$, $CellContext`xinters$, $CellContext`yinters$, \
$CellContext`plt4$, $CellContext`plt5$, $CellContext`plt6$, \
$CellContext`plt7$, $CellContext`rstagelbl$, $CellContext`sstagelbl$, \
$CellContext`reboilerlbl$, $CellContext`v$, $CellContext`i$, \
$CellContext`tbl1$, $CellContext`tbl2$, $CellContext`tbl3$, \
$CellContext`bottomsconc$, $CellContext`distilconc$, $CellContext`xblabel$, \
$CellContext`xdlabel$, $CellContext`tbl4$, $CellContext`tblih$, \
$CellContext`tbliv$, $CellContext`feedstate$, $CellContext`distflow$, \
$CellContext`botflow$, $CellContext`stagelines$, $CellContext`feedline$, \
$CellContext`stagelabels$, $CellContext`zlbl$, $CellContext`legend$}, \
$CellContext`zf = 0.5; $CellContext`q = 0.5; $CellContext`mve = 
         1; $CellContext`P = 760; $CellContext`AMet = 
         8.08097; $CellContext`BMet = 1582.271; $CellContext`CMet = 
         239.726; $CellContext`VPMet = 
         10^($CellContext`AMet - $CellContext`BMet/($CellContext`CMet + \
$CellContext`T)); $CellContext`VPWat = 
         10^($CellContext`AWat - $CellContext`BWat/($CellContext`CWat + \
$CellContext`T)); $CellContext`AWat = 8.07131; $CellContext`BWat = 
         1730.63; $CellContext`CWat = 233.426; $CellContext`A12 = 
         0.5434; $CellContext`A21 = 0.7923; $CellContext`\[Gamma]1[
           Pattern[$CellContext`i, 
            Blank[]]] = 
         Exp[$CellContext`x2[$CellContext`i]^2 ($CellContext`A12 + (
              2 ($CellContext`A21 - $CellContext`A12)) (
              1 - $CellContext`x2[$CellContext`i]))]; $CellContext`\[Gamma]2[
           Pattern[$CellContext`i, 
            Blank[]]] = 
         Exp[(1 - $CellContext`x2[$CellContext`i])^2 ($CellContext`A21 + (
              2 ($CellContext`A12 - $CellContext`A21)) \
$CellContext`x2[$CellContext`i])]; $CellContext`i$ = 0; 
        While[$CellContext`i$ < 
          101, {$CellContext`x2[$CellContext`i$] = $CellContext`i$ 
            0.01, $CellContext`T[$CellContext`i$] = Part[
             
             FindRoot[$CellContext`P == ($CellContext`VPWat $CellContext`\
\[Gamma]1[$CellContext`i$]) (
                 1 - $CellContext`x2[$CellContext`i$]) + ($CellContext`VPMet \
$CellContext`\[Gamma]2[$CellContext`i$]) $CellContext`x2[$CellContext`i$], \
{$CellContext`T, 60}, AccuracyGoal -> 5], 1, 
             2], $CellContext`y2[$CellContext`i$] = 
           ReplaceAll[$CellContext`x2[$CellContext`i$] + (($CellContext`VPMet \
$CellContext`\[Gamma]2[$CellContext`i$]) \
($CellContext`x2[$CellContext`i$]/$CellContext`P) - \
$CellContext`x2[$CellContext`i$]) $CellContext`mve, $CellContext`T -> \
$CellContext`T[$CellContext`i$]], 
           Increment[$CellContext`i$]}]; $CellContext`tb = Table[{
            $CellContext`x2[$CellContext`i$], 
            $CellContext`y2[$CellContext`i$]}, {$CellContext`i$, 0, 
            100}]; $CellContext`equilb = 
         Interpolation[$CellContext`tb]; $CellContext`equilb2[
           Pattern[$CellContext`m, 
            
            Blank[]]] = $CellContext`m + ($CellContext`equilb[$CellContext`m] - \
$CellContext`m) (1/$CellContext`mve); $CellContext`feed$[
           Pattern[$CellContext`x, 
            Blank[]]] := 
         If[$CellContext`q != 
           1, $CellContext`q ($CellContext`x/($CellContext`q - 
             1)) - $CellContext`zf/($CellContext`q - 1), 
           1000000 ($CellContext`x - $CellContext`zf) + $CellContext`zf]; \
$CellContext`plt0$ = Plot[
           $CellContext`equilb2[$CellContext`x], {$CellContext`x, 0, 1}, 
           PlotStyle -> RGBColor[1, 0, 0], 
           FrameLabel -> {
            "liquid mole fraction (\!\(\*SubscriptBox[\(x\), \(met\)]\))", 
             "vapor mole fraction (\!\(\*SubscriptBox[\(y\), \(met\)]\))"}, 
           LabelStyle -> 12, Frame -> True, 
           AxesOrigin -> {0, 0}]; $CellContext`pinch$ = Quiet[
           
           FindRoot[$CellContext`feed$[$CellContext`x] == \
$CellContext`equilb2[$CellContext`x], {$CellContext`x, 
             0.5}]]; $CellContext`xpinch$ = 
         Part[$CellContext`pinch$, 1, 
           2]; $CellContext`ypinch$ = \
$CellContext`feed$[$CellContext`xpinch$]; $CellContext`opertRect[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`ypinch$ + (($CellContext`x$ - \
$CellContext`xpinch$)/($CellContext`xd$$ - $CellContext`xpinch$)) \
($CellContext`xd$$ - $CellContext`ypinch$); $CellContext`opertStrp[
           Pattern[$CellContext`x$, 
            
            Blank[]]] := $CellContext`ypinch$ + (($CellContext`x$ - \
$CellContext`xpinch$)/($CellContext`xb$$ - $CellContext`xpinch$)) \
($CellContext`xb$$ - $CellContext`ypinch$); $CellContext`Rmin$ = \
(($CellContext`xd$$ - $CellContext`ypinch$)/($CellContext`xd$$ - \
$CellContext`xpinch$))/(
          1 - ($CellContext`xd$$ - $CellContext`ypinch$)/($CellContext`xd$$ - \
$CellContext`xpinch$)); $CellContext`R$ = $CellContext`lvmult$$; \
$CellContext`OpRect$[
           Pattern[$CellContext`x$, 
            Blank[]]] := ($CellContext`R$/($CellContext`R$ + 
            1)) $CellContext`x$ + $CellContext`xd$$/($CellContext`R$ + 
           1); $CellContext`inters$ = 
         FindRoot[$CellContext`feed$[$CellContext`x] == \
$CellContext`OpRect$[$CellContext`x], {$CellContext`x, 
            0.7}]; $CellContext`xinters$ = 
         Part[$CellContext`inters$, 1, 
           2]; $CellContext`yinters$ = \
$CellContext`OpRect$[$CellContext`xinters$]; 
        If[$CellContext`yinters$ >= \
$CellContext`equilb[$CellContext`xinters$], $CellContext`OpStrp$[
             Pattern[$CellContext`x, 
              
              Blank[]]] := $CellContext`opertStrp[$CellContext`x]; \
$CellContext`plt4$ = Plot[
             $CellContext`opertRect[$CellContext`x], {$CellContext`x, \
$CellContext`xpinch$, $CellContext`xd$$}, PlotStyle -> 
             RGBColor[0, 1, 1]]; $CellContext`plt5$ = Plot[
             $CellContext`opertStrp[$CellContext`x], {$CellContext`x, \
$CellContext`xb$$, $CellContext`xpinch$}, PlotStyle -> 
             RGBColor[1, 0, 1]]; $CellContext`plt6$ = Plot[
             $CellContext`feed$[$CellContext`x], {$CellContext`x, \
$CellContext`xpinch$, $CellContext`zf}, PlotStyle -> RGBColor[0, 0, 1], 
             PlotRange -> {{0, 1}, {0, 1}}]; $CellContext`plt7$ = Plot[
             $CellContext`equilb[$CellContext`m], {$CellContext`m, 0, 1}, 
             PlotStyle -> {
               RGBColor[0.5, 0.5, 0.5], Dashed}]; $CellContext`yr$[
            0] = $CellContext`xd$$; $CellContext`xr$[
            0] = $CellContext`xd$$; $CellContext`i$ = 0; 
          While[$CellContext`i$ < 25, {$CellContext`v$ = Part[
               Quiet[
                
                FindRoot[$CellContext`yr$[$CellContext`i$] == \
$CellContext`equilb[$CellContext`u], {$CellContext`u, 0.5}]], 1, 
               2], $CellContext`t = $CellContext`opertRect[$CellContext`v$], 
             
             If[$CellContext`v$ > $CellContext`xpinch$, \
{$CellContext`xr$[$CellContext`i$ + 
                 1] = $CellContext`v$, $CellContext`yr$[$CellContext`i$ + 
                 1] = $CellContext`t}], 
             Increment[$CellContext`i$]}]; $CellContext`ir$ = $CellContext`i$ - 
            1; $CellContext`i$ = 0; 
          If[$CellContext`ir$ >= 
            0, $CellContext`ys$[
              0] = $CellContext`yr$[$CellContext`ir$]; $CellContext`xs$[
              0] = $CellContext`xr$[$CellContext`ir$]]; 
          While[$CellContext`i$ < 20, {$CellContext`v$ = Part[
               Quiet[
                
                FindRoot[$CellContext`ys$[$CellContext`i$] == \
$CellContext`equilb[$CellContext`u], {$CellContext`u, 0.5}]], 1, 
               2], $CellContext`t = $CellContext`opertStrp[$CellContext`v$], \
$CellContext`xs$[$CellContext`i$ + 
               1] = $CellContext`v$, $CellContext`ys$[$CellContext`i$ + 
               1] = $CellContext`t, 
             
             Increment[$CellContext`i$]}]; $CellContext`imax$ = \
$CellContext`i$ - 1; $CellContext`tbl1$ = Table[
             Line[{{
                $CellContext`xr$[$CellContext`i$], 
                $CellContext`yr$[$CellContext`i$ - 1]}, {
                $CellContext`xr$[$CellContext`i$], 
                $CellContext`yr$[$CellContext`i$]}}], {$CellContext`i$, 
              1, $CellContext`ir$}]; $CellContext`tbl2$ = 
           If[$CellContext`ir$ >= 1, 
             Table[
              Line[{{
                 $CellContext`xr$[$CellContext`i$], 
                 $CellContext`yr$[$CellContext`i$]}, {
                 $CellContext`xr$[$CellContext`i$ + 1], 
                 $CellContext`yr$[$CellContext`i$]}}], {$CellContext`i$, 
               0, $CellContext`ir$ - 1}], 
             Table[
              Line[{{
                 $CellContext`xr$[$CellContext`i$], 
                 $CellContext`yr$[$CellContext`i$]}, {
                 $CellContext`xr$[$CellContext`i$ + 1], 
                 $CellContext`yr$[$CellContext`i$]}}], {$CellContext`i$, 0, 
               0}]]; $CellContext`tbl3$ = Table[
             Line[{{
                $CellContext`xs$[$CellContext`i$ + 1], 
                $CellContext`ys$[$CellContext`i$]}, {
                $CellContext`xs$[$CellContext`i$ + 1], 
                $CellContext`ys$[$CellContext`i$ + 1]}}], {$CellContext`i$, 
              0, $CellContext`imax$ - 1}]; $CellContext`tbl4$ = Table[
             Line[{{
                $CellContext`xs$[$CellContext`i$ - 1], 
                $CellContext`ys$[$CellContext`i$ - 1]}, {
                $CellContext`xs$[$CellContext`i$], 
                $CellContext`ys$[$CellContext`i$ - 1]}}], {$CellContext`i$, 
              1, $CellContext`imax$ + 1}]; $CellContext`tblih$ = Line[{{
               $CellContext`xs$[1], 
               $CellContext`ys$[0]}, {
               $CellContext`xr$[$CellContext`ir$], 
               $CellContext`ys$[0]}}]; $CellContext`tbliv$ = Line[{{
               $CellContext`xs$[1], 
               $CellContext`ys$[0]}, {
               $CellContext`xs$[1], 
               $CellContext`ys$[1]}}]; $CellContext`xblabel$ = {White, 
             
             Rectangle[{$CellContext`xs$[$CellContext`imax$ + 1] + 0.045, 
               0.025}, {$CellContext`xs$[$CellContext`imax$ + 1] + 0.215, 
               0.085}], Black, 
             Style[
              Text[
               StringJoin["\!\(\*SubscriptBox[\(x\), \(b\)]\)= ", 
                ToString[
                 SetPrecision[
                  $CellContext`xs$[$CellContext`imax$ + 1], 2]], 
                ""], {$CellContext`xs$[$CellContext`imax$ + 1] + 0.135, 
                0.05}], 12]}; $CellContext`xdlabel$ = Graphics[
             Style[
              Text[
               StringJoin["\!\(\*SubscriptBox[\(x\), \(d\)]\)= ", 
                ToString[
                 SetPrecision[
                  $CellContext`xr$[0], 2]], ""], {$CellContext`xr$[0] - 0.1, 
                0.05}], 12], ImageSize -> {15, 13}]; $CellContext`zlbl$ = {
             Style[
              Line[{{0.5, 0.5}, {0.5, 0}}], Dashed], White, 
             Rectangle[{0.45, 0.11}, {0.55, 0.19}], Black, 
             Text["\!\(\*SubscriptBox[\(z\), \(f\)]\)= 0.5", {0.5, 0.15}]}; 
          PaneSelector[{
            1 -> If[$CellContext`yinters$ < \
$CellContext`equilb[$CellContext`xinters$], 
               GraphicsRow[{
                 
                 Show[$CellContext`plt0$, $CellContext`plt6$, \
$CellContext`plt4$, $CellContext`plt5$, $CellContext`rstagelbl$, \
$CellContext`sstagelbl$, $CellContext`bottomsconc$, $CellContext`distilconc$, \
$CellContext`xdlabel$, 
                  
                  Graphics[{$CellContext`tbl1$, $CellContext`tbl2$, \
$CellContext`tbl3$, $CellContext`tbl4$, $CellContext`tblih$, \
$CellContext`tbliv$, {
                    RGBColor[0, 1, 0], 
                    Line[{{0, 0}, {1, 1}}]}}], PlotLabel -> Style[
                    Row[{
                    StringJoin["equilibrium stages needed = ", 
                    ToString[$CellContext`it$], " (including reboiler)"]}], 
                    12], ImageSize -> {330, 300}, AspectRatio -> Full, 
                  PlotRangePadding -> None, 
                  Epilog -> {$CellContext`xblabel$, \
$CellContext`reboilerlbl$, $CellContext`zlbl$}], 
                 Graphics[{
                   EdgeForm[{Black, Thick}], White, 
                   Rectangle[{35, 20}, {65, 90}], Black, 
                   
                   Arrow[{{
                    10, 20 + 70 ((2 $CellContext`imax$ + 1)/(
                    2 $CellContext`it$))}, {
                    35, 20 + 70 ((2 $CellContext`imax$ + 1)/(
                    2 $CellContext`it$))}}], 
                   Line[{{50, 90}, {50, 100}}], 
                   Line[{{50, 100}, {80, 100}}], 
                   Arrow[{{80, 100}, {80, 90}}], White, 
                   Rectangle[{75, 80}, {85, 90}], Black, 
                   Arrow[{{60, 20}, {60, 10}}], 
                   Line[{{55, 5}, {45, 5}}], 
                   Arrow[{{45, 5}, {45, 20}}], White, 
                   Rectangle[{55, 0}, {65, 10}], Black, 
                   Arrow[{{75, 85}, {65, 85}}], 
                   Arrow[{{85, 85}, {100, 85}}], 
                   Arrow[{{65, 5}, {100, 5}}], 
                   Text[
                    Style[
                    "Feed rate: \n1 kmol \!\(\*SuperscriptBox[\(h\), \
\(-1\)]\)", 12], {23, 12.5 + 
                    70 ((2 $CellContext`imax$ + 1)/(2 $CellContext`it$))}], 
                   Text[
                    Style[
                    StringJoin["\!\(\*SubscriptBox[\(z\), \(f\)]\): ", 
                    ToString[$CellContext`zf], ""], 12], {
                    23, 33 + 70 ((2 $CellContext`imax$ + 1)/(
                    2 $CellContext`it$))}], 
                   Text[
                    Style[
                    StringJoin["quality: ", 
                    ToString[$CellContext`q], ""], 12], {
                    23, 28 + 70 ((2 $CellContext`imax$ + 1)/(
                    2 $CellContext`it$))}], $CellContext`feedstate$, 
                   Text[
                    Style[
                    StringJoin["distillate flow: \n", 
                    ToString[
                    SetPrecision[$CellContext`distflow$, 2]], 
                    " kmol \!\(\*SuperscriptBox[\(h\), \(-1\)]\)"], 12], {
                    95, 96.5}], 
                   Text[
                    Style[
                    StringJoin["bottoms flow: \n", 
                    ToString[
                    SetPrecision[$CellContext`botflow$, 2]], 
                    " kmol \!\(\*SuperscriptBox[\(h\), \(-1\)]\)"], 12], {94, 
                    12}], $CellContext`stagelines$, $CellContext`stagelabels$, 
                   Text[
                    Style["R", 12], {60, 5}], 
                   Text[
                    Style["C", 12], {80, 85}], 
                   Text[
                    Style[
                    StringJoin[
                    "reflux ratio (\!\(\*FractionBox[\(L\), \(D\)]\)): ", 
                    ToString[
                    SetPrecision[$CellContext`R$, 3]], ""], 12], {86, 71}]}, 
                  PlotRange -> {{10, 107}, {0, 107}}, 
                  ImageSize -> {280, 300}]}, Spacings -> -35, Alignment -> 
                Center], 
               GraphicsRow[{
                 
                 Show[$CellContext`plt0$, $CellContext`plt6$, \
$CellContext`plt4$, $CellContext`plt5$, 
                  
                  Graphics[{$CellContext`tbl1$, $CellContext`tbl2$, \
$CellContext`tblih$, $CellContext`tbliv$, {
                    RGBColor[0, 1, 0], 
                    Line[{{0, 0}, {1, 1}}]}}], PlotLabel -> Style[
                    
                    Row[{"equilibrium stages needed = infinite (pinch \
point)"}], 12], ImageSize -> {330, 300}, AspectRatio -> Full, 
                  PlotRangePadding -> None], 
                 Graphics[{
                   EdgeForm[{Black, Thick}], White, 
                   Rectangle[{35, 20}, {65, 90}], Black, 
                   Arrow[{{10, 50}, {35, 50}}], 
                   Line[{{50, 90}, {50, 100}}], 
                   Line[{{50, 100}, {80, 100}}], 
                   Arrow[{{80, 100}, {80, 90}}], White, 
                   Rectangle[{75, 80}, {85, 90}], Black, 
                   Arrow[{{60, 20}, {60, 10}}], 
                   Line[{{55, 5}, {45, 5}}], 
                   Arrow[{{45, 5}, {45, 20}}], White, 
                   Rectangle[{55, 0}, {65, 10}], Black, 
                   Arrow[{{75, 85}, {65, 85}}], 
                   Arrow[{{85, 85}, {100, 85}}], 
                   Arrow[{{65, 5}, {100, 5}}], 
                   Text[
                    Style[
                    "Feed rate: \n1 kmol \!\(\*SuperscriptBox[\(h\), \
\(-1\)]\)", 12], {23, 42.5}], 
                   Text[
                    Style[
                    StringJoin["\!\(\*SubscriptBox[\(z\), \(f\)]\): ", 
                    ToString[$CellContext`zf], ""], 12], {23, 63}], 
                   Text[
                    Style[
                    StringJoin["quality: ", 
                    ToString[$CellContext`q], ""], 12], {23, 58}], 
                   Text[
                    Style["VLE", 12], {23, 53}], 
                   Text[
                    Style[
                    "distillate flow: \n N/A kmol \!\(\*SuperscriptBox[\(h\), \
\(-1\)]\)", 12], {95, 96.5}], 
                   Text[
                    Style[
                    "bottoms flow: \n N/A kmol \!\(\*SuperscriptBox[\(h\), \
\(-1\)]\)", 12], {94, 12}], 
                   Text[
                    Style["R", 12], {60, 5}], 
                   Text[
                    Style["C", 12], {80, 85}], 
                   Text[
                    Style[
                    StringJoin[
                    "reflux ratio (\!\(\*FractionBox[\(L\), \(D\)]\)): ", 
                    ToString[
                    SetPrecision[$CellContext`R$, 3]], ""], 12], {86, 71}]}, 
                  PlotRange -> {{10, 107}, {0, 107}}, 
                  ImageSize -> {280, 300}]}, Spacings -> -35, Alignment -> 
                Center]], 2 -> 
             If[$CellContext`yinters$ < \
$CellContext`equilb[$CellContext`xinters$], 
               
               Show[$CellContext`plt0$, $CellContext`plt6$, \
$CellContext`plt4$, $CellContext`plt5$, $CellContext`rstagelbl$, \
$CellContext`sstagelbl$, $CellContext`bottomsconc$, $CellContext`distilconc$, \
$CellContext`xdlabel$, 
                
                Graphics[{$CellContext`tbl1$, $CellContext`tbl2$, \
$CellContext`tbl3$, $CellContext`tbl4$, $CellContext`tblih$, \
$CellContext`tbliv$, {
                   RGBColor[0, 1, 0], 
                   Line[{{0, 0}, {1, 1}}]}}], PlotLabel -> Style[
                  Row[{
                    StringJoin["equilibrium stages needed = ", 
                    ToString[$CellContext`it$], " (including reboiler)"]}], 
                  14], ImageSize -> {550, 400}, Placed -> Center, AspectRatio -> 
                Full, PlotRangePadding -> None, 
                Epilog -> {$CellContext`xblabel$, $CellContext`reboilerlbl$, \
$CellContext`zlbl$}], 
               
               Show[$CellContext`plt0$, $CellContext`plt6$, \
$CellContext`plt4$, $CellContext`plt5$, 
                
                Graphics[{$CellContext`tbl1$, $CellContext`tbl2$, \
$CellContext`tblih$, $CellContext`tbliv$, {
                   RGBColor[0, 1, 0], 
                   Line[{{0, 0}, {1, 1}}]}}], PlotLabel -> Style[
                  Row[{"equilibrium stages needed = infinite (pinch point)"}],
                   14], ImageSize -> {550, 400}, AspectRatio -> Full, Placed -> 
                Center, PlotRangePadding -> 
                None]]}, $CellContext`window$$], $CellContext`OpStrp$[
             Pattern[$CellContext`x$, 
              
              Blank[]]] := $CellContext`yinters$ + (($CellContext`x$ - \
$CellContext`xinters$)/($CellContext`xb$$ - $CellContext`xinters$)) \
($CellContext`xb$$ - $CellContext`yinters$); $CellContext`plt4$ = Plot[
             $CellContext`OpRect$[$CellContext`x], {$CellContext`x, \
$CellContext`xinters$, $CellContext`xd$$}, PlotStyle -> 
             RGBColor[0, 1, 1]]; $CellContext`plt5$ = Plot[
             $CellContext`OpStrp$[$CellContext`x], {$CellContext`x, \
$CellContext`xb$$, $CellContext`xinters$}, PlotStyle -> 
             RGBColor[1, 0, 1]]; $CellContext`plt6$ = Plot[
             $CellContext`feed$[$CellContext`x], {$CellContext`x, \
$CellContext`xinters$, $CellContext`zf}, PlotStyle -> 
             RGBColor[0, 0, 1]]; $CellContext`plt7$ = Plot[
             $CellContext`equilb[$CellContext`m], {$CellContext`m, 0, 1}, 
             PlotStyle -> {
               RGBColor[0.5, 0.5, 0.5], Dashed}]; $CellContext`yr$[
            0] = $CellContext`xd$$; $CellContext`xr$[
            0] = $CellContext`xd$$; $CellContext`i$ = 0; 
          While[$CellContext`xr$[$CellContext`i$] > $CellContext`xinters$, \
{$CellContext`v$ = Part[
               Quiet[
                
                FindRoot[$CellContext`yr$[$CellContext`i$] == \
$CellContext`equilb[$CellContext`u], {$CellContext`u, 0.7}]], 1, 
               2], $CellContext`t = $CellContext`OpRect$[$CellContext`v$], 
             
             If[$CellContext`v$ > $CellContext`xinters$, \
{$CellContext`xr$[$CellContext`i$ + 
                 1] = $CellContext`v$, $CellContext`yr$[$CellContext`i$ + 
                 1] = $CellContext`t}], 
             Increment[$CellContext`i$]}]; $CellContext`ir$ = $CellContext`i$ - 
            1; $CellContext`i$ = 0; 
          If[$CellContext`ir$ >= 
            0, $CellContext`ys$[
              0] = $CellContext`yr$[$CellContext`ir$]; $CellContext`xs$[
              0] = $CellContext`xr$[$CellContext`ir$]]; 
          While[$CellContext`xs$[$CellContext`i$] > $CellContext`xb$$, \
{$CellContext`v$ = Part[
               Quiet[
                
                FindRoot[$CellContext`ys$[$CellContext`i$] == \
$CellContext`equilb[$CellContext`u], {$CellContext`u, 0.5}]], 1, 
               2], $CellContext`t = $CellContext`OpStrp$[$CellContext`v$], \
$CellContext`xs$[$CellContext`i$ + 
               1] = $CellContext`v$, $CellContext`ys$[$CellContext`i$ + 
               1] = $CellContext`t, 
             
             Increment[$CellContext`i$]}]; $CellContext`imax$ = \
$CellContext`i$ - 1; $CellContext`tbl1$ = Table[
             Line[{{
                $CellContext`xr$[$CellContext`i$], 
                $CellContext`yr$[$CellContext`i$ - 1]}, {
                $CellContext`xr$[$CellContext`i$], 
                $CellContext`yr$[$CellContext`i$]}}], {$CellContext`i$, 
              1, $CellContext`ir$}]; $CellContext`tbl2$ = 
           If[$CellContext`ir$ >= 1, 
             Table[
              Line[{{
                 $CellContext`xr$[$CellContext`i$], 
                 $CellContext`yr$[$CellContext`i$]}, {
                 $CellContext`xr$[$CellContext`i$ + 1], 
                 $CellContext`yr$[$CellContext`i$]}}], {$CellContext`i$, 
               0, $CellContext`ir$ - 1}], 
             Table[
              Line[{{
                 $CellContext`xr$[$CellContext`i$], 
                 $CellContext`yr$[$CellContext`i$]}, {
                 $CellContext`xr$[$CellContext`i$ + 1], 
                 $CellContext`yr$[$CellContext`i$]}}], {$CellContext`i$, 0, 
               0}]]; $CellContext`tbl3$ = Table[
             Line[{{
                $CellContext`xs$[$CellContext`i$ + 1], 
                $CellContext`ys$[$CellContext`i$]}, {
                $CellContext`xs$[$CellContext`i$ + 1], 
                $CellContext`ys$[$CellContext`i$ + 1]}}], {$CellContext`i$, 
              0, $CellContext`imax$ - 1}]; $CellContext`bottomsconc$ = 
           Graphics[
             Style[
              Line[{{
                 $CellContext`xs$[$CellContext`imax$ + 1], 
                 $CellContext`ys$[$CellContext`imax$]}, {
                 $CellContext`xs$[$CellContext`imax$ + 1], 0}}], 
              Dashed]]; $CellContext`xblabel$ = {White, 
             
             Rectangle[{$CellContext`xs$[$CellContext`imax$ + 1] + 0.045, 
               0.025}, {$CellContext`xs$[$CellContext`imax$ + 1] + 0.215, 
               0.085}], Black, 
             Style[
              Text[
               StringJoin["\!\(\*SubscriptBox[\(x\), \(b\)]\)= ", 
                ToString[
                 SetPrecision[
                  $CellContext`xs$[$CellContext`imax$ + 1], 2]], 
                ""], {$CellContext`xs$[$CellContext`imax$ + 1] + 0.135, 
                0.05}], 12]}; $CellContext`xdlabel$ = Graphics[
             Style[
              Text[
               StringJoin["\!\(\*SubscriptBox[\(x\), \(d\)]\)= ", 
                ToString[
                 SetPrecision[
                  $CellContext`xr$[0], 2]], ""], {$CellContext`xr$[0] - 0.1, 
                0.05}], 12], ImageSize -> {15, 13}]; $CellContext`distilconc$ = 
           Graphics[
             Style[
              Line[{{
                 $CellContext`xr$[0], 
                 $CellContext`yr$[0]}, {
                 $CellContext`xr$[0], 0}}], Dashed]]; $CellContext`tbl4$ = 
           Table[
             Line[{{
                $CellContext`xs$[$CellContext`i$ - 1], 
                $CellContext`ys$[$CellContext`i$ - 1]}, {
                $CellContext`xs$[$CellContext`i$], 
                $CellContext`ys$[$CellContext`i$ - 1]}}], {$CellContext`i$, 
              1, $CellContext`imax$ + 1}]; $CellContext`tblih$ = Line[{{
               $CellContext`xs$[1], 
               $CellContext`ys$[0]}, {
               $CellContext`xr$[$CellContext`ir$], 
               $CellContext`ys$[0]}}]; $CellContext`tbliv$ = Line[{{
               $CellContext`xs$[1], 
               $CellContext`ys$[0]}, {
               $CellContext`xs$[1], 
               $CellContext`ys$[
               1]}}]; $CellContext`it$ = $CellContext`imax$ + \
$CellContext`ir$ + 1; $CellContext`rstagelbl$ = Table[
             Graphics[
              Style[
               Text[
                StringJoin["", 
                 
                 ToString[$CellContext`ir$ + 
                  1 + $CellContext`imax$ - $CellContext`f], 
                 ""], {$CellContext`xr$[$CellContext`f] - 
                 0.0125, $CellContext`yr$[$CellContext`f - 1] + 0.015}], 12], 
              ImageSize -> {20, 10}], {$CellContext`f, 
              1, $CellContext`ir$}]; $CellContext`sstagelbl$ = Table[
             Graphics[
              Style[
               Text[
                StringJoin["", 
                 ToString[$CellContext`imax$ + 1 - $CellContext`f], 
                 ""], {$CellContext`xs$[$CellContext`f] - 
                 0.0125, $CellContext`ys$[$CellContext`f - 1] + 0.02}], 12], 
              ImageSize -> {20, 10}], {$CellContext`f, 
              1, $CellContext`imax$}]; $CellContext`reboilerlbl$ = {White, 
             Rectangle[{$CellContext`xs$[$CellContext`imax$ + 1] - 0.015, 
               $CellContext`ys$[$CellContext`imax$]}, \
{$CellContext`xs$[$CellContext`imax$ + 1] + 
               0.015, $CellContext`ys$[$CellContext`imax$] + 0.045}], Black, 
             Style[
              Text["R", {
                $CellContext`xs$[$CellContext`imax$ + 
                 1], $CellContext`ys$[$CellContext`imax$] + 0.025}], 
              12]}; $CellContext`feedstate$ = If[$CellContext`q < 0, 
             Text[
              Style["subcooled liquid", 10], {
              23, 23 + 70 ((2 $CellContext`imax$ + 1)/(2 $CellContext`it$))}], 
             If[$CellContext`q == 0, 
              Text[
               Style["saturated liquid", 10], {
               23, 23 + 70 ((2 $CellContext`imax$ + 1)/(
                  2 $CellContext`it$))}], 
              If[0 < $CellContext`q < 1, 
               Text[
                Style["VLE", 12], {
                23, 23 + 70 ((2 $CellContext`imax$ + 1)/(
                   2 $CellContext`it$))}], 
               If[$CellContext`q == 1, 
                Text[
                 Style["saturated vapor", 10], {
                 23, 23 + 70 ((2 $CellContext`imax$ + 1)/(
                    2 $CellContext`it$))}], 
                Text[
                 Style["superheated vapor", 10], {
                 23, 23 + 70 ((2 $CellContext`imax$ + 1)/(
                    2 $CellContext`it$))}]]]]]; $CellContext`distflow$ = \
($CellContext`zf - $CellContext`xs$[$CellContext`imax$ + 
              1])/$CellContext`xd$$; $CellContext`botflow$ = 
           1 - $CellContext`distflow$; $CellContext`stagelines$ = Table[
             
             Line[{{35, 20 + (70/$CellContext`it$) $CellContext`i$}, {
               65, 20 + (
                  70/$CellContext`it$) $CellContext`i$}}], {$CellContext`i$, 
              1, $CellContext`it$ - 1}]; $CellContext`stagelabels$ = Table[
             Style[
              Text[
               StringJoin["Stage ", 
                ToString[$CellContext`i$], ""], {
               50, 22 + (70/$CellContext`it$) $CellContext`i$}], 
              12], {$CellContext`i$, 1, $CellContext`it$ - 
              1}]; $CellContext`feedline$ = 
           Line[{{65, 20 + 
               70 ((2 $CellContext`imax$ + 1)/(2 $CellContext`it$))}, {
              85, 20 + 70 ((2 $CellContext`imax$ + 1)/(
                 2 $CellContext`it$))}}]; $CellContext`zlbl$ = {
             Style[
              Line[{{0.5, 0.5}, {0.5, 0}}], Dashed], White, 
             Rectangle[{0.45, 0.11}, {0.55, 0.19}], Black, 
             Style[
              Text["\!\(\*SubscriptBox[\(z\), \(f\)]\)= 0.5", {0.5, 0.15}], 
              12]}; PaneSelector[{
            1 -> If[$CellContext`yinters$ < \
$CellContext`equilb[$CellContext`xinters$], 
               GraphicsRow[{
                 
                 Show[$CellContext`plt0$, $CellContext`plt6$, \
$CellContext`plt4$, $CellContext`plt5$, $CellContext`rstagelbl$, \
$CellContext`sstagelbl$, $CellContext`bottomsconc$, $CellContext`distilconc$, \
$CellContext`xdlabel$, 
                  
                  Graphics[{$CellContext`tbl1$, $CellContext`tbl2$, \
$CellContext`tbl3$, $CellContext`tbl4$, $CellContext`tblih$, \
$CellContext`tbliv$, {
                    RGBColor[0, 1, 0], 
                    Line[{{0, 0}, {1, 1}}]}}], PlotLabel -> Style[
                    Row[{
                    StringJoin["equilibrium stages needed = ", 
                    ToString[$CellContext`it$], " (including reboiler)"]}], 
                    12], ImageSize -> {330, 300}, AspectRatio -> Full, 
                  PlotRangePadding -> None, 
                  Epilog -> {$CellContext`xblabel$, \
$CellContext`reboilerlbl$, $CellContext`zlbl$}], 
                 Graphics[{
                   EdgeForm[{Black, Thick}], White, 
                   Rectangle[{35, 20}, {65, 90}], Black, 
                   
                   Arrow[{{
                    10, 20 + 70 ((2 $CellContext`imax$ + 1)/(
                    2 $CellContext`it$))}, {
                    35, 20 + 70 ((2 $CellContext`imax$ + 1)/(
                    2 $CellContext`it$))}}], 
                   Line[{{50, 90}, {50, 100}}], 
                   Line[{{50, 100}, {80, 100}}], 
                   Arrow[{{80, 100}, {80, 90}}], White, 
                   Rectangle[{75, 80}, {85, 90}], Black, 
                   Arrow[{{60, 20}, {60, 10}}], 
                   Line[{{55, 5}, {45, 5}}], 
                   Arrow[{{45, 5}, {45, 20}}], White, 
                   Rectangle[{55, 0}, {65, 10}], Black, 
                   Arrow[{{75, 85}, {65, 85}}], 
                   Arrow[{{85, 85}, {100, 85}}], 
                   Arrow[{{65, 5}, {100, 5}}], 
                   Text[
                    Style[
                    "Feed rate: \n1 kmol \!\(\*SuperscriptBox[\(h\), \
\(-1\)]\)", 12], {23, 12.5 + 
                    70 ((2 $CellContext`imax$ + 1)/(2 $CellContext`it$))}], 
                   Text[
                    Style[
                    StringJoin["\!\(\*SubscriptBox[\(z\), \(f\)]\): ", 
                    ToString[$CellContext`zf], ""], 12], {
                    23, 33 + 70 ((2 $CellContext`imax$ + 1)/(
                    2 $CellContext`it$))}], 
                   Text[
                    Style[
                    StringJoin["quality: ", 
                    ToString[$CellContext`q], ""], 12], {
                    23, 28 + 70 ((2 $CellContext`imax$ + 1)/(
                    2 $CellContext`it$))}], $CellContext`feedstate$, 
                   Text[
                    Style[
                    StringJoin["distillate flow: \n", 
                    ToString[
                    SetPrecision[$CellContext`distflow$, 2]], 
                    " kmol \!\(\*SuperscriptBox[\(h\), \(-1\)]\)"], 12], {
                    95, 96.5}], 
                   Text[
                    Style[
                    StringJoin["bottoms flow: \n", 
                    ToString[
                    SetPrecision[$CellContext`botflow$, 2]], 
                    " kmol \!\(\*SuperscriptBox[\(h\), \(-1\)]\)"], 12], {94, 
                    12}], $CellContext`stagelines$, $CellContext`stagelabels$, 
                   Text[
                    Style["R", 12], {60, 5}], 
                   Text[
                    Style["C", 12], {80, 85}], 
                   Text[
                    Style[
                    StringJoin[
                    "reflux ratio (\!\(\*FractionBox[\(L\), \(D\)]\)): ", 
                    ToString[
                    SetPrecision[$CellContext`R$, 3]], ""], 12], {86, 71}]}, 
                  PlotRange -> {{10, 107}, {0, 107}}, 
                  ImageSize -> {280, 300}]}, Spacings -> -35, Alignment -> 
                Center], 
               GraphicsRow[{
                 
                 Show[$CellContext`plt0$, $CellContext`plt6$, \
$CellContext`plt4$, $CellContext`plt5$, 
                  
                  Graphics[{$CellContext`tbl1$, $CellContext`tbl2$, \
$CellContext`tblih$, $CellContext`tbliv$, {
                    RGBColor[0, 1, 0], 
                    Line[{{0, 0}, {1, 1}}]}}], PlotLabel -> Style[
                    
                    Row[{"equilibrium stages needed = infinite (pinch \
point)"}], 12], ImageSize -> {330, 300}, AspectRatio -> Full, 
                  PlotRangePadding -> None], 
                 Graphics[{
                   EdgeForm[{Black, Thick}], White, 
                   Rectangle[{35, 20}, {65, 90}], Black, 
                   Arrow[{{10, 50}, {35, 50}}], 
                   Line[{{50, 90}, {50, 100}}], 
                   Line[{{50, 100}, {80, 100}}], 
                   Arrow[{{80, 100}, {80, 90}}], White, 
                   Rectangle[{75, 80}, {85, 90}], Black, 
                   Arrow[{{60, 20}, {60, 10}}], 
                   Line[{{55, 5}, {45, 5}}], 
                   Arrow[{{45, 5}, {45, 20}}], White, 
                   Rectangle[{55, 0}, {65, 10}], Black, 
                   Arrow[{{75, 85}, {65, 85}}], 
                   Arrow[{{85, 85}, {100, 85}}], 
                   Arrow[{{65, 5}, {100, 5}}], 
                   Text[
                    Style[
                    "Feed rate: \n1 kmol \!\(\*SuperscriptBox[\(h\), \
\(-1\)]\)", 12], {23, 42.5}], 
                   Text[
                    Style[
                    StringJoin["\!\(\*SubscriptBox[\(z\), \(f\)]\): ", 
                    ToString[$CellContext`zf], ""], 10], {23, 63}], 
                   Text[
                    Style[
                    StringJoin["quality: ", 
                    ToString[$CellContext`q], ""], 12], {23, 58}], 
                   Text[
                    Style["VLE", 12], {23, 53}], 
                   Text[
                    Style[
                    "distillate flow: \n N/A kmol \!\(\*SuperscriptBox[\(h\), \
\(-1\)]\)", 10], {95, 96.5}], 
                   Text[
                    Style[
                    "bottoms flow: \n N/A kmol \!\(\*SuperscriptBox[\(h\), \
\(-1\)]\)", 12], {94, 12}], 
                   Text[
                    Style["R", 12], {60, 5}], 
                   Text[
                    Style["C", 12], {80, 85}], 
                   Text[
                    Style[
                    StringJoin[
                    "reflux ratio (\!\(\*FractionBox[\(L\), \(D\)]\)): ", 
                    ToString[
                    SetPrecision[$CellContext`R$, 3]], ""], 12], {86, 71}]}, 
                  PlotRange -> {{10, 107}, {0, 107}}, 
                  ImageSize -> {280, 300}]}, Spacings -> -35, Alignment -> 
                Center]], 2 -> 
             If[$CellContext`yinters$ < \
$CellContext`equilb[$CellContext`xinters$], 
               
               Show[$CellContext`plt0$, $CellContext`plt6$, \
$CellContext`plt4$, $CellContext`plt5$, $CellContext`rstagelbl$, \
$CellContext`sstagelbl$, $CellContext`bottomsconc$, $CellContext`distilconc$, \
$CellContext`xdlabel$, 
                
                Graphics[{$CellContext`tbl1$, $CellContext`tbl2$, \
$CellContext`tbl3$, $CellContext`tbl4$, $CellContext`tblih$, \
$CellContext`tbliv$, {
                   RGBColor[0, 1, 0], 
                   Line[{{0, 0}, {1, 1}}]}}], PlotLabel -> Style[
                  Row[{
                    StringJoin["equilibrium stages needed = ", 
                    ToString[$CellContext`it$], " (including reboiler)"]}], 
                  14], ImageSize -> {550, 400}, Placed -> Center, AspectRatio -> 
                Full, PlotRangePadding -> None, 
                Epilog -> {$CellContext`xblabel$, $CellContext`reboilerlbl$, \
$CellContext`zlbl$}], 
               
               Show[$CellContext`plt0$, $CellContext`plt6$, \
$CellContext`plt4$, $CellContext`plt5$, 
                
                Graphics[{$CellContext`tbl1$, $CellContext`tbl2$, \
$CellContext`tblih$, $CellContext`tbliv$, {
                   RGBColor[0, 1, 0], 
                   Line[{{0, 0}, {1, 1}}]}}], PlotLabel -> Style[
                  Row[{"equilibrium stages needed = infinite (pinch point)"}],
                   14], ImageSize -> {550, 400}, AspectRatio -> Full, Placed -> 
                Center, PlotRangePadding -> None]]}, $CellContext`window$$]]],
       "Specifications" :> {{{$CellContext`window$$, 1}, {
         1 -> "show flow diagram", 2 -> "hide flow diagram"}, ControlType -> 
         SetterBar, ControlPlacement -> 1}, {{$CellContext`xd$$, 0.85, 
          
          Row[{"distillate specification (\!\(\*SubscriptBox[\(x\), \
\(d\)]\))"}]}, 0.8, 0.98, 0.01, Appearance -> {"Labeled", Small}, ImageSize -> 
         Small, ControlPlacement -> 
         2}, {{$CellContext`xb$$, 0.15, 
          "bottoms specification (\!\(\*SubscriptBox[\(x\), \(b\)]\))"}, 0.05,
          0.2, 0.01, Appearance -> {"Labeled", Small}, ImageSize -> Small, 
         ControlPlacement -> 
         3}, {{$CellContext`lvmult$$, 3, 
          "external reflux ratio (\!\(\*FractionBox[\(L\), \(D\)]\))"}, 0.25, 
         10, 0.25, Appearance -> {"Labeled", Small}, ImageSize -> Small, 
         ControlPlacement -> 4}, 
        Grid[{{
           Manipulate`Place[1], 
           Manipulate`Place[2]}, {
           Manipulate`Place[3], 
           Manipulate`Place[4]}}, Alignment -> Center]}, 
      "Options" :> {
       TrackedSymbols -> Manipulate, SynchronousUpdating -> False}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{645., {254., 259.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`zf = 0.5, $CellContext`q = 
       0.5, $CellContext`mve = 1, $CellContext`P = 760, $CellContext`AMet = 
       8.08097, $CellContext`BMet = 1582.271, $CellContext`CMet = 
       239.726, $CellContext`VPMet = 
       10^(8.08097 - 1582.271/(239.726 + $CellContext`T)), $CellContext`T[0] = 
       99.99682973671648, $CellContext`T[1] = 
       98.21946006882526, $CellContext`T[2] = 
       96.60997113930603, $CellContext`T[3] = 
       95.1452592525535, $CellContext`T[4] = 
       93.8063056729462, $CellContext`T[5] = 
       92.57730265010647, $CellContext`T[6] = 
       91.44499511362586, $CellContext`T[7] = 
       90.39817860132489, $CellContext`T[8] = 
       89.4273118739457, $CellContext`T[9] = 
       88.52421477399663, $CellContext`T[10] = 
       87.68183019055046, $CellContext`T[11] = 
       86.8940347651278, $CellContext`T[12] = 
       86.155487039119, $CellContext`T[13] = 
       85.46150464091626, $CellContext`T[14] = 
       84.80796420047079, $CellContext`T[15] = 
       84.19121920221346, $CellContext`T[16] = 
       83.60803210950365, $CellContext`T[17] = 
       83.05551792843781, $CellContext`T[18] = 
       82.5310970056507, $CellContext`T[19] = 
       82.03245532948513, $CellContext`T[20] = 
       81.55751096652205, $CellContext`T[21] = 
       81.10438554461557, $CellContext`T[22] = 
       80.67137991009221, $CellContext`T[23] = 
       80.25695325589052, $CellContext`T[24] = 
       79.85970515043964, $CellContext`T[25] = 
       79.4783600022914, $CellContext`T[26] = 
       79.11175357938417, $CellContext`T[27] = 
       78.75882126891229, $CellContext`T[28] = 
       78.41858781784521, $CellContext`T[29] = 
       78.09015833790441, $CellContext`T[30] = 
       77.77271039441422, $CellContext`T[31] = 
       77.46548702755757, $CellContext`T[32] = 
       77.16779057847738, $CellContext`T[33] = 
       76.87897721239078, $CellContext`T[34] = 
       76.59845204722487, $CellContext`T[35] = 
       76.32566480987427, $CellContext`T[36] = 
       76.06010595353105, $CellContext`T[37] = 
       75.8013031790485, $CellContext`T[38] = 
       75.54881831130287, $CellContext`T[39] = 
       75.30224448826755, $CellContext`T[40] = 
       75.06120362623399, $CellContext`T[41] = 
       74.82534412947032, $CellContext`T[42] = 
       74.59433881674713, $CellContext`T[43] = 
       74.36788304069852, $CellContext`T[44] = 
       74.14569297901582, $CellContext`T[45] = 
       73.92750407907944, $CellContext`T[46] = 
       73.71306963987671, $CellContext`T[47] = 
       73.50215951699536, $CellContext`T[48] = 
       73.29455893815961, $CellContext`T[49] = 
       73.09006741823646, $CellContext`T[50] = 
       72.8884977639067, $CellContext`T[51] = 
       72.68967515930277, $CellContext`T[52] = 
       72.49343632488225, $CellContext`T[53] = 
       72.29962874265314, $CellContext`T[54] = 
       72.10810994161041, $CellContext`T[55] = 
       71.91874683789692, $CellContext`T[56] = 
       71.73141512477811, $CellContext`T[57] = 
       71.54599870802853, $CellContext`T[58] = 
       71.36238918277667, $CellContext`T[59] = 
       71.18048534825554, $CellContext`T[60] = 
       71.00019275725656, $CellContext`T[61] = 
       70.82142329740165, $CellContext`T[62] = 
       70.64409480162657, $CellContext`T[63] = 
       70.46813068551815, $CellContext`T[64] = 
       70.29345960937154, $CellContext`T[65] = 
       70.12001516303211, $CellContext`T[66] = 
       69.94773557176647, $CellContext`T[67] = 
       69.77656342156524, $CellContext`T[68] = 
       69.6064454024261, $CellContext`T[69] = 
       69.43733206829398, $CellContext`T[70] = 
       69.26917761245164, $CellContext`T[71] = 
       69.10193965725921, $CellContext`T[72] = 
       68.93557905723723, $CellContext`T[73] = 
       68.77005971457062, $CellContext`T[74] = 
       68.60534840619249, $CellContext`T[75] = 
       68.44141462167278, $CellContext`T[76] = 
       68.27823041120466, $CellContext`T[77] = 
       68.11577024303699, $CellContext`T[78] = 
       67.9540108697468, $CellContext`T[79] = 
       67.79293120282252, $CellContext`T[80] = 
       67.63251219501953, $CellContext`T[81] = 
       67.47273673004487, $CellContext`T[82] = 
       67.31358951912902, $CellContext`T[83] = 
       67.15505700408784, $CellContext`T[84] = 
       66.99712726650593, $CellContext`T[85] = 
       66.83978994270075, $CellContext`T[86] = 
       66.68303614415002, $CellContext`T[87] = 
       66.52685838309158, $CellContext`T[88] = 
       66.3712505030205, $CellContext`T[89] = 
       66.21620761383333, $CellContext`T[90] = 
       66.06172603138161, $CellContext`T[91] = 
       65.90780322121635, $CellContext`T[92] = 
       65.75443774631901, $CellContext`T[93] = 
       65.60162921862546, $CellContext`T[94] = 
       65.44937825416643, $CellContext`T[95] = 
       65.29768643165389, $CellContext`T[96] = 
       65.1465562543569, $CellContext`T[97] = 
       64.99599111511763, $CellContext`T[98] = 
       64.8459952643676, $CellContext`T[99] = 
       64.69657378101162, $CellContext`T[100] = 
       64.54773254605333, $CellContext`VPWat = 
       10^(8.07131 - 1730.63/(233.426 + $CellContext`T)), $CellContext`AWat = 
       8.07131, $CellContext`BWat = 1730.63, $CellContext`CWat = 
       233.426, $CellContext`A12 = 0.5434, $CellContext`A21 = 
       0.7923, $CellContext`\[Gamma]1[
         Pattern[$CellContext`i, 
          Blank[]]] = 
       E^((0.5434 + 
          0.4978 (1 - $CellContext`x2[$CellContext`i])) \
$CellContext`x2[$CellContext`i]^2), $CellContext`x2[0] = 
       0., $CellContext`x2[1] = 0.01, $CellContext`x2[2] = 
       0.02, $CellContext`x2[3] = 0.03, $CellContext`x2[4] = 
       0.04, $CellContext`x2[5] = 0.05, $CellContext`x2[6] = 
       0.06, $CellContext`x2[7] = 0.07, $CellContext`x2[8] = 
       0.08, $CellContext`x2[9] = 0.09, $CellContext`x2[10] = 
       0.1, $CellContext`x2[11] = 0.11, $CellContext`x2[12] = 
       0.12, $CellContext`x2[13] = 0.13, $CellContext`x2[14] = 
       0.14, $CellContext`x2[15] = 0.15, $CellContext`x2[16] = 
       0.16, $CellContext`x2[17] = 0.17, $CellContext`x2[18] = 
       0.18, $CellContext`x2[19] = 0.19, $CellContext`x2[20] = 
       0.2, $CellContext`x2[21] = 0.21, $CellContext`x2[22] = 
       0.22, $CellContext`x2[23] = 0.23, $CellContext`x2[24] = 
       0.24, $CellContext`x2[25] = 0.25, $CellContext`x2[26] = 
       0.26, $CellContext`x2[27] = 0.27, $CellContext`x2[28] = 
       0.28, $CellContext`x2[29] = 0.29, $CellContext`x2[30] = 
       0.3, $CellContext`x2[31] = 0.31, $CellContext`x2[32] = 
       0.32, $CellContext`x2[33] = 0.33, $CellContext`x2[34] = 
       0.34, $CellContext`x2[35] = 0.35000000000000003`, $CellContext`x2[36] = 
       0.36, $CellContext`x2[37] = 0.37, $CellContext`x2[38] = 
       0.38, $CellContext`x2[39] = 0.39, $CellContext`x2[40] = 
       0.4, $CellContext`x2[41] = 0.41000000000000003`, $CellContext`x2[42] = 
       0.42, $CellContext`x2[43] = 0.43, $CellContext`x2[44] = 
       0.44, $CellContext`x2[45] = 0.45, $CellContext`x2[46] = 
       0.46, $CellContext`x2[47] = 0.47000000000000003`, $CellContext`x2[48] = 
       0.48, $CellContext`x2[49] = 0.49, $CellContext`x2[50] = 
       0.5, $CellContext`x2[51] = 0.51, $CellContext`x2[52] = 
       0.52, $CellContext`x2[53] = 0.53, $CellContext`x2[54] = 
       0.54, $CellContext`x2[55] = 0.55, $CellContext`x2[56] = 
       0.56, $CellContext`x2[57] = 0.5700000000000001, $CellContext`x2[58] = 
       0.58, $CellContext`x2[59] = 0.59, $CellContext`x2[60] = 
       0.6, $CellContext`x2[61] = 0.61, $CellContext`x2[62] = 
       0.62, $CellContext`x2[63] = 0.63, $CellContext`x2[64] = 
       0.64, $CellContext`x2[65] = 0.65, $CellContext`x2[66] = 
       0.66, $CellContext`x2[67] = 0.67, $CellContext`x2[68] = 
       0.68, $CellContext`x2[69] = 0.6900000000000001, $CellContext`x2[70] = 
       0.7000000000000001, $CellContext`x2[71] = 0.71, $CellContext`x2[72] = 
       0.72, $CellContext`x2[73] = 0.73, $CellContext`x2[74] = 
       0.74, $CellContext`x2[75] = 0.75, $CellContext`x2[76] = 
       0.76, $CellContext`x2[77] = 0.77, $CellContext`x2[78] = 
       0.78, $CellContext`x2[79] = 0.79, $CellContext`x2[80] = 
       0.8, $CellContext`x2[81] = 0.81, $CellContext`x2[82] = 
       0.8200000000000001, $CellContext`x2[83] = 
       0.8300000000000001, $CellContext`x2[84] = 0.84, $CellContext`x2[85] = 
       0.85, $CellContext`x2[86] = 0.86, $CellContext`x2[87] = 
       0.87, $CellContext`x2[88] = 0.88, $CellContext`x2[89] = 
       0.89, $CellContext`x2[90] = 0.9, $CellContext`x2[91] = 
       0.91, $CellContext`x2[92] = 0.92, $CellContext`x2[93] = 
       0.93, $CellContext`x2[94] = 0.9400000000000001, $CellContext`x2[95] = 
       0.9500000000000001, $CellContext`x2[96] = 0.96, $CellContext`x2[97] = 
       0.97, $CellContext`x2[98] = 0.98, $CellContext`x2[99] = 
       0.99, $CellContext`x2[100] = 1., $CellContext`\[Gamma]2[
         Pattern[$CellContext`i, 
          Blank[]]] = 
       E^((1 - $CellContext`x2[$CellContext`i])^2 (0.7923 - 
          0.4978 $CellContext`x2[$CellContext`i])), $CellContext`y2[0] = 
       0., $CellContext`y2[1] = 0.0713265084129491, $CellContext`y2[2] = 
       0.1327588360532387, $CellContext`y2[3] = 
       0.18617359504869407`, $CellContext`y2[4] = 
       0.23301303195110273`, $CellContext`y2[5] = 
       0.2744016996325357, $CellContext`y2[6] = 
       0.31122795363535855`, $CellContext`y2[7] = 
       0.34420191307605674`, $CellContext`y2[8] = 
       0.3738973656038224, $CellContext`y2[9] = 
       0.4007825225409765, $CellContext`y2[10] = 
       0.42524290387113717`, $CellContext`y2[11] = 
       0.44759858405021213`, $CellContext`y2[12] = 
       0.4681173408737574, $CellContext`y2[13] = 
       0.48702478951108696`, $CellContext`y2[14] = 
       0.5045122715238102, $CellContext`y2[15] = 
       0.5207430535867018, $CellContext`y2[16] = 
       0.5358572404351288, $CellContext`y2[17] = 
       0.5499757003378076, $CellContext`y2[18] = 
       0.5632032253664141, $CellContext`y2[19] = 
       0.5756310937059816, $CellContext`y2[20] = 
       0.5873391610027535, $CellContext`y2[21] = 
       0.5983975780173573, $CellContext`y2[22] = 
       0.6088682096875453, $CellContext`y2[23] = 
       0.6188058140356989, $CellContext`y2[24] = 
       0.6282590267166825, $CellContext`y2[25] = 
       0.6372711873402513, $CellContext`y2[26] = 
       0.6458810362656919, $CellContext`y2[27] = 
       0.6541233047988793, $CellContext`y2[28] = 
       0.6620292172212718, $CellContext`y2[29] = 
       0.6696269195449821, $CellContext`y2[30] = 
       0.6769418470944896, $CellContext`y2[31] = 
       0.6839970407953876, $CellContext`y2[32] = 
       0.6908134202764197, $CellContext`y2[33] = 
       0.697410020465988, $CellContext`y2[34] = 
       0.7038041972138824, $CellContext`y2[35] = 
       0.7100118065357496, $CellContext`y2[36] = 
       0.716047361317491, $CellContext`y2[37] = 
       0.7219241686944147, $CellContext`y2[38] = 
       0.7276544508084978, $CellContext`y2[39] = 
       0.7332494512251161, $CellContext`y2[40] = 
       0.738719528940946, $CellContext`y2[41] = 
       0.744074241624106, $CellContext`y2[42] = 
       0.7493224194850119, $CellContext`y2[43] = 
       0.7544722309733664, $CellContext`y2[44] = 
       0.7595312413261001, $CellContext`y2[45] = 
       0.764506464847261, $CellContext`y2[46] = 
       0.7694044116793626, $CellContext`y2[47] = 
       0.7742311297225841, $CellContext`y2[48] = 
       0.7789922422706423, $CellContext`y2[49] = 
       0.783692981857395, $CellContext`y2[50] = 
       0.788338220744416, $CellContext`y2[51] = 
       0.7929324984249544, $CellContext`y2[52] = 
       0.7974800464727274, $CellContext`y2[53] = 
       0.8019848110233828, $CellContext`y2[54] = 
       0.8064504731416016, $CellContext`y2[55] = 
       0.810880467296376, $CellContext`y2[56] = 
       0.8152779981408929, $CellContext`y2[57] = 
       0.8196460557706, $CellContext`y2[58] = 
       0.8239874296130217, $CellContext`y2[59] = 
       0.8283047210858469, $CellContext`y2[60] = 
       0.8326003551443146, $CellContext`y2[61] = 
       0.8368765908259601, $CellContext`y2[62] = 
       0.8411355308888939, $CellContext`y2[63] = 
       0.8453791306297432, $CellContext`y2[64] = 
       0.8496092059582223, $CellContext`y2[65] = 
       0.8538274407974416, $CellContext`y2[66] = 
       0.858035393872065, $CellContext`y2[67] = 
       0.8622345049401188, $CellContext`y2[68] = 
       0.8664261005188618, $CellContext`y2[69] = 
       0.8706113991502034, $CellContext`y2[70] = 
       0.8747915162468219, $CellContext`y2[71] = 
       0.878967468556284, $CellContext`y2[72] = 
       0.8831401782770903, $CellContext`y2[73] = 
       0.8873104768573862, $CellContext`y2[74] = 
       0.8914791085045388, $CellContext`y2[75] = 
       0.8956467334310929, $CellContext`y2[76] = 
       0.899813930860723, $CellContext`y2[77] = 
       0.9039812018155857, $CellContext`y2[78] = 
       0.9081489717046616, $CellContext`y2[79] = 
       0.9123175927319381, $CellContext`y2[80] = 
       0.9164873461401789, $CellContext`y2[81] = 
       0.9206584443065575, $CellContext`y2[82] = 
       0.9248310327041909, $CellContext`y2[83] = 
       0.9290051917428603, $CellContext`y2[84] = 
       0.9331809385013335, $CellContext`y2[85] = 
       0.9373582283627508, $CellContext`y2[86] = 
       0.9415369565637908, $CellContext`y2[87] = 
       0.9457169596677109, $CellContext`y2[88] = 
       0.9498980169705386, $CellContext`y2[89] = 
       0.9540798518493078, $CellContext`y2[90] = 
       0.9582621330605233, $CellContext`y2[91] = 
       0.9624444759966418, $CellContext`y2[92] = 
       0.9666264439079109, $CellContext`y2[93] = 
       0.9708075490963227, $CellContext`y2[94] = 
       0.9749872540883283, $CellContext`y2[95] = 
       0.9791649727922535, $CellContext`y2[96] = 
       0.9833400716462812, $CellContext`y2[97] = 
       0.9875118707623988, $CellContext`y2[98] = 
       0.991679645071342, $CellContext`y2[99] = 
       0.9958426254734836, $CellContext`y2[100] = 
       1.000000000000002, $CellContext`tb = CompressedData["
1:eJxdkntQVHUUx5F1SU3BBxhi4wspGhvIR6KAfBMHH5gRFmhJOjGg41qiASsD
jcIEpCGBsYxAyZSAzWLiiEgg5ihI6wPM5bWAC+777u7dey8PMV+zxK7nr87M
nTv38Tvn+/1+zuL4pO2Jri4uLokTl+P+/8rwrNmkTc9G+OWnoSnhtXj1LENx
RH73OvsNNCzIYaMbyrEk2T3qRJeCvlfCfkf3YndnO8pKHSWHz2CaX1uBkv6v
wYEbZ875s52wRTveXILsyNPUfa/10Pk66GfEBAmcCtNUFYfWTfsT3W2KawfO
9VG/RkzWh4kCgh7inbiC5jH/a5jc4X48pUpN/a+j9VRS0tmxAVROnFZV3EDs
uQ6xZNkjmncTMtGn7JOlGqx0VgvmtXrHcnINzb+FLW17vK77adEy5j8xoRUJ
qcqKvaVa0qPAGklYa7NYh+3OgbchM3xgOnVAR/ruYMsO8bGMezpo0x0N76JI
982F2W/pSW8bZJ3iwL4MPQ475B1qxy8pTX3r2/Wk/z5Wbar6o9bHgFcUHmAZ
cyIvN8FAfh4g89aLOvfzBmx2DlAidNX740W8gfwpIVGUG3cEGuGYFlfQAfGw
/WDx10by24m/ZnWMZMmNcNpRdYJVe7ds0xvJfxdCVv17fel8ExY65Czoxoam
RmVAtIny6MbQxuAvC3NM2LfXUT04M3V+jaTBRPmoIKiZt9UWExzdPGtUcM1S
1bv4MJRXL/Rxv74c3szgiaPdWC92fViWr5AylF8fhp+u9j1dwSDM2bAfUyJr
b6f8w1Ce/che1OSa/JyBU17OQyysbhg5u9RM+aox5rdW6vmRGe1tjlKjJFC0
oUdqprwH8NPocpcn5WZ4OQUOwj+7Pi7zbzPlP4jejJO+WZwZznZxj9DfZdwm
8rQQDw2i3jgxZ1awhfxocFda/OzyHgvx0SBd1P/ocbaF/GkQfZSZrpZbiJcW
V2Xjaw7ft5BfLeTzXEqaRizET4vwkETdzblW8q9DbGH6Fz8EW4mnDp3eD3Q+
u62Uhw5Vj8VMWpaV+OoRmjx+TF5ppXz0uBtzUnJJYSXeesz9ttij2GqlvAxY
2dF7fOcMlvgbsGIOqsYDWcrPgDhNly1/O0v7YMT6+qRKt1SW8jTCLnFTfnWa
pf0wIsH3VnBLI0v5mpAw/jBpupqlfTHhip+vItLOUt4TexMljc9cZKP9YVCU
Lrx3MdxG+TMIEQ8N9SbYaJ8Y8CLRivFcG/EwIzP+51hfuY14mBHidql44z0b
8TDDx4iX+zkb8TDjefP5gz96cMTDgknvvl5dt5wjHhas7dkVMfAJRzwsWPL7
2dopUo54WOG69RmCSjgUOnlYkb08z3v/VY54WLGn8ruIcjVHPFjE5/E1PXaO
eLAYjM1/c/ZinniwqE7+bfXHG3jiYYNXwYXcwkSeeNhwUx+Q1vE9Tzxs2Hox
6jOvap54cLijK9q1s40nHhwOzsySlfE88eDgkR1u758pEA8eMYci07xXCsSD
x5VJw4roGIF48Ej3m12ac0QgHgKUzdVHa0sF4iFgdK50tKdJIB4CJLq8z4cH
BOIxhKl0/w/+Ey5m
        "], $CellContext`equilb = 
       InterpolatingFunction[{{0., 1.}}, {
         5, 7, 0, {101}, {4}, 0, 0, 0, 0, Automatic, {}, {}, 
          False}, CompressedData["
1:eJxFkD1MwmAQhqsjM64YN5yd9UZdYWYyQUdxxVVnHFx0cIHFhcTEREyMUdH4
EzAgYhERW34LLeCCs3wfT+IlhELv7n2eW1jfCkdnDcOYmXyixn/t+NOrdnxX
pt8HkgnsuaHMMb9TcnSo6oT/0+KF1NMp78/EZyZjy75z+i5kMZK4HQcv6b+S
1OStmbxm7kaWdGWZv5PsODiZuGfPg4T14CP7nsSOq8Zn9uZkW62L5dn/IlOL
AjkFWdMDRfKKoqYiiVdyS6JjzBL5bzKv1gTKcJRlc0PVOzymqC5/2oSrIr+q
bVyB70NWdGMVzqrodXuf8NYkn1NVg/tL5vTCOvx10W2Rbzwscix8LPIsvGxy
bfxs8ht4NuBo4NuEp4l3E64W/i34WtyhDWebe7Th7XCXDtwd7tOFv8udung4
eDh4OHg4ePTw6OHRw6Mv+9qjj0cfDxcPFw8XDw8PDw8PjwEeAzwGeAzxGOIx
xGOExwiPER4/8gdMi46v
         "], {
         Developer`PackedArrayForm, {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
           13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29,
           30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46,
           47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63,
           64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,
           81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97,
           98, 99, 100, 101}, CompressedData["
1:eJxFk31QjAkAh7fW5ruIurVu5rAtZtyU6ER1fmebHPlIXMspGk0xNlpUqylD
O1YknWh3lI+GVGbXYSwaLIbI+sid3bIqG3n3493dd9/3bctHPmb3zP3j+eeZ
ef5/JmfJVuYEcDicHM53xFcGEwrEOqiTKl/86ruLKfnBKeUdBvgeE1/Wtz+D
4HWRqO2wEbl3TzVNp9qh2jlYuGmoGdbRabEs/RIv2gy3cpu6MMQ6nxsZ+wpD
TMEHChotaD0ik9W/74GkycSTzngDFfcP6kNELya08iW0pheL2zLD7ojeIrvQ
eHZj7VvMlc5vbeERUNl+cxzJJbB4NW9PyVMC1cSOC6FTrVC186K6Sqw4WaDv
WvDMipjfG//WCWyYQZZXlGXbUPrgy9Xg8zYkxPzir2ZskBrq7Kuj7OB5fXnq
rXbcHmvqV2jsoCz8+8usdsTHfLwTMdGBRP0NY2SqA30L4zZU7XPg1PCJF6XX
HWAt5DSLy4FAxctmjoCENeP0V+8iEulLj1ca5CS8g3OEx86SGJase1TwLwnl
JH1g/mcSP2mv99dHOPFeNE8+frkTNVHcRLPciaMD0ZwPdU5MVzZnlD50orPk
kFBBO9HdYV/GHe9Cyg/l48bGufBErv50JdOFYm73m3dKF1J3k6MsGhduqvxz
t//jgmYCp0bf74I4Poe4F+6GpKp43cE4N9r5zwnBejca3/HIIoUbCfn+PZoG
N56kHZJeNrgRvksdona7MdvUeWDNaAqzxqHRH0Uho7fDU7mSwoJmWUNQIQWf
NMi45RiFbOGDuPs3vtn/SjbKQuGaSGhI9lEYkSLPKp3kQXUxO/OS2IN4Xl9f
Z7YHDJc7y1/mQWnWCYlQ860HXVYvfOqBwI6vm2kPPrecz/srhEbAzyO1V6Np
zDOnJ/WsojHlXL1umJxG4JJPiK2hoYyu4G++SSOzYW9SnYVGVgVz0eyj8VpS
+WPoZAba/DNzViQyCDt8oawqh8E9a2SRaT+DJZdS/gzTMnhMVKevaWOQN0ah
Os4wCFGKfd1jWKRtSy7iz2ZxLcBrSE1jUSwKrd23k4WxRbtbV8tiIFw+YNaz
kBIVa709LIb/f0cf/gMtUKG3
          "]}, {Automatic}], $CellContext`equilb2[
         Pattern[$CellContext`m, 
          Blank[]]] = 
       InterpolatingFunction[{{0., 1.}}, {
         5, 7, 0, {101}, {4}, 0, 0, 0, 0, Automatic, {}, {}, 
          False}, CompressedData["
1:eJxFkD1MwmAQhqsjM64YN5yd9UZdYWYyQUdxxVVnHFx0cIHFhcTEREyMUdH4
EzAgYhERW34LLeCCs3wfT+IlhELv7n2eW1jfCkdnDcOYmXyixn/t+NOrdnxX
pt8HkgnsuaHMMb9TcnSo6oT/0+KF1NMp78/EZyZjy75z+i5kMZK4HQcv6b+S
1OStmbxm7kaWdGWZv5PsODiZuGfPg4T14CP7nsSOq8Zn9uZkW62L5dn/IlOL
AjkFWdMDRfKKoqYiiVdyS6JjzBL5bzKv1gTKcJRlc0PVOzymqC5/2oSrIr+q
bVyB70NWdGMVzqrodXuf8NYkn1NVg/tL5vTCOvx10W2Rbzwscix8LPIsvGxy
bfxs8ht4NuBo4NuEp4l3E64W/i34WtyhDWebe7Th7XCXDtwd7tOFv8udung4
eDh4OHg4ePTw6OHRw6Mv+9qjj0cfDxcPFw8XDw8PDw8PjwEeAzwGeAzxGOIx
xGOExwiPER4/8gdMi46v
         "], {
         Developer`PackedArrayForm, {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,
           13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29,
           30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46,
           47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63,
           64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,
           81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97,
           98, 99, 100, 101}, CompressedData["
1:eJxFk31QjAkAh7fW5ruIurVu5rAtZtyU6ER1fmebHPlIXMspGk0xNlpUqylD
O1YknWh3lI+GVGbXYSwaLIbI+sid3bIqG3n3493dd9/3bctHPmb3zP3j+eeZ
ef5/JmfJVuYEcDicHM53xFcGEwrEOqiTKl/86ruLKfnBKeUdBvgeE1/Wtz+D
4HWRqO2wEbl3TzVNp9qh2jlYuGmoGdbRabEs/RIv2gy3cpu6MMQ6nxsZ+wpD
TMEHChotaD0ik9W/74GkycSTzngDFfcP6kNELya08iW0pheL2zLD7ojeIrvQ
eHZj7VvMlc5vbeERUNl+cxzJJbB4NW9PyVMC1cSOC6FTrVC186K6Sqw4WaDv
WvDMipjfG//WCWyYQZZXlGXbUPrgy9Xg8zYkxPzir2ZskBrq7Kuj7OB5fXnq
rXbcHmvqV2jsoCz8+8usdsTHfLwTMdGBRP0NY2SqA30L4zZU7XPg1PCJF6XX
HWAt5DSLy4FAxctmjoCENeP0V+8iEulLj1ca5CS8g3OEx86SGJase1TwLwnl
JH1g/mcSP2mv99dHOPFeNE8+frkTNVHcRLPciaMD0ZwPdU5MVzZnlD50orPk
kFBBO9HdYV/GHe9Cyg/l48bGufBErv50JdOFYm73m3dKF1J3k6MsGhduqvxz
t//jgmYCp0bf74I4Poe4F+6GpKp43cE4N9r5zwnBejca3/HIIoUbCfn+PZoG
N56kHZJeNrgRvksdona7MdvUeWDNaAqzxqHRH0Uho7fDU7mSwoJmWUNQIQWf
NMi45RiFbOGDuPs3vtn/SjbKQuGaSGhI9lEYkSLPKp3kQXUxO/OS2IN4Xl9f
Z7YHDJc7y1/mQWnWCYlQ860HXVYvfOqBwI6vm2kPPrecz/srhEbAzyO1V6Np
zDOnJ/WsojHlXL1umJxG4JJPiK2hoYyu4G++SSOzYW9SnYVGVgVz0eyj8VpS
+WPoZAba/DNzViQyCDt8oawqh8E9a2SRaT+DJZdS/gzTMnhMVKevaWOQN0ah
Os4wCFGKfd1jWKRtSy7iz2ZxLcBrSE1jUSwKrd23k4WxRbtbV8tiIFw+YNaz
kBIVa709LIb/f0cf/gMtUKG3
          "]}, {
         Automatic}][$CellContext`m], $CellContext`opertRect[
         Pattern[$CellContext`x$, 
          
          Blank[]]] := $CellContext`ypinch$173768 + (($CellContext`x$ - \
$CellContext`xpinch$173768)/(FE`xd$$718 - $CellContext`xpinch$173768)) (
          FE`xd$$718 - $CellContext`ypinch$173768), 
       Attributes[$CellContext`x$] = {Temporary}, 
       Attributes[$CellContext`ypinch$173768] = {
        Temporary}, $CellContext`ypinch$173768 = 0.6864459715410411, 
       Attributes[$CellContext`xpinch$173768] = {
        Temporary}, $CellContext`xpinch$173768 = 0.31355402845895886`, 
       FE`xd$$718 = 0.85, $CellContext`xd$$ = 0.85, $CellContext`opertStrp[
         Pattern[$CellContext`x$, 
          
          Blank[]]] := $CellContext`ypinch$173768 + (($CellContext`x$ - \
$CellContext`xpinch$173768)/(FE`xb$$718 - $CellContext`xpinch$173768)) (
          FE`xb$$718 - $CellContext`ypinch$173768), FE`xb$$718 = 
       0.12000000000000001`, $CellContext`xb$$ = 0.15, $CellContext`lvmult$$ = 
       3, Attributes[PlotRange] = {ReadProtected}, $CellContext`t = 
       5.433426064529464, $CellContext`window$$ = 1}; 
     Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.679191588866485*^9, 3.679191650576631*^9, 
  3.679191705874424*^9, 3.679191783622233*^9},
 CellID->437920262]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ManipulateCaptionSection"],

Cell["\<\
This demonstration shows how to determine the number of equilibrium stages \
needed for a two-component separation in a countercurrent distillation \
column. The demonstration also shows the optimal location on the column to \
feed the binary mixture. The number of equilibrium stages needed depends on \
the purity of the exiting streams as well as the reflux ratio.\
\>", "ManipulateCaption",
 CellChangeTimes->{{3.676483224143324*^9, 3.676483436577602*^9}, {
  3.6764834700860443`*^9, 3.676483481421093*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ThumbnailSection"],

Cell[BoxData[
 GraphicsBox[
  {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], RectangleBox[{0, 0}], 
   InsetBox[
    StyleBox["\<\"Thumbnail Placeholder\"\>",
     StripOnInput->False,
     FontFamily->"Verdana",
     FontSize->14], {0.5, 0.6}], InsetBox[
    StyleBox["\<\"Replace this with your\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.45}], InsetBox[
    StyleBox["\<\"Manipulate at a particular setting.\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.39}], InsetBox[
    StyleBox["\<\"(Do not use a bitmap.)\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.315}]},
  ImageMargins->0.,
  ImageSize->220]], "Output",
 CellEditDuplicate->False]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SnapshotsSection"],

Cell[BoxData[
 GraphicsBox[
  {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], RectangleBox[{0, 0}], 
   InsetBox[
    StyleBox["\<\"Snapshot Placeholder\"\>",
     StripOnInput->False,
     FontFamily->"Verdana",
     FontSize->14], {0.5, 0.6}], InsetBox[
    StyleBox["\<\"Replace this with your\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.45}], InsetBox[
    StyleBox["\<\"Manipulate at a particular setting.\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.39}], InsetBox[
    StyleBox["\<\"(Do not use a bitmap.)\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.315}]},
  ImageMargins->0.,
  ImageSize->220]], "Output",
 CellEditDuplicate->False]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "DetailsSection"],

Cell["\<\
The McCabe-Thiele graphical solution method for binary distillation (1925) is \
used to determine the number of equilibrium stages needed to achieve a \
specified separation in a distillation column [1]. The equations used in the \
McCabe-Thiele method are based on previous numerical methods by Warren K. \
Lewis.\
\>", "DetailNotes",
 CellChangeTimes->{{3.6764836855195093`*^9, 3.676483686241996*^9}, {
  3.6764837229709883`*^9, 3.676483801144796*^9}, {3.676484208985889*^9, 
  3.6764842575148783`*^9}, {3.676484973087748*^9, 3.676484976158633*^9}},
 CellID->755317722],

Cell["\<\
The accuracy of the McCabe-Thiele method is dependent on a few main \
assumptions:\
\>", "DetailNotes",
 CellChangeTimes->{{3.6764836855195093`*^9, 3.676483686241996*^9}, {
  3.6764837229709883`*^9, 3.676483801144796*^9}, {3.676484208985889*^9, 
  3.676484292825663*^9}, {3.6764843498604507`*^9, 3.6764843504218388`*^9}},
 CellID->1224384310],

Cell["\<\
1.) The distillation is adiabatic (no heat transfer occurs to or from the \
surrounding environment)\
\>", "DetailNotes",
 CellChangeTimes->{{3.6764836855195093`*^9, 3.676483686241996*^9}, {
  3.6764837229709883`*^9, 3.676483801144796*^9}, {3.676484208985889*^9, 
  3.676484295403784*^9}, {3.676484422381997*^9, 3.6764844523721724`*^9}},
 CellID->2068001857],

Cell["\<\
2.) Constant Molar Overflow (CMO) is valid. CMO assumes that for every mole \
of vapor condensed, one mole of liquid is vaporized. This results in constant \
liquid and vapor flows between stages (the exception being the flows of the \
stages above and below the feed stream, which are unequal). In order for CMO \
to be met, the following conditions must be true [2]:\
\>", "DetailNotes",
 CellChangeTimes->{{3.6764836855195093`*^9, 3.676483686241996*^9}, {
  3.6764837229709883`*^9, 3.676483801144796*^9}, {3.676484208985889*^9, 
  3.676484295403784*^9}, {3.676484422381997*^9, 3.676484456276331*^9}, {
  3.676484503206237*^9, 3.67648451246283*^9}, {3.676484550067234*^9, 
  3.676484732401277*^9}, {3.676484794407113*^9, 3.6764848252942133`*^9}, {
  3.676484966087009*^9, 3.676484966686973*^9}, {3.679189773946205*^9, 
  3.6791897739993753`*^9}},
 CellID->885594904],

Cell[TextData[{
 "\ta.) Specific heat changes are small compared to latent heat changes \
between stages ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"|", 
     RowBox[{
      SubscriptBox["H", 
       RowBox[{"j", "+", "1"}]], "-", 
      SubscriptBox["H", "j"]}], "|", 
     RowBox[{
      RowBox[{"<<", 
       SubscriptBox["\[Lambda]", "vap"]}], " ", "and"}], " ", "|", 
     RowBox[{
      SubscriptBox["h", 
       RowBox[{"j", "+", "1"}]], "-", 
      SubscriptBox["h", "j"]}], "|", 
     RowBox[{"<<", 
      SubscriptBox["\[Lambda]", "vap"]}]}], ")"}], TraditionalForm]], 
  "InlineMath",
  FormatType->"TraditionalForm"]
}], "DetailNotes",
 CellChangeTimes->{{3.6764836855195093`*^9, 3.676483686241996*^9}, {
  3.6764837229709883`*^9, 3.676483801144796*^9}, {3.676484208985889*^9, 
  3.676484295403784*^9}, {3.676484422381997*^9, 3.676484456276331*^9}, {
  3.676484503206237*^9, 3.67648451246283*^9}, {3.676484550067234*^9, 
  3.676484732401277*^9}, {3.676484794407113*^9, 3.676484958034377*^9}, {
  3.676485023568264*^9, 3.676485066439378*^9}, {3.676485115881385*^9, 
  3.676485177601013*^9}},
 CellID->1019746882],

Cell[TextData[{
 "\tb.) Heat of vaporization ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SubscriptBox["\[Lambda]", "vap"], ")"}], TraditionalForm]], "InlineMath",
  FormatType->"TraditionalForm"],
 " is the same for both components and therefore not dependent on \
concentration."
}], "DetailNotes",
 CellChangeTimes->{{3.6764836855195093`*^9, 3.676483686241996*^9}, {
  3.6764837229709883`*^9, 3.676483801144796*^9}, {3.676484208985889*^9, 
  3.676484295403784*^9}, {3.676484422381997*^9, 3.676484456276331*^9}, {
  3.676484503206237*^9, 3.67648451246283*^9}, {3.676484550067234*^9, 
  3.676484732401277*^9}, {3.676484794407113*^9, 3.676484958034377*^9}, {
  3.676485023568264*^9, 3.676485111254067*^9}, {3.676485187148814*^9, 
  3.6764852239547787`*^9}, {3.676485264176264*^9, 3.676485264181322*^9}},
 CellID->1246656247],

Cell["3.) Heat of mixing is negligible.", "DetailNotes",
 CellChangeTimes->{{3.6764836855195093`*^9, 3.676483686241996*^9}, {
  3.6764837229709883`*^9, 3.676483801144796*^9}, {3.676484208985889*^9, 
  3.676484295403784*^9}, {3.676484422381997*^9, 3.676484456276331*^9}, {
  3.676484503206237*^9, 3.67648451246283*^9}, {3.676484550067234*^9, 
  3.676484732401277*^9}, {3.676484794407113*^9, 3.676484958034377*^9}, {
  3.676485023568264*^9, 3.676485111254067*^9}, {3.676485187148814*^9, 
  3.6764852239547787`*^9}, {3.676485264176264*^9, 3.6764853236040697`*^9}, {
  3.676485916469355*^9, 3.676485945463601*^9}},
 CellID->1783929300]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ControlSuggestionsSection"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Resize Images"]}],
  "\"Click inside an image to reveal its orange resize frame.\\nDrag any of \
the orange resize handles to resize the image.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"ResizeImages"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Rotate and Zoom in 3D"]}],
  RowBox[{
   "\"Drag a 3D graphic to rotate it. Starting the drag near the center \
tumbles\\nthe graphic; starting near a corner turns it parallel to the plane \
of the screen.\\nHold down \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" (or \"", 
    FrameBox[
    "Cmd", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" on Mac) and drag up and down to zoom.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"RotateAndZoomIn3D"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Drag Locators"]}],
  RowBox[{"\"Drag any locator (\"", 
    GraphicsBox[
     LocatorBox[
      Scaled[{0.5, 0.5}]], ImageSize -> 20], 
    "\", etc.) to move it around.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"DragLocators"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Create and Delete Locators"]}],
  RowBox[{"\"Insert a new locator in the graphic by holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key\\nand clicking where you want it to be. Delete a locator by \
clicking it\\nwhile holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" key.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"CreateAndDeleteLocators"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Slider Zoom"]}],
  RowBox[{"\"Hold down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key while moving a slider to make fine adjustments in the slider \
value.\\nHold \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" and/or \"", 
    FrameBox[
    "Shift", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" at the same time as \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" to make ever finer adjustments.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"SliderZoom"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Gamepad Controls"]}],
  "\"Control this Demonstration with a gamepad or other\\nhuman interface \
device connected to your computer.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.35696210375764*^9, 3.3895522232313623`*^9},
 FontFamily->"Verdana",
 CellTags->"GamepadControls"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Automatic Animation"]}],
  RowBox[{"\"Animate a slider in this Demonstration by clicking the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJzzTSzJSM1NLMlMTlRwL0osyMhMLlZwyy8CCjEzMjAwcIKwAgOI/R/IhBKc\n\
/4EAyGAG0f+nTZsGwgysIJIRKsWKLAXGIHFmEpUgLADxWUAkI24jZs+eTaEt\n\
IG+wQKRmzJgBlYf5lhEA30OqWA=="], "Graphics", ImageSize -> {9, 9}, ImageMargins -> 
      0, CellBaseline -> Baseline], BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"button\\nnext to the slider, and then clicking the play button that \
appears.\\nAnimate all controls by selecting \"", 
    StyleBox["Autorun", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"AutomaticAnimation"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Bookmark Animation"]}],
  RowBox[{
   "\"See a prepared animation of this Demonstration by selecting\\n\"", 
    StyleBox["Animate Bookmarks", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"BookmarkAnimation"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SearchTermsSection"],

Cell["McCabe", "SearchTerms",
 CellChangeTimes->{{3.676485815538929*^9, 3.6764858254525547`*^9}},
 CellID->707831853],

Cell["Thiele", "SearchTerms",
 CellChangeTimes->{{3.676485828589663*^9, 3.676485829354587*^9}},
 CellID->1024827644],

Cell["McCabe-Thiele", "SearchTerms",
 CellChangeTimes->{{3.67648583157992*^9, 3.6764858339204397`*^9}},
 CellID->1116116389],

Cell["McCabe Thiele", "SearchTerms",
 CellChangeTimes->{{3.676485835516714*^9, 3.6764858376544237`*^9}},
 CellID->1540823896],

Cell["distillation", "SearchTerms",
 CellChangeTimes->{{3.6764858478543386`*^9, 3.676485852197497*^9}},
 CellID->425150255],

Cell["binary", "SearchTerms",
 CellChangeTimes->{{3.6764858546888638`*^9, 3.676485855389348*^9}},
 CellID->881704250],

Cell["separation", "SearchTerms",
 CellChangeTimes->{{3.676485858442082*^9, 3.6764858593483553`*^9}},
 CellID->1806955628]
}, Open  ]],

Cell["", "RelatedLinksSection"],

Cell[CellGroupData[{

Cell["", "AuthorSection"],

Cell["Contributed by: Neil Hendren", "Author",
 CellChangeTimes->{{3.6764855534513073`*^9, 3.676485565382338*^9}, 
   3.6764857460458508`*^9},
 CellID->1612637756],

Cell["\<\
Based on a previous demonstration (McCabe & Thiele Graphical Method) by: \
Housam Binous. Visit \
http://demonstrations.wolfram.com/McCabeThieleGraphicalMethod/\
\>", "Author",
 CellChangeTimes->{{3.6764855534513073`*^9, 3.676485575658956*^9}, {
  3.676485710212734*^9, 3.676485740791806*^9}},
 CellID->1074598703],

Cell["\<\
Additional contributions by: John Falconer, Thomas Belval (University of \
Colorado Boulder)\
\>", "Author",
 CellChangeTimes->{{3.67813809784464*^9, 3.67813810517865*^9}},
 CellID->1482685674]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1113, 755},
WindowMargins->{{78, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.4 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 11, \
2016)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "Demonstration.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "ResizeImages"->{
  Cell[189868, 4164, 312, 8, 29, "ControlSuggestions",
   CellTags->"ResizeImages"]},
 "RotateAndZoomIn3D"->{
  Cell[190183, 4174, 678, 16, 29, "ControlSuggestions",
   CellTags->"RotateAndZoomIn3D"]},
 "DragLocators"->{
  Cell[190864, 4192, 340, 11, 29, "ControlSuggestions",
   CellTags->"DragLocators"]},
 "CreateAndDeleteLocators"->{
  Cell[191207, 4205, 637, 15, 29, "ControlSuggestions",
   CellTags->"CreateAndDeleteLocators"]},
 "SliderZoom"->{
  Cell[191847, 4222, 844, 21, 29, "ControlSuggestions",
   CellTags->"SliderZoom"]},
 "GamepadControls"->{
  Cell[192694, 4245, 369, 9, 29, "ControlSuggestions",
   CellTags->"GamepadControls"]},
 "AutomaticAnimation"->{
  Cell[193066, 4256, 1464, 31, 29, "ControlSuggestions",
   CellTags->"AutomaticAnimation"]},
 "BookmarkAnimation"->{
  Cell[194533, 4289, 908, 21, 29, "ControlSuggestions",
   CellTags->"BookmarkAnimation"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"ResizeImages", 197576, 4387},
 {"RotateAndZoomIn3D", 197686, 4390},
 {"DragLocators", 197797, 4393},
 {"CreateAndDeleteLocators", 197914, 4396},
 {"SliderZoom", 198029, 4399},
 {"GamepadControls", 198136, 4402},
 {"AutomaticAnimation", 198250, 4405},
 {"BookmarkAnimation", 198368, 4408}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 115, 1, 76, "DemoTitle"],
Cell[CellGroupData[{
Cell[720, 27, 33, 0, 275, "InitializationSection"],
Cell[756, 29, 138, 4, 24, "Input",
 InitializationCell->True,
 CellID->229163725]
}, Open  ]],
Cell[CellGroupData[{
Cell[931, 38, 29, 0, 243, "ManipulateSection"],
Cell[CellGroupData[{
Cell[985, 42, 116687, 2640, 3975, "Input"],
Cell[117675, 2684, 64027, 1262, 525, "Output",
 CellID->437920262]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[181751, 3952, 36, 0, 181, "ManipulateCaptionSection"],
Cell[181790, 3954, 521, 8, 55, "ManipulateCaption"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182348, 3967, 28, 0, 179, "ThumbnailSection"],
Cell[182379, 3969, 1242, 34, 230, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[183658, 4008, 28, 0, 149, "SnapshotsSection"],
Cell[183689, 4010, 1241, 34, 230, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[184967, 4049, 26, 0, 357, "DetailsSection"],
Cell[184996, 4051, 581, 10, 39, "DetailNotes",
 CellID->755317722],
Cell[185580, 4063, 352, 7, 23, "DetailNotes",
 CellID->1224384310],
Cell[185935, 4072, 368, 7, 23, "DetailNotes",
 CellID->2068001857],
Cell[186306, 4081, 878, 14, 55, "DetailNotes",
 CellID->885594904],
Cell[187187, 4097, 1138, 30, 27, "DetailNotes",
 CellID->1019746882],
Cell[188328, 4129, 829, 17, 27, "DetailNotes",
 CellID->1246656247],
Cell[189160, 4148, 631, 9, 23, "DetailNotes",
 CellID->1783929300]
}, Open  ]],
Cell[CellGroupData[{
Cell[189828, 4162, 37, 0, 131, "ControlSuggestionsSection"],
Cell[189868, 4164, 312, 8, 29, "ControlSuggestions",
 CellTags->"ResizeImages"],
Cell[190183, 4174, 678, 16, 29, "ControlSuggestions",
 CellTags->"RotateAndZoomIn3D"],
Cell[190864, 4192, 340, 11, 29, "ControlSuggestions",
 CellTags->"DragLocators"],
Cell[191207, 4205, 637, 15, 29, "ControlSuggestions",
 CellTags->"CreateAndDeleteLocators"],
Cell[191847, 4222, 844, 21, 29, "ControlSuggestions",
 CellTags->"SliderZoom"],
Cell[192694, 4245, 369, 9, 29, "ControlSuggestions",
 CellTags->"GamepadControls"],
Cell[193066, 4256, 1464, 31, 29, "ControlSuggestions",
 CellTags->"AutomaticAnimation"],
Cell[194533, 4289, 908, 21, 29, "ControlSuggestions",
 CellTags->"BookmarkAnimation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[195478, 4315, 30, 0, 165, "SearchTermsSection"],
Cell[195511, 4317, 117, 2, 23, "SearchTerms",
 CellID->707831853],
Cell[195631, 4321, 116, 2, 23, "SearchTerms",
 CellID->1024827644],
Cell[195750, 4325, 124, 2, 23, "SearchTerms",
 CellID->1116116389],
Cell[195877, 4329, 125, 2, 23, "SearchTerms",
 CellID->1540823896],
Cell[196005, 4333, 123, 2, 23, "SearchTerms",
 CellID->425150255],
Cell[196131, 4337, 117, 2, 23, "SearchTerms",
 CellID->881704250],
Cell[196251, 4341, 122, 2, 23, "SearchTerms",
 CellID->1806955628]
}, Open  ]],
Cell[196388, 4346, 31, 0, 149, "RelatedLinksSection"],
Cell[CellGroupData[{
Cell[196444, 4350, 25, 0, 137, "AuthorSection"],
Cell[196472, 4352, 163, 3, 23, "Author",
 CellID->1612637756],
Cell[196638, 4357, 324, 7, 23, "Author",
 CellID->1074598703],
Cell[196965, 4366, 203, 5, 23, "Author",
 CellID->1482685674]
}, Open  ]]
}, Open  ]]
}
]
*)

