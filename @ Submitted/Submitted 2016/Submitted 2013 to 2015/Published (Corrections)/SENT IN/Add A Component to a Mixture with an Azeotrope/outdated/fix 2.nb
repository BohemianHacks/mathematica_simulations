(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     52684,       1228]
NotebookOptionsPosition[     52123,       1205]
NotebookOutlinePosition[     52467,       1220]
CellTagsIndexPosition[     52424,       1217]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "go", ",", "P", ",", "T", ",", "Psat1", ",", "Psat2", ",", "A12", ",", 
       "A21", ",", "\[Gamma]1", ",", "\[Gamma]2", ",", "Px", ",", "Py", ",", 
       "x1", ",", "y1", ",", "x2", ",", "y2", ",", "L", ",", "V", ",", "nL", 
       ",", "nV", ",", "z", ",", "X", ",", "Y", ",", "fL", ",", "fV", ",", 
       "add", ",", "hL", ",", "piston", ",", "p1", ",", "p2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"go", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"bn", "\[Equal]", "1"}], ",", "go1", ",", "go2"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"P", "=", "0.52"}], ";", "\[IndentingNewLine]", 
      RowBox[{"T", "=", "55"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Psat1", "=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"4.018", "-", 
          RowBox[{"1203.835", "/", 
           RowBox[{"(", 
            RowBox[{"T", "+", "219.8"}], ")"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Psat2", "=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"5.247", "-", 
          RowBox[{"1598.673", "/", 
           RowBox[{"(", 
            RowBox[{"T", "+", "226.6"}], ")"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"A12", "=", "1.2278"}], ";", "\[IndentingNewLine]", 
      RowBox[{"A21", "=", "1.9228"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Gamma]1", "[", "x_", "]"}], "=", 
       RowBox[{"Exp", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "x"}], ")"}], "2"], "*", 
         RowBox[{"(", 
          RowBox[{"A12", "+", 
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"A21", "-", "A12"}], ")"}], "*", "x"}]}], ")"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Gamma]2", "[", "x_", "]"}], "=", 
       RowBox[{"Exp", "[", 
        RowBox[{
         SuperscriptBox["x", "2"], "*", 
         RowBox[{"(", 
          RowBox[{"A21", "+", 
           RowBox[{"2", "*", 
            RowBox[{"(", 
             RowBox[{"A12", "-", "A21"}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", "x"}], ")"}]}]}], ")"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Px", "[", "x_", "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Gamma]1", "[", "x", "]"}], "*", "x", "*", "Psat1"}], "+", 
        RowBox[{
         RowBox[{"\[Gamma]2", "[", "x", "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "x"}], ")"}], "*", "Psat2"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Py", "[", "x_", "]"}], "=", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          FractionBox["x", 
           RowBox[{
            RowBox[{"\[Gamma]1", "[", "x", "]"}], "*", "Psat1"}]], "+", 
          FractionBox[
           RowBox[{"1", "-", "x"}], 
           RowBox[{
            RowBox[{"\[Gamma]2", "[", "x", "]"}], "*", "Psat2"}]]}], ")"}], 
        RowBox[{"-", "1"}]]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"x1", "=", "0.1743"}], ";", 
      RowBox[{"y1", "=", "0.3564"}], ";", 
      RowBox[{"x2", "=", "0.9444"}], ";", 
      RowBox[{"y2", "=", "0.827"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"L", "=", "5"}], ";", 
      RowBox[{"V", "=", "0.5"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nL", "[", "c_", "]"}], "=", 
       RowBox[{
        RowBox[{"(", "c", ")"}], "*", "L"}]}], ";", 
      RowBox[{
       RowBox[{"nV", "[", "c_", "]"}], "=", 
       RowBox[{
        RowBox[{"(", "c", ")"}], "*", "V"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"z", "=", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"nL", "[", "x1", "]"}], "+", 
           RowBox[{"nV", "[", "y1", "]"}]}], 
          RowBox[{"L", "+", "V"}]], "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "go"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"bn", "\[Equal]", "1"}], ",", 
           FractionBox[
            RowBox[{
             RowBox[{"nL", "[", "x1", "]"}], "+", 
             RowBox[{"nV", "[", "x1", "]"}], "+", "n"}], 
            RowBox[{"L", "+", "V", "+", "n"}]], ",", 
           RowBox[{"1", "-", 
            FractionBox[
             RowBox[{
              RowBox[{"nL", "[", 
               RowBox[{"1", "-", "x1"}], "]"}], "+", 
              RowBox[{"nV", "[", 
               RowBox[{"1", "-", "x1"}], "]"}], "+", "n"}], 
             RowBox[{"L", "+", "V", "+", "n"}]]}]}], "]"}], "*", "go"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"X", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Px", "[", "z", "]"}], "\[LessEqual]", "P"}], ",", "z", ",", 
         RowBox[{
          RowBox[{"Py", "[", "z", "]"}], "\[GreaterEqual]", "P"}], ",", "0", 
         ",", 
         RowBox[{"x1", "<", "z", "<", "y1"}], ",", "x1", ",", 
         RowBox[{"y2", "<", "z", "<", "x2"}], ",", "x2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Y", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Px", "[", "z", "]"}], "\[LessEqual]", "P"}], ",", "0", ",", 
         RowBox[{
          RowBox[{"Py", "[", "z", "]"}], "\[GreaterEqual]", "P"}], ",", "z", 
         ",", 
         RowBox[{"x1", "<", "z", "<", "y1"}], ",", "y1", ",", 
         RowBox[{"y2", "<", "z", "<", "x2"}], ",", "y2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"fL", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Px", "[", "z", "]"}], "\[LessEqual]", "P"}], ",", "1", ",", 
         RowBox[{
          RowBox[{"Py", "[", "z", "]"}], "\[GreaterEqual]", "P"}], ",", "0", 
         ",", 
         RowBox[{"x1", "<", "z", "<", "y1"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"y1", "-", "z"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"y1", "-", "x1"}], ")"}]}], ",", 
         RowBox[{"y2", "<", "z", "<", "x2"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"y2", "-", "z"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"y2", "-", "x2"}], ")"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fV", "=", 
       RowBox[{"1", "-", "fL"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"add", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"0.1", "+", 
          RowBox[{"0.8", "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "0.5"}], ")"}], "/", "24.5"}]}]}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "go"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"hL", "=", 
       RowBox[{"fL", "*", 
        RowBox[{"(", 
         RowBox[{"0.15", "+", 
          RowBox[{"go", "*", 
           RowBox[{"(", 
            RowBox[{"0.01", "+", 
             RowBox[{"0.15", "*", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"n", "-", "0.5"}], ")"}], "/", "24.5"}]}]}], 
            ")"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"piston", "=", 
       RowBox[{"2.35", "+", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"bn", "\[Equal]", "1"}], ",", 
           RowBox[{"0.4", "*", "fV"}], ",", 
           RowBox[{"hL", "-", "2.35"}]}], "]"}], "*", "go"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"p1", "=", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"Inset", "@", "\[IndentingNewLine]", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Opacity", "[", "0.5", "]"}], ",", 
                RowBox[{"Cylinder", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "2.75"}], "}"}]}], "}"}], 
                 "]"}], ",", 
                RowBox[{"Cylinder", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "1.375"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "0", ",", "1.375"}], "}"}]}], "}"}], 
                  ",", "0.17"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Opacity", "[", "0.75", "]"}], ",", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{"0.07", ",", "1", ",", "0.6"}], "]"}], ",", 
                RowBox[{"Cylinder", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "hL"}], "}"}]}], "}"}], "]"}],
                 ",", 
                RowBox[{"Cylinder", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "1.375"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "+", "add"}], ",", "0", ",", "1.375"}], 
                    "}"}]}], "}"}], ",", "0.17"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Cylinder", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"1", "+", "add"}], ",", "0", ",", "1.375"}], 
                   "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"2.1", "+", "add"}], ",", "0", ",", "1.375"}], 
                   "}"}]}], "}"}], ",", "0.04"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"Black", ",", 
                RowBox[{"Cylinder", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2.1", "+", "add"}], ",", "0", ",", "1.375"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2.125", "+", "add"}], ",", "0", ",", "1.375"}], 
                    "}"}]}], "}"}], ",", "0.175"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"Gray", ",", 
                RowBox[{"Cylinder", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "piston"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"piston", "+", "0.15"}]}], "}"}]}], "}"}], "]"}], 
                ",", 
                RowBox[{"Cylinder", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"piston", "+", "0.15"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "3"}], "}"}]}], "}"}], ",", 
                  "0.11"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Subsuperscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<P\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<E\>\"", ",", "\"\<sat\>\""}], "]"}], ",", 
                    "\"\< < \>\"", ",", 
                    RowBox[{"Subsuperscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<P\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<B\>\"", ",", "\"\<sat\>\""}], "]"}]}], "}"}], "]"}], 
                  ",", "20"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "0", ",", "2.75"}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"go", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"n", ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"bn", "\[Equal]", "1"}], ",", 
                    "\"\< mol benzene\>\"", ",", "\"\< mol ethanol\>\""}], 
                    "]"}], ",", "\"\< added\>\""}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<add \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"n", ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}]}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"bn", "\[Equal]", "1"}], ",", 
                    "\"\< mol benzene\>\"", ",", "\"\< mol ethanol\>\""}], 
                    "]"}]}], "}"}], "]"}]}], "]"}], ",", "20"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"2.15", ",", "0", ",", "0.85"}], "}"}]}], "]"}], ",",
               "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"go", "\[Equal]", "1"}], ",", 
                RowBox[{"Text", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"bn", "\[Equal]", "1"}], ",", 
                    "\"\<liquid evaporates\>\"", ",", 
                    "\"\<vapor condenses\>\""}], "]"}], ",", "20"}], "]"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"2", ",", "0", ",", "2"}], "}"}]}], "]"}]}], "]"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"fV", ">", "0"}], ",", 
                RowBox[{"Text", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Superscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<V\>\""}], "]"}], ",", "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"V", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"fV", "*", 
                    RowBox[{"(", 
                    RowBox[{"V", "+", "L", "+", "n"}], ")"}]}], "-", "V"}], 
                    ")"}], "*", "go"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Spacer", "[", "25", "]"}], ",", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<y\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<B\>\""}], "]"}], ",", "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"Y", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "}"}], "]"}], 
                    ",", "18"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"bn", "\[Equal]", "1"}], ",", "1.311", ",", 
                    RowBox[{
                    RowBox[{"0.5", "*", "piston"}], "+", "hL"}]}], "]"}]}], 
                   "}"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"fL", ">", "0"}], ",", 
                RowBox[{"Text", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Superscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<L\>\""}], "]"}], ",", "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"L", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"fL", "*", 
                    RowBox[{"(", 
                    RowBox[{"V", "+", "L", "+", "n"}], ")"}]}], "-", "L"}], 
                    ")"}], "*", "go"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "1"}], "}"}]}], "]"}], ",", 
                    RowBox[{"Spacer", "[", "25", "]"}], ",", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<x\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<B\>\""}], "]"}], ",", "\"\< = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"X", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "}"}], "]"}], 
                    ",", "18"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"-", "0.5"}], ",", 
                    RowBox[{"0.15", "*", "hL"}]}], "}"}]}], "]"}]}], "]"}]}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", 
            RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
            RowBox[{"ViewPoint", "\[Rule]", "Front"}], ",", 
            RowBox[{"Lighting", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"\"\<Ambient\>\"", ",", "LightGray"}], "}"}], "}"}]}], 
            ",", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"500", ",", "352"}], "}"}]}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "3.25"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "3"}], "}"}]}], "}"}]}]}], "]"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "3.25"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "3"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"500", ",", "352"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"p2", "=", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Px", "[", "x", "]"}], ",", 
             RowBox[{"Py", "[", "x", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.36", ",", "0.64"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Thick", ",", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{"0.1", ",", "0.6", ",", "0"}], "]"}]}], "}"}]}], 
             "}"}]}], ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<benzene mole fraction\>\"", ",", "17"}], "]"}], 
              ",", 
              RowBox[{"Style", "[", 
               RowBox[{"\"\<pressure (bar)\>\"", ",", "17"}], "]"}]}], 
             "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Black", ",", "14"}], "}"}]}], ",", 
           RowBox[{"PlotRangeClipping", "\[Rule]", "False"}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"70", ",", "50"}], "\[IndentingNewLine]", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"45", ",", "5"}], "}"}]}], "}"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<pure ethanol\>\"", ",", "14"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.32"}], "}"}]}], "]"}], ",", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<pure benzene\>\"", ",", "14"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0.32"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Dashed", ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Px", "[", "z", "]"}], "\[LessEqual]", "P"}], 
                 "\[Or]", 
                 RowBox[{
                  RowBox[{"Py", "[", "z", "]"}], "\[GreaterEqual]", "P"}]}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Px", "[", "z", "]"}], "\[LessEqual]", "P"}], ",",
                     "Blue", ",", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.1", ",", "0.6", ",", "0."}], "]"}]}], "]"}], 
                  ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"z", ",", "P"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "0.363"}], "}"}]}], "}"}], "]"}]}], 
                 "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"x1", "<", "z", "<", "y1"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"Blue", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x1", ",", "0.363"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x1", ",", "P"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "P"}], "}"}]}], "}"}], "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.1", ",", "0.6", ",", "0."}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"y1", ",", "0.363"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y1", ",", "P"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "P"}], "}"}]}], "}"}], "]"}]}], "}"}]}],
                  "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"y2", "<", "z", "<", "x2"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"Blue", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x2", ",", "0.363"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x2", ",", "P"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "P"}], "}"}]}], "}"}], "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.1", ",", "0.6", ",", "0."}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"y2", ",", "0.363"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y2", ",", "P"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "P"}], "}"}]}], "}"}], "]"}]}], "}"}]}],
                  "}"}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
              RowBox[{"Point", "[", 
               RowBox[{"{", 
                RowBox[{"z", ",", "P"}], "}"}], "]"}]}], "}"}]}], "}"}], 
          "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"500", ",", "352"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{"Switch", "[", 
        RowBox[{"cs", ",", "1", ",", "p1", ",", "2", ",", "p2"}], "]"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"cs", ",", "1", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "\"\<piston-cylinder\>\""}], ",", 
             RowBox[{"2", "\[Rule]", 
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<P-x-y\>\"", ",", "Italic"}], "]"}], ",", 
                 "\"\< diagram\>\""}], "}"}], "]"}]}]}], "}"}], ",", 
           "Setter"}], "}"}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"bn", ",", "1", ",", "\"\<\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "\"\<add benzene\>\""}], ",", 
             RowBox[{"2", "\[Rule]", "\"\<add ethanol\>\""}]}], "}"}], ",", 
           "Setter"}], "}"}], "]"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"n", ",", "10", ",", "\"\<add moles\>\""}], "}"}], ",", 
            "0.5", ",", "25", ",", "0.1", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PaneSelector", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Control", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"go1", ",", "0", ",", "\"\<inject\>\""}], "}"}], 
                 ",", "0", ",", "1", ",", "Trigger", ",", 
                 RowBox[{"AnimationRate", "\[Rule]", "1"}], ",", 
                 RowBox[{"AppearanceElements", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<PlayPauseButton\>\"", ",", "\"\<ResetButton\>\""}], 
                   "}"}]}]}], "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"2", "\[Rule]", 
              RowBox[{"Control", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"go2", ",", "0", ",", "\"\<inject\>\""}], "}"}], 
                 ",", "0", ",", "1", ",", "Trigger", ",", 
                 RowBox[{"AnimationRate", "\[Rule]", "1"}], ",", 
                 RowBox[{"AppearanceElements", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<PlayPauseButton\>\"", ",", "\"\<ResetButton\>\""}], 
                   "}"}]}]}], "}"}], "]"}]}]}], "\[IndentingNewLine]", "}"}], 
           ",", 
           RowBox[{"Dynamic", "@", "bn"}]}], "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6382055981417923`*^9, 3.638205703611825*^9}, {
   3.638205958870425*^9, 3.6382059870550375`*^9}, {3.63820601858084*^9, 
   3.638206170741544*^9}, {3.6382065814770365`*^9, 3.638206720393982*^9}, {
   3.6382069147731*^9, 3.638206960093692*^9}, {3.6382070254704313`*^9, 
   3.638208573365966*^9}, {3.638208877108339*^9, 3.6382090091178894`*^9}, {
   3.6382090544054794`*^9, 3.6382090940327463`*^9}, {3.6382091256125526`*^9, 
   3.6382095528249874`*^9}, {3.638209663446315*^9, 3.638210159093664*^9}, {
   3.6382101920765505`*^9, 3.638210262120557*^9}, {3.638210293366344*^9, 
   3.6382106312096677`*^9}, {3.6382106864538274`*^9, 3.638210698400511*^9}, {
   3.6382107456882153`*^9, 3.63821079803821*^9}, {3.638210840267625*^9, 
   3.6382108460259542`*^9}, {3.6382108829150643`*^9, 
   3.6382108899324656`*^9}, {3.638210921427267*^9, 3.6382109376261935`*^9}, {
   3.638211024297151*^9, 3.638211114265297*^9}, {3.638211155269642*^9, 
   3.638211294209589*^9}, {3.6382113553370857`*^9, 3.638211375437235*^9}, {
   3.6382114213508615`*^9, 3.638211423826003*^9}, {3.638211474699912*^9, 
   3.638211486800605*^9}, {3.6382115763327255`*^9, 3.638211873151703*^9}, 
   3.638211906205593*^9, {3.6382123542462196`*^9, 3.6382124570140977`*^9}, {
   3.6382125528905816`*^9, 3.638212593329894*^9}, {3.638212738907221*^9, 
   3.638212777244414*^9}, {3.6382128089712286`*^9, 3.6382128203858814`*^9}, {
   3.638278627365118*^9, 3.638278633248454*^9}, {3.6382786885136156`*^9, 
   3.6382787130630198`*^9}, {3.6382787699662743`*^9, 3.638278829599685*^9}, {
   3.638278878432478*^9, 3.6382788855118833`*^9}, {3.638279010354024*^9, 
   3.6382790584747763`*^9}, 3.638279090612614*^9, {3.6382791320699854`*^9, 
   3.638279132486009*^9}, {3.638279403356502*^9, 3.638279478640808*^9}, {
   3.638279552966059*^9, 3.6382795962755365`*^9}, {3.6382796291644173`*^9, 
   3.638279806653569*^9}, {3.6382798431246557`*^9, 3.638280046794305*^9}, {
   3.6382803085062733`*^9, 3.638280396487306*^9}, {3.638280447385217*^9, 
   3.6382805180022564`*^9}, {3.638280631731761*^9, 3.638280646014578*^9}, {
   3.6382806831567025`*^9, 3.6382807415050397`*^9}, {3.638281151884512*^9, 
   3.638281266116046*^9}, {3.6382813581813116`*^9, 3.6382813834447565`*^9}, {
   3.638281435903757*^9, 3.6382814466823735`*^9}, {3.6382814793752437`*^9, 
   3.6382814996944056`*^9}, {3.638281581963111*^9, 3.6382819508652115`*^9}, {
   3.6382819876683164`*^9, 3.6382819902944665`*^9}, {3.6382820253544717`*^9, 
   3.638282026465535*^9}, 3.6382820596164317`*^9, {3.638282096612548*^9, 
   3.638282181839422*^9}, {3.6382822979010606`*^9, 3.638282314727023*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`bn$$ = 2, $CellContext`cs$$ = 
    1, $CellContext`go1$$ = 1., $CellContext`go2$$ = 1., $CellContext`n$$ = 
    10, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`cs$$], 1, ""}, {1 -> "piston-cylinder", 2 -> Row[{
          Style["P-x-y", Italic], " diagram"}]}}, {{
       Hold[$CellContext`bn$$], 1, ""}, {
      1 -> "add benzene", 2 -> "add ethanol"}}, {{
       Hold[$CellContext`n$$], 10, "add moles"}, 0.5, 25, 0.1}, {{
       Hold[$CellContext`go1$$], 0, "inject"}, 0, 1}, {{
       Hold[$CellContext`go2$$], 0, "inject"}, 0, 1}, {
      Hold[
       Grid[{{
          Manipulate`Place[1]}, {
          Manipulate`Place[2]}, {
          Manipulate`Place[3], 
          PaneSelector[{1 -> Manipulate`Place[4], 2 -> Manipulate`Place[5]}, 
           Dynamic[$CellContext`bn$$]]}}, Alignment -> Left]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    500., {174., 178.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`cs$149870$$ = 
    False, $CellContext`bn$149871$$ = False, $CellContext`n$149872$$ = 
    0, $CellContext`go1$149873$$ = 0, $CellContext`go2$149874$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`bn$$ = 1, $CellContext`cs$$ = 
        1, $CellContext`go1$$ = 0, $CellContext`go2$$ = 0, $CellContext`n$$ = 
        10}, "ControllerVariables" :> {
        Hold[$CellContext`cs$$, $CellContext`cs$149870$$, False], 
        Hold[$CellContext`bn$$, $CellContext`bn$149871$$, False], 
        Hold[$CellContext`n$$, $CellContext`n$149872$$, 0], 
        Hold[$CellContext`go1$$, $CellContext`go1$149873$$, 0], 
        Hold[$CellContext`go2$$, $CellContext`go2$149874$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`go$, $CellContext`P$, $CellContext`T$, \
$CellContext`Psat1$, $CellContext`Psat2$, $CellContext`A12$, \
$CellContext`A21$, $CellContext`\[Gamma]1$, $CellContext`\[Gamma]2$, \
$CellContext`Px$, $CellContext`Py$, $CellContext`x1$, $CellContext`y1$, \
$CellContext`x2$, $CellContext`y2$, $CellContext`L$, $CellContext`V$, \
$CellContext`nL$, $CellContext`nV$, $CellContext`z$, $CellContext`X$, \
$CellContext`Y$, $CellContext`fL$, $CellContext`fV$, $CellContext`add$, \
$CellContext`hL$, $CellContext`piston$, $CellContext`p1$, $CellContext`p2$}, \
$CellContext`go$ = 
         If[$CellContext`bn$$ == 
           1, $CellContext`go1$$, $CellContext`go2$$]; $CellContext`P$ = 
         0.52; $CellContext`T$ = 55; $CellContext`Psat1$ = 
         10^(4.018 - 1203.835/($CellContext`T$ + 219.8)); $CellContext`Psat2$ = 
         10^(5.247 - 1598.673/($CellContext`T$ + 226.6)); $CellContext`A12$ = 
         1.2278; $CellContext`A21$ = 1.9228; $CellContext`\[Gamma]1$[
           Pattern[$CellContext`x$, 
            Blank[]]] = 
         Exp[(1 - $CellContext`x$)^2 ($CellContext`A12$ + 
            2 ($CellContext`A21$ - $CellContext`A12$) $CellContext`x$)]; \
$CellContext`\[Gamma]2$[
           Pattern[$CellContext`x$, 
            Blank[]]] = 
         Exp[$CellContext`x$^2 ($CellContext`A21$ + 
            2 ($CellContext`A12$ - $CellContext`A21$) (
              1 - $CellContext`x$))]; $CellContext`Px$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] = $CellContext`\[Gamma]1$[$CellContext`x$] \
$CellContext`x$ $CellContext`Psat1$ + \
$CellContext`\[Gamma]2$[$CellContext`x$] (
            1 - $CellContext`x$) $CellContext`Psat2$; $CellContext`Py$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] = \
($CellContext`x$/($CellContext`\[Gamma]1$[$CellContext`x$] \
$CellContext`Psat1$) + (
             1 - $CellContext`x$)/($CellContext`\[Gamma]2$[$CellContext`x$] \
$CellContext`Psat2$))^(-1); $CellContext`x1$ = 0.1743; $CellContext`y1$ = 
         0.3564; $CellContext`x2$ = 0.9444; $CellContext`y2$ = 
         0.827; $CellContext`L$ = 5; $CellContext`V$ = 0.5; $CellContext`nL$[
           Pattern[$CellContext`c$, 
            Blank[]]] = $CellContext`c$ $CellContext`L$; $CellContext`nV$[
           Pattern[$CellContext`c$, 
            
            Blank[]]] = $CellContext`c$ $CellContext`V$; $CellContext`z$ = \
(($CellContext`nL$[$CellContext`x1$] + \
$CellContext`nV$[$CellContext`y1$])/($CellContext`L$ + $CellContext`V$)) (
            1 - $CellContext`go$) + 
          If[$CellContext`bn$$ == 
             1, ($CellContext`nL$[$CellContext`x1$] + \
$CellContext`nV$[$CellContext`x1$] + $CellContext`n$$)/($CellContext`L$ + \
$CellContext`V$ + $CellContext`n$$), 
             1 - ($CellContext`nL$[1 - $CellContext`x1$] + $CellContext`nV$[
               1 - $CellContext`x1$] + $CellContext`n$$)/($CellContext`L$ + \
$CellContext`V$ + $CellContext`n$$)] $CellContext`go$; $CellContext`X$ = 
         Which[$CellContext`Px$[$CellContext`z$] <= $CellContext`P$, \
$CellContext`z$, $CellContext`Py$[$CellContext`z$] >= $CellContext`P$, 
           0, $CellContext`x1$ < $CellContext`z$ < $CellContext`y1$, \
$CellContext`x1$, $CellContext`y2$ < $CellContext`z$ < $CellContext`x2$, \
$CellContext`x2$]; $CellContext`Y$ = 
         Which[$CellContext`Px$[$CellContext`z$] <= $CellContext`P$, 
           0, $CellContext`Py$[$CellContext`z$] >= $CellContext`P$, \
$CellContext`z$, $CellContext`x1$ < $CellContext`z$ < $CellContext`y1$, \
$CellContext`y1$, $CellContext`y2$ < $CellContext`z$ < $CellContext`x2$, \
$CellContext`y2$]; $CellContext`fL$ = 
         Which[$CellContext`Px$[$CellContext`z$] <= $CellContext`P$, 
           1, $CellContext`Py$[$CellContext`z$] >= $CellContext`P$, 
           0, $CellContext`x1$ < $CellContext`z$ < $CellContext`y1$, \
($CellContext`y1$ - $CellContext`z$)/($CellContext`y1$ - $CellContext`x1$), \
$CellContext`y2$ < $CellContext`z$ < $CellContext`x2$, ($CellContext`y2$ - \
$CellContext`z$)/($CellContext`y2$ - $CellContext`x2$)]; $CellContext`fV$ = 
         1 - $CellContext`fL$; $CellContext`add$ = (0.1 + 
           0.8 (($CellContext`n$$ - 0.5)/24.5)) (
           1 - $CellContext`go$); $CellContext`hL$ = $CellContext`fL$ (
           0.15 + $CellContext`go$ (0.01 + 
             0.15 (($CellContext`n$$ - 0.5)/24.5))); $CellContext`piston$ = 
         2.35 + If[$CellContext`bn$$ == 1, 
             0.4 $CellContext`fV$, $CellContext`hL$ - 
             2.35] $CellContext`go$; $CellContext`p1$ = Graphics[
           Inset[
            Graphics3D[{{
               Opacity[0.5], 
               Cylinder[{{0, 0, 0}, {0, 0, 2.75}}], 
               Cylinder[{{1, 0, 1.375}, {2, 0, 1.375}}, 0.17]}, {
               Opacity[0.75], 
               RGBColor[0.07, 1, 0.6], 
               Cylinder[{{0, 0, 0}, {0, 0, $CellContext`hL$}}], 
               
               Cylinder[{{1, 0, 1.375}, {1 + $CellContext`add$, 0, 1.375}}, 
                0.17]}, 
              
              Cylinder[{{1 + $CellContext`add$, 0, 1.375}, {
                2.1 + $CellContext`add$, 0, 1.375}}, 0.04], {Black, 
               
               Cylinder[{{2.1 + $CellContext`add$, 0, 1.375}, {
                 2.125 + $CellContext`add$, 0, 1.375}}, 0.175]}, {Gray, 
               
               Cylinder[{{0, 0, $CellContext`piston$}, {
                 0, 0, $CellContext`piston$ + 0.15}}], 
               
               Cylinder[{{0, 0, $CellContext`piston$ + 0.15}, {0, 0, 3}}, 
                0.11]}, 
              Text[
               Style[
                Row[{
                  Subsuperscript[
                   Style["P", Italic], "E", "sat"], " < ", 
                  Subsuperscript[
                   Style["P", Italic], "B", "sat"]}], 20], {2, 0, 2.75}], 
              Text[
               Style[
                If[$CellContext`go$ == 1, 
                 Row[{
                   NumberForm[$CellContext`n$$, {3, 1}], 
                   If[$CellContext`bn$$ == 1, " mol benzene", " mol ethanol"],
                    " added"}], 
                 Row[{"add ", 
                   NumberForm[$CellContext`n$$, {3, 1}], 
                   
                   If[$CellContext`bn$$ == 1, " mol benzene", 
                    " mol ethanol"]}]], 20], {2.15, 0, 0.85}], 
              If[$CellContext`go$ == 1, 
               Text[
                Style[
                 
                 If[$CellContext`bn$$ == 1, "liquid evaporates", 
                  "vapor condenses"], 20], {2, 0, 2}]], 
              If[$CellContext`fV$ > 0, 
               Text[
                Style[
                 Row[{
                   Superscript[
                    Style["n", Italic], "V"], " = ", 
                   
                   NumberForm[$CellContext`V$ + ($CellContext`fV$ \
($CellContext`V$ + $CellContext`L$ + $CellContext`n$$) - $CellContext`V$) \
$CellContext`go$, {3, 1}], 
                   Spacer[25], 
                   Subscript[
                    Style["y", Italic], "B"], " = ", 
                   NumberForm[$CellContext`Y$, {2, 2}]}], 18], {0, 0, 
                 
                 If[$CellContext`bn$$ == 1, 1.311, 
                  0.5 $CellContext`piston$ + $CellContext`hL$]}]], 
              If[$CellContext`fL$ > 0, 
               Text[
                Style[
                 Row[{
                   Superscript[
                    Style["n", Italic], "L"], " = ", 
                   
                   NumberForm[$CellContext`L$ + ($CellContext`fL$ \
($CellContext`V$ + $CellContext`L$ + $CellContext`n$$) - $CellContext`L$) \
$CellContext`go$, {3, 1}], 
                   Spacer[25], 
                   Subscript[
                    Style["x", Italic], "B"], " = ", 
                   NumberForm[$CellContext`X$, {2, 2}]}], 18], {
                0, -0.5, 0.15 $CellContext`hL$}]]}, Boxed -> False, ViewPoint -> 
             Front, Lighting -> {{"Ambient", LightGray}}, 
             ImageSize -> {500, 352}, 
             PlotRange -> {{-1, 3.25}, {-1, 1}, {0, 3}}]], 
           PlotRange -> {{-1, 3.25}, {0, 3}}, 
           ImageSize -> {500, 352}]; $CellContext`p2$ = Show[
           Plot[{
             $CellContext`Px$[$CellContext`x], 
             $CellContext`Py$[$CellContext`x]}, {$CellContext`x, 0, 1}, 
            PlotRange -> {{0, 1}, {0.36, 0.64}}, 
            PlotStyle -> {{Thick, Blue}, {Thick, 
               RGBColor[0.1, 0.6, 0]}}, Frame -> True, FrameLabel -> {
              Style["benzene mole fraction", 17], 
              Style["pressure (bar)", 17]}, LabelStyle -> {Black, 14}, 
            PlotRangeClipping -> False, ImagePadding -> {{70, 50}, {45, 5}}], 
           Graphics[{
             Text[
              Style["pure ethanol", 14], {0, 0.32}], 
             Text[
              Style["pure benzene", 14], {1, 0.32}], {Thick, Dashed, 
              If[
               
               Or[$CellContext`Px$[$CellContext`z$] <= $CellContext`P$, \
$CellContext`Py$[$CellContext`z$] >= $CellContext`P$], {
                If[$CellContext`Px$[$CellContext`z$] <= $CellContext`P$, Blue, 
                 RGBColor[0.1, 0.6, 0.]], 
                
                Line[{{$CellContext`z$, $CellContext`P$}, {$CellContext`z$, 
                   0.363}}]}], 
              
              If[$CellContext`x1$ < $CellContext`z$ < $CellContext`y1$, {{
                Blue, 
                 
                 Line[{{$CellContext`x1$, 
                    0.363}, {$CellContext`x1$, $CellContext`P$}, \
{$CellContext`z$, $CellContext`P$}}]}, {
                 RGBColor[0.1, 0.6, 0.], 
                 
                 Line[{{$CellContext`y1$, 
                    0.363}, {$CellContext`y1$, $CellContext`P$}, \
{$CellContext`z$, $CellContext`P$}}]}}], 
              
              If[$CellContext`y2$ < $CellContext`z$ < $CellContext`x2$, {{
                Blue, 
                 
                 Line[{{$CellContext`x2$, 
                    0.363}, {$CellContext`x2$, $CellContext`P$}, \
{$CellContext`z$, $CellContext`P$}}]}, {
                 RGBColor[0.1, 0.6, 0.], 
                 
                 Line[{{$CellContext`y2$, 
                    0.363}, {$CellContext`y2$, $CellContext`P$}, \
{$CellContext`z$, $CellContext`P$}}]}}]}, {
              PointSize[0.02], 
              Point[{$CellContext`z$, $CellContext`P$}]}}], 
           ImageSize -> {500, 352}]; Show[
          
          Switch[$CellContext`cs$$, 1, $CellContext`p1$, 
           2, $CellContext`p2$]]], 
      "Specifications" :> {{{$CellContext`cs$$, 1, ""}, {
         1 -> "piston-cylinder", 2 -> Row[{
             Style["P-x-y", Italic], " diagram"}]}, ControlType -> Setter, 
         ControlPlacement -> 1}, {{$CellContext`bn$$, 1, ""}, {
         1 -> "add benzene", 2 -> "add ethanol"}, ControlType -> Setter, 
         ControlPlacement -> 2}, {{$CellContext`n$$, 10, "add moles"}, 0.5, 
         25, 0.1, Appearance -> "Labeled", ControlPlacement -> 
         3}, {{$CellContext`go1$$, 0, "inject"}, 0, 1, ControlType -> Trigger,
          AnimationRate -> 1, 
         AppearanceElements -> {"PlayPauseButton", "ResetButton"}, 
         ControlPlacement -> 4}, {{$CellContext`go2$$, 0, "inject"}, 0, 1, 
         ControlType -> Trigger, AnimationRate -> 1, 
         AppearanceElements -> {"PlayPauseButton", "ResetButton"}, 
         ControlPlacement -> 5}, 
        Grid[{{
           Manipulate`Place[1]}, {
           Manipulate`Place[2]}, {
           Manipulate`Place[3], 
           PaneSelector[{1 -> Manipulate`Place[4], 2 -> Manipulate`Place[5]}, 
            Dynamic[$CellContext`bn$$]]}}, Alignment -> Left]}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{551., {242., 249.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.6382801056116686`*^9, {3.638280376343154*^9, 3.6382803979773912`*^9}, 
   3.638280647674673*^9, {3.638281206795653*^9, 3.638281242473694*^9}, 
   3.638281384619824*^9, 3.6382814548028383`*^9, {3.638281486563655*^9, 
   3.6382815009074755`*^9}, {3.6382817020929823`*^9, 3.638281791549099*^9}, 
   3.638281953691373*^9, 3.6382819917705507`*^9, {3.638282195349195*^9, 
   3.6382822140332637`*^9}, {3.638282298783111*^9, 3.638282315651076*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"x1", "=", 
     RowBox[{"y", "/.", 
      RowBox[{"Quiet", "@", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Px", "[", "y", "]"}], "\[Equal]", "P"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", "0"}], "}"}]}], "]"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"x2", "=", 
     RowBox[{"y", "/.", 
      RowBox[{"Quiet", "@", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Px", "[", "y", "]"}], "\[Equal]", "P"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", "1"}], "}"}]}], "]"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"y1", "=", 
     RowBox[{"y", "/.", 
      RowBox[{"Quiet", "@", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Py", "[", "y", "]"}], "\[Equal]", "P"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", "0"}], "}"}]}], "]"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"y2", "=", 
     RowBox[{"y", "/.", 
      RowBox[{"Quiet", "@", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Py", "[", "y", "]"}], "\[Equal]", "P"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", "1"}], "}"}]}], "]"}]}]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"p3", "=", 
    RowBox[{"BarChart", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"fL", ",", "fV"}], "}"}], ",", 
      RowBox[{"ChartStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Blue", ",", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.1", ",", "0.6", ",", "0."}], "]"}]}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"185", ",", "352"}], "}"}]}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}]}], "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.6382821735529485`*^9, 3.6382821818524227`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Switch", "[", 
   RowBox[{"cs", ",", "1", ",", 
    RowBox[{"Show", "[", "p1", "]"}], ",", "2", ",", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Show", "[", "p2", "]"}], ",", 
       RowBox[{"Show", "[", "p3", "]"}]}], "}"}], "]"}]}], "]"}], 
  "*)"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"2.35", "/", "2"}]], "Input",
 CellChangeTimes->{{3.63828059709678*^9, 3.6382805982758474`*^9}}],

Cell[BoxData["1.175`"], "Output",
 CellChangeTimes->{3.6382805987648754`*^9}]
}, Open  ]]
},
WindowSize->{1366, 686},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.1 for Microsoft Windows (64-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 33977, 792, 1664, "Input"],
Cell[34560, 816, 14842, 297, 508, "Output"]
}, Open  ]],
Cell[49417, 1116, 1375, 43, 112, "Input"],
Cell[50795, 1161, 750, 20, 31, "Input"],
Cell[51548, 1183, 335, 10, 31, "Input"],
Cell[CellGroupData[{
Cell[51908, 1197, 119, 2, 31, "Input"],
Cell[52030, 1201, 77, 1, 31, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
