(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    129004,       2786]
NotebookOptionsPosition[    124250,       2643]
NotebookOutlinePosition[    125868,       2693]
CellTagsIndexPosition[    125532,       2681]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Pharmacokinetic Modelling", "DemoTitle",
 CellChangeTimes->{{3.6084260435775213`*^9, 3.6084260536150956`*^9}, 
   3.608656617231862*^9}],

Cell["", "InitializationSection"],

Cell[CellGroupData[{

Cell["", "ManipulateSection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"V1", "=", "1"}], ",", "\[IndentingNewLine]", "bc", ",", "pw1",
        ",", "pw2", ",", "a2", ",", "b2", ",", "injectiontimes", ",", "r", 
       ",", "c1", ",", "c2", ",", "d", ",", "eqns", ",", "m", ",", 
       "LegendKey"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"LegendKey", "=", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Black", ",", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<plot legend\>\"", ",", "16", ",", "Bold"}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0.84"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "Thick", ",", "\[IndentingNewLine]", 
           "Orange", ",", "\[IndentingNewLine]", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"0.6", "-", 
                 RowBox[{"0", 
                  RowBox[{"(", 
                   FractionBox[
                    RowBox[{"0.6", "-", "0.1"}], "4"], ")"}]}]}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"0.3", ",", 
                RowBox[{"0.6", "-", 
                 RowBox[{"0", 
                  RowBox[{"(", 
                   FractionBox[
                    RowBox[{"0.6", "-", "0.1"}], "4"], ")"}]}]}]}], "}"}]}], 
             "}"}], "]"}], ",", "\[IndentingNewLine]", "Black", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<compartment 1 concentration\>\"", ",", "16"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.4", ",", 
               RowBox[{"0.6", "-", 
                RowBox[{"0", 
                 RowBox[{"(", 
                  FractionBox[
                   RowBox[{"0.6", "-", "0.1"}], "4"], ")"}]}]}]}], "}"}], ",",
              "Left"}], "]"}], ",", "\[IndentingNewLine]", "Blue", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"0.6", "-", 
                 RowBox[{"1", 
                  RowBox[{"(", 
                   FractionBox[
                    RowBox[{"0.6", "-", "0.1"}], "4"], ")"}]}]}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"0.3", ",", 
                RowBox[{"0.6", "-", 
                 RowBox[{"1", 
                  RowBox[{"(", 
                   FractionBox[
                    RowBox[{"0.6", "-", "0.1"}], "4"], ")"}]}]}]}], "}"}]}], 
             "}"}], "]"}], ",", "\[IndentingNewLine]", "Black", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<compartment 2 concentration\>\"", ",", "16"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.4", ",", 
               RowBox[{"0.6", "-", 
                RowBox[{"1", 
                 RowBox[{"(", 
                  FractionBox[
                   RowBox[{"0.6", "-", "0.1"}], "4"], ")"}]}]}]}], "}"}], ",",
              "Left"}], "]"}], ",", "\[IndentingNewLine]", "Purple", ",", 
           "\[IndentingNewLine]", "Dashed", ",", "\[IndentingNewLine]", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"0.6", "-", 
                 RowBox[{"2", 
                  RowBox[{"(", 
                   FractionBox[
                    RowBox[{"0.6", "-", "0.1"}], "4"], ")"}]}]}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"0.3", ",", 
                RowBox[{"0.6", "-", 
                 RowBox[{"2", 
                  RowBox[{"(", 
                   FractionBox[
                    RowBox[{"0.6", "-", "0.1"}], "4"], ")"}]}]}]}], "}"}]}], 
             "}"}], "]"}], ",", "\[IndentingNewLine]", "Black", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<toxic dose\>\"", ",", "16"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.4", ",", 
               RowBox[{"0.6", "-", 
                RowBox[{"2", 
                 RowBox[{"(", 
                  FractionBox[
                   RowBox[{"0.6", "-", "0.1"}], "4"], ")"}]}]}]}], "}"}], ",",
              "Left"}], "]"}], ",", "\[IndentingNewLine]", "Green", ",", 
           "\[IndentingNewLine]", "Dashed", ",", "\[IndentingNewLine]", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"0.6", "-", 
                 RowBox[{"3", 
                  RowBox[{"(", 
                   FractionBox[
                    RowBox[{"0.6", "-", "0.1"}], "4"], ")"}]}]}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"0.3", ",", 
                RowBox[{"0.6", "-", 
                 RowBox[{"3", 
                  RowBox[{"(", 
                   FractionBox[
                    RowBox[{"0.6", "-", "0.1"}], "4"], ")"}]}]}]}], "}"}]}], 
             "}"}], "]"}], ",", "\[IndentingNewLine]", "Black", ",", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<effective dose\>\"", ",", "16"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.4", ",", 
               RowBox[{"0.6", "-", 
                RowBox[{"3", 
                 RowBox[{"(", 
                  FractionBox[
                   RowBox[{"0.6", "-", "0.1"}], "4"], ")"}]}]}]}], "}"}], ",",
              "\[IndentingNewLine]", "Left"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "250", "}"}], ",", 
            RowBox[{"{", "300", "}"}]}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", "ad", "]"}], ",", ",", 
        RowBox[{"ka", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", "ad", "]"}], ",", 
        RowBox[{
         SubscriptBox["c1", "0"], "=", "0"}], ",", 
        RowBox[{
         SubscriptBox["c1", "0"], "=", 
         RowBox[{"Din", "/", "V1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"TrueQ", "[", "ad", "]"}], ",", 
        RowBox[{"r", "=", "Din"}], ",", 
        RowBox[{"r", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"comp", "\[Equal]", "1"}], ",", 
        RowBox[{"elim", "=", 
         RowBox[{"{", "1", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"comp", "\[Equal]", "1"}], ",", 
        RowBox[{"k12", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"comp", "\[Equal]", "1"}], ",", 
        RowBox[{"k21", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"elim", ",", "1"}], "]"}], ",", ",", 
        RowBox[{"kel1", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"elim", ",", "2"}], "]"}], ",", ",", 
        RowBox[{"kel2", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"roi", "*", "n"}], "<", "10"}], ",", 
        RowBox[{"m", "=", "n"}], ",", 
        RowBox[{"m", "=", 
         RowBox[{"Ceiling", "[", 
          RowBox[{"10", "/", "roi"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"injectiontimes", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}], "*", "roi"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "m"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eqns", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Rest", "[", 
             RowBox[{"FoldList", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"d", "[", "t", "]"}], ",", 
                    RowBox[{"c1", "[", "t", "]"}], ",", 
                    RowBox[{"c2", "[", "t", "]"}]}], "}"}], 
                  "\[IndentingNewLine]", "/.", 
                  RowBox[{"First", "@", 
                   RowBox[{"NDSolve", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"d", "'"}], "[", "t", "]"}], "\[Equal]", 
                    RowBox[{
                    RowBox[{"-", "ka"}], "*", 
                    RowBox[{"d", "[", "t", "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"c1", "'"}], "[", "t", "]"}], "\[Equal]", 
                    RowBox[{
                    RowBox[{"ka", "*", 
                    RowBox[{
                    RowBox[{"d", "[", "t", "]"}], "/", "V1"}]}], "-", 
                    RowBox[{"(", 
                    RowBox[{"k12", "*", 
                    RowBox[{"c1", "[", "t", "]"}]}], ")"}], "-", 
                    RowBox[{
                    RowBox[{"(", "kel1", ")"}], 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"c1", "[", "t", "]"}], ")"}], "^", 
                    RowBox[{"(", "ro", ")"}]}]}], "+", 
                    RowBox[{"k21", "*", 
                    RowBox[{"c2", "[", "t", "]"}]}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"c2", "'"}], "[", "t", "]"}], "\[Equal]", 
                    RowBox[{
                    RowBox[{"k12", "*", 
                    RowBox[{"c1", "[", "t", "]"}]}], "-", 
                    RowBox[{"k21", "*", 
                    RowBox[{"c2", "[", "t", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", "kel2", ")"}], 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"c2", "[", "t", "]"}], ")"}], "^", 
                    RowBox[{"(", "ro", ")"}]}]}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"d", "[", "#2", "]"}], "\[Equal]", 
                    RowBox[{"Chop", "[", 
                    RowBox[{"r", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"t", "->", "#2"}], "}"}]}], ")"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"Boole", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"t", "->", "#2"}], "}"}]}], ")"}], ">", "0"}], 
                    "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"c1", "[", "#2", "]"}], "\[Equal]", 
                    RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    SubscriptBox["c1", "0"], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"t", "->", "#2"}], "}"}]}], ")"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"Boole", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"t", "->", "#2"}], "}"}]}], ")"}], ">", "0"}], 
                    "]"}]}]}], "]"}], "/", "V1"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"c2", "[", "#2", "]"}], "\[Equal]", 
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"t", "->", "#2"}], "}"}]}], ")"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"Boole", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"t", "->", "#2"}], "}"}]}], ")"}], ">", "0"}], 
                    "]"}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"d", ",", "c1", ",", "c2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "#2", ",", "10"}], "}"}]}], "]"}]}]}], 
                 ")"}], "&"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
               "\[IndentingNewLine]", "injectiontimes"}], "]"}], "]"}], "]"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}], ",", "3"}], "}"}]}], "]"}], ",", "2"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bc", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"t", "\[LessEqual]", 
               RowBox[{"i", "*", "roi"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"m", "-", "1"}]}], "}"}]}], "]"}], ",", "2"}], "]"}], 
          ",", 
          RowBox[{"t", "\[GreaterEqual]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "-", "1"}], ")"}], "*", "roi"}]}]}], "}"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"pw1", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Riffle", "[", 
          RowBox[{
           RowBox[{"Take", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", "eqns", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "]"}], ",", "bc"}], 
          "]"}], ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pw2", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Riffle", "[", 
          RowBox[{
           RowBox[{"Drop", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", "eqns", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "]"}], ",", "bc"}], 
          "]"}], ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Piecewise", "[", "pw1", "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"comp", "==", "2"}], ",", 
                RowBox[{"Piecewise", "[", "pw2", "]"}]}], "]"}], ",", "1", 
              ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", "10"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Exclusions", "\[Rule]", "None"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "10"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "3"}], "}"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Thick", ",", "Orange"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"Thick", ",", "Dashed", ",", "Green"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"Thick", ",", "Dashed", ",", "Purple"}], "}"}]}], 
              "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"True", ",", "False"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<time\>\"", ",", "16"}], "]"}], ",", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<concentration\>\"", ",", "16"}], "]"}]}], 
              "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Epilog", "\[Rule]", 
             RowBox[{"Rotate", "[", 
              RowBox[{
               RowBox[{"Inset", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<therapeutic\\n window\>\"", ",", "14"}], "]"}],
                  ",", 
                 RowBox[{"{", 
                  RowBox[{"9.6", ",", "1.5"}], "}"}]}], "]"}], ",", 
               RowBox[{"3", "*", 
                RowBox[{"Pi", "/", "2"}]}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotLabel", "\[Rule]", 
             RowBox[{"Style", "[", 
              RowBox[{
              "\"\<drug compartment concentration versus time\>\"", ",", "16",
                ",", "Bold"}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "375", "}"}], ",", 
               RowBox[{"{", "400", "}"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"FrameTicksStyle", "->", 
             RowBox[{"Directive", "[", 
              RowBox[{"FontSize", "\[Rule]", "16"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotRangeClipping", "\[Rule]", "False"}]}], 
           "\[IndentingNewLine]", "]"}], "}"}], ",", 
         RowBox[{"{", "LegendKey", "}"}]}], "}"}], "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Style", "[", 
    RowBox[{"\"\<compartmental model\\n\>\"", ",", "Bold"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"comp", ",", "2", ",", "\"\<number of\\ncompartments\>\""}], 
      "}"}], ",", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"1", "\[Rule]", "\"\<one\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{"2", "\[Rule]", "\"\<two\>\""}]}], "\[IndentingNewLine]", 
      "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "RadioButtonBar"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "k12", ",", "1", ",", "\"\<\!\(\*SubscriptBox[\(k\), \(12\)]\)\>\""}], 
      "}"}], ",", "0", ",", "4", ",", "0.1", ",", "\[IndentingNewLine]", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
     RowBox[{"Enabled", "\[Rule]", 
      RowBox[{"TrueQ", "[", 
       RowBox[{"comp", "\[Equal]", "2"}], "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "k21", ",", "1", ",", "\"\<\!\(\*SubscriptBox[\(k\), \(21\)]\)\>\""}], 
      "}"}], ",", "0", ",", "4", ",", "0.1", ",", "\[IndentingNewLine]", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
     RowBox[{"Enabled", "\[Rule]", 
      RowBox[{"TrueQ", "[", 
       RowBox[{"comp", "\[Equal]", "2"}], "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "Delimiter", ",", "\[IndentingNewLine]", 
   RowBox[{"Style", "[", 
    RowBox[{"\"\<drug kinetics\\n\>\"", ",", "Bold"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"elim", ",", 
       RowBox[{"{", "1", "}"}], ",", 
       "\"\<elimination\\ncompartment(s):\>\""}], "}"}], ",", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"1", "\[Rule]", "\"\<one\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{"2", "\[Rule]", "\"\<two\>\""}]}], "\[IndentingNewLine]", 
      "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "CheckboxBar"}], ",", 
     RowBox[{"Enabled", "\[Rule]", 
      RowBox[{"TrueQ", "[", 
       RowBox[{"comp", "\[Equal]", "2"}], "]"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ro", ",", "1", ",", "\"\<elimination\\n order:\>\""}], "}"}], 
     ",", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "0", "\[Rule]", "\"\<\!\(\*SuperscriptBox[\(0\), \(th\)]\) \>\""}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
       "1", "\[Rule]", "\"\<\!\(\*SuperscriptBox[\(1\), \(st\)]\) \>\""}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
       "2", "\[Rule]", "\"\<\!\(\*SuperscriptBox[\(2\), \(nd\)]\) \>\""}]}], 
      "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "RadioButton"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "kel1", ",", "1", ",", 
       "\"\<\!\(\*SubscriptBox[\(k\), \(el, 1\)]\)\>\""}], "}"}], ",", "0", 
     ",", "4", ",", "0.1", ",", "\[IndentingNewLine]", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
     RowBox[{"Enabled", "\[Rule]", 
      RowBox[{"MemberQ", "[", 
       RowBox[{"elim", ",", "1"}], "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "kel2", ",", "1", ",", 
       "\"\<\!\(\*SubscriptBox[\(k\), \(el, 2\)]\)\>\""}], "}"}], ",", "0", 
     ",", "4", ",", "0.1", ",", "\[IndentingNewLine]", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
     RowBox[{"Enabled", "\[Rule]", 
      RowBox[{"MemberQ", "[", 
       RowBox[{"elim", ",", "2"}], "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ad", ",", "False", ",", 
       "\"\<\!\(\*SuperscriptBox[\(1\), \(st\)]\) compartment\\ndrug \
absorption\>\""}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "Checkbox"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ka", ",", "2", ",", "\"\<\!\(\*SubscriptBox[\(k\), \(a\)]\)\>\""}], 
      "}"}], ",", "0", ",", "4", ",", "0.1", ",", "\[IndentingNewLine]", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
     RowBox[{"Enabled", "\[Rule]", 
      RowBox[{"Dynamic", "[", "ad", "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "Delimiter", ",", "\[IndentingNewLine]", 
   RowBox[{"Style", "[", 
    RowBox[{"\"\<dosing scheme\\n\>\"", ",", "Bold"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Din", ",", "1.5", ",", "\"\<dose mass\>\""}], "}"}], ",", "0", 
     ",", "2", ",", "0.05", ",", "\[IndentingNewLine]", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "5", ",", "\"\<number of doses\>\""}], "}"}], ",", 
     "1", ",", "9", ",", "1", ",", "\[IndentingNewLine]", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"roi", ",", "1.4", ",", "\"\<dose interval\>\""}], "}"}], ",", 
     "0.2", ",", "4", ",", "0.1", ",", "\[IndentingNewLine]", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"SynchronousUpdating", "\[Rule]", "False"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"TrackedSymbols", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
   
   RowBox[{"ControlPlacement", "\[Rule]", "Left"}], ",", " ", 
   RowBox[{"AutorunSequencing", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.608229656247377*^9, {3.6082298870305767`*^9, 3.6082298888106785`*^9}, {
   3.6082299277639065`*^9, 3.6082301156336517`*^9}, {3.608230882471513*^9, 
   3.608230890185954*^9}, {3.6082313258158703`*^9, 3.608231329160062*^9}, {
   3.608231509401371*^9, 3.6082315135176067`*^9}, 3.6082316068119426`*^9, {
   3.608231820984193*^9, 3.6082318741172314`*^9}, {3.608304336510186*^9, 
   3.6083043939804735`*^9}, 3.60830448483967*^9, {3.60839988178531*^9, 
   3.608399960797829*^9}, {3.6084063347648926`*^9, 3.6084063436394*^9}, {
   3.608406442404049*^9, 3.608406494852049*^9}, {3.608406541811735*^9, 
   3.608406546152983*^9}, {3.608406680138647*^9, 3.608406680503668*^9}, {
   3.608406730646536*^9, 3.608406760922267*^9}, {3.608406818700572*^9, 
   3.6084068290061617`*^9}, {3.6084068773539267`*^9, 3.608406932875102*^9}, {
   3.6084069972157826`*^9, 3.6084070221122065`*^9}, {3.608407073683156*^9, 
   3.608407073971173*^9}, {3.608407492760126*^9, 3.608407504231782*^9}, {
   3.6084075371176634`*^9, 3.60840754090888*^9}, {3.608407576593921*^9, 
   3.6084075797631025`*^9}, {3.6084076318340807`*^9, 
   3.6084076417626486`*^9}, {3.6084078056220207`*^9, 
   3.6084078363437777`*^9}, {3.6084079389176445`*^9, 3.608407976159775*^9}, {
   3.608408016391076*^9, 3.608408026844674*^9}, {3.6084081479396*^9, 
   3.6084081484696302`*^9}, {3.6084082490193815`*^9, 3.608408258344915*^9}, {
   3.6084082931839075`*^9, 3.608408311109933*^9}, {3.608408703305365*^9, 
   3.6084087048534536`*^9}, {3.6084089847794647`*^9, 
   3.6084090008613844`*^9}, {3.6084222831314363`*^9, 3.608422285891594*^9}, {
   3.6084223787849073`*^9, 3.6084223915666385`*^9}, {3.6084225055211563`*^9, 
   3.6084225057801714`*^9}, {3.6084225543699503`*^9, 
   3.6084228898621397`*^9}, {3.608422963950377*^9, 3.6084230074098625`*^9}, {
   3.608423124303549*^9, 3.608423133886097*^9}, {3.6084234097928777`*^9, 
   3.608423643395239*^9}, 3.60842687314397*^9, {3.608429077412047*^9, 
   3.608429098216237*^9}, {3.6084295332391186`*^9, 3.608429546969904*^9}, 
   3.6084301233538713`*^9, {3.6089180765257006`*^9, 3.608918083808117*^9}, {
   3.60891817897256*^9, 3.608918188184087*^9}, {3.608918342311902*^9, 
   3.608918344355019*^9}, 3.6089183930728054`*^9, {3.608920564269991*^9, 
   3.6089205902744784`*^9}, {3.6089207074311795`*^9, 3.608920745349348*^9}, {
   3.6089211186286983`*^9, 3.608921121605869*^9}, {3.608924443131303*^9, 
   3.608924472333675*^9}, 3.6089245241220307`*^9, {3.6097585849585342`*^9, 
   3.609758593867425*^9}, {3.609854937881049*^9, 3.609854940677796*^9}, {
   3.609854988241117*^9, 3.609854988409827*^9}, 3.609855063075678*^9, {
   3.610214718364154*^9, 3.61021471858858*^9}, {3.6344887654445896`*^9, 
   3.634488824918991*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`ad$$ = False, $CellContext`comp$$ = 
    1, $CellContext`Din$$ = 1.5, $CellContext`elim$$ = {
    1}, $CellContext`k12$$ = 0, $CellContext`k21$$ = 0, $CellContext`ka$$ = 
    0, $CellContext`kel1$$ = 1, $CellContext`kel2$$ = 0, $CellContext`n$$ = 
    5, $CellContext`ro$$ = 1, $CellContext`roi$$ = 1.4, Typeset`show$$ = True,
     Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[
       Style["compartmental model\n", Bold]], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`comp$$], 2, "number of\ncompartments"}, {
      1 -> "one", 2 -> "two"}}, {{
       Hold[$CellContext`k12$$], 1, "\!\(\*SubscriptBox[\(k\), \(12\)]\)"}, 0,
       4, 0.1}, {{
       Hold[$CellContext`k21$$], 1, "\!\(\*SubscriptBox[\(k\), \(21\)]\)"}, 0,
       4, 0.1}, {
      Hold[
       Style["drug kinetics\n", Bold]], Manipulate`Dump`ThisIsNotAControl}, {{
      
       Hold[$CellContext`elim$$], {1}, "elimination\ncompartment(s):"}, {
      1 -> "one", 2 -> "two"}}, {{
       Hold[$CellContext`ro$$], 1, "elimination\n order:"}, {
      0 -> "\!\(\*SuperscriptBox[\(0\), \(th\)]\) ", 1 -> 
       "\!\(\*SuperscriptBox[\(1\), \(st\)]\) ", 2 -> 
       "\!\(\*SuperscriptBox[\(2\), \(nd\)]\) "}}, {{
       Hold[$CellContext`kel1$$], 1, 
       "\!\(\*SubscriptBox[\(k\), \(el, 1\)]\)"}, 0, 4, 0.1}, {{
       Hold[$CellContext`kel2$$], 1, 
       "\!\(\*SubscriptBox[\(k\), \(el, 2\)]\)"}, 0, 4, 0.1}, {{
       Hold[$CellContext`ad$$], False, 
       "\!\(\*SuperscriptBox[\(1\), \(st\)]\) compartment\ndrug absorption"}, \
{True, False}}, {{
       Hold[$CellContext`ka$$], 2, "\!\(\*SubscriptBox[\(k\), \(a\)]\)"}, 0, 
      4, 0.1}, {
      Hold[
       Style["dosing scheme\n", Bold]], Manipulate`Dump`ThisIsNotAControl}, {{
      
       Hold[$CellContext`Din$$], 1.5, "dose mass"}, 0, 2, 0.05}, {{
       Hold[$CellContext`n$$], 5, "number of doses"}, 1, 9, 1}, {{
       Hold[$CellContext`roi$$], 1.4, "dose interval"}, 0.2, 4, 0.1}}, 
    Typeset`size$$ = {375., {198., 205.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`comp$32769$$ = False, $CellContext`k12$32770$$ = 
    0, $CellContext`k21$32771$$ = 0, $CellContext`elim$32772$$ = 
    False, $CellContext`ro$32773$$ = False, $CellContext`kel1$32774$$ = 
    0, $CellContext`kel2$32775$$ = 0, $CellContext`ad$32776$$ = 
    False, $CellContext`ka$32777$$ = 0, $CellContext`Din$32778$$ = 
    0, $CellContext`n$32779$$ = 0, $CellContext`roi$32780$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`ad$$ = False, $CellContext`comp$$ = 
        2, $CellContext`Din$$ = 
        1.5, $CellContext`elim$$ = {1}, $CellContext`k12$$ = 
        1, $CellContext`k21$$ = 1, $CellContext`ka$$ = 2, $CellContext`kel1$$ = 
        1, $CellContext`kel2$$ = 1, $CellContext`n$$ = 5, $CellContext`ro$$ = 
        1, $CellContext`roi$$ = 1.4}, "ControllerVariables" :> {
        Hold[$CellContext`comp$$, $CellContext`comp$32769$$, False], 
        Hold[$CellContext`k12$$, $CellContext`k12$32770$$, 0], 
        Hold[$CellContext`k21$$, $CellContext`k21$32771$$, 0], 
        Hold[$CellContext`elim$$, $CellContext`elim$32772$$, False], 
        Hold[$CellContext`ro$$, $CellContext`ro$32773$$, False], 
        Hold[$CellContext`kel1$$, $CellContext`kel1$32774$$, 0], 
        Hold[$CellContext`kel2$$, $CellContext`kel2$32775$$, 0], 
        Hold[$CellContext`ad$$, $CellContext`ad$32776$$, False], 
        Hold[$CellContext`ka$$, $CellContext`ka$32777$$, 0], 
        Hold[$CellContext`Din$$, $CellContext`Din$32778$$, 0], 
        Hold[$CellContext`n$$, $CellContext`n$32779$$, 0], 
        Hold[$CellContext`roi$$, $CellContext`roi$32780$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Block[{$CellContext`V1 = 
         1, $CellContext`bc, $CellContext`pw1, $CellContext`pw2, \
$CellContext`a2, $CellContext`b2, $CellContext`injectiontimes, \
$CellContext`r, $CellContext`c1, $CellContext`c2, $CellContext`d, \
$CellContext`eqns, $CellContext`m, $CellContext`LegendKey}, \
$CellContext`LegendKey = Graphics[{Black, 
            Text[
             Style["plot legend", 16, Bold], {1, 0.84}], Thick, Orange, 
            
            Line[{{0, 0.6 - 0 ((0.6 - 0.1)/4)}, {
              0.3, 0.6 - 0 ((0.6 - 0.1)/4)}}], Black, 
            Text[
             Style["compartment 1 concentration", 16], {
             0.4, 0.6 - 0 ((0.6 - 0.1)/4)}, Left], Blue, 
            
            Line[{{0, 0.6 - 1 ((0.6 - 0.1)/4)}, {
              0.3, 0.6 - 1 ((0.6 - 0.1)/4)}}], Black, 
            Text[
             Style["compartment 2 concentration", 16], {
             0.4, 0.6 - 1 ((0.6 - 0.1)/4)}, Left], Purple, Dashed, 
            
            Line[{{0, 0.6 - 2 ((0.6 - 0.1)/4)}, {
              0.3, 0.6 - 2 ((0.6 - 0.1)/4)}}], Black, 
            Text[
             Style["toxic dose", 16], {0.4, 0.6 - 2 ((0.6 - 0.1)/4)}, Left], 
            Green, Dashed, 
            
            Line[{{0, 0.6 - 3 ((0.6 - 0.1)/4)}, {
              0.3, 0.6 - 3 ((0.6 - 0.1)/4)}}], Black, 
            Text[
             Style["effective dose", 16], {0.4, 0.6 - 3 ((0.6 - 0.1)/4)}, 
             Left]}, PlotRange -> {{0, 2}, {0, 1}}, 
           ImageSize -> {{250}, {300}}]; If[
          TrueQ[$CellContext`ad$$], Null, $CellContext`ka$$ = 0]; If[
          TrueQ[$CellContext`ad$$], Subscript[$CellContext`c1, 0] = 0, 
          Subscript[$CellContext`c1, 0] = $CellContext`Din$$/$CellContext`V1]; 
        If[
          
          TrueQ[$CellContext`ad$$], $CellContext`r = $CellContext`Din$$, \
$CellContext`r = 0]; If[$CellContext`comp$$ == 1, $CellContext`elim$$ = {1}]; 
        If[$CellContext`comp$$ == 1, $CellContext`k12$$ = 0]; 
        If[$CellContext`comp$$ == 1, $CellContext`k21$$ = 0]; If[
          MemberQ[$CellContext`elim$$, 1], Null, $CellContext`kel1$$ = 0]; 
        If[
          MemberQ[$CellContext`elim$$, 2], Null, $CellContext`kel2$$ = 0]; 
        If[$CellContext`roi$$ $CellContext`n$$ < 
          10, $CellContext`m = $CellContext`n$$, $CellContext`m = 
          Ceiling[10/$CellContext`roi$$]]; $CellContext`injectiontimes = 
         Table[($CellContext`i - 1) $CellContext`roi$$, {$CellContext`i, 
            1, $CellContext`m}]; $CellContext`eqns = Partition[
           Drop[
            Flatten[
             Rest[
              FoldList[ReplaceAll[{
                 $CellContext`d[$CellContext`t], 
                 $CellContext`c1[$CellContext`t], 
                 $CellContext`c2[$CellContext`t]}, 
                First[
                 
                 NDSolve[{
                  Derivative[
                    1][$CellContext`d][$CellContext`t] == \
(-$CellContext`ka$$) $CellContext`d[$CellContext`t], 
                   Derivative[
                    1][$CellContext`c1][$CellContext`t] == $CellContext`ka$$ \
($CellContext`d[$CellContext`t]/$CellContext`V1) - $CellContext`k12$$ \
$CellContext`c1[$CellContext`t] - $CellContext`kel1$$ \
$CellContext`c1[$CellContext`t]^$CellContext`ro$$ + $CellContext`k21$$ \
$CellContext`c2[$CellContext`t], 
                   Derivative[
                    1][$CellContext`c2][$CellContext`t] == $CellContext`k12$$ \
$CellContext`c1[$CellContext`t] - $CellContext`k21$$ \
$CellContext`c2[$CellContext`t] - $CellContext`kel2$$ \
$CellContext`c2[$CellContext`t]^$CellContext`ro$$, $CellContext`d[#2] == 
                   Chop[$CellContext`r + ReplaceAll[
                    Part[#, 1], {$CellContext`t -> #2}] Boole[ReplaceAll[
                    Part[#, 1], {$CellContext`t -> #2}] > 
                    0]], $CellContext`c1[#2] == 
                   Chop[Subscript[$CellContext`c1, 0] + ReplaceAll[
                    Part[#, 2], {$CellContext`t -> #2}] Boole[ReplaceAll[
                    Part[#, 2], {$CellContext`t -> #2}] > 
                    0]]/$CellContext`V1, $CellContext`c2[#2] == 
                   Chop[ReplaceAll[
                    Part[#, 3], {$CellContext`t -> #2}] Boole[ReplaceAll[
                    Part[#, 3], {$CellContext`t -> #2}] > 
                    0]]}, {$CellContext`d, $CellContext`c1, $CellContext`c2}, \
{$CellContext`t, #2, 10}]]]& , {0, 0, 0}, $CellContext`injectiontimes]]], {
            1, -1, 3}], 2]; $CellContext`bc = Flatten[{
            Flatten[
             
             Table[$CellContext`t <= $CellContext`i $CellContext`roi$$, \
{$CellContext`i, 1, $CellContext`m - 1}], 
             2], $CellContext`t >= ($CellContext`m - 
              1) $CellContext`roi$$}]; $CellContext`pw1 = Partition[
           Riffle[
            Take[
             Flatten[$CellContext`eqns], {1, -1, 2}], $CellContext`bc], 
           2]; $CellContext`pw2 = Partition[
           Riffle[
            Drop[
             Flatten[$CellContext`eqns], {1, -1, 2}], $CellContext`bc], 2]; 
        Grid[{{
            Plot[{
              Piecewise[$CellContext`pw1], 
              If[$CellContext`comp$$ == 2, 
               Piecewise[$CellContext`pw2]], 1, 2}, {$CellContext`t, 0, 10}, 
             Exclusions -> None, PlotRange -> {{0, 10}, {0, 3}}, 
             PlotStyle -> {{Thick, Orange}, {Thick, Blue}, {
               Thick, Dashed, Green}, {Thick, Dashed, Purple}}, 
             Frame -> {{True, False}, {True, False}}, FrameLabel -> {
               Style["time", 16], 
               Style["concentration", 16]}, Epilog -> Rotate[
               Inset[
                Style["therapeutic\n window", 14], {9.6, 1.5}], 3 (Pi/2)], 
             PlotLabel -> 
             Style["drug compartment concentration versus time", 16, Bold], 
             ImageSize -> {{375}, {400}}, FrameTicksStyle -> 
             Directive[FontSize -> 16], PlotRangeClipping -> 
             False]}, {$CellContext`LegendKey}}]], "Specifications" :> {
        Style[
        "compartmental model\n", 
         Bold], {{$CellContext`comp$$, 2, "number of\ncompartments"}, {
         1 -> "one", 2 -> "two"}, ControlType -> 
         RadioButtonBar}, {{$CellContext`k12$$, 1, 
          "\!\(\*SubscriptBox[\(k\), \(12\)]\)"}, 0, 4, 0.1, Appearance -> 
         "Labeled", Enabled -> Dynamic[
           TrueQ[$CellContext`comp$$ == 2]], ImageSize -> 
         Tiny}, {{$CellContext`k21$$, 1, 
          "\!\(\*SubscriptBox[\(k\), \(21\)]\)"}, 0, 4, 0.1, Appearance -> 
         "Labeled", Enabled -> Dynamic[
           TrueQ[$CellContext`comp$$ == 2]], ImageSize -> Tiny}, Delimiter, 
        Style[
        "drug kinetics\n", 
         Bold], {{$CellContext`elim$$, {1}, "elimination\ncompartment(s):"}, {
         1 -> "one", 2 -> "two"}, ControlType -> CheckboxBar, Enabled -> 
         Dynamic[
           TrueQ[$CellContext`comp$$ == 2]]}, {{$CellContext`ro$$, 1, 
          "elimination\n order:"}, {
         0 -> "\!\(\*SuperscriptBox[\(0\), \(th\)]\) ", 1 -> 
          "\!\(\*SuperscriptBox[\(1\), \(st\)]\) ", 2 -> 
          "\!\(\*SuperscriptBox[\(2\), \(nd\)]\) "}, ControlType -> 
         RadioButton}, {{$CellContext`kel1$$, 1, 
          "\!\(\*SubscriptBox[\(k\), \(el, 1\)]\)"}, 0, 4, 0.1, Appearance -> 
         "Labeled", Enabled -> Dynamic[
           MemberQ[$CellContext`elim$$, 1]], ImageSize -> 
         Tiny}, {{$CellContext`kel2$$, 1, 
          "\!\(\*SubscriptBox[\(k\), \(el, 2\)]\)"}, 0, 4, 0.1, Appearance -> 
         "Labeled", Enabled -> Dynamic[
           MemberQ[$CellContext`elim$$, 2]], ImageSize -> 
         Tiny}, {{$CellContext`ad$$, False, 
          "\!\(\*SuperscriptBox[\(1\), \(st\)]\) compartment\ndrug \
absorption"}, {True, False}, ControlType -> 
         Checkbox}, {{$CellContext`ka$$, 2, 
          "\!\(\*SubscriptBox[\(k\), \(a\)]\)"}, 0, 4, 0.1, Appearance -> 
         "Labeled", Enabled -> Dynamic[$CellContext`ad$$], ImageSize -> Tiny},
         Delimiter, 
        Style[
        "dosing scheme\n", Bold], {{$CellContext`Din$$, 1.5, "dose mass"}, 0, 
         2, 0.05, Appearance -> "Labeled", ImageSize -> 
         Tiny}, {{$CellContext`n$$, 5, "number of doses"}, 1, 9, 1, 
         Appearance -> "Labeled", ImageSize -> 
         Tiny}, {{$CellContext`roi$$, 1.4, "dose interval"}, 0.2, 4, 0.1, 
         Appearance -> "Labeled", ImageSize -> Tiny}}, 
      "Options" :> {
       SynchronousUpdating -> False, TrackedSymbols -> True, ControlPlacement -> 
        Left, AutorunSequencing -> {2, 3}}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{651., {237., 244.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.634488331266756*^9, 3.6344886199452677`*^9, {3.6344888010386257`*^9, 
   3.6344888259030476`*^9}},
 CellID->433757142]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ManipulateCaptionSection"],

Cell["\<\
The one- and two-compartment pharmacokinetic models give the concentration \
profile of a drug in the body for a given dosing scheme. The area under these \
curves corresponds to the total exposure to the drug. The therapeutic window \
for a drug is the range between the effective dose and the toxic dose. The \
dosing scheme for a drug is designed to attain the target concentrations \
within the therapeutic window. The therapeutic window in this Demonstration \
is preset, but it is different for each drug. Drug elimination reactions can \
have varying reaction orders and associated rate constants depending on the \
system. Drugs are often absorbed in the first compartment when administered \
orally; the drug must first be absorbed in the stomach before entering the \
blood stream.\
\>", "ManipulateCaption",
 CellChangeTimes->{{3.6083932210962133`*^9, 3.608393299303686*^9}, {
   3.6083933890628204`*^9, 3.608393414373268*^9}, {3.608425815846496*^9, 
   3.608425911531969*^9}, {3.608425967657179*^9, 3.6084260246594396`*^9}, {
   3.6084260825217495`*^9, 3.608426251446411*^9}, {3.608426367812067*^9, 
   3.608426413294668*^9}, {3.608426608214817*^9, 3.608426624990776*^9}, {
   3.6084277823659744`*^9, 3.608427788649334*^9}, {3.608427834090933*^9, 
   3.6084278900601344`*^9}, {3.6084305027835736`*^9, 
   3.6084305302821465`*^9}, {3.6086567021051683`*^9, 3.608656704343656*^9}, {
   3.608656756139017*^9, 3.608656810895337*^9}, {3.6089212075777864`*^9, 
   3.6089212137871413`*^9}, {3.608924595931676*^9, 3.608924637666363*^9}, {
   3.609702974978194*^9, 3.609702981222376*^9}, 3.6097584599958324`*^9, 
   3.609758622574295*^9, {3.6097588338184175`*^9, 3.609758834361472*^9}, {
   3.60985512854624*^9, 3.6098551311909647`*^9}, {3.6098591560504847`*^9, 
   3.609859163435318*^9}, {3.6098591994660482`*^9, 3.609859259103099*^9}, {
   3.609859673274006*^9, 3.6098596739422207`*^9}, {3.609859721565138*^9, 
   3.609859726553672*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ThumbnailSection"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`ad$$ = False, $CellContext`comp$$ = 
    2, $CellContext`Din$$ = 1.55, $CellContext`elim$$ = {
    2}, $CellContext`k12$$ = 4., $CellContext`k21$$ = 0.2, $CellContext`ka$$ =
     0, $CellContext`kel1$$ = 0, $CellContext`kel2$$ = 
    1.7000000000000002`, $CellContext`n$$ = 8, $CellContext`ro$$ = 
    2, $CellContext`roi$$ = 0.7, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[
       Style["compartmental model\n", Bold]], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`comp$$], 2, "number of\ncompartments"}, {
      1 -> "one", 2 -> "two"}}, {{
       Hold[$CellContext`k12$$], 4., "\!\(\*SubscriptBox[\(k\), \(12\)]\)"}, 
      0, 4, 0.1}, {{
       Hold[$CellContext`k21$$], 0.2, "\!\(\*SubscriptBox[\(k\), \(21\)]\)"}, 
      0, 4, 0.1}, {
      Hold[
       Style["drug kinetics\n", Bold]], Manipulate`Dump`ThisIsNotAControl}, {{
      
       Hold[$CellContext`elim$$], {2}, "elimination\ncompartment(s):"}, {
      1 -> "one", 2 -> "two"}}, {{
       Hold[$CellContext`ro$$], 2, "elimination\n order:"}, {
      0 -> "\!\(\*SuperscriptBox[\(0\), \(th\)]\) ", 1 -> 
       "\!\(\*SuperscriptBox[\(1\), \(st\)]\) ", 2 -> 
       "\!\(\*SuperscriptBox[\(2\), \(nd\)]\) "}}, {{
       Hold[$CellContext`kel1$$], 0, 
       "\!\(\*SubscriptBox[\(k\), \(el, 1\)]\)"}, 0, 4, 0.1}, {{
       Hold[$CellContext`kel2$$], 1.7000000000000002`, 
       "\!\(\*SubscriptBox[\(k\), \(el, 2\)]\)"}, 0, 4, 0.1}, {{
       Hold[$CellContext`ad$$], False, 
       "\!\(\*SuperscriptBox[\(1\), \(st\)]\) compartment\ndrug absorption"}, \
{True, False}}, {{
       Hold[$CellContext`ka$$], 0, "\!\(\*SubscriptBox[\(k\), \(a\)]\)"}, 0, 
      4, 0.1}, {
      Hold[
       Style["dosing scheme\n", Bold]], Manipulate`Dump`ThisIsNotAControl}, {{
      
       Hold[$CellContext`Din$$], 1.55, "dose mass"}, 0, 2, 0.05}, {{
       Hold[$CellContext`n$$], 8, "number of doses"}, 1, 9, 1}, {{
       Hold[$CellContext`roi$$], 0.7, "dose interval"}, 0.2, 4, 0.1}}, 
    Typeset`size$$ = {375., {194.34375, 199.65625}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`comp$3830$$ = False, $CellContext`k12$3831$$ = 
    0, $CellContext`k21$3832$$ = 0, $CellContext`elim$3833$$ = 
    False, $CellContext`ro$3834$$ = False, $CellContext`kel1$3835$$ = 
    0, $CellContext`kel2$3836$$ = 0, $CellContext`ad$3837$$ = 
    False, $CellContext`ka$3838$$ = 0, $CellContext`Din$3839$$ = 
    0, $CellContext`n$3840$$ = 0, $CellContext`roi$3841$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`ad$$ = False, $CellContext`comp$$ = 
        2, $CellContext`Din$$ = 
        1.55, $CellContext`elim$$ = {2}, $CellContext`k12$$ = 
        4., $CellContext`k21$$ = 0.2, $CellContext`ka$$ = 
        0, $CellContext`kel1$$ = 0, $CellContext`kel2$$ = 
        1.7000000000000002`, $CellContext`n$$ = 8, $CellContext`ro$$ = 
        2, $CellContext`roi$$ = 0.7}, "ControllerVariables" :> {
        Hold[$CellContext`comp$$, $CellContext`comp$3830$$, False], 
        Hold[$CellContext`k12$$, $CellContext`k12$3831$$, 0], 
        Hold[$CellContext`k21$$, $CellContext`k21$3832$$, 0], 
        Hold[$CellContext`elim$$, $CellContext`elim$3833$$, False], 
        Hold[$CellContext`ro$$, $CellContext`ro$3834$$, False], 
        Hold[$CellContext`kel1$$, $CellContext`kel1$3835$$, 0], 
        Hold[$CellContext`kel2$$, $CellContext`kel2$3836$$, 0], 
        Hold[$CellContext`ad$$, $CellContext`ad$3837$$, False], 
        Hold[$CellContext`ka$$, $CellContext`ka$3838$$, 0], 
        Hold[$CellContext`Din$$, $CellContext`Din$3839$$, 0], 
        Hold[$CellContext`n$$, $CellContext`n$3840$$, 0], 
        Hold[$CellContext`roi$$, $CellContext`roi$3841$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Block[{$CellContext`V1 = 
         1, $CellContext`bc, $CellContext`pw1, $CellContext`pw2, \
$CellContext`a2, $CellContext`b2, $CellContext`injectiontimes, \
$CellContext`r, $CellContext`c1, $CellContext`c2, $CellContext`d, \
$CellContext`eqns, $CellContext`m, $CellContext`LegendKey}, \
$CellContext`LegendKey = Graphics[{Black, 
            Text[
             Style["plot legend", 16, Bold], {1, 0.84}], Thick, Orange, 
            
            Line[{{0, 0.6 - 0 ((0.6 - 0.1)/4)}, {
              0.3, 0.6 - 0 ((0.6 - 0.1)/4)}}], Black, 
            Text[
             Style["compartment 1 concentration", 16], {
             0.4, 0.6 - 0 ((0.6 - 0.1)/4)}, Left], Blue, 
            
            Line[{{0, 0.6 - 1 ((0.6 - 0.1)/4)}, {
              0.3, 0.6 - 1 ((0.6 - 0.1)/4)}}], Black, 
            Text[
             Style["compartment 2 concentration", 16], {
             0.4, 0.6 - 1 ((0.6 - 0.1)/4)}, Left], Purple, Dashed, 
            
            Line[{{0, 0.6 - 2 ((0.6 - 0.1)/4)}, {
              0.3, 0.6 - 2 ((0.6 - 0.1)/4)}}], Black, 
            Text[
             Style["toxic dose", 16], {0.4, 0.6 - 2 ((0.6 - 0.1)/4)}, Left], 
            Green, Dashed, 
            
            Line[{{0, 0.6 - 3 ((0.6 - 0.1)/4)}, {
              0.3, 0.6 - 3 ((0.6 - 0.1)/4)}}], Black, 
            Text[
             Style["effective dose", 16], {0.4, 0.6 - 3 ((0.6 - 0.1)/4)}, 
             Left]}, PlotRange -> {{0, 2}, {0, 1}}, 
           ImageSize -> {{250}, {300}}]; If[
          TrueQ[$CellContext`ad$$], Null, $CellContext`ka$$ = 0]; If[
          TrueQ[$CellContext`ad$$], Subscript[$CellContext`c1, 0] = 0, 
          Subscript[$CellContext`c1, 0] = $CellContext`Din$$/$CellContext`V1]; 
        If[
          
          TrueQ[$CellContext`ad$$], $CellContext`r = $CellContext`Din$$, \
$CellContext`r = 0]; If[$CellContext`comp$$ == 1, $CellContext`elim$$ = {1}]; 
        If[$CellContext`comp$$ == 1, $CellContext`k12$$ = 0]; 
        If[$CellContext`comp$$ == 1, $CellContext`k21$$ = 0]; If[
          MemberQ[$CellContext`elim$$, 1], Null, $CellContext`kel1$$ = 0]; 
        If[
          MemberQ[$CellContext`elim$$, 2], Null, $CellContext`kel2$$ = 0]; 
        If[$CellContext`roi$$ $CellContext`n$$ < 
          10, $CellContext`m = $CellContext`n$$, $CellContext`m = 
          Ceiling[10/$CellContext`roi$$]]; $CellContext`injectiontimes = 
         Table[($CellContext`i - 1) $CellContext`roi$$, {$CellContext`i, 
            1, $CellContext`m}]; $CellContext`eqns = Partition[
           Drop[
            Flatten[
             Rest[
              FoldList[ReplaceAll[{
                 $CellContext`d[$CellContext`t], 
                 $CellContext`c1[$CellContext`t], 
                 $CellContext`c2[$CellContext`t]}, 
                First[
                 
                 NDSolve[{
                  Derivative[
                    1][$CellContext`d][$CellContext`t] == \
(-$CellContext`ka$$) $CellContext`d[$CellContext`t], 
                   Derivative[
                    1][$CellContext`c1][$CellContext`t] == $CellContext`ka$$ \
($CellContext`d[$CellContext`t]/$CellContext`V1) - $CellContext`k12$$ \
$CellContext`c1[$CellContext`t] - $CellContext`kel1$$ \
$CellContext`c1[$CellContext`t]^$CellContext`ro$$ + $CellContext`k21$$ \
$CellContext`c2[$CellContext`t], 
                   Derivative[
                    1][$CellContext`c2][$CellContext`t] == $CellContext`k12$$ \
$CellContext`c1[$CellContext`t] - $CellContext`k21$$ \
$CellContext`c2[$CellContext`t] - $CellContext`kel2$$ \
$CellContext`c2[$CellContext`t]^$CellContext`ro$$, $CellContext`d[#2] == 
                   Chop[$CellContext`r + ReplaceAll[
                    Part[#, 1], {$CellContext`t -> #2}] Boole[ReplaceAll[
                    Part[#, 1], {$CellContext`t -> #2}] > 
                    0]], $CellContext`c1[#2] == 
                   Chop[Subscript[$CellContext`c1, 0] + ReplaceAll[
                    Part[#, 2], {$CellContext`t -> #2}] Boole[ReplaceAll[
                    Part[#, 2], {$CellContext`t -> #2}] > 
                    0]]/$CellContext`V1, $CellContext`c2[#2] == 
                   Chop[ReplaceAll[
                    Part[#, 3], {$CellContext`t -> #2}] Boole[ReplaceAll[
                    Part[#, 3], {$CellContext`t -> #2}] > 
                    0]]}, {$CellContext`d, $CellContext`c1, $CellContext`c2}, \
{$CellContext`t, #2, 10}]]]& , {0, 0, 0}, $CellContext`injectiontimes]]], {
            1, -1, 3}], 2]; $CellContext`bc = Flatten[{
            Flatten[
             
             Table[$CellContext`t <= $CellContext`i $CellContext`roi$$, \
{$CellContext`i, 1, $CellContext`m - 1}], 
             2], $CellContext`t >= ($CellContext`m - 
              1) $CellContext`roi$$}]; $CellContext`pw1 = Partition[
           Riffle[
            Take[
             Flatten[$CellContext`eqns], {1, -1, 2}], $CellContext`bc], 
           2]; $CellContext`pw2 = Partition[
           Riffle[
            Drop[
             Flatten[$CellContext`eqns], {1, -1, 2}], $CellContext`bc], 2]; 
        Grid[{{
            Plot[{
              Piecewise[$CellContext`pw1], 
              If[$CellContext`comp$$ == 2, 
               Piecewise[$CellContext`pw2]], 1, 2}, {$CellContext`t, 0, 10}, 
             Exclusions -> None, PlotRange -> {{0, 10}, {0, 3}}, 
             PlotStyle -> {{Thick, Orange}, {Thick, Blue}, {
               Thick, Dashed, Green}, {Thick, Dashed, Purple}}, 
             Frame -> {{True, False}, {True, False}}, FrameLabel -> {
               Style["time", 16], 
               Style["concentration", 16]}, Epilog -> Rotate[
               Inset[
                Style["therapeutic\n window", 14], {9.6, 1.5}], 3 (Pi/2)], 
             PlotLabel -> 
             Style["drug compartment concentration versus time", 16, Bold], 
             ImageSize -> {{375}, {400}}, FrameTicksStyle -> 
             Directive[FontSize -> 16], PlotRangeClipping -> 
             False]}, {$CellContext`LegendKey}}]], "Specifications" :> {
        Style[
        "compartmental model\n", 
         Bold], {{$CellContext`comp$$, 2, "number of\ncompartments"}, {
         1 -> "one", 2 -> "two"}, ControlType -> 
         RadioButtonBar}, {{$CellContext`k12$$, 4., 
          "\!\(\*SubscriptBox[\(k\), \(12\)]\)"}, 0, 4, 0.1, Appearance -> 
         "Labeled", Enabled -> Dynamic[
           TrueQ[$CellContext`comp$$ == 2]], ImageSize -> 
         Tiny}, {{$CellContext`k21$$, 0.2, 
          "\!\(\*SubscriptBox[\(k\), \(21\)]\)"}, 0, 4, 0.1, Appearance -> 
         "Labeled", Enabled -> Dynamic[
           TrueQ[$CellContext`comp$$ == 2]], ImageSize -> Tiny}, Delimiter, 
        Style[
        "drug kinetics\n", 
         Bold], {{$CellContext`elim$$, {2}, "elimination\ncompartment(s):"}, {
         1 -> "one", 2 -> "two"}, ControlType -> CheckboxBar, Enabled -> 
         Dynamic[
           TrueQ[$CellContext`comp$$ == 2]]}, {{$CellContext`ro$$, 2, 
          "elimination\n order:"}, {
         0 -> "\!\(\*SuperscriptBox[\(0\), \(th\)]\) ", 1 -> 
          "\!\(\*SuperscriptBox[\(1\), \(st\)]\) ", 2 -> 
          "\!\(\*SuperscriptBox[\(2\), \(nd\)]\) "}, ControlType -> 
         RadioButton}, {{$CellContext`kel1$$, 0, 
          "\!\(\*SubscriptBox[\(k\), \(el, 1\)]\)"}, 0, 4, 0.1, Appearance -> 
         "Labeled", Enabled -> Dynamic[
           MemberQ[$CellContext`elim$$, 1]], ImageSize -> 
         Tiny}, {{$CellContext`kel2$$, 1.7000000000000002`, 
          "\!\(\*SubscriptBox[\(k\), \(el, 2\)]\)"}, 0, 4, 0.1, Appearance -> 
         "Labeled", Enabled -> Dynamic[
           MemberQ[$CellContext`elim$$, 2]], ImageSize -> 
         Tiny}, {{$CellContext`ad$$, False, 
          "\!\(\*SuperscriptBox[\(1\), \(st\)]\) compartment\ndrug \
absorption"}, {True, False}, ControlType -> 
         Checkbox}, {{$CellContext`ka$$, 0, 
          "\!\(\*SubscriptBox[\(k\), \(a\)]\)"}, 0, 4, 0.1, Appearance -> 
         "Labeled", Enabled -> Dynamic[$CellContext`ad$$], ImageSize -> Tiny},
         Delimiter, 
        Style[
        "dosing scheme\n", Bold], {{$CellContext`Din$$, 1.55, "dose mass"}, 0,
          2, 0.05, Appearance -> "Labeled", ImageSize -> 
         Tiny}, {{$CellContext`n$$, 8, "number of doses"}, 1, 9, 1, 
         Appearance -> "Labeled", ImageSize -> 
         Tiny}, {{$CellContext`roi$$, 0.7, "dose interval"}, 0.2, 4, 0.1, 
         Appearance -> "Labeled", ImageSize -> Tiny}}, 
      "Options" :> {
       SynchronousUpdating -> False, TrackedSymbols -> True, ControlPlacement -> 
        Left, AutorunSequencing -> {2, 3}}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{651., {237., 244.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->1637124699]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SnapshotsSection"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`ad$$ = False, $CellContext`comp$$ = 
    1, $CellContext`Din$$ = 2., $CellContext`elim$$ = {
    1}, $CellContext`k12$$ = 0, $CellContext`k21$$ = 0, $CellContext`ka$$ = 
    0, $CellContext`kel1$$ = 1., $CellContext`kel2$$ = 0, $CellContext`n$$ = 
    7, $CellContext`ro$$ = 0, $CellContext`roi$$ = 1.9000000000000001`, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{
      Hold[
       Style["compartmental model\n", Bold]], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`comp$$], 1, "number of\ncompartments"}, {
      1 -> "one", 2 -> "two"}}, {{
       Hold[$CellContext`k12$$], 0, "\!\(\*SubscriptBox[\(k\), \(12\)]\)"}, 0,
       4, 0.1}, {{
       Hold[$CellContext`k21$$], 0, "\!\(\*SubscriptBox[\(k\), \(21\)]\)"}, 0,
       4, 0.1}, {
      Hold[
       Style["drug kinetics\n", Bold]], Manipulate`Dump`ThisIsNotAControl}, {{
      
       Hold[$CellContext`elim$$], {1}, "elimination\ncompartment(s):"}, {
      1 -> "one", 2 -> "two"}}, {{
       Hold[$CellContext`ro$$], 0, "elimination\n order:"}, {
      0 -> "\!\(\*SuperscriptBox[\(0\), \(th\)]\) ", 1 -> 
       "\!\(\*SuperscriptBox[\(1\), \(st\)]\) ", 2 -> 
       "\!\(\*SuperscriptBox[\(2\), \(nd\)]\) "}}, {{
       Hold[$CellContext`kel1$$], 1., 
       "\!\(\*SubscriptBox[\(k\), \(el, 1\)]\)"}, 0, 4, 0.1}, {{
       Hold[$CellContext`kel2$$], 0, 
       "\!\(\*SubscriptBox[\(k\), \(el, 2\)]\)"}, 0, 4, 0.1}, {{
       Hold[$CellContext`ad$$], False, 
       "\!\(\*SuperscriptBox[\(1\), \(st\)]\) compartment\ndrug absorption"}, \
{True, False}}, {{
       Hold[$CellContext`ka$$], 0, "\!\(\*SubscriptBox[\(k\), \(a\)]\)"}, 0, 
      4, 0.1}, {
      Hold[
       Style["dosing scheme\n", Bold]], Manipulate`Dump`ThisIsNotAControl}, {{
      
       Hold[$CellContext`Din$$], 2., "dose mass"}, 0, 2, 0.05}, {{
       Hold[$CellContext`n$$], 7, "number of doses"}, 1, 9, 1}, {{
       Hold[$CellContext`roi$$], 1.9000000000000001`, "dose interval"}, 0.2, 
      4, 0.1}}, Typeset`size$$ = {375., {194.34375, 199.65625}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`comp$3955$$ = False, $CellContext`k12$3956$$ = 
    0, $CellContext`k21$3957$$ = 0, $CellContext`elim$3958$$ = 
    False, $CellContext`ro$3959$$ = False, $CellContext`kel1$3960$$ = 
    0, $CellContext`kel2$3961$$ = 0, $CellContext`ad$3962$$ = 
    False, $CellContext`ka$3963$$ = 0, $CellContext`Din$3964$$ = 
    0, $CellContext`n$3965$$ = 0, $CellContext`roi$3966$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`ad$$ = False, $CellContext`comp$$ = 
        1, $CellContext`Din$$ = 
        2., $CellContext`elim$$ = {1}, $CellContext`k12$$ = 
        0, $CellContext`k21$$ = 0, $CellContext`ka$$ = 0, $CellContext`kel1$$ = 
        1., $CellContext`kel2$$ = 0, $CellContext`n$$ = 7, $CellContext`ro$$ = 
        0, $CellContext`roi$$ = 1.9000000000000001`}, "ControllerVariables" :> {
        Hold[$CellContext`comp$$, $CellContext`comp$3955$$, False], 
        Hold[$CellContext`k12$$, $CellContext`k12$3956$$, 0], 
        Hold[$CellContext`k21$$, $CellContext`k21$3957$$, 0], 
        Hold[$CellContext`elim$$, $CellContext`elim$3958$$, False], 
        Hold[$CellContext`ro$$, $CellContext`ro$3959$$, False], 
        Hold[$CellContext`kel1$$, $CellContext`kel1$3960$$, 0], 
        Hold[$CellContext`kel2$$, $CellContext`kel2$3961$$, 0], 
        Hold[$CellContext`ad$$, $CellContext`ad$3962$$, False], 
        Hold[$CellContext`ka$$, $CellContext`ka$3963$$, 0], 
        Hold[$CellContext`Din$$, $CellContext`Din$3964$$, 0], 
        Hold[$CellContext`n$$, $CellContext`n$3965$$, 0], 
        Hold[$CellContext`roi$$, $CellContext`roi$3966$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Block[{$CellContext`V1 = 
         1, $CellContext`bc, $CellContext`pw1, $CellContext`pw2, \
$CellContext`a2, $CellContext`b2, $CellContext`injectiontimes, \
$CellContext`r, $CellContext`c1, $CellContext`c2, $CellContext`d, \
$CellContext`eqns, $CellContext`m, $CellContext`LegendKey}, \
$CellContext`LegendKey = Graphics[{Black, 
            Text[
             Style["plot legend", 16, Bold], {1, 0.84}], Thick, Orange, 
            
            Line[{{0, 0.6 - 0 ((0.6 - 0.1)/4)}, {
              0.3, 0.6 - 0 ((0.6 - 0.1)/4)}}], Black, 
            Text[
             Style["compartment 1 concentration", 16], {
             0.4, 0.6 - 0 ((0.6 - 0.1)/4)}, Left], Blue, 
            
            Line[{{0, 0.6 - 1 ((0.6 - 0.1)/4)}, {
              0.3, 0.6 - 1 ((0.6 - 0.1)/4)}}], Black, 
            Text[
             Style["compartment 2 concentration", 16], {
             0.4, 0.6 - 1 ((0.6 - 0.1)/4)}, Left], Purple, Dashed, 
            
            Line[{{0, 0.6 - 2 ((0.6 - 0.1)/4)}, {
              0.3, 0.6 - 2 ((0.6 - 0.1)/4)}}], Black, 
            Text[
             Style["toxic dose", 16], {0.4, 0.6 - 2 ((0.6 - 0.1)/4)}, Left], 
            Green, Dashed, 
            
            Line[{{0, 0.6 - 3 ((0.6 - 0.1)/4)}, {
              0.3, 0.6 - 3 ((0.6 - 0.1)/4)}}], Black, 
            Text[
             Style["effective dose", 16], {0.4, 0.6 - 3 ((0.6 - 0.1)/4)}, 
             Left]}, PlotRange -> {{0, 2}, {0, 1}}, 
           ImageSize -> {{250}, {300}}]; If[
          TrueQ[$CellContext`ad$$], Null, $CellContext`ka$$ = 0]; If[
          TrueQ[$CellContext`ad$$], Subscript[$CellContext`c1, 0] = 0, 
          Subscript[$CellContext`c1, 0] = $CellContext`Din$$/$CellContext`V1]; 
        If[
          
          TrueQ[$CellContext`ad$$], $CellContext`r = $CellContext`Din$$, \
$CellContext`r = 0]; If[$CellContext`comp$$ == 1, $CellContext`elim$$ = {1}]; 
        If[$CellContext`comp$$ == 1, $CellContext`k12$$ = 0]; 
        If[$CellContext`comp$$ == 1, $CellContext`k21$$ = 0]; If[
          MemberQ[$CellContext`elim$$, 1], Null, $CellContext`kel1$$ = 0]; 
        If[
          MemberQ[$CellContext`elim$$, 2], Null, $CellContext`kel2$$ = 0]; 
        If[$CellContext`roi$$ $CellContext`n$$ < 
          10, $CellContext`m = $CellContext`n$$, $CellContext`m = 
          Ceiling[10/$CellContext`roi$$]]; $CellContext`injectiontimes = 
         Table[($CellContext`i - 1) $CellContext`roi$$, {$CellContext`i, 
            1, $CellContext`m}]; $CellContext`eqns = Partition[
           Drop[
            Flatten[
             Rest[
              FoldList[ReplaceAll[{
                 $CellContext`d[$CellContext`t], 
                 $CellContext`c1[$CellContext`t], 
                 $CellContext`c2[$CellContext`t]}, 
                First[
                 
                 NDSolve[{
                  Derivative[
                    1][$CellContext`d][$CellContext`t] == \
(-$CellContext`ka$$) $CellContext`d[$CellContext`t], 
                   Derivative[
                    1][$CellContext`c1][$CellContext`t] == $CellContext`ka$$ \
($CellContext`d[$CellContext`t]/$CellContext`V1) - $CellContext`k12$$ \
$CellContext`c1[$CellContext`t] - $CellContext`kel1$$ \
$CellContext`c1[$CellContext`t]^$CellContext`ro$$ + $CellContext`k21$$ \
$CellContext`c2[$CellContext`t], 
                   Derivative[
                    1][$CellContext`c2][$CellContext`t] == $CellContext`k12$$ \
$CellContext`c1[$CellContext`t] - $CellContext`k21$$ \
$CellContext`c2[$CellContext`t] - $CellContext`kel2$$ \
$CellContext`c2[$CellContext`t]^$CellContext`ro$$, $CellContext`d[#2] == 
                   Chop[$CellContext`r + ReplaceAll[
                    Part[#, 1], {$CellContext`t -> #2}] Boole[ReplaceAll[
                    Part[#, 1], {$CellContext`t -> #2}] > 
                    0]], $CellContext`c1[#2] == 
                   Chop[Subscript[$CellContext`c1, 0] + ReplaceAll[
                    Part[#, 2], {$CellContext`t -> #2}] Boole[ReplaceAll[
                    Part[#, 2], {$CellContext`t -> #2}] > 
                    0]]/$CellContext`V1, $CellContext`c2[#2] == 
                   Chop[ReplaceAll[
                    Part[#, 3], {$CellContext`t -> #2}] Boole[ReplaceAll[
                    Part[#, 3], {$CellContext`t -> #2}] > 
                    0]]}, {$CellContext`d, $CellContext`c1, $CellContext`c2}, \
{$CellContext`t, #2, 10}]]]& , {0, 0, 0}, $CellContext`injectiontimes]]], {
            1, -1, 3}], 2]; $CellContext`bc = Flatten[{
            Flatten[
             
             Table[$CellContext`t <= $CellContext`i $CellContext`roi$$, \
{$CellContext`i, 1, $CellContext`m - 1}], 
             2], $CellContext`t >= ($CellContext`m - 
              1) $CellContext`roi$$}]; $CellContext`pw1 = Partition[
           Riffle[
            Take[
             Flatten[$CellContext`eqns], {1, -1, 2}], $CellContext`bc], 
           2]; $CellContext`pw2 = Partition[
           Riffle[
            Drop[
             Flatten[$CellContext`eqns], {1, -1, 2}], $CellContext`bc], 2]; 
        Grid[{{
            Plot[{
              Piecewise[$CellContext`pw1], 
              If[$CellContext`comp$$ == 2, 
               Piecewise[$CellContext`pw2]], 1, 2}, {$CellContext`t, 0, 10}, 
             Exclusions -> None, PlotRange -> {{0, 10}, {0, 3}}, 
             PlotStyle -> {{Thick, Orange}, {Thick, Blue}, {
               Thick, Dashed, Green}, {Thick, Dashed, Purple}}, 
             Frame -> {{True, False}, {True, False}}, FrameLabel -> {
               Style["time", 16], 
               Style["concentration", 16]}, Epilog -> Rotate[
               Inset[
                Style["therapeutic\n window", 14], {9.6, 1.5}], 3 (Pi/2)], 
             PlotLabel -> 
             Style["drug compartment concentration versus time", 16, Bold], 
             ImageSize -> {{375}, {400}}, FrameTicksStyle -> 
             Directive[FontSize -> 16], PlotRangeClipping -> 
             False]}, {$CellContext`LegendKey}}]], "Specifications" :> {
        Style[
        "compartmental model\n", 
         Bold], {{$CellContext`comp$$, 1, "number of\ncompartments"}, {
         1 -> "one", 2 -> "two"}, ControlType -> 
         RadioButtonBar}, {{$CellContext`k12$$, 0, 
          "\!\(\*SubscriptBox[\(k\), \(12\)]\)"}, 0, 4, 0.1, Appearance -> 
         "Labeled", Enabled -> Dynamic[
           TrueQ[$CellContext`comp$$ == 2]], ImageSize -> 
         Tiny}, {{$CellContext`k21$$, 0, 
          "\!\(\*SubscriptBox[\(k\), \(21\)]\)"}, 0, 4, 0.1, Appearance -> 
         "Labeled", Enabled -> Dynamic[
           TrueQ[$CellContext`comp$$ == 2]], ImageSize -> Tiny}, Delimiter, 
        Style[
        "drug kinetics\n", 
         Bold], {{$CellContext`elim$$, {1}, "elimination\ncompartment(s):"}, {
         1 -> "one", 2 -> "two"}, ControlType -> CheckboxBar, Enabled -> 
         Dynamic[
           TrueQ[$CellContext`comp$$ == 2]]}, {{$CellContext`ro$$, 0, 
          "elimination\n order:"}, {
         0 -> "\!\(\*SuperscriptBox[\(0\), \(th\)]\) ", 1 -> 
          "\!\(\*SuperscriptBox[\(1\), \(st\)]\) ", 2 -> 
          "\!\(\*SuperscriptBox[\(2\), \(nd\)]\) "}, ControlType -> 
         RadioButton}, {{$CellContext`kel1$$, 1., 
          "\!\(\*SubscriptBox[\(k\), \(el, 1\)]\)"}, 0, 4, 0.1, Appearance -> 
         "Labeled", Enabled -> Dynamic[
           MemberQ[$CellContext`elim$$, 1]], ImageSize -> 
         Tiny}, {{$CellContext`kel2$$, 0, 
          "\!\(\*SubscriptBox[\(k\), \(el, 2\)]\)"}, 0, 4, 0.1, Appearance -> 
         "Labeled", Enabled -> Dynamic[
           MemberQ[$CellContext`elim$$, 2]], ImageSize -> 
         Tiny}, {{$CellContext`ad$$, False, 
          "\!\(\*SuperscriptBox[\(1\), \(st\)]\) compartment\ndrug \
absorption"}, {True, False}, ControlType -> 
         Checkbox}, {{$CellContext`ka$$, 0, 
          "\!\(\*SubscriptBox[\(k\), \(a\)]\)"}, 0, 4, 0.1, Appearance -> 
         "Labeled", Enabled -> Dynamic[$CellContext`ad$$], ImageSize -> Tiny},
         Delimiter, 
        Style[
        "dosing scheme\n", Bold], {{$CellContext`Din$$, 2., "dose mass"}, 0, 
         2, 0.05, Appearance -> "Labeled", ImageSize -> 
         Tiny}, {{$CellContext`n$$, 7, "number of doses"}, 1, 9, 1, 
         Appearance -> "Labeled", ImageSize -> 
         Tiny}, {{$CellContext`roi$$, 1.9000000000000001`, "dose interval"}, 
         0.2, 4, 0.1, Appearance -> "Labeled", ImageSize -> Tiny}}, 
      "Options" :> {
       SynchronousUpdating -> False, TrackedSymbols -> True, ControlPlacement -> 
        Left, AutorunSequencing -> {2, 3}}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{651., {237., 244.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->1594330729],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`ad$$ = False, $CellContext`comp$$ = 
    2, $CellContext`Din$$ = 0.5, $CellContext`elim$$ = {
    1}, $CellContext`k12$$ = 3.9000000000000004`, $CellContext`k21$$ = 
    1.4000000000000001`, $CellContext`ka$$ = 0, $CellContext`kel1$$ = 
    4., $CellContext`kel2$$ = 0, $CellContext`n$$ = 5, $CellContext`ro$$ = 
    2, $CellContext`roi$$ = 0.9000000000000001, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[
       Style["compartmental model\n", Bold]], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`comp$$], 2, "number of\ncompartments"}, {
      1 -> "one", 2 -> "two"}}, {{
       Hold[$CellContext`k12$$], 3.9000000000000004`, 
       "\!\(\*SubscriptBox[\(k\), \(12\)]\)"}, 0, 4, 0.1}, {{
       Hold[$CellContext`k21$$], 1.4000000000000001`, 
       "\!\(\*SubscriptBox[\(k\), \(21\)]\)"}, 0, 4, 0.1}, {
      Hold[
       Style["drug kinetics\n", Bold]], Manipulate`Dump`ThisIsNotAControl}, {{
      
       Hold[$CellContext`elim$$], {1}, "elimination\ncompartment(s):"}, {
      1 -> "one", 2 -> "two"}}, {{
       Hold[$CellContext`ro$$], 2, "elimination\n order:"}, {
      0 -> "\!\(\*SuperscriptBox[\(0\), \(th\)]\) ", 1 -> 
       "\!\(\*SuperscriptBox[\(1\), \(st\)]\) ", 2 -> 
       "\!\(\*SuperscriptBox[\(2\), \(nd\)]\) "}}, {{
       Hold[$CellContext`kel1$$], 4., 
       "\!\(\*SubscriptBox[\(k\), \(el, 1\)]\)"}, 0, 4, 0.1}, {{
       Hold[$CellContext`kel2$$], 0, 
       "\!\(\*SubscriptBox[\(k\), \(el, 2\)]\)"}, 0, 4, 0.1}, {{
       Hold[$CellContext`ad$$], False, 
       "\!\(\*SuperscriptBox[\(1\), \(st\)]\) compartment\ndrug absorption"}, \
{True, False}}, {{
       Hold[$CellContext`ka$$], 0, "\!\(\*SubscriptBox[\(k\), \(a\)]\)"}, 0, 
      4, 0.1}, {
      Hold[
       Style["dosing scheme\n", Bold]], Manipulate`Dump`ThisIsNotAControl}, {{
      
       Hold[$CellContext`Din$$], 0.5, "dose mass"}, 0, 2, 0.05}, {{
       Hold[$CellContext`n$$], 5, "number of doses"}, 1, 9, 1}, {{
       Hold[$CellContext`roi$$], 0.9000000000000001, "dose interval"}, 0.2, 4,
       0.1}}, Typeset`size$$ = {375., {194.34375, 199.65625}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`comp$4080$$ = False, $CellContext`k12$4081$$ = 
    0, $CellContext`k21$4082$$ = 0, $CellContext`elim$4083$$ = 
    False, $CellContext`ro$4084$$ = False, $CellContext`kel1$4085$$ = 
    0, $CellContext`kel2$4086$$ = 0, $CellContext`ad$4087$$ = 
    False, $CellContext`ka$4088$$ = 0, $CellContext`Din$4089$$ = 
    0, $CellContext`n$4090$$ = 0, $CellContext`roi$4091$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`ad$$ = False, $CellContext`comp$$ = 
        2, $CellContext`Din$$ = 
        0.5, $CellContext`elim$$ = {1}, $CellContext`k12$$ = 
        3.9000000000000004`, $CellContext`k21$$ = 
        1.4000000000000001`, $CellContext`ka$$ = 0, $CellContext`kel1$$ = 
        4., $CellContext`kel2$$ = 0, $CellContext`n$$ = 5, $CellContext`ro$$ = 
        2, $CellContext`roi$$ = 0.9000000000000001}, "ControllerVariables" :> {
        Hold[$CellContext`comp$$, $CellContext`comp$4080$$, False], 
        Hold[$CellContext`k12$$, $CellContext`k12$4081$$, 0], 
        Hold[$CellContext`k21$$, $CellContext`k21$4082$$, 0], 
        Hold[$CellContext`elim$$, $CellContext`elim$4083$$, False], 
        Hold[$CellContext`ro$$, $CellContext`ro$4084$$, False], 
        Hold[$CellContext`kel1$$, $CellContext`kel1$4085$$, 0], 
        Hold[$CellContext`kel2$$, $CellContext`kel2$4086$$, 0], 
        Hold[$CellContext`ad$$, $CellContext`ad$4087$$, False], 
        Hold[$CellContext`ka$$, $CellContext`ka$4088$$, 0], 
        Hold[$CellContext`Din$$, $CellContext`Din$4089$$, 0], 
        Hold[$CellContext`n$$, $CellContext`n$4090$$, 0], 
        Hold[$CellContext`roi$$, $CellContext`roi$4091$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Block[{$CellContext`V1 = 
         1, $CellContext`bc, $CellContext`pw1, $CellContext`pw2, \
$CellContext`a2, $CellContext`b2, $CellContext`injectiontimes, \
$CellContext`r, $CellContext`c1, $CellContext`c2, $CellContext`d, \
$CellContext`eqns, $CellContext`m, $CellContext`LegendKey}, \
$CellContext`LegendKey = Graphics[{Black, 
            Text[
             Style["plot legend", 16, Bold], {1, 0.84}], Thick, Orange, 
            
            Line[{{0, 0.6 - 0 ((0.6 - 0.1)/4)}, {
              0.3, 0.6 - 0 ((0.6 - 0.1)/4)}}], Black, 
            Text[
             Style["compartment 1 concentration", 16], {
             0.4, 0.6 - 0 ((0.6 - 0.1)/4)}, Left], Blue, 
            
            Line[{{0, 0.6 - 1 ((0.6 - 0.1)/4)}, {
              0.3, 0.6 - 1 ((0.6 - 0.1)/4)}}], Black, 
            Text[
             Style["compartment 2 concentration", 16], {
             0.4, 0.6 - 1 ((0.6 - 0.1)/4)}, Left], Purple, Dashed, 
            
            Line[{{0, 0.6 - 2 ((0.6 - 0.1)/4)}, {
              0.3, 0.6 - 2 ((0.6 - 0.1)/4)}}], Black, 
            Text[
             Style["toxic dose", 16], {0.4, 0.6 - 2 ((0.6 - 0.1)/4)}, Left], 
            Green, Dashed, 
            
            Line[{{0, 0.6 - 3 ((0.6 - 0.1)/4)}, {
              0.3, 0.6 - 3 ((0.6 - 0.1)/4)}}], Black, 
            Text[
             Style["effective dose", 16], {0.4, 0.6 - 3 ((0.6 - 0.1)/4)}, 
             Left]}, PlotRange -> {{0, 2}, {0, 1}}, 
           ImageSize -> {{250}, {300}}]; If[
          TrueQ[$CellContext`ad$$], Null, $CellContext`ka$$ = 0]; If[
          TrueQ[$CellContext`ad$$], Subscript[$CellContext`c1, 0] = 0, 
          Subscript[$CellContext`c1, 0] = $CellContext`Din$$/$CellContext`V1]; 
        If[
          
          TrueQ[$CellContext`ad$$], $CellContext`r = $CellContext`Din$$, \
$CellContext`r = 0]; If[$CellContext`comp$$ == 1, $CellContext`elim$$ = {1}]; 
        If[$CellContext`comp$$ == 1, $CellContext`k12$$ = 0]; 
        If[$CellContext`comp$$ == 1, $CellContext`k21$$ = 0]; If[
          MemberQ[$CellContext`elim$$, 1], Null, $CellContext`kel1$$ = 0]; 
        If[
          MemberQ[$CellContext`elim$$, 2], Null, $CellContext`kel2$$ = 0]; 
        If[$CellContext`roi$$ $CellContext`n$$ < 
          10, $CellContext`m = $CellContext`n$$, $CellContext`m = 
          Ceiling[10/$CellContext`roi$$]]; $CellContext`injectiontimes = 
         Table[($CellContext`i - 1) $CellContext`roi$$, {$CellContext`i, 
            1, $CellContext`m}]; $CellContext`eqns = Partition[
           Drop[
            Flatten[
             Rest[
              FoldList[ReplaceAll[{
                 $CellContext`d[$CellContext`t], 
                 $CellContext`c1[$CellContext`t], 
                 $CellContext`c2[$CellContext`t]}, 
                First[
                 
                 NDSolve[{
                  Derivative[
                    1][$CellContext`d][$CellContext`t] == \
(-$CellContext`ka$$) $CellContext`d[$CellContext`t], 
                   Derivative[
                    1][$CellContext`c1][$CellContext`t] == $CellContext`ka$$ \
($CellContext`d[$CellContext`t]/$CellContext`V1) - $CellContext`k12$$ \
$CellContext`c1[$CellContext`t] - $CellContext`kel1$$ \
$CellContext`c1[$CellContext`t]^$CellContext`ro$$ + $CellContext`k21$$ \
$CellContext`c2[$CellContext`t], 
                   Derivative[
                    1][$CellContext`c2][$CellContext`t] == $CellContext`k12$$ \
$CellContext`c1[$CellContext`t] - $CellContext`k21$$ \
$CellContext`c2[$CellContext`t] - $CellContext`kel2$$ \
$CellContext`c2[$CellContext`t]^$CellContext`ro$$, $CellContext`d[#2] == 
                   Chop[$CellContext`r + ReplaceAll[
                    Part[#, 1], {$CellContext`t -> #2}] Boole[ReplaceAll[
                    Part[#, 1], {$CellContext`t -> #2}] > 
                    0]], $CellContext`c1[#2] == 
                   Chop[Subscript[$CellContext`c1, 0] + ReplaceAll[
                    Part[#, 2], {$CellContext`t -> #2}] Boole[ReplaceAll[
                    Part[#, 2], {$CellContext`t -> #2}] > 
                    0]]/$CellContext`V1, $CellContext`c2[#2] == 
                   Chop[ReplaceAll[
                    Part[#, 3], {$CellContext`t -> #2}] Boole[ReplaceAll[
                    Part[#, 3], {$CellContext`t -> #2}] > 
                    0]]}, {$CellContext`d, $CellContext`c1, $CellContext`c2}, \
{$CellContext`t, #2, 10}]]]& , {0, 0, 0}, $CellContext`injectiontimes]]], {
            1, -1, 3}], 2]; $CellContext`bc = Flatten[{
            Flatten[
             
             Table[$CellContext`t <= $CellContext`i $CellContext`roi$$, \
{$CellContext`i, 1, $CellContext`m - 1}], 
             2], $CellContext`t >= ($CellContext`m - 
              1) $CellContext`roi$$}]; $CellContext`pw1 = Partition[
           Riffle[
            Take[
             Flatten[$CellContext`eqns], {1, -1, 2}], $CellContext`bc], 
           2]; $CellContext`pw2 = Partition[
           Riffle[
            Drop[
             Flatten[$CellContext`eqns], {1, -1, 2}], $CellContext`bc], 2]; 
        Grid[{{
            Plot[{
              Piecewise[$CellContext`pw1], 
              If[$CellContext`comp$$ == 2, 
               Piecewise[$CellContext`pw2]], 1, 2}, {$CellContext`t, 0, 10}, 
             Exclusions -> None, PlotRange -> {{0, 10}, {0, 3}}, 
             PlotStyle -> {{Thick, Orange}, {Thick, Blue}, {
               Thick, Dashed, Green}, {Thick, Dashed, Purple}}, 
             Frame -> {{True, False}, {True, False}}, FrameLabel -> {
               Style["time", 16], 
               Style["concentration", 16]}, Epilog -> Rotate[
               Inset[
                Style["therapeutic\n window", 14], {9.6, 1.5}], 3 (Pi/2)], 
             PlotLabel -> 
             Style["drug compartment concentration versus time", 16, Bold], 
             ImageSize -> {{375}, {400}}, FrameTicksStyle -> 
             Directive[FontSize -> 16], PlotRangeClipping -> 
             False]}, {$CellContext`LegendKey}}]], "Specifications" :> {
        Style[
        "compartmental model\n", 
         Bold], {{$CellContext`comp$$, 2, "number of\ncompartments"}, {
         1 -> "one", 2 -> "two"}, ControlType -> 
         RadioButtonBar}, {{$CellContext`k12$$, 3.9000000000000004`, 
          "\!\(\*SubscriptBox[\(k\), \(12\)]\)"}, 0, 4, 0.1, Appearance -> 
         "Labeled", Enabled -> Dynamic[
           TrueQ[$CellContext`comp$$ == 2]], ImageSize -> 
         Tiny}, {{$CellContext`k21$$, 1.4000000000000001`, 
          "\!\(\*SubscriptBox[\(k\), \(21\)]\)"}, 0, 4, 0.1, Appearance -> 
         "Labeled", Enabled -> Dynamic[
           TrueQ[$CellContext`comp$$ == 2]], ImageSize -> Tiny}, Delimiter, 
        Style[
        "drug kinetics\n", 
         Bold], {{$CellContext`elim$$, {1}, "elimination\ncompartment(s):"}, {
         1 -> "one", 2 -> "two"}, ControlType -> CheckboxBar, Enabled -> 
         Dynamic[
           TrueQ[$CellContext`comp$$ == 2]]}, {{$CellContext`ro$$, 2, 
          "elimination\n order:"}, {
         0 -> "\!\(\*SuperscriptBox[\(0\), \(th\)]\) ", 1 -> 
          "\!\(\*SuperscriptBox[\(1\), \(st\)]\) ", 2 -> 
          "\!\(\*SuperscriptBox[\(2\), \(nd\)]\) "}, ControlType -> 
         RadioButton}, {{$CellContext`kel1$$, 4., 
          "\!\(\*SubscriptBox[\(k\), \(el, 1\)]\)"}, 0, 4, 0.1, Appearance -> 
         "Labeled", Enabled -> Dynamic[
           MemberQ[$CellContext`elim$$, 1]], ImageSize -> 
         Tiny}, {{$CellContext`kel2$$, 0, 
          "\!\(\*SubscriptBox[\(k\), \(el, 2\)]\)"}, 0, 4, 0.1, Appearance -> 
         "Labeled", Enabled -> Dynamic[
           MemberQ[$CellContext`elim$$, 2]], ImageSize -> 
         Tiny}, {{$CellContext`ad$$, False, 
          "\!\(\*SuperscriptBox[\(1\), \(st\)]\) compartment\ndrug \
absorption"}, {True, False}, ControlType -> 
         Checkbox}, {{$CellContext`ka$$, 0, 
          "\!\(\*SubscriptBox[\(k\), \(a\)]\)"}, 0, 4, 0.1, Appearance -> 
         "Labeled", Enabled -> Dynamic[$CellContext`ad$$], ImageSize -> Tiny},
         Delimiter, 
        Style[
        "dosing scheme\n", Bold], {{$CellContext`Din$$, 0.5, "dose mass"}, 0, 
         2, 0.05, Appearance -> "Labeled", ImageSize -> 
         Tiny}, {{$CellContext`n$$, 5, "number of doses"}, 1, 9, 1, 
         Appearance -> "Labeled", ImageSize -> 
         Tiny}, {{$CellContext`roi$$, 0.9000000000000001, "dose interval"}, 
         0.2, 4, 0.1, Appearance -> "Labeled", ImageSize -> Tiny}}, 
      "Options" :> {
       SynchronousUpdating -> False, TrackedSymbols -> True, ControlPlacement -> 
        Left, AutorunSequencing -> {2, 3}}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{651., {237., 244.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->1763098684],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`ad$$ = True, $CellContext`comp$$ = 
    2, $CellContext`Din$$ = 0.25, $CellContext`elim$$ = {1, 
    2}, $CellContext`k12$$ = 2.6, $CellContext`k21$$ = 
    2.6, $CellContext`ka$$ = 4., $CellContext`kel1$$ = 
    0., $CellContext`kel2$$ = 1.7000000000000002`, $CellContext`n$$ = 
    9, $CellContext`ro$$ = 1, $CellContext`roi$$ = 0.2, Typeset`show$$ = True,
     Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[
       Style["compartmental model\n", Bold]], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`comp$$], 2, "number of\ncompartments"}, {
      1 -> "one", 2 -> "two"}}, {{
       Hold[$CellContext`k12$$], 2.6, "\!\(\*SubscriptBox[\(k\), \(12\)]\)"}, 
      0, 4, 0.1}, {{
       Hold[$CellContext`k21$$], 2.6, "\!\(\*SubscriptBox[\(k\), \(21\)]\)"}, 
      0, 4, 0.1}, {
      Hold[
       Style["drug kinetics\n", Bold]], Manipulate`Dump`ThisIsNotAControl}, {{
      
       Hold[$CellContext`elim$$], {1, 2}, "elimination\ncompartment(s):"}, {
      1 -> "one", 2 -> "two"}}, {{
       Hold[$CellContext`ro$$], 1, "elimination\n order:"}, {
      0 -> "\!\(\*SuperscriptBox[\(0\), \(th\)]\) ", 1 -> 
       "\!\(\*SuperscriptBox[\(1\), \(st\)]\) ", 2 -> 
       "\!\(\*SuperscriptBox[\(2\), \(nd\)]\) "}}, {{
       Hold[$CellContext`kel1$$], 0., 
       "\!\(\*SubscriptBox[\(k\), \(el, 1\)]\)"}, 0, 4, 0.1}, {{
       Hold[$CellContext`kel2$$], 1.7000000000000002`, 
       "\!\(\*SubscriptBox[\(k\), \(el, 2\)]\)"}, 0, 4, 0.1}, {{
       Hold[$CellContext`ad$$], True, 
       "\!\(\*SuperscriptBox[\(1\), \(st\)]\) compartment\ndrug absorption"}, \
{True, False}}, {{
       Hold[$CellContext`ka$$], 4., "\!\(\*SubscriptBox[\(k\), \(a\)]\)"}, 0, 
      4, 0.1}, {
      Hold[
       Style["dosing scheme\n", Bold]], Manipulate`Dump`ThisIsNotAControl}, {{
      
       Hold[$CellContext`Din$$], 0.25, "dose mass"}, 0, 2, 0.05}, {{
       Hold[$CellContext`n$$], 9, "number of doses"}, 1, 9, 1}, {{
       Hold[$CellContext`roi$$], 0.2, "dose interval"}, 0.2, 4, 0.1}}, 
    Typeset`size$$ = {375., {194.34375, 199.65625}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`comp$4205$$ = False, $CellContext`k12$4206$$ = 
    0, $CellContext`k21$4207$$ = 0, $CellContext`elim$4208$$ = 
    False, $CellContext`ro$4209$$ = False, $CellContext`kel1$4210$$ = 
    0, $CellContext`kel2$4211$$ = 0, $CellContext`ad$4212$$ = 
    False, $CellContext`ka$4213$$ = 0, $CellContext`Din$4214$$ = 
    0, $CellContext`n$4215$$ = 0, $CellContext`roi$4216$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`ad$$ = True, $CellContext`comp$$ = 
        2, $CellContext`Din$$ = 
        0.25, $CellContext`elim$$ = {1, 2}, $CellContext`k12$$ = 
        2.6, $CellContext`k21$$ = 2.6, $CellContext`ka$$ = 
        4., $CellContext`kel1$$ = 0., $CellContext`kel2$$ = 
        1.7000000000000002`, $CellContext`n$$ = 9, $CellContext`ro$$ = 
        1, $CellContext`roi$$ = 0.2}, "ControllerVariables" :> {
        Hold[$CellContext`comp$$, $CellContext`comp$4205$$, False], 
        Hold[$CellContext`k12$$, $CellContext`k12$4206$$, 0], 
        Hold[$CellContext`k21$$, $CellContext`k21$4207$$, 0], 
        Hold[$CellContext`elim$$, $CellContext`elim$4208$$, False], 
        Hold[$CellContext`ro$$, $CellContext`ro$4209$$, False], 
        Hold[$CellContext`kel1$$, $CellContext`kel1$4210$$, 0], 
        Hold[$CellContext`kel2$$, $CellContext`kel2$4211$$, 0], 
        Hold[$CellContext`ad$$, $CellContext`ad$4212$$, False], 
        Hold[$CellContext`ka$$, $CellContext`ka$4213$$, 0], 
        Hold[$CellContext`Din$$, $CellContext`Din$4214$$, 0], 
        Hold[$CellContext`n$$, $CellContext`n$4215$$, 0], 
        Hold[$CellContext`roi$$, $CellContext`roi$4216$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Block[{$CellContext`V1 = 
         1, $CellContext`bc, $CellContext`pw1, $CellContext`pw2, \
$CellContext`a2, $CellContext`b2, $CellContext`injectiontimes, \
$CellContext`r, $CellContext`c1, $CellContext`c2, $CellContext`d, \
$CellContext`eqns, $CellContext`m, $CellContext`LegendKey}, \
$CellContext`LegendKey = Graphics[{Black, 
            Text[
             Style["plot legend", 16, Bold], {1, 0.84}], Thick, Orange, 
            
            Line[{{0, 0.6 - 0 ((0.6 - 0.1)/4)}, {
              0.3, 0.6 - 0 ((0.6 - 0.1)/4)}}], Black, 
            Text[
             Style["compartment 1 concentration", 16], {
             0.4, 0.6 - 0 ((0.6 - 0.1)/4)}, Left], Blue, 
            
            Line[{{0, 0.6 - 1 ((0.6 - 0.1)/4)}, {
              0.3, 0.6 - 1 ((0.6 - 0.1)/4)}}], Black, 
            Text[
             Style["compartment 2 concentration", 16], {
             0.4, 0.6 - 1 ((0.6 - 0.1)/4)}, Left], Purple, Dashed, 
            
            Line[{{0, 0.6 - 2 ((0.6 - 0.1)/4)}, {
              0.3, 0.6 - 2 ((0.6 - 0.1)/4)}}], Black, 
            Text[
             Style["toxic dose", 16], {0.4, 0.6 - 2 ((0.6 - 0.1)/4)}, Left], 
            Green, Dashed, 
            
            Line[{{0, 0.6 - 3 ((0.6 - 0.1)/4)}, {
              0.3, 0.6 - 3 ((0.6 - 0.1)/4)}}], Black, 
            Text[
             Style["effective dose", 16], {0.4, 0.6 - 3 ((0.6 - 0.1)/4)}, 
             Left]}, PlotRange -> {{0, 2}, {0, 1}}, 
           ImageSize -> {{250}, {300}}]; If[
          TrueQ[$CellContext`ad$$], Null, $CellContext`ka$$ = 0]; If[
          TrueQ[$CellContext`ad$$], Subscript[$CellContext`c1, 0] = 0, 
          Subscript[$CellContext`c1, 0] = $CellContext`Din$$/$CellContext`V1]; 
        If[
          
          TrueQ[$CellContext`ad$$], $CellContext`r = $CellContext`Din$$, \
$CellContext`r = 0]; If[$CellContext`comp$$ == 1, $CellContext`elim$$ = {1}]; 
        If[$CellContext`comp$$ == 1, $CellContext`k12$$ = 0]; 
        If[$CellContext`comp$$ == 1, $CellContext`k21$$ = 0]; If[
          MemberQ[$CellContext`elim$$, 1], Null, $CellContext`kel1$$ = 0]; 
        If[
          MemberQ[$CellContext`elim$$, 2], Null, $CellContext`kel2$$ = 0]; 
        If[$CellContext`roi$$ $CellContext`n$$ < 
          10, $CellContext`m = $CellContext`n$$, $CellContext`m = 
          Ceiling[10/$CellContext`roi$$]]; $CellContext`injectiontimes = 
         Table[($CellContext`i - 1) $CellContext`roi$$, {$CellContext`i, 
            1, $CellContext`m}]; $CellContext`eqns = Partition[
           Drop[
            Flatten[
             Rest[
              FoldList[ReplaceAll[{
                 $CellContext`d[$CellContext`t], 
                 $CellContext`c1[$CellContext`t], 
                 $CellContext`c2[$CellContext`t]}, 
                First[
                 
                 NDSolve[{
                  Derivative[
                    1][$CellContext`d][$CellContext`t] == \
(-$CellContext`ka$$) $CellContext`d[$CellContext`t], 
                   Derivative[
                    1][$CellContext`c1][$CellContext`t] == $CellContext`ka$$ \
($CellContext`d[$CellContext`t]/$CellContext`V1) - $CellContext`k12$$ \
$CellContext`c1[$CellContext`t] - $CellContext`kel1$$ \
$CellContext`c1[$CellContext`t]^$CellContext`ro$$ + $CellContext`k21$$ \
$CellContext`c2[$CellContext`t], 
                   Derivative[
                    1][$CellContext`c2][$CellContext`t] == $CellContext`k12$$ \
$CellContext`c1[$CellContext`t] - $CellContext`k21$$ \
$CellContext`c2[$CellContext`t] - $CellContext`kel2$$ \
$CellContext`c2[$CellContext`t]^$CellContext`ro$$, $CellContext`d[#2] == 
                   Chop[$CellContext`r + ReplaceAll[
                    Part[#, 1], {$CellContext`t -> #2}] Boole[ReplaceAll[
                    Part[#, 1], {$CellContext`t -> #2}] > 
                    0]], $CellContext`c1[#2] == 
                   Chop[Subscript[$CellContext`c1, 0] + ReplaceAll[
                    Part[#, 2], {$CellContext`t -> #2}] Boole[ReplaceAll[
                    Part[#, 2], {$CellContext`t -> #2}] > 
                    0]]/$CellContext`V1, $CellContext`c2[#2] == 
                   Chop[ReplaceAll[
                    Part[#, 3], {$CellContext`t -> #2}] Boole[ReplaceAll[
                    Part[#, 3], {$CellContext`t -> #2}] > 
                    0]]}, {$CellContext`d, $CellContext`c1, $CellContext`c2}, \
{$CellContext`t, #2, 10}]]]& , {0, 0, 0}, $CellContext`injectiontimes]]], {
            1, -1, 3}], 2]; $CellContext`bc = Flatten[{
            Flatten[
             
             Table[$CellContext`t <= $CellContext`i $CellContext`roi$$, \
{$CellContext`i, 1, $CellContext`m - 1}], 
             2], $CellContext`t >= ($CellContext`m - 
              1) $CellContext`roi$$}]; $CellContext`pw1 = Partition[
           Riffle[
            Take[
             Flatten[$CellContext`eqns], {1, -1, 2}], $CellContext`bc], 
           2]; $CellContext`pw2 = Partition[
           Riffle[
            Drop[
             Flatten[$CellContext`eqns], {1, -1, 2}], $CellContext`bc], 2]; 
        Grid[{{
            Plot[{
              Piecewise[$CellContext`pw1], 
              If[$CellContext`comp$$ == 2, 
               Piecewise[$CellContext`pw2]], 1, 2}, {$CellContext`t, 0, 10}, 
             Exclusions -> None, PlotRange -> {{0, 10}, {0, 3}}, 
             PlotStyle -> {{Thick, Orange}, {Thick, Blue}, {
               Thick, Dashed, Green}, {Thick, Dashed, Purple}}, 
             Frame -> {{True, False}, {True, False}}, FrameLabel -> {
               Style["time", 16], 
               Style["concentration", 16]}, Epilog -> Rotate[
               Inset[
                Style["therapeutic\n window", 14], {9.6, 1.5}], 3 (Pi/2)], 
             PlotLabel -> 
             Style["drug compartment concentration versus time", 16, Bold], 
             ImageSize -> {{375}, {400}}, FrameTicksStyle -> 
             Directive[FontSize -> 16], PlotRangeClipping -> 
             False]}, {$CellContext`LegendKey}}]], "Specifications" :> {
        Style[
        "compartmental model\n", 
         Bold], {{$CellContext`comp$$, 2, "number of\ncompartments"}, {
         1 -> "one", 2 -> "two"}, ControlType -> 
         RadioButtonBar}, {{$CellContext`k12$$, 2.6, 
          "\!\(\*SubscriptBox[\(k\), \(12\)]\)"}, 0, 4, 0.1, Appearance -> 
         "Labeled", Enabled -> Dynamic[
           TrueQ[$CellContext`comp$$ == 2]], ImageSize -> 
         Tiny}, {{$CellContext`k21$$, 2.6, 
          "\!\(\*SubscriptBox[\(k\), \(21\)]\)"}, 0, 4, 0.1, Appearance -> 
         "Labeled", Enabled -> Dynamic[
           TrueQ[$CellContext`comp$$ == 2]], ImageSize -> Tiny}, Delimiter, 
        Style[
        "drug kinetics\n", 
         Bold], {{$CellContext`elim$$, {1, 2}, 
          "elimination\ncompartment(s):"}, {1 -> "one", 2 -> "two"}, 
         ControlType -> CheckboxBar, Enabled -> Dynamic[
           TrueQ[$CellContext`comp$$ == 2]]}, {{$CellContext`ro$$, 1, 
          "elimination\n order:"}, {
         0 -> "\!\(\*SuperscriptBox[\(0\), \(th\)]\) ", 1 -> 
          "\!\(\*SuperscriptBox[\(1\), \(st\)]\) ", 2 -> 
          "\!\(\*SuperscriptBox[\(2\), \(nd\)]\) "}, ControlType -> 
         RadioButton}, {{$CellContext`kel1$$, 0., 
          "\!\(\*SubscriptBox[\(k\), \(el, 1\)]\)"}, 0, 4, 0.1, Appearance -> 
         "Labeled", Enabled -> Dynamic[
           MemberQ[$CellContext`elim$$, 1]], ImageSize -> 
         Tiny}, {{$CellContext`kel2$$, 1.7000000000000002`, 
          "\!\(\*SubscriptBox[\(k\), \(el, 2\)]\)"}, 0, 4, 0.1, Appearance -> 
         "Labeled", Enabled -> Dynamic[
           MemberQ[$CellContext`elim$$, 2]], ImageSize -> 
         Tiny}, {{$CellContext`ad$$, True, 
          "\!\(\*SuperscriptBox[\(1\), \(st\)]\) compartment\ndrug \
absorption"}, {True, False}, ControlType -> 
         Checkbox}, {{$CellContext`ka$$, 4., 
          "\!\(\*SubscriptBox[\(k\), \(a\)]\)"}, 0, 4, 0.1, Appearance -> 
         "Labeled", Enabled -> Dynamic[$CellContext`ad$$], ImageSize -> Tiny},
         Delimiter, 
        Style[
        "dosing scheme\n", Bold], {{$CellContext`Din$$, 0.25, "dose mass"}, 0,
          2, 0.05, Appearance -> "Labeled", ImageSize -> 
         Tiny}, {{$CellContext`n$$, 9, "number of doses"}, 1, 9, 1, 
         Appearance -> "Labeled", ImageSize -> 
         Tiny}, {{$CellContext`roi$$, 0.2, "dose interval"}, 0.2, 4, 0.1, 
         Appearance -> "Labeled", ImageSize -> Tiny}}, 
      "Options" :> {
       SynchronousUpdating -> False, TrackedSymbols -> True, ControlPlacement -> 
        Left, AutorunSequencing -> {2, 3}}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{651., {237., 244.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->1420220682]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "DetailsSection"],

Cell[TextData[{
 "The main assumption here is that both compartments are well mixed. When the \
drug does not absorb, it is assumed to be administered in a rapid dose (i.e. \
bolus injection). The constants ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "12"], TraditionalForm]], "InlineMath"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "21"], TraditionalForm]], "InlineMath"],
 " represent the rate transfer coefficients from compartment 1 to compartment \
2 and vice versa, assuming a first-order transfer between them. Each \
compartment has its own elimination rate ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", 
    RowBox[{"el", ",", "1"}]], TraditionalForm]], "InlineMath"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", 
    RowBox[{"el", ",", "2"}]], TraditionalForm]], "InlineMath"],
 ". The absorption coefficient ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "a"], TraditionalForm]], "InlineMath"],
 " determines the rate at which the drug absorbs into the first compartment, \
assuming absorption to be first order. The concentrations and time are \
intentionally left unitless but the whole system is dimensionally consistent. \
The drug elimination reaction order is ",
 Cell[BoxData[
  FormBox["ro", TraditionalForm]], "InlineMath"],
 "."
}], "DetailNotes",
 CellChangeTimes->{{3.6084296801675224`*^9, 3.6084297464483137`*^9}, {
   3.608429777931114*^9, 3.6084298694923515`*^9}, 3.6084302294589405`*^9, {
   3.6084303058623104`*^9, 3.608430343067438*^9}, {3.608430565941186*^9, 
   3.608430595413872*^9}, {3.608430626659659*^9, 3.6084306775745707`*^9}, {
   3.6086568435309877`*^9, 3.6086569638437986`*^9}, {3.6089246973279333`*^9, 
   3.608924704639782*^9}, {3.609696931559031*^9, 3.6096969526872396`*^9}, {
   3.609697180360262*^9, 3.609697262088936*^9}, {3.6096973293227816`*^9, 
   3.6096973681220007`*^9}, {3.6096975351385536`*^9, 3.609697692230539*^9}, {
   3.609698648731248*^9, 3.6096986487402477`*^9}, {3.609698679788024*^9, 
   3.609698813098649*^9}, {3.609698857068164*^9, 3.6096989379207883`*^9}, {
   3.609699272832511*^9, 3.609699272845512*^9}, {3.6097005864538727`*^9, 
   3.609700616167572*^9}, 3.609700689090743*^9, {3.6097030835039086`*^9, 
   3.6097031135490403`*^9}, {3.609703149422068*^9, 3.6097031500704966`*^9}, {
   3.609703359780992*^9, 3.609703410067685*^9}, {3.6097584769748325`*^9, 
   3.6097584874628325`*^9}, {3.6098551606395807`*^9, 3.609855161100309*^9}, {
   3.609855208520698*^9, 3.609855281073381*^9}, 3.609855312949431*^9, {
   3.6098593157200203`*^9, 3.609859319645019*^9}, {3.609859349819593*^9, 
   3.60985943722371*^9}, 3.610214782525917*^9, {3.6102148221478643`*^9, 
   3.610214829666552*^9}},
 CellID->844898134],

Cell["Injected dose:", "DetailNotes",
 CellChangeTimes->{{3.6084296801675224`*^9, 3.6084297464483137`*^9}, {
   3.608429777931114*^9, 3.6084298694923515`*^9}, 3.6084302294589405`*^9, {
   3.6084303058623104`*^9, 3.608430343067438*^9}, {3.608430565941186*^9, 
   3.608430595413872*^9}, {3.608430626659659*^9, 3.6084306775745707`*^9}, {
   3.6086568435309877`*^9, 3.6086569638437986`*^9}, {3.6089246973279333`*^9, 
   3.608924704639782*^9}, {3.609696931559031*^9, 3.6096969526872396`*^9}, {
   3.609697180360262*^9, 3.609697262088936*^9}, {3.6096973293227816`*^9, 
   3.6096973681220007`*^9}, {3.6096975351385536`*^9, 3.609697692230539*^9}, {
   3.609698648731248*^9, 3.6096986487402477`*^9}, {3.609698679788024*^9, 
   3.609698813098649*^9}, {3.609698857068164*^9, 3.6096989379207883`*^9}, {
   3.609699272832511*^9, 3.609699272845512*^9}, {3.6097005864538727`*^9, 
   3.609700616167572*^9}, 3.609700689090743*^9, {3.6097030835039086`*^9, 
   3.6097031135490403`*^9}, {3.609703149422068*^9, 3.6097031500704966`*^9}, {
   3.609703359780992*^9, 3.609703410067685*^9}, {3.6097584769748325`*^9, 
   3.6097584874628325`*^9}, {3.6098551606395807`*^9, 3.609855161100309*^9}, {
   3.609855208520698*^9, 3.609855281073381*^9}, 3.609855312949431*^9, {
   3.6098593157200203`*^9, 3.609859319645019*^9}, {3.609859349819593*^9, 
   3.60985943722371*^9}, 3.610214782525917*^9, {3.6102148221478643`*^9, 
   3.610214826913808*^9}},
 CellID->2012289996],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[Delta]", "\[InvisibleSpace]", 
      RowBox[{"d", "(", "t", ")"}]}], 
     RowBox[{"\[Delta]", "\[InvisibleSpace]", "t"}]], "=", 
    RowBox[{
     RowBox[{"-", 
      SubscriptBox["k", "a"]}], " ", 
     RowBox[{"d", "(", "t", ")"}]}]}], TraditionalForm]], "InlineMath"],
 "."
}], "DetailNotes",
 CellChangeTimes->{{3.6084296801675224`*^9, 3.6084297464483137`*^9}, {
   3.608429777931114*^9, 3.6084298694923515`*^9}, 3.6084302294589405`*^9, {
   3.6084303058623104`*^9, 3.608430343067438*^9}, {3.608430565941186*^9, 
   3.608430595413872*^9}, {3.608430626659659*^9, 3.6084306775745707`*^9}, {
   3.6086568435309877`*^9, 3.6086569638437986`*^9}, {3.6089246973279333`*^9, 
   3.608924704639782*^9}, {3.609696931559031*^9, 3.6096969526872396`*^9}, {
   3.609697180360262*^9, 3.609697262088936*^9}, {3.6096973293227816`*^9, 
   3.6096973681220007`*^9}, {3.6096975351385536`*^9, 3.609697692230539*^9}, {
   3.609698648731248*^9, 3.6096986487402477`*^9}, {3.609698679788024*^9, 
   3.609698813098649*^9}, {3.609698857068164*^9, 3.6096989379207883`*^9}, {
   3.609699272832511*^9, 3.609699305586385*^9}, {3.6096993605245266`*^9, 
   3.609699372797229*^9}, {3.609700330365225*^9, 3.6097003303742256`*^9}, {
   3.6097006736338587`*^9, 3.6097006850415115`*^9}, {3.609703173461171*^9, 
   3.609703247402708*^9}, {3.6097034196601057`*^9, 3.6097034205737247`*^9}, 
   3.609703451213255*^9, 3.609758426796833*^9, {3.609855321005863*^9, 
   3.6098553545474243`*^9}, {3.6098553972996607`*^9, 3.609855410065539*^9}},
 CellID->151878723],

Cell["\<\
The first dose is at time zero, and the same mass is then injected for each \
subsequent dose. \
\>", "DetailNotes",
 CellChangeTimes->{{3.6084296801675224`*^9, 3.6084297464483137`*^9}, {
   3.608429777931114*^9, 3.6084298694923515`*^9}, 3.6084302294589405`*^9, {
   3.6084303058623104`*^9, 3.608430343067438*^9}, {3.608430565941186*^9, 
   3.608430595413872*^9}, {3.608430626659659*^9, 3.6084306775745707`*^9}, {
   3.6086568435309877`*^9, 3.6086569638437986`*^9}, {3.6089246973279333`*^9, 
   3.608924704639782*^9}, {3.609696931559031*^9, 3.6096969526872396`*^9}, {
   3.609697180360262*^9, 3.609697262088936*^9}, {3.6096973293227816`*^9, 
   3.6096973681220007`*^9}, {3.6096975351385536`*^9, 3.609697692230539*^9}, {
   3.609698648731248*^9, 3.6096986487402477`*^9}, {3.609698679788024*^9, 
   3.609698813098649*^9}, {3.609698857068164*^9, 3.6096989379207883`*^9}, {
   3.609699272832511*^9, 3.609699305586385*^9}, {3.6096993605245266`*^9, 
   3.609699372797229*^9}, {3.609700330365225*^9, 3.6097003303742256`*^9}, {
   3.6097006736338587`*^9, 3.6097006850415115`*^9}, {3.609703173461171*^9, 
   3.609703247402708*^9}, {3.6097034196601057`*^9, 3.6097034205737247`*^9}, 
   3.609703451213255*^9, 3.609758426796833*^9, {3.609855321005863*^9, 
   3.6098553545474243`*^9}, {3.6098553972996607`*^9, 3.6098554064995327`*^9}},
 
 CellID->2017017122],

Cell["Compartment one:", "DetailNotes",
 CellChangeTimes->{{3.6084296801675224`*^9, 3.6084297464483137`*^9}, {
   3.608429777931114*^9, 3.6084298694923515`*^9}, 3.6084302294589405`*^9, {
   3.6084303058623104`*^9, 3.608430343067438*^9}, {3.608430565941186*^9, 
   3.608430595413872*^9}, {3.608430626659659*^9, 3.6084306775745707`*^9}, {
   3.6086568435309877`*^9, 3.6086569638437986`*^9}, {3.6089246973279333`*^9, 
   3.608924704639782*^9}, {3.609696931559031*^9, 3.6096969526872396`*^9}, {
   3.609697180360262*^9, 3.609697262088936*^9}, {3.6096973293227816`*^9, 
   3.6096973681220007`*^9}, {3.6096975351385536`*^9, 3.609697692230539*^9}, {
   3.609698648731248*^9, 3.6096986487402477`*^9}, {3.609698679788024*^9, 
   3.609698813098649*^9}, {3.609698857068164*^9, 3.6096989379207883`*^9}, {
   3.609699272832511*^9, 3.609699305586385*^9}, {3.6096993605245266`*^9, 
   3.609699372797229*^9}, {3.609700330365225*^9, 3.6097003303742256`*^9}, {
   3.6097006736338587`*^9, 3.6097006850415115`*^9}, {3.609703173461171*^9, 
   3.609703247402708*^9}, {3.6097034196601057`*^9, 3.6097034205737247`*^9}, 
   3.609703451213255*^9, 3.609758426796833*^9, {3.609855321005863*^9, 
   3.6098553545474243`*^9}, 3.6098553972996607`*^9},
 CellID->1226314774],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[Delta]", "\[InvisibleSpace]", 
      RowBox[{
       SubscriptBox["c", "1"], "(", "t", ")"}]}], 
     RowBox[{"\[Delta]", "\[InvisibleSpace]", "t"}]], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["k", "a"], " ", 
      FractionBox[
       RowBox[{"d", "(", "t", ")"}], 
       SubscriptBox["V", "1"]]}], "-", 
     RowBox[{
      SubscriptBox["k", "12"], " ", 
      RowBox[{
       SubscriptBox["c", "1"], "(", "t", ")"}]}], "-", 
     RowBox[{
      SubscriptBox["k", 
       RowBox[{"el", ",", "1"}]], " ", 
      SuperscriptBox[
       RowBox[{
        SubscriptBox["c", "1"], "(", "t", ")"}], "ro"]}], "+", 
     RowBox[{
      SubscriptBox["k", "21"], " ", 
      RowBox[{
       SubscriptBox["c", "2"], "(", "t", ")"}]}]}]}], TraditionalForm]], 
  "InlineMath"],
 "."
}], "DetailNotes",
 CellChangeTimes->{{3.6084296801675224`*^9, 3.6084297464483137`*^9}, {
   3.608429777931114*^9, 3.6084298694923515`*^9}, 3.6084302294589405`*^9, {
   3.6084303058623104`*^9, 3.608430343067438*^9}, {3.608430565941186*^9, 
   3.608430595413872*^9}, {3.608430626659659*^9, 3.6084306775745707`*^9}, {
   3.6086568435309877`*^9, 3.6086569638437986`*^9}, {3.6089246973279333`*^9, 
   3.608924704639782*^9}, {3.609696931559031*^9, 3.6096969526872396`*^9}, {
   3.609697180360262*^9, 3.609697262088936*^9}, {3.6096973293227816`*^9, 
   3.6096973681220007`*^9}, {3.6096975351385536`*^9, 3.609697692230539*^9}, {
   3.609698648731248*^9, 3.6096986487402477`*^9}, {3.609698679788024*^9, 
   3.609698813098649*^9}, {3.609698857068164*^9, 3.6096989379207883`*^9}, {
   3.609699272832511*^9, 3.609699305586385*^9}, {3.6096993605245266`*^9, 
   3.609699372797229*^9}, {3.609700330365225*^9, 3.6097004151560745`*^9}, {
   3.6097004826559353`*^9, 3.6097004970767603`*^9}, {3.609700551184855*^9, 
   3.6097005515818777`*^9}, 3.609700694881074*^9, {3.609703261487144*^9, 
   3.6097033220076866`*^9}, 3.6097034415247564`*^9, 3.609758430499833*^9, {
   3.609855365824738*^9, 3.609855388858508*^9}},
 CellID->249173880],

Cell["\<\
The initial condition for compartment one is that the drug concentration \
there is zero when absorption occurs, and it is the mass of the drug divided \
by the volume of compartment one when absorption does not occur.\
\>", "DetailNotes",
 CellChangeTimes->{{3.6084296801675224`*^9, 3.6084297464483137`*^9}, {
   3.608429777931114*^9, 3.6084298694923515`*^9}, 3.6084302294589405`*^9, {
   3.6084303058623104`*^9, 3.608430343067438*^9}, {3.608430565941186*^9, 
   3.608430595413872*^9}, {3.608430626659659*^9, 3.6084306775745707`*^9}, {
   3.6086568435309877`*^9, 3.6086569638437986`*^9}, {3.6089246973279333`*^9, 
   3.608924704639782*^9}, {3.609696931559031*^9, 3.6096969526872396`*^9}, {
   3.609697180360262*^9, 3.609697262088936*^9}, {3.6096973293227816`*^9, 
   3.6096973681220007`*^9}, {3.6096975351385536`*^9, 3.609697692230539*^9}, {
   3.609698648731248*^9, 3.6096986487402477`*^9}, {3.609698679788024*^9, 
   3.609698813098649*^9}, {3.609698857068164*^9, 3.6096989379207883`*^9}, {
   3.609699272832511*^9, 3.609699305586385*^9}, {3.6096993605245266`*^9, 
   3.609699372797229*^9}, {3.609700330365225*^9, 3.6097004151560745`*^9}, {
   3.6097004826559353`*^9, 3.6097004970767603`*^9}, {3.609700551184855*^9, 
   3.6097005515818777`*^9}, 3.609700694881074*^9, {3.609703261487144*^9, 
   3.6097033220076866`*^9}, 3.6097034415247564`*^9, 3.609758430499833*^9, {
   3.609855365824738*^9, 3.60985538470702*^9}, {3.6098554162506027`*^9, 
   3.609855422025784*^9}, 3.609855517446745*^9},
 CellID->1274850284],

Cell["Compartment two:", "DetailNotes",
 CellChangeTimes->{{3.6084296801675224`*^9, 3.6084297464483137`*^9}, {
   3.608429777931114*^9, 3.6084298694923515`*^9}, 3.6084302294589405`*^9, {
   3.6084303058623104`*^9, 3.608430343067438*^9}, {3.608430565941186*^9, 
   3.608430595413872*^9}, {3.608430626659659*^9, 3.6084306775745707`*^9}, {
   3.6086568435309877`*^9, 3.6086569638437986`*^9}, {3.6089246973279333`*^9, 
   3.608924704639782*^9}, {3.609696931559031*^9, 3.6096969526872396`*^9}, {
   3.609697180360262*^9, 3.609697262088936*^9}, {3.6096973293227816`*^9, 
   3.6096973681220007`*^9}, {3.6096975351385536`*^9, 3.609697692230539*^9}, {
   3.609698648731248*^9, 3.6096986487402477`*^9}, {3.609698679788024*^9, 
   3.609698813098649*^9}, {3.609698857068164*^9, 3.6096989379207883`*^9}, {
   3.609699272832511*^9, 3.609699305586385*^9}, {3.6096993605245266`*^9, 
   3.609699372797229*^9}, {3.609700330365225*^9, 3.6097004151560745`*^9}, {
   3.6097004826559353`*^9, 3.6097004970767603`*^9}, {3.609700551184855*^9, 
   3.6097005515818777`*^9}, 3.609700694881074*^9, {3.609703261487144*^9, 
   3.6097033220076866`*^9}, 3.6097034415247564`*^9, 3.609758430499833*^9, {
   3.609855365824738*^9, 3.60985538470702*^9}, 3.6098554162506027`*^9},
 CellID->1878564788],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[Delta]", "\[InvisibleSpace]", 
      RowBox[{
       SubscriptBox["c", "2"], "(", "t", ")"}]}], 
     RowBox[{"\[Delta]", "\[InvisibleSpace]", "t"}]], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["k", "12"], " ", 
      RowBox[{
       SubscriptBox["c", "1"], "(", "t", ")"}]}], "-", 
     RowBox[{
      SubscriptBox["k", "21"], " ", 
      RowBox[{
       SubscriptBox["c", "2"], "(", "t", ")"}]}], "-", 
     RowBox[{
      SubscriptBox["k", 
       RowBox[{"el", ",", "2"}]], " ", 
      SuperscriptBox[
       RowBox[{
        SubscriptBox["c", "2"], "(", "t", ")"}], "ro"]}]}]}], 
   TraditionalForm]], "InlineMath"],
 "."
}], "DetailNotes",
 CellChangeTimes->{{3.6084296801675224`*^9, 3.6084297464483137`*^9}, {
   3.608429777931114*^9, 3.6084298694923515`*^9}, 3.6084302294589405`*^9, {
   3.6084303058623104`*^9, 3.608430343067438*^9}, {3.608430565941186*^9, 
   3.608430595413872*^9}, {3.608430626659659*^9, 3.6084306775745707`*^9}, {
   3.6086568435309877`*^9, 3.6086569638437986`*^9}, {3.6089246973279333`*^9, 
   3.608924704639782*^9}, {3.609696931559031*^9, 3.6096969526872396`*^9}, {
   3.609697180360262*^9, 3.609697262088936*^9}, {3.6096973293227816`*^9, 
   3.6096973681220007`*^9}, {3.6096975351385536`*^9, 3.609697692230539*^9}, {
   3.609698648731248*^9, 3.6096986487402477`*^9}, {3.609698679788024*^9, 
   3.609698813098649*^9}, {3.609698857068164*^9, 3.6096989379207883`*^9}, {
   3.609699272832511*^9, 3.609699305586385*^9}, {3.6096993605245266`*^9, 
   3.609699372797229*^9}, {3.609700330365225*^9, 3.6097004151560745`*^9}, {
   3.6097004826559353`*^9, 3.609700549545761*^9}, {3.6097033275173845`*^9, 
   3.609703339797608*^9}, 3.6097034368136053`*^9, {3.609855463950993*^9, 
   3.6098554876278887`*^9}},
 CellID->286990574],

Cell["\<\
The initial condition for compartment two is that the concentration there is \
zero at time zero.\[LineSeparator]\
\>", "DetailNotes",
 CellChangeTimes->{{3.6084296801675224`*^9, 3.6084297464483137`*^9}, {
   3.608429777931114*^9, 3.6084298694923515`*^9}, 3.6084302294589405`*^9, {
   3.6084303058623104`*^9, 3.608430343067438*^9}, {3.608430565941186*^9, 
   3.608430595413872*^9}, {3.608430626659659*^9, 3.6084306775745707`*^9}, {
   3.6086568435309877`*^9, 3.6086569638437986`*^9}, {3.6089246973279333`*^9, 
   3.608924704639782*^9}, {3.609696931559031*^9, 3.6096969526872396`*^9}, {
   3.609697180360262*^9, 3.609697262088936*^9}, {3.6096973293227816`*^9, 
   3.6096973681220007`*^9}, {3.6096975351385536`*^9, 3.609697692230539*^9}, {
   3.609698648731248*^9, 3.6096986487402477`*^9}, {3.609698679788024*^9, 
   3.609698813098649*^9}, {3.609698857068164*^9, 3.6096989379207883`*^9}, {
   3.609699272832511*^9, 3.609699305586385*^9}, {3.6096993605245266`*^9, 
   3.609699372797229*^9}, {3.609700330365225*^9, 3.6097004151560745`*^9}, {
   3.6097004826559353`*^9, 3.609700549545761*^9}, {3.6097033275173845`*^9, 
   3.609703339797608*^9}, 3.6097034368136053`*^9, {3.609855463950993*^9, 
   3.609855502011745*^9}},
 CellID->1176238425]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ControlSuggestionsSection"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[" Resize Images"]}],
  "\"Click inside an image to reveal its orange resize frame.\\nDrag any of \
the orange resize handles to resize the image.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.60842800030044*^9},
 FontFamily->"Verdana",
 CellTags->"ResizeImages"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Rotate and Zoom in 3D"]}],
  RowBox[{
   "\"Drag a 3D graphic to rotate it. Starting the drag near the center \
tumbles\\nthe graphic; starting near a corner turns it parallel to the plane \
of the screen.\\nHold down \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" (or \"", 
    FrameBox[
    "Cmd", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" on Mac) and drag up and down to zoom.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"RotateAndZoomIn3D"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Drag Locators"]}],
  RowBox[{"\"Drag any locator (\"", 
    GraphicsBox[
     LocatorBox[
      Scaled[{0.5, 0.5}]], ImageSize -> 20], 
    "\", etc.) to move it around.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"DragLocators"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Create and Delete Locators"]}],
  RowBox[{"\"Insert a new locator in the graphic by holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key\\nand clicking where you want it to be. Delete a locator by \
clicking it\\nwhile holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" key.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"CreateAndDeleteLocators"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[" Slider Zoom"]}],
  RowBox[{"\"Hold down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key while moving a slider to make fine adjustments in the slider \
value.\\nHold \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" and/or \"", 
    FrameBox[
    "Shift", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" at the same time as \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" to make ever finer adjustments.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.6084281215083723`*^9},
 FontFamily->"Verdana",
 CellTags->"SliderZoom"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[" Gamepad Controls"]}],
  "\"Control this Demonstration with a gamepad or other\\nhuman interface \
device connected to your computer.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.35696210375764*^9, 3.3895522232313623`*^9, 
  3.608428121900395*^9},
 FontFamily->"Verdana",
 CellTags->"GamepadControls"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[" Automatic Animation"]}],
  RowBox[{"\"Animate a slider in this Demonstration by clicking the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJzzTSzJSM1NLMlMTlRwL0osyMhMLlZwyy8CCjEzMjAwcIKwAgOI/R/IhBKc\n\
/4EAyGAG0f+nTZsGwgysIJIRKsWKLAXGIHFmEpUgLADxWUAkI24jZs+eTaEt\n\
IG+wQKRmzJgBlYf5lhEA30OqWA=="], "Graphics", ImageSize -> {9, 9}, ImageMargins -> 
      0, CellBaseline -> Baseline], BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"button\\nnext to the slider, and then clicking the play button that \
appears.\\nAnimate all controls by selecting \"", 
    StyleBox["Autorun", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.6084281223724217`*^9},
 FontFamily->"Verdana",
 CellTags->"AutomaticAnimation"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Bookmark Animation"]}],
  RowBox[{
   "\"See a prepared animation of this Demonstration by selecting\\n\"", 
    StyleBox["Animate Bookmarks", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"BookmarkAnimation"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SearchTermsSection"],

Cell["chemical engineering", "SearchTerms",
 CellChangeTimes->{{3.6084281319509697`*^9, 3.6084281408274775`*^9}},
 CellID->67926656],

Cell["pharmacokinetics", "SearchTerms",
 CellChangeTimes->{{3.6084281319509697`*^9, 3.608428145192727*^9}},
 CellID->259287395],

Cell["compartment model", "SearchTerms",
 CellChangeTimes->{{3.6084281319509697`*^9, 3.608428155394311*^9}},
 CellID->118036060],

Cell["drug concentration", "SearchTerms",
 CellChangeTimes->{{3.6084281319509697`*^9, 3.608428185482032*^9}, {
  3.60843036791486*^9, 3.6084303679178596`*^9}, {3.60970299749533*^9, 
  3.60970299749728*^9}},
 CellID->10457980],

Cell["kinetics", "SearchTerms",
 CellChangeTimes->{{3.6084281319509697`*^9, 3.608428185482032*^9}, {
  3.60843036791486*^9, 3.6084303679178596`*^9}, {3.60970299749533*^9, 
  3.609703000519305*^9}},
 CellID->391099422],

Cell["", "SearchTerms",
 CellChangeTimes->{{3.6084281319509697`*^9, 3.608428185482032*^9}, {
  3.60843036791486*^9, 3.6084303679178596`*^9}, {3.60970299749533*^9, 
  3.6097030005173144`*^9}},
 CellID->719026785]
}, Open  ]],

Cell["", "RelatedLinksSection"],

Cell[CellGroupData[{

Cell["", "AuthorSection"],

Cell[TextData[{
 "Contributed by: ",
 ButtonBox["Nicholas R. Larson",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=Nicholas+R.+\
Larson"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=Nicholas+R.+Larson"]
}], "Author",
 CellChangeTimes->{
  3.6084282008699117`*^9, {3.609504476722556*^9, 3.6095044943155622`*^9}, 
   3.6098548073998137`*^9}],

Cell[TextData[{
 "With additional contributions by: ",
 ButtonBox["John L. Falconer",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=John+L.+\
Falconer"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=John+L.+Falconer"],
 " and",
 ButtonBox[" ",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=John+L.+\
Falconer"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=John+L.+Falconer"],
 ButtonBox["Rachael L. Baumann",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=Rachael+L.+\
Baumann"], None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=Rachael+L.+Baumann"]
}], "Author",
 CellChangeTimes->{
  3.6084282008699117`*^9, {3.609504476722556*^9, 3.6095044943155622`*^9}, {
   3.6098548073998137`*^9, 3.609854812327482*^9}},
 CellID->656061828],

Cell["\<\
(University of Colorado Boulder, Department of Chemical and Biological \
Engineering)\
\>", "Author",
 CellChangeTimes->{
  3.6084282008699117`*^9, {3.609504476722556*^9, 3.6095044943155622`*^9}, {
   3.6098548073998137`*^9, 3.609854812327482*^9}},
 CellID->1250099498]
}, Open  ]]
}, Open  ]]
},
WindowSize->{667, 670},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (December 4, 2014)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "Demonstration.nb", 
  CharacterEncoding -> "WindowsANSI"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "ResizeImages"->{
  Cell[115554, 2394, 352, 9, 29, "ControlSuggestions",
   CellTags->"ResizeImages"]},
 "RotateAndZoomIn3D"->{
  Cell[115909, 2405, 678, 16, 29, "ControlSuggestions",
   CellTags->"RotateAndZoomIn3D"]},
 "DragLocators"->{
  Cell[116590, 2423, 340, 11, 29, "ControlSuggestions",
   CellTags->"DragLocators"]},
 "CreateAndDeleteLocators"->{
  Cell[116933, 2436, 637, 15, 29, "ControlSuggestions",
   CellTags->"CreateAndDeleteLocators"]},
 "SliderZoom"->{
  Cell[117573, 2453, 887, 22, 29, "ControlSuggestions",
   CellTags->"SliderZoom"]},
 "GamepadControls"->{
  Cell[118463, 2477, 393, 10, 29, "ControlSuggestions",
   CellTags->"GamepadControls"]},
 "AutomaticAnimation"->{
  Cell[118859, 2489, 1507, 32, 29, "ControlSuggestions",
   CellTags->"AutomaticAnimation"]},
 "BookmarkAnimation"->{
  Cell[120369, 2523, 908, 21, 29, "ControlSuggestions",
   CellTags->"BookmarkAnimation"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"ResizeImages", 124624, 2654},
 {"RotateAndZoomIn3D", 124734, 2657},
 {"DragLocators", 124845, 2660},
 {"CreateAndDeleteLocators", 124962, 2663},
 {"SliderZoom", 125077, 2666},
 {"GamepadControls", 125184, 2669},
 {"AutomaticAnimation", 125299, 2672},
 {"BookmarkAnimation", 125417, 2675}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 142, 2, 74, "DemoTitle"],
Cell[725, 26, 33, 0, 287, "InitializationSection"],
Cell[CellGroupData[{
Cell[783, 30, 29, 0, 192, "ManipulateSection"],
Cell[CellGroupData[{
Cell[837, 34, 29603, 702, 2498, "Input"],
Cell[30443, 738, 13352, 258, 493, "Output",
 CellID->433757142]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[43844, 1002, 36, 0, 169, "ManipulateCaptionSection"],
Cell[43883, 1004, 1951, 28, 82, "ManipulateCaption"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45871, 1037, 28, 0, 173, "ThumbnailSection"],
Cell[45902, 1039, 13250, 256, 493, "Output",
 CellID->1637124699]
}, Open  ]],
Cell[CellGroupData[{
Cell[59189, 1300, 28, 0, 149, "SnapshotsSection"],
Cell[59220, 1302, 13214, 254, 461, "Output",
 CellID->1594330729],
Cell[72437, 1558, 13374, 256, 461, "Output",
 CellID->1763098684],
Cell[85814, 1816, 13271, 256, 461, "Output",
 CellID->1420220682]
}, Open  ]],
Cell[CellGroupData[{
Cell[99122, 2077, 26, 0, 357, "DetailsSection"],
Cell[99151, 2079, 2707, 54, 91, "DetailNotes",
 CellID->844898134],
Cell[101861, 2135, 1435, 20, 23, "DetailNotes",
 CellID->2012289996],
Cell[103299, 2157, 1607, 30, 30, "DetailNotes",
 CellID->151878723],
Cell[104909, 2189, 1355, 21, 23, "DetailNotes",
 CellID->2017017122],
Cell[106267, 2212, 1240, 17, 23, "DetailNotes",
 CellID->1226314774],
Cell[107510, 2231, 2085, 48, 34, "DetailNotes",
 CellID->249173880],
Cell[109598, 2281, 1521, 22, 39, "DetailNotes",
 CellID->1274850284],
Cell[111122, 2305, 1261, 17, 23, "DetailNotes",
 CellID->1878564788],
Cell[112386, 2324, 1843, 42, 31, "DetailNotes",
 CellID->286990574],
Cell[114232, 2368, 1245, 19, 39, "DetailNotes",
 CellID->1176238425]
}, Open  ]],
Cell[CellGroupData[{
Cell[115514, 2392, 37, 0, 131, "ControlSuggestionsSection"],
Cell[115554, 2394, 352, 9, 29, "ControlSuggestions",
 CellTags->"ResizeImages"],
Cell[115909, 2405, 678, 16, 29, "ControlSuggestions",
 CellTags->"RotateAndZoomIn3D"],
Cell[116590, 2423, 340, 11, 29, "ControlSuggestions",
 CellTags->"DragLocators"],
Cell[116933, 2436, 637, 15, 29, "ControlSuggestions",
 CellTags->"CreateAndDeleteLocators"],
Cell[117573, 2453, 887, 22, 29, "ControlSuggestions",
 CellTags->"SliderZoom"],
Cell[118463, 2477, 393, 10, 29, "ControlSuggestions",
 CellTags->"GamepadControls"],
Cell[118859, 2489, 1507, 32, 29, "ControlSuggestions",
 CellTags->"AutomaticAnimation"],
Cell[120369, 2523, 908, 21, 29, "ControlSuggestions",
 CellTags->"BookmarkAnimation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[121314, 2549, 30, 0, 165, "SearchTermsSection"],
Cell[121347, 2551, 132, 2, 23, "SearchTerms",
 CellID->67926656],
Cell[121482, 2555, 127, 2, 23, "SearchTerms",
 CellID->259287395],
Cell[121612, 2559, 128, 2, 23, "SearchTerms",
 CellID->118036060],
Cell[121743, 2563, 225, 4, 23, "SearchTerms",
 CellID->10457980],
Cell[121971, 2569, 217, 4, 23, "SearchTerms",
 CellID->391099422],
Cell[122191, 2575, 211, 4, 23, "SearchTerms",
 CellID->719026785]
}, Open  ]],
Cell[122417, 2582, 31, 0, 149, "RelatedLinksSection"],
Cell[CellGroupData[{
Cell[122473, 2586, 25, 0, 137, "AuthorSection"],
Cell[122501, 2588, 434, 12, 23, "Author"],
Cell[122938, 2602, 1002, 28, 23, "Author",
 CellID->656061828],
Cell[123943, 2632, 279, 7, 23, "Author",
 CellID->1250099498]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
