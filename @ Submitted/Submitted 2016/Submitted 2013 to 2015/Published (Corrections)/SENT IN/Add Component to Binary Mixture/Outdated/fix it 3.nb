(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     98157,       2159]
NotebookOptionsPosition[     97391,       2131]
NotebookOutlinePosition[     97737,       2146]
CellTagsIndexPosition[     97694,       2143]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "P", ",", "x1", ",", "y1", ",", "z0", ",", "T", ",", "Psat1", ",", 
       "Psat2", ",", "Px", ",", "Py", ",", "nL", ",", "nV", ",", "zf", ",", 
       "step", ",", "zPoint", ",", "p1", ",", "p2", ",", "leverL", ",", 
       "leverV", ",", "h", ",", "hL", ",", "hV", ",", "vL", ",", "vV", ",", 
       "piston", ",", "L", ",", "V", ",", "n", ",", "add"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T", "=", "30"}], ";", "\[IndentingNewLine]", 
      RowBox[{"P", "=", "0.12"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Psat1", "=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"4", "-", 
          RowBox[{"1171.53", "/", 
           RowBox[{"(", 
            RowBox[{"T", "+", "224.2"}], ")"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Psat2", "=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"4.05", "-", 
          RowBox[{"1355", "/", 
           RowBox[{"(", 
            RowBox[{"T", "+", "209.4"}], ")"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Px", "[", "x_", "]"}], "=", 
       RowBox[{
        RowBox[{"x", "*", "Psat1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "x"}], ")"}], "*", "Psat2"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Py", "[", "x_", "]"}], "=", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          FractionBox["x", "Psat1"], "+", 
          FractionBox[
           RowBox[{"1", "-", "x"}], "Psat2"]}], ")"}], 
        RowBox[{"-", "1"}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"x1", "=", 
       RowBox[{"x", "/.", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Px", "[", "x", "]"}], "\[Equal]", "P"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0.1"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"y1", "=", 
       RowBox[{"x", "/.", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Py", "[", "x", "]"}], "\[Equal]", "P"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0.1"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nL", "=", "20"}], ";", "\[IndentingNewLine]", 
      RowBox[{"nV", "=", "3"}], ";", "\[IndentingNewLine]", 
      RowBox[{"z0", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"x1", "*", "nL"}], "+", 
          RowBox[{"y1", "*", "nV"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"nL", "+", "nV"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"zf", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"cs", "\[Equal]", "1"}], ",", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "x1"}], ")"}], "*", "nL"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "y1"}], ")"}], "*", "nV"}], "+", "nA"}], 
            ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"nL", "+", "nV", "+", "nA"}], ")"}]}]}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x1", "*", "nL"}], "+", 
            RowBox[{"y1", "*", "nV"}], "+", "nA"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"nL", "+", "nV", "+", "nA"}], ")"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"zPoint", "=", 
       RowBox[{"z0", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"zf", "-", "z0"}], ")"}], "*", "step"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"leverL", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Px", "[", "zPoint", "]"}], "\[LessEqual]", "P"}], ",", "1",
          ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"y1", "-", "zPoint"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"y1", "-", "x1"}], ")"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"leverV", "=", 
       RowBox[{"1", "-", "leverL"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"L", "[", "z_", "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Px", "[", "z", "]"}], "\[LessEqual]", "P"}], ",", "1", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"y1", "-", "z"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"y1", "-", "x1"}], ")"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"h", "=", "2.35"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"hL", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"cs", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"0.3", "*", "leverL"}], "+", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"nA", ">", "3.1"}], ",", 
             RowBox[{"0.05", "*", 
              RowBox[{"(", 
               FractionBox[
                RowBox[{"nA", "-", "3.2"}], 
                RowBox[{"6", "-", "3.2"}]], ")"}]}], ",", "0"}], "]"}], "*", 
           "step"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"0.3", "*", "leverL", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"0.5", "*", "step"}]}], ")"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"piston", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"cs", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"nA", "\[LessEqual]", "3.1"}], ",", "\[IndentingNewLine]", 
           RowBox[{"h", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{
                   FractionBox["1", "3"], "*", 
                   RowBox[{"(", 
                    RowBox[{"nA", "-", "0.1"}], ")"}]}]}], ")"}], "*", 
                RowBox[{"(", 
                 RowBox[{"h", "-", "hL"}], ")"}]}], "+", "hL", "-", "h"}], 
              ")"}], "*", "step"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"h", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"hL", "-", "h"}], ")"}], "*", "step"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"h", "+", 
          RowBox[{"0.5", "*", "step"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"step", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"cs", "\[Equal]", "1"}], ",", "s1", ",", "s2"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"add", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"0.05", "+", 
          RowBox[{"0.7", "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nA", "-", "0.1"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"6", "-", "0.1"}], ")"}]}]}]}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "step"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"p1", "=", 
       RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Inset", "[", "\[IndentingNewLine]", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Opacity", "[", "0.5", "]"}], ",", 
                RowBox[{"Cylinder", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "2.75"}], "}"}]}], "}"}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Cylinder", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "1.375"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "0", ",", "1.375"}], "}"}]}], "}"}], 
                  ",", "0.13"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Opacity", "[", "0.75", "]"}], ",", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{"0.07", ",", "1", ",", "0.6"}], "]"}], ",", 
                RowBox[{"Cylinder", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "hL"}], "}"}]}], "}"}], "]"}],
                 ",", "\[IndentingNewLine]", 
                RowBox[{"Cylinder", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "1.375"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "+", "add"}], ",", "0", ",", "1.375"}], 
                    "}"}]}], "}"}], ",", "0.13"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Cylinder", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"1", "+", "add"}], ",", "0", ",", "1.375"}], 
                   "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"2.1", "+", "add"}], ",", "0", ",", "1.375"}], 
                   "}"}]}], "}"}], ",", "0.03"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"Black", ",", 
                RowBox[{"Cylinder", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2.1", "+", "add"}], ",", "0", ",", "1.375"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2.125", "+", "add"}], ",", "0", ",", "1.375"}], 
                    "}"}]}], "}"}], ",", "0.14"}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"Gray", ",", 
                RowBox[{"Cylinder", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "piston"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"piston", "+", "0.15"}]}], "}"}]}], "}"}], "]"}], 
                ",", 
                RowBox[{"Cylinder", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"piston", "+", "0.15"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "3"}], "}"}]}], "}"}], ",", 
                  "0.11"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"cs", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"s1", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"nA", ",", "\"\< mol \>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<-octane added\>\""}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<add \>\"", ",", "nA", ",", "\"\< mol \>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<-octane\>\""}], "}"}], "]"}]}], "]"}], ",", "18"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"s1", "\[Equal]", "1"}], ",", 
                    "\"\<vapor condenses\>\"", ",", "\"\<\>\""}], "]"}], ",", 
                    "18"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "0", ",", "1.75"}], "}"}]}], "]"}]}], 
                 "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"s1", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"nA", ",", "\"\< mol \>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<-hexane added\>\""}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<add \>\"", ",", "nA", ",", "\"\< mol \>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<-hexane\>\""}], "}"}], "]"}]}], "]"}], ",", "18"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"s2", "\[Equal]", "1"}], ",", 
                    "\"\<liquid evaporates\>\"", ",", "\"\<\>\""}], "]"}], 
                    ",", "18"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "0", ",", "1.75"}], "}"}]}], "]"}]}], 
                 "\[IndentingNewLine]", "}"}]}], "]"}]}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", 
            RowBox[{"Lighting", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"\"\<Ambient\>\"", ",", "LightGray"}], "}"}], "}"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"Boxed", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
            RowBox[{"ViewPoint", "\[Rule]", "Front"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "3.25"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "0.1"}], ",", "3"}], "}"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", "500"}]}], "]"}], 
          "\[IndentingNewLine]", "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"500", ",", "353"}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "3.25"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "0.1"}], ",", "3"}], "}"}]}], "}"}]}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"p2", "=", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Px", "[", "x", "]"}], ",", 
             RowBox[{"Py", "[", "x", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.01", ",", "0.25"}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Thick", ",", 
                RowBox[{"RGBColor", "[", 
                 RowBox[{"0.1", ",", "0.6", ",", "0"}], "]"}]}], "}"}]}], 
             "}"}]}], ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], ",", 
                   "\"\<-hexane mole fraction\>\""}], "}"}], "]"}], ",", 
                "17"}], "]"}], ",", 
              RowBox[{"Style", "[", 
               RowBox[{"\"\<pressure (bar)\>\"", ",", "17"}], "]"}]}], 
             "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Black", ",", "13"}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"500", ",", "353"}], "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"PlotRangeClipping", "\[Rule]", "False"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ImagePadding", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"50", ",", "50"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"52", ",", "5"}], "}"}]}], "}"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{"\"\<pure \>\"", ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], ",", 
                   "\"\<-octane\>\""}], "}"}], "]"}], ",", "14"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.", ",", 
                RowBox[{"-", "0.025"}]}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{"\"\<pure \>\"", ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], ",", 
                   "\"\<-hexane\>\""}], "}"}], "]"}], ",", "14"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"1.", ",", 
                RowBox[{"-", "0.025"}]}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Px", "[", "zPoint", "]"}], "\[LessEqual]", "P"}], ",",
               "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"Thick", ",", "Dashed", ",", "Blue", ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"zPoint", ",", "P"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"zPoint", ",", "0.01"}], "}"}]}], "}"}], "]"}]}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"Thick", ",", "Dashed", ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"Blue", ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x1", ",", "0.01"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x1", ",", "P"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"zPoint", ",", "P"}], "}"}]}], "}"}], "]"}]}], 
                 "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"RGBColor", "[", 
                   RowBox[{"0.1", ",", "0.6", ",", "0"}], "]"}], ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"zPoint", ",", "P"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y1", ",", "P"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y1", ",", "0.01"}], "}"}]}], "}"}], "]"}]}], 
                 "}"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
              RowBox[{"Point", "[", 
               RowBox[{"{", 
                RowBox[{"zPoint", ",", "P"}], "}"}], "]"}]}], "}"}]}], "}"}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{"Switch", "[", 
        RowBox[{"ptv", ",", "1", ",", "p1", ",", "2", ",", "p2"}], "]"}], 
       "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ",", 
   RowBox[{"Column", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ptv", ",", "1", ",", "\"\<\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "\[Rule]", "\"\<piston\[Hyphen]cylinder\>\""}], ",", 
            RowBox[{"2", "\[Rule]", 
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<P-x-y\>\"", ",", "Italic"}], "]"}], ",", 
                "\"\< diagram\>\""}], "}"}], "]"}]}]}], "}"}], ",", 
          "Setter"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"cs", ",", "1", ",", "\"\<\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "\[Rule]", "\"\<add octane\>\""}], ",", 
            RowBox[{"2", "\[Rule]", "\"\<add hexane\>\""}]}], "}"}], ",", 
          "Setter"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"nA", ",", "3.1", ",", "\"\<add moles\>\""}], "}"}], ",", 
          "0.1", ",", "6", ",", "0.1", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
        "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"PaneSelector", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"1", "\[Rule]", 
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"s1", ",", "0", ",", "\"\<inject isothermally\>\""}], 
            "}"}], ",", "0", ",", "1", ",", "Trigger", ",", 
           RowBox[{"AnimationRate", "\[Rule]", "2"}], ",", 
           RowBox[{"AppearanceElements", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<PlayPauseButton\>\"", ",", "\"\<ResetButton\>\""}], 
             "}"}]}]}], "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"2", "\[Rule]", 
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"s2", ",", "0", ",", "\"\<inject isothermally\>\""}], 
            "}"}], ",", "0", ",", "1", ",", "Trigger", ",", 
           RowBox[{"AnimationRate", "\[Rule]", "2"}], ",", 
           RowBox[{"AppearanceElements", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<PlayPauseButton\>\"", ",", "\"\<ResetButton\>\""}], 
             "}"}]}]}], "}"}], "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"Dynamic", "@", "cs"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.63340096301792*^9, 3.633401189165855*^9}, {
   3.633401222873783*^9, 3.6334014109225388`*^9}, {3.633401485496804*^9, 
   3.633401590453807*^9}, {3.6334017198982115`*^9, 3.6334017420724792`*^9}, {
   3.6334018290704556`*^9, 3.6334018294424767`*^9}, 3.6334022721918*^9, {
   3.633444061414255*^9, 3.6334441193825707`*^9}, {3.633444179087986*^9, 
   3.6334441831992207`*^9}, {3.633444215335059*^9, 3.633444435000623*^9}, {
   3.6334445175503445`*^9, 3.633444520457511*^9}, {3.633444594265733*^9, 
   3.63344468531294*^9}, {3.633444753882862*^9, 3.6334447567720275`*^9}, {
   3.6334448026736526`*^9, 3.6334448617090297`*^9}, {3.633444893224832*^9, 
   3.633444915781122*^9}, {3.6334449552923822`*^9, 3.6334449574535055`*^9}, {
   3.633445006798328*^9, 3.633445059775358*^9}, {3.633445097348507*^9, 
   3.633445165730418*^9}, {3.633445205115671*^9, 3.633445312374806*^9}, {
   3.633445354135195*^9, 3.6334460544482503`*^9}, {3.6334461005578876`*^9, 
   3.6334461049031363`*^9}, {3.633446146569519*^9, 3.633446210304165*^9}, {
   3.6334462493613987`*^9, 3.633446616427394*^9}, {3.633446801103956*^9, 
   3.633446854930035*^9}, {3.6334468880239277`*^9, 3.6334468921331635`*^9}, {
   3.6334477813030205`*^9, 3.633447823187416*^9}, {3.633447950600704*^9, 
   3.6334480659523015`*^9}, {3.6334481135370235`*^9, 3.6334481891113462`*^9}, 
   3.633448242719412*^9, {3.633448313501461*^9, 3.63344831890477*^9}, {
   3.633448426172905*^9, 3.6334484869513817`*^9}, {3.6334485247665443`*^9, 
   3.6334486833096123`*^9}, {3.633448831164069*^9, 3.633449023931095*^9}, {
   3.6334491183634963`*^9, 3.6334491780849123`*^9}, {3.633451484663841*^9, 
   3.6334515887837963`*^9}, {3.6334528577973795`*^9, 3.633452871481162*^9}, {
   3.633453194221622*^9, 3.633453220291113*^9}, {3.6334534379935646`*^9, 
   3.6334534524973946`*^9}, {3.6334536188909116`*^9, 3.633453645935458*^9}, {
   3.633453682257536*^9, 3.633453685920746*^9}, {3.633453717311541*^9, 
   3.6334537747048235`*^9}, {3.6334538169272385`*^9, 
   3.6334538915865088`*^9}, {3.6334539259724755`*^9, 
   3.6334540642283835`*^9}, {3.6334541052697306`*^9, 
   3.6334541258069057`*^9}, {3.6334541893955426`*^9, 
   3.6334542564153757`*^9}, {3.6334542995498433`*^9, 3.633454483875386*^9}, {
   3.633454518722379*^9, 3.6334545436438046`*^9}, {3.6334547219280014`*^9, 
   3.6334548216297045`*^9}, {3.6334552468800273`*^9, 3.6334552832511077`*^9}, 
   3.6334553697600555`*^9, {3.6334555376286573`*^9, 3.6334555916247454`*^9}, {
   3.633455674796503*^9, 3.633455708253416*^9}, {3.633455742334366*^9, 
   3.633455770133956*^9}, {3.6334558348546576`*^9, 3.6334558361127295`*^9}, {
   3.6334561594892254`*^9, 3.6334562069879427`*^9}, {3.633456497491558*^9, 
   3.633456544934272*^9}, {3.633456577827153*^9, 3.6334566574507074`*^9}, {
   3.6334566887144957`*^9, 3.6334567900182896`*^9}, 3.6334568394601173`*^9, {
   3.6334571239113874`*^9, 3.6334572150616007`*^9}, {3.633457247512457*^9, 
   3.633457314656297*^9}, {3.633457393502807*^9, 3.6334574584585223`*^9}, {
   3.633457488991269*^9, 3.6334574990348434`*^9}, {3.6334575790454197`*^9, 
   3.633457636605712*^9}, {3.633457783990142*^9, 3.633457848881853*^9}, {
   3.6334579204239454`*^9, 3.6334579484845505`*^9}, {3.633457986014697*^9, 
   3.633458072775659*^9}, {3.6334581154801016`*^9, 3.6334581163701525`*^9}, {
   3.633458154892356*^9, 3.633458171554309*^9}, {3.63345822541039*^9, 
   3.6334582261274304`*^9}, {3.6334582622804985`*^9, 3.63345827839042*^9}, {
   3.633458972805138*^9, 3.6334590336736193`*^9}, {3.633459069785685*^9, 
   3.6334591577107143`*^9}, {3.633459217120112*^9, 3.633459272573284*^9}, {
   3.6334593028750167`*^9, 3.633459339432108*^9}, {3.633529738789895*^9, 
   3.6335297416000557`*^9}, {3.633539262468618*^9, 3.633539297014594*^9}, {
   3.6335393353567867`*^9, 3.6335393455133677`*^9}, {3.6335395692591653`*^9, 
   3.633539612712651*^9}, {3.6335397458762674`*^9, 3.6335398293200397`*^9}, {
   3.633540008539291*^9, 3.6335400216260395`*^9}, {3.633540065532551*^9, 
   3.6335401025406675`*^9}, {3.633540160160963*^9, 3.6335402229995575`*^9}, {
   3.633540544432942*^9, 3.633540657635417*^9}, {3.633540700556872*^9, 
   3.633540775664168*^9}, {3.6335409258317566`*^9, 3.633541040679326*^9}, {
   3.633541085123868*^9, 3.633541138160901*^9}, {3.633541255675623*^9, 
   3.6335414064972496`*^9}, {3.6335414455834846`*^9, 3.633541457636174*^9}, {
   3.6335415161325197`*^9, 3.6335415173355885`*^9}, {3.6335416049786015`*^9, 
   3.6335416738205395`*^9}, {3.633541728190649*^9, 3.633541953628544*^9}, {
   3.6335420151160603`*^9, 3.6335420302549267`*^9}, {3.6335421092714453`*^9, 
   3.6335421729950905`*^9}, {3.633542236552726*^9, 3.633542279739196*^9}, {
   3.633542444923644*^9, 3.633542632139352*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`cs$$ = 1, $CellContext`nA$$ = 
    3.1, $CellContext`ptv$$ = 1, $CellContext`s1$$ = 0, $CellContext`s2$$ = 0,
     Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`ptv$$], 1, ""}, {
      1 -> "piston\[Hyphen]cylinder", 2 -> Row[{
          Style["P-x-y", Italic], " diagram"}]}}, {{
       Hold[$CellContext`cs$$], 1, ""}, {
      1 -> "add octane", 2 -> "add hexane"}}, {{
       Hold[$CellContext`nA$$], 3.1, "add moles"}, 0.1, 6, 0.1}, {
      Hold[
       Column[{
         Manipulate`Place[1], 
         Manipulate`Place[2], 
         Manipulate`Place[3]}, Alignment -> Left]], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`s1$$], 0, "inject isothermally"}, 0, 1}, {{
       Hold[$CellContext`s2$$], 0, "inject isothermally"}, 0, 1}, {
      Hold[
       PaneSelector[{1 -> Manipulate`Place[4], 2 -> Manipulate`Place[5]}, 
        Dynamic[$CellContext`cs$$]]], Manipulate`Dump`ThisIsNotAControl}}, 
    Typeset`size$$ = {500., {174., 179.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`ptv$37443$$ = False, $CellContext`cs$37444$$ = 
    False, $CellContext`nA$37445$$ = 0, $CellContext`s1$37446$$ = 
    0, $CellContext`s2$37447$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`cs$$ = 1, $CellContext`nA$$ = 
        3.1, $CellContext`ptv$$ = 1, $CellContext`s1$$ = 0, $CellContext`s2$$ = 
        0}, "ControllerVariables" :> {
        Hold[$CellContext`ptv$$, $CellContext`ptv$37443$$, False], 
        Hold[$CellContext`cs$$, $CellContext`cs$37444$$, False], 
        Hold[$CellContext`nA$$, $CellContext`nA$37445$$, 0], 
        Hold[$CellContext`s1$$, $CellContext`s1$37446$$, 0], 
        Hold[$CellContext`s2$$, $CellContext`s2$37447$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`P$, $CellContext`x1$, $CellContext`y1$, \
$CellContext`z0$, $CellContext`T$, $CellContext`Psat1$, $CellContext`Psat2$, \
$CellContext`Px$, $CellContext`Py$, $CellContext`nL$, $CellContext`nV$, \
$CellContext`zf$, $CellContext`step$, $CellContext`zPoint$, $CellContext`p1$, \
$CellContext`p2$, $CellContext`leverL$, $CellContext`leverV$, \
$CellContext`h$, $CellContext`hL$, $CellContext`hV$, $CellContext`vL$, \
$CellContext`vV$, $CellContext`piston$, $CellContext`L$, $CellContext`V$, \
$CellContext`n$, $CellContext`add$}, $CellContext`T$ = 30; $CellContext`P$ = 
         0.12; $CellContext`Psat1$ = 
         10^(4 - 1171.53/($CellContext`T$ + 224.2)); $CellContext`Psat2$ = 
         10^(4.05 - 1355/($CellContext`T$ + 209.4)); $CellContext`Px$[
           Pattern[$CellContext`x$, 
            Blank[]]] = $CellContext`x$ $CellContext`Psat1$ + (
            1 - $CellContext`x$) $CellContext`Psat2$; $CellContext`Py$[
           Pattern[$CellContext`x$, 
            
            Blank[]]] = ($CellContext`x$/$CellContext`Psat1$ + (
             1 - $CellContext`x$)/$CellContext`Psat2$)^(-1); $CellContext`x1$ = 
         ReplaceAll[$CellContext`x, 
           
           FindRoot[$CellContext`Px$[$CellContext`x] == $CellContext`P$, \
{$CellContext`x, 0.1}]]; $CellContext`y1$ = ReplaceAll[$CellContext`x, 
           
           FindRoot[$CellContext`Py$[$CellContext`x] == $CellContext`P$, \
{$CellContext`x, 0.1}]]; $CellContext`nL$ = 20; $CellContext`nV$ = 
         3; $CellContext`z0$ = ($CellContext`x1$ $CellContext`nL$ + \
$CellContext`y1$ $CellContext`nV$)/($CellContext`nL$ + $CellContext`nV$); \
$CellContext`zf$ = 
         If[$CellContext`cs$$ == 1, 
           1 - ((1 - $CellContext`x1$) $CellContext`nL$ + (
              1 - $CellContext`y1$) $CellContext`nV$ + \
$CellContext`nA$$)/($CellContext`nL$ + $CellContext`nV$ + $CellContext`nA$$), \
($CellContext`x1$ $CellContext`nL$ + $CellContext`y1$ $CellContext`nV$ + \
$CellContext`nA$$)/($CellContext`nL$ + $CellContext`nV$ + $CellContext`nA$$)]; \
$CellContext`zPoint$ = $CellContext`z0$ + ($CellContext`zf$ - \
$CellContext`z0$) $CellContext`step$; $CellContext`leverL$ = 
         If[$CellContext`Px$[$CellContext`zPoint$] <= $CellContext`P$, 
           1, ($CellContext`y1$ - $CellContext`zPoint$)/($CellContext`y1$ - \
$CellContext`x1$)]; $CellContext`leverV$ = 
         1 - $CellContext`leverL$; $CellContext`L$[
           Pattern[$CellContext`z$, 
            Blank[]]] = 
         If[$CellContext`Px$[$CellContext`z$] <= $CellContext`P$, 
           1, ($CellContext`y1$ - $CellContext`z$)/($CellContext`y1$ - \
$CellContext`x1$)]; $CellContext`h$ = 2.35; $CellContext`hL$ = 
         If[$CellContext`cs$$ == 1, 0.3 $CellContext`leverL$ + 
           If[$CellContext`nA$$ > 3.1, 
              0.05 (($CellContext`nA$$ - 3.2)/(6 - 3.2)), 
              0] $CellContext`step$, 
           0.3 $CellContext`leverL$ (1 - 
            0.5 $CellContext`step$)]; $CellContext`piston$ = 
         If[$CellContext`cs$$ == 1, 
           
           If[$CellContext`nA$$ <= 
            3.1, $CellContext`h$ + ((
                1 - (1/3) ($CellContext`nA$$ - 
                 0.1)) ($CellContext`h$ - $CellContext`hL$) + \
$CellContext`hL$ - $CellContext`h$) $CellContext`step$, $CellContext`h$ + \
($CellContext`hL$ - $CellContext`h$) $CellContext`step$], $CellContext`h$ + 
           0.5 $CellContext`step$]; $CellContext`step$ = 
         If[$CellContext`cs$$ == 
           1, $CellContext`s1$$, $CellContext`s2$$]; $CellContext`add$ = (
           0.05 + 0.7 (($CellContext`nA$$ - 0.1)/(6 - 0.1))) (
           1 - $CellContext`step$); $CellContext`p1$ = Graphics[
           Inset[
            Graphics3D[{{
               Opacity[0.5], 
               Cylinder[{{0, 0, 0}, {0, 0, 2.75}}], 
               Cylinder[{{1, 0, 1.375}, {2, 0, 1.375}}, 0.13]}, {
               Opacity[0.75], 
               RGBColor[0.07, 1, 0.6], 
               Cylinder[{{0, 0, 0}, {0, 0, $CellContext`hL$}}], 
               
               Cylinder[{{1, 0, 1.375}, {1 + $CellContext`add$, 0, 1.375}}, 
                0.13]}, 
              
              Cylinder[{{1 + $CellContext`add$, 0, 1.375}, {
                2.1 + $CellContext`add$, 0, 1.375}}, 0.03], {Black, 
               
               Cylinder[{{2.1 + $CellContext`add$, 0, 1.375}, {
                 2.125 + $CellContext`add$, 0, 1.375}}, 0.14]}, {Gray, 
               
               Cylinder[{{0, 0, $CellContext`piston$}, {
                 0, 0, $CellContext`piston$ + 0.15}}], 
               
               Cylinder[{{0, 0, $CellContext`piston$ + 0.15}, {0, 0, 3}}, 
                0.11]}, 
              Text[
               Style[
                If[$CellContext`cs$$ == 1, 
                 If[$CellContext`s1$$ == 1, 
                  Row[{$CellContext`nA$$, " mol ", 
                    Style["n", Italic], "-octane added"}], 
                  Row[{"add ", $CellContext`nA$$, " mol ", 
                    Style["n", Italic], "-octane"}]], 
                 If[$CellContext`s2$$ == 1, 
                  Row[{$CellContext`nA$$, " mol ", 
                    Style["n", Italic], "-hexane added"}], 
                  Row[{"add ", $CellContext`nA$$, " mol ", 
                    Style["n", Italic], "-hexane"}]]], 18], {2, 0, 1}], 
              Text[
               Style[
                Which[
                 And[$CellContext`cs$$ == 1, $CellContext`s1$$ == 1], 
                 "vapor condenses", 
                 And[$CellContext`cs$$ == 2, $CellContext`s2$$ == 1], 
                 "liquid evaporates", True, ""], 18], {2, 0, 1.75}]}, 
             Lighting -> {{"Ambient", LightGray}}, Boxed -> False, ViewPoint -> 
             Front, PlotRange -> {{-1, 3.25}, {-1, 1}, {-0.1, 3}}, ImageSize -> 
             500]], ImageSize -> {500, 353}, 
           PlotRange -> {{-1, 3.25}, {-0.1, 3}}]; $CellContext`p2$ = Show[
           Plot[{
             $CellContext`Px$[$CellContext`x], 
             $CellContext`Py$[$CellContext`x]}, {$CellContext`x, 0, 1}, 
            PlotRange -> {{0, 1}, {0.01, 0.25}}, 
            PlotStyle -> {{Thick, Blue}, {Thick, 
               RGBColor[0.1, 0.6, 0]}}, Frame -> True, FrameLabel -> {
              Style[
               Row[{
                 Style["n", Italic], "-hexane mole fraction"}], 17], 
              Style["pressure (bar)", 17]}, LabelStyle -> {Black, 13}, 
            ImageSize -> {500, 353}, PlotRangeClipping -> False, 
            ImagePadding -> {{50, 50}, {52, 5}}], 
           Graphics[{
             Text[
              Style[
               Row[{"pure ", 
                 Style["n", Italic], "-octane"}], 14], {0., -0.025}], 
             Text[
              Style[
               Row[{"pure ", 
                 Style["n", Italic], "-hexane"}], 14], {1., -0.025}], 
             
             If[$CellContext`Px$[$CellContext`zPoint$] <= $CellContext`P$, {
              Thick, Dashed, Blue, 
               
               Line[{{$CellContext`zPoint$, $CellContext`P$}, \
{$CellContext`zPoint$, 0.01}}]}, {Thick, Dashed, {Blue, 
                
                Line[{{$CellContext`x1$, 
                   0.01}, {$CellContext`x1$, $CellContext`P$}, \
{$CellContext`zPoint$, $CellContext`P$}}]}, {
                RGBColor[0.1, 0.6, 0], 
                
                Line[{{$CellContext`zPoint$, $CellContext`P$}, \
{$CellContext`y1$, $CellContext`P$}, {$CellContext`y1$, 0.01}}]}}], {
              PointSize[0.02], 
              Point[{$CellContext`zPoint$, $CellContext`P$}]}}]]; Show[
          
          Switch[$CellContext`ptv$$, 1, $CellContext`p1$, 
           2, $CellContext`p2$]]], 
      "Specifications" :> {{{$CellContext`ptv$$, 1, ""}, {
         1 -> "piston\[Hyphen]cylinder", 2 -> Row[{
             Style["P-x-y", Italic], " diagram"}]}, ControlType -> Setter, 
         ControlPlacement -> 1}, {{$CellContext`cs$$, 1, ""}, {
         1 -> "add octane", 2 -> "add hexane"}, ControlType -> Setter, 
         ControlPlacement -> 2}, {{$CellContext`nA$$, 3.1, "add moles"}, 0.1, 
         6, 0.1, Appearance -> "Labeled", ControlPlacement -> 3}, 
        Column[{
          Manipulate`Place[1], 
          Manipulate`Place[2], 
          Manipulate`Place[3]}, Alignment -> 
         Left], {{$CellContext`s1$$, 0, "inject isothermally"}, 0, 1, 
         ControlType -> Trigger, AnimationRate -> 2, 
         AppearanceElements -> {"PlayPauseButton", "ResetButton"}, 
         ControlPlacement -> 
         4}, {{$CellContext`s2$$, 0, "inject isothermally"}, 0, 1, 
         ControlType -> Trigger, AnimationRate -> 2, 
         AppearanceElements -> {"PlayPauseButton", "ResetButton"}, 
         ControlPlacement -> 5}, 
        PaneSelector[{1 -> Manipulate`Place[4], 2 -> Manipulate`Place[5]}, 
         Dynamic[$CellContext`cs$$]]}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{551., {257., 264.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.633448191823501*^9, 3.633448244113492*^9, 3.6334483202578473`*^9, 
   3.6334483807153053`*^9, 3.6334486411702023`*^9, 3.633448684502681*^9, {
   3.633448864057951*^9, 3.633448892124556*^9}, {3.6334490151785946`*^9, 
   3.63344902471714*^9}, 3.6334491795189943`*^9, 3.6334515985163527`*^9, 
   3.6334528726142273`*^9, 3.633453224491353*^9, 3.633453453414447*^9, 
   3.633453778284028*^9, 3.6334539910641985`*^9, 3.6334541270649776`*^9, 
   3.6334542576134443`*^9, 3.633454380387467*^9, 3.63345443761674*^9, 
   3.6334544853894725`*^9, 3.6334545465129685`*^9, 3.6334548234008055`*^9, 
   3.633455285185218*^9, 3.6334553705981035`*^9, {3.633455681835905*^9, 
   3.6334557092274723`*^9}, 3.633455772142071*^9, 3.633455837382802*^9, 
   3.633456208859049*^9, 3.6334564129247212`*^9, 3.633456791496374*^9, 
   3.6334568410442085`*^9, 3.633457217077716*^9, 3.633457253458797*^9, 
   3.633457322676756*^9, 3.633457459971609*^9, {3.6334575805465055`*^9, 
   3.6334576374737616`*^9}, 3.633457850851966*^9, 3.633457950123644*^9, 
   3.6334580740207305`*^9, 3.633458117748232*^9, 3.6334581739874487`*^9, 
   3.6334582276865196`*^9, {3.6334582635405703`*^9, 3.633458279304472*^9}, 
   3.6334589793645134`*^9, {3.6334591530434475`*^9, 3.6334591645741067`*^9}, 
   3.6334593431693215`*^9, 3.633526601450449*^9, 3.633539125095761*^9, 
   3.6335392677779217`*^9, 3.6335393475834866`*^9, 3.6335396207041078`*^9, {
   3.633539843151831*^9, 3.633539854193463*^9}, 3.6335399206702647`*^9, 
   3.6335400242901917`*^9, 3.633540109594071*^9, 3.6335401834332943`*^9, 
   3.6335406228694286`*^9, 3.633540659394518*^9, 3.6335407771442523`*^9, 
   3.6335409842630987`*^9, 3.633541049597836*^9, {3.633541302048275*^9, 
   3.6335413229024677`*^9}, {3.6335413834839334`*^9, 3.6335414075333085`*^9}, 
   3.6335414582282085`*^9, 3.633541521343818*^9, 3.6335416093018494`*^9, {
   3.6335419206716585`*^9, 3.6335419550896273`*^9}, 3.6335421746801867`*^9, 
   3.6335422393628864`*^9, 3.6335424088505807`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Ref", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6334479226551056`*^9, 3.633447931580616*^9}}],

Cell[BoxData[
 RowBox[{"Framed", "[", 
  RowBox[{
   RowBox[{"Column", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "PsatH", ",", "PsatO", ",", "amtL", ",", "step", ",", "pto", ",", 
             "h", ",", "f", ",", "piston", ",", "zi", ",", "tank", ",", 
             "plotPxy"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"PsatH", "=", "0.247474"}], ";", "\[IndentingNewLine]", 
            RowBox[{"PsatO", "=", "0.024569"}], ";", "\[IndentingNewLine]", 
            RowBox[{"zi", "=", "0.0905"}], ";", "\[IndentingNewLine]", 
            RowBox[{"amtL", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"cs", "\[Equal]", "1"}], ",", 
               RowBox[{"0.182", "+", 
                RowBox[{"0.02", "*", "step"}]}], ",", 
               RowBox[{"0.182", "*", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "step"}], ")"}]}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"step", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"cs", "\[Equal]", "1"}], ",", "amt1", ",", "amt2"}], 
              "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"pto", "=", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"h", "=", "2.75"}], ";", "\[IndentingNewLine]", 
            RowBox[{"f", "=", 
             RowBox[{"Sequence", "[", 
              RowBox[{
               RowBox[{"FontSize", "\[Rule]", "18"}], ",", 
               RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"piston", "=", 
             RowBox[{"2.35", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"amtL", "*", "h"}], "-", "2.35"}], ")"}], "*", 
               "step"}]}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"tank", "=", 
             RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Inset", "[", "\[IndentingNewLine]", 
                RowBox[{"Graphics3D", "[", 
                 RowBox[{
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Opacity", "[", "0.5", "]"}], ",", 
                    RowBox[{"Cylinder", "[", 
                    RowBox[{"{", 
                    RowBox[{"pto", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "h"}], "}"}]}], "}"}], "]"}], 
                    ",", 
                    RowBox[{"Cylinder", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", 
                    RowBox[{"h", "/", "2"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "0", ",", 
                    RowBox[{"h", "/", "2"}]}], "}"}]}], "}"}], ",", "0.13"}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Opacity", "[", "0.75", "]"}], ",", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.07", ",", "1", ",", "0.6"}], "]"}], ",", 
                    RowBox[{"Cylinder", "[", 
                    RowBox[{"{", 
                    RowBox[{"pto", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"amtL", "*", "h"}]}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Cylinder", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", 
                    RowBox[{"h", "/", "2"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "+", 
                    RowBox[{"0.4", "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "step"}], ")"}]}]}], ",", "0", ",", 
                    RowBox[{"h", "/", "2"}]}], "}"}]}], "}"}], ",", "0.13"}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Cylinder", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "+", 
                    RowBox[{"0.4", "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "step"}], ")"}]}]}], ",", "0", ",", 
                    RowBox[{"h", "/", "2"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2.05", "+", 
                    RowBox[{"0.4", "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "step"}], ")"}]}]}], ",", "0", ",", 
                    RowBox[{"h", "/", "2"}]}], "}"}]}], "}"}], ",", "0.04"}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Black", ",", 
                    RowBox[{"Cylinder", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2.05", "+", 
                    RowBox[{"0.4", "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "step"}], ")"}]}]}], ",", "0", ",", 
                    RowBox[{"h", "/", "2"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2.075", "+", 
                    RowBox[{"0.4", "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "step"}], ")"}]}]}], ",", "0", ",", 
                    RowBox[{"h", "/", "2"}]}], "}"}]}], "}"}], ",", "0.14"}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Gray", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"cs", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cylinder", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "piston"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"2.5", "-", "2.35", "+", "piston"}]}], "}"}]}], 
                    "}"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Cylinder", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"2.5", "-", "2.35", "+", "piston"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "2.85"}], "}"}]}], "}"}], ",",
                     "0.1"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cylinder", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"2.35", "+", 
                    RowBox[{"0.25", "*", "step"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"2.5", "+", 
                    RowBox[{"0.25", "*", "step"}]}]}], "}"}]}], "}"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Cylinder", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"2.5", "+", 
                    RowBox[{"0.25", "*", "step"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "2.85"}], "}"}]}], "}"}], ",",
                     "0.1"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"cs", "\[Equal]", "1"}], ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"amt1", "\[Equal]", "1"}], ",", 
                    "\"\<all vapor condenses\>\"", ",", "\"\<\>\""}], "]"}], 
                    ",", 
                    RowBox[{"Evaluate", "@", "f"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2.2", ",", "0", ",", "1.75"}], "}"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"amt1", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<2 mol \>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<-octane added\>\""}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<add 2 mol \>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<-octane\>\""}], "}"}], "]"}]}], "]"}], ",", 
                    RowBox[{"Evaluate", "@", "f"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2.2", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"step", "\[GreaterEqual]", "0.8"}], ",", 
                    "\"\<\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<0.1 mol \>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<-hexane\>\""}], "}"}], "]"}], ",", "\"\<vapor\>\""}],
                     "}"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{"Evaluate", "@", "f"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"0.5", "*", "piston"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"0.55", "*", "amtL", "*", "h"}], "-", 
                    RowBox[{"0.5", "*", "piston"}]}], ")"}], "*", 
                    "step"}]}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"amt1", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<20.1 mol \>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<-hexane\>\""}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<20 mol \>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<-hexane\>\""}], "}"}], "]"}], ",", 
                    "\"\<liquid\>\""}], "}"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{"Evaluate", "@", "f"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"0.15", "+", 
                    RowBox[{"0.45", "*", "step"}]}], ")"}], "*", "amtL", "*", 
                    "h"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"amt1", "\[Equal]", "1"}], ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<2 mol \>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<-octane\>\""}], "}"}], "]"}], ",", "\"\<\>\""}], 
                    "]"}], ",", 
                    RowBox[{"Evaluate", "@", "f"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"0.1", "*", "amtL", "*", "h"}]}], "}"}]}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"amt2", "\[Equal]", "1"}], ",", 
                    "\"\<all liquid evaporates\>\"", ",", "\"\<\>\""}], "]"}],
                     ",", 
                    RowBox[{"Evaluate", "@", "f"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2.2", ",", "0", ",", "1.75"}], "}"}]}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"amt2", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<2 mol \>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<-hexane added\>\""}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<add 2 mol \>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<-hexane\>\""}], "}"}], "]"}]}], "]"}], ",", 
                    RowBox[{"Evaluate", "@", "f"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2.2", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"amt2", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<20.1 mol \>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<-octane\>\""}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<0.1 mol \>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<-octane\>\""}], "}"}], "]"}], ",", "\"\<vapor\>\""}],
                     "}"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{"Evaluate", "@", "f"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"amt2", "<", "1"}], ",", 
                    RowBox[{"0.5", "*", "2.35"}], ",", 
                    RowBox[{"h", "/", "2"}]}], "]"}]}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"amt2", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<2 mol \>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<-hexane\>\""}], "}"}], "]"}], ",", 
                    RowBox[{"Evaluate", "@", "f"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"0.45", "*", "2.35"}]}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Column", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<20 mol \>\"", ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<-octane\>\""}], "}"}], "]"}], ",", 
                    "\"\<liquid\>\""}], "}"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}], ",", 
                    RowBox[{"Evaluate", "@", "f"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"0.15", "*", "amtL", "*", "h", "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "step"}], ")"}]}]}], "}"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                    "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Lighting", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Ambient\>\"", ",", "LightGray"}], "}"}], 
                    "}"}]}], ",", 
                  RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
                  RowBox[{"ViewPoint", "\[Rule]", "Front"}], ",", 
                  RowBox[{"PlotRange", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "3.25"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "3"}], "}"}]}], "}"}]}], ",", 
                  RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}], 
                "\[IndentingNewLine]", "]"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "3.25"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "3"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"plotPxy", "=", 
             RowBox[{"Show", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Plot", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"x", "*", "PsatH"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "x"}], ")"}], "*", "PsatO"}]}], ",", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    FractionBox["x", "PsatH"], "+", 
                    FractionBox[
                    RowBox[{"1", "-", "x"}], "PsatO"]}], ")"}], 
                    RowBox[{"-", "1"}]]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                 RowBox[{"FrameLabel", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<-hexane mole fraction\>\""}], "}"}], "]"}], ",", 
                    "16"}], "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<pressure (bar)\>\"", ",", "16"}], "]"}]}], 
                   "}"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"LabelStyle", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"Black", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
                    "13"}], "}"}]}], ",", 
                 RowBox[{"PlotStyle", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Thick", ",", 
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.1", ",", "0.6", ",", "0"}], "]"}]}], "}"}]}], 
                   "}"}]}], ",", 
                 RowBox[{"ImageSize", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"400", ",", "282"}], "}"}]}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Graphics", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"cs", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"amt1", "\[Equal]", "1"}], ",", 
                    "\"\<all liquid\>\"", ",", "\"\<\>\""}], "]"}], ",", "18",
                     ",", 
                    RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.2", ",", "0.2"}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"amt2", "==", "1"}], ",", "\"\<all vapor\>\"", 
                    ",", "\"\<\>\""}], "]"}], ",", "18", ",", 
                    RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.8", ",", "0.025"}], "}"}]}], "]"}]}], "]"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"cs", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Thickness", "[", "0.0055", "]"}], ",", "Dashed", 
                    ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"zi", "*", "step"}]}], ",", "PsatH"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "PsatH"}], "}"}]}], "}"}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
                    RowBox[{"Point", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"zi", "*", "step"}]}], ",", "PsatH"}], "}"}], 
                    "]"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Thickness", "[", "0.0055", "]"}], ",", "Dashed", 
                    ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "PsatO"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"zi", "*", "step"}], ",", "PsatO"}], "}"}]}], 
                    "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
                    RowBox[{"Point", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"zi", "*", "step"}], ",", "PsatO"}], "}"}], 
                    "]"}]}], "}"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]",
                  "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Mouseover", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Show", "[", "tank", "]"}], ",", 
              RowBox[{"Show", "[", "plotPxy", "]"}]}], "\[IndentingNewLine]", 
             "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"cs", ",", "1", ",", 
              RowBox[{"Style", "[", 
               RowBox[{"\"\<component to inject\>\"", ",", "13", ",", 
                RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}]}],
              "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "\[Rule]", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<-octane\>\""}], "}"}], "]"}], ",", "13", ",", 
                 RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], 
                "]"}]}], ",", 
              RowBox[{"2", "\[Rule]", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<n\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<-hexane\>\""}], "}"}], "]"}], ",", "13", ",", 
                 RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], 
                "]"}]}]}], "}"}], ",", "Setter"}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PaneSelector", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Control", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"amt1", ",", "0", ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<inject isothermally\>\"", ",", "13", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], 
                    "]"}]}], "}"}], ",", "0", ",", "1", ",", "Trigger", ",", 
                 RowBox[{"AnimationRate", "\[Rule]", "1"}], ",", 
                 RowBox[{"AppearanceElements", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<PlayPauseButton\>\"", ",", "\"\<ResetButton\>\""}], 
                   "}"}]}]}], "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"2", "\[Rule]", 
              RowBox[{"Control", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"amt2", ",", "0", ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<inject isothermally\>\"", ",", "13", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], 
                    "]"}]}], "}"}], ",", "0", ",", "1", ",", "Trigger", ",", 
                 RowBox[{"AnimationRate", "\[Rule]", "1"}], ",", 
                 RowBox[{"AppearanceElements", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<PlayPauseButton\>\"", ",", "\"\<ResetButton\>\""}], 
                   "}"}]}]}], "}"}], "]"}]}]}], "\[IndentingNewLine]", "}"}], 
           ",", 
           RowBox[{"Dynamic", "@", "cs"}]}], "]"}]}], "\[IndentingNewLine]", 
        "]"}], ",", 
       RowBox[{"Text", "@", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Figure 11\>\"", ",", "16", ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", "Bold", 
          ",", 
          RowBox[{"Darker", "[", 
           RowBox[{"Cyan", ",", "0.65"}], "]"}]}], "]"}]}]}], "}"}], ",", 
     RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Lighter", "[", 
     RowBox[{"Gray", ",", "0.4"}], "]"}]}]}], "]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.633447931582616*^9}],

Cell[BoxData[
 FrameBox[
  TagBox[GridBox[{
     {
      TagBox[
       StyleBox[
        DynamicModuleBox[{$CellContext`amt1$$ = 0, $CellContext`amt2$$ = 
         0, $CellContext`cs$$ = 1, Typeset`show$$ = True, 
         Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
         Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
         "\"untitled\"", Typeset`specs$$ = {{{
            Hold[$CellContext`cs$$], 1, 
            Style["component to inject", 13, FontFamily -> "Arial"]}, {
           1 -> Style[
              Row[{
                Style["n", Italic], "-octane"}], 13, FontFamily -> "Arial"], 
            2 -> Style[
              Row[{
                Style["n", Italic], "-hexane"}], 13, FontFamily -> 
              "Arial"]}}, {{
            Hold[$CellContext`amt1$$], 0, 
            Style["inject isothermally", 13, FontFamily -> "Arial"]}, 0, 1}, {{
            Hold[$CellContext`amt2$$], 0, 
            Style["inject isothermally", 13, FontFamily -> "Arial"]}, 0, 1}, {
           Hold[
            PaneSelector[{1 -> Manipulate`Place[1], 2 -> Manipulate`Place[2]}, 
             Dynamic[$CellContext`cs$$]]], 
           Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
         400., {139., 143.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
         Typeset`skipInitDone$$ = True, $CellContext`cs$30529$$ = 
         False, $CellContext`amt1$30530$$ = 0, $CellContext`amt2$30531$$ = 0}, 
         DynamicBox[Manipulate`ManipulateBoxes[
          2, StandardForm, 
           "Variables" :> {$CellContext`amt1$$ = 0, $CellContext`amt2$$ = 
             0, $CellContext`cs$$ = 1}, "ControllerVariables" :> {
             Hold[$CellContext`cs$$, $CellContext`cs$30529$$, False], 
             Hold[$CellContext`amt1$$, $CellContext`amt1$30530$$, 0], 
             Hold[$CellContext`amt2$$, $CellContext`amt2$30531$$, 0]}, 
           "OtherVariables" :> {
            Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
             Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
             Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
             Typeset`initDone$$, Typeset`skipInitDone$$}, "Body" :> 
           Module[{$CellContext`PsatH$, $CellContext`PsatO$, \
$CellContext`amtL$, $CellContext`step$, $CellContext`pto$, $CellContext`h$, \
$CellContext`f$, $CellContext`piston$, $CellContext`zi$, $CellContext`tank$, \
$CellContext`plotPxy$}, $CellContext`PsatH$ = 0.247474; $CellContext`PsatO$ = 
              0.024569; $CellContext`zi$ = 0.0905; $CellContext`amtL$ = 
              If[$CellContext`cs$$ == 1, 0.182 + 0.02 $CellContext`step$, 
                0.182 (1 - $CellContext`step$)]; $CellContext`step$ = 
              If[$CellContext`cs$$ == 
                1, $CellContext`amt1$$, $CellContext`amt2$$]; \
$CellContext`pto$ = {0, 0, 0}; $CellContext`h$ = 2.75; $CellContext`f$ = 
              Sequence[
               FontSize -> 18, FontFamily -> "Arial"]; $CellContext`piston$ = 
              2.35 + ($CellContext`amtL$ $CellContext`h$ - 
                 2.35) $CellContext`step$; $CellContext`tank$ = Graphics[
                Inset[
                 Graphics3D[{{
                    Opacity[0.5], 
                    Cylinder[{$CellContext`pto$, {0, 0, $CellContext`h$}}], 
                    
                    Cylinder[{{1, 0, $CellContext`h$/2}, {
                    2, 0, $CellContext`h$/2}}, 0.13]}, {
                    Opacity[0.75], 
                    RGBColor[0.07, 1, 0.6], 
                    
                    Cylinder[{$CellContext`pto$, {
                    0, 0, $CellContext`amtL$ $CellContext`h$}}], 
                    
                    Cylinder[{{1, 0, $CellContext`h$/2}, {
                    1 + 0.4 (1 - $CellContext`step$), 0, $CellContext`h$/2}}, 
                    0.13]}, 
                   
                   Cylinder[{{
                    1 + 0.4 (1 - $CellContext`step$), 0, $CellContext`h$/2}, {
                    2.05 + 0.4 (1 - $CellContext`step$), 0, $CellContext`h$/
                    2}}, 0.04], {Black, 
                    
                    Cylinder[{{
                    2.05 + 0.4 (1 - $CellContext`step$), 0, $CellContext`h$/
                    2}, {2.075 + 0.4 (1 - $CellContext`step$), 
                    0, $CellContext`h$/2}}, 0.14]}, {Gray, 
                    If[$CellContext`cs$$ == 1, {
                    Cylinder[{{0, 0, $CellContext`piston$}, {
                    0, 0, 2.5 - 2.35 + $CellContext`piston$}}], 
                    
                    Cylinder[{{0, 0, 2.5 - 2.35 + $CellContext`piston$}, {
                    0, 0, 2.85}}, 0.1]}, {
                    
                    Cylinder[{{0, 0, 2.35 + 0.25 $CellContext`step$}, {
                    0, 0, 2.5 + 0.25 $CellContext`step$}}], 
                    
                    Cylinder[{{0, 0, 2.5 + 0.25 $CellContext`step$}, {
                    0, 0, 2.85}}, 0.1]}]}, 
                   If[$CellContext`cs$$ == 1, {
                    Text[
                    Style[
                    If[$CellContext`amt1$$ == 1, "all vapor condenses", ""], 
                    Evaluate[$CellContext`f$]], {2.2, 0, 1.75}], 
                    Text[
                    Style[
                    If[$CellContext`amt1$$ == 1, 
                    Row[{"2 mol ", 
                    Style["n", Italic], "-octane added"}], 
                    Row[{"add 2 mol ", 
                    Style["n", Italic], "-octane"}]], 
                    Evaluate[$CellContext`f$]], {2.2, 0, 1}], 
                    Text[
                    Style[
                    If[$CellContext`step$ >= 0.8, "", 
                    Column[{
                    Row[{"0.1 mol ", 
                    Style["n", Italic], "-hexane"}], "vapor"}, Alignment -> 
                    Center]], 
                    Evaluate[$CellContext`f$]], {
                    0, 0, 0.5 $CellContext`piston$ + ((
                    0.55 $CellContext`amtL$) $CellContext`h$ - 
                    0.5 $CellContext`piston$) $CellContext`step$}], 
                    Text[
                    Style[
                    If[$CellContext`amt1$$ == 1, 
                    Row[{"20.1 mol ", 
                    Style["n", Italic], "-hexane"}], 
                    Column[{
                    Row[{"20 mol ", 
                    Style["n", Italic], "-hexane"}], "liquid"}, Alignment -> 
                    Center]], 
                    Evaluate[$CellContext`f$]], {
                    0, 0, ((0.15 + 
                    0.45 $CellContext`step$) $CellContext`amtL$) \
$CellContext`h$}], 
                    Text[
                    Style[
                    If[$CellContext`amt1$$ == 1, 
                    Row[{"2 mol ", 
                    Style["n", Italic], "-octane"}], ""], 
                    Evaluate[$CellContext`f$]], {
                    0, 0, (0.1 $CellContext`amtL$) $CellContext`h$}]}, {
                    Text[
                    Style[
                    If[$CellContext`amt2$$ == 1, "all liquid evaporates", ""], 
                    Evaluate[$CellContext`f$]], {2.2, 0, 1.75}], 
                    Text[
                    Style[
                    If[$CellContext`amt2$$ == 1, 
                    Row[{"2 mol ", 
                    Style["n", Italic], "-hexane added"}], 
                    Row[{"add 2 mol ", 
                    Style["n", Italic], "-hexane"}]], 
                    Evaluate[$CellContext`f$]], {2.2, 0, 1}], 
                    Text[
                    Style[
                    If[$CellContext`amt2$$ == 1, 
                    Row[{"20.1 mol ", 
                    Style["n", Italic], "-octane"}], 
                    Column[{
                    Row[{"0.1 mol ", 
                    Style["n", Italic], "-octane"}], "vapor"}, Alignment -> 
                    Center]], 
                    Evaluate[$CellContext`f$]], {0, 0, 
                    
                    If[$CellContext`amt2$$ < 1, 0.5 2.35, $CellContext`h$/
                    2]}], 
                    If[$CellContext`amt2$$ == 1, 
                    Text[
                    Style[
                    Row[{"2 mol ", 
                    Style["n", Italic], "-hexane"}], 
                    Evaluate[$CellContext`f$]], {0, 0, 0.45 2.35}], 
                    Text[
                    Style[
                    Column[{
                    Row[{"20 mol ", 
                    Style["n", Italic], "-octane"}], "liquid"}, Alignment -> 
                    Center], 
                    Evaluate[$CellContext`f$]], {
                    0, 0, ((0.15 $CellContext`amtL$) $CellContext`h$) (
                    1 - $CellContext`step$)}]]}]}, 
                  Lighting -> {{"Ambient", LightGray}}, Boxed -> False, 
                  ViewPoint -> Front, 
                  PlotRange -> {{-1, 3.25}, {-1, 1}, {0, 3}}, ImageSize -> 
                  400]], PlotRange -> {{-1, 3.25}, {0, 3}}, ImageSize -> 
                400]; $CellContext`plotPxy$ = Show[
                
                Plot[{$CellContext`x $CellContext`PsatH$ + (
                    1 - $CellContext`x) $CellContext`PsatO$, \
($CellContext`x/$CellContext`PsatH$ + (
                    1 - $CellContext`x)/$CellContext`PsatO$)^(-1)}, \
{$CellContext`x, 0, 1}, Frame -> True, FrameLabel -> {
                   Style[
                    Row[{
                    Style["n", Italic], "-hexane mole fraction"}], 16], 
                   Style["pressure (bar)", 16]}, 
                 LabelStyle -> {Black, FontFamily -> "Arial", 13}, 
                 PlotStyle -> {{Thick, Blue}, {Thick, 
                    RGBColor[0.1, 0.6, 0]}}, ImageSize -> {400, 282}], 
                Graphics[{
                  If[$CellContext`cs$$ == 1, 
                   Text[
                    Style[
                    If[$CellContext`amt1$$ == 1, "all liquid", ""], 18, 
                    GrayLevel[0.4], FontFamily -> "Arial"], {0.2, 0.2}], 
                   Text[
                    Style[
                    If[$CellContext`amt2$$ == 1, "all vapor", ""], 18, 
                    GrayLevel[0.4], FontFamily -> "Arial"], {0.8, 0.025}]], 
                  If[$CellContext`cs$$ == 1, {{
                    Thickness[0.0055], Dashed, 
                    
                    Line[{{1 - $CellContext`zi$ $CellContext`step$, \
$CellContext`PsatH$}, {1, $CellContext`PsatH$}}]}, {
                    PointSize[0.02], 
                    
                    Point[{1 - $CellContext`zi$ $CellContext`step$, \
$CellContext`PsatH$}]}}, {{
                    Thickness[0.0055], Dashed, 
                    
                    Line[{{0, $CellContext`PsatO$}, {$CellContext`zi$ \
$CellContext`step$, $CellContext`PsatO$}}]}, {
                    PointSize[0.02], 
                    
                    Point[{$CellContext`zi$ $CellContext`step$, \
$CellContext`PsatO$}]}}]}]]; Mouseover[
               Show[$CellContext`tank$], 
               Show[$CellContext`plotPxy$]]], 
           "Specifications" :> {{{$CellContext`cs$$, 1, 
               Style["component to inject", 13, FontFamily -> "Arial"]}, {
              1 -> Style[
                 Row[{
                   Style["n", Italic], "-octane"}], 13, FontFamily -> 
                 "Arial"], 2 -> Style[
                 Row[{
                   Style["n", Italic], "-hexane"}], 13, FontFamily -> 
                 "Arial"]}, ControlType -> Setter}, {{$CellContext`amt1$$, 0, 
               Style["inject isothermally", 13, FontFamily -> "Arial"]}, 0, 1,
               ControlType -> Trigger, AnimationRate -> 1, 
              AppearanceElements -> {"PlayPauseButton", "ResetButton"}, 
              ControlPlacement -> 1}, {{$CellContext`amt2$$, 0, 
               Style["inject isothermally", 13, FontFamily -> "Arial"]}, 0, 1,
               ControlType -> Trigger, AnimationRate -> 1, 
              AppearanceElements -> {"PlayPauseButton", "ResetButton"}, 
              ControlPlacement -> 2}, 
             
             PaneSelector[{
              1 -> Manipulate`Place[1], 2 -> Manipulate`Place[2]}, 
              Dynamic[$CellContext`cs$$]]}, "Options" :> {}, 
           "DefaultOptions" :> {}],
          ImageSizeCache->{451., {197., 204.}},
          SingleEvaluation->True],
         Deinitialization:>None,
         DynamicModuleValues:>{},
         SynchronousInitialization->True,
         UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
         UnsavedVariables:>{Typeset`initDone$$},
         UntrackedVariables:>{Typeset`size$$}], "Manipulate",
        Deployed->True,
        StripOnInput->False],
       Manipulate`InterpretManipulate[1]]},
     {
      InterpretationBox[Cell[BoxData[
        FormBox[
         StyleBox["\<\"Figure 11\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0., 0.35, 0.35],
          FrontFaceColor->RGBColor[0., 0.35, 0.35],
          BackFaceColor->RGBColor[0., 0.35, 0.35],
          GraphicsColor->RGBColor[0., 0.35, 0.35],
          FontFamily->"Arial",
          FontSize->16,
          FontWeight->Bold,
          FontColor->RGBColor[0., 0.35, 0.35]], TextForm]], "InlineText"],
       Text[
        Style["Figure 11", 16, FontFamily -> "Arial", Bold, 
         RGBColor[0., 0.35, 0.35]]]]}
    },
    DefaultBaseStyle->"Column",
    GridBoxAlignment->{"Columns" -> {{Center}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Column"],
  FrameStyle->RGBColor[0.7, 0.7, 0.7],
  StripOnInput->False]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.633447035936388*^9, 3.633447931582616*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{"(*", 
   RowBox[{"vL", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"N", "[", 
       RowBox[{"1", "/", "655"}], "]"}], "\[IndentingNewLine]", "vV"}], "=", 
     RowBox[{"N", "[", 
      RowBox[{"1", "/", "0.4139"}], "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"vL", "=", "0.001527"}], ";", "\[IndentingNewLine]", 
    RowBox[{"vV", "=", "2.416"}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"L", "=", "0.87"}], ";", "\[IndentingNewLine]", 
    RowBox[{"V", "=", "0.13"}], ";", "\[IndentingNewLine]", 
    RowBox[{"l", "=", 
     RowBox[{"L", "*", 
      RowBox[{"vL", "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"L", "*", "vL"}], "+", 
         RowBox[{"V", "*", "vV"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"v", "=", 
     RowBox[{"V", "*", 
      RowBox[{"vV", "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"L", "*", "vL"}], "+", 
         RowBox[{"V", "*", "vV"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Graphics", "[", 
     RowBox[{
      RowBox[{"Text", "[", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Grid", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<liq =\>\"", ",", "l"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<vap =\>\"", ",", "v"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<sum =\>\"", ",", 
              RowBox[{"l", "+", "v"}]}], "}"}]}], "}"}], "]"}], ",", "16"}], 
        "]"}], "]"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"200", ",", "100"}], "}"}]}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vL", ",", "0.001527", ",", "\"\<vL\>\""}], "}"}], ",", 
     "0.0015", ",", "0.1", ",", "0.0001", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vV", ",", "2.416", ",", "\"\<vV\>\""}], "}"}], ",", "1", ",", 
     "5", ",", "0.001", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6334499468578835`*^9, 3.633450352797102*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`vL$$ = 
    0.05420000000000008, $CellContext`vV$$ = 2.4179999999999997`, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`vL$$], 0.001527, "vL"}, 0.0015, 0.1, 0.0001}, {{
       Hold[$CellContext`vV$$], 2.416, "vV"}, 1, 5, 0.001}}, 
    Typeset`size$$ = {200., {48., 52.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`vL$41696$$ = 0, $CellContext`vV$41697$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`vL$$ = 0.001527, $CellContext`vV$$ = 
        2.416}, "ControllerVariables" :> {
        Hold[$CellContext`vL$$, $CellContext`vL$41696$$, 0], 
        Hold[$CellContext`vV$$, $CellContext`vV$41697$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`L = 0.87; $CellContext`V = 
        0.13; $CellContext`l = $CellContext`L \
($CellContext`vL$$/($CellContext`L $CellContext`vL$$ + $CellContext`V \
$CellContext`vV$$)); $CellContext`v = $CellContext`V \
($CellContext`vV$$/($CellContext`L $CellContext`vL$$ + $CellContext`V \
$CellContext`vV$$)); Graphics[
         Text[
          Style[
           
           Grid[{{"liq =", $CellContext`l}, {"vap =", $CellContext`v}, {
             "sum =", $CellContext`l + $CellContext`v}}], 16]], 
         ImageSize -> {200, 100}]), 
      "Specifications" :> {{{$CellContext`vL$$, 0.001527, "vL"}, 0.0015, 0.1, 
         0.0001, Appearance -> "Labeled"}, {{$CellContext`vV$$, 2.416, "vV"}, 
         1, 5, 0.001, Appearance -> "Labeled"}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{310., {107., 114.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.6334500762682853`*^9, {3.633450108156109*^9, 3.6334501366547394`*^9}, {
   3.633450332274928*^9, 3.633450353329132*^9}}]
}, Open  ]]
},
WindowSize->{1366, 686},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 31129, 705, 2061, "Input"],
Cell[31712, 729, 13619, 256, 538, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45368, 990, 140, 2, 30, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[45511, 994, 33167, 723, 1865, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[78681, 1719, 13652, 283, 452, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[CellGroupData[{
Cell[92370, 2007, 2372, 66, 232, "Input"],
Cell[94745, 2075, 2630, 53, 238, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
