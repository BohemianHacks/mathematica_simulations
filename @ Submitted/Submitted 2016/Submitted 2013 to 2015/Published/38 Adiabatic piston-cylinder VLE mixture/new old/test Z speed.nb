(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     51361,       1319]
NotebookOptionsPosition[     50785,       1296]
NotebookOutlinePosition[     51124,       1311]
CellTagsIndexPosition[     51081,       1308]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"pvL", ":=", 
   RowBox[{"{", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vL", ",", " ", "P"}], "}"}], ","}], "*)"}], 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"18.79", ",", "0.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"20.41", ",", "1.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"21.28", ",", "2.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"21.99", ",", "3.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"22.63", ",", "4.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"23.23", ",", "5.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"23.83", ",", "6.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"24.41", ",", "7.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"25.", ",", "8.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"25.61", ",", "9.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"26.23", ",", "10.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"26.88", ",", "11.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"27.57", ",", "12.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"28.3", ",", "13.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"29.08", ",", "14.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"29.94", ",", "15.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"30.90", ",", "16.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"31.99", ",", "17.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"33.29", ",", "18.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"34.89", ",", "19.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"36.99", ",", "20.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"40.14", ",", "21.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"40.59", ",", "21.2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"41.09", ",", "21.3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"41.64", ",", "21.40"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"42.28", ",", "21.5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"43.02", ",", "21.6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"43.91", ",", "21.7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"45.01", ",", "21.8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"46.45", ",", "21.90"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"48.72", ",", "22."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"55.95", ",", "22.06"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pvV", ":=", 
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vV", ",", " ", "P"}], "}"}], ","}], "*)"}], 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"30517.", ",", "0.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"29162.", ",", "0.106"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"27162.", ",", "0.114"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"25162.", ",", "0.124"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"23162.", ",", "0.134"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"21162.", ",", "0.148"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"19162.", ",", "0.165"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"17162.", ",", "0.185"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"15162.", ",", "0.211"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"13162.", ",", "0.246"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"11162.", ",", "0.293"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"9162.", ",", "0.361"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"7162.", ",", "0.47"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5162.", ",", "0.665"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4662.", ",", "0.74"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4162.", ",", "0.834"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3662.", ",", "0.954"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3162.", ",", "1.113"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2662.", ",", "1.331"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2162.", ",", "1.651"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1662.", ",", "2.162"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1162.", ",", "3.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"874.2", ",", "4.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"695.89", ",", "5.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"574.14", ",", "6.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"485.45", ",", "7.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"417.78", ",", "8.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"364.29", ",", "9.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"320.84", ",", "10.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"284.72", ",", "11.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"254.12", ",", "12.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"227.77", ",", "13.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"204.73", ",", "14.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"184.31", ",", "15.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"165.94", ",", "16.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"149.19", ",", "17.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"133.63", ",", "18.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"118.83", ",", "19.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"104.18", ",", "20.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"88.27", ",", "21.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"86.47", ",", "21.2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"84.61", ",", "21.3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"82.65", ",", "21.40"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"80.59", ",", "21.5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"78.38", ",", "21.6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"75.98", ",", "21.7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"73.29", ",", "21.8"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"70.10", ",", "21.90"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"65.71", ",", "22."}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"55.95", ",", "22.06"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PV", ":=", 
    RowBox[{"Interpolation", "[", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"Join", "[", 
       RowBox[{"pvL", ",", 
        RowBox[{"Reverse", "[", "pvV", "]"}]}], "]"}], "]"}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"P", "[", "V", "]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VPL", ":=", 
    RowBox[{"Quiet", "@", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"Map", "[", 
       RowBox[{"Reverse", ",", "pvL"}], "]"}], "]"}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    SuperscriptBox["V", "L"], "[", "P", "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VPV", ":=", 
    RowBox[{"Quiet", "@", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"Map", "[", 
       RowBox[{"Reverse", ",", "pvV"}], "]"}], "]"}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    SuperscriptBox["V", "V"], "[", "P", "]"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hvap", ":=", 
   RowBox[{"Quiet", "@", 
    RowBox[{"Interpolation", "[", 
     RowBox[{"{", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"T", ",", " ", "Hvap"}], "}"}], ","}], "*)"}], 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"273.", ",", "45054."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"298.", ",", "43990."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"313.", ",", "43350."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"333.", ",", "42482."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"353.", ",", "41585."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"373.", ",", "40657."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"393.", ",", "39684."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"413.", ",", "38643."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"433.", ",", "37518."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"453.", ",", "36304."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"473.", ",", "34962."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"493.", ",", "33468."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"513.", ",", "31809."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"533.", ",", "29930."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"553.", ",", "27795."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"573.", ",", "25300."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"593.", ",", "22297."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"613.", ",", "18502."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"633.", ",", "12966."}], "}"}]}], "}"}], "]"}]}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.65194665186677*^9, 3.651946711675191*^9}, {
   3.6519470100412564`*^9, 3.651947040740012*^9}, 3.653225345711525*^9, {
   3.6532254290982943`*^9, 3.6532254326334963`*^9}, {3.653225467761506*^9, 
   3.6532255157352495`*^9}, {3.653225565637104*^9, 3.653225566778169*^9}, 
   3.6532285418413334`*^9, {3.653319691603228*^9, 3.6533197109033318`*^9}, {
   3.653674296065611*^9, 3.653674314183647*^9}, {3.6536743694028053`*^9, 
   3.653674370659878*^9}},
 CellID->106716937],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "R", ",", "Pref", ",", "Tref", ",", "Pc", ",", "Tc", ",", "CpA", ",", 
       "CpB", ",", "CpC", ",", "CpD", ",", "\[Kappa]", ",", "A", ",", "B", 
       ",", "a2", ",", "a1", ",", "a0", ",", "f", ",", "q", ",", "p", ",", 
       "r", ",", "Zmin", ",", "Zmax", ",", "Z", ",", "Hdepref", ",", 
       "Sdepref", ",", "Hig", ",", "Sig", ",", "Hdep", ",", "Sdep", ",", "H", 
       ",", "S", ",", "P1", ",", "T1", ",", "q1", ",", "S1", ",", "sol"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"R", "=", "8.314"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Pref", "=", "0.1"}], ";", 
      RowBox[{"Tref", "=", "298"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Pc", "=", "22.12"}], ";", 
      RowBox[{"Tc", "=", "647.3"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"CpA", "=", "32.24"}], ";", 
      RowBox[{"CpB", "=", "0.001924"}], ";", 
      RowBox[{"CpC", "=", "1.055*^-5"}], ";", 
      RowBox[{"CpD", "=", 
       RowBox[{"-", "3.596*^-9"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Kappa]", ":=", 
       RowBox[{"0.37464", "+", 
        RowBox[{"1.54226", "*", 
         RowBox[{"(", "0.344", ")"}]}], "-", 
        RowBox[{"0.26992", "*", 
         SuperscriptBox[
          RowBox[{"(", "0.344", ")"}], "2"]}]}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
       RowBox[{"0.4572355289", "*", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"\[Kappa]", "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SqrtBox[
               RowBox[{"T", "/", "Tc"}]]}], ")"}]}]}], ")"}], "2"], "*", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["Tc", "T"], ")"}], "2"], "*", 
        FractionBox["P", "Pc"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"B", "[", 
        RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
       RowBox[{"0.0777960739", "*", 
        FractionBox["Tc", "T"], "*", 
        FractionBox["P", "Pc"]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a2", "[", 
        RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"B", "[", 
         RowBox[{"T", ",", "P"}], "]"}], "-", "1"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a1", "[", 
        RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"T", ",", "P"}], "]"}], "-", 
        RowBox[{"3", "*", 
         SuperscriptBox[
          RowBox[{"B", "[", 
           RowBox[{"T", ",", "P"}], "]"}], "2"]}], "-", 
        RowBox[{"2", "*", 
         RowBox[{"B", "[", 
          RowBox[{"T", ",", "P"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a0", "[", 
        RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"A", "[", 
            RowBox[{"T", ",", "P"}], "]"}], "*", 
           RowBox[{"B", "[", 
            RowBox[{"T", ",", "P"}], "]"}]}], "-", 
          SuperscriptBox[
           RowBox[{"B", "[", 
            RowBox[{"T", ",", "P"}], "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{"B", "[", 
            RowBox[{"T", ",", "P"}], "]"}], "3"]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"T_", ",", "P_", ",", "z_"}], "]"}], ":=", 
       RowBox[{"P", "*", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"T", ",", "P"}], "]"}], "-", "1", "-", 
          RowBox[{"Log", "[", 
           RowBox[{
            RowBox[{"z", "[", 
             RowBox[{"T", ",", "P"}], "]"}], "-", 
            RowBox[{"B", "[", 
             RowBox[{"T", ",", "P"}], "]"}]}], "]"}], "-", 
          RowBox[{
           FractionBox[
            RowBox[{"A", "[", 
             RowBox[{"T", ",", "P"}], "]"}], 
            RowBox[{"2.8284", "*", 
             RowBox[{"B", "[", 
              RowBox[{"T", ",", "P"}], "]"}]}]], "*", 
           RowBox[{"Log", "[", 
            FractionBox[
             RowBox[{
              RowBox[{"z", "[", 
               RowBox[{"T", ",", "P"}], "]"}], "+", 
              RowBox[{"2.4142", "*", 
               RowBox[{"B", "[", 
                RowBox[{"T", ",", "P"}], "]"}]}]}], 
             RowBox[{
              RowBox[{"z", "[", 
               RowBox[{"T", ",", "P"}], "]"}], "-", 
              RowBox[{"0.4142", "*", 
               RowBox[{"B", "[", 
                RowBox[{"T", ",", "P"}], "]"}]}]}]], "]"}]}]}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"q", "[", 
        RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "*", 
           SuperscriptBox[
            RowBox[{"a2", "[", 
             RowBox[{"T", ",", "P"}], "]"}], "3"]}], "-", 
          RowBox[{"9", "*", 
           RowBox[{"a2", "[", 
            RowBox[{"T", ",", "P"}], "]"}], "*", 
           RowBox[{"a1", "[", 
            RowBox[{"T", ",", "P"}], "]"}]}], "+", 
          RowBox[{"27", "*", 
           RowBox[{"a0", "[", 
            RowBox[{"T", ",", "P"}], "]"}]}]}], ")"}], "/", "27"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", "*", 
           RowBox[{"a1", "[", 
            RowBox[{"T", ",", "P"}], "]"}]}], "-", 
          SuperscriptBox[
           RowBox[{"a2", "[", 
            RowBox[{"T", ",", "P"}], "]"}], "2"]}], ")"}], "/", "3"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
       RowBox[{
        FractionBox[
         SuperscriptBox[
          RowBox[{"q", "[", 
           RowBox[{"T", ",", "P"}], "]"}], "2"], "4"], "+", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"p", "[", 
           RowBox[{"T", ",", "P"}], "]"}], "3"], "27"]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Zmin", "[", 
        RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"2", "*", 
         SqrtBox[
          RowBox[{
           RowBox[{"-", 
            RowBox[{"p", "[", 
             RowBox[{"T", ",", "P"}], "]"}]}], "/", "3"}]], "*", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ArcCos", "[", 
             FractionBox[
              RowBox[{"3", "*", 
               RowBox[{"q", "[", 
                RowBox[{"T", ",", "P"}], "]"}]}], 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"T", ",", "P"}], "]"}], "*", "2", "*", 
               SqrtBox[
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"p", "[", 
                   RowBox[{"T", ",", "P"}], "]"}]}], "/", "3"}]]}]], "]"}], 
            "/", "3"}], "+", 
           RowBox[{"2", "*", 
            RowBox[{"\[Pi]", "/", "3"}]}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"a2", "[", 
          RowBox[{"T", ",", "P"}], "]"}], "/", "3"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Zmax", "[", 
        RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"2", "*", 
         SqrtBox[
          RowBox[{
           RowBox[{"-", 
            RowBox[{"p", "[", 
             RowBox[{"T", ",", "P"}], "]"}]}], "/", "3"}]], "*", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"ArcCos", "[", 
            FractionBox[
             RowBox[{"3", "*", 
              RowBox[{"q", "[", 
               RowBox[{"T", ",", "P"}], "]"}]}], 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"T", ",", "P"}], "]"}], "*", "2", "*", 
              SqrtBox[
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"p", "[", 
                  RowBox[{"T", ",", "P"}], "]"}]}], "/", "3"}]]}]], "]"}], 
           "/", "3"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"a2", "[", 
          RowBox[{"T", ",", "P"}], "]"}], "/", "3"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Z", "[", 
        RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"CubeRoot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"q", "[", 
                  RowBox[{"T", ",", "P"}], "]"}]}], "/", "2"}], "+", 
               SqrtBox[
                RowBox[{"r", "[", 
                 RowBox[{"T", ",", "P"}], "]"}]]}], "]"}], "+", 
             RowBox[{"CubeRoot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"q", "[", 
                  RowBox[{"T", ",", "P"}], "]"}]}], "/", "2"}], "-", 
               SqrtBox[
                RowBox[{"r", "[", 
                 RowBox[{"T", ",", "P"}], "]"}]]}], "]"}], "-", 
             RowBox[{
              RowBox[{"a2", "[", 
               RowBox[{"T", ",", "P"}], "]"}], "/", "3"}]}], ",", 
            RowBox[{
             RowBox[{"r", "[", 
              RowBox[{"T", ",", "P"}], "]"}], ">", "0"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"f", "[", 
                RowBox[{"T", ",", "P", ",", "Zmin"}], "]"}], "<", 
               RowBox[{"f", "[", 
                RowBox[{"T", ",", "P", ",", "Zmax"}], "]"}]}], ",", 
              RowBox[{"Zmin", "[", 
               RowBox[{"T", ",", "P"}], "]"}], ",", 
              RowBox[{"Zmax", "[", 
               RowBox[{"T", ",", "P"}], "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"r", "[", 
              RowBox[{"T", ",", "P"}], "]"}], "\[LessEqual]", "0"}]}], 
           "}"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Hdepref", "=", 
       RowBox[{"-", "45729.2"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"J", "/", "mol"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Sdepref", "=", 
       RowBox[{"-", "123.285"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"J", "/", "mol"}], "/", "K"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Hig", "[", "T_", "]"}], ":=", 
       RowBox[{
        RowBox[{"CpA", "*", 
         RowBox[{"(", 
          RowBox[{"T", "-", "Tref"}], ")"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], "*", "CpB", "*", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["T", "2"], "-", 
           SuperscriptBox["Tref", "2"]}], ")"}]}], "+", 
        RowBox[{
         FractionBox["1", "3"], "*", "CpC", "*", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["T", "3"], "-", 
           SuperscriptBox["Tref", "3"]}], ")"}]}], "+", 
        RowBox[{
         FractionBox["1", "4"], "*", "CpD", "*", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["T", "4"], "-", 
           SuperscriptBox["Tref", "4"]}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sig", "[", 
        RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"CpA", "*", 
         RowBox[{"Log", "[", 
          RowBox[{"T", "/", "Tref"}], "]"}]}], "+", 
        RowBox[{"CpB", "*", 
         RowBox[{"(", 
          RowBox[{"T", "-", "Tref"}], ")"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], "*", "CpC", "*", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["T", "2"], "-", 
           SuperscriptBox["Tref", "2"]}], ")"}]}], "+", 
        RowBox[{
         FractionBox["1", "3"], "*", "CpD", "*", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["T", "3"], "-", 
           SuperscriptBox["Tref", "3"]}], ")"}]}], "-", 
        RowBox[{"R", "*", 
         RowBox[{"Log", "[", 
          RowBox[{"P", "/", "Pref"}], "]"}]}]}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Hdep", "[", 
        RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
       RowBox[{"R", "*", "T", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Z", "[", 
           RowBox[{"T", ",", "P"}], "]"}], "-", "1", "-", 
          RowBox[{
           FractionBox[
            RowBox[{"A", "[", 
             RowBox[{"T", ",", "P"}], "]"}], 
            RowBox[{"2.8284", "*", 
             RowBox[{"B", "[", 
              RowBox[{"T", ",", "P"}], "]"}]}]], "*", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"\[Kappa]", "*", 
              SqrtBox[
               FractionBox[
                RowBox[{"T", "/", "Tc"}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{"\[Kappa]", "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    SqrtBox[
                    RowBox[{"T", "/", "Tc"}]]}], ")"}]}]}], ")"}], "2"]]]}]}],
             ")"}], "*", 
           RowBox[{"Log", "[", 
            FractionBox[
             RowBox[{
              RowBox[{"Z", "[", 
               RowBox[{"T", ",", "P"}], "]"}], "+", 
              RowBox[{"2.4142", "*", 
               RowBox[{"B", "[", 
                RowBox[{"T", ",", "P"}], "]"}]}]}], 
             RowBox[{
              RowBox[{"Z", "[", 
               RowBox[{"T", ",", "P"}], "]"}], "-", 
              RowBox[{"0.4142", "*", 
               RowBox[{"B", "[", 
                RowBox[{"T", ",", "P"}], "]"}]}]}]], "]"}]}]}], ")"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sdep", "[", 
        RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"R", "*", 
         RowBox[{"Log", "[", 
          RowBox[{
           RowBox[{"Z", "[", 
            RowBox[{"T", ",", "P"}], "]"}], "-", 
           RowBox[{"B", "[", 
            RowBox[{"T", ",", "P"}], "]"}]}], "]"}]}], "-", 
        RowBox[{"R", "*", 
         FractionBox[
          RowBox[{"A", "[", 
           RowBox[{"T", ",", "P"}], "]"}], 
          RowBox[{"2.8284", "*", 
           RowBox[{"B", "[", 
            RowBox[{"T", ",", "P"}], "]"}]}]], "*", "\[Kappa]", "*", 
         SqrtBox[
          FractionBox[
           RowBox[{"T", "/", "Tc"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"\[Kappa]", "*", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 SqrtBox[
                  RowBox[{"T", "/", "Tc"}]]}], ")"}]}]}], ")"}], "2"]]], "*", 
         RowBox[{"Log", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"Z", "[", 
             RowBox[{"T", ",", "P"}], "]"}], "+", 
            RowBox[{"2.4142", "*", 
             RowBox[{"B", "[", 
              RowBox[{"T", ",", "P"}], "]"}]}]}], 
           RowBox[{
            RowBox[{"Z", "[", 
             RowBox[{"T", ",", "P"}], "]"}], "-", 
            RowBox[{"0.4142", "*", 
             RowBox[{"B", "[", 
              RowBox[{"T", ",", "P"}], "]"}]}]}]], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"H", "[", 
        RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Hdep", "[", 
         RowBox[{"T", ",", "P"}], "]"}], "-", "Hdepref", "+", 
        RowBox[{"Hig", "[", "T", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Sdep", "[", 
         RowBox[{"T", ",", "P"}], "]"}], "-", "Sdepref", "+", 
        RowBox[{"Sig", "[", 
         RowBox[{"T", ",", "P"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"P1", "=", "1.25"}], ";", 
      RowBox[{"T1", ":=", "459.4"}], ";", "\[IndentingNewLine]", 
      RowBox[{"q1", ":=", 
       FractionBox[
        RowBox[{"V1", "-", 
         RowBox[{"VPL", "[", "P1", "]"}]}], 
        RowBox[{
         RowBox[{"VPV", "[", "P1", "]"}], "-", 
         RowBox[{"VPL", "[", "P1", "]"}]}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"S1", ":=", 
       RowBox[{
        RowBox[{"S", "[", 
         RowBox[{"T1", ",", "P1"}], "]"}], "+", 
        RowBox[{"q1", "*", 
         FractionBox[
          RowBox[{"Hvap", "[", "T1", "]"}], "T1"]}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"sol", ":=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t2", ",", "v2"}], "}"}], "/.", 
        RowBox[{"Quiet", "@", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"S1", "\[Equal]", 
              RowBox[{
               RowBox[{"S", "[", 
                RowBox[{"t2", ",", "P2"}], "]"}], "+", 
               RowBox[{
                FractionBox[
                 RowBox[{"v2", "-", 
                  RowBox[{"VPL", "[", "P2", "]"}]}], 
                 RowBox[{
                  RowBox[{"VPV", "[", "P2", "]"}], "-", 
                  RowBox[{"VPL", "[", "P2", "]"}]}]], "*", 
                FractionBox[
                 RowBox[{"Hvap", "[", "t2", "]"}], "t2"]}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"v2", "\[Equal]", 
              RowBox[{
               RowBox[{"Z", "[", 
                RowBox[{"t2", ",", "P2"}], "]"}], "*", "R", "*", 
               RowBox[{"t2", "/", "P2"}]}]}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"t2", ",", "500"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"v2", ",", "V1"}], "}"}]}], "}"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "sol"}]}], 
    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"V1", ",", "659", ",", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<initial volume (\>\"", ",", 
           RowBox[{"Superscript", "[", 
            RowBox[{"\"\<cm\>\"", ",", "3"}], "]"}], ",", "\"\</mol)\>\""}], 
          "}"}], "]"}]}], "}"}], ",", "20", ",", "2000", ",", "1", ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"P2", ",", "25", ",", "\"\<final pressure (MPa)\>\""}], "}"}], 
      ",", "1.5", ",", "50", ",", "0.1", ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"SaveDefinitions", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.65367269980131*^9, 3.6536730286991215`*^9}, {
  3.6536730673473325`*^9, 3.6536730907656717`*^9}, {3.653673230358656*^9, 
  3.653673431654169*^9}, {3.6536734643530397`*^9, 3.653673513955877*^9}, {
  3.6536735477828116`*^9, 3.653673575815415*^9}, {3.653673613402565*^9, 
  3.653673635066804*^9}, {3.653673676278161*^9, 3.6536737994712076`*^9}, {
  3.6536740383708715`*^9, 3.653674085217551*^9}, {3.6536741218356457`*^9, 
  3.653674139896679*^9}, {3.6536741802499866`*^9, 3.6536742277877054`*^9}, {
  3.6536743301455603`*^9, 3.65367436562659*^9}, {3.6536744164044943`*^9, 
  3.653674439471813*^9}, {3.653674728188327*^9, 3.653674738054891*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`P2$$ = 14.3, $CellContext`V1$$ = 1612, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`V1$$], 659, 
       Row[{"initial volume (", 
         Superscript["cm", 3], "/mol)"}]}, 20, 2000, 1}, {{
       Hold[$CellContext`P2$$], 25, "final pressure (MPa)"}, 1.5, 50, 0.1}}, 
    Typeset`size$$ = {109., {2., 8.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    False, $CellContext`V1$71660$$ = 0, $CellContext`P2$71661$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`P2$$ = 25, $CellContext`V1$$ = 659}, 
      "ControllerVariables" :> {
        Hold[$CellContext`V1$$, $CellContext`V1$71660$$, 0], 
        Hold[$CellContext`P2$$, $CellContext`P2$71661$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`R$, $CellContext`Pref$, $CellContext`Tref$, \
$CellContext`Pc$, $CellContext`Tc$, $CellContext`CpA$, $CellContext`CpB$, \
$CellContext`CpC$, $CellContext`CpD$, $CellContext`\[Kappa]$, \
$CellContext`A$, $CellContext`B$, $CellContext`a2$, $CellContext`a1$, \
$CellContext`a0$, $CellContext`f$, $CellContext`q$, $CellContext`p$, \
$CellContext`r$, $CellContext`Zmin$, $CellContext`Zmax$, $CellContext`Z$, \
$CellContext`Hdepref$, $CellContext`Sdepref$, $CellContext`Hig$, \
$CellContext`Sig$, $CellContext`Hdep$, $CellContext`Sdep$, $CellContext`H$, \
$CellContext`S$, $CellContext`P1$, $CellContext`T1$, $CellContext`q1$, \
$CellContext`S1$, $CellContext`sol$}, $CellContext`R$ = 
         8.314; $CellContext`Pref$ = 0.1; $CellContext`Tref$ = 
         298; $CellContext`Pc$ = 22.12; $CellContext`Tc$ = 
         647.3; $CellContext`CpA$ = 32.24; $CellContext`CpB$ = 
         0.001924; $CellContext`CpC$ = 
         0.00001055; $CellContext`CpD$ = -3.596*^-9; $CellContext`\[Kappa]$ := 
         0.37464 + 1.54226 0.344 - 0.26992 0.344^2; $CellContext`A$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`P$, 
            Blank[]]] := 
         0.4572355289 (
            1 + $CellContext`\[Kappa]$ (1 - 
              Sqrt[$CellContext`T$/$CellContext`Tc$]))^2 \
($CellContext`Tc$/$CellContext`T$)^2 ($CellContext`P$/$CellContext`Pc$); \
$CellContext`B$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`P$, 
            Blank[]]] := 
         0.0777960739 ($CellContext`Tc$/$CellContext`T$) \
($CellContext`P$/$CellContext`Pc$); $CellContext`a2$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`P$, 
            Blank[]]] := $CellContext`B$[$CellContext`T$, $CellContext`P$] - 
          1; $CellContext`a1$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`P$, 
            Blank[]]] := $CellContext`A$[$CellContext`T$, $CellContext`P$] - 
          3 $CellContext`B$[$CellContext`T$, $CellContext`P$]^2 - 
          2 $CellContext`B$[$CellContext`T$, $CellContext`P$]; \
$CellContext`a0$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`P$, 
            
            Blank[]]] := -($CellContext`A$[$CellContext`T$, $CellContext`P$] \
$CellContext`B$[$CellContext`T$, $CellContext`P$] - \
$CellContext`B$[$CellContext`T$, $CellContext`P$]^2 - \
$CellContext`B$[$CellContext`T$, $CellContext`P$]^3); $CellContext`f$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`P$, 
            Blank[]], 
           Pattern[$CellContext`z$, 
            Blank[]]] := $CellContext`P$ 
          Exp[$CellContext`z$[$CellContext`T$, $CellContext`P$] - 1 - 
            Log[$CellContext`z$[$CellContext`T$, $CellContext`P$] - \
$CellContext`B$[$CellContext`T$, $CellContext`P$]] - \
($CellContext`A$[$CellContext`T$, $CellContext`P$]/(
             2.8284 $CellContext`B$[$CellContext`T$, $CellContext`P$])) 
            Log[($CellContext`z$[$CellContext`T$, $CellContext`P$] + 
               2.4142 $CellContext`B$[$CellContext`T$, \
$CellContext`P$])/($CellContext`z$[$CellContext`T$, $CellContext`P$] - 
              0.4142 $CellContext`B$[$CellContext`T$, $CellContext`P$])]]; \
$CellContext`q$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`P$, 
            Blank[]]] := (
           2 $CellContext`a2$[$CellContext`T$, $CellContext`P$]^3 - 
           9 $CellContext`a2$[$CellContext`T$, $CellContext`P$] \
$CellContext`a1$[$CellContext`T$, $CellContext`P$] + 
           27 $CellContext`a0$[$CellContext`T$, $CellContext`P$])/
          27; $CellContext`p$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`P$, 
            Blank[]]] := (
           3 $CellContext`a1$[$CellContext`T$, $CellContext`P$] - \
$CellContext`a2$[$CellContext`T$, $CellContext`P$]^2)/3; $CellContext`r$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`P$, 
            Blank[]]] := $CellContext`q$[$CellContext`T$, $CellContext`P$]^2/
           4 + $CellContext`p$[$CellContext`T$, $CellContext`P$]^3/
           27; $CellContext`Zmin$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`P$, 
            Blank[]]] := 
         2 Sqrt[(-$CellContext`p$[$CellContext`T$, $CellContext`P$])/3] 
           Cos[ArcCos[
               3 $CellContext`q$[$CellContext`T$, \
$CellContext`P$]/($CellContext`p$[$CellContext`T$, $CellContext`P$] 2 
                Sqrt[(-$CellContext`p$[$CellContext`T$, $CellContext`P$])/
                  3])]/3 + 2 (Pi/
               3)] - $CellContext`a2$[$CellContext`T$, $CellContext`P$]/
          3; $CellContext`Zmax$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`P$, 
            Blank[]]] := 
         2 Sqrt[(-$CellContext`p$[$CellContext`T$, $CellContext`P$])/3] 
           Cos[ArcCos[
              3 $CellContext`q$[$CellContext`T$, \
$CellContext`P$]/($CellContext`p$[$CellContext`T$, $CellContext`P$] 2 
               Sqrt[(-$CellContext`p$[$CellContext`T$, $CellContext`P$])/3])]/
             3] - $CellContext`a2$[$CellContext`T$, $CellContext`P$]/
          3; $CellContext`Z$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`P$, 
            Blank[]]] := 
         Piecewise[{{
            CubeRoot[(-$CellContext`q$[$CellContext`T$, $CellContext`P$])/2 + 
               Sqrt[
                 $CellContext`r$[$CellContext`T$, $CellContext`P$]]] + 
             CubeRoot[(-$CellContext`q$[$CellContext`T$, $CellContext`P$])/2 - 
               Sqrt[
                $CellContext`r$[$CellContext`T$, $CellContext`P$]]] - \
$CellContext`a2$[$CellContext`T$, $CellContext`P$]/
             3, $CellContext`r$[$CellContext`T$, $CellContext`P$] > 0}, {
             
             If[$CellContext`f$[$CellContext`T$, $CellContext`P$, \
$CellContext`Zmin$] < $CellContext`f$[$CellContext`T$, $CellContext`P$, \
$CellContext`Zmax$], 
              $CellContext`Zmin$[$CellContext`T$, $CellContext`P$], 
              $CellContext`Zmax$[$CellContext`T$, $CellContext`P$]], \
$CellContext`r$[$CellContext`T$, $CellContext`P$] <= 
             0}}]; $CellContext`Hdepref$ = -45729.2; $CellContext`Sdepref$ = \
-123.285; $CellContext`Hig$[
           Pattern[$CellContext`T$, 
            
            Blank[]]] := $CellContext`CpA$ ($CellContext`T$ - \
$CellContext`Tref$) + (1/
            2) $CellContext`CpB$ ($CellContext`T$^2 - $CellContext`Tref$^2) + \
(1/3) $CellContext`CpC$ ($CellContext`T$^3 - $CellContext`Tref$^3) + (1/
            4) $CellContext`CpD$ ($CellContext`T$^4 - $CellContext`Tref$^4); \
$CellContext`Sig$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`P$, 
            Blank[]]] := $CellContext`CpA$ 
           Log[$CellContext`T$/$CellContext`Tref$] + $CellContext`CpB$ \
($CellContext`T$ - $CellContext`Tref$) + (1/
            2) $CellContext`CpC$ ($CellContext`T$^2 - $CellContext`Tref$^2) + \
(1/3) $CellContext`CpD$ ($CellContext`T$^3 - $CellContext`Tref$^3) - \
$CellContext`R$ Log[$CellContext`P$/$CellContext`Pref$]; $CellContext`Hdep$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`P$, 
            
            Blank[]]] := $CellContext`R$ $CellContext`T$ \
($CellContext`Z$[$CellContext`T$, $CellContext`P$] - 
           1 - ($CellContext`A$[$CellContext`T$, $CellContext`P$]/(
            2.8284 $CellContext`B$[$CellContext`T$, $CellContext`P$])) (
            1 + $CellContext`\[Kappa]$ 
             Sqrt[$CellContext`T$ $CellContext`Tc$^(-1)/(
                1 + $CellContext`\[Kappa]$ (1 - 
                  Sqrt[$CellContext`T$/$CellContext`Tc$]))^2]) 
           Log[($CellContext`Z$[$CellContext`T$, $CellContext`P$] + 
              2.4142 $CellContext`B$[$CellContext`T$, \
$CellContext`P$])/($CellContext`Z$[$CellContext`T$, $CellContext`P$] - 
             0.4142 $CellContext`B$[$CellContext`T$, $CellContext`P$])]); \
$CellContext`Sdep$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`P$, 
            Blank[]]] := $CellContext`R$ 
           Log[$CellContext`Z$[$CellContext`T$, $CellContext`P$] - \
$CellContext`B$[$CellContext`T$, $CellContext`P$]] - $CellContext`R$ \
($CellContext`A$[$CellContext`T$, $CellContext`P$]/(
           2.8284 $CellContext`B$[$CellContext`T$, $CellContext`P$])) \
$CellContext`\[Kappa]$ 
          Sqrt[$CellContext`T$ $CellContext`Tc$^(-1)/(
             1 + $CellContext`\[Kappa]$ (1 - 
               Sqrt[$CellContext`T$/$CellContext`Tc$]))^2] 
          Log[($CellContext`Z$[$CellContext`T$, $CellContext`P$] + 
             2.4142 $CellContext`B$[$CellContext`T$, \
$CellContext`P$])/($CellContext`Z$[$CellContext`T$, $CellContext`P$] - 
            0.4142 $CellContext`B$[$CellContext`T$, $CellContext`P$])]; \
$CellContext`H$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`P$, 
            
            Blank[]]] := $CellContext`Hdep$[$CellContext`T$, $CellContext`P$] - \
$CellContext`Hdepref$ + $CellContext`Hig$[$CellContext`T$]; $CellContext`S$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`P$, 
            
            Blank[]]] := $CellContext`Sdep$[$CellContext`T$, $CellContext`P$] - \
$CellContext`Sdepref$ + $CellContext`Sig$[$CellContext`T$, $CellContext`P$]; \
$CellContext`P1$ = 1.25; $CellContext`T1$ := 
         459.4; $CellContext`q1$ := ($CellContext`V1$$ - \
$CellContext`VPL[$CellContext`P1$])/($CellContext`VPV[$CellContext`P1$] - \
$CellContext`VPL[$CellContext`P1$]); $CellContext`S1$ := \
$CellContext`S$[$CellContext`T1$, $CellContext`P1$] + $CellContext`q1$ \
($CellContext`Hvap[$CellContext`T1$]/$CellContext`T1$); $CellContext`sol$ := 
         ReplaceAll[{$CellContext`t, $CellContext`v2}, 
           Quiet[
            
            FindRoot[{$CellContext`S1$ == $CellContext`S$[$CellContext`t, \
$CellContext`P2$$] + (($CellContext`v2 - \
$CellContext`VPL[$CellContext`P2$$])/($CellContext`VPV[$CellContext`P2$$] - \
$CellContext`VPL[$CellContext`P2$$])) \
($CellContext`Hvap[$CellContext`t]/$CellContext`t), $CellContext`v2 == \
$CellContext`Z$[$CellContext`t, $CellContext`P2$$] $CellContext`R$ \
($CellContext`t/$CellContext`P2$$)}, {{$CellContext`t, 
               500}, {$CellContext`v2, $CellContext`V1$$}}]]]; \
$CellContext`sol$], "Specifications" :> {{{$CellContext`V1$$, 659, 
          Row[{"initial volume (", 
            Superscript["cm", 3], "/mol)"}]}, 20, 2000, 1, Appearance -> 
         "Labeled"}, {{$CellContext`P2$$, 25, "final pressure (MPa)"}, 1.5, 
         50, 0.1, Appearance -> "Labeled"}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{420., {65., 72.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`VPL := Quiet[
         Interpolation[
          Map[
          Reverse, $CellContext`pvL]]], $CellContext`pvL := CompressedData["
1:eJxTTMoPSmViYGBQAGIQzXV9cYHtKSOHWTNBYKe9Zkz/oa8ZJlD+R3uPh1Ui
69xNHc6eAQEGB1uQhr8wPocDWHqhmUMaGAg4VAO5D63MoXwRBxC36gqML+EA
Md8CypdxYAADSwdjMFBwAElrzIHxlaDmWUH5KhD7HsL4ag5BO+RaX0+0hvI1
IO7ysYHytSD2i9hC+ToOhSAPfIDx9SDueGYH8a+kAdR/9lC+oUPr68Adcksd
oHwjiH2FjlC+sYM8SEGdE5RvApEXdIHyTR3eALW3ertA7YPyu12g7jSFqL/o
Ag0PU4clBUAXKLtCwqXB1OHwV42Y/iZXaHyYQvzzxRVi3mZTSHg0ukHjwxSi
ztId6i9TSHjGeEDD2Qwi/9PbASzMb+YAAARzztA=
        "], $CellContext`VPV := Quiet[
         Interpolation[
          Map[
          Reverse, $CellContext`pvV]]], $CellContext`pvV := CompressedData["
1:eJwt0ltIFHEUBvDJp7KiC0uUSNlStlhUuv0XepC+erGwh3bSirAQ6Y6lRiyy
hBixRkhIvpiVGmQXI2SxNUppzVUr0S0VyUoLojYpu7CQkUbR/Oc7B5bhNzvz
nTlnZnlBkXkwwTCMDOunj7oQfYvLtboebtIu94/h/Ob82ICzna54g15fuCFp
3SO6+hX2bAw984U76PqX+Pl3uPRzaid9ZxiVheN/muIR+v4QlgUmvA+W9tCR
ATRnvfc7mp/aNuqiUPvbts1J6KNbexE8eeTit9Mv6GgPLtScWHj28RAd64Tu
3pA0Qk+3w2EHvqPTQtiq47NitKdF+o3TW4L4cONKd0rwC331LnT31ee+06Hb
sLDo9fM43d+Ilroft55kT9Ifr2HQOTpVdmya/l0r/8+AbVc1ov26ZnKv3koc
sms+7DV0BMQOOn5GvBhuXbvLxMmcK9nP8+4UlGQmjlzv9omd0Cyee0q8Al+t
uEBfiTgVjcXWFV1FYhfvLy0Up6EqMunKqzkqXgPTun1i1mHxWu4tfIBzLFlP
3ywQpyNPB4TyxRmcp3Wf2M3nmb1XvAH2a1mwS6yYV58r/RSsaTITV+Vyf9sV
r2vKkX0o/HJZHVfmcM/lCvpxvZd2yver+J39M5l3T6HLGq/KNOV9KOZUeHn8
pLi/4zuYZ3iYM5XNvczz4D9iKTWn
        "], $CellContext`Hvap := Quiet[
         Interpolation[CompressedData["
1:eJxTTMoPSmViYGAQBmIQDQYChQ4g6sD/p2CaYUERhF8F5U8ohvC1oPwLJWDa
Yd8TCF+gDEwr+EH5AeUQ/q3HUP0VYLohAcq/UAmmE+49guqvhpgfCOUH1EDo
XQ+h+msh9glB+RfqIOaFP4DwORog8gL3IfwVEH6D1V0I36MRYr7KbQj/BYTP
sPUGhO5ogug/dhXC12iG6Be8BOGfgPAZgk86AAA8bj23
          "]]], Attributes[Superscript] = {NHoldRest, ReadProtected}}; 
     Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.6536730353165*^9, 3.653673062167036*^9}, 
   3.6536731126979265`*^9, {3.653673336349718*^9, 3.6536734324782166`*^9}, 
   3.6536734657791214`*^9, 3.6536735154009595`*^9, 3.6536735484288483`*^9, {
   3.653673578513569*^9, 3.6536735810627155`*^9}, 3.6536737099810886`*^9, {
   3.653674378856346*^9, 3.6536743937081957`*^9}, 3.6536744458111763`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"Z2", "[", 
     RowBox[{"t_", ",", "P_"}], "]"}], ":=", 
    RowBox[{"Quiet", "@", 
     RowBox[{
      RowBox[{"Interpolation", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"T", ",", 
           RowBox[{"Piecewise", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"CubeRoot", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"q", "[", 
                    RowBox[{"T", ",", "P"}], "]"}]}], "/", "2"}], "+", 
                   SqrtBox[
                    RowBox[{"r", "[", 
                    RowBox[{"T", ",", "P"}], "]"}]]}], "]"}], "+", 
                 RowBox[{"CubeRoot", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"q", "[", 
                    RowBox[{"T", ",", "P"}], "]"}]}], "/", "2"}], "-", 
                   SqrtBox[
                    RowBox[{"r", "[", 
                    RowBox[{"T", ",", "P"}], "]"}]]}], "]"}], "-", 
                 RowBox[{
                  RowBox[{"a2", "[", 
                   RowBox[{"T", ",", "P"}], "]"}], "/", "3"}]}], ",", 
                RowBox[{
                 RowBox[{"r", "[", 
                  RowBox[{"T", ",", "P"}], "]"}], ">", "0"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"f", "[", 
                    RowBox[{"T", ",", "P", ",", "Zmin"}], "]"}], "<", 
                   RowBox[{"f", "[", 
                    RowBox[{"T", ",", "P", ",", "Zmax"}], "]"}]}], ",", 
                  RowBox[{"Zmin", "[", 
                   RowBox[{"T", ",", "P"}], "]"}], ",", 
                  RowBox[{"Zmax", "[", 
                   RowBox[{"T", ",", "P"}], "]"}]}], "]"}], ",", 
                RowBox[{
                 RowBox[{"r", "[", 
                  RowBox[{"T", ",", "P"}], "]"}], "\[LessEqual]", "0"}]}], 
               "}"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"T", ",", "200", ",", "Tc"}], "}"}]}], "]"}], "]"}], "[", 
      "t", "]"}]}]}], ";"}], "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Column", "[", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Timing", "[", 
      RowBox[{
       RowBox[{"Z1", "[", 
        RowBox[{"T1", ",", "P1"}], "]"}], ";"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Timing", "[", 
      RowBox[{
       RowBox[{"Z2", "[", 
        RowBox[{"T1", ",", "P1"}], "]"}], ";"}], "]"}]}], 
    "\[IndentingNewLine]", "}"}], "]"}], "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"root", "[", 
     RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
    RowBox[{"z", "/.", 
     RowBox[{"Quiet", "@", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SuperscriptBox["z", "3"], "+", 
          RowBox[{
           RowBox[{"a2", "[", 
            RowBox[{"T", ",", "P"}], "]"}], "*", 
           SuperscriptBox["z", "2"]}], "+", 
          RowBox[{
           RowBox[{"a1", "[", 
            RowBox[{"T", ",", "P"}], "]"}], "*", "z"}], "+", 
          RowBox[{"a0", "[", 
           RowBox[{"T", ",", "P"}], "]"}]}], "\[Equal]", "0"}], ",", "z", ",",
         "Reals"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Z2", "[", 
     RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"root", "[", 
         RowBox[{"T", ",", "P"}], "]"}], "]"}], "\[Equal]", "1"}], ",", 
      RowBox[{"First", "@", 
       RowBox[{"root", "[", 
        RowBox[{"T", ",", "P"}], "]"}]}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"T", ",", "P", ",", 
           RowBox[{"Min", "[", 
            RowBox[{"root", "[", 
             RowBox[{"T", ",", "P"}], "]"}], "]"}]}], "]"}], "<", 
         RowBox[{"f", "[", 
          RowBox[{"T", ",", "P", ",", 
           RowBox[{"Max", "[", 
            RowBox[{"root", "[", 
             RowBox[{"T", ",", "P"}], "]"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{"root", "[", 
          RowBox[{"T", ",", "P"}], "]"}], "]"}], ",", 
        RowBox[{"Max", "[", 
         RowBox[{"root", "[", 
          RowBox[{"T", ",", "P"}], "]"}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"T1", ",", "300", ",", "\"\<temperature \>\""}], "}"}], ",", 
      "250", ",", "600", ",", "1", ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"P1", ",", "25", ",", "\"\<pressure (MPa)\>\""}], "}"}], ",", 
      "1.5", ",", "50", ",", "0.1", ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], "]"}]}], 
  "*)"}]], "Input"]
},
WindowSize->{667, 670},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 7, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 9581, 273, 732, "Input",
 InitializationCell->True,
 CellID->106716937],
Cell[CellGroupData[{
Cell[10164, 297, 20231, 542, 2098, "Input"],
Cell[30398, 841, 14917, 294, 154, "Output"]
}, Open  ]],
Cell[45330, 1138, 2476, 63, 143, "Input"],
Cell[47809, 1203, 459, 14, 92, "Input"],
Cell[48271, 1219, 1861, 55, 135, "Input"],
Cell[50135, 1276, 646, 18, 72, "Input"]
}
]
*)

(* End of internal cache information *)
