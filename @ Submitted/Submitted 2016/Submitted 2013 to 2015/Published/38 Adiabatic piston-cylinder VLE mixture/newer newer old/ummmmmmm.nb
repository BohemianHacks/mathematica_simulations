(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     45067,       1153]
NotebookOptionsPosition[     44433,       1127]
NotebookOutlinePosition[     44777,       1142]
CellTagsIndexPosition[     44734,       1139]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "R", ",", "Pc", ",", "Tc", ",", "\[Kappa]", ",", "A", ",", "B", ",", 
       "Z", ",", "S", ",", "V", ",", "vL", ",", "vV", ",", "sL", ",", "sV", 
       ",", "Tsat", ",", "P1", ",", "T1", ",", "V1", ",", "S1", ",", "qsat", 
       ",", "q2", ",", "T2", ",", "V2", ",", "S2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"R", "=", "8.314"}], ";", 
      RowBox[{"Pc", "=", "22.12"}], ";", 
      RowBox[{"Tc", "=", "647.3"}], ";", 
      RowBox[{"\[Kappa]", "=", "0.8732"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
       RowBox[{"0.4572355289", "*", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"\[Kappa]", "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SqrtBox[
               RowBox[{"T", "/", "Tc"}]]}], ")"}]}]}], ")"}], "2"], "*", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["Tc", "T"], ")"}], "2"], "*", 
        FractionBox["P", "Pc"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"B", "[", 
        RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
       RowBox[{"0.0777960739", "*", 
        FractionBox["Tc", "T"], "*", 
        FractionBox["P", "Pc"]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Z", "[", 
        RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a2", ",", "a1", ",", "a0", ",", "zlist", ",", "f"}], "}"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"a2", "=", 
           RowBox[{
            RowBox[{"B", "[", 
             RowBox[{"T", ",", "P"}], "]"}], "-", "1"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"a1", "=", 
           RowBox[{
            RowBox[{"A", "[", 
             RowBox[{"T", ",", "P"}], "]"}], "-", 
            RowBox[{"3", "*", 
             SuperscriptBox[
              RowBox[{"B", "[", 
               RowBox[{"T", ",", "P"}], "]"}], "2"]}], "-", 
            RowBox[{"2", "*", 
             RowBox[{"B", "[", 
              RowBox[{"T", ",", "P"}], "]"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"a0", "=", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"A", "[", 
                RowBox[{"T", ",", "P"}], "]"}], "*", 
               RowBox[{"B", "[", 
                RowBox[{"T", ",", "P"}], "]"}]}], "-", 
              SuperscriptBox[
               RowBox[{"B", "[", 
                RowBox[{"T", ",", "P"}], "]"}], "2"], "-", 
              SuperscriptBox[
               RowBox[{"B", "[", 
                RowBox[{"T", ",", "P"}], "]"}], "3"]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"zlist", "=", 
           RowBox[{"z", "/.", 
            RowBox[{"Quiet", "@", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 SuperscriptBox["z", "3"], "+", 
                 RowBox[{"a2", "*", 
                  SuperscriptBox["z", "2"]}], "+", 
                 RowBox[{"a1", "*", "z"}], "+", "a0"}], "\[Equal]", "0"}], 
               ",", "z", ",", "Reals"}], "]"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"f", "[", "i_", "]"}], ":=", 
           RowBox[{"P", "*", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"zlist", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "-", "1", "-", 
              RowBox[{"Log", "[", 
               RowBox[{
                RowBox[{"zlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "-", 
                RowBox[{"B", "[", 
                 RowBox[{"T", ",", "P"}], "]"}]}], "]"}], "-", 
              RowBox[{
               FractionBox[
                RowBox[{"A", "[", 
                 RowBox[{"T", ",", "P"}], "]"}], 
                RowBox[{"2.8482", "*", 
                 RowBox[{"B", "[", 
                  RowBox[{"T", ",", "P"}], "]"}]}]], "*", 
               RowBox[{"Log", "[", 
                FractionBox[
                 RowBox[{
                  RowBox[{"zlist", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "+", 
                  RowBox[{"2.4142", "*", 
                   RowBox[{"B", "[", 
                    RowBox[{"T", ",", "P"}], "]"}]}]}], 
                 RowBox[{
                  RowBox[{"zlist", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "-", 
                  RowBox[{"0.4142", "*", 
                   RowBox[{"B", "[", 
                    RowBox[{"T", ",", "P"}], "]"}]}]}]], "]"}]}]}], "]"}]}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"SortBy", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"zlist", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], ",", 
                  RowBox[{"f", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], ",", "Last"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "zlist"}], "\[Equal]", "1"}], ",", 
            RowBox[{"First", "@", "zlist"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"zlist", "[", 
               RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}]}], "}"}]}]}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Tref", ",", "Pref", ",", "Cp", ",", "Sig", ",", "Sdep"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Tref", "=", "298"}], ";", 
          RowBox[{"Pref", "=", "0.1"}], ";", 
          RowBox[{"Cp", "=", 
           RowBox[{"{", 
            RowBox[{"32.24", ",", "0.001924", ",", "1.055*^-5", ",", 
             RowBox[{"-", "3.596*^-9"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Sig", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Cp", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{"Log", "[", 
              RowBox[{"T", "/", "Tref"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"Cp", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{"(", 
              RowBox[{"T", "-", "Tref"}], ")"}]}], "+", 
            RowBox[{
             FractionBox["1", "2"], "*", 
             RowBox[{"Cp", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "*", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["T", "2"], "-", 
               SuperscriptBox["Tref", "2"]}], ")"}]}], "+", 
            RowBox[{
             FractionBox["1", "3"], "*", 
             RowBox[{"Cp", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "*", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["T", "3"], "-", 
               SuperscriptBox["Tref", "3"]}], ")"}]}], "-", 
            RowBox[{"R", "*", 
             RowBox[{"Log", "[", 
              RowBox[{"P", "/", "Pref"}], "]"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Sdep", "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"R", "*", 
               RowBox[{"Log", "[", 
                RowBox[{"#", "-", 
                 RowBox[{"B", "[", 
                  RowBox[{"T", ",", "P"}], "]"}]}], "]"}]}], "-", 
              RowBox[{"R", "*", 
               FractionBox[
                RowBox[{"A", "[", 
                 RowBox[{"T", ",", "P"}], "]"}], 
                RowBox[{"2.8284", "*", 
                 RowBox[{"B", "[", 
                  RowBox[{"T", ",", "P"}], "]"}]}]], "*", "\[Kappa]", "*", 
               SqrtBox[
                FractionBox[
                 RowBox[{"T", "/", "Tc"}], 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"\[Kappa]", "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    SqrtBox[
                    RowBox[{"T", "/", "Tc"}]]}], ")"}]}]}], ")"}], "2"]]], 
               "*", 
               RowBox[{"Log", "[", 
                FractionBox[
                 RowBox[{"#", "+", 
                  RowBox[{"2.4142", "*", 
                   RowBox[{"B", "[", 
                    RowBox[{"T", ",", "P"}], "]"}]}]}], 
                 RowBox[{"#", "-", 
                  RowBox[{"0.4142", "*", 
                   RowBox[{"B", "[", 
                    RowBox[{"T", ",", "P"}], "]"}]}]}]], "]"}]}]}], "&"}], "/@", 
            RowBox[{"Z", "[", 
             RowBox[{"T", ",", "P"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Sdep", "-", 
           RowBox[{"(", 
            RowBox[{"-", "123.285"}], ")"}], "+", "Sig"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"V", "[", 
        RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"Z", "[", 
         RowBox[{"T", ",", "P"}], "]"}], "*", "R", "*", 
        RowBox[{"T", "/", "P"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], 
       "*****)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vL", "[", 
        RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
       RowBox[{"Min", "@", 
        RowBox[{"V", "[", 
         RowBox[{"T", ",", "P"}], "]"}]}]}], ";", 
      RowBox[{
       RowBox[{"vV", "[", 
        RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
       RowBox[{"Max", "@", 
        RowBox[{"V", "[", 
         RowBox[{"T", ",", "P"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sL", "[", 
        RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
       RowBox[{"Min", "@", 
        RowBox[{"S", "[", 
         RowBox[{"T", ",", "P"}], "]"}]}]}], ";", 
      RowBox[{
       RowBox[{"sV", "[", 
        RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
       RowBox[{"Max", "@", 
        RowBox[{"S", "[", 
         RowBox[{"T", ",", "P"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], 
       "*****)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Tsat", "[", "P_", "]"}], ":=", 
       RowBox[{"t", "/.", 
        RowBox[{"Quiet", "@", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"10", "*", "P"}], "\[Equal]", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"5.20389", "-", 
                RowBox[{"1733.926", "/", 
                 RowBox[{"(", 
                  RowBox[{"t", "-", "39.485"}], ")"}]}]}], ")"}]}]}], ",", 
            "t"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"P1", "=", "0.5"}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"Tsat", "@", "P1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"V1", "=", 
       RowBox[{
        RowBox[{"q1", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"vV", "[", 
            RowBox[{"T1", ",", "P1"}], "]"}], "-", 
           RowBox[{"vL", "[", 
            RowBox[{"T1", ",", "P1"}], "]"}]}], ")"}]}], "+", 
        RowBox[{"vL", "[", 
         RowBox[{"T1", ",", "P1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"S1", "=", 
       RowBox[{
        RowBox[{"q1", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"sV", "[", 
            RowBox[{"T1", ",", "P1"}], "]"}], "-", 
           RowBox[{"sL", "[", 
            RowBox[{"T1", ",", "P1"}], "]"}]}], ")"}]}], "+", 
        RowBox[{"sL", "[", 
         RowBox[{"T1", ",", "P1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"qsat", "=", 
       FractionBox[
        RowBox[{"S1", "-", 
         RowBox[{"sL", "[", 
          RowBox[{
           RowBox[{"Tsat", "@", "P2"}], ",", "P2"}], "]"}]}], 
        RowBox[{
         RowBox[{"sV", "[", 
          RowBox[{
           RowBox[{"Tsat", "@", "P2"}], ",", "P2"}], "]"}], "-", 
         RowBox[{"sL", "[", 
          RowBox[{
           RowBox[{"Tsat", "@", "P2"}], ",", "P2"}], "]"}]}]]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"Quiet", "@", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{"S1", "\[Equal]", 
             RowBox[{
              RowBox[{"S", "[", 
               RowBox[{"t", ",", "P2"}], "]"}], "[", 
              RowBox[{"[", "#", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "T1"}], "}"}]}], "]"}]}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"0", "<", "qsat", "<", "1"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"q2", "=", "qsat"}], ";", 
          RowBox[{"T2", "=", 
           RowBox[{"Tsat", "@", "P2"}]}], ";"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"qsat", "\[LessEqual]", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"q2", "=", "0"}], ";", 
          RowBox[{"T2", "=", 
           RowBox[{"Quiet", "@", 
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"sL", "[", 
                    RowBox[{"#", ",", "P2"}], "]"}], ",", "#"}], "}"}], "&"}],
                 "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"T1", ",", 
                  RowBox[{"Tsat", "@", "P2"}], ",", "2"}], "]"}]}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
             "S1", "]"}]}]}], ";"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"qsat", "\[GreaterEqual]", "1"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"q2", "=", "1"}], ";", 
          RowBox[{"T2", "=", 
           RowBox[{"Quiet", "@", 
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"sV", "[", 
                    RowBox[{"#", ",", "P2"}], "]"}], ",", "#"}], "}"}], "&"}],
                 "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"T1", ",", 
                  RowBox[{"Tsat", "@", "P2"}], ",", "2"}], "]"}]}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
             "S1", "]"}]}]}], ";"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"V2", "=", 
       RowBox[{
        RowBox[{"q2", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"vV", "[", 
            RowBox[{"T2", ",", "P2"}], "]"}], "-", 
           RowBox[{"vL", "[", 
            RowBox[{"T2", ",", "P2"}], "]"}]}], ")"}]}], "+", 
        RowBox[{"vL", "[", 
         RowBox[{"T2", ",", "P2"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"S2", "=", 
       RowBox[{
        RowBox[{"q2", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"sV", "[", 
            RowBox[{"T2", ",", "P2"}], "]"}], "-", 
           RowBox[{"sL", "[", 
            RowBox[{"T2", ",", "P2"}], "]"}]}], ")"}]}], "+", 
        RowBox[{"sL", "[", 
         RowBox[{"T2", ",", "P2"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"V1", ",", "V2"}], "}"}], ";", 
      RowBox[{"V", "[", 
       RowBox[{"Tc", ",", "Pc"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"q1", ",", "0.4", ",", "\"\<initial vapor quality\>\""}], 
       "}"}], ",", "0.1", ",", "0.95", ",", "0.05", ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"P2", ",", "15", ",", "\"\<final pressure (MPa)\>\""}], "}"}], 
      ",", "1", ",", "20", ",", "0.1", ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.6682803249687686`*^9, 3.668280670382154*^9}, {
  3.6682807071086316`*^9, 3.6682808150366974`*^9}, {3.6682808613951983`*^9, 
  3.6682810418151846`*^9}, {3.6682811087403297`*^9, 3.668281137719788*^9}, {
  3.668281168154851*^9, 3.668281169876854*^9}, {3.6682812081461315`*^9, 
  3.668281224690566*^9}, {3.6682813281211233`*^9, 3.668281344402866*^9}, {
  3.6682814260504913`*^9, 3.668281597520859*^9}, {3.668281635224737*^9, 
  3.6682817003495197`*^9}, {3.668281751757882*^9, 3.6682817813723507`*^9}, {
  3.6682818638401785`*^9, 3.6682820081504803`*^9}, {3.6682823278031425`*^9, 
  3.6682824390318823`*^9}, {3.668282472251953*^9, 3.6682828246765223`*^9}, {
  3.668282869716418*^9, 3.6682828890362563`*^9}, {3.6682829865274954`*^9, 
  3.6682830389228067`*^9}, {3.668283084315858*^9, 3.6682830859870605`*^9}, {
  3.6682832330861344`*^9, 3.6682833206995134`*^9}, {3.6682834385159597`*^9, 
  3.6682834735478363`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`P2$$ = 15, $CellContext`q1$$ = 0.4, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`q1$$], 0.4, "initial vapor quality"}, 0.1, 0.95, 
      0.05}, {{
       Hold[$CellContext`P2$$], 15, "final pressure (MPa)"}, 1, 20, 0.1}}, 
    Typeset`size$$ = {40., {0., 8.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`q1$2350997$$ = 0, $CellContext`P2$2350998$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`P2$$ = 15, $CellContext`q1$$ = 0.4}, 
      "ControllerVariables" :> {
        Hold[$CellContext`q1$$, $CellContext`q1$2350997$$, 0], 
        Hold[$CellContext`P2$$, $CellContext`P2$2350998$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`R$, $CellContext`Pc$, $CellContext`Tc$, \
$CellContext`\[Kappa]$, $CellContext`A$, $CellContext`B$, $CellContext`Z$, \
$CellContext`S$, $CellContext`V$, $CellContext`vL$, $CellContext`vV$, \
$CellContext`sL$, $CellContext`sV$, $CellContext`Tsat$, $CellContext`P1$, \
$CellContext`T1$, $CellContext`V1$, $CellContext`S1$, $CellContext`qsat$, \
$CellContext`q2$, $CellContext`T2$, $CellContext`V2$, $CellContext`S2$}, \
$CellContext`R$ = 8.314; $CellContext`Pc$ = 22.12; $CellContext`Tc$ = 
         647.3; $CellContext`\[Kappa]$ = 0.8732; $CellContext`A$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`P$, 
            Blank[]]] := 
         0.4572355289 (
            1 + $CellContext`\[Kappa]$ (1 - 
              
              Sqrt[$CellContext`T$/$CellContext`Tc$]))^2 \
($CellContext`Tc$/$CellContext`T$)^2 ($CellContext`P$/$CellContext`Pc$); \
$CellContext`B$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`P$, 
            Blank[]]] := 
         0.0777960739 ($CellContext`Tc$/$CellContext`T$) \
($CellContext`P$/$CellContext`Pc$); $CellContext`Z$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`P$, 
            Blank[]]] := 
         Module[{$CellContext`a2$, $CellContext`a1$, $CellContext`a0$, \
$CellContext`zlist$, $CellContext`f$}, $CellContext`a2$ = \
$CellContext`B$[$CellContext`T$, $CellContext`P$] - 
             1; $CellContext`a1$ = $CellContext`A$[$CellContext`T$, \
$CellContext`P$] - 3 $CellContext`B$[$CellContext`T$, $CellContext`P$]^2 - 
             2 $CellContext`B$[$CellContext`T$, $CellContext`P$]; \
$CellContext`a0$ = -($CellContext`A$[$CellContext`T$, $CellContext`P$] \
$CellContext`B$[$CellContext`T$, $CellContext`P$] - \
$CellContext`B$[$CellContext`T$, $CellContext`P$]^2 - \
$CellContext`B$[$CellContext`T$, $CellContext`P$]^3); $CellContext`zlist$ = 
            ReplaceAll[$CellContext`z, 
              Quiet[
               
               Solve[$CellContext`z^3 + $CellContext`a2$ $CellContext`z^2 + \
$CellContext`a1$ $CellContext`z + $CellContext`a0$ == 0, $CellContext`z, 
                Reals]]]; $CellContext`f$[
              Pattern[$CellContext`i$, 
               Blank[]]] := $CellContext`P$ 
             Exp[Part[$CellContext`zlist$, $CellContext`i$] - 1 - Log[
               Part[$CellContext`zlist$, $CellContext`i$] - \
$CellContext`B$[$CellContext`T$, $CellContext`P$]] - \
($CellContext`A$[$CellContext`T$, $CellContext`P$]/(
                2.8482 $CellContext`B$[$CellContext`T$, $CellContext`P$])) 
               Log[(Part[$CellContext`zlist$, $CellContext`i$] + 
                  2.4142 $CellContext`B$[$CellContext`T$, $CellContext`P$])/(
                 Part[$CellContext`zlist$, $CellContext`i$] - 
                 0.4142 $CellContext`B$[$CellContext`T$, $CellContext`P$])]]; 
           If[Length[$CellContext`zlist$] == 1, 
             First[$CellContext`zlist$], 
             Map[Part[$CellContext`zlist$, #]& , {1, -1}]]]; $CellContext`S$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`P$, 
            Blank[]]] := 
         Module[{$CellContext`Tref$, $CellContext`Pref$, $CellContext`Cp$, \
$CellContext`Sig$, $CellContext`Sdep$}, $CellContext`Tref$ = 
            298; $CellContext`Pref$ = 
            0.1; $CellContext`Cp$ = {32.24, 0.001924, 
             0.00001055, -3.596*^-9}; $CellContext`Sig$ = 
            Part[$CellContext`Cp$, 1] Log[$CellContext`T$/$CellContext`Tref$] + 
             Part[$CellContext`Cp$, 
                2] ($CellContext`T$ - $CellContext`Tref$) + (1/2) 
              Part[$CellContext`Cp$, 
                3] ($CellContext`T$^2 - $CellContext`Tref$^2) + (1/3) 
              Part[$CellContext`Cp$, 
                4] ($CellContext`T$^3 - $CellContext`Tref$^3) - \
$CellContext`R$ Log[$CellContext`P$/$CellContext`Pref$]; $CellContext`Sdep$ = 
            Map[$CellContext`R$ 
               Log[# - $CellContext`B$[$CellContext`T$, $CellContext`P$]] - \
$CellContext`R$ ($CellContext`A$[$CellContext`T$, $CellContext`P$]/(
               2.8284 $CellContext`B$[$CellContext`T$, $CellContext`P$])) \
$CellContext`\[Kappa]$ 
              Sqrt[$CellContext`T$ $CellContext`Tc$^(-1)/(
                 1 + $CellContext`\[Kappa]$ (1 - 
                   Sqrt[$CellContext`T$/$CellContext`Tc$]))^2] 
              Log[(# + 
                 2.4142 $CellContext`B$[$CellContext`T$, $CellContext`P$])/(# - 
                0.4142 $CellContext`B$[$CellContext`T$, $CellContext`P$])]& , 
              $CellContext`Z$[$CellContext`T$, $CellContext`P$]]; \
$CellContext`Sdep$ - -123.285 + $CellContext`Sig$]; $CellContext`V$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`P$, 
            
            Blank[]]] := $CellContext`Z$[$CellContext`T$, $CellContext`P$] \
$CellContext`R$ ($CellContext`T$/$CellContext`P$); $CellContext`vL$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`P$, 
            Blank[]]] := Min[
           $CellContext`V$[$CellContext`T$, $CellContext`P$]]; \
$CellContext`vV$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`P$, 
            Blank[]]] := Max[
           $CellContext`V$[$CellContext`T$, $CellContext`P$]]; \
$CellContext`sL$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`P$, 
            Blank[]]] := Min[
           $CellContext`S$[$CellContext`T$, $CellContext`P$]]; \
$CellContext`sV$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`P$, 
            Blank[]]] := Max[
           $CellContext`S$[$CellContext`T$, $CellContext`P$]]; \
$CellContext`Tsat$[
           Pattern[$CellContext`P, 
            Blank[]]] := ReplaceAll[$CellContext`t, 
           Quiet[
            Part[
             Solve[
             10 $CellContext`P == 
              10^(5.20389 - 1733.926/($CellContext`t - 
                39.485)), $CellContext`t], 1]]]; $CellContext`P1$ = 
         0.5; $CellContext`T1$ = $CellContext`Tsat$[$CellContext`P1$]; \
$CellContext`V1$ = $CellContext`q1$$ ($CellContext`vV$[$CellContext`T1$, \
$CellContext`P1$] - $CellContext`vL$[$CellContext`T1$, $CellContext`P1$]) + \
$CellContext`vL$[$CellContext`T1$, $CellContext`P1$]; $CellContext`S1$ = \
$CellContext`q1$$ ($CellContext`sV$[$CellContext`T1$, $CellContext`P1$] - \
$CellContext`sL$[$CellContext`T1$, $CellContext`P1$]) + \
$CellContext`sL$[$CellContext`T1$, $CellContext`P1$]; $CellContext`qsat$ = \
($CellContext`S1$ - $CellContext`sL$[
            $CellContext`Tsat$[$CellContext`P2$$], \
$CellContext`P2$$])/($CellContext`sV$[
            $CellContext`Tsat$[$CellContext`P2$$], $CellContext`P2$$] - \
$CellContext`sL$[
           $CellContext`Tsat$[$CellContext`P2$$], $CellContext`P2$$]); 
        Which[0 < $CellContext`qsat$ < 
          1, {$CellContext`q2$ = $CellContext`qsat$; $CellContext`T2$ = \
$CellContext`Tsat$[$CellContext`P2$$]; Null}, $CellContext`qsat$ <= 
          0, {$CellContext`q2$ = 0; $CellContext`T2$ = Quiet[
              Interpolation[
               Map[{
                 $CellContext`sL$[#, $CellContext`P2$$], #}& , 
                Range[$CellContext`T1$, 
                 $CellContext`Tsat$[$CellContext`P2$$], 2]], 
               InterpolationOrder -> 1][$CellContext`S1$]]; 
           Null}, $CellContext`qsat$ >= 
          1, {$CellContext`q2$ = 1; $CellContext`T2$ = Quiet[
              Interpolation[
               Map[{
                 $CellContext`sV$[#, $CellContext`P2$$], #}& , 
                Range[$CellContext`T1$, 
                 $CellContext`Tsat$[$CellContext`P2$$], 2]], 
               InterpolationOrder -> 1][$CellContext`S1$]]; 
           Null}]; $CellContext`V2$ = $CellContext`q2$ \
($CellContext`vV$[$CellContext`T2$, $CellContext`P2$$] - \
$CellContext`vL$[$CellContext`T2$, $CellContext`P2$$]) + \
$CellContext`vL$[$CellContext`T2$, $CellContext`P2$$]; $CellContext`S2$ = \
$CellContext`q2$ ($CellContext`sV$[$CellContext`T2$, $CellContext`P2$$] - \
$CellContext`sL$[$CellContext`T2$, $CellContext`P2$$]) + \
$CellContext`sL$[$CellContext`T2$, $CellContext`P2$$]; {$CellContext`V1$, \
$CellContext`V2$}; $CellContext`V$[$CellContext`Tc$, $CellContext`Pc$]], 
      "Specifications" :> {{{$CellContext`q1$$, 0.4, "initial vapor quality"},
          0.1, 0.95, 0.05, Appearance -> 
         "Labeled"}, {{$CellContext`P2$$, 15, "final pressure (MPa)"}, 1, 20, 
         0.1, Appearance -> "Labeled"}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{401., {65., 72.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.668280499771947*^9, 3.6682805604450703`*^9, {3.6682806181879883`*^9, 
   3.668280671130955*^9}, {3.6682807237004786`*^9, 3.6682808155534983`*^9}, 
   3.668280908598097*^9, 3.668281011930713*^9, 3.6682810434415874`*^9, {
   3.6682811279549685`*^9, 3.668281171220457*^9}, {3.6682812152549458`*^9, 
   3.668281225222967*^9}, {3.668281335120242*^9, 3.66828134512289*^9}, {
   3.668281456804357*^9, 3.6682815998844633`*^9}, 3.6682816518675737`*^9, 
   3.668281702589324*^9, {3.6682823343689566`*^9, 3.6682823662146215`*^9}, {
   3.668282431641245*^9, 3.668282439783684*^9}, {3.66828247516696*^9, 
   3.6682825032956195`*^9}, {3.668282537125492*^9, 3.668282552570326*^9}, 
   3.6682825849075966`*^9, {3.668282629287489*^9, 3.668282657248747*^9}, {
   3.6682827024966416`*^9, 3.668282726140291*^9}, 3.6682828304411354`*^9, 
   3.6682828918486624`*^9, {3.6682830110911465`*^9, 3.668283034063995*^9}, 
   3.668283074836438*^9, 3.6682832535337744`*^9, 3.6682833211987143`*^9, 
   3.6682834421999674`*^9, 3.6682834749070387`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"Quiet", "@", 
     RowBox[{
      RowBox[{"Interpolation", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"sL", "[", 
             RowBox[{"#", ",", "P2"}], "]"}], ",", "#"}], "}"}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"T1", ",", 
           RowBox[{"Tsat", "@", "P2"}], ",", "2"}], "]"}]}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "s", 
      "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"s", ",", "39", ",", "116"}], "}"}]}], "]"}], "*)"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"func", ",", "data"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"func", "[", "x_", "]"}], ":=", 
     RowBox[{"Sin", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"data", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0.5"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"data", "[", 
            RowBox[{"[", "#", "]"}], "]"}], ",", 
           RowBox[{"func", "[", 
            RowBox[{"data", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], ",", "Last"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.6682820391629643`*^9, 3.6682820578952875`*^9}, {
  3.6682821257841024`*^9, 3.6682822870340595`*^9}}],

Cell[BoxData["0.5`"], "Output",
 CellChangeTimes->{
  3.6682821984818635`*^9, {3.6682822620590057`*^9, 3.668282287589061*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"N", "@", 
    RowBox[{"Sin", "[", "#", "]"}]}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"0.5", ",", "1"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6682820866818123`*^9, 3.668282109031867*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.479425538604203`", ",", "0.8414709848078965`"}], "}"}]], "Output",
 CellChangeTimes->{{3.6682820928972273`*^9, 3.6682821094238677`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"Z", "[", 
     RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "a2", ",", "a1", ",", "a0", ",", "p", ",", "q", ",", "r", ",", "x", 
        ",", "zlist"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a2", "=", 
        RowBox[{
         RowBox[{"B", "[", 
          RowBox[{"T", ",", "P"}], "]"}], "-", "1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"a1", "=", 
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"T", ",", "P"}], "]"}], "-", 
         RowBox[{"3", "*", 
          SuperscriptBox[
           RowBox[{"B", "[", 
            RowBox[{"T", ",", "P"}], "]"}], "2"]}], "-", 
         RowBox[{"2", "*", 
          RowBox[{"B", "[", 
           RowBox[{"T", ",", "P"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"a0", "=", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", 
             RowBox[{"T", ",", "P"}], "]"}], "*", 
            RowBox[{"B", "[", 
             RowBox[{"T", ",", "P"}], "]"}]}], "-", 
           SuperscriptBox[
            RowBox[{"B", "[", 
             RowBox[{"T", ",", "P"}], "]"}], "2"], "-", 
           SuperscriptBox[
            RowBox[{"B", "[", 
             RowBox[{"T", ",", "P"}], "]"}], "3"]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", "*", "a1"}], "-", 
           SuperscriptBox["a2", "2"]}], ")"}], "/", "3"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"q", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "*", 
            SuperscriptBox["a2", "3"]}], "-", 
           RowBox[{"9", "*", "a2", "*", "a1"}], "+", 
           RowBox[{"27", "*", "a0"}]}], ")"}], "/", "27"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{
         RowBox[{
          SuperscriptBox["q", "2"], "/", "4"}], "+", 
         RowBox[{
          SuperscriptBox["p", "3"], "/", "27"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"x", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"r", ">", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"CubeRoot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "q"}], "/", "2"}], "+", 
              SqrtBox["r"]}], "]"}], "+", 
            RowBox[{"CubeRoot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "q"}], "/", "2"}], "-", 
              SqrtBox["r"]}], "]"}]}], "}"}], ",", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"m", ",", "\[Theta]"}], "}"}], ",", 
            RowBox[{
             RowBox[{"m", "=", 
              RowBox[{"2", "*", 
               SqrtBox[
                RowBox[{
                 RowBox[{"-", "p"}], "/", "3"}]]}]}], ";", 
             RowBox[{"\[Theta]", "=", 
              RowBox[{
               RowBox[{"ArcCos", "[", 
                FractionBox[
                 RowBox[{"3", "*", "q"}], 
                 RowBox[{"p", "*", "m"}]], "]"}], "/", "3"}]}], ";", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"m", "*", 
                RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ",", 
               RowBox[{"m", "*", 
                RowBox[{"Cos", "[", 
                 RowBox[{"\[Theta]", "+", 
                  RowBox[{"4", "*", 
                   RowBox[{"\[Pi]", "/", "3"}]}]}], "]"}]}], ",", 
               RowBox[{"m", "*", 
                RowBox[{"Cos", "[", 
                 RowBox[{"\[Theta]", "+", 
                  RowBox[{"2", "*", 
                   RowBox[{"\[Pi]", "/", "3"}]}]}], "]"}]}]}], "}"}]}]}], 
           "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"zlist", "=", 
        RowBox[{"x", "-", 
         RowBox[{"a2", "/", "3"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"First", "@", "zlist"}], 
          RowBox[{"(*", "V", "*)"}], ",", 
          RowBox[{"Last", "@", "zlist"}]}], 
         RowBox[{"(*", "L", "*)"}], "}"}]}]}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Tref", ",", "Pref", ",", "Cp", ",", "Sig", ",", "Sdep"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Tref", "=", "298"}], ";", 
       RowBox[{"Pref", "=", "0.1"}], ";", 
       RowBox[{"Cp", "=", 
        RowBox[{"{", 
         RowBox[{"32.24", ",", "0.001924", ",", "1.055*^-5", ",", 
          RowBox[{"-", "3.596*^-9"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Sig", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Cp", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", 
          RowBox[{"Log", "[", 
           RowBox[{"T", "/", "Tref"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"Cp", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"T", "-", "Tref"}], ")"}]}], "+", 
         RowBox[{
          FractionBox["1", "2"], "*", 
          RowBox[{"Cp", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["T", "2"], "-", 
            SuperscriptBox["Tref", "2"]}], ")"}]}], "+", 
         RowBox[{
          FractionBox["1", "3"], "*", 
          RowBox[{"Cp", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["T", "3"], "-", 
            SuperscriptBox["Tref", "3"]}], ")"}]}], "-", 
         RowBox[{"R", "*", 
          RowBox[{"Log", "[", 
           RowBox[{"P", "/", "Pref"}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Sdep", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"R", "*", 
            RowBox[{"Log", "[", 
             RowBox[{"#", "-", 
              RowBox[{"B", "[", 
               RowBox[{"T", ",", "P"}], "]"}]}], "]"}]}], "-", 
           RowBox[{"R", "*", 
            FractionBox[
             RowBox[{"A", "[", 
              RowBox[{"T", ",", "P"}], "]"}], 
             RowBox[{"2.8284", "*", 
              RowBox[{"B", "[", 
               RowBox[{"T", ",", "P"}], "]"}]}]], "*", "\[Kappa]", "*", 
            SqrtBox[
             FractionBox[
              RowBox[{"T", "/", "Tc"}], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"\[Kappa]", "*", 
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    SqrtBox[
                    RowBox[{"T", "/", "Tc"}]]}], ")"}]}]}], ")"}], "2"]]], 
            "*", 
            RowBox[{"Log", "[", 
             FractionBox[
              RowBox[{"#", "+", 
               RowBox[{"2.4142", "*", 
                RowBox[{"B", "[", 
                 RowBox[{"T", ",", "P"}], "]"}]}]}], 
              RowBox[{"#", "-", 
               RowBox[{"0.4142", "*", 
                RowBox[{"B", "[", 
                 RowBox[{"T", ",", "P"}], "]"}]}]}]], "]"}]}]}], "&"}], "/@", 
         RowBox[{"Z", "[", 
          RowBox[{"T", ",", "P"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Sdep", "-", 
        RowBox[{"(", 
         RowBox[{"-", "123.285"}], ")"}], "+", "Sig"}]}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V", "[", 
     RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Z", "[", 
      RowBox[{"T", ",", "P"}], "]"}], "*", "R", "*", 
     RowBox[{"T", "/", "P"}]}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], 
    "*****)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vL", "[", 
     RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
    RowBox[{"Min", "@", 
     RowBox[{"V", "[", 
      RowBox[{"T", ",", "P"}], "]"}]}]}], ";", 
   RowBox[{
    RowBox[{"vV", "[", 
     RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
    RowBox[{"Max", "@", 
     RowBox[{"V", "[", 
      RowBox[{"T", ",", "P"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sL", "[", 
     RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
    RowBox[{"Min", "@", 
     RowBox[{"S", "[", 
      RowBox[{"T", ",", "P"}], "]"}]}]}], ";", 
   RowBox[{
    RowBox[{"sV", "[", 
     RowBox[{"T_", ",", "P_"}], "]"}], ":=", 
    RowBox[{"Max", "@", 
     RowBox[{"S", "[", 
      RowBox[{"T", ",", "P"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], 
    "*****)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Tsat", "[", "P_", "]"}], ":=", 
    RowBox[{"t", "/.", 
     RowBox[{"Quiet", "@", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"10", "*", "P"}], "\[Equal]", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"5.20389", "-", 
             RowBox[{"1733.926", "/", 
              RowBox[{"(", 
               RowBox[{"t", "-", "39.485"}], ")"}]}]}], ")"}]}]}], ",", "t"}],
         "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"P1", "=", "0.5"}], ";", "\[IndentingNewLine]", 
   RowBox[{"T1", "=", 
    RowBox[{"Tsat", "@", "P1"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"V1", "=", 
    RowBox[{
     RowBox[{"q1", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"vV", "[", 
         RowBox[{"T1", ",", "P1"}], "]"}], "-", 
        RowBox[{"vL", "[", 
         RowBox[{"T1", ",", "P1"}], "]"}]}], ")"}]}], "+", 
     RowBox[{"vL", "[", 
      RowBox[{"T1", ",", "P1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"S1", "=", 
    RowBox[{
     RowBox[{"q1", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sV", "[", 
         RowBox[{"T1", ",", "P1"}], "]"}], "-", 
        RowBox[{"sL", "[", 
         RowBox[{"T1", ",", "P1"}], "]"}]}], ")"}]}], "+", 
     RowBox[{"sL", "[", 
      RowBox[{"T1", ",", "P1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"qsat", "=", 
    FractionBox[
     RowBox[{"S1", "-", 
      RowBox[{"sL", "[", 
       RowBox[{
        RowBox[{"Tsat", "@", "P2"}], ",", "P2"}], "]"}]}], 
     RowBox[{
      RowBox[{"sV", "[", 
       RowBox[{
        RowBox[{"Tsat", "@", "P2"}], ",", "P2"}], "]"}], "-", 
      RowBox[{"sL", "[", 
       RowBox[{
        RowBox[{"Tsat", "@", "P2"}], ",", "P2"}], "]"}]}]]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"T1", ",", "V1", ",", "S1"}], "}"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"{", 
    RowBox[{"qsat", ",", 
     RowBox[{"Tsat", "@", "P2"}], ",", 
     RowBox[{"Quiet", "@", 
      RowBox[{"FindRoot", "[", 
       RowBox[{
        RowBox[{"S1", "\[Equal]", 
         RowBox[{"First", "@", 
          RowBox[{"S", "[", 
           RowBox[{"t", ",", "P2"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{"Tsat", "@", "P2"}]}], "}"}]}], "]"}]}]}], "}"}], "*)"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.668281065062834*^9, 3.668281079487867*^9}}]
},
WindowSize->{667, 670},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (February 25, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 18438, 471, 1637, "Input"],
Cell[19021, 495, 11405, 219, 154, "Output"]
}, Open  ]],
Cell[30441, 717, 670, 20, 72, "Input"],
Cell[CellGroupData[{
Cell[31136, 741, 1102, 31, 112, "Input"],
Cell[32241, 774, 126, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32404, 781, 241, 7, 31, "Input"],
Cell[32648, 790, 178, 3, 31, "Output"]
}, Open  ]],
Cell[32841, 796, 11588, 329, 975, "Input"]
}
]
*)

