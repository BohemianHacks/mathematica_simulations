(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     54863,       1270]
NotebookOptionsPosition[     54457,       1252]
NotebookOutlinePosition[     54801,       1267]
CellTagsIndexPosition[     54758,       1264]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Tref", ",", "Pref", ",", "Pin", ",", "nin", ",", "Psat1", ",", "Psat2",
        ",", "CpL1", ",", "CpL2", ",", "CpV1", ",", "CpV2", ",", "Hf1", ",", 
       "Hf2", ",", "\[CapitalDelta]Hv1", ",", "\[CapitalDelta]Hv2", ",", "HF",
        ",", "HL", ",", "HV", ",", "x1", ",", "y1", ",", "sol", ",", "Qrat", 
       ",", "Tout", ",", "nV", ",", "nL", ",", "p1", ",", "p2", ",", "p3", 
       ",", "p4", ",", "diam", ",", "height", ",", "arch", ",", "radius", ",",
        "func"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Tref", "=", "298"}], ";", 
      RowBox[{"Pref", "=", "1"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Pin", "=", "20"}], ";", 
      RowBox[{"(*", "bar", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"nin", "=", "1"}], ";", 
      RowBox[{"(*", "mol", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"z1", "=", "0.3"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Psat1", "[", "T_", "]"}], "=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"5.15853", "-", 
          RowBox[{"1569.613", "/", 
           RowBox[{"(", 
            RowBox[{"T", "-", "34.846"}], ")"}]}]}], ")"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"bar", ",", " ", "K"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Psat2", "[", "T_", "]"}], "=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"4.92531", "-", 
          RowBox[{"1432.526", "/", 
           RowBox[{"(", 
            RowBox[{"T", "-", "61.819"}], ")"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Qrat", "[", "n_", "]"}], "=", 
       RowBox[{"n", "/", "nin"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x1", "[", 
        RowBox[{"T_", ",", "n_"}], "]"}], "=", 
       FractionBox["z1", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"Qrat", "[", "n", "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Psat1", "[", "T", "]"}], "/", "Pout"}], "-", "1"}], 
           ")"}]}]}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"y1", "[", 
        RowBox[{"T_", ",", "n_"}], "]"}], "=", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"T", ",", "n"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Psat1", "[", "T", "]"}], "/", "Pout"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CpL1", "[", "T_", "]"}], "=", 
       RowBox[{"111.7", "-", 
        RowBox[{"0.4264", "*", 
         RowBox[{"(", 
          RowBox[{"T", "-", "Tref"}], ")"}]}], "+", 
        RowBox[{"0.00109", "*", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"T", "-", "Tref"}], ")"}], "2"]}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"J", "/", "mol"}], "/", "K"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CpL2", "[", "T_", "]"}], "=", 
       RowBox[{"281.6", "-", 
        RowBox[{"1.435", "*", 
         RowBox[{"(", 
          RowBox[{"T", "-", "Tref"}], ")"}]}], "+", 
        RowBox[{"0.002903", "*", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"T", "-", "Tref"}], ")"}], "2"]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CpV1", "[", "T_", "]"}], "=", 
       RowBox[{"21.15", "+", 
        RowBox[{"0.07092", "*", 
         RowBox[{"(", 
          RowBox[{"T", "-", "Tref"}], ")"}]}], "+", 
        RowBox[{"2.587", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "5"}]], "*", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"T", "-", "Tref"}], ")"}], "2"]}], "-", 
        RowBox[{"2.852", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "8"}]], "*", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"T", "-", "Tref"}], ")"}], "3"]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CpV2", "[", "T_", "]"}], "=", 
       RowBox[{"9.014", "+", 
        RowBox[{"0.2141", "*", 
         RowBox[{"(", 
          RowBox[{"T", "-", "Tref"}], ")"}]}], "-", 
        RowBox[{"8.39", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "5"}]], "*", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"T", "-", "Tref"}], ")"}], "2"]}], "+", 
        RowBox[{"1.373", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "9"}]], "*", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"T", "-", "Tref"}], ")"}], "3"]}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Hf1", "=", 
       RowBox[{"-", "74.8936"}]}], ";", 
      RowBox[{"Hf2", "=", 
       RowBox[{"-", "83.82"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"kJ", "/", "mol"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]Hv1", "=", "35.3"}], ";", 
      RowBox[{"\[CapitalDelta]Hv2", "=", "38.6"}], ";", 
      RowBox[{"(*", 
       RowBox[{"kJ", "/", "mol"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"HF", "=", 
       RowBox[{
        RowBox[{"z1", "*", 
         RowBox[{"(", 
          RowBox[{"Hf1", "+", 
           RowBox[{"CpL1", "[", "Tin", "]"}], "-", "\[CapitalDelta]Hv1"}], 
          ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "z1"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"Hf2", "+", 
           RowBox[{"CpL2", "[", "Tin", "]"}], "-", "\[CapitalDelta]Hv2"}], 
          ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"HL", "[", 
        RowBox[{"T_", ",", "n_"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"x1", "[", 
          RowBox[{"T", ",", "n"}], "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"Hf1", "+", 
           RowBox[{"CpL1", "[", "T", "]"}], "-", "\[CapitalDelta]Hv1"}], 
          ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"x1", "[", 
            RowBox[{"T", ",", "n"}], "]"}]}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"Hf2", "+", 
           RowBox[{"CpL2", "[", "T", "]"}], "-", "\[CapitalDelta]Hv2"}], 
          ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"HV", "[", 
        RowBox[{"T_", ",", "n_"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"y1", "[", 
          RowBox[{"T", ",", "n"}], "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"Hf1", "+", 
           RowBox[{"CpV1", "[", "T", "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"y1", "[", 
            RowBox[{"T", ",", "n"}], "]"}]}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"Hf2", "+", 
           RowBox[{"CpV2", "[", "T", "]"}]}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"Quiet", "@", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"z1", "*", 
               FractionBox[
                RowBox[{"1", "-", 
                 RowBox[{
                  RowBox[{"Psat1", "[", "tout", "]"}], "/", "Pout"}]}], 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"Qrat", "[", "nv", "]"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Psat1", "[", "tout", "]"}], "/", "Pout"}], "-", 
                    "1"}], ")"}]}]}]]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "z1"}], ")"}], "*", 
               FractionBox[
                RowBox[{"1", "-", 
                 RowBox[{
                  RowBox[{"Psat2", "[", "tout", "]"}], "/", "Pout"}]}], 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"Qrat", "[", "nv", "]"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Psat2", "[", "tout", "]"}], "/", "Pout"}], "-", 
                    "1"}], ")"}]}]}]]}]}], "\[Equal]", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"HF", "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"Qrat", "[", "nv", "]"}]}], ")"}], "*", 
               RowBox[{"HL", "[", 
                RowBox[{"tout", ",", "nv"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"Qrat", "[", "nv", "]"}], "*", 
               RowBox[{"HV", "[", 
                RowBox[{"tout", ",", "nv"}], "]"}]}]}], "\[Equal]", "0"}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"tout", ",", "300"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"nv", ",", "1"}], "}"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Tout", "=", 
       RowBox[{"tout", "/.", "sol"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nV", "=", 
       RowBox[{"nv", "/.", "sol"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nL", "=", 
       RowBox[{"nin", "-", "nV"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"diam", "=", "2"}], ";", 
      RowBox[{"height", "=", "3"}], ";", 
      RowBox[{"arch", "=", "0.85"}], ";", 
      RowBox[{"radius", "=", 
       RowBox[{"diam", "/", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"func", "[", "x_", "]"}], "=", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", "radius", ")"}], "2"], "-", 
         SuperscriptBox["x", "2"]}]]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"p1", "=", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"GrayLevel", "[", "0.5", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"FilledCurve", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Line", "[", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", "radius"}], ",", 
                    RowBox[{
                    RowBox[{"arch", "*", 
                    RowBox[{"func", "[", "x", "]"}]}], "+", "height"}]}], 
                    "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"-", "radius"}], ",", "radius", ",", "0.01"}], 
                    "}"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Line", "[", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", "radius"}], ",", 
                    RowBox[{
                    RowBox[{"-", "arch"}], "*", 
                    RowBox[{"func", "[", "x", "]"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"-", "radius"}], ",", "radius", ",", "0.01"}], 
                    "}"}]}], "]"}], "]"}]}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"FilledCurve", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "height"}], "}"}]}], "}"}], "]"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"diam", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"diam", ",", "height"}], "}"}]}], "}"}], "]"}]}], 
               "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"x", "+", "radius"}], ",", 
                  RowBox[{
                   RowBox[{"arch", "*", 
                    RowBox[{"func", "[", "x", "]"}]}], "+", "height"}]}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", 
                  RowBox[{"-", "radius"}], ",", "radius", ",", "0.01"}], 
                 "}"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Line", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"x", "+", "radius"}], ",", 
                  RowBox[{
                   RowBox[{"-", "arch"}], "*", 
                   RowBox[{"func", "[", "x", "]"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", 
                  RowBox[{"-", "radius"}], ",", "radius", ",", "0.01"}], 
                 "}"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "height"}], "}"}]}], "}"}], "]"}], ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"diam", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"diam", ",", "height"}], "}"}]}], "}"}], "]"}]}], 
            "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", 
             RowBox[{"Arrowheads", "[", "0.075", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1.5"}], ",", 
                  RowBox[{"0.5", "*", "height"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"0.5", "*", "height"}]}], "}"}]}], "}"}], "]"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"radius", ",", 
                  RowBox[{"height", "+", "arch"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"radius", ",", 
                  RowBox[{"height", "+", "arch", "+", "radius"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"1.5", "*", "diam"}], ",", 
                  RowBox[{"height", "+", "arch", "+", "radius"}]}], "}"}]}], 
               "}"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"radius", ",", 
                  RowBox[{"-", "arch"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"radius", ",", 
                  RowBox[{
                   RowBox[{"-", "arch"}], "-", "radius"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"1.5", "*", "diam"}], ",", 
                  RowBox[{
                   RowBox[{"-", "arch"}], "-", "radius"}]}], "}"}]}], "}"}], 
              "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"Column", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(n\), \(in\)]\) = \>\"", "nin"}],
                     ",", "\"\< mol\>\""}], "}"}], "]"}], ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(z\), \(1\)]\) = \>\"", ",", 
                    "z1"}], "}"}], "]"}], ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(z\), \(2\)]\) = \>\"", ",", 
                    RowBox[{"1", "-", "z1"}]}], "}"}], "]"}]}], "}"}], "]"}], 
                  ",", "17"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "1.3"}], "}"}]}], "]"}], ","}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"Framed", "@", 
                  RowBox[{"Grid", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(n\), \(in\)]\) =\>\"", ",", 
                    "nin", ",", "\"\<mol\>\""}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(z\), \(1\)]\) =\>\"", ",", 
                    "z1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(z\), \(2\)]\) =\>\"", ",", 
                    RowBox[{"1", "-", "z1"}]}], "}"}]}], "}"}], "]"}]}], ",", 
                 "17"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "1.3"}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Column", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SuperscriptBox[\(n\), \(L\)]\) = \>\"", ",", 
                    "nL", ",", "\"\< mol\>\""}], "}"}], "]"}], ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(x\), \(1\)]\) = \>\"", ",", 
                    RowBox[{"x1", "[", 
                    RowBox[{"Tout", ",", "nV"}], "]"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(x\), \(2\)]\) = \>\"", ",", 
                    RowBox[{"1", "-", 
                    RowBox[{"x1", "[", 
                    RowBox[{"Tout", ",", "nV"}], "]"}]}]}], "}"}], "]"}]}], 
                    "}"}], "]"}], ",", "17"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"1.55", "*", "diam"}], ",", 
                   RowBox[{
                    RowBox[{"-", "arch"}], "-", "radius"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ","}], 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"Framed", "@", 
                  RowBox[{"Grid", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SuperscriptBox[\(n\), \(L\)]\) =\>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"nL", ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "2"}], "}"}]}], "]"}], ",", 
                    "\"\<mol\>\""}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(x\), \(1\)]\) =\>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"x1", "[", 
                    RowBox[{"Tout", ",", "nV"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(x\), \(2\)]\) =\>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"1", "-", 
                    RowBox[{"x1", "[", 
                    RowBox[{"Tout", ",", "nV"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "}"}]}], "}"}],
                    "]"}]}], ",", "17"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"1.55", "*", "diam"}], ",", 
                 RowBox[{
                  RowBox[{"-", "arch"}], "-", "radius"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"Column", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SuperscriptBox[\(n\), \(V\)]\) = \>\"", ",", 
                    "nV", ",", "\"\< mol\>\""}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(y\), \(1\)]\) = \>\"", ",", 
                    RowBox[{"y1", "[", 
                    RowBox[{"Tout", ",", "nV"}], "]"}]}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(y\), \(2\)]\) = \>\"", ",", 
                    RowBox[{"1", "-", 
                    RowBox[{"y1", "[", 
                    RowBox[{"Tout", ",", "nV"}], "]"}]}]}], "}"}], "]"}]}], 
                   "\[IndentingNewLine]", "}"}], "]"}], ",", "17"}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"1.55", "*", "diam"}], ",", 
                 RowBox[{"height", "+", "arch", "+", "radius"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ","}], 
            "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Column", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(T\), \(in\)]\) = \>\"", ",", 
                    "Tin", ",", "\"\< K\>\""}], "}"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(P\), \(in\)]\) = \>\"", ",", 
                    "Pin", ",", "\"\< bar\>\""}], "}"}], "]"}]}], 
                 "\[IndentingNewLine]", "}"}], "]"}], ",", "17"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "radius"}], ",", 
               RowBox[{"height", "+", 
                RowBox[{"0.5", "*", "arch"}]}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Column", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(T\), \(out\)]\) = \>\"", ",", 
                    "Tout", ",", "\"\< K\>\""}], "}"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(P\), \(out\)]\) = \>\"", ",", 
                    "Pout", ",", "\"\< bar\>\""}], "}"}], "]"}]}], 
                 "\[IndentingNewLine]", "}"}], "]"}], ",", "17"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1.75", "*", "diam"}], ",", 
               RowBox[{"0.5", "*", "height"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{"p2", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", 
               RowBox[{
                RowBox[{"-", "arch"}], "-", "radius"}]}], "}"}]}], "]"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{"p3", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", 
               RowBox[{"height", "+", "arch", "+", "radius"}]}], "}"}]}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{"p4", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "3"}], ",", 
               RowBox[{"0.5", "*", "height"}]}], "}"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"400", ",", "392"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"p2", "=", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"BarChart", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"nL", ",", "nV"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ChartStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"Blue", ",", "Green"}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"175", ",", "392"}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Frame", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"True", ",", "None"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "None"}], "}"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"None", ",", 
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<mols  exiting \>\"", ",", "17"}], "]"}]}], 
               "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.75"}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ChartLabels", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<liquid\>\"", ",", "16"}], "]"}], ",", 
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<vapor\>\"", ",", "16"}], "]"}]}], "}"}]}], ",", 
             RowBox[{"LabelStyle", "\[Rule]", 
              RowBox[{"GrayLevel", "[", "0.2", "]"}]}]}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Graphics", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(x\), \(1\)]\) = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"x1", "[", 
                    RowBox[{"Tout", ",", "nV"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "}"}], "]"}], 
                  ",", "15"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"nL", "+", "0.025"}]}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(y\), \(1\)]\) = \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"y1", "[", 
                    RowBox[{"Tout", ",", "nV"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "}"}], "]"}], 
                  ",", "15"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", 
                  RowBox[{"nV", "+", "0.025"}]}], "}"}]}], "]"}]}], "}"}], 
            "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Show", "[", "p1", "]"}], ",", 
          RowBox[{"Show", "[", "p2", "]"}]}], "}"}], "]"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"p2", "=", 
       RowBox[{"BarChart", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x1", "[", 
            RowBox[{"Tout", ",", "nV"}], "]"}], ",", 
           RowBox[{"1", "-", 
            RowBox[{"x1", "[", 
             RowBox[{"Tout", ",", "nV"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"ChartStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Blue", ",", "Green"}], "}"}]}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"100", ",", "100"}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p3", "=", 
       RowBox[{"BarChart", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"y1", "[", 
            RowBox[{"Tout", ",", "nV"}], "]"}], ",", 
           RowBox[{"1", "-", 
            RowBox[{"y1", "[", 
             RowBox[{"Tout", ",", "nV"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"ChartStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Blue", ",", "Green"}], "}"}]}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"100", ",", "100"}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p4", "=", 
       RowBox[{"BarChart", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"z1", ",", 
           RowBox[{"1", "-", "z1"}]}], "}"}], ",", 
         RowBox[{"ChartStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Blue", ",", "Green"}], "}"}]}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"100", ",", "100"}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "[", "p1", "]"}]}]}], "\[IndentingNewLine]", "]"}], ",",
    "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Tin", ",", "425", ",", "\"\<inlet temperature (K)\>\""}], 
       "}"}], ",", "423", ",", "500", ",", "1", ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Pout", ",", "2", ",", "\"\<outlet pressure (bar)\>\""}], 
       "}"}], ",", "1", ",", "5", ",", "0.1", ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"z1", ",", "0.3", ",", "\"\<methane feed composition\>\""}], 
       "}"}], ",", "0.1", ",", "0.9", ",", "0.05", ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6392402918228874`*^9, 3.6392403777148*^9}, {
   3.6392404310458508`*^9, 3.6392404349630747`*^9}, {3.639240465196804*^9, 
   3.6392405478315306`*^9}, {3.6392405810964327`*^9, 
   3.6392406423879385`*^9}, {3.6392406790160336`*^9, 
   3.6392407980268407`*^9}, {3.6392408345869317`*^9, 
   3.6392408574752407`*^9}, {3.6392408901221085`*^9, 
   3.6392410140141945`*^9}, {3.639241064417077*^9, 3.639241081301043*^9}, {
   3.639241465728031*^9, 3.6392415142378054`*^9}, {3.6394205401192026`*^9, 
   3.639420541457279*^9}, {3.63942301871397*^9, 3.6394230260003867`*^9}, {
   3.6394875095586243`*^9, 3.6394875124317884`*^9}, {3.6394877018826246`*^9, 
   3.6394877035567207`*^9}, {3.639487820142389*^9, 3.6394878872652283`*^9}, {
   3.639488005259977*^9, 3.6394885354182997`*^9}, {3.6394886550791445`*^9, 
   3.6394887485804925`*^9}, {3.6394888706144724`*^9, 3.639489021847122*^9}, {
   3.6394890653706117`*^9, 3.6394892337512426`*^9}, {3.6394895022846017`*^9, 
   3.6394895909246716`*^9}, {3.639489632380043*^9, 3.6394897464245653`*^9}, {
   3.6394897964014244`*^9, 3.6394899495341825`*^9}, {3.639489987793371*^9, 
   3.6394901050000753`*^9}, {3.639490147293494*^9, 3.639490219828643*^9}, {
   3.639490304065461*^9, 3.639490326653753*^9}, {3.6394904075573807`*^9, 
   3.6394908041090617`*^9}, {3.639491207959161*^9, 3.6394912383719*^9}, {
   3.639491317782442*^9, 3.639491331146207*^9}, {3.6394926034169765`*^9, 
   3.6394926333216867`*^9}, {3.639493756732942*^9, 3.6394938656821737`*^9}, {
   3.639494080979488*^9, 3.639494232409149*^9}, {3.6394943106006217`*^9, 
   3.6394943523850117`*^9}, {3.639494394532422*^9, 3.639494405349041*^9}, {
   3.639494441083085*^9, 3.6394948585269613`*^9}, {3.6394971807257833`*^9, 
   3.639497475125622*^9}, {3.639839745803666*^9, 3.639839764692746*^9}, {
   3.639839800836814*^9, 3.6398399866294403`*^9}, {3.639849884551569*^9, 
   3.6398499454180503`*^9}, {3.6400190939960127`*^9, 
   3.6400191802059436`*^9}, {3.6400192310998545`*^9, 
   3.6400192651888046`*^9}, {3.640019604553215*^9, 3.6400196095675015`*^9}, {
   3.640019653385008*^9, 3.640019720455844*^9}, {3.640019764426359*^9, 
   3.64001983577944*^9}, {3.640019868086288*^9, 3.6400199854540014`*^9}, {
   3.6400200712039056`*^9, 3.640020222932584*^9}, {3.6400202855791674`*^9, 
   3.640020293439617*^9}, {3.6400203439565067`*^9, 3.6400203951814365`*^9}, {
   3.6400205490642376`*^9, 3.640020591834684*^9}, {3.6400206674460087`*^9, 
   3.6400208645072803`*^9}, {3.6400210606274977`*^9, 3.640021119253851*^9}, 
   3.6400212540205593`*^9, {3.640021302257318*^9, 3.640021313352953*^9}, {
   3.6400280662831984`*^9, 3.6400280930407286`*^9}, {3.640028166557934*^9, 
   3.640028185298005*^9}, {3.640028255556024*^9, 3.6400283538446455`*^9}, {
   3.640028389102662*^9, 3.6400284093848224`*^9}, {3.6400284487290726`*^9, 
   3.6400284533943396`*^9}, {3.6400286517056828`*^9, 
   3.6400287224797306`*^9}, {3.640028753105482*^9, 3.64002878628738*^9}, {
   3.640028848836958*^9, 3.640028863751811*^9}, {3.6400289342848454`*^9, 
   3.6400289688788233`*^9}, {3.6400295658089657`*^9, 3.64002958056781*^9}, {
   3.640029617544925*^9, 3.640029665048642*^9}, {3.640029772425784*^9, 
   3.6400297803922396`*^9}, {3.6400301464791784`*^9, 3.6400301941239033`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`Pout$$ = 2, $CellContext`Tin$$ = 
    425, $CellContext`z1$$ = 0.3, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`Tin$$], 425, "inlet temperature (K)"}, 423, 500, 
      1}, {{
       Hold[$CellContext`Pout$$], 2, "outlet pressure (bar)"}, 1, 5, 0.1}, {{
       Hold[$CellContext`z1$$], 0.3, "methane feed composition"}, 0.1, 0.9, 
      0.05}}, Typeset`size$$ = {400., {194., 198.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`Tin$4391$$ = 0, $CellContext`Pout$4392$$ = 
    0, $CellContext`z1$4393$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`Pout$$ = 2, $CellContext`Tin$$ = 
        425, $CellContext`z1$$ = 0.3}, "ControllerVariables" :> {
        Hold[$CellContext`Tin$$, $CellContext`Tin$4391$$, 0], 
        Hold[$CellContext`Pout$$, $CellContext`Pout$4392$$, 0], 
        Hold[$CellContext`z1$$, $CellContext`z1$4393$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`Tref$, $CellContext`Pref$, $CellContext`Pin$, \
$CellContext`nin$, $CellContext`Psat1$, $CellContext`Psat2$, \
$CellContext`CpL1$, $CellContext`CpL2$, $CellContext`CpV1$, \
$CellContext`CpV2$, $CellContext`Hf1$, $CellContext`Hf2$, $CellContext`\
\[CapitalDelta]Hv1$, $CellContext`\[CapitalDelta]Hv2$, $CellContext`HF$, \
$CellContext`HL$, $CellContext`HV$, $CellContext`x1$, $CellContext`y1$, \
$CellContext`sol$, $CellContext`Qrat$, $CellContext`Tout$, $CellContext`nV$, \
$CellContext`nL$, $CellContext`p1$, $CellContext`p2$, $CellContext`p3$, \
$CellContext`p4$, $CellContext`diam$, $CellContext`height$, \
$CellContext`arch$, $CellContext`radius$, $CellContext`func$}, \
$CellContext`Tref$ = 298; $CellContext`Pref$ = 1; $CellContext`Pin$ = 
         20; $CellContext`nin$ = 1; $CellContext`Psat1$[
           Pattern[$CellContext`T, 
            Blank[]]] = 
         10^(5.15853 - 1569.613/($CellContext`T - 
           34.846)); $CellContext`Psat2$[
           Pattern[$CellContext`T, 
            Blank[]]] = 
         10^(4.92531 - 1432.526/($CellContext`T - 61.819)); $CellContext`Qrat$[
           Pattern[$CellContext`n$, 
            Blank[]]] = $CellContext`n$/$CellContext`nin$; $CellContext`x1$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`n$, 
            Blank[]]] = $CellContext`z1$$/(
          1 + $CellContext`Qrat$[$CellContext`n$] \
($CellContext`Psat1$[$CellContext`T$]/$CellContext`Pout$$ - 
            1)); $CellContext`y1$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`n$, 
            
            Blank[]]] = $CellContext`x1$[$CellContext`T$, $CellContext`n$] \
($CellContext`Psat1$[$CellContext`T$]/$CellContext`Pout$$); $CellContext`CpL1$[
           Pattern[$CellContext`T$, 
            Blank[]]] = 
         111.7 - 0.4264 ($CellContext`T$ - $CellContext`Tref$) + 
          0.00109 ($CellContext`T$ - $CellContext`Tref$)^2; $CellContext`CpL2$[
           Pattern[$CellContext`T$, 
            Blank[]]] = 
         281.6 - 1.435 ($CellContext`T$ - $CellContext`Tref$) + 
          0.002903 ($CellContext`T$ - $CellContext`Tref$)^2; \
$CellContext`CpV1$[
           Pattern[$CellContext`T$, 
            Blank[]]] = 
         21.15 + 0.07092 ($CellContext`T$ - $CellContext`Tref$) + 
          2.587 10^(-5) ($CellContext`T$ - $CellContext`Tref$)^2 - 2.852 
          10^(-8) ($CellContext`T$ - $CellContext`Tref$)^3; $CellContext`CpV2$[
           Pattern[$CellContext`T$, 
            Blank[]]] = 
         9.014 + 0.2141 ($CellContext`T$ - $CellContext`Tref$) - 8.39 
          10^(-5) ($CellContext`T$ - $CellContext`Tref$)^2 + 
          1.373 10^(-9) ($CellContext`T$ - $CellContext`Tref$)^3; \
$CellContext`Hf1$ = -74.8936; $CellContext`Hf2$ = -83.82; $CellContext`\
\[CapitalDelta]Hv1$ = 35.3; $CellContext`\[CapitalDelta]Hv2$ = 
         38.6; $CellContext`HF$ = $CellContext`z1$$ ($CellContext`Hf1$ + \
$CellContext`CpL1$[$CellContext`Tin$$] - $CellContext`\[CapitalDelta]Hv1$) + (
            1 - $CellContext`z1$$) ($CellContext`Hf2$ + \
$CellContext`CpL2$[$CellContext`Tin$$] - $CellContext`\[CapitalDelta]Hv2$); \
$CellContext`HL$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`n$, 
            
            Blank[]]] = $CellContext`x1$[$CellContext`T$, $CellContext`n$] \
($CellContext`Hf1$ + $CellContext`CpL1$[$CellContext`T$] - $CellContext`\
\[CapitalDelta]Hv1$) + (
            1 - $CellContext`x1$[$CellContext`T$, $CellContext`n$]) \
($CellContext`Hf2$ + $CellContext`CpL2$[$CellContext`T$] - $CellContext`\
\[CapitalDelta]Hv2$); $CellContext`HV$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`n$, 
            
            Blank[]]] = $CellContext`y1$[$CellContext`T$, $CellContext`n$] \
($CellContext`Hf1$ + $CellContext`CpV1$[$CellContext`T$]) + (
            1 - $CellContext`y1$[$CellContext`T$, $CellContext`n$]) \
($CellContext`Hf2$ + $CellContext`CpV2$[$CellContext`T$]); $CellContext`sol$ = 
         Quiet[
           
           FindRoot[{$CellContext`z1$$ ((
                 1 - $CellContext`Psat1$[$CellContext`tout]/$CellContext`Pout$\
$)/(1 + $CellContext`Qrat$[$CellContext`nv] \
($CellContext`Psat1$[$CellContext`tout]/$CellContext`Pout$$ - 1))) + (
                1 - $CellContext`z1$$) ((
                 1 - $CellContext`Psat2$[$CellContext`tout]/$CellContext`Pout$\
$)/(1 + $CellContext`Qrat$[$CellContext`nv] \
($CellContext`Psat2$[$CellContext`tout]/$CellContext`Pout$$ - 1))) == 
             0, $CellContext`HF$ - (
               1 - $CellContext`Qrat$[$CellContext`nv]) \
$CellContext`HL$[$CellContext`tout, $CellContext`nv] - \
$CellContext`Qrat$[$CellContext`nv] $CellContext`HV$[$CellContext`tout, \
$CellContext`nv] == 
             0}, {{$CellContext`tout, 300}, {$CellContext`nv, 
              1}}]]; $CellContext`Tout$ = 
         ReplaceAll[$CellContext`tout, $CellContext`sol$]; $CellContext`nV$ = 
         ReplaceAll[$CellContext`nv, $CellContext`sol$]; $CellContext`nL$ = \
$CellContext`nin$ - $CellContext`nV$; $CellContext`diam$ = 
         2; $CellContext`height$ = 3; $CellContext`arch$ = 
         0.85; $CellContext`radius$ = $CellContext`diam$/2; $CellContext`func$[
           Pattern[$CellContext`x$, 
            Blank[]]] = ($CellContext`radius$^2 - $CellContext`x$^2)^
          Rational[1, 2]; $CellContext`p1$ = Graphics[{{
             GrayLevel[0.5], 
             FilledCurve[{
               Line[
                
                Table[{$CellContext`x + $CellContext`radius$, \
$CellContext`arch$ $CellContext`func$[$CellContext`x] + \
$CellContext`height$}, {$CellContext`x, -$CellContext`radius$, \
$CellContext`radius$, 0.01}]], 
               Line[
                
                Table[{$CellContext`x + $CellContext`radius$, \
(-$CellContext`arch$) $CellContext`func$[$CellContext`x]}, {$CellContext`x, \
-$CellContext`radius$, $CellContext`radius$, 0.01}]]}], 
             FilledCurve[{
               Line[{{0, 0}, {0, $CellContext`height$}}], 
               
               Line[{{$CellContext`diam$, 
                  0}, {$CellContext`diam$, $CellContext`height$}}]}]}, {Thick, 
             Line[
              
              Table[{$CellContext`x + $CellContext`radius$, \
$CellContext`arch$ $CellContext`func$[$CellContext`x] + \
$CellContext`height$}, {$CellContext`x, -$CellContext`radius$, \
$CellContext`radius$, 0.01}]], 
             Line[
              
              Table[{$CellContext`x + $CellContext`radius$, \
(-$CellContext`arch$) $CellContext`func$[$CellContext`x]}, {$CellContext`x, \
-$CellContext`radius$, $CellContext`radius$, 0.01}]], 
             Line[{{0, 0}, {0, $CellContext`height$}}], 
             
             Line[{{$CellContext`diam$, 
                0}, {$CellContext`diam$, $CellContext`height$}}]}, {Thick, 
             Arrowheads[0.075], 
             
             Arrow[{{-1.5, 0.5 $CellContext`height$}, {
               0, 0.5 $CellContext`height$}}], 
             
             Arrow[{{$CellContext`radius$, $CellContext`height$ + \
$CellContext`arch$}, {$CellContext`radius$, $CellContext`height$ + \
$CellContext`arch$ + $CellContext`radius$}, {
               1.5 $CellContext`diam$, $CellContext`height$ + \
$CellContext`arch$ + $CellContext`radius$}}], 
             
             Arrow[{{$CellContext`radius$, -$CellContext`arch$}, \
{$CellContext`radius$, -$CellContext`arch$ - $CellContext`radius$}, {
               1.5 $CellContext`diam$, -$CellContext`arch$ - \
$CellContext`radius$}}]}, 
            Text[
             Style[
              Column[{
                
                Row[{"\!\(\*SubscriptBox[\(T\), \(in\)]\) = ", \
$CellContext`Tin$$, " K"}], 
                
                Row[{"\!\(\*SubscriptBox[\(P\), \(in\)]\) = ", \
$CellContext`Pin$, " bar"}]}], 
              17], {-$CellContext`radius$, $CellContext`height$ + 
              0.5 $CellContext`arch$}], 
            Text[
             Style[
              Column[{
                
                Row[{"\!\(\*SubscriptBox[\(T\), \(out\)]\) = ", \
$CellContext`Tout$, " K"}], 
                
                Row[{"\!\(\*SubscriptBox[\(P\), \(out\)]\) = ", \
$CellContext`Pout$$, " bar"}]}], 17], {
             1.75 $CellContext`diam$, 0.5 $CellContext`height$}], 
            
            Inset[$CellContext`p2$, {
             4, -$CellContext`arch$ - $CellContext`radius$}], 
            
            Inset[$CellContext`p3$, {
             4, $CellContext`height$ + $CellContext`arch$ + \
$CellContext`radius$}], 
            Inset[$CellContext`p4$, {-3, 0.5 $CellContext`height$}]}, 
           ImageSize -> {400, 392}]; $CellContext`p2$ = BarChart[{
            $CellContext`x1$[$CellContext`Tout$, $CellContext`nV$], 
            1 - $CellContext`x1$[$CellContext`Tout$, $CellContext`nV$]}, 
           ChartStyle -> {Blue, Green}, AspectRatio -> Full, Frame -> True, 
           ImageSize -> {100, 100}, PlotRange -> {0, 1}]; $CellContext`p3$ = 
         BarChart[{
            $CellContext`y1$[$CellContext`Tout$, $CellContext`nV$], 
            1 - $CellContext`y1$[$CellContext`Tout$, $CellContext`nV$]}, 
           ChartStyle -> {Blue, Green}, AspectRatio -> Full, Frame -> True, 
           ImageSize -> {100, 100}, PlotRange -> {0, 1}]; $CellContext`p4$ = 
         BarChart[{$CellContext`z1$$, 1 - $CellContext`z1$$}, 
           ChartStyle -> {Blue, Green}, AspectRatio -> Full, Frame -> True, 
           ImageSize -> {100, 100}, PlotRange -> {0, 1}]; 
        Show[$CellContext`p1$]], 
      "Specifications" :> {{{$CellContext`Tin$$, 425, 
          "inlet temperature (K)"}, 423, 500, 1, Appearance -> 
         "Labeled"}, {{$CellContext`Pout$$, 2, "outlet pressure (bar)"}, 1, 5,
          0.1, Appearance -> 
         "Labeled"}, {{$CellContext`z1$$, 0.3, "methane feed composition"}, 
         0.1, 0.9, 0.05, Appearance -> "Labeled"}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{451., {266., 273.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.639494337383154*^9, 3.639494407747178*^9, 3.639494456526968*^9, {
   3.639494487239725*^9, 3.639494533812389*^9}, {3.6394945668582788`*^9, 
   3.6394945934818015`*^9}, {3.6394946532672215`*^9, 3.639494760490354*^9}, {
   3.639494796929438*^9, 3.639494858803977*^9}, 3.6394971926694665`*^9, {
   3.6394972453914824`*^9, 3.639497267665756*^9}, 3.6394973437601085`*^9, 
   3.6394974765667048`*^9, 3.6398397746243143`*^9, {3.639839837363903*^9, 
   3.639839844235296*^9}, 3.639839903295674*^9, {3.63983996355412*^9, 
   3.639839987412485*^9}, 3.6398499566706944`*^9, 3.640019276929476*^9, 
   3.6400196106015606`*^9, {3.640019665958727*^9, 3.640019689241059*^9}, 
   3.6400198395006533`*^9, 3.6400198835161705`*^9, {3.640019915730013*^9, 
   3.6400199548782525`*^9}, {3.6400201323184013`*^9, 3.640020225038705*^9}, 
   3.6400203960094833`*^9, {3.6400205546735587`*^9, 3.640020595465892*^9}, {
   3.6400207419062676`*^9, 3.640020755593051*^9}, 3.640020865502337*^9, 
   3.64002112308607*^9, 3.640021314672028*^9, {3.640028071417492*^9, 
   3.6400280956958804`*^9}, 3.6400281861980567`*^9, 3.6400284118319626`*^9, 
   3.640028454239388*^9, 3.6400286604871845`*^9, 3.64002878785347*^9, 
   3.640028864860874*^9, 3.6400289723170204`*^9, 3.6400296684428363`*^9, 
   3.6400298079418154`*^9, 3.6400301223687997`*^9, 3.640030198200137*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"vary", " ", 
   SubscriptBox["P", "out"], " ", "too"}], "*)"}]], "Input",
 CellChangeTimes->{{3.640021664974064*^9, 3.6400216763797164`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Text", "@", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"Row", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Grid", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SubscriptBox[\(T\), \(in\)]\) =\>\"", ",", "Tin", ",", 
             "\"\<K\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SubscriptBox[\(P\), \(in\)]\) =\>\"", ",", "Pin", ",", 
             "\"\<bar\>\""}], "}"}], ",", 
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SubscriptBox[\(n\), \(in\)]\) =\>\"", ",", "nin", ",", 
             "\"\<mol\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SubscriptBox[\(z\), \(1\)]\) =\>\"", ",", "z1"}], 
            "}"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Spacer", "[", "60", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Grid", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SubscriptBox[\(T\), \(out\)]\) =\>\"", ",", "Tout", 
             ",", "\"\<K\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SubscriptBox[\(P\), \(out\)]\) =\>\"", ",", "Pout", 
             ",", "\"\<bar\>\""}], "}"}], ",", 
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(n\), \(V\)]\) =\>\"", ",", "nV", ",", 
             "\"\<mol\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<\!\(\*SubscriptBox[\(y\), \(1\)]\) =\>\"", ",", 
             RowBox[{"y1", "[", 
              RowBox[{"Tout", ",", "nV"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(n\), \(L\)]\) =\>\"", ",", "nL", ",", 
             "\"\<mol\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<\!\(\*SubscriptBox[\(x\), \(1\)]\) =\>\"", ",", 
             RowBox[{"x1", "[", 
              RowBox[{"Tout", ",", "nV"}], "]"}]}], "}"}]}], "}"}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], "]"}], ",", "17"}], "]"}]}], 
  "*)"}]], "Input"]
},
WindowSize->{1366, 686},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.1 for Microsoft Windows (64-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 38045, 900, 2294, "Input"],
Cell[38628, 924, 13266, 258, 556, "Output"]
}, Open  ]],
Cell[51909, 1185, 182, 4, 31, "Input"],
Cell[52094, 1191, 2359, 59, 118, "Input"]
}
]
*)

(* End of internal cache information *)
