(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     49965,       1197]
NotebookOptionsPosition[     49598,       1180]
NotebookOutlinePosition[     49942,       1195]
CellTagsIndexPosition[     49899,       1192]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "px", ",", "rBlank", ",", "rPhase", ",", "x1", ",", "x2", ",", "tie", 
       ",", "rPhasePlot", ",", "near", ",", "ytie1", ",", "xtie1", ",", 
       "xtie2", ",", "lever", ",", "loc", ",", "tieline"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"px", "=", 
        RowBox[{"pt", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", 
       RowBox[{"py", "=", 
        RowBox[{"pt", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"px", "=", "0.3"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"rBlank", "=", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Thin", ",", 
             RowBox[{"GrayLevel", "[", "0.65", "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "i"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "-", "i"}], ",", "i"}], "}"}]}], "}"}], 
                  "]"}], ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"1", "-", "i"}]}], "}"}]}], "}"}], "]"}], ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "i"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "0", ",", "1", ",", "0.1"}], "}"}]}], 
              "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"EdgeForm", "[", "Thick", "]"}], ",", 
             RowBox[{"FaceForm", "[", "None", "]"}], ",", 
             RowBox[{"Polygon", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"j", ",", "15"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", 
                   RowBox[{"-", "0.03"}]}], "}"}]}], "]"}], ",", 
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"j", ",", "15"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "0.035"}], ",", "j"}], "}"}]}], "]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "0.1", ",", "0.9", ",", "0.1"}], "}"}]}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<S\>\"", ",", "18"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"1.03", ",", "0"}], "}"}]}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<A\>\"", ",", "18"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1.025"}], "}"}]}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<C\>\"", ",", "18"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.025"}], ",", 
               RowBox[{"-", "0.025"}]}], "}"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "0.1"}], ",", "1.1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "0.05"}], ",", "1.05"}], "}"}]}], "}"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rPhase", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"BezierFunction", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.1", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.12", ",", "0.7"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.37", ",", "0.46"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.9", ",", "0"}], "}"}]}], "}"}], "]"}], "[", "i", 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "1", ",", "0.025"}], "}"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"x1", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"x", "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"rPhase", "[", "x", "]"}], "\[Equal]", "y"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0.1"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"{", 
            RowBox[{
            "0.03", ",", "0.07", ",", "0.12", ",", "0.18", ",", "0.26", ",", 
             "0.32"}], "}"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"x2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"x", "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"rPhase", "[", "x", "]"}], "\[Equal]", "y"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0.9"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"{", 
            RowBox[{
            "0.05", ",", "0.13", ",", "0.2", ",", "0.28", ",", "0.37", ",", 
             "0.43"}], "}"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tie", "[", 
        RowBox[{"x_", ",", "n_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"rPhase", "[", 
             RowBox[{"x2", "[", 
              RowBox[{"[", "n", "]"}], "]"}], "]"}], "-", 
            RowBox[{"rPhase", "[", 
             RowBox[{"x1", "[", 
              RowBox[{"[", "n", "]"}], "]"}], "]"}]}], 
           RowBox[{
            RowBox[{"x2", "[", 
             RowBox[{"[", "n", "]"}], "]"}], "-", 
            RowBox[{"x1", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}]], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"x", "-", 
           RowBox[{"x1", "[", 
            RowBox[{"[", "n", "]"}], "]"}]}], ")"}]}], "+", 
        RowBox[{"rPhase", "[", 
         RowBox[{"x1", "[", 
          RowBox[{"[", "n", "]"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"loc", "[", 
        RowBox[{
        "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_", 
         ",", "c7_"}], "]"}], ":=", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"py", "\[LessEqual]", 
          RowBox[{"tie", "[", 
           RowBox[{"px", ",", "1"}], "]"}]}], ",", "c1", ",", 
         RowBox[{
          RowBox[{"tie", "[", 
           RowBox[{"px", ",", "1"}], "]"}], "<", "py", "\[LessEqual]", 
          RowBox[{"tie", "[", 
           RowBox[{"px", ",", "2"}], "]"}]}], ",", "c2", ",", 
         RowBox[{
          RowBox[{"tie", "[", 
           RowBox[{"px", ",", "2"}], "]"}], "<", "py", "\[LessEqual]", 
          RowBox[{"tie", "[", 
           RowBox[{"px", ",", "3"}], "]"}]}], ",", "c3", ",", 
         RowBox[{
          RowBox[{"tie", "[", 
           RowBox[{"px", ",", "3"}], "]"}], "<", "py", "\[LessEqual]", 
          RowBox[{"tie", "[", 
           RowBox[{"px", ",", "4"}], "]"}]}], ",", "c4", ",", 
         RowBox[{
          RowBox[{"tie", "[", 
           RowBox[{"px", ",", "4"}], "]"}], "<", "py", "\[LessEqual]", 
          RowBox[{"tie", "[", 
           RowBox[{"px", ",", "5"}], "]"}]}], ",", "c5", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tie", "[", 
           RowBox[{"px", ",", "5"}], "]"}], "<", "py", "\[LessEqual]", 
          RowBox[{"tie", "[", 
           RowBox[{"px", ",", "6"}], "]"}]}], ",", "c6", ",", 
         RowBox[{
          RowBox[{"tie", "[", 
           RowBox[{"px", ",", "6"}], "]"}], "<", "py"}], ",", "c7"}], "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"lever", "=", 
       RowBox[{"loc", "[", 
        RowBox[{
         RowBox[{"py", "/", 
          RowBox[{"tie", "[", 
           RowBox[{"px", ",", "1"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"py", "-", 
            RowBox[{"tie", "[", 
             RowBox[{"px", ",", "1"}], "]"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"tie", "[", 
             RowBox[{"px", ",", "2"}], "]"}], "-", 
            RowBox[{"tie", "[", 
             RowBox[{"px", ",", "1"}], "]"}]}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"py", "-", 
            RowBox[{"tie", "[", 
             RowBox[{"px", ",", "2"}], "]"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"tie", "[", 
             RowBox[{"px", ",", "3"}], "]"}], "-", 
            RowBox[{"tie", "[", 
             RowBox[{"px", ",", "2"}], "]"}]}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"py", "-", 
            RowBox[{"tie", "[", 
             RowBox[{"px", ",", "3"}], "]"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"tie", "[", 
             RowBox[{"px", ",", "4"}], "]"}], "-", 
            RowBox[{"tie", "[", 
             RowBox[{"px", ",", "3"}], "]"}]}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"py", "-", 
            RowBox[{"tie", "[", 
             RowBox[{"px", ",", "4"}], "]"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"tie", "[", 
             RowBox[{"px", ",", "5"}], "]"}], "-", 
            RowBox[{"tie", "[", 
             RowBox[{"px", ",", "4"}], "]"}]}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"py", "-", 
            RowBox[{"tie", "[", 
             RowBox[{"px", ",", "5"}], "]"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"tie", "[", 
             RowBox[{"px", ",", "6"}], "]"}], "-", 
            RowBox[{"tie", "[", 
             RowBox[{"px", ",", "5"}], "]"}]}], ")"}]}], ",", 
         RowBox[{"py", "-", 
          RowBox[{"tie", "[", 
           RowBox[{"px", ",", "6"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"tieline", "[", "x_", "]"}], "=", 
         RowBox[{
          RowBox[{"0.5", "*", 
           RowBox[{"(", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"loc", "[", 
              RowBox[{
               RowBox[{"tie", "[", 
                RowBox[{"0.03", ",", "1"}], "]"}], ",", 
               RowBox[{"tie", "[", 
                RowBox[{"0.07", ",", "2"}], "]"}], ",", 
               RowBox[{"tie", "[", 
                RowBox[{"0.12", ",", "3"}], "]"}], ",", 
               RowBox[{"tie", "[", 
                RowBox[{"0.18", ",", "4"}], "]"}], ",", 
               RowBox[{"tie", "[", 
                RowBox[{"0.26", ",", "5"}], "]"}], ",", 
               RowBox[{"tie", "[", 
                RowBox[{"0.32", ",", "6"}], "]"}], ",", "py"}], "]"}], "+", 
             "\[IndentingNewLine]", 
             RowBox[{"loc", "[", 
              RowBox[{
               RowBox[{"tie", "[", 
                RowBox[{"0.05", ",", "1"}], "]"}], ",", 
               RowBox[{"tie", "[", 
                RowBox[{"0.13", ",", "2"}], "]"}], ",", 
               RowBox[{"tie", "[", 
                RowBox[{"0.2", ",", "3"}], "]"}], ",", 
               RowBox[{"tie", "[", 
                RowBox[{"0.28", ",", "4"}], "]"}], ",", 
               RowBox[{"tie", "[", 
                RowBox[{"0.37", ",", "5"}], "]"}], ",", 
               RowBox[{"tie", "[", 
                RowBox[{"0.43", ",", "6"}], "]"}], ",", "py"}], "]"}]}], 
            ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"x", "-", "px"}], ")"}]}], "+", "py"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tieline", "[", "x_", "]"}], "=", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "lever"}], ")"}], "*", 
            RowBox[{"loc", "[", 
             RowBox[{"0", ",", 
              RowBox[{"tie", "[", 
               RowBox[{"0.03", ",", "1"}], "]"}], ",", 
              RowBox[{"tie", "[", 
               RowBox[{"0.07", ",", "2"}], "]"}], ",", 
              RowBox[{"tie", "[", 
               RowBox[{"0.12", ",", "3"}], "]"}], ",", 
              RowBox[{"tie", "[", 
               RowBox[{"0.18", ",", "4"}], "]"}], ",", 
              RowBox[{"tie", "[", 
               RowBox[{"0.26", ",", "5"}], "]"}], ",", 
              RowBox[{"tie", "[", 
               RowBox[{"0.32", ",", "6"}], "]"}]}], "]"}]}], "+", 
           RowBox[{"lever", "*", 
            RowBox[{"loc", "[", 
             RowBox[{
              RowBox[{"tie", "[", 
               RowBox[{"0.03", ",", "1"}], "]"}], ",", 
              RowBox[{"tie", "[", 
               RowBox[{"0.07", ",", "2"}], "]"}], ",", 
              RowBox[{"tie", "[", 
               RowBox[{"0.12", ",", "3"}], "]"}], ",", 
              RowBox[{"tie", "[", 
               RowBox[{"0.18", ",", "4"}], "]"}], ",", 
              RowBox[{"tie", "[", 
               RowBox[{"0.26", ",", "5"}], "]"}], ",", 
              RowBox[{"tie", "[", 
               RowBox[{"0.32", ",", "6"}], "]"}], ",", "py"}], "]"}]}]}], 
          ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"x", "-", "px"}], ")"}]}], "+", "py"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"xtie1", "=", 
         RowBox[{"x", "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"rPhase", "[", "x", "]"}], "\[Equal]", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "lever"}], ")"}], "*", 
               RowBox[{"loc", "[", 
                RowBox[{"0", ",", 
                 RowBox[{"tie", "[", 
                  RowBox[{"0.03", ",", "1"}], "]"}], ",", 
                 RowBox[{"tie", "[", 
                  RowBox[{"0.07", ",", "2"}], "]"}], ",", 
                 RowBox[{"tie", "[", 
                  RowBox[{"0.12", ",", "3"}], "]"}], ",", 
                 RowBox[{"tie", "[", 
                  RowBox[{"0.18", ",", "4"}], "]"}], ",", 
                 RowBox[{"tie", "[", 
                  RowBox[{"0.26", ",", "5"}], "]"}], ",", 
                 RowBox[{"tie", "[", 
                  RowBox[{"0.32", ",", "6"}], "]"}]}], "]"}]}], "+", 
              "\[IndentingNewLine]", 
              RowBox[{"lever", "*", 
               RowBox[{"loc", "[", 
                RowBox[{
                 RowBox[{"tie", "[", 
                  RowBox[{"0.03", ",", "1"}], "]"}], ",", 
                 RowBox[{"tie", "[", 
                  RowBox[{"0.07", ",", "2"}], "]"}], ",", 
                 RowBox[{"tie", "[", 
                  RowBox[{"0.12", ",", "3"}], "]"}], ",", 
                 RowBox[{"tie", "[", 
                  RowBox[{"0.18", ",", "4"}], "]"}], ",", 
                 RowBox[{"tie", "[", 
                  RowBox[{"0.26", ",", "5"}], "]"}], ",", 
                 RowBox[{"tie", "[", 
                  RowBox[{"0.32", ",", "6"}], "]"}], ",", "py"}], "]"}]}]}]}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0.1"}], "}"}]}], "]"}]}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"xtie1", "=", 
       RowBox[{"x", "/.", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"rPhase", "[", "x", "]"}], "\[Equal]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "lever"}], ")"}], "*", 
             RowBox[{"loc", "[", 
              RowBox[{"0", ",", 
               RowBox[{"tie", "[", 
                RowBox[{"0.07", ",", "1"}], "]"}], ",", 
               RowBox[{"tie", "[", 
                RowBox[{"0.12", ",", "2"}], "]"}], ",", 
               RowBox[{"tie", "[", 
                RowBox[{"0.18", ",", "3"}], "]"}], ",", 
               RowBox[{"tie", "[", 
                RowBox[{"0.26", ",", "4"}], "]"}], ",", 
               RowBox[{"tie", "[", 
                RowBox[{"0.32", ",", "5"}], "]"}], ",", 
               RowBox[{"tie", "[", 
                RowBox[{"0.32", ",", "6"}], "]"}]}], "]"}]}], "+", 
            "\[IndentingNewLine]", 
            RowBox[{"lever", "*", 
             RowBox[{"loc", "[", 
              RowBox[{
               RowBox[{"tie", "[", 
                RowBox[{"0.03", ",", "1"}], "]"}], ",", 
               RowBox[{"tie", "[", 
                RowBox[{"0.07", ",", "2"}], "]"}], ",", 
               RowBox[{"tie", "[", 
                RowBox[{"0.12", ",", "3"}], "]"}], ",", 
               RowBox[{"tie", "[", 
                RowBox[{"0.18", ",", "4"}], "]"}], ",", 
               RowBox[{"tie", "[", 
                RowBox[{"0.26", ",", "5"}], "]"}], ",", 
               RowBox[{"tie", "[", 
                RowBox[{"0.32", ",", "6"}], "]"}], ",", "py"}], "]"}]}]}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0.1"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"xtie1", "=", 
         RowBox[{"x", "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"rPhase", "[", "x", "]"}], "\[Equal]", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"loc", "[", 
                 RowBox[{
                  RowBox[{"tie", "[", 
                   RowBox[{"0.03", ",", "1"}], "]"}], ",", 
                  RowBox[{"tie", "[", 
                   RowBox[{"0.07", ",", "2"}], "]"}], ",", 
                  RowBox[{"tie", "[", 
                   RowBox[{"0.12", ",", "3"}], "]"}], ",", 
                  RowBox[{"tie", "[", 
                   RowBox[{"0.18", ",", "4"}], "]"}], ",", 
                  RowBox[{"tie", "[", 
                   RowBox[{"0.26", ",", "5"}], "]"}], ",", 
                  RowBox[{"tie", "[", 
                   RowBox[{"0.32", ",", "6"}], "]"}], ",", "py"}], "]"}], "-", 
                RowBox[{"loc", "[", 
                 RowBox[{"0", ",", 
                  RowBox[{"tie", "[", 
                   RowBox[{"0.03", ",", "1"}], "]"}], ",", 
                  RowBox[{"tie", "[", 
                   RowBox[{"0.07", ",", "2"}], "]"}], ",", 
                  RowBox[{"tie", "[", 
                   RowBox[{"0.12", ",", "3"}], "]"}], ",", 
                  RowBox[{"tie", "[", 
                   RowBox[{"0.18", ",", "4"}], "]"}], ",", 
                  RowBox[{"tie", "[", 
                   RowBox[{"0.26", ",", "5"}], "]"}], ",", 
                  RowBox[{"tie", "[", 
                   RowBox[{"0.32", ",", "6"}], "]"}]}], "]"}]}], ")"}], "*", 
              "\[IndentingNewLine]", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "lever"}], ")"}], "*", 
                 RowBox[{"loc", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{"tie", "[", 
                    RowBox[{"0.03", ",", "1"}], "]"}], ",", 
                   RowBox[{"tie", "[", 
                    RowBox[{"0.07", ",", "2"}], "]"}], ",", 
                   RowBox[{"tie", "[", 
                    RowBox[{"0.12", ",", "3"}], "]"}], ",", 
                   RowBox[{"tie", "[", 
                    RowBox[{"0.18", ",", "4"}], "]"}], ",", 
                   RowBox[{"tie", "[", 
                    RowBox[{"0.26", ",", "5"}], "]"}], ",", 
                   RowBox[{"tie", "[", 
                    RowBox[{"0.32", ",", "6"}], "]"}]}], "]"}]}], "+", 
                "\[IndentingNewLine]", 
                RowBox[{"lever", "*", 
                 RowBox[{"loc", "[", 
                  RowBox[{
                   RowBox[{"tie", "[", 
                    RowBox[{"0.03", ",", "1"}], "]"}], ",", 
                   RowBox[{"tie", "[", 
                    RowBox[{"0.07", ",", "2"}], "]"}], ",", 
                   RowBox[{"tie", "[", 
                    RowBox[{"0.12", ",", "3"}], "]"}], ",", 
                   RowBox[{"tie", "[", 
                    RowBox[{"0.18", ",", "4"}], "]"}], ",", 
                   RowBox[{"tie", "[", 
                    RowBox[{"0.26", ",", "5"}], "]"}], ",", 
                   RowBox[{"tie", "[", 
                    RowBox[{"0.32", ",", "6"}], "]"}], ",", "py"}], "]"}]}]}],
                ")"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0.1"}], "}"}]}], "]"}]}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"xtie2", "=", 
         RowBox[{"x", "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"rPhase", "[", "x", "]"}], "\[Equal]", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "lever"}], ")"}], "*", 
               RowBox[{"loc", "[", 
                RowBox[{"0", ",", 
                 RowBox[{"tie", "[", 
                  RowBox[{"0.05", ",", "1"}], "]"}], ",", 
                 RowBox[{"tie", "[", 
                  RowBox[{"0.13", ",", "2"}], "]"}], ",", 
                 RowBox[{"tie", "[", 
                  RowBox[{"0.2", ",", "3"}], "]"}], ",", 
                 RowBox[{"tie", "[", 
                  RowBox[{"0.28", ",", "4"}], "]"}], ",", 
                 RowBox[{"tie", "[", 
                  RowBox[{"0.37", ",", "5"}], "]"}], ",", 
                 RowBox[{"tie", "[", 
                  RowBox[{"0.43", ",", "6"}], "]"}]}], "]"}]}], "+", 
              "\[IndentingNewLine]", 
              RowBox[{"lever", "*", 
               RowBox[{"loc", "[", 
                RowBox[{
                 RowBox[{"tie", "[", 
                  RowBox[{"0.05", ",", "1"}], "]"}], ",", 
                 RowBox[{"tie", "[", 
                  RowBox[{"0.13", ",", "2"}], "]"}], ",", 
                 RowBox[{"tie", "[", 
                  RowBox[{"0.2", ",", "3"}], "]"}], ",", 
                 RowBox[{"tie", "[", 
                  RowBox[{"0.28", ",", "4"}], "]"}], ",", 
                 RowBox[{"tie", "[", 
                  RowBox[{"0.37", ",", "5"}], "]"}], ",", 
                 RowBox[{"tie", "[", 
                  RowBox[{"0.43", ",", "6"}], "]"}], ",", "py"}], "]"}]}]}]}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0.9"}], "}"}]}], "]"}]}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"xtie2", "=", 
       RowBox[{"x", "/.", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"rPhase", "[", "x", "]"}], "\[Equal]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              FractionBox[
               RowBox[{
                RowBox[{"rPhase", "[", "xtie1", "]"}], "-", "py"}], 
               RowBox[{"xtie1", "-", "px"}]], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"x", "-", "px"}], ")"}]}], "+", "py"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0.9"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rPhasePlot", "=", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"rPhase", "[", "x", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0.1", ",", "0.9"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Black"}], "}"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{"tie", "[", 
              RowBox[{"x", ",", "n"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"x1", "[", 
                RowBox[{"[", "n", "]"}], "]"}], ",", 
               RowBox[{"x2", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"Thick", ",", "Black"}], "}"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", "6"}], "}"}]}], "]"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{"rBlank", ",", "rPhasePlot", ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"tieline", "[", "x", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"x", "/.", 
               RowBox[{"FindRoot", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"rPhase", "[", "x", "]"}], "\[Equal]", 
                  RowBox[{"tieline", "[", "x", "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "0.1"}], "}"}]}], "]"}]}], ",", 
              RowBox[{"x", "/.", 
               RowBox[{"FindRoot", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"rPhase", "[", "x", "]"}], "\[Equal]", 
                  RowBox[{"tieline", "[", "x", "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "0.9"}], "}"}]}], "]"}]}]}], "}"}]}], 
           "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "[", "0.025", "]"}], ",", 
             RowBox[{"Point", "[", 
              RowBox[{"{", 
               RowBox[{"px", ",", "py"}], "}"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Dashed", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"xtie1", ",", 
                  RowBox[{"rPhase", "[", "xtie1", "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"xtie2", ",", 
                  RowBox[{"rPhase", "[", "xtie2", "]"}]}], "}"}]}], "}"}], 
              "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"470", ",", "450"}], "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"Column", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"lever", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "lever"}], ")"}], "*", 
              RowBox[{"loc", "[", 
               RowBox[{"0", ",", 
                RowBox[{"tie", "[", 
                 RowBox[{"0.03", ",", "1"}], "]"}], ",", 
                RowBox[{"tie", "[", 
                 RowBox[{"0.07", ",", "2"}], "]"}], ",", 
                RowBox[{"tie", "[", 
                 RowBox[{"0.12", ",", "3"}], "]"}], ",", 
                RowBox[{"tie", "[", 
                 RowBox[{"0.18", ",", "4"}], "]"}], ",", 
                RowBox[{"tie", "[", 
                 RowBox[{"0.26", ",", "5"}], "]"}], ",", 
                RowBox[{"tie", "[", 
                 RowBox[{"0.32", ",", "6"}], "]"}]}], "]"}]}], "+", 
             "\[IndentingNewLine]", 
             RowBox[{"lever", "*", 
              RowBox[{"loc", "[", 
               RowBox[{
                RowBox[{"tie", "[", 
                 RowBox[{"0.03", ",", "1"}], "]"}], ",", 
                RowBox[{"tie", "[", 
                 RowBox[{"0.07", ",", "2"}], "]"}], ",", 
                RowBox[{"tie", "[", 
                 RowBox[{"0.12", ",", "3"}], "]"}], ",", 
                RowBox[{"tie", "[", 
                 RowBox[{"0.18", ",", "4"}], "]"}], ",", 
                RowBox[{"tie", "[", 
                 RowBox[{"0.26", ",", "5"}], "]"}], ",", 
                RowBox[{"tie", "[", 
                 RowBox[{"0.32", ",", "6"}], "]"}], ",", "py"}], "]"}]}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"rPhase", "[", "xtie1", "]"}]}], "\[IndentingNewLine]", 
           "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Control", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pt", ",", 
         RowBox[{"{", 
          RowBox[{"0.3", ",", "0.25"}], "}"}]}], "}"}], ",", "Locator", ",", 
       RowBox[{"Appearance", "\[Rule]", 
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Disk", "[", "]"}], "}"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "12"}]}], "]"}]}]}], "}"}], "]"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"py", ",", "0.25", ",", "\"\<\>\""}], "}"}], ",", "0", ",", 
      "1", ",", "0.01", ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.64528594297285*^9, 3.6452859568256416`*^9}, {
   3.6452860050734015`*^9, 3.6452860222063813`*^9}, {3.645286084406939*^9, 
   3.6452861275864086`*^9}, {3.6452862198736873`*^9, 
   3.6452862786700506`*^9}, {3.645286325892751*^9, 3.6452864930613127`*^9}, {
   3.6452866419748297`*^9, 3.645286777068557*^9}, {3.6452868181079044`*^9, 
   3.6452868617143984`*^9}, {3.6452868946232805`*^9, 3.645287013424076*^9}, {
   3.6452871955634937`*^9, 3.645287207479175*^9}, {3.64528727033177*^9, 
   3.6452872870827284`*^9}, {3.6452873354254932`*^9, 
   3.6452874845990257`*^9}, {3.645287523541253*^9, 3.6452877029335136`*^9}, {
   3.64528776179788*^9, 3.6452879229851*^9}, {3.6452879682416883`*^9, 
   3.6452879996684856`*^9}, {3.6452880567797527`*^9, 3.64528806356614*^9}, {
   3.6452881689751697`*^9, 3.645288181384879*^9}, {3.6452882648726544`*^9, 
   3.6452884335663033`*^9}, {3.6452884968669243`*^9, 3.6452888164752045`*^9}, 
   3.64528887479354*^9, {3.6452889055022964`*^9, 3.6452889462896295`*^9}, {
   3.6452889814186387`*^9, 3.6452889843498063`*^9}, {3.645289025110138*^9, 
   3.64528910068246*^9}, {3.6452891991490917`*^9, 3.645289214781986*^9}, 
   3.645289284225958*^9, {3.6452893369629745`*^9, 3.645289343670358*^9}, {
   3.645289376273223*^9, 3.645289377672303*^9}, {3.645289409697135*^9, 
   3.645289474918865*^9}, {3.645289653442076*^9, 3.645289655558197*^9}, {
   3.645289690942221*^9, 3.6452897218269873`*^9}, {3.6452897610962334`*^9, 
   3.6452897616872673`*^9}, {3.645289795072177*^9, 3.6452898276380396`*^9}, {
   3.6452898579707747`*^9, 3.645289887114442*^9}, {3.6452899235975285`*^9, 
   3.6452900030000696`*^9}, {3.645290086901869*^9, 3.645290096347409*^9}, {
   3.645290151848583*^9, 3.645290156387843*^9}, {3.645290215065199*^9, 
   3.645290331051833*^9}, {3.645290756833186*^9, 3.645290757744239*^9}, {
   3.6452908356206927`*^9, 3.645290893515004*^9}, {3.6452912626871195`*^9, 
   3.645291263526168*^9}, {3.6452913345752316`*^9, 3.6452913510991764`*^9}, {
   3.6452913959827437`*^9, 3.645291431963802*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`py$$ = 0.25, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`py$$], 0.25, ""}, 0, 1, 0.01}}, Typeset`size$$ = {
    470., {223., 227.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`py$158034$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`py$$ = 0.25}, 
      "ControllerVariables" :> {
        Hold[$CellContext`py$$, $CellContext`py$158034$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`px$, $CellContext`rBlank$, $CellContext`rPhase$, \
$CellContext`x1$, $CellContext`x2$, $CellContext`tie$, \
$CellContext`rPhasePlot$, $CellContext`near$, $CellContext`ytie1$, \
$CellContext`xtie1$, $CellContext`xtie2$, $CellContext`lever$, \
$CellContext`loc$, $CellContext`tieline$}, $CellContext`px$ = 
         0.3; $CellContext`rBlank$ = Graphics[{{Thin, 
             GrayLevel[0.65], 
             Table[{
               
               Line[{{0, $CellContext`i}, {
                 1 - $CellContext`i, $CellContext`i}}], 
               
               Line[{{$CellContext`i, 0}, {$CellContext`i, 
                  1 - $CellContext`i}}], 
               
               Line[{{0, $CellContext`i}, {$CellContext`i, 
                  0}}]}, {$CellContext`i, 0, 1, 0.1}]}, {
             EdgeForm[Thick], 
             FaceForm[None], 
             Polygon[{{0, 1}, {0, 0}, {1, 0}}]}, 
            Table[{
              Text[
               Style[$CellContext`j, 15], {$CellContext`j, -0.03}], 
              Text[
               
               Style[$CellContext`j, 
                15], {-0.035, $CellContext`j}]}, {$CellContext`j, 0.1, 0.9, 
              0.1}], 
            Text[
             Style["S", 18], {1.03, 0}], 
            Text[
             Style["A", 18], {0, 1.025}], 
            Text[
             Style["C", 18], {-0.025, -0.025}]}, 
           PlotRange -> {{-0.1, 1.1}, {-0.05, 1.05}}]; $CellContext`rPhase$ = 
         Interpolation[
           Table[
            
            BezierFunction[{{0.1, 0}, {0.12, 0.7}, {0.37, 0.46}, {
              0.9, 0}}][$CellContext`i], {$CellContext`i, 0, 1, 
             0.025}]]; $CellContext`x1$ = Table[
           ReplaceAll[$CellContext`x, 
            
            FindRoot[$CellContext`rPhase$[$CellContext`x] == $CellContext`y, \
{$CellContext`x, 0.1}]], {$CellContext`y, {0.03, 0.07, 0.12, 0.18, 0.26, 
            0.32}}]; $CellContext`x2$ = Table[
           ReplaceAll[$CellContext`x, 
            
            FindRoot[$CellContext`rPhase$[$CellContext`x] == $CellContext`y, \
{$CellContext`x, 0.9}]], {$CellContext`y, {0.05, 0.13, 0.2, 0.28, 0.37, 
            0.43}}]; $CellContext`tie$[
           Pattern[$CellContext`x$, 
            Blank[]], 
           Pattern[$CellContext`n$, 
            Blank[]]] := (($CellContext`rPhase$[
               Part[$CellContext`x2$, $CellContext`n$]] - $CellContext`rPhase$[
              Part[$CellContext`x1$, $CellContext`n$]])/(
            Part[$CellContext`x2$, $CellContext`n$] - 
            Part[$CellContext`x1$, $CellContext`n$])) ($CellContext`x$ - 
            Part[$CellContext`x1$, $CellContext`n$]) + $CellContext`rPhase$[
            Part[$CellContext`x1$, $CellContext`n$]]; $CellContext`loc$[
           Pattern[$CellContext`c1$, 
            Blank[]], 
           Pattern[$CellContext`c2$, 
            Blank[]], 
           Pattern[$CellContext`c3$, 
            Blank[]], 
           Pattern[$CellContext`c4$, 
            Blank[]], 
           Pattern[$CellContext`c5$, 
            Blank[]], 
           Pattern[$CellContext`c6$, 
            Blank[]], 
           Pattern[$CellContext`c7$, 
            Blank[]]] := 
         Which[$CellContext`py$$ <= $CellContext`tie$[$CellContext`px$, 
             1], $CellContext`c1$, 
           Inequality[
            $CellContext`tie$[$CellContext`px$, 1], Less, $CellContext`py$$, 
            LessEqual, 
            $CellContext`tie$[$CellContext`px$, 2]], $CellContext`c2$, 
           Inequality[
            $CellContext`tie$[$CellContext`px$, 2], Less, $CellContext`py$$, 
            LessEqual, 
            $CellContext`tie$[$CellContext`px$, 3]], $CellContext`c3$, 
           Inequality[
            $CellContext`tie$[$CellContext`px$, 3], Less, $CellContext`py$$, 
            LessEqual, 
            $CellContext`tie$[$CellContext`px$, 4]], $CellContext`c4$, 
           Inequality[
            $CellContext`tie$[$CellContext`px$, 4], Less, $CellContext`py$$, 
            LessEqual, 
            $CellContext`tie$[$CellContext`px$, 5]], $CellContext`c5$, 
           Inequality[
            $CellContext`tie$[$CellContext`px$, 5], Less, $CellContext`py$$, 
            LessEqual, 
            $CellContext`tie$[$CellContext`px$, 
             6]], $CellContext`c6$, $CellContext`tie$[$CellContext`px$, 
             6] < $CellContext`py$$, $CellContext`c7$]; $CellContext`lever$ = \
$CellContext`loc$[$CellContext`py$$/$CellContext`tie$[$CellContext`px$, 
            1], ($CellContext`py$$ - $CellContext`tie$[$CellContext`px$, 
             1])/($CellContext`tie$[$CellContext`px$, 
             2] - $CellContext`tie$[$CellContext`px$, 
            1]), ($CellContext`py$$ - $CellContext`tie$[$CellContext`px$, 
             2])/($CellContext`tie$[$CellContext`px$, 
             3] - $CellContext`tie$[$CellContext`px$, 
            2]), ($CellContext`py$$ - $CellContext`tie$[$CellContext`px$, 
             3])/($CellContext`tie$[$CellContext`px$, 
             4] - $CellContext`tie$[$CellContext`px$, 
            3]), ($CellContext`py$$ - $CellContext`tie$[$CellContext`px$, 
             4])/($CellContext`tie$[$CellContext`px$, 
             5] - $CellContext`tie$[$CellContext`px$, 
            4]), ($CellContext`py$$ - $CellContext`tie$[$CellContext`px$, 
             5])/($CellContext`tie$[$CellContext`px$, 
             6] - $CellContext`tie$[$CellContext`px$, 
            5]), $CellContext`py$$ - $CellContext`tie$[$CellContext`px$, 
            6]]; $CellContext`tieline$[
           Pattern[$CellContext`x$, 
            Blank[]]] = ((1 - $CellContext`lever$) $CellContext`loc$[0, 
               $CellContext`tie$[0.03, 1], 
               $CellContext`tie$[0.07, 2], 
               $CellContext`tie$[0.12, 3], 
               $CellContext`tie$[0.18, 4], 
               $CellContext`tie$[0.26, 5], 
               $CellContext`tie$[
               0.32, 6]] + $CellContext`lever$ $CellContext`loc$[
               $CellContext`tie$[0.03, 1], 
               $CellContext`tie$[0.07, 2], 
               $CellContext`tie$[0.12, 3], 
               $CellContext`tie$[0.18, 4], 
               $CellContext`tie$[0.26, 5], 
               $CellContext`tie$[
               0.32, 6], $CellContext`py$$]) ($CellContext`x$ - \
$CellContext`px$) + $CellContext`py$$; $CellContext`xtie1$ = 
         ReplaceAll[$CellContext`x, 
           
           FindRoot[$CellContext`rPhase$[$CellContext`x] == (
               1 - $CellContext`lever$) $CellContext`loc$[0, 
                $CellContext`tie$[0.07, 1], 
                $CellContext`tie$[0.12, 2], 
                $CellContext`tie$[0.18, 3], 
                $CellContext`tie$[0.26, 4], 
                $CellContext`tie$[0.32, 5], 
                $CellContext`tie$[
                0.32, 6]] + $CellContext`lever$ $CellContext`loc$[
                $CellContext`tie$[0.03, 1], 
                $CellContext`tie$[0.07, 2], 
                $CellContext`tie$[0.12, 3], 
                $CellContext`tie$[0.18, 4], 
                $CellContext`tie$[0.26, 5], 
                $CellContext`tie$[
                0.32, 6], $CellContext`py$$], {$CellContext`x, 
             0.1}]]; $CellContext`xtie2$ = ReplaceAll[$CellContext`x, 
           
           FindRoot[$CellContext`rPhase$[$CellContext`x] == \
(($CellContext`rPhase$[$CellContext`xtie1$] - \
$CellContext`py$$)/($CellContext`xtie1$ - $CellContext`px$)) ($CellContext`x - \
$CellContext`px$) + $CellContext`py$$, {$CellContext`x, 
             0.9}]]; $CellContext`rPhasePlot$ = Show[
           Plot[
            $CellContext`rPhase$[$CellContext`x], {$CellContext`x, 0.1, 0.9}, 
            PlotStyle -> {Thick, Black}], 
           Table[
            Plot[
             $CellContext`tie$[$CellContext`x, $CellContext`n], \
{$CellContext`x, 
              Part[$CellContext`x1$, $CellContext`n], 
              Part[$CellContext`x2$, $CellContext`n]}, 
             PlotStyle -> {Thick, Black}], {$CellContext`n, 1, 6}]]; 
        Show[$CellContext`rBlank$, $CellContext`rPhasePlot$, 
          Graphics[{{
             PointSize[0.025], 
             Point[{$CellContext`px$, $CellContext`py$$}]}, {Thick, Dashed, 
             Line[{{$CellContext`xtie1$, 
                $CellContext`rPhase$[$CellContext`xtie1$]}, \
{$CellContext`xtie2$, 
                $CellContext`rPhase$[$CellContext`xtie2$]}}]}}], 
          ImageSize -> {470, 450}, PlotLabel -> 
          Column[{$CellContext`lever$, (
               1 - $CellContext`lever$) $CellContext`loc$[0, 
                $CellContext`tie$[0.03, 1], 
                $CellContext`tie$[0.07, 2], 
                $CellContext`tie$[0.12, 3], 
                $CellContext`tie$[0.18, 4], 
                $CellContext`tie$[0.26, 5], 
                $CellContext`tie$[
                0.32, 6]] + $CellContext`lever$ $CellContext`loc$[
                $CellContext`tie$[0.03, 1], 
                $CellContext`tie$[0.07, 2], 
                $CellContext`tie$[0.12, 3], 
                $CellContext`tie$[0.18, 4], 
                $CellContext`tie$[0.26, 5], 
                $CellContext`tie$[0.32, 6], $CellContext`py$$], 
             $CellContext`rPhase$[$CellContext`xtie1$]}]]], 
      "Specifications" :> {{{$CellContext`py$$, 0.25, ""}, 0, 1, 0.01, 
         Appearance -> "Labeled"}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{521., {268., 275.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.6452860175731163`*^9, 3.6452860230864315`*^9}, {
   3.645286111276476*^9, 3.6452861283554525`*^9}, 3.6452862444280915`*^9, 
   3.645286480160575*^9, {3.645286754355258*^9, 3.6452867795647*^9}, 
   3.6452868289635253`*^9, 3.6452868634784994`*^9, {3.645286913040334*^9, 
   3.6452869269991326`*^9}, {3.645286985826497*^9, 3.645287014007109*^9}, 
   3.6452873636201057`*^9, 3.6452875762922697`*^9, 3.6452877898994875`*^9, 
   3.6452880035597086`*^9, 3.64528809065269*^9, 3.645288393628019*^9, {
   3.6452887604329987`*^9, 3.6452887883675966`*^9}, 3.6452888277458487`*^9, 
   3.645288876027611*^9, 3.645288949368806*^9, 3.645289009552248*^9, 
   3.645289103075597*^9, {3.645289201894249*^9, 3.645289216196067*^9}, 
   3.645289286869109*^9, 3.6452893807854815`*^9, 3.6452894816602507`*^9, 
   3.6452897343427033`*^9, 3.645289768444654*^9, 3.6452898293711386`*^9, {
   3.645289871255534*^9, 3.645289887656472*^9}, 3.6452900048961782`*^9, 
   3.6452903333319635`*^9, 3.645290768744868*^9, 3.645290894291049*^9, 
   3.645291353587319*^9, 3.645291435888026*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"lever", "=", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"py", "\[LessEqual]", 
       RowBox[{"tie", "[", 
        RowBox[{"px", ",", "1"}], "]"}]}], ",", 
      RowBox[{"py", "/", 
       RowBox[{"tie", "[", 
        RowBox[{"px", ",", "1"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tie", "[", 
        RowBox[{"px", ",", "1"}], "]"}], "<", "py", "\[LessEqual]", 
       RowBox[{"tie", "[", 
        RowBox[{"px", ",", "2"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"py", "-", 
         RowBox[{"tie", "[", 
          RowBox[{"px", ",", "1"}], "]"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"tie", "[", 
          RowBox[{"px", ",", "2"}], "]"}], "-", 
         RowBox[{"tie", "[", 
          RowBox[{"px", ",", "1"}], "]"}]}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tie", "[", 
        RowBox[{"px", ",", "2"}], "]"}], "<", "py", "\[LessEqual]", 
       RowBox[{"tie", "[", 
        RowBox[{"px", ",", "3"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"py", "-", 
         RowBox[{"tie", "[", 
          RowBox[{"px", ",", "2"}], "]"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"tie", "[", 
          RowBox[{"px", ",", "3"}], "]"}], "-", 
         RowBox[{"tie", "[", 
          RowBox[{"px", ",", "2"}], "]"}]}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tie", "[", 
        RowBox[{"px", ",", "3"}], "]"}], "<", "py", "\[LessEqual]", 
       RowBox[{"tie", "[", 
        RowBox[{"px", ",", "4"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"py", "-", 
         RowBox[{"tie", "[", 
          RowBox[{"px", ",", "3"}], "]"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"tie", "[", 
          RowBox[{"px", ",", "4"}], "]"}], "-", 
         RowBox[{"tie", "[", 
          RowBox[{"px", ",", "3"}], "]"}]}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tie", "[", 
        RowBox[{"px", ",", "4"}], "]"}], "<", "py", "\[LessEqual]", 
       RowBox[{"tie", "[", 
        RowBox[{"px", ",", "5"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"py", "-", 
         RowBox[{"tie", "[", 
          RowBox[{"px", ",", "4"}], "]"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"tie", "[", 
          RowBox[{"px", ",", "5"}], "]"}], "-", 
         RowBox[{"tie", "[", 
          RowBox[{"px", ",", "4"}], "]"}]}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tie", "[", 
        RowBox[{"px", ",", "5"}], "]"}], "<", "py", "\[LessEqual]", 
       RowBox[{"tie", "[", 
        RowBox[{"px", ",", "6"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"py", "-", 
         RowBox[{"tie", "[", 
          RowBox[{"px", ",", "5"}], "]"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"tie", "[", 
          RowBox[{"px", ",", "6"}], "]"}], "-", 
         RowBox[{"tie", "[", 
          RowBox[{"px", ",", "5"}], "]"}]}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tie", "[", 
        RowBox[{"px", ",", "6"}], "]"}], "<", "py"}], ",", 
      RowBox[{"py", "-", 
       RowBox[{"tie", "[", 
        RowBox[{"px", ",", "6"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "*)"}]], "Input"]
},
WindowSize->{1366, 686},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.1 for Microsoft Windows (64-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 33629, 808, 1659, "Input"],
Cell[34212, 832, 11844, 240, 560, "Output"]
}, Open  ]],
Cell[46071, 1075, 3523, 103, 192, "Input"]
}
]
*)

(* End of internal cache information *)
