(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     49747,       1234]
NotebookOptionsPosition[     49029,       1205]
NotebookOutlinePosition[     49371,       1220]
CellTagsIndexPosition[     49328,       1217]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Cs0", ",", "\[Mu]max", ",", "kd", ",", "\[Mu]", ",", "rg", ",", "rd", 
       ",", "rs", ",", "sol", ",", "cell", ",", "sub", ",", "sub2", ",", 
       "range1", ",", "range2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Cs0", "=", "1"}], ";", 
      RowBox[{"\[Mu]max", "=", "0.8"}], ";", 
      RowBox[{"kd", "=", "0.06"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "d_", "]"}], ":=", 
       RowBox[{"\[Mu]max", "*", 
        FractionBox[
         RowBox[{"Cs", "[", "d", "]"}], 
         RowBox[{"ks", "+", 
          RowBox[{"Cs", "[", "d", "]"}]}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rg", "[", "d_", "]"}], ":=", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "d", "]"}], "*", 
        RowBox[{"Cc", "[", "d", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rd", "[", "d_", "]"}], ":=", 
       RowBox[{"kd", "*", 
        RowBox[{"Cc", "[", "d", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "d_", "]"}], ":=", 
       RowBox[{
        RowBox[{"-", "2"}], "*", 
        RowBox[{"rg", "[", "d", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"Quiet", "@", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d", "*", 
               RowBox[{"Cc", "[", "d", "]"}]}], "\[Equal]", 
              RowBox[{
               RowBox[{"rg", "[", "d", "]"}], "-", 
               RowBox[{"rd", "[", "d", "]"}]}]}], ")"}], "\[And]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d", "*", 
               RowBox[{"(", 
                RowBox[{"Cs0", "-", 
                 RowBox[{"Cs", "[", "d", "]"}]}], ")"}]}], "\[Equal]", 
              RowBox[{"-", 
               RowBox[{"rs", "[", "d", "]"}]}]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cc", "[", "d", "]"}], ",", 
             RowBox[{"Cs", "[", "d", "]"}]}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cell", "[", "d_", "]"}], ":=", 
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Cc", "[", "d", "]"}], "/.", "sol"}], ",", 
            RowBox[{"d", "\[LessEqual]", "range1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"range1", "<", "d"}]}], "}"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sub", "[", "d_", "]"}], ":=", 
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Cs", "[", "d", "]"}], "/.", "sol"}], ",", 
            RowBox[{"d", "\[LessEqual]", "range1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Cs", "[", "d", "]"}], "/.", "sol"}], "/.", 
             RowBox[{"d", "\[Rule]", "range1"}]}], ",", 
            RowBox[{"range1", "<", "d"}]}], "}"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"range1", ":=", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"Cs0", "*", "kd"}], "+", 
          RowBox[{"kd", "*", "ks"}], "-", 
          RowBox[{"Cs0", "*", "\[Mu]max"}]}], 
         RowBox[{"Cs0", "+", "ks"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"range2", ":=", 
       RowBox[{"\[Mu]max", "-", "kd"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"cell", "[", "d", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"d", ",", "0", ",", 
            RowBox[{"Blueopt", "*", "range2"}]}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Blue"}], "}"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Purpleopt", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"sub", "[", "d", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"d", ",", "0", ",", "range2"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"Thick", ",", "Purple"}], "}"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Graphics", "[", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Purple", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"di", ",", 
                  RowBox[{
                   RowBox[{"sub", "[", "d", "]"}], "/.", 
                   RowBox[{"d", "\[Rule]", "di"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"di", ",", "0", ",", 
                  RowBox[{"range2", "-", "0.00025"}], ",", "0.00025"}], 
                 "}"}]}], "]"}], "]"}]}], "}"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "range2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ks", ",", "0.1", ",", 
        RowBox[{"Subscript", "[", 
         RowBox[{"\"\<k\>\"", ",", "\"\<s\>\""}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.01", ",", "0.1"}], "}"}], ",", "Setter"}], "}"}], "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Purpleopt", ",", "1", ",", "\"\<how to plot purple:\>\""}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "\[Rule]", "\"\< Plot \>\""}], ",", 
        RowBox[{"2", "\[Rule]", "\"\< Table \>\""}]}], "}"}], ",", "Setter"}],
      "}"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Blueopt", ",", "1", ",", "\"\<x-range on blue:\>\""}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "\[Rule]", "\"\< short \>\""}], ",", 
        RowBox[{"1.5", "\[Rule]", "\"\< long \>\""}]}], "}"}], ",", 
      "Setter"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Blueopt", ",", "1", ",", 
        "\"\<x-range on blue (c \[Times] range2):\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1.5"}], "}"}], ",", "Setter"}], "}"}], "]"}], 
   "*)"}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.6485580263637266`*^9, 3.6485584343490615`*^9}, {
  3.648558466029874*^9, 3.648558502732973*^9}, {3.6485588879500065`*^9, 
  3.6485589918539495`*^9}, {3.6485591547552667`*^9, 3.648559189831273*^9}, {
  3.648559232986741*^9, 3.648559256294074*^9}, {3.648559295745331*^9, 
  3.6485597369675674`*^9}, {3.6485597733726497`*^9, 3.648559786646409*^9}, {
  3.6485599423693156`*^9, 3.6485599871218753`*^9}, {3.6485600460752473`*^9, 
  3.6485601628529263`*^9}, {3.6485603058681064`*^9, 3.648560372228902*^9}, {
  3.6485604051907873`*^9, 3.648560696719462*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`Blueopt$$ = 1.5, $CellContext`ks$$ = 
    0.01, $CellContext`Purpleopt$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`ks$$], 0.1, 
       Subscript["k", "s"]}, {0.01, 0.1}}, {{
       Hold[$CellContext`Purpleopt$$], 1, "how to plot purple:"}, {
      1 -> " Plot ", 2 -> " Table "}}, {{
       Hold[$CellContext`Blueopt$$], 1, "x-range on blue:"}, {
      1 -> " short ", 1.5 -> " long "}}}, Typeset`size$$ = {
    360., {112., 116.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`ks$58830$$ = 
    False, $CellContext`Purpleopt$58831$$ = 
    False, $CellContext`Blueopt$58832$$ = False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`Blueopt$$ = 1, $CellContext`ks$$ = 
        0.1, $CellContext`Purpleopt$$ = 1}, "ControllerVariables" :> {
        Hold[$CellContext`ks$$, $CellContext`ks$58830$$, False], 
        Hold[$CellContext`Purpleopt$$, $CellContext`Purpleopt$58831$$, False], 
        Hold[$CellContext`Blueopt$$, $CellContext`Blueopt$58832$$, False]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`Cs0$, $CellContext`\[Mu]max$, $CellContext`kd$, \
$CellContext`\[Mu]$, $CellContext`rg$, $CellContext`rd$, $CellContext`rs$, \
$CellContext`sol$, $CellContext`cell$, $CellContext`sub$, $CellContext`sub2$, \
$CellContext`range1$, $CellContext`range2$}, $CellContext`Cs0$ = 
         1; $CellContext`\[Mu]max$ = 0.8; $CellContext`kd$ = 
         0.06; $CellContext`\[Mu]$[
           Pattern[$CellContext`d$, 
            
            Blank[]]] := $CellContext`\[Mu]max$ \
($CellContext`Cs[$CellContext`d$]/($CellContext`ks$$ + \
$CellContext`Cs[$CellContext`d$])); $CellContext`rg$[
           Pattern[$CellContext`d$, 
            
            Blank[]]] := $CellContext`\[Mu]$[$CellContext`d$] \
$CellContext`Cc[$CellContext`d$]; $CellContext`rd$[
           Pattern[$CellContext`d$, 
            
            Blank[]]] := $CellContext`kd$ $CellContext`Cc[$CellContext`d$]; \
$CellContext`rs$[
           Pattern[$CellContext`d$, 
            
            Blank[]]] := (-2) $CellContext`rg$[$CellContext`d$]; \
$CellContext`sol$ = Quiet[
           Part[
            Solve[
             
             And[$CellContext`d $CellContext`Cc[$CellContext`d] == \
$CellContext`rg$[$CellContext`d] - $CellContext`rd$[$CellContext`d], \
$CellContext`d ($CellContext`Cs0$ - $CellContext`Cs[$CellContext`d]) == \
-$CellContext`rs$[$CellContext`d]], {
              $CellContext`Cc[$CellContext`d], 
              $CellContext`Cs[$CellContext`d]}], 2]]; $CellContext`cell$[
           Pattern[$CellContext`d$, 
            Blank[]]] := Piecewise[{{
             ReplaceAll[
              $CellContext`Cc[$CellContext`d$], $CellContext`sol$], \
$CellContext`d$ <= $CellContext`range1$}, {
            0, $CellContext`range1$ < $CellContext`d$}}]; $CellContext`sub$[
           Pattern[$CellContext`d$, 
            Blank[]]] := Piecewise[{{
             ReplaceAll[
              $CellContext`Cs[$CellContext`d$], $CellContext`sol$], \
$CellContext`d$ <= $CellContext`range1$}, {
             ReplaceAll[
              ReplaceAll[
               $CellContext`Cs[$CellContext`d$], $CellContext`sol$], \
$CellContext`d$ -> $CellContext`range1$], $CellContext`range1$ < \
$CellContext`d$}}]; $CellContext`range1$ := -(($CellContext`Cs0$ \
$CellContext`kd$ + $CellContext`kd$ $CellContext`ks$$ - $CellContext`Cs0$ \
$CellContext`\[Mu]max$)/($CellContext`Cs0$ + $CellContext`ks$$)); \
$CellContext`range2$ := $CellContext`\[Mu]max$ - $CellContext`kd$; Show[
          Plot[
           $CellContext`cell$[$CellContext`d], {$CellContext`d, 
            0, $CellContext`Blueopt$$ $CellContext`range2$}, 
           PlotStyle -> {Thick, Blue}], 
          If[$CellContext`Purpleopt$$ == 1, 
           Plot[
            $CellContext`sub$[$CellContext`d], {$CellContext`d, 
             0, $CellContext`range2$}, PlotStyle -> {Thick, Purple}], 
           Graphics[{Thick, Purple, 
             Line[
              Table[{$CellContext`di, 
                ReplaceAll[
                 $CellContext`sub$[$CellContext`d], $CellContext`d -> \
$CellContext`di]}, {$CellContext`di, 0, $CellContext`range2$ - 0.00025, 
                0.00025}]]}]], 
          PlotRange -> {{0, $CellContext`range2$}, {0, All}}, Frame -> True, 
          Axes -> False]], "Specifications" :> {{{$CellContext`ks$$, 0.1, 
          Subscript["k", "s"]}, {0.01, 0.1}, ControlType -> 
         Setter}, {{$CellContext`Purpleopt$$, 1, "how to plot purple:"}, {
         1 -> " Plot ", 2 -> " Table "}, ControlType -> 
         Setter}, {{$CellContext`Blueopt$$, 1, "x-range on blue:"}, {
         1 -> " short ", 1.5 -> " long "}, ControlType -> Setter}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{411., {178., 185.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.6485580035004187`*^9, {3.6485580665310235`*^9, 3.648558077953677*^9}, 
   3.6485581227212377`*^9, 3.64855826875259*^9, 3.6485583024385166`*^9, {
   3.648558422060359*^9, 3.648558434898093*^9}, 3.648558470802147*^9, 
   3.648558503183999*^9, {3.648558907123103*^9, 3.648558920688879*^9}, 
   3.6485589937880597`*^9, 3.648559050412298*^9, {3.648559158404475*^9, 
   3.6485591915943737`*^9}, 3.648559269705841*^9, 3.6485593001345816`*^9, {
   3.6485594070606976`*^9, 3.64855942440769*^9}, 3.648559458136619*^9, {
   3.648559490998499*^9, 3.648559506967412*^9}, 3.648559549929869*^9, {
   3.6485596168976994`*^9, 3.6485596441732597`*^9}, {3.648559680349329*^9, 
   3.6485597374875965`*^9}, {3.648559948024639*^9, 3.6485599698128853`*^9}, 
   3.648560163860984*^9, {3.648560362015318*^9, 3.6485603769791737`*^9}, {
   3.6485604141963024`*^9, 3.6485604538515706`*^9}, {3.6485604870134673`*^9, 
   3.6485606147507734`*^9}, 3.6485606466595984`*^9, 3.6485606973084955`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Cs0", ",", "\[Mu]max", ",", "kd", ",", "\[Mu]", ",", "rg", ",", "rd", 
       ",", "rs", ",", "sol", ",", "cell", ",", "sub", ",", "range", ",", 
       "cell2", ",", "sub2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Cs0", "=", "1"}], ";", 
      RowBox[{"\[Mu]max", "=", "0.8"}], ";", 
      RowBox[{"kd", "=", "0.06"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "d_", "]"}], ":=", 
       RowBox[{"\[Mu]max", "*", 
        FractionBox[
         RowBox[{"Cs", "[", "d", "]"}], 
         RowBox[{"ks", "+", 
          RowBox[{"Cs", "[", "d", "]"}]}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rg", "[", "d_", "]"}], ":=", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "d", "]"}], "*", 
        RowBox[{"Cc", "[", "d", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rd", "[", "d_", "]"}], ":=", 
       RowBox[{"kd", "*", 
        RowBox[{"Cc", "[", "d", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "d_", "]"}], ":=", 
       RowBox[{
        RowBox[{"-", "2"}], "*", 
        RowBox[{"rg", "[", "d", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"Quiet", "@", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d", "*", 
               RowBox[{"Cc", "[", "d", "]"}]}], "\[Equal]", 
              RowBox[{
               RowBox[{"rg", "[", "d", "]"}], "-", 
               RowBox[{"rd", "[", "d", "]"}]}]}], ")"}], "\[And]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d", "*", 
               RowBox[{"(", 
                RowBox[{"Cs0", "-", 
                 RowBox[{"Cs", "[", "d", "]"}]}], ")"}]}], "\[Equal]", 
              RowBox[{"-", 
               RowBox[{"rs", "[", "d", "]"}]}]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cc", "[", "d", "]"}], ",", 
             RowBox[{"Cs", "[", "d", "]"}]}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cell", "[", "d_", "]"}], ":=", 
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Cc", "[", "d", "]"}], "/.", "sol"}], ",", 
            RowBox[{"d", "\[LessEqual]", "range"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"range", "<", "d"}]}], "}"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sub", "[", "d_", "]"}], ":=", 
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Cs", "[", "d", "]"}], "/.", "sol"}], ",", 
            RowBox[{"d", "\[LessEqual]", "range"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Cs", "[", "d", "]"}], "/.", "sol"}], "/.", 
             RowBox[{"d", "\[Rule]", "range"}]}], ",", 
            RowBox[{"range", "<", "d"}]}], "}"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"cell2", "[", "d_", "]"}], ":=", 
         FractionBox[
          RowBox[{"d", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"d", "+", "kd"}], ")"}], "*", "ks"}], "+", 
             RowBox[{"Cs0", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"d", "+", "kd", "-"}], "\[InvisibleComma]", 
                "\[Mu]max"}], ")"}]}]}], ")"}]}], 
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"d", "+", "kd"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"d", "+", "kd", "-", "\[Mu]max"}], ")"}]}]]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sub2", "[", "d_", "]"}], ":=", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"ks", "*", 
            RowBox[{"(", 
             RowBox[{"d", "+", "kd"}], ")"}]}], 
           RowBox[{"d", "+", "kd", "-", "\[Mu]max"}]]}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cell2", "[", "d_", "]"}], ":=", 
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            FractionBox[
             RowBox[{"d", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"d", "+", "kd"}], ")"}], "*", "ks"}], "+", 
                RowBox[{"Cs0", "*", 
                 RowBox[{"(", 
                  RowBox[{"d", "+", "kd", "-", "\[Mu]max"}], ")"}]}]}], 
               ")"}]}], 
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{"d", "+", "kd"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{"d", "+", "kd", "-", "\[Mu]max"}], ")"}]}]], ",", 
            RowBox[{"d", "\[LessEqual]", "range"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"range", "<", "d"}]}], "}"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sub2", "[", "d_", "]"}], ":=", 
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              RowBox[{"ks", "*", 
               RowBox[{"(", 
                RowBox[{"d", "+", "kd"}], ")"}]}], 
              RowBox[{"d", "+", "kd", "-", "\[Mu]max"}]]}], ",", 
            RowBox[{"d", "\[LessEqual]", "range"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              RowBox[{"ks", "*", 
               RowBox[{"(", 
                RowBox[{"range", "+", "kd"}], ")"}]}], 
              RowBox[{"range", "+", "kd", "-", "\[Mu]max"}]]}], ",", 
            RowBox[{"range", "<", "d"}]}], "}"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"range", ":=", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"Cs0", "*", "kd"}], "+", 
          RowBox[{"kd", "*", "ks"}], "-", 
          RowBox[{"Cs0", "*", "\[Mu]max"}]}], 
         RowBox[{"Cs0", "+", "ks"}]]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"cell", "[", "d", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"d", ",", "0", ",", "0.74"}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Blue"}], "}"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Purpleopt", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"sub", "[", "d", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"d", ",", "0", ",", "0.74"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"Thick", ",", "Purple"}], "}"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Graphics", "[", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Purple", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"di", ",", 
                  RowBox[{
                   RowBox[{"sub", "[", "d", "]"}], "/.", 
                   RowBox[{"d", "\[Rule]", "di"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"di", ",", "0", ",", 
                  RowBox[{"0.74", "-", "0.00025"}], ",", "0.00025"}], "}"}]}],
                "]"}], "]"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0.74"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ks", ",", "0.1", ",", 
        RowBox[{"Subscript", "[", 
         RowBox[{"\"\<k\>\"", ",", "\"\<s\>\""}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.01", ",", "0.1"}], "}"}], ",", "Setter"}], "}"}], "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Purpleopt", ",", "1", ",", "\"\<how to plot purple:\>\""}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "\[Rule]", "\"\< Plot \>\""}], ",", 
        RowBox[{"2", "\[Rule]", "\"\< Table \>\""}]}], "}"}], ",", "Setter"}],
      "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.6485607377388077`*^9, 3.648560745624259*^9}, {
  3.648560803088546*^9, 3.648560956810338*^9}, {3.6485614680865817`*^9, 
  3.648561585128276*^9}, {3.6485617314526453`*^9, 3.6485617326267123`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`ks$$ = 0.1, $CellContext`Purpleopt$$ = 1, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`ks$$], 0.1, 
       Subscript["k", "s"]}, {0.01, 0.1}}, {{
       Hold[$CellContext`Purpleopt$$], 1, "how to plot purple:"}, {
      1 -> " Plot ", 2 -> " Table "}}}, Typeset`size$$ = {360., {112., 116.}},
     Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`ks$69650$$ = False, $CellContext`Purpleopt$69651$$ = 
    False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`ks$$ = 0.1, $CellContext`Purpleopt$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`ks$$, $CellContext`ks$69650$$, False], 
        Hold[$CellContext`Purpleopt$$, $CellContext`Purpleopt$69651$$, 
         False]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`Cs0$, $CellContext`\[Mu]max$, $CellContext`kd$, \
$CellContext`\[Mu]$, $CellContext`rg$, $CellContext`rd$, $CellContext`rs$, \
$CellContext`sol$, $CellContext`cell$, $CellContext`sub$, \
$CellContext`range$, $CellContext`cell2$, $CellContext`sub2$}, \
$CellContext`Cs0$ = 1; $CellContext`\[Mu]max$ = 0.8; $CellContext`kd$ = 
         0.06; $CellContext`\[Mu]$[
           Pattern[$CellContext`d$, 
            
            Blank[]]] := $CellContext`\[Mu]max$ \
($CellContext`Cs[$CellContext`d$]/($CellContext`ks$$ + \
$CellContext`Cs[$CellContext`d$])); $CellContext`rg$[
           Pattern[$CellContext`d$, 
            
            Blank[]]] := $CellContext`\[Mu]$[$CellContext`d$] \
$CellContext`Cc[$CellContext`d$]; $CellContext`rd$[
           Pattern[$CellContext`d$, 
            
            Blank[]]] := $CellContext`kd$ $CellContext`Cc[$CellContext`d$]; \
$CellContext`rs$[
           Pattern[$CellContext`d$, 
            
            Blank[]]] := (-2) $CellContext`rg$[$CellContext`d$]; \
$CellContext`sol$ = Quiet[
           Part[
            Solve[
             
             And[$CellContext`d $CellContext`Cc[$CellContext`d] == \
$CellContext`rg$[$CellContext`d] - $CellContext`rd$[$CellContext`d], \
$CellContext`d ($CellContext`Cs0$ - $CellContext`Cs[$CellContext`d]) == \
-$CellContext`rs$[$CellContext`d]], {
              $CellContext`Cc[$CellContext`d], 
              $CellContext`Cs[$CellContext`d]}], 2]]; $CellContext`cell$[
           Pattern[$CellContext`d$, 
            Blank[]]] := Piecewise[{{
             ReplaceAll[
              $CellContext`Cc[$CellContext`d$], $CellContext`sol$], \
$CellContext`d$ <= $CellContext`range$}, {
            0, $CellContext`range$ < $CellContext`d$}}]; $CellContext`sub$[
           Pattern[$CellContext`d$, 
            Blank[]]] := Piecewise[{{
             ReplaceAll[
              $CellContext`Cs[$CellContext`d$], $CellContext`sol$], \
$CellContext`d$ <= $CellContext`range$}, {
             ReplaceAll[
              ReplaceAll[
               $CellContext`Cs[$CellContext`d$], $CellContext`sol$], \
$CellContext`d$ -> $CellContext`range$], $CellContext`range$ < \
$CellContext`d$}}]; $CellContext`cell2$[
           Pattern[$CellContext`d$, 
            Blank[]]] := 
         Piecewise[{{$CellContext`d$ (($CellContext`d$ + $CellContext`kd$) \
$CellContext`ks$$ + $CellContext`Cs0$ ($CellContext`d$ + $CellContext`kd$ - \
$CellContext`\[Mu]max$))/(
             2 ($CellContext`d$ + $CellContext`kd$) ($CellContext`d$ + \
$CellContext`kd$ - $CellContext`\[Mu]max$)), $CellContext`d$ <= \
$CellContext`range$}, {
            0, $CellContext`range$ < $CellContext`d$}}]; $CellContext`sub2$[
           Pattern[$CellContext`d$, 
            Blank[]]] := 
         Piecewise[{{-($CellContext`ks$$ ($CellContext`d$ + \
$CellContext`kd$)/($CellContext`d$ + $CellContext`kd$ - \
$CellContext`\[Mu]max$)), $CellContext`d$ <= $CellContext`range$}, \
{-($CellContext`ks$$ ($CellContext`range$ + \
$CellContext`kd$)/($CellContext`range$ + $CellContext`kd$ - \
$CellContext`\[Mu]max$)), $CellContext`range$ < $CellContext`d$}}]; \
$CellContext`range$ := -(($CellContext`Cs0$ $CellContext`kd$ + \
$CellContext`kd$ $CellContext`ks$$ - $CellContext`Cs0$ \
$CellContext`\[Mu]max$)/($CellContext`Cs0$ + $CellContext`ks$$)); Show[
          Plot[
           $CellContext`cell$[$CellContext`d], {$CellContext`d, 0, 0.74}, 
           PlotStyle -> {Thick, Blue}], 
          If[$CellContext`Purpleopt$$ == 1, 
           Plot[
            $CellContext`sub$[$CellContext`d], {$CellContext`d, 0, 0.74}, 
            PlotStyle -> {Thick, Purple}], 
           Graphics[{Thick, Purple, 
             Line[
              Table[{$CellContext`di, 
                ReplaceAll[
                 $CellContext`sub$[$CellContext`d], $CellContext`d -> \
$CellContext`di]}, {$CellContext`di, 0, 0.74 - 0.00025, 0.00025}]]}]], 
          PlotRange -> {{0, 0.74}, {0, All}}, Frame -> True, Axes -> False]], 
      "Specifications" :> {{{$CellContext`ks$$, 0.1, 
          Subscript["k", "s"]}, {0.01, 0.1}, ControlType -> 
         Setter}, {{$CellContext`Purpleopt$$, 1, "how to plot purple:"}, {
         1 -> " Plot ", 2 -> " Table "}, ControlType -> Setter}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{411., {167., 174.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.6485607623662167`*^9, {3.6485608056636934`*^9, 3.6485608323302183`*^9}, 
   3.6485608792769036`*^9, 3.648560960302538*^9, 3.648561733830781*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Mu]", ",", "rg", ",", "rd", ",", "rs", ",", "sol", ",", "cell", ",", 
       "sub", ",", "range"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Mu]", "[", "d_", "]"}], ":=", 
       RowBox[{"0.8", "*", 
        FractionBox[
         RowBox[{"Cs", "[", "d", "]"}], 
         RowBox[{"ks", "+", 
          RowBox[{"Cs", "[", "d", "]"}]}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rg", "[", "d_", "]"}], ":=", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "d", "]"}], "*", 
        RowBox[{"Cc", "[", "d", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rd", "[", "d_", "]"}], ":=", 
       RowBox[{"0.06", "*", 
        RowBox[{"Cc", "[", "d", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rs", "[", "d_", "]"}], ":=", 
       RowBox[{
        RowBox[{"-", "2"}], "*", 
        RowBox[{"rg", "[", "d", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"Quiet", "@", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d", "*", 
               RowBox[{"Cc", "[", "d", "]"}]}], "\[Equal]", 
              RowBox[{
               RowBox[{"rg", "[", "d", "]"}], "-", 
               RowBox[{"rd", "[", "d", "]"}]}]}], ")"}], "\[And]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d", "*", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"Cs", "[", "d", "]"}]}], ")"}]}], "\[Equal]", 
              RowBox[{"-", 
               RowBox[{"rs", "[", "d", "]"}]}]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cc", "[", "d", "]"}], ",", 
             RowBox[{"Cs", "[", "d", "]"}]}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cell", "[", "d_", "]"}], ":=", 
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Cc", "[", "d", "]"}], "/.", "sol"}], ",", 
            RowBox[{"d", "\[LessEqual]", "range"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"range", "<", "d"}]}], "}"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sub", "[", "d_", "]"}], ":=", 
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Cs", "[", "d", "]"}], "/.", "sol"}], ",", 
            RowBox[{"d", "\[LessEqual]", "range"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Cs", "[", "d", "]"}], "/.", "sol"}], "/.", 
             RowBox[{"d", "\[Rule]", "range"}]}], ",", 
            RowBox[{"range", "<", "d"}]}], "}"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"range", ":=", 
       FractionBox[
        RowBox[{"0.74", "-", 
         RowBox[{"0.06", "*", "ks"}]}], 
        RowBox[{"1", "+", "ks"}]]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"cell", "[", "d", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"d", ",", "0", ",", "0.74"}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Blue"}], "}"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Purpleopt", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"sub", "[", "d", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"d", ",", "0", ",", "0.74"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"Thick", ",", "Purple"}], "}"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Graphics", "[", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Purple", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"di", ",", 
                  RowBox[{
                   RowBox[{"sub", "[", "d", "]"}], "/.", 
                   RowBox[{"d", "\[Rule]", "di"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"di", ",", "0", ",", 
                  RowBox[{"0.74", "-", "0.00025"}], ",", "0.00025"}], "}"}]}],
                "]"}], "]"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0.74"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ks", ",", "0.1", ",", 
        RowBox[{"Subscript", "[", 
         RowBox[{"\"\<k\>\"", ",", "\"\<s\>\""}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.01", ",", "0.1"}], "}"}], ",", "Setter"}], "}"}], "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Purpleopt", ",", "1", ",", "\"\<how to plot purple:\>\""}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "\[Rule]", "\"\< Plot \>\""}], ",", 
        RowBox[{"2", "\[Rule]", "\"\< Table \>\""}]}], "}"}], ",", "Setter"}],
      "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]], "Input"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`ks$$ = 0.1, $CellContext`Purpleopt$$ = 1, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`ks$$], 0.1, 
       Subscript["k", "s"]}, {0.01, 0.1}}, {{
       Hold[$CellContext`Purpleopt$$], 1, "how to plot purple:"}, {
      1 -> " Plot ", 2 -> " Table "}}}, Typeset`size$$ = {360., {112., 116.}},
     Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`ks$66920$$ = False, $CellContext`Purpleopt$66921$$ = 
    False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`ks$$ = 0.1, $CellContext`Purpleopt$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`ks$$, $CellContext`ks$66920$$, False], 
        Hold[$CellContext`Purpleopt$$, $CellContext`Purpleopt$66921$$, 
         False]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`\[Mu]$, $CellContext`rg$, $CellContext`rd$, \
$CellContext`rs$, $CellContext`sol$, $CellContext`cell$, $CellContext`sub$, \
$CellContext`range$}, $CellContext`\[Mu]$[
           Pattern[$CellContext`d$, 
            Blank[]]] := 
         0.8 ($CellContext`Cs[$CellContext`d$]/($CellContext`ks$$ + \
$CellContext`Cs[$CellContext`d$])); $CellContext`rg$[
           Pattern[$CellContext`d$, 
            
            Blank[]]] := $CellContext`\[Mu]$[$CellContext`d$] \
$CellContext`Cc[$CellContext`d$]; $CellContext`rd$[
           Pattern[$CellContext`d, 
            Blank[]]] := 
         0.06 $CellContext`Cc[$CellContext`d]; $CellContext`rs$[
           Pattern[$CellContext`d$, 
            
            Blank[]]] := (-2) $CellContext`rg$[$CellContext`d$]; \
$CellContext`sol$ = Quiet[
           Part[
            Solve[
             
             And[$CellContext`d $CellContext`Cc[$CellContext`d] == \
$CellContext`rg$[$CellContext`d] - $CellContext`rd$[$CellContext`d], \
$CellContext`d (
                1 - $CellContext`Cs[$CellContext`d]) == \
-$CellContext`rs$[$CellContext`d]], {
              $CellContext`Cc[$CellContext`d], 
              $CellContext`Cs[$CellContext`d]}], 2]]; $CellContext`cell$[
           Pattern[$CellContext`d$, 
            Blank[]]] := Piecewise[{{
             ReplaceAll[
              $CellContext`Cc[$CellContext`d$], $CellContext`sol$], \
$CellContext`d$ <= $CellContext`range$}, {
            0, $CellContext`range$ < $CellContext`d$}}]; $CellContext`sub$[
           Pattern[$CellContext`d$, 
            Blank[]]] := Piecewise[{{
             ReplaceAll[
              $CellContext`Cs[$CellContext`d$], $CellContext`sol$], \
$CellContext`d$ <= $CellContext`range$}, {
             ReplaceAll[
              ReplaceAll[
               $CellContext`Cs[$CellContext`d$], $CellContext`sol$], \
$CellContext`d$ -> $CellContext`range$], $CellContext`range$ < \
$CellContext`d$}}]; $CellContext`range$ := (0.74 - 0.06 $CellContext`ks$$)/(
          1 + $CellContext`ks$$); Show[
          Plot[
           $CellContext`cell$[$CellContext`d], {$CellContext`d, 0, 0.74}, 
           PlotStyle -> {Thick, Blue}], 
          If[$CellContext`Purpleopt$$ == 1, 
           Plot[
            $CellContext`sub$[$CellContext`d], {$CellContext`d, 0, 0.74}, 
            PlotStyle -> {Thick, Purple}], 
           Graphics[{Thick, Purple, 
             Line[
              Table[{$CellContext`di, 
                ReplaceAll[
                 $CellContext`sub$[$CellContext`d], $CellContext`d -> \
$CellContext`di]}, {$CellContext`di, 0, 0.74 - 0.00025, 0.00025}]]}]], 
          PlotRange -> {{0, 0.74}, {0, All}}, Frame -> True, Axes -> False]], 
      "Specifications" :> {{{$CellContext`ks$$, 0.1, 
          Subscript["k", "s"]}, {0.01, 0.1}, ControlType -> 
         Setter}, {{$CellContext`Purpleopt$$, 1, "how to plot purple:"}, {
         1 -> " Plot ", 2 -> " Table "}, ControlType -> Setter}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{411., {167., 174.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.648561157233802*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Mu]", ",", "rg", ",", "rd", ",", "rs", ",", "sol", ",", "cell", ",", 
     "sub"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Mu]", "[", "d_", "]"}], ":=", 
     RowBox[{"\[Mu]max", "*", 
      FractionBox[
       RowBox[{"Cs", "[", "d", "]"}], 
       RowBox[{"ks", "+", 
        RowBox[{"Cs", "[", "d", "]"}]}]]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rg", "[", "d_", "]"}], ":=", 
     RowBox[{
      RowBox[{"\[Mu]", "[", "d", "]"}], "*", 
      RowBox[{"Cc", "[", "d", "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rd", "[", "d_", "]"}], ":=", 
     RowBox[{"kd", "*", 
      RowBox[{"Cc", "[", "d", "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rs", "[", "d_", "]"}], ":=", 
     RowBox[{
      RowBox[{"-", "2"}], "*", 
      RowBox[{"rg", "[", "d", "]"}]}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"sol", ":=", 
     RowBox[{"Quiet", "@", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d", "*", 
             RowBox[{"Cc", "[", "d", "]"}]}], "\[Equal]", 
            RowBox[{
             RowBox[{"rg", "[", "d", "]"}], "-", 
             RowBox[{"rd", "[", "d", "]"}]}]}], ")"}], "\[And]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d", "*", 
             RowBox[{"(", 
              RowBox[{"Cs0", "-", 
               RowBox[{"Cs", "[", "d", "]"}]}], ")"}]}], "\[Equal]", 
            RowBox[{"-", 
             RowBox[{"rs", "[", "d", "]"}]}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cc", "[", "d", "]"}], ",", 
           RowBox[{"Cs", "[", "d", "]"}]}], "}"}]}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cell", "[", "d_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Cc", "[", "d", "]"}], "/.", "sol"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sub", "[", "d_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Cs", "[", "d", "]"}], "/.", "sol"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Text", "@", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<\!\(\*SubscriptBox[\(C\), \(C\)]\) =\>\"", ",", 
             RowBox[{"Simplify", "@", 
              RowBox[{"cell", "[", "d", "]"}]}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\"\<\!\(\*SubscriptBox[\(C\), \(S\)]\) =\>\"", ",", 
             RowBox[{"Simplify", "@", 
              RowBox[{"sub", "[", "d", "]"}]}]}], "}"}]}], "}"}], ",", 
         RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], ",", "22"}], 
      "]"}]}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.648561201591339*^9, 3.6485613528209887`*^9}}],

Cell[BoxData[
 InterpretationBox[Cell[BoxData[
   FormBox[
    StyleBox[
     TagBox[GridBox[{
        {"\<\"\\!\\(\\*SubscriptBox[\\(C\\), \\(C\\)]\\) =\"\>", 
         FractionBox[
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"d", "+", "kd"}], ")"}], " ", "ks"}], "+", 
             RowBox[{"Cs0", " ", 
              RowBox[{"(", 
               RowBox[{"d", "+", "kd", "-", "\[Mu]max"}], ")"}]}]}], ")"}]}], 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"d", "+", "kd"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"d", "+", "kd", "-", "\[Mu]max"}], ")"}]}]]},
        {"\<\"\\!\\(\\*SubscriptBox[\\(C\\), \\(S\\)]\\) =\"\>", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"d", "+", "kd"}], ")"}], " ", "ks"}], 
           RowBox[{"d", "+", "kd", "-", "\[Mu]max"}]]}]}
       },
       AutoDelete->False,
       GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"],
     StripOnInput->False,
     FontSize->22], TextForm]], "InlineText"],
  Text[
   Style[
    Grid[{{
      "\!\(\*SubscriptBox[\(C\), \(C\)]\) =", 
       Rational[
        1, 2] $CellContext`d ($CellContext`d + $CellContext`kd)^(-1) \
(($CellContext`d + $CellContext`kd) $CellContext`ks + $CellContext`Cs0 \
($CellContext`d + $CellContext`kd - $CellContext`\[Mu]max))/($CellContext`d + \
$CellContext`kd - $CellContext`\[Mu]max)}, {
      "\!\(\*SubscriptBox[\(C\), \(S\)]\) =", -($CellContext`d + \
$CellContext`kd) $CellContext`ks/($CellContext`d + $CellContext`kd - \
$CellContext`\[Mu]max)}}, Frame -> All], 22]]]], "Output",
 CellChangeTimes->{{3.6485612338801856`*^9, 3.648561265917018*^9}, {
  3.6485613490787745`*^9, 3.648561353601033*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Cc", "[", "d_", "]"}], ":=", 
   FractionBox[
    RowBox[{"d", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d", "+", "kd"}], ")"}], "*", "ks"}], "+", 
       RowBox[{"Cs0", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", "+", "kd", "-"}], "\[InvisibleComma]", "\[Mu]max"}], 
         ")"}]}]}], ")"}]}], 
    RowBox[{"2", "*", 
     RowBox[{"(", 
      RowBox[{"d", "+", "kd"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"d", "+", "kd", "-", "\[Mu]max"}], ")"}]}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cs", "[", "d_", "]"}], ":=", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"ks", "*", 
      RowBox[{"(", 
       RowBox[{"d", "+", "kd"}], ")"}]}], 
     RowBox[{"d", "+", "kd", "-", "\[Mu]max"}]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6485613588083315`*^9, 3.648561445403284*^9}}]
},
WindowSize->{1366, 686},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 7, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 8223, 208, 717, "Input"],
Cell[8806, 232, 6707, 128, 380, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15550, 365, 9990, 261, 828, "Input"],
Cell[25543, 628, 6205, 126, 358, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31785, 759, 6330, 166, 577, "Input"],
Cell[38118, 927, 4809, 101, 358, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42964, 1033, 3159, 86, 365, "Input"],
Cell[46126, 1121, 1935, 48, 106, "Output"]
}, Open  ]],
Cell[48076, 1172, 949, 31, 86, "Input"]
}
]
*)

(* End of internal cache information *)
