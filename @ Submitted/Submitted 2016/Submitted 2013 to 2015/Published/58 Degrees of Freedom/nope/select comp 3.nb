(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     66801,       1690]
NotebookOptionsPosition[     66077,       1661]
NotebookOutlinePosition[     66422,       1676]
CellTagsIndexPosition[     66379,       1673]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"comp", ",", "equipment", ",", "streams"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"comp", "[", 
        RowBox[{"label_", ",", "pos_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Subscript", "[", 
              RowBox[{"label", ",", "#"}], "]"}], ",", "15"}], "]"}], ",", 
           "pos", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"#", "*", "2"}]}], "}"}]}], "]"}], "&"}], "/@", 
        RowBox[{"Range", "@", "species"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"comp", "[", 
          RowBox[{"label_", ",", "pos_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"label", ",", "#"}], "]"}], ",", "15"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pos", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"pos", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", 
                RowBox[{"#", "*", "0.25"}]}]}], "}"}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "@", "species"}]}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"equipment", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<unit 1\>\"", ",", 
           RowBox[{"Rectangle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{"\"\<unit 1\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<unit 2\>\"", ",", 
           RowBox[{"Rectangle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"6", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"8", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{"\"\<unit 2\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"7", ",", "1"}], "}"}]}], "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"streams", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<A\>\"", ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{"\"\<A\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"comp", "[", 
            RowBox[{"\"\<a\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<B\>\"", ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"4", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"6", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{"\"\<B\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"5", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"comp", "[", 
            RowBox[{"\"\<b\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"5", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<C\>\"", ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"8", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"10", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{"\"\<C\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"9", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"comp", "[", 
            RowBox[{"\"\<c\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"9", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<D\>\"", ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"7", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"7", ",", 
                RowBox[{"-", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{"\"\<D\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", 
               RowBox[{"-", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"comp", "[", 
            RowBox[{"\"\<d\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FaceForm", "[", "Transparent", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"FreeQ", "[", 
                 RowBox[{"e", ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Button", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"EdgeForm", "[", "Thick", "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "16"}], "]"}]}], 
                   "}"}], ",", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"e", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Button", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"EdgeForm", "[", 
                    RowBox[{"{", 
                    RowBox[{"Thick", ",", "Blue"}], "}"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "16", ",", "Bold", 
                    ",", "Blue"}], "]"}]}], "}"}], ",", 
                  RowBox[{"e", "=", 
                   RowBox[{"DeleteCases", "[", 
                    RowBox[{"e", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}]}], 
               "\[IndentingNewLine]", "]"}], "&"}], "/@", "equipment"}]}], 
           "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"FreeQ", "[", 
                 RowBox[{"s", ",", "#"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Button", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "16"}], "]"}]}], 
                   "}"}], ",", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"s", ",", "#"}], "]"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Button", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"Blue", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "16", ",", "Bold"}], 
                    "]"}]}], "}"}], ",", 
                  RowBox[{"s", "=", 
                   RowBox[{"DeleteCases", "[", 
                    RowBox[{"s", ",", "#"}], "]"}]}]}], "]"}]}], 
               "\[IndentingNewLine]", "]"}], "&"}], "/@", "streams"}]}], 
           "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"FreeQ", "[", 
                RowBox[{"c", ",", "#"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Button", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "4", "]"}], "]"}], ",", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"c", ",", "#"}], "]"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Button", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", "Bold", ",", 
                   "Blue"}], "]"}], ",", 
                 RowBox[{"c", "=", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{"c", ",", "#"}], "]"}]}]}], "]"}]}], 
              "\[IndentingNewLine]", "]"}], "&"}], ",", "s"}], "]"}]}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "500"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"species", ",", "3", ",", "\"\<number of species\>\""}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3", ",", "4"}], "}"}], ",", "Setter"}], "}"}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"e", ",", 
        RowBox[{"{", "}"}]}], "}"}], ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s", ",", 
        RowBox[{"{", "}"}]}], "}"}], ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"c", ",", 
        RowBox[{"{", "}"}]}], "}"}], ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.6591194737280674`*^9, 3.65911955046041*^9}, {
  3.6591195844188375`*^9, 3.659119608504198*^9}, {3.6592052320435753`*^9, 
  3.659205243947256*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`c$$ = {}, $CellContext`e$$ = {}, \
$CellContext`s$$ = {}, $CellContext`species$$ = 3, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`species$$], 3, "number of species"}, {2, 3, 4}}, {{
       Hold[$CellContext`e$$], {}}}, {{
       Hold[$CellContext`s$$], {}}}, {{
       Hold[$CellContext`c$$], {}}}}, Typeset`size$$ = {500., {73., 78.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`species$160613$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`c$$ = {}, $CellContext`e$$ = {}, \
$CellContext`s$$ = {}, $CellContext`species$$ = 3}, "ControllerVariables" :> {
        Hold[$CellContext`species$$, $CellContext`species$160613$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`comp$, $CellContext`equipment$, \
$CellContext`streams$}, $CellContext`comp$[
           Pattern[$CellContext`label$, 
            Blank[]], 
           Pattern[$CellContext`pos$, 
            Blank[]]] := Map[Text[
            Style[
             Subscript[$CellContext`label$, #], 15], $CellContext`pos$, {
            0, # 2}]& , 
           Range[$CellContext`species$$]]; $CellContext`equipment$ = {{
           "unit 1", 
            Rectangle[{2, 0}, {4, 2}], 
            Text["unit 1", {3, 1}]}, {"unit 2", 
            Rectangle[{6, 0}, {8, 2}], 
            Text["unit 2", {7, 1}]}}; $CellContext`streams$ = {{"A", 
            Arrow[{{-1, 1}, {2, 1}}], 
            Text["A", {0, 1}, {0, -1}], 
            $CellContext`comp$["a", {0, 1}]}, {"B", 
            Arrow[{{4, 1}, {6, 1}}], 
            Text["B", {5, 1}, {0, -1}], 
            $CellContext`comp$["b", {5, 1}]}, {"C", 
            Arrow[{{8, 1}, {10, 1}}], 
            Text["C", {9, 1}, {0, -1}], 
            $CellContext`comp$["c", {9, 1}]}, {"D", 
            Arrow[{{7, 0}, {7, -1}, {1, -1}, {1, 1}}], 
            Text["D", {4, -1}, {0, -1}], 
            $CellContext`comp$["d", {4, -1}]}}; Graphics[{{
            FaceForm[Transparent], 
            Map[If[
              FreeQ[$CellContext`e$$, 
               Part[#, 1]], 
              Button[{
                EdgeForm[Thick], 
                Part[#, 2], 
                Style[
                 Part[#, 3], 16]}, 
               AppendTo[$CellContext`e$$, 
                Part[#, 1]]], 
              Button[{
                EdgeForm[{Thick, Blue}], 
                Part[#, 2], 
                Style[
                 Part[#, 3], 16, Bold, Blue]}, $CellContext`e$$ = 
               DeleteCases[$CellContext`e$$, 
                 Part[#, 1]]]]& , $CellContext`equipment$]}, {Thick, 
            Map[If[
              FreeQ[$CellContext`s$$, #], 
              Button[{
                Part[#, 2], 
                Style[
                 Part[#, 3], 16]}, 
               AppendTo[$CellContext`s$$, #]], 
              Button[{Blue, 
                Part[#, 2], 
                Style[
                 Part[#, 3], 16, Bold]}, $CellContext`s$$ = 
               DeleteCases[$CellContext`s$$, #]]]& , $CellContext`streams$]}, 
           Map[If[
             FreeQ[$CellContext`c$$, #], 
             Button[
              Part[#, 4], 
              AppendTo[$CellContext`c$$, #]], 
             Button[
              Style[
               Part[#, 4], Bold, Blue], $CellContext`c$$ = 
              DeleteCases[$CellContext`c$$, #]]]& , $CellContext`s$$]}, 
          ImageSize -> 500]], 
      "Specifications" :> {{{$CellContext`species$$, 3, 
          "number of species"}, {2, 3, 4}, ControlType -> 
         Setter}, {{$CellContext`e$$, {}}, ControlType -> 
         None}, {{$CellContext`s$$, {}}, ControlType -> 
         None}, {{$CellContext`c$$, {}}, ControlType -> None}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{551., {117., 124.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.6591194671881976`*^9, 3.659119494537239*^9}, 
   3.659119552219509*^9, {3.6591195988491545`*^9, 3.6591196167201633`*^9}, 
   3.659187071050826*^9, 3.659205245290333*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "comp", ",", "comp2", ",", "equipment", ",", "streams", ",", 
       "components"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"comp", "[", 
        RowBox[{"label_", ",", "pos_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Subscript", "[", 
              RowBox[{"label", ",", "#"}], "]"}], ",", "15"}], "]"}], ",", 
           "pos", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"#", "*", "2"}]}], "}"}]}], "]"}], "&"}], "/@", 
        RowBox[{"Range", "@", "species"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"comp", "[", 
          RowBox[{"label_", ",", "pos_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"label", ",", "#"}], "]"}], ",", "15"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pos", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"pos", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", 
                RowBox[{"#", "*", "0.25"}]}]}], "}"}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "@", "species"}]}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"comp2", "[", 
        RowBox[{"label_", ",", "num_", ",", "pos_"}], "]"}], ":=", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"label", ",", "num"}], "]"}], ",", "15", ",", 
           RowBox[{"Background", "\[Rule]", "Yellow"}]}], "]"}], ",", "pos"}],
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"equipment", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<unit 1\>\"", ",", 
           RowBox[{"Rectangle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{"\"\<unit 1\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<unit 2\>\"", ",", 
           RowBox[{"Rectangle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"6", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"8", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{"\"\<unit 2\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"7", ",", "1"}], "}"}]}], "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"streams", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<A\>\"", ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{"\"\<A\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"comp", "[", 
            RowBox[{"\"\<a\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<B\>\"", ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"4", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"6", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{"\"\<B\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"5", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"comp", "[", 
            RowBox[{"\"\<b\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"5", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<C\>\"", ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"8", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"10", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{"\"\<C\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"9", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"comp", "[", 
            RowBox[{"\"\<c\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"9", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<D\>\"", ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"7", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"7", ",", 
                RowBox[{"-", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{"\"\<D\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", 
               RowBox[{"-", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"comp", "[", 
            RowBox[{"\"\<d\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"components", "=", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Flatten", "@", 
            RowBox[{"{", 
             RowBox[{"\"\<A\>\"", ",", 
              RowBox[{"comp", "[", 
               RowBox[{"\"\<a\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Flatten", "@", 
            RowBox[{"{", 
             RowBox[{"\"\<B\>\"", ",", 
              RowBox[{"comp", "[", 
               RowBox[{"\"\<b\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"5", ",", "1"}], "}"}]}], "]"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Flatten", "@", 
            RowBox[{"{", 
             RowBox[{"\"\<C\>\"", ",", 
              RowBox[{"comp", "[", 
               RowBox[{"\"\<c\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"9", ",", "1"}], "}"}]}], "]"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Flatten", "@", 
            RowBox[{"{", 
             RowBox[{"\"\<D\>\"", ",", 
              RowBox[{"comp", "[", 
               RowBox[{"\"\<d\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "}"}]}]}], 
          "\[IndentingNewLine]", "}"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"components", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<A\>\"", ",", 
           RowBox[{"comp2", "[", 
            RowBox[{"\"\<a\>\"", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.5"}], "}"}]}], "]"}], ",", 
           RowBox[{"comp2", "[", 
            RowBox[{"\"\<a\>\"", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<B\>\"", ",", 
           RowBox[{"comp2", "[", 
            RowBox[{"\"\<b\>\"", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"5", ",", "0.5"}], "}"}]}], "]"}], ",", 
           RowBox[{"comp2", "[", 
            RowBox[{"\"\<b\>\"", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"5", ",", "0"}], "}"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<C\>\"", ",", 
           RowBox[{"comp2", "[", 
            RowBox[{"\"\<c\>\"", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"9", ",", "0.5"}], "}"}]}], "]"}], ",", 
           RowBox[{"comp2", "[", 
            RowBox[{"\"\<c\>\"", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"9", ",", "0"}], "}"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<D\>\"", ",", 
           RowBox[{"comp2", "[", 
            RowBox[{"\"\<d\>\"", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", 
               RowBox[{"-", "1.5"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"comp2", "[", 
            RowBox[{"\"\<d\>\"", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", 
               RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"FaceForm", "[", "Transparent", "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"FreeQ", "[", 
                    RowBox[{"e", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EdgeForm", "[", "Thick", "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "16"}], "]"}]}], 
                    "}"}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"e", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EdgeForm", "[", 
                    RowBox[{"{", 
                    RowBox[{"Thick", ",", "Blue"}], "}"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "16", ",", "Bold", 
                    ",", "Blue"}], "]"}]}], "}"}], ",", 
                    RowBox[{"e", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"e", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}]}], 
                  "\[IndentingNewLine]", "]"}], "&"}], "/@", "equipment"}]}], 
              "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Thick", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"FreeQ", "[", 
                    RowBox[{"s", ",", "#"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "16"}], "]"}]}], 
                    "}"}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"s", ",", "#"}], "]"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "16", ",", "Bold"}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"s", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"s", ",", "#"}], "]"}]}]}], "]"}]}], 
                  "\[IndentingNewLine]", "]"}], "&"}], "/@", "streams"}]}], 
              "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"FreeQ", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", "Bold", ",", 
                    "Blue"}], "]"}], ",", 
                    RowBox[{"c", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}]}], "]"}]}], 
                  "\[IndentingNewLine]", "]"}], "&"}], ",", "s"}], "]"}], 
              "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"FreeQ", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Button", "[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Button", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "Bold", ",", 
                    "Blue"}], "]"}], ",", 
                   RowBox[{"c", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}]}], 
                "\[IndentingNewLine]", "]"}], "&"}], "/@", "components"}], 
             ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"FreeQ", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Button", "[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Button", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "Bold", ",", 
                    "Blue"}], "]"}], ",", 
                   RowBox[{"c", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}]}], 
                "\[IndentingNewLine]", "]"}], "&"}], "/@", "components"}]}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "500"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"FreeQ", "[", 
              RowBox[{"e", ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], "/@", 
            "equipment"}], ","}], "*)"}], "\[IndentingNewLine]", 
         "components"}], "\[IndentingNewLine]", "}"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"species", ",", "2", ",", "\"\<number of species\>\""}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3", ",", "4"}], "}"}], ",", "Setter"}], "}"}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"e", ",", 
        RowBox[{"{", "}"}]}], "}"}], ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s", ",", 
        RowBox[{"{", "}"}]}], "}"}], ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"c", ",", 
        RowBox[{"{", "}"}]}], "}"}], ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzUsowwEAx/FNW57RPJLDGiUO0zRhy7NZiWFFq62dMH8yGTMskXCQrc2B
cZAcPLIUsXksSmslao+ylZZXNhdZluTRiPx/O/z6XH71zWnvayFiKBQKixy0
HPH/AjUhwUTmCzVIurNdEg85k1QGZJm+0uG13ceGlLqNwujPY+XCN5O7GtKU
5nq4mkB0Qe2AshueLQyr4KKiawq+37TpYNUJ3wglP7ELUFXgOoDPXP0xHGHn
eCBXTPfBFb3DD5cNzDsYpqcGoJx9/wSnx3bfYetSKAKLDJ9RL4aceY+klg17
IZTIBGXQfVJcATuy1uTQe5jbCx/UFjWcFSfr4MBtnBGKZzRzsDOtfBFWu+bX
IU3j3YJ2W6IVqnozbNEO03QK+71rDng5cu6EjSmEv1QYEsiskTvor3sNwv3v
j0c4PtrwBKUiDpVH6uzcYUDzoD8L5mcrhLB5rKkFVppSpTCJM0HAq71NJaz9
YPfA4+dfdStpmCfSwn9uuwMG
  "]],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`c$$ = {
    "A"}, $CellContext`e$$ = {}, $CellContext`s$$ = {}, \
$CellContext`species$$ = 2, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`species$$], 2, "number of species"}, {2, 3, 4}}, {{
       Hold[$CellContext`e$$], {}}}, {{
       Hold[$CellContext`s$$], {}}}, {{
       Hold[$CellContext`c$$], {}}}}, Typeset`size$$ = {672., {114., 121.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`species$158992$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`c$$ = {}, $CellContext`e$$ = {}, \
$CellContext`s$$ = {}, $CellContext`species$$ = 2}, "ControllerVariables" :> {
        Hold[$CellContext`species$$, $CellContext`species$158992$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`comp$, $CellContext`comp2$, \
$CellContext`equipment$, $CellContext`streams$, $CellContext`components$}, \
$CellContext`comp$[
           Pattern[$CellContext`label$, 
            Blank[]], 
           Pattern[$CellContext`pos$, 
            Blank[]]] := Map[Text[
            Style[
             Subscript[$CellContext`label$, #], 15], $CellContext`pos$, {
            0, # 2}]& , 
           Range[$CellContext`species$$]]; $CellContext`comp2$[
           Pattern[$CellContext`label, 
            Blank[]], 
           Pattern[$CellContext`num, 
            Blank[]], 
           Pattern[$CellContext`pos, 
            Blank[]]] := Text[
           Style[
            Subscript[$CellContext`label, $CellContext`num], 15, Background -> 
            Yellow], $CellContext`pos]; $CellContext`equipment$ = {{"unit 1", 
            Rectangle[{2, 0}, {4, 2}], 
            Text["unit 1", {3, 1}]}, {"unit 2", 
            Rectangle[{6, 0}, {8, 2}], 
            Text["unit 2", {7, 1}]}}; $CellContext`streams$ = {{"A", 
            Arrow[{{-1, 1}, {2, 1}}], 
            Text["A", {0, 1}, {0, -1}], 
            $CellContext`comp$["a", {0, 1}]}, {"B", 
            Arrow[{{4, 1}, {6, 1}}], 
            Text["B", {5, 1}, {0, -1}], 
            $CellContext`comp$["b", {5, 1}]}, {"C", 
            Arrow[{{8, 1}, {10, 1}}], 
            Text["C", {9, 1}, {0, -1}], 
            $CellContext`comp$["c", {9, 1}]}, {"D", 
            Arrow[{{7, 0}, {7, -1}, {1, -1}, {1, 1}}], 
            Text["D", {4, -1}, {0, -1}], 
            $CellContext`comp$["d", {4, -1}]}}; $CellContext`components$ = {{
           "A", 
            $CellContext`comp2$["a", 1, {0, 0.5}], 
            $CellContext`comp2$["a", 2, {0, 0}]}, {"B", 
            $CellContext`comp2$["b", 1, {5, 0.5}], 
            $CellContext`comp2$["b", 2, {5, 0}]}, {"C", 
            $CellContext`comp2$["c", 1, {9, 0.5}], 
            $CellContext`comp2$["c", 2, {9, 0}]}, {"D", 
            $CellContext`comp2$["d", 1, {4, -1.5}], 
            $CellContext`comp2$["d", 2, {4, -2}]}}; Column[{
           Graphics[{{
              FaceForm[Transparent], 
              Map[If[
                FreeQ[$CellContext`e$$, 
                 Part[#, 1]], 
                Button[{
                  EdgeForm[Thick], 
                  Part[#, 2], 
                  Style[
                   Part[#, 3], 16]}, 
                 AppendTo[$CellContext`e$$, 
                  Part[#, 1]]], 
                Button[{
                  EdgeForm[{Thick, Blue}], 
                  Part[#, 2], 
                  Style[
                   Part[#, 3], 16, Bold, Blue]}, $CellContext`e$$ = 
                 DeleteCases[$CellContext`e$$, 
                   Part[#, 1]]]]& , $CellContext`equipment$]}, {Thick, 
              Map[If[
                FreeQ[$CellContext`s$$, #], 
                Button[{
                  Part[#, 2], 
                  Style[
                   Part[#, 3], 16]}, 
                 AppendTo[$CellContext`s$$, #]], 
                Button[{Blue, 
                  Part[#, 2], 
                  Style[
                   Part[#, 3], 16, Bold]}, $CellContext`s$$ = 
                 DeleteCases[$CellContext`s$$, #]]]& , \
$CellContext`streams$]}, 
             Map[If[
               FreeQ[$CellContext`c$$, 
                Part[#, 1]], 
               Button[
                Part[#, 2], 
                AppendTo[$CellContext`c$$, 
                 Part[#, 1]]], 
               Button[
                Style[
                 Part[#, 2], Bold, Blue], $CellContext`c$$ = 
                DeleteCases[$CellContext`c$$, 
                  Part[#, 1]]]]& , $CellContext`components$], 
             Map[If[
               FreeQ[$CellContext`c$$, 
                Part[#, 1]], 
               Button[
                Part[#, 3], 
                AppendTo[$CellContext`c$$, 
                 Part[#, 1]]], 
               Button[
                Style[
                 Part[#, 3], Bold, Blue], $CellContext`c$$ = 
                DeleteCases[$CellContext`c$$, 
                  Part[#, 1]]]]& , $CellContext`components$]}, ImageSize -> 
            500], $CellContext`components$}]], 
      "Specifications" :> {{{$CellContext`species$$, 2, 
          "number of species"}, {2, 3, 4}, ControlType -> 
         Setter}, {{$CellContext`e$$, {}}, ControlType -> 
         None}, {{$CellContext`s$$, {}}, ControlType -> 
         None}, {{$CellContext`c$$, {}}, ControlType -> None}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{723., {159., 166.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.6589445013206263`*^9, 3.6589445278951464`*^9}, {
   3.6589446140060716`*^9, 3.658944650182141*^9}, 3.658944810194293*^9, {
   3.6589448552928724`*^9, 3.658944863871363*^9}, {3.6589448977613015`*^9, 
   3.6589449112790747`*^9}, 3.6589450288527994`*^9, 3.6589450718602595`*^9, 
   3.6589451024270077`*^9, 3.6589453408656454`*^9, 3.658945568681676*^9, 
   3.6589456179564943`*^9, {3.658945762752776*^9, 3.658945797561767*^9}, {
   3.658945834531882*^9, 3.658945932914509*^9}, 3.658945969672611*^9, 
   3.658946027820937*^9, 3.658946111040697*^9, {3.658946141187422*^9, 
   3.658946161849603*^9}, 3.6589462042860303`*^9, 3.6589462532758327`*^9, 
   3.658946313322267*^9, {3.658946376920905*^9, 3.658946469978227*^9}, 
   3.6589465124336557`*^9, {3.658946873472306*^9, 3.6589468911503167`*^9}, 
   3.6589469432732983`*^9, {3.6589470271370945`*^9, 3.6589470430560055`*^9}, {
   3.65894731850276*^9, 3.6589473454583015`*^9}, 3.6589474341003723`*^9, 
   3.6589474723295584`*^9, 3.658947513951939*^9, 3.65894766135637*^9, {
   3.658947692271138*^9, 3.6589476983574867`*^9}, 3.6589477334134912`*^9, 
   3.658947766656393*^9, 3.658947799541274*^9, {3.658947857153569*^9, 
   3.658947880635912*^9}, {3.6589479461166573`*^9, 3.6589479935793724`*^9}, {
   3.658948061924281*^9, 3.658948085449627*^9}, {3.658948145253048*^9, 
   3.6589481937988243`*^9}, 3.659118322275282*^9, 3.659118371070546*^9, 
   3.65911840639205*^9, {3.6591184385633698`*^9, 3.6591184623767133`*^9}, 
   3.6591185392520585`*^9, {3.6591185881528187`*^9, 3.6591186087659893`*^9}, 
   3.659118748147379*^9, {3.6591187843374243`*^9, 3.659118800079815*^9}, 
   3.6591192319938803`*^9, {3.65911930625609*^9, 3.6591193177307396`*^9}, {
   3.6591193696346807`*^9, 3.659119405045679*^9}, 3.659119449984225*^9, {
   3.6592035074339333`*^9, 3.6592035150233674`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"comp", "[", 
    RowBox[{"label_", ",", "pos_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Text", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"label", ",", "#"}], "]"}], ",", "15"}], "]"}], ",", "pos", 
       ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"#", "*", "2"}]}], "}"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "@", "species"}]}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{"Text", "[", 
    RowBox[{
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Subscript", "[", 
        RowBox[{"\"\<a\>\"", ",", "2"}], "]"}], ",", "15", ",", 
       RowBox[{"Background", "\[Rule]", "Green"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"2", "*", "2"}]}], "}"}]}], "]"}], 
   RowBox[{"(*", 
    RowBox[{"&", "/@", 
     RowBox[{"Range", "@", "2"}]}], "*)"}], "\[IndentingNewLine]", "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6591186513684072`*^9, 3.659118703472845*^9}}],

Cell[BoxData[
 GraphicsBox[InsetBox[
   StyleBox[
    SubscriptBox["\<\"a\"\>", "2"],
    StripOnInput->False,
    FontSize->15,
    Background->RGBColor[0, 1, 0]], {0, 0}, {0, 4}]]], "Output",
 CellChangeTimes->{{3.659118665052677*^9, 3.6591187039183683`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FaceForm", "[", "Transparent", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"FreeQ", "[", 
              RowBox[{"e", ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Button", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"EdgeForm", "[", "Thick", "]"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "16"}], "]"}]}], 
                "}"}], ",", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"e", ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Button", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"EdgeForm", "[", 
                  RowBox[{"{", 
                   RowBox[{"Thick", ",", "Blue"}], "}"}], "]"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "16", ",", "Bold", 
                   ",", "Blue"}], "]"}]}], "}"}], ",", 
               RowBox[{"e", "=", 
                RowBox[{"DeleteCases", "[", 
                 RowBox[{"e", ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}]}], 
            "\[IndentingNewLine]", "]"}], "&"}], "/@", "equipment"}]}], 
        "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"FreeQ", "[", 
              RowBox[{"s", ",", "#"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Button", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "16"}], "]"}]}], 
                "}"}], ",", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"s", ",", "#"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Button", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Blue", ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "16", ",", "Bold"}], 
                  "]"}]}], "}"}], ",", 
               RowBox[{"s", "=", 
                RowBox[{"DeleteCases", "[", 
                 RowBox[{"s", ",", "#"}], "]"}]}]}], "]"}]}], 
            "\[IndentingNewLine]", "]"}], "&"}], "/@", "streams"}]}], 
        "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"FreeQ", "[", 
             RowBox[{"c", ",", "#"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Button", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "4", "]"}], "]"}], ",", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"c", ",", "#"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Button", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], ",", "Bold", ",", "Blue"}], 
               "]"}], ",", 
              RowBox[{"c", "=", 
               RowBox[{"DeleteCases", "[", 
                RowBox[{"c", ",", "#"}], "]"}]}]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}], "&"}], ",", "s"}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "500"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"species", ",", "2", ",", "\"\<number of species\>\""}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3", ",", "4"}], "}"}], ",", "Setter"}], "}"}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"e", ",", 
        RowBox[{"{", "}"}]}], "}"}], ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s", ",", 
        RowBox[{"{", "}"}]}], "}"}], ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"c", ",", 
        RowBox[{"{", "}"}]}], "}"}], ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Initialization", "\[RuleDelayed]", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"comp", "[", 
        RowBox[{"label_", ",", "pos_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Subscript", "[", 
              RowBox[{"label", ",", "#"}], "]"}], ",", "15"}], "]"}], ",", 
           "pos", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"#", "*", "2"}]}], "}"}]}], "]"}], "&"}], "/@", 
        RowBox[{"Range", "@", "species"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"equipment", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<unit 1\>\"", ",", 
           RowBox[{"Rectangle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{"\"\<unit 1\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<unit 2\>\"", ",", 
           RowBox[{"Rectangle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"6", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"8", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{"\"\<unit 2\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"7", ",", "1"}], "}"}]}], "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"streams", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<A\>\"", ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{"\"\<A\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"comp", "[", 
            RowBox[{"\"\<a\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<B\>\"", ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"4", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"6", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{"\"\<B\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"5", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"comp", "[", 
            RowBox[{"\"\<b\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"5", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<C\>\"", ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"8", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"10", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{"\"\<C\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"9", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"comp", "[", 
            RowBox[{"\"\<c\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"9", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<D\>\"", ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"7", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"7", ",", 
                RowBox[{"-", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{"\"\<D\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", 
               RowBox[{"-", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"comp", "[", 
            RowBox[{"\"\<d\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "}"}]}], ";"}], ")"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.659203600708268*^9, 3.6592036772886486`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`c$$ = {{"A", 
      Arrow[{{-1, 1}, {2, 1}}], 
      Text["A", {0, 1}, {0, -1}], {
       Text[
        Style[
         Subscript["a", 1], 15], {0, 1}, {0, 2}], 
       Text[
        Style[
         Subscript["a", 2], 15], {0, 1}, {0, 4}]}}}, $CellContext`e$$ = {
    "unit 1"}, $CellContext`s$$ = {{"A", 
      Arrow[{{-1, 1}, {2, 1}}], 
      Text["A", {0, 1}, {0, -1}], {
       Text[
        Style[
         Subscript["a", 1], 15], {0, 1}, {0, 2}], 
       Text[
        Style[
         Subscript["a", 2], 15], {0, 1}, {0, 4}]}}, {"C", 
      Arrow[{{8, 1}, {10, 1}}], 
      Text["C", {9, 1}, {0, -1}], {
       Text[
        Style[
         Subscript["c", 1], 15], {9, 1}, {0, 2}], 
       Text[
        Style[
         Subscript["c", 2], 15], {9, 1}, {0, 4}]}}}, $CellContext`species$$ = 
    2, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`species$$], 2, "number of species"}, {2, 3, 4}}, {{
       Hold[$CellContext`e$$], {}}}, {{
       Hold[$CellContext`s$$], {}}}, {{
       Hold[$CellContext`c$$], {}}}}, Typeset`size$$ = {500., {73., 78.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    False, $CellContext`species$160479$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`c$$ = {}, $CellContext`e$$ = {}, \
$CellContext`s$$ = {}, $CellContext`species$$ = 2}, "ControllerVariables" :> {
        Hold[$CellContext`species$$, $CellContext`species$160479$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Graphics[{{
          FaceForm[Transparent], 
          Map[If[
            FreeQ[$CellContext`e$$, 
             Part[#, 1]], 
            Button[{
              EdgeForm[Thick], 
              Part[#, 2], 
              Style[
               Part[#, 3], 16]}, 
             AppendTo[$CellContext`e$$, 
              Part[#, 1]]], 
            Button[{
              EdgeForm[{Thick, Blue}], 
              Part[#, 2], 
              Style[
               Part[#, 3], 16, Bold, Blue]}, $CellContext`e$$ = 
             DeleteCases[$CellContext`e$$, 
               Part[#, 1]]]]& , $CellContext`equipment]}, {Thick, 
          Map[If[
            FreeQ[$CellContext`s$$, #], 
            Button[{
              Part[#, 2], 
              Style[
               Part[#, 3], 16]}, 
             AppendTo[$CellContext`s$$, #]], 
            Button[{Blue, 
              Part[#, 2], 
              Style[
               Part[#, 3], 16, Bold]}, $CellContext`s$$ = 
             DeleteCases[$CellContext`s$$, #]]]& , $CellContext`streams]}, 
         Map[If[
           FreeQ[$CellContext`c$$, #], 
           Button[
            Part[#, 4], 
            AppendTo[$CellContext`c$$, #]], 
           Button[
            Style[
             Part[#, 4], Bold, Blue], $CellContext`c$$ = 
            DeleteCases[$CellContext`c$$, #]]]& , $CellContext`s$$]}, 
        ImageSize -> 500], 
      "Specifications" :> {{{$CellContext`species$$, 2, 
          "number of species"}, {2, 3, 4}, ControlType -> 
         Setter}, {{$CellContext`e$$, {}}, ControlType -> 
         None}, {{$CellContext`s$$, {}}, ControlType -> 
         None}, {{$CellContext`c$$, {}}, ControlType -> None}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{551., {117., 124.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>(($CellContext`comp[
         Pattern[$CellContext`label$, 
          Blank[]], 
         Pattern[$CellContext`pos$, 
          Blank[]]] := Map[Text[
          Style[
           Subscript[$CellContext`label$, #], 15], $CellContext`pos$, {
          0, # 2}]& , 
         Range[$CellContext`species$$]]; $CellContext`equipment = {{"unit 1", 
          Rectangle[{2, 0}, {4, 2}], 
          Text["unit 1", {3, 1}]}, {"unit 2", 
          Rectangle[{6, 0}, {8, 2}], 
          Text["unit 2", {7, 1}]}}; $CellContext`streams = {{"A", 
          Arrow[{{-1, 1}, {2, 1}}], 
          Text["A", {0, 1}, {0, -1}], 
          $CellContext`comp["a", {0, 1}]}, {"B", 
          Arrow[{{4, 1}, {6, 1}}], 
          Text["B", {5, 1}, {0, -1}], 
          $CellContext`comp["b", {5, 1}]}, {"C", 
          Arrow[{{8, 1}, {10, 1}}], 
          Text["C", {9, 1}, {0, -1}], 
          $CellContext`comp["c", {9, 1}]}, {"D", 
          Arrow[{{7, 0}, {7, -1}, {1, -1}, {1, 1}}], 
          Text["D", {4, -1}, {0, -1}], 
          $CellContext`comp["d", {4, -1}]}}; Null); Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.659203654628352*^9}]
}, Open  ]]
},
WindowSize->{1366, 686},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.3 for Microsoft Windows (64-bit) (October 9, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 12974, 332, 872, "Input"],
Cell[13557, 356, 4905, 110, 258, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18499, 471, 21146, 526, 1472, "Input"],
Cell[39648, 999, 8083, 168, 342, "Output"]
}, Open  ]],
Cell[47746, 1170, 526, 17, 31, "Input"],
Cell[CellGroupData[{
Cell[48297, 1191, 687, 19, 72, "Input"],
Cell[48987, 1212, 261, 7, 375, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49285, 1224, 11484, 302, 732, "Input"],
Cell[60772, 1528, 5289, 130, 258, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
