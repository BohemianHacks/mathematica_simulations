(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     41379,        988]
NotebookOptionsPosition[     41056,        972]
NotebookOutlinePosition[     41401,        987]
CellTagsIndexPosition[     41358,        984]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"unit", ",", "comp", ",", "streams", ",", "streams2"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"unit", "[", 
        RowBox[{"pos_", ",", "side_"}], "]"}], ":=", 
       RowBox[{"Rectangle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "1.5"}], ",", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"side", "*", "1.5"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "1.5"}], ",", 
           RowBox[{
            RowBox[{"pos", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", 
            RowBox[{"side", "*", "1.5"}]}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"comp", "[", 
        RowBox[{"label_", ",", "pos_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Subscript", "[", 
              RowBox[{"label", ",", "#"}], "]"}], ",", "15"}], "]"}], ",", 
           "pos", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"#", "*", "2"}]}], "}"}]}], "]"}], "&"}], "/@", 
        RowBox[{"Range", "@", "species"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"streams", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<feed\>\"", ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "4"}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1.5"}], ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<feed\>\"", ",", "15"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "3"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1.5"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"comp", "[", 
            RowBox[{"\"\<z\>\"", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "3"}], ",", "0.25"}], "}"}]}], "]"}]}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<condenser\>\"", ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "3.75"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "5.25"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"4.5", ",", "5.25"}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<vapor\>\"", ",", "15"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"2.75", ",", "5.25"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1.5"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"comp", "[", 
            RowBox[{"\"\<y\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"2.75", ",", "5.5"}], "}"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<reboiler\>\"", ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "3.75"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "5.25"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"4.5", ",", 
                RowBox[{"-", "5.25"}]}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<liquid\>\"", ",", "15"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"1.5", ",", 
               RowBox[{"-", "5.25"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1.5"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"comp", "[", 
            RowBox[{"\"\<x\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"1.5", ",", 
               RowBox[{"-", "5.5"}]}], "}"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<cond product\>\"", ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"7.5", ",", "5.25"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"11", ",", "5.25"}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<overhead\>\"", ",", "15"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"9.2", ",", "5.25"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1.5"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"comp", "[", 
            RowBox[{"\"\<y\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"9.2", ",", "5.5"}], "}"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<reboiler product\>\"", ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"7.5", ",", 
                RowBox[{"-", "5.25"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"11", ",", 
                RowBox[{"-", "5.25"}]}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<bottoms\>\"", ",", "15"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"9.2", ",", 
               RowBox[{"-", "5.25"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1.5"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"comp", "[", 
            RowBox[{"\"\<x\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"9.2", ",", 
               RowBox[{"-", "5.5"}]}], "}"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<reflux\>\"", ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"6", ",", "3.75"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"6", ",", "2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1.5", ",", "2"}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<reflux\>\"", ",", "15"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"4.5", ",", "2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1.5"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"comp", "[", 
            RowBox[{"\"\<x\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"4.5", ",", "2.25"}], "}"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\"\<reboil\>\"", ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"6", ",", 
                RowBox[{"-", "3.75"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"6", ",", 
                RowBox[{"-", "2"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1.5", ",", 
                RowBox[{"-", "2"}]}], "}"}]}], "}"}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<reboil\>\"", ",", "15"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", 
               RowBox[{"-", "2"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1.5"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"comp", "[", 
            RowBox[{"\"\<y\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", 
               RowBox[{"-", "225"}]}], "}"}]}], "]"}]}], "}"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"streams2", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Flatten", "@", 
          RowBox[{"{", 
           RowBox[{"\"\<feed\>\"", ",", 
            RowBox[{"comp", "[", 
             RowBox[{"\"\<z\>\"", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "3"}], ",", "0.25"}], "}"}]}], "]"}]}], "}"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Flatten", "@", 
          RowBox[{"{", 
           RowBox[{"\"\<condenser\>\"", ",", 
            RowBox[{"comp", "[", 
             RowBox[{"\"\<y\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"2.75", ",", "5.5"}], "}"}]}], "]"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Flatten", "@", 
          RowBox[{"{", 
           RowBox[{"\"\<reboiler\>\"", ",", 
            RowBox[{"comp", "[", 
             RowBox[{"\"\<x\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"1.5", ",", 
                RowBox[{"-", "5.5"}]}], "}"}]}], "]"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Flatten", "@", 
          RowBox[{"{", 
           RowBox[{"\"\<cond product\>\"", ",", 
            RowBox[{"comp", "[", 
             RowBox[{"\"\<y\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"9.2", ",", "5.5"}], "}"}]}], "]"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Flatten", "@", 
          RowBox[{"{", 
           RowBox[{"\"\<reboiler product\>\"", ",", 
            RowBox[{"comp", "[", 
             RowBox[{"\"\<x\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"9.2", ",", 
                RowBox[{"-", "5.5"}]}], "}"}]}], "]"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Flatten", "@", 
          RowBox[{"{", 
           RowBox[{"\"\<reflux\>\"", ",", 
            RowBox[{"comp", "[", 
             RowBox[{"\"\<x\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"4.5", ",", "2.25"}], "}"}]}], "]"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Flatten", "@", 
          RowBox[{"{", 
           RowBox[{"\"\<reboil\>\"", ",", 
            RowBox[{"comp", "[", 
             RowBox[{"\"\<y\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", 
                RowBox[{"-", "225"}]}], "}"}]}], "]"}]}], "}"}]}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"EdgeForm", "[", "Thick", "]"}], ",", 
             RowBox[{"FaceForm", "[", "None", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"unit", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", "2.5"}], "]"}], ",", 
             RowBox[{"unit", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"6", ",", "5.25"}], "}"}], ",", "1"}], "]"}], ",", 
             RowBox[{"unit", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"6", ",", 
                 RowBox[{"-", "5.25"}]}], "}"}], ",", "1"}], "]"}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"FreeQ", "[", 
                    RowBox[{"s", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "Thick", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"s", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "Bold"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", "Thick", ",", "Blue",
                     ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"s", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"s", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}]}], 
                  "\[IndentingNewLine]", "]"}], "&"}], ",", "streams"}], 
               "]"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"FreeQ", "[", 
                    RowBox[{"s", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "Thick", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"s", ",", "#"}], "]"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "Bold"}], "]"}], ",",
                     "Thick", ",", "Blue", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"s", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"s", ",", "#"}], "]"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"FreeQ", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", "Bold"}], "]"}], ",", 
                    RowBox[{"c", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "\[IndentingNewLine]", "]"}], "&"}], ",", "s"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
                  "]"}], "&"}], ",", "streams"}], "]"}], "*)"}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"FreeQ", "[", 
                   RowBox[{"s", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Button", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "Thick", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"s", ",", "#"}], "]"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Button", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "Bold"}], "]"}], ",",
                     "Thick", ",", "Blue", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"s", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"s", ",", "#"}], "]"}]}]}], "]"}]}], 
                 "\[IndentingNewLine]", "]"}], "&"}], ",", "streams"}], "]"}],
              ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"FreeQ", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"4", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"4", ",", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}]}], "}"}],
                    ",", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"4", ",", "1"}], "]"}], "]"}], ",", "Bold"}], 
                    "]"}], ",", 
                    RowBox[{"c", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"4", ",", "2"}], "]"}], "]"}], ",", "Bold"}], 
                    "]"}], ",", 
                    RowBox[{"c", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}]}], 
                    "}"}]}], "\[IndentingNewLine]", "]"}], "&"}], ",", "s"}], 
               "]"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"FreeQ", "[", 
                   RowBox[{"c", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Button", "[", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Button", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", "Bold"}], "]"}], ",", 
                    RowBox[{"c", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}]}], 
                 "\[IndentingNewLine]", "]"}], "&"}], ",", "s"}], "]"}], 
             ","}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"FreeQ", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{"\"\<ooo\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "3"}], ",", 
                    RowBox[{"-", "2.5"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Button", "[", 
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<ooo\>\"", ",", "Bold"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "3"}], ",", 
                    RowBox[{"-", "2.5"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"c", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}]}], 
                  "\[IndentingNewLine]", "]"}], "&"}], ",", "s"}], "]"}], 
              ","}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"FreeQ", "[", 
                   RowBox[{"c", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Button", "[", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Button", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "Bold"}], "]"}], ",", 
                    RowBox[{"c", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}]}], 
                 "\[IndentingNewLine]", "]"}], "&"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "@", "s"}], "\[Equal]", "0"}], ",", "s", 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "@", "s"}], "\[Equal]", "1"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"s", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "4"}], "]"}], "]"}]}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"s", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"s", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", ",", "4"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "@", "s"}]}]}]}], "]"}]}], 
                "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
             "*)"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"ImageSize", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"550", ",", "400"}], "}"}]}], ",", 
           RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "8.5"}], ",", "7.25"}], "}"}]}], ",", 
           RowBox[{"ImagePadding", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"55", ",", "None"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"FreeQ", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "1", ",", 
                 "0"}], "]"}], "&"}], ",", "s"}], "]"}]}]}], "]"}], ","}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{"#", "&"}], ",", "s"}], "]"}], ","}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "s"}], "\[Equal]", "0"}], ",", "s", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", "s"}], "\[Equal]", "1"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"s", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"s", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "4"}], "]"}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"s", "[", 
                  RowBox[{"[", 
                   RowBox[{"#", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"s", "[", 
                  RowBox[{"[", 
                   RowBox[{"#", ",", "4"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
              RowBox[{"Range", "@", 
               RowBox[{"Length", "@", "s"}]}]}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], "*)"}], "\[IndentingNewLine]", "}"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"species", ",", "2", ",", "\"\<species\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3", ",", "4"}], "}"}], ",", "Setter"}], "}"}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"c", ",", 
        RowBox[{"{", "}"}]}], "}"}], ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s", ",", 
        RowBox[{"{", "}"}]}], "}"}], ",", 
      RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.658864216026622*^9, 3.6588645172048483`*^9}, {
   3.6588645498507156`*^9, 3.65886469871023*^9}, {3.6588647462779503`*^9, 
   3.6588648002720385`*^9}, {3.6588648772674427`*^9, 
   3.6588652021620255`*^9}, {3.6588652331257963`*^9, 3.658865554198161*^9}, {
   3.6588656013498583`*^9, 3.6588656045980434`*^9}, {3.6588656545559015`*^9, 
   3.658865767943386*^9}, {3.6588657983671265`*^9, 3.658865899778927*^9}, {
   3.65886593094271*^9, 3.65886602134088*^9}, {3.6588660608921423`*^9, 
   3.658866093219991*^9}, {3.6588661995140705`*^9, 3.658866274929384*^9}, {
   3.6588663399861054`*^9, 3.658866574183501*^9}, {3.6588667899378414`*^9, 
   3.658866811582079*^9}, {3.6588668463440676`*^9, 3.658866853455474*^9}, {
   3.658866895572883*^9, 3.6588668962799234`*^9}, {3.658873429963629*^9, 
   3.6588735634622645`*^9}, {3.658873604750626*^9, 3.6588736600637903`*^9}, {
   3.6588736942697463`*^9, 3.6588736963678665`*^9}, {3.6588737407974076`*^9, 
   3.658873755908272*^9}, {3.6588737994857645`*^9, 3.6588738041370306`*^9}, {
   3.6588738358018417`*^9, 3.6588739218127613`*^9}, {3.6588739653462515`*^9, 
   3.6588739977831063`*^9}, {3.6588740340191793`*^9, 
   3.6588740407965665`*^9}, {3.658874155652136*^9, 3.658874196409467*^9}, {
   3.658874227527247*^9, 3.658874300995449*^9}, {3.658874400783157*^9, 
   3.658874422126377*^9}, {3.6588744626646957`*^9, 3.658874536077895*^9}, {
   3.6588746136583323`*^9, 3.658874964774415*^9}, {3.658874997781303*^9, 
   3.6588751266896763`*^9}, {3.6588751786306467`*^9, 
   3.6588754780797744`*^9}, {3.658875658154074*^9, 3.6588756942321377`*^9}, {
   3.6588757506993675`*^9, 3.6588757976420527`*^9}, 3.6588760587689877`*^9}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`c$$ = {}, $CellContext`s$$ = {}, \
$CellContext`species$$ = 2, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`species$$], 2, "species"}, {2, 3, 4}}, {{
       Hold[$CellContext`c$$], {}}}, {{
       Hold[$CellContext`s$$], {}}}}, Typeset`size$$ = {550., {204., 211.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`species$163462$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`c$$ = {}, $CellContext`s$$ = {}, \
$CellContext`species$$ = 2}, "ControllerVariables" :> {
        Hold[$CellContext`species$$, $CellContext`species$163462$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`unit$, $CellContext`comp$, $CellContext`streams$, \
$CellContext`streams2$}, $CellContext`unit$[
           Pattern[$CellContext`pos, 
            Blank[]], 
           Pattern[$CellContext`side, 
            Blank[]]] := 
         Rectangle[{
           Part[$CellContext`pos, 1] - 1.5, 
            Part[$CellContext`pos, 2] - $CellContext`side 1.5}, {
           Part[$CellContext`pos, 1] + 1.5, 
            Part[$CellContext`pos, 2] + $CellContext`side 
             1.5}]; $CellContext`comp$[
           Pattern[$CellContext`label$, 
            Blank[]], 
           Pattern[$CellContext`pos$, 
            Blank[]]] := Map[Text[
            Style[
             Subscript[$CellContext`label$, #], 15], $CellContext`pos$, {
            0, # 2}]& , 
           Range[$CellContext`species$$]]; $CellContext`streams$ = {{"feed", 
            Arrow[{{-4, 0}, {-1.5, 0}}], 
            Text[
             Style["feed", 15], {-3, 0}, {0, -1.5}], 
            $CellContext`comp$["z", {-3, 0.25}]}, {"condenser", 
            Arrow[{{0, 3.75}, {0, 5.25}, {4.5, 5.25}}], 
            Text[
             Style["vapor", 15], {2.75, 5.25}, {0, -1.5}], 
            $CellContext`comp$["y", {2.75, 5.5}]}, {"reboiler", 
            Arrow[{{0, -3.75}, {0, -5.25}, {4.5, -5.25}}], 
            Text[
             Style["liquid", 15], {1.5, -5.25}, {0, -1.5}], 
            $CellContext`comp$["x", {1.5, -5.5}]}, {"cond product", 
            Arrow[{{7.5, 5.25}, {11, 5.25}}], 
            Text[
             Style["overhead", 15], {9.2, 5.25}, {0, -1.5}], 
            $CellContext`comp$["y", {9.2, 5.5}]}, {"reboiler product", 
            Arrow[{{7.5, -5.25}, {11, -5.25}}], 
            Text[
             Style["bottoms", 15], {9.2, -5.25}, {0, -1.5}], 
            $CellContext`comp$["x", {9.2, -5.5}]}, {"reflux", 
            Arrow[{{6, 3.75}, {6, 2}, {1.5, 2}}], 
            Text[
             Style["reflux", 15], {4.5, 2}, {0, -1.5}], 
            $CellContext`comp$["x", {4.5, 2.25}]}, {"reboil", 
            Arrow[{{6, -3.75}, {6, -2}, {1.5, -2}}], 
            Text[
             Style["reboil", 15], {3, -2}, {0, -1.5}], 
            $CellContext`comp$["y", {3, -225}]}}; $CellContext`streams2$ = {
           Flatten[{"feed", 
             $CellContext`comp$["z", {-3, 0.25}]}], 
           Flatten[{"condenser", 
             $CellContext`comp$["y", {2.75, 5.5}]}], 
           Flatten[{"reboiler", 
             $CellContext`comp$["x", {1.5, -5.5}]}], 
           Flatten[{"cond product", 
             $CellContext`comp$["y", {9.2, 5.5}]}], 
           Flatten[{"reboiler product", 
             $CellContext`comp$["x", {9.2, -5.5}]}], 
           Flatten[{"reflux", 
             $CellContext`comp$["x", {4.5, 2.25}]}], 
           Flatten[{"reboil", 
             $CellContext`comp$["y", {3, -225}]}]}; Column[{
           Graphics[{
             EdgeForm[Thick], 
             FaceForm[None], 
             $CellContext`unit$[{0, 0}, 2.5], 
             $CellContext`unit$[{6, 5.25}, 1], 
             $CellContext`unit$[{6, -5.25}, 1], 
             Map[If[
               FreeQ[$CellContext`s$$, 
                Part[#, 1]], 
               Button[{
                 Part[#, 3], Thick, 
                 Part[#, 2]}, 
                AppendTo[$CellContext`s$$, #]], 
               Button[{
                 Style[
                  Part[#, 3], Bold], Thick, Blue, 
                 Part[#, 2]}, $CellContext`s$$ = 
                DeleteCases[$CellContext`s$$, #]]]& , $CellContext`streams$], 
             Map[If[
               FreeQ[$CellContext`c$$, 
                Part[#, 1]], 
               Button[
                Part[#, 4], 
                AppendTo[$CellContext`c$$, 
                 Part[#, 1]]], 
               Button[
                Style[
                 Part[#, 4], Bold], $CellContext`c$$ = 
                DeleteCases[$CellContext`c$$, 
                  Part[#, 1]]]]& , $CellContext`s$$], Null}, 
            ImageSize -> {550, 400}, AspectRatio -> Full, 
            PlotRange -> {-8.5, 7.25}, 
            ImagePadding -> {{55, None}, {None, None}}, PlotLabel -> Map[If[
               FreeQ[$CellContext`c$$, 
                Part[#, 1]], 1, 0]& , $CellContext`s$$]], Null}]], 
      "Specifications" :> {{{$CellContext`species$$, 2, "species"}, {2, 3, 4},
          ControlType -> Setter}, {{$CellContext`c$$, {}}, ControlType -> 
         None}, {{$CellContext`s$$, {}}, ControlType -> None}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{601., {249., 256.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.658873999035178*^9, {3.65887417356016*^9, 3.6588741969064956`*^9}, {
   3.6588742358327217`*^9, 3.658874260258119*^9}, 3.6588743019845057`*^9, {
   3.6588744101176906`*^9, 3.6588744233284464`*^9}, {3.658874463510744*^9, 
   3.6588744903862815`*^9}, {3.658874531459631*^9, 3.6588745366869297`*^9}, 
   3.658874614438377*^9, {3.6588746521775355`*^9, 3.6588746786460495`*^9}, {
   3.658874713555046*^9, 3.658874809944559*^9}, {3.6588748435524817`*^9, 
   3.658874965979484*^9}, 3.658874998473343*^9, {3.6588750429108844`*^9, 
   3.658875062662014*^9}, 3.658875098989092*^9, 3.658875129960863*^9, {
   3.6588751907983427`*^9, 3.6588752207070537`*^9}, {3.6588752693578367`*^9, 
   3.6588752904230413`*^9}, {3.658875386329527*^9, 3.658875389603714*^9}, {
   3.658875422391589*^9, 3.658875448559086*^9}, 3.658875479117834*^9, 
   3.6588756955362124`*^9, {3.6588757811551094`*^9, 3.6588758024203253`*^9}, 
   3.6588760656093793`*^9}]
}, Open  ]]
},
WindowSize->{1366, 686},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.3 for Microsoft Windows (64-bit) (October 9, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 33372, 797, 1812, "Input"],
Cell[33955, 821, 7085, 148, 522, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
