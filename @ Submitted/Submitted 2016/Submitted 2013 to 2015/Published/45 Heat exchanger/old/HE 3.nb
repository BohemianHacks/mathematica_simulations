(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     50739,       1133]
NotebookOptionsPosition[     50372,       1116]
NotebookOutlinePosition[     50717,       1131]
CellTagsIndexPosition[     50674,       1128]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "m", ",", "dshell", ",", "dtube", ",", "Cpc", ",", "\[Mu]c", ",", "kc", 
       ",", "Cph", ",", "\[Mu]h", ",", "kh", ",", "Th1", ",", "Tc1", ",", 
       "Th2", ",", "Tc2", ",", "q", ",", "Th", ",", "Tc", ",", "shell", ",", 
       "tube", ",", "ReD", ",", "c", ",", "Pr", ",", "h", ",", "U", ",", 
       "\[CapitalDelta]T1", ",", "\[CapitalDelta]T2", ",", 
       "\[CapitalDelta]Tlm", ",", "L"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m", "=", "5"}], ";", 
      RowBox[{"(*", 
       RowBox[{"kg", "/", "s"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"dshell", "=", "0.9"}], ";", 
      RowBox[{"dtube", "=", "0.4"}], ";", 
      RowBox[{"(*", "m", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Cpc", "[", "T_", "]"}], ":=", 
       RowBox[{
        RowBox[{"2*^-7", "*", 
         SuperscriptBox["T", "3"]}], "-", 
        RowBox[{"0.0002", "*", 
         SuperscriptBox["T", "2"]}], "+", 
        RowBox[{"0.0797", "*", "T"}], "-", "5.3801"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"kJ", "/", "kg"}], "/", "K"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Mu]c", "[", "T_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "5*^-15"}], "*", 
         SuperscriptBox["T", "5"]}], "+", 
        RowBox[{"1*^-11", "*", 
         SuperscriptBox["T", "4"]}], "-", 
        RowBox[{"1*^-8", "*", 
         SuperscriptBox["T", "3"]}], "+", 
        RowBox[{"6*^-6", "*", 
         SuperscriptBox["T", "2"]}], "-", 
        RowBox[{"0.0013", "*", "T"}], "+", "0.1229"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"N", " ", 
        RowBox[{"s", "/", "m2"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kc", "[", "T_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "6*^-6"}], "*", 
         SuperscriptBox["T", "2"]}], "+", 
        RowBox[{"0.0049", "*", "T"}], "-", "0.3191"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"W", "/", "m"}], "/", "K"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"fluid", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Cph", "[", "T_", "]"}], ":=", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "6*^-9"}], "*", 
             SuperscriptBox["T", "3"]}], "+", 
            RowBox[{"1*^-5", "*", 
             SuperscriptBox["T", "2"]}], "-", 
            RowBox[{"0.0085", "*", "T"}], "+", "3.6971"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[Mu]h", "[", "T_", "]"}], ":=", 
           RowBox[{
            RowBox[{"4*^-8", "*", "T"}], "-", "1*^-6"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"kh", "[", "T_", "]"}], ":=", 
           RowBox[{
            RowBox[{"8*^-5", "*", "T"}], "-", "0.0075"}]}], ";"}], "}"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Cph", "[", "T_", "]"}], ":=", 
           RowBox[{"Cpc", "[", "T", "]"}]}], ";", 
          RowBox[{
           RowBox[{"\[Mu]h", "[", "T_", "]"}], ":=", 
           RowBox[{"\[Mu]c", "[", "T", "]"}]}], ";", 
          RowBox[{
           RowBox[{"kh", "[", "T_", "]"}], ":=", 
           RowBox[{"kc", "[", "T", "]"}]}], ";"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Th1", "=", "500"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Tc1", "=", "300"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"fluid", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Th2", "=", "Th1"}], ";", 
          RowBox[{"Tc2", "=", 
           RowBox[{"Tc1", "+", "\[CapitalDelta]Tc"}]}], ";", 
          RowBox[{"q", "=", 
           RowBox[{"m", "*", 
            RowBox[{"Cpc", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Tc1", "+", "Tc2"}], ")"}], "/", "2"}], "]"}], "*", 
            RowBox[{"(", 
             RowBox[{"Tc2", "-", "Tc1"}], ")"}]}]}], ";"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Tc2", "=", "Tc1"}], ";", 
          RowBox[{"Th2", "=", 
           RowBox[{"Th1", "-", "\[CapitalDelta]Th"}]}], ";", 
          RowBox[{"q", "=", 
           RowBox[{"m", "*", 
            RowBox[{"Cph", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Th1", "+", "Th2"}], ")"}], "/", "2"}], "]"}], "*", 
            RowBox[{"(", 
             RowBox[{"Th1", "-", "Th2"}], ")"}]}]}], ";"}], "}"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Th", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Th1", "+", "Th2"}], ")"}], "/", "2"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Tc", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Tc1", "+", "Tc2"}], ")"}], "/", "2"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"shell", "=", 
       RowBox[{"{", 
        RowBox[{"Th", ",", "dshell", ",", "Cph", ",", "\[Mu]h", ",", "kh"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tube", "=", 
       RowBox[{"{", 
        RowBox[{"Tc", ",", "dtube", ",", "Cpc", ",", "\[Mu]c", ",", "kc"}], 
        "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ReD", "[", 
        RowBox[{"T_", ",", "d_", ",", "Cp_", ",", "\[Mu]_", ",", "k_"}], 
        "]"}], ":=", 
       RowBox[{
        FractionBox["m", 
         RowBox[{
          RowBox[{"\[Pi]", "/", "4"}], "*", 
          SuperscriptBox["d", "2"]}]], "*", 
        FractionBox["d", 
         RowBox[{"\[Mu]", "[", "T", "]"}]]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c", "[", 
        RowBox[{"T_", ",", "d_", ",", "Cp_", ",", "\[Mu]_", ",", "k_"}], 
        "]"}], ":=", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ReD", "[", 
           RowBox[{"T", ",", "d", ",", "Cp", ",", "\[Mu]", ",", "k"}], "]"}], 
          "<", "4"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.989", ",", "0.33"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"4", "\[LessEqual]", 
          RowBox[{"ReD", "[", 
           RowBox[{"T", ",", "d", ",", "Cp", ",", "\[Mu]", ",", "k"}], "]"}], 
          "<", "40"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.911", ",", "0.385"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"40", "\[LessEqual]", 
          RowBox[{"ReD", "[", 
           RowBox[{"T", ",", "d", ",", "Cp", ",", "\[Mu]", ",", "k"}], "]"}], 
          "<", "4000"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.683", ",", "0.466"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"4000", "\[LessEqual]", 
          RowBox[{"ReD", "[", 
           RowBox[{"T", ",", "d", ",", "Cp", ",", "\[Mu]", ",", "k"}], "]"}], 
          "<", "40000"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.193", ",", "0.618"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"40000", "\[LessEqual]", 
          RowBox[{"ReD", "[", 
           RowBox[{"T", ",", "d", ",", "Cp", ",", "\[Mu]", ",", "k"}], "]"}], 
          "\[LessEqual]", "400000"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.027", ",", "0.805"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Pr", "[", 
        RowBox[{"T_", ",", "d_", ",", "Cp_", ",", "\[Mu]_", ",", "k_"}], 
        "]"}], ":=", 
       FractionBox[
        RowBox[{
         RowBox[{"Cp", "[", "T", "]"}], "*", 
         RowBox[{"\[Mu]", "[", "T", "]"}]}], 
        RowBox[{"k", "[", "T", "]"}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"h", "[", 
        RowBox[{"T_", ",", "d_", ",", "Cp_", ",", "\[Mu]_", ",", "k_"}], 
        "]"}], ":=", 
       RowBox[{
        FractionBox[
         RowBox[{"k", "[", "T", "]"}], "d"], "*", 
        RowBox[{"First", "@", 
         RowBox[{"c", "[", 
          RowBox[{"T", ",", "d", ",", "Cp", ",", "\[Mu]", ",", "k"}], "]"}]}],
         "*", 
        RowBox[{
         RowBox[{"ReD", "[", 
          RowBox[{"T", ",", "d", ",", "Cp", ",", "\[Mu]", ",", "k"}], "]"}], 
         "^", 
         RowBox[{"Last", "@", 
          RowBox[{"c", "[", 
           RowBox[{"T", ",", "d", ",", "Cp", ",", "\[Mu]", ",", "k"}], 
           "]"}]}]}], "*", 
        SuperscriptBox[
         RowBox[{"Pr", "[", 
          RowBox[{"T", ",", "d", ",", "Cp", ",", "\[Mu]", ",", "k"}], "]"}], 
         RowBox[{"1", "/", "3"}]]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"W", "/", "m2"}], "/", "K"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"U", "=", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"h", "@@", "shell"}]}], "+", 
          RowBox[{"1", "/", 
           RowBox[{"h", "@@", "tube"}]}]}], ")"}], 
        RowBox[{"-", "1"}]]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"W", "/", "m2"}], "/", "K"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"flow", "\[Equal]", "1"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[CapitalDelta]T1", "=", 
           RowBox[{"Th1", "-", "Tc1"}]}], ";", 
          RowBox[{"\[CapitalDelta]T2", "=", 
           RowBox[{"Th2", "-", "Tc2"}]}], ";"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[CapitalDelta]T1", "=", 
           RowBox[{"Th1", "-", "Tc2"}]}], ";", 
          RowBox[{"\[CapitalDelta]T2", "=", 
           RowBox[{"Th2", "-", "Tc1"}]}], ";"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]Tlm", "=", 
       FractionBox[
        RowBox[{"\[CapitalDelta]T2", "-", "\[CapitalDelta]T1"}], 
        RowBox[{"Log", "[", 
         RowBox[{"\[CapitalDelta]T2", "/", "\[CapitalDelta]T1"}], "]"}]]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"L", "=", 
       FractionBox["q", 
        RowBox[{
        "\[Pi]", "*", "dtube", "*", "U", "*", "\[CapitalDelta]Tlm"}]]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"heat", " ", "exchanger", " ", "length"}], ",", " ", "m"}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"RGBColor", "[", 
             RowBox[{"1", ",", "0.18", ",", "0"}], "]"}], ",", 
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{
                 RowBox[{"-", "0.5"}], "*", "dshell"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"L", ",", 
                RowBox[{"0.5", "*", "dshell"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{
                 RowBox[{"-", "0.5"}], "*", "dshell"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"0.1", "*", "L"}], ",", 
                RowBox[{
                 RowBox[{"-", "0.7"}], "*", "dshell"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"0.9", "*", "L"}], ",", 
                RowBox[{"0.5", "*", "dshell"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"L", ",", 
                RowBox[{"0.7", "*", "dshell"}]}], "}"}]}], "]"}]}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"RGBColor", "[", 
             RowBox[{"0", ",", "0.56", ",", "1"}], "]"}], ",", 
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{
                 RowBox[{"-", "0.5"}], "*", "dtube"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"L", ",", 
                RowBox[{"0.5", "*", "dtube"}]}], "}"}]}], "]"}]}], "}"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Thick", ",", 
              RowBox[{"Arrowheads", "[", 
               RowBox[{"{", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"flow", "\[Equal]", "1"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0.05", ",", "1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "0.05"}], ",", "0"}], "}"}]}], "]"}], "}"}], 
               "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"x", "+", 
                    RowBox[{"i", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"L", "-", 
                    RowBox[{"3", "*", "0.25", "*", "L"}]}], "2"], "+", 
                    RowBox[{"0.25", "*", "L"}]}], ")"}]}]}], ",", "0"}], 
                  "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "0", ",", 
                   RowBox[{"0.25", "*", "L"}], ",", "0.01"}], "}"}]}], "]"}], 
               "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "2"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Thick", ",", 
                RowBox[{"Arrowheads", "[", "0.05", "]"}], ",", 
                RowBox[{"Arrow", "[", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"i", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"L", "-", 
                    RowBox[{"4", "*", "0.2", "*", "L"}]}], "3"], "+", 
                    RowBox[{"0.2", "*", "L"}]}], ")"}]}]}], ",", 
                    RowBox[{"j", "*", "0.25", "*", 
                    RowBox[{"(", 
                    RowBox[{"dshell", "+", "dtube"}], ")"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x", ",", "0", ",", 
                    RowBox[{"0.2", "*", "L"}], ",", "0.01"}], "}"}]}], "]"}], 
                 "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"j", "\[Equal]", 
                   RowBox[{"-", "1"}]}], ",", "1", ",", "0"}], "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"j", "\[Equal]", 
                   RowBox[{"-", "1"}]}], ",", "3", ",", "2"}], "]"}]}], 
               "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Arrowheads", "[", "0.05", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"0.05", "*", "L"}], ",", 
                 RowBox[{
                  RowBox[{"-", "0.9"}], "*", "dshell"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"0.05", "*", "L"}], ",", 
                 RowBox[{
                  RowBox[{"-", "0.25"}], "*", 
                  RowBox[{"(", 
                   RowBox[{"dshell", "+", "dtube"}], ")"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"0.2", "*", "L"}], ",", 
                 RowBox[{
                  RowBox[{"-", "0.25"}], "*", 
                  RowBox[{"(", 
                   RowBox[{"dshell", "+", "dtube"}], ")"}]}]}], "}"}]}], 
              "}"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"3", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    RowBox[{"L", "-", 
                    RowBox[{"4", "*", "0.2", "*", "L"}]}], "3"], "+", 
                    RowBox[{"0.2", "*", "L"}]}], ")"}]}], ",", 
                 RowBox[{"0.25", "*", 
                  RowBox[{"(", 
                   RowBox[{"dshell", "+", "dtube"}], ")"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"0.95", "*", "L"}], ",", 
                 RowBox[{"0.25", "*", 
                  RowBox[{"(", 
                   RowBox[{"dshell", "+", "dtube"}], ")"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"0.95", "*", "L"}], ",", 
                 RowBox[{"0.9", "*", "dshell"}]}], "}"}]}], "}"}], "]"}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<q\>\"", ",", "Italic"}], "]"}], ",", 
                 "\"\< = \>\"", ",", 
                 RowBox[{
                 "U", "*", "\[Pi]", "*", "dtube", "*", "L", "*", 
                  "\[CapitalDelta]Tlm"}], ",", "\"\< W\>\""}], "}"}], "]"}], 
              ",", "17"}], "]"}], ",", 
            RowBox[{"Scaled", "[", 
             RowBox[{"{", 
              RowBox[{"0.15", ",", "0.85"}], "}"}], "]"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"500", ",", "350"}], "}"}]}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "Full"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"fluid", ",", "1", ",", "\"\<heat transfer fluid:\>\""}], 
       "}"}], ",", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"1", "\[Rule]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{
           "\"\<condensing steam (\[CapitalDelta]\[InvisibleSpace]\>\"", ",", 
            RowBox[{"Subscript", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<T\>\"", ",", "Italic"}], "]"}], ",", 
              "\"\<h\>\""}], "]"}], ",", "\"\< = 0)\>\""}], "}"}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"2", "\[Rule]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{
           "\"\<evaporating liquid (\[CapitalDelta]\[InvisibleSpace]\>\"", 
            ",", 
            RowBox[{"Subscript", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<T\>\"", ",", "Italic"}], "]"}], ",", 
              "\"\<c\>\""}], "]"}], ",", "\"\< = 0)\>\""}], "}"}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}], ",", "PopupMenu"}], "}"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"flow", ",", "1", ",", "\"\<fluid flow:\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "\[Rule]", "\"\< parallel \>\""}], ",", 
        RowBox[{"2", "\[Rule]", "\"\< counter \>\""}]}], "}"}], ",", 
      "Setter"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Spacer", "[", "1", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PaneSelector", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"1", "\[Rule]", 
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[CapitalDelta]Tc", ",", "50", ",", "\[IndentingNewLine]", 
             RowBox[{"Column", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\"\<tube temperature difference\>\"", ",", 
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{"\"\<\[CapitalDelta]\[InvisibleSpace]\>\"", ",", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<T\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<c\>\""}], "]"}], ",", "\"\< = \>\"", ",", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<T\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<c,2\>\""}], "]"}], ",", "\"\< - \>\"", ",", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<T\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<c,1\>\""}], "]"}]}], "}"}], "]"}]}], "}"}], ",", 
               "Center"}], "]"}]}], "}"}], ",", "10", ",", "100", ",", "1", 
           ",", 
           RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"2", "\[Rule]", 
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[CapitalDelta]Th", ",", "50", ",", "\[IndentingNewLine]", 
             RowBox[{"Column", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\"\<shell temperature difference\>\"", ",", 
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{"\"\<\[CapitalDelta]\[InvisibleSpace]\>\"", ",", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<T\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<h\>\""}], "]"}], ",", "\"\< = \>\"", ",", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<T\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<h,1\>\""}], "]"}], ",", "\"\< - \>\"", ",", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<T\>\"", ",", "Italic"}], "]"}], ",", 
                    "\"\<h,2\>\""}], "]"}]}], "}"}], "]"}]}], "}"}], ",", 
               "Center"}], "]"}]}], "}"}], ",", "10", ",", "100", ",", "1", 
           ",", 
           RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
         "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"Dynamic", "@", "fluid"}]}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.6549603231896544`*^9, 3.654960635306506*^9}, {
   3.654960734039153*^9, 3.654960736159274*^9}, {3.654960775053499*^9, 
   3.6549607900243554`*^9}, {3.65496131443335*^9, 3.654961407946698*^9}, {
   3.6549614478189793`*^9, 3.654961520064111*^9}, {3.65496157318215*^9, 
   3.654961606456053*^9}, {3.6549617629380026`*^9, 3.6549617729185734`*^9}, {
   3.6549623630083246`*^9, 3.6549623988603754`*^9}, {3.654962479467986*^9, 
   3.6549624987160873`*^9}, {3.654962530985933*^9, 3.6549625581564865`*^9}, {
   3.6549626522928715`*^9, 3.654962773911827*^9}, {3.6549628120140066`*^9, 
   3.6549628483390846`*^9}, {3.6549629235983887`*^9, 
   3.6549629909912434`*^9}, {3.654963044149284*^9, 3.6549631883545322`*^9}, 
   3.654963233508115*^9, {3.654963268846136*^9, 3.654963361985463*^9}, {
   3.654963397161475*^9, 3.6549634921529083`*^9}, {3.6549635248527784`*^9, 
   3.6549636208812714`*^9}, {3.6549637207199817`*^9, 
   3.6549637886228657`*^9}, {3.654963826523033*^9, 3.654964023558303*^9}, {
   3.6549640647736607`*^9, 3.654964185545568*^9}, {3.654964221263611*^9, 
   3.6549642322962418`*^9}, {3.6549642743356466`*^9, 
   3.6549644640995007`*^9}, {3.6549644955142975`*^9, 3.654964538373749*^9}, {
   3.6549645946629686`*^9, 3.6549646740155067`*^9}, {3.65496471689896*^9, 
   3.6549649500772967`*^9}, {3.6549650169261203`*^9, 3.654965325013742*^9}, {
   3.6549656047807436`*^9, 3.6549656592188573`*^9}, {3.654965691589709*^9, 
   3.6549657237905507`*^9}, {3.6549663314963093`*^9, 3.654966382278214*^9}, {
   3.654966420058375*^9, 3.65496658238966*^9}, {3.6549666124503794`*^9, 
   3.65496673887261*^9}, {3.654967012468259*^9, 3.6549670333584538`*^9}, {
   3.654967164819973*^9, 3.654967619564983*^9}, {3.6549676694918385`*^9, 
   3.6549677349185805`*^9}, {3.654967840560623*^9, 3.6549678409536457`*^9}, {
   3.6549678714773912`*^9, 3.65496804400826*^9}, {3.654968109555009*^9, 
   3.654968304905182*^9}, {3.654968336776005*^9, 3.654968586638296*^9}, {
   3.6549686702790804`*^9, 3.65496875034766*^9}, {3.6549692515833287`*^9, 
   3.6549700231074576`*^9}, {3.6549700813487887`*^9, 
   3.6549702192716775`*^9}, {3.654970250810481*^9, 3.654970282755308*^9}, {
   3.6549703130720425`*^9, 3.654970329232967*^9}, {3.654970441740402*^9, 
   3.654970461221516*^9}, {3.654970548203491*^9, 3.6549706829371977`*^9}, {
   3.6549709889657016`*^9, 3.6549711873980513`*^9}, {3.654971370152504*^9, 
   3.6549714487910023`*^9}, {3.654971480988844*^9, 3.654971813846882*^9}, {
   3.6549718606485586`*^9, 3.6549718886731615`*^9}, {3.654972448075158*^9, 
   3.654972544955699*^9}, {3.654972581475788*^9, 3.6549726062792063`*^9}, {
   3.654972653632915*^9, 3.6549728829370303`*^9}, {3.65497291543989*^9, 
   3.6549731124791594`*^9}, {3.655022895974085*^9, 3.655023090562215*^9}, {
   3.6550232418228664`*^9, 3.655023293030795*^9}, {3.655027343557472*^9, 
   3.6550273445415287`*^9}, {3.6550273895181007`*^9, 
   3.6550273913122034`*^9}, {3.6550300517783737`*^9, 
   3.6550300559166102`*^9}, {3.6550300882094574`*^9, 3.655030156232348*^9}, {
   3.655030545112591*^9, 3.655030638593938*^9}, {3.655030670795779*^9, 
   3.6550307277420363`*^9}, {3.6550307611289463`*^9, 
   3.6550308149280233`*^9}, {3.655030895031605*^9, 3.6550309048841686`*^9}, {
   3.655031125852807*^9, 3.6550312719851656`*^9}, {3.6550315488380003`*^9, 
   3.65503169027109*^9}, {3.655031733993591*^9, 3.65503175286467*^9}, {
   3.6550317837904387`*^9, 3.655031857431651*^9}, {3.655031914492915*^9, 
   3.655031947662812*^9}, {3.6550319852819633`*^9, 3.65503209344415*^9}, {
   3.655032124305915*^9, 3.655032159599934*^9}, {3.6550321916417665`*^9, 
   3.655032192941841*^9}, {3.6550322522172318`*^9, 3.655032275761578*^9}, {
   3.655032307807411*^9, 3.6550323382171507`*^9}, {3.65503257004641*^9, 
   3.6550328038087807`*^9}, {3.6550328346915474`*^9, 
   3.6550330782074757`*^9}, {3.6550331510066395`*^9, 
   3.6550332859463577`*^9}, {3.655033365141887*^9, 3.655033545809221*^9}, {
   3.655033632671189*^9, 3.6550337153339167`*^9}, {3.6550337489848413`*^9, 
   3.655033801104823*^9}, {3.655033834761748*^9, 3.655033859894185*^9}, {
   3.6550339144483056`*^9, 3.6550339401447754`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`flow$$ = 1, $CellContext`fluid$$ = 
    1, $CellContext`\[CapitalDelta]Tc$$ = 
    43, $CellContext`\[CapitalDelta]Th$$ = 50, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`fluid$$], 1, "heat transfer fluid:"}, {
      1 -> Row[{"condensing steam (\[CapitalDelta]\[InvisibleSpace]", 
          Subscript[
           Style["T", Italic], "h"], " = 0)"}], 2 -> 
       Row[{"evaporating liquid (\[CapitalDelta]\[InvisibleSpace]", 
          Subscript[
           Style["T", Italic], "c"], " = 0)"}]}}, {{
       Hold[$CellContext`flow$$], 1, "fluid flow:"}, {
      1 -> " parallel ", 2 -> " counter "}}, {
      Hold[
       Spacer[1]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`\[CapitalDelta]Tc$$], 50, 
       Column[{"tube temperature difference", 
         Row[{"\[CapitalDelta]\[InvisibleSpace]", 
           Subscript[
            Style["T", Italic], "c"], " = ", 
           Subscript[
            Style["T", Italic], "c,2"], " - ", 
           Subscript[
            Style["T", Italic], "c,1"]}]}, Center]}, 10, 100, 1}, {{
       Hold[$CellContext`\[CapitalDelta]Th$$], 50, 
       Column[{"shell temperature difference", 
         Row[{"\[CapitalDelta]\[InvisibleSpace]", 
           Subscript[
            Style["T", Italic], "h"], " = ", 
           Subscript[
            Style["T", Italic], "h,1"], " - ", 
           Subscript[
            Style["T", Italic], "h,2"]}]}, Center]}, 10, 100, 1}, {
      Hold[
       PaneSelector[{1 -> Manipulate`Place[1], 2 -> Manipulate`Place[2]}, 
        Dynamic[$CellContext`fluid$$]]], Manipulate`Dump`ThisIsNotAControl}}, 
    Typeset`size$$ = {500., {173., 177.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`fluid$198288$$ = False, $CellContext`flow$198289$$ = 
    False, $CellContext`\[CapitalDelta]Tc$198290$$ = 
    0, $CellContext`\[CapitalDelta]Th$198291$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`flow$$ = 1, $CellContext`fluid$$ = 
        1, $CellContext`\[CapitalDelta]Tc$$ = 
        50, $CellContext`\[CapitalDelta]Th$$ = 50}, "ControllerVariables" :> {
        Hold[$CellContext`fluid$$, $CellContext`fluid$198288$$, False], 
        Hold[$CellContext`flow$$, $CellContext`flow$198289$$, False], 
        Hold[$CellContext`\[CapitalDelta]Tc$$, \
$CellContext`\[CapitalDelta]Tc$198290$$, 0], 
        Hold[$CellContext`\[CapitalDelta]Th$$, \
$CellContext`\[CapitalDelta]Th$198291$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`m$, $CellContext`dshell$, $CellContext`dtube$, \
$CellContext`Cpc$, $CellContext`\[Mu]c$, $CellContext`kc$, $CellContext`Cph$, \
$CellContext`\[Mu]h$, $CellContext`kh$, $CellContext`Th1$, $CellContext`Tc1$, \
$CellContext`Th2$, $CellContext`Tc2$, $CellContext`q$, $CellContext`Th$, \
$CellContext`Tc$, $CellContext`shell$, $CellContext`tube$, $CellContext`ReD$, \
$CellContext`c$, $CellContext`Pr$, $CellContext`h$, $CellContext`U$, \
$CellContext`\[CapitalDelta]T1$, $CellContext`\[CapitalDelta]T2$, \
$CellContext`\[CapitalDelta]Tlm$, $CellContext`L$}, $CellContext`m$ = 
         5; $CellContext`dshell$ = 0.9; $CellContext`dtube$ = 
         0.4; $CellContext`Cpc$[
           Pattern[$CellContext`T, 
            Blank[]]] := 
         Rational[1, 5000000] $CellContext`T^3 - 0.0002 $CellContext`T^2 + 
          0.0797 $CellContext`T - 5.3801; $CellContext`\[Mu]c$[
           Pattern[$CellContext`T, 
            Blank[]]] := (-Rational[1, 200000000000000]) $CellContext`T^5 + 
          Rational[1, 100000000000] $CellContext`T^4 - 
          Rational[1, 100000000] $CellContext`T^3 + 
          Rational[3, 500000] $CellContext`T^2 - 0.0013 $CellContext`T + 
          0.1229; $CellContext`kc$[
           Pattern[$CellContext`T, 
            Blank[]]] := (-Rational[3, 500000]) $CellContext`T^2 + 
          0.0049 $CellContext`T - 0.3191; 
        If[$CellContext`fluid$$ == 1, {$CellContext`Cph$[
              Pattern[$CellContext`T, 
               Blank[]]] := (-Rational[3, 500000000]) $CellContext`T^3 + 
             Rational[1, 100000] $CellContext`T^2 - 0.0085 $CellContext`T + 
             3.6971; $CellContext`\[Mu]h$[
              Pattern[$CellContext`T, 
               Blank[]]] := 
            Rational[1, 25000000] $CellContext`T - Rational[
             1, 1000000]; $CellContext`kh$[
              Pattern[$CellContext`T, 
               Blank[]]] := Rational[1, 12500] $CellContext`T - 0.0075; 
           Null}, {$CellContext`Cph$[
              Pattern[$CellContext`T$, 
               
               Blank[]]] := $CellContext`Cpc$[$CellContext`T$]; $CellContext`\
\[Mu]h$[
              Pattern[$CellContext`T$, 
               
               Blank[]]] := $CellContext`\[Mu]c$[$CellContext`T$]; \
$CellContext`kh$[
              Pattern[$CellContext`T$, 
               Blank[]]] := $CellContext`kc$[$CellContext`T$]; 
           Null}]; $CellContext`Th1$ = 500; $CellContext`Tc1$ = 300; 
        If[$CellContext`fluid$$ == 
          1, {$CellContext`Th2$ = $CellContext`Th1$; $CellContext`Tc2$ = \
$CellContext`Tc1$ + $CellContext`\[CapitalDelta]Tc$$; $CellContext`q$ = \
$CellContext`m$ $CellContext`Cpc$[($CellContext`Tc1$ + $CellContext`Tc2$)/
               2] ($CellContext`Tc2$ - $CellContext`Tc1$); 
           Null}, {$CellContext`Tc2$ = $CellContext`Tc1$; $CellContext`Th2$ = \
$CellContext`Th1$ - $CellContext`\[CapitalDelta]Th$$; $CellContext`q$ = \
$CellContext`m$ $CellContext`Cph$[($CellContext`Th1$ + $CellContext`Th2$)/
               2] ($CellContext`Th1$ - $CellContext`Th2$); 
           Null}]; $CellContext`Th$ = ($CellContext`Th1$ + $CellContext`Th2$)/
          2; $CellContext`Tc$ = ($CellContext`Tc1$ + $CellContext`Tc2$)/
          2; $CellContext`shell$ = {$CellContext`Th$, $CellContext`dshell$, \
$CellContext`Cph$, $CellContext`\[Mu]h$, $CellContext`kh$}; \
$CellContext`tube$ = {$CellContext`Tc$, $CellContext`dtube$, \
$CellContext`Cpc$, $CellContext`\[Mu]c$, $CellContext`kc$}; $CellContext`ReD$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`d$, 
            Blank[]], 
           Pattern[$CellContext`Cp$, 
            Blank[]], 
           Pattern[$CellContext`\[Mu]$, 
            Blank[]], 
           Pattern[$CellContext`k$, 
            Blank[]]] := ($CellContext`m$/((Pi/
            4) $CellContext`d$^2)) \
($CellContext`d$/$CellContext`\[Mu]$[$CellContext`T$]); $CellContext`c$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`d$, 
            Blank[]], 
           Pattern[$CellContext`Cp$, 
            Blank[]], 
           Pattern[$CellContext`\[Mu]$, 
            Blank[]], 
           Pattern[$CellContext`k$, 
            Blank[]]] := 
         Which[$CellContext`ReD$[$CellContext`T$, $CellContext`d$, \
$CellContext`Cp$, $CellContext`\[Mu]$, $CellContext`k$] < 4, {0.989, 0.33}, 
           Inequality[4, LessEqual, 
            $CellContext`ReD$[$CellContext`T$, $CellContext`d$, \
$CellContext`Cp$, $CellContext`\[Mu]$, $CellContext`k$], Less, 40], {0.911, 
           0.385}, 
           Inequality[40, LessEqual, 
            $CellContext`ReD$[$CellContext`T$, $CellContext`d$, \
$CellContext`Cp$, $CellContext`\[Mu]$, $CellContext`k$], Less, 4000], {0.683, 
           0.466}, 
           Inequality[4000, LessEqual, 
            $CellContext`ReD$[$CellContext`T$, $CellContext`d$, \
$CellContext`Cp$, $CellContext`\[Mu]$, $CellContext`k$], Less, 40000], {0.193,
            0.618}, 
           40000 <= $CellContext`ReD$[$CellContext`T$, $CellContext`d$, \
$CellContext`Cp$, $CellContext`\[Mu]$, $CellContext`k$] <= 400000, {0.027, 
           0.805}]; $CellContext`Pr$[
           Pattern[$CellContext`T, 
            Blank[]], 
           Pattern[$CellContext`d, 
            Blank[]], 
           Pattern[$CellContext`Cp, 
            Blank[]], 
           Pattern[$CellContext`\[Mu], 
            Blank[]], 
           Pattern[$CellContext`k, 
            
            Blank[]]] := $CellContext`Cp[$CellContext`T] \
$CellContext`\[Mu][$CellContext`T]/$CellContext`k[$CellContext`T]; \
$CellContext`h$[
           Pattern[$CellContext`T$, 
            Blank[]], 
           Pattern[$CellContext`d$, 
            Blank[]], 
           Pattern[$CellContext`Cp$, 
            Blank[]], 
           Pattern[$CellContext`\[Mu]$, 
            Blank[]], 
           Pattern[$CellContext`k$, 
            Blank[]]] := ($CellContext`k$[$CellContext`T$]/$CellContext`d$) 
          First[
            $CellContext`c$[$CellContext`T$, $CellContext`d$, \
$CellContext`Cp$, $CellContext`\[Mu]$, $CellContext`k$]] \
$CellContext`ReD$[$CellContext`T$, $CellContext`d$, $CellContext`Cp$, \
$CellContext`\[Mu]$, $CellContext`k$]^Last[
             $CellContext`c$[$CellContext`T$, $CellContext`d$, \
$CellContext`Cp$, $CellContext`\[Mu]$, $CellContext`k$]] \
$CellContext`Pr$[$CellContext`T$, $CellContext`d$, $CellContext`Cp$, \
$CellContext`\[Mu]$, $CellContext`k$]^(1/3); $CellContext`U$ = (
           1/Apply[$CellContext`h$, $CellContext`shell$] + 
           1/Apply[$CellContext`h$, $CellContext`tube$])^(-1); 
        If[$CellContext`flow$$ == 
          1, {$CellContext`\[CapitalDelta]T1$ = $CellContext`Th1$ - \
$CellContext`Tc1$; $CellContext`\[CapitalDelta]T2$ = $CellContext`Th2$ - \
$CellContext`Tc2$; 
           Null}, {$CellContext`\[CapitalDelta]T1$ = $CellContext`Th1$ - \
$CellContext`Tc2$; $CellContext`\[CapitalDelta]T2$ = $CellContext`Th2$ - \
$CellContext`Tc1$; 
           Null}]; $CellContext`\[CapitalDelta]Tlm$ = ($CellContext`\
\[CapitalDelta]T2$ - $CellContext`\[CapitalDelta]T1$)/
          Log[$CellContext`\[CapitalDelta]T2$/$CellContext`\[CapitalDelta]T1$]\
; $CellContext`L$ = $CellContext`q$/(
          Pi $CellContext`dtube$ $CellContext`U$ \
$CellContext`\[CapitalDelta]Tlm$); Graphics[{{
            RGBColor[1, 0.18, 0], 
            
            Rectangle[{
             0, (-0.5) $CellContext`dshell$}, {$CellContext`L$, 
              0.5 $CellContext`dshell$}], 
            
            Rectangle[{0, (-0.5) $CellContext`dshell$}, {
             0.1 $CellContext`L$, (-0.7) $CellContext`dshell$}], 
            
            Rectangle[{
             0.9 $CellContext`L$, 0.5 $CellContext`dshell$}, {$CellContext`L$,
               0.7 $CellContext`dshell$}]}, {
            RGBColor[0, 0.56, 1], 
            
            Rectangle[{
             0, (-0.5) $CellContext`dtube$}, {$CellContext`L$, 
              0.5 $CellContext`dtube$}]}, 
           Table[{Thick, 
             Arrowheads[{
               If[$CellContext`flow$$ == 1, {0.05, 1}, {-0.05, 0}]}], 
             Arrow[
              
              Table[{$CellContext`x + $CellContext`i (($CellContext`L$ - 3 
                    0.25 $CellContext`L$)/2 + 0.25 $CellContext`L$), 
                0}, {$CellContext`x, 0, 0.25 $CellContext`L$, 
                0.01}]]}, {$CellContext`i, 0, 2}], 
           Table[
            Table[{Thick, 
              Arrowheads[0.05], 
              Arrow[
               
               Table[{$CellContext`x + $CellContext`i (($CellContext`L$ - 4 
                    0.2 $CellContext`L$)/3 + 
                   0.2 $CellContext`L$), $CellContext`j 
                 0.25 ($CellContext`dshell$ + $CellContext`dtube$)}, \
{$CellContext`x, 0, 0.2 $CellContext`L$, 0.01}]]}, {$CellContext`i, 
              If[$CellContext`j == -1, 1, 0], 
              If[$CellContext`j == -1, 3, 2]}], {$CellContext`j, {-1, 1}}], {
           Thick, 
            Arrowheads[0.05], 
            
            Arrow[{{0.05 $CellContext`L$, (-0.9) $CellContext`dshell$}, {
              0.05 $CellContext`L$, (-0.25) ($CellContext`dshell$ + \
$CellContext`dtube$)}, {
              
              0.2 $CellContext`L$, (-0.25) ($CellContext`dshell$ + \
$CellContext`dtube$)}}], 
            
            Arrow[{{3 (($CellContext`L$ - 4 0.2 $CellContext`L$)/3 + 
                0.2 $CellContext`L$), 
               0.25 ($CellContext`dshell$ + $CellContext`dtube$)}, {
              0.95 $CellContext`L$, 
               0.25 ($CellContext`dshell$ + $CellContext`dtube$)}, {
              0.95 $CellContext`L$, 0.9 $CellContext`dshell$}}]}, 
           Text[
            Style[
             Row[{
               Style["q", Italic], " = ", $CellContext`U$ 
               Pi $CellContext`dtube$ $CellContext`L$ $CellContext`\
\[CapitalDelta]Tlm$, " W"}], 17], 
            Scaled[{0.15, 0.85}]]}, Frame -> True, ImageSize -> {500, 350}, 
          AspectRatio -> Full]], 
      "Specifications" :> {{{$CellContext`fluid$$, 1, 
          "heat transfer fluid:"}, {
         1 -> Row[{"condensing steam (\[CapitalDelta]\[InvisibleSpace]", 
             Subscript[
              Style["T", Italic], "h"], " = 0)"}], 2 -> 
          Row[{"evaporating liquid (\[CapitalDelta]\[InvisibleSpace]", 
             Subscript[
              Style["T", Italic], "c"], " = 0)"}]}, ControlType -> 
         PopupMenu}, {{$CellContext`flow$$, 1, "fluid flow:"}, {
         1 -> " parallel ", 2 -> " counter "}, ControlType -> Setter}, 
        Spacer[1], {{$CellContext`\[CapitalDelta]Tc$$, 50, 
          Column[{"tube temperature difference", 
            Row[{"\[CapitalDelta]\[InvisibleSpace]", 
              Subscript[
               Style["T", Italic], "c"], " = ", 
              Subscript[
               Style["T", Italic], "c,2"], " - ", 
              Subscript[
               Style["T", Italic], "c,1"]}]}, Center]}, 10, 100, 1, 
         Appearance -> "Labeled", ControlPlacement -> 
         1}, {{$CellContext`\[CapitalDelta]Th$$, 50, 
          Column[{"shell temperature difference", 
            Row[{"\[CapitalDelta]\[InvisibleSpace]", 
              Subscript[
               Style["T", Italic], "h"], " = ", 
              Subscript[
               Style["T", Italic], "h,1"], " - ", 
              Subscript[
               Style["T", Italic], "h,2"]}]}, Center]}, 10, 100, 1, 
         Appearance -> "Labeled", ControlPlacement -> 2}, 
        PaneSelector[{1 -> Manipulate`Place[1], 2 -> Manipulate`Place[2]}, 
         Dynamic[$CellContext`fluid$$]]}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{551., {251., 258.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.6549606386366963`*^9, 3.654961352801544*^9, {3.6549613842413425`*^9, 
   3.6549614083327208`*^9}, {3.654961594588374*^9, 3.6549616068490753`*^9}, 
   3.654962788980689*^9, 3.654962994437441*^9, 3.6549631904116497`*^9, 
   3.654963493827004*^9, {3.6549635283709803`*^9, 3.6549636020191927`*^9}, {
   3.6549637518187604`*^9, 3.654963779348335*^9}, 3.6549641043249226`*^9, {
   3.6549641747829523`*^9, 3.654964186089599*^9}, {3.6549642248528166`*^9, 
   3.6549642361014595`*^9}, 3.654964474041069*^9, 3.654964539034786*^9, 
   3.6549646756506004`*^9, {3.6549647341249447`*^9, 3.6549647958994784`*^9}, {
   3.654964850759616*^9, 3.654964864516403*^9}, 3.6549649520444093`*^9, {
   3.654965020447322*^9, 3.654965036103217*^9}, {3.6549651554290423`*^9, 
   3.65496517899839*^9}, 3.6549653272758713`*^9, {3.654965608458954*^9, 
   3.6549656608849525`*^9}, 3.6549657246966023`*^9, {3.654966354259611*^9, 
   3.6549663830852604`*^9}, 3.6549673097812643`*^9, 3.6549674116470904`*^9, {
   3.6549675878771706`*^9, 3.6549676104394608`*^9}, 3.654967738038759*^9, {
   3.6549682478999214`*^9, 3.654968305722229*^9}, 3.6549683828966427`*^9, {
   3.654968537362478*^9, 3.6549685496631813`*^9}, 3.6549685879113693`*^9, {
   3.6549686733272543`*^9, 3.6549687014618635`*^9}, {3.6549687417791696`*^9, 
   3.654968750962695*^9}, {3.654969358131423*^9, 3.6549694914170465`*^9}, {
   3.654969628778903*^9, 3.654969725287423*^9}, 3.6549697691299305`*^9, {
   3.654969818539757*^9, 3.654969876022045*^9}, 3.6549699223736963`*^9, {
   3.654969956430644*^9, 3.6549700023602705`*^9}, 3.6549700967976723`*^9, {
   3.6549701477885885`*^9, 3.654970168110751*^9}, {3.65497021546946*^9, 
   3.654970220107725*^9}, 3.6549702516115274`*^9, {3.6549703145381265`*^9, 
   3.6549703294679804`*^9}, {3.6549706060518*^9, 3.654970630288186*^9}, {
   3.654970662576033*^9, 3.654970675798789*^9}, {3.654971001024391*^9, 
   3.654971008438815*^9}, 3.6549711241744347`*^9, {3.654971165276786*^9, 
   3.654971187693068*^9}, {3.654971383068243*^9, 3.6549714494760413`*^9}, {
   3.6549715224032125`*^9, 3.654971549028735*^9}, {3.65497158774895*^9, 
   3.654971602354785*^9}, {3.654971704314617*^9, 3.6549717855552635`*^9}, {
   3.6549718638047395`*^9, 3.6549718890291824`*^9}, {3.6549724850802746`*^9, 
   3.654972548886924*^9}, 3.6549726165197926`*^9, 3.6549728401695843`*^9, {
   3.654973083301491*^9, 3.6549731374835896`*^9}, 3.6550230589094048`*^9, 
   3.6550230914152637`*^9, 3.6550232561376853`*^9, 3.6550232953969307`*^9, 
   3.6550273480747304`*^9, 3.6550273918732357`*^9, 3.6550300596178217`*^9, {
   3.655030150946046*^9, 3.6550301567053747`*^9}, 3.6550308784266553`*^9, 
   3.655030932520749*^9, 3.655031237832212*^9, 3.6550312752873545`*^9, {
   3.65503155039909*^9, 3.6550315798727756`*^9}, 3.6550316350179296`*^9, 
   3.6550316936912856`*^9, 3.6550318620739164`*^9, 3.655031916721042*^9, 
   3.655032095906291*^9, {3.6550321278231163`*^9, 3.6550321639071803`*^9}, 
   3.655032204019475*^9, 3.6550322531612854`*^9, {3.6550325850362673`*^9, 
   3.6550326124888377`*^9}, {3.655032683801917*^9, 3.655032690223284*^9}, 
   3.6550327261513386`*^9, {3.655032848437333*^9, 3.6550328642792397`*^9}, {
   3.6550329880303173`*^9, 3.655033078777508*^9}, {3.6550331885137844`*^9, 
   3.655033202306574*^9}, {3.655033275245745*^9, 3.655033286185371*^9}, 
   3.655033718762113*^9, {3.6550337881490817`*^9, 3.655033801876867*^9}, 
   3.655033861736291*^9, {3.6550339199626207`*^9, 3.655033940457793*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Text", "@", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"Row", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Grid", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\"\<\>\"", ",", "\"\<shell (hot)\>\"", ",", 
             "\"\<tube (cold)\>\""}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SubscriptBox[\(T\), \(avg\)]\) =\>\"", ",", "Th", ",", 
             "Tc", ",", "\"\<K\>\""}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\"\<\!\(\*SubscriptBox[\(Re\), \(D\)]\) =\>\"", ",", 
             RowBox[{"ReD", "@@", "shell"}], ",", 
             RowBox[{"ReD", "@@", "tube"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\"\<Pr =\>\"", ",", 
             RowBox[{"Pr", "@@", "shell"}], ",", 
             RowBox[{"Pr", "@@", "tube"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\"\<h =\>\"", ",", 
             RowBox[{"h", "@@", "shell"}], ",", 
             RowBox[{"h", "@@", "tube"}], ",", 
             "\"\<W/\!\(\*SuperscriptBox[\(m\), \(2\)]\)/K\>\""}], "}"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SubscriptBox[\(\[CapitalDelta]T\), \(1\)]\) =\>\"", 
             ",", "\[CapitalDelta]T1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SubscriptBox[\(\[CapitalDelta]T\), \(2\)]\) =\>\"", 
             ",", "\[CapitalDelta]T2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<U =\>\"", ",", "U", ",", 
             "\"\<W/\!\(\*SuperscriptBox[\(m\), \(2\)]\)/K\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<L =\>\"", ",", "L", ",", "\"\<m\>\""}], "}"}]}], 
          "\[IndentingNewLine]", "}"}], "]"}], ",", 
        RowBox[{"Spacer", "[", "35", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Grid", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SubscriptBox[\(T\), \(h, 1\)]\) =\>\"", ",", "Th1"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SubscriptBox[\(T\), \(h, 2\)]\) =\>\"", ",", "Th2"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SubscriptBox[\(T\), \(c, 1\)]\) =\>\"", ",", "Tc1"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SubscriptBox[\(T\), \(c, 2\)]\) =\>\"", ",", "Tc2"}], 
            "}"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",",
      "16"}], "]"}]}], "*)"}]], "Input"]
},
WindowSize->{1366, 686},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.3 for Microsoft Windows (64-bit) (October 9, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 28261, 655, 1697, "Input"],
Cell[28844, 679, 18579, 361, 526, "Output"]
}, Open  ]],
Cell[47438, 1043, 2930, 71, 245, "Input"]
}
]
*)

(* End of internal cache information *)
