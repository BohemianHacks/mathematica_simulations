(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     46717,       1053]
NotebookOptionsPosition[     46242,       1033]
NotebookOutlinePosition[     46581,       1048]
CellTagsIndexPosition[     46538,       1045]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "optimalvolume", ",", "conversion", ",", "profit", ",", "profitplot", 
       ",", "reactor", ",", "k", ",", "Fro", ",", "Fao", ",", "Ca", ",", "Cr",
        ",", "s", ",", "p1", ",", "tao", ",", "concA", ",", "concR", ",", 
       "concplot"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"k", "=", "0.1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Fao", "=", 
       RowBox[{"cao", "*", "vo"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Fro", "=", 
       RowBox[{"cro", "*", "vo"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ca", "=", 
       RowBox[{
        RowBox[{"Fa", "[", "z", "]"}], "/", "vo"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Cr", "=", 
       RowBox[{
        RowBox[{"Fr", "[", "z", "]"}], "/", "vo"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tao", "=", 
       RowBox[{"vr", "/", "vo"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"s", "=", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ag", "\[Equal]", "1"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Fa", "'"}], "[", "z", "]"}], "\[Equal]", 
              RowBox[{
               RowBox[{"-", "k"}], "*", "Ca"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Fa", "'"}], "[", "z", "]"}], "\[Equal]", 
              RowBox[{
               RowBox[{"-", "k"}], "*", "Ca", "*", "Cr"}]}]}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ag", "\[Equal]", "1"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Fr", "'"}], "[", "z", "]"}], "\[Equal]", 
              RowBox[{"k", "*", "Ca"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Fr", "'"}], "[", "z", "]"}], "\[Equal]", 
              RowBox[{"k", "*", "Ca", "*", "Cr"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"Fa", "[", "0", "]"}], "==", "Fao"}], ",", 
           RowBox[{
            RowBox[{"Fr", "[", "0", "]"}], "\[Equal]", "Fro"}]}], "}"}], ",", 
         
         RowBox[{"{", 
          RowBox[{"Fa", ",", "Fr"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"z", ",", "0", ",", "1000"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"conversion", "[", "z_", "]"}], "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"cs", "\[Equal]", "2"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Fao", "-", 
            RowBox[{
             RowBox[{"Evaluate", "[", 
              RowBox[{
               RowBox[{"Fa", "[", "z", "]"}], "/.", "s"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "Fao"}], ",", 
         RowBox[{
          RowBox[{"ag", "\[Equal]", "1"}], "&&", 
          RowBox[{"cs", "\[Equal]", "1"}]}], ",", " ", 
         RowBox[{"k", "*", 
          RowBox[{"z", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"k", "*", "z"}], "+", "vo"}], ")"}]}]}], ",", 
         RowBox[{
          RowBox[{"ag", "\[Equal]", "2"}], "&&", 
          RowBox[{"cs", "\[Equal]", "1"}]}], ",", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{"vo", "/", 
            RowBox[{"(", 
             RowBox[{"z", "*", "k", "*", "cao"}], ")"}]}], ")"}]}]}], "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"profit", "[", 
        RowBox[{"z_", ",", "pp_", ",", "pr_", ",", "reactorprice_"}], "]"}], 
       "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"cs", "\[Equal]", "2"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{"Fr", "[", "z", "]"}], "/.", "s"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "*", "pp"}], "-", 
          RowBox[{"Fro", "*", "pp"}], "-", 
          RowBox[{"Fao", "*", "pr"}], "-", 
          RowBox[{"reactorprice", "*", "z"}]}], ",", 
         RowBox[{
          RowBox[{"pp", "*", 
           RowBox[{"conversion", "[", "z", "]"}], "*", "Fao"}], "-", 
          RowBox[{"Fro", "*", "pp"}], "-", 
          RowBox[{"Fao", "*", "pr"}], "-", 
          RowBox[{"reactorprice", "*", "z"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"optimalvolume", "=", 
       RowBox[{"z", "/.", 
        RowBox[{"Quiet", "@", 
         RowBox[{"FindRoot", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"cs", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{"Fr", "[", "z", "]"}], "/.", "s"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "*", "pp"}], "-", 
                 RowBox[{"Fro", "*", "pp"}], "-", 
                 RowBox[{"Fao", "*", "pr"}], "-", 
                 RowBox[{"reactorprice", "*", "z"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"pp", "*", 
                  RowBox[{"conversion", "[", "z", "]"}], "*", "Fao"}], "-", 
                 RowBox[{"Fro", "*", "pp"}], "-", 
                 RowBox[{"Fao", "*", "pr"}], "-", 
                 RowBox[{"reactorprice", "*", "z"}]}]}], "]"}], ",", 
              "\[IndentingNewLine]", "z"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"{", 
            RowBox[{"z", ",", "1"}], "}"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"op", ",", 
        RowBox[{"vr", "=", "optimalvolume"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"concA", "[", "z_", "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"cs", "\[Equal]", "2"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{"Fa", "[", "z", "]"}], "/.", "s"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/", "vo"}], ",", 
         RowBox[{"cao", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"conversion", "[", "z", "]"}]}], ")"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"concR", "[", "z_", "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"cs", "\[Equal]", "2"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{"Fr", "[", "z", "]"}], "/.", "s"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/", "vo"}], ",", 
         RowBox[{"cro", "+", 
          RowBox[{"cao", "*", 
           RowBox[{"conversion", "[", "z", "]"}]}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"concplot", "=", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"concA", "[", "z", "]"}], ",", 
            RowBox[{"concR", "[", "z", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", "0", ",", 
            RowBox[{"tao", "*", "vo"}]}], "}"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", "14"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "10"}], "}"}]}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<reactor volume(L)\>\"", ",", "\"\<concentration (M)\>\""}], 
            "}"}]}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"profitplot", "=", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"profit", "[", 
            RowBox[{"z", ",", "pp", ",", "pr", ",", "reactorprice"}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"z", ",", "0", ",", "1000"}], "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1000"}], ",", 
              RowBox[{
               RowBox[{"profit", "[", 
                RowBox[{
                "optimalvolume", ",", "pp", ",", "pr", ",", "reactorprice"}], 
                "]"}], "+", "100"}]}], "}"}]}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<reactor volume (L)\>\"", ",", 
              "\"\<profit (dollars/min)\>\""}], "}"}]}], ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", "14"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
           RowBox[{"PlotRangePadding", "\[Rule]", "None"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
             RowBox[{"Point", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{"op", ",", "optimalvolume", ",", "vr"}], "]"}], ",", 
                
                RowBox[{"If", "[", 
                 RowBox[{"op", ",", 
                  RowBox[{"profit", "[", 
                   RowBox[{
                   "optimalvolume", ",", "pp", ",", "pr", ",", 
                    "reactorprice"}], "]"}], ",", 
                  RowBox[{"profit", "[", 
                   RowBox[{"vr", ",", "pp", ",", "pr", ",", "reactorprice"}], 
                   "]"}]}], "]"}]}], "}"}], "]"}]}], "}"}], 
           "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"reactor", "=", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Black", ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0.5", ",", "1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0.75", ",", "1"}], "}"}]}], "}"}], "]"}]}], "}"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"Thick", ",", " ", "Black", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"cs", "==", "1"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0.75", ",", "1.2"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0.75", ",", "0.6"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1.25", ",", "0.6"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1.25", ",", "1.2"}], "}"}]}], "}"}], "]"}], ",", 
                
                RowBox[{"Circle", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0.75", ",", "1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0.1", ",", "0.15"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"3", 
                    RowBox[{"Pi", "/", "2"}]}], ",", 
                    RowBox[{"Pi", "/", "2"}]}], "}"}]}], "]"}]}], "]"}]}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"Thick", ",", " ", "Black", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"cs", "\[Equal]", "1"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"1.2", ",", "1.3"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "0.8"}], "}"}]}], "}"}], "]"}], ",", 
                RowBox[{"Circle", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1.25", ",", "1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0.1", ",", "0.15"}], "}"}]}], "]"}]}], "]"}]}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"Thick", ",", " ", "Black", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"cs", "\[Equal]", "1"}], ",", 
                RowBox[{"BezierCurve", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0.8", ",", "0.8"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0.9", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1.1", ",", "0.6"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1.2", ",", "0.8"}], "}"}]}], "}"}], "]"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0.75", ",", "1.15"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1.25", ",", "1.15"}], "}"}]}], "}"}], "]"}]}], 
               "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"Thick", ",", " ", "Black", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"cs", "\[Equal]", "1"}], ",", 
                RowBox[{"BezierCurve", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0.8", ",", "0.8"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0.9", ",", "0.6"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1.1", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1.2", ",", "0.8"}], "}"}]}], "}"}], "]"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0.75", ",", "0.85"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1.25", ",", "0.85"}], "}"}]}], "}"}], "]"}]}], 
               "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"Thick", ",", " ", "Black", ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1.25", ",", "1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1.5", ",", "1"}], "}"}]}], "}"}], "]"}]}], "}"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ag", "\[Equal]", "1"}], ",", 
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Row", "[", 
                    RowBox[{"{", "\"\<A \[ShortRightArrow] R\>\"", "}"}], 
                    "]"}], ",", "16"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1.6"}], "}"}]}], "]"}], ",", 
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"Row", "[", 
                    RowBox[{
                    "{", "\"\<A + R \[ShortRightArrow] 2 R\>\"", "}"}], "]"}],
                    ",", "16"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1.6"}], "}"}]}], "]"}]}], "]"}], "}"}]}],
            "\[IndentingNewLine]", "}"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Switch", "[", 
              RowBox[{"gt", ",", "\[IndentingNewLine]", "1", ",", 
               RowBox[{"Show", "[", "profitplot", "]"}], ",", 
               "\[IndentingNewLine]", "2", ",", 
               RowBox[{"Show", "[", "concplot", "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Show", "[", "reactor", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Graphics", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Text", "[", 
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<profit = \>\"", ",", " ", 
                    RowBox[{"If", "[", 
                    RowBox[{"op", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"profit", "[", 
                    RowBox[{
                    "optimalvolume", ",", "pp", ",", "pr", ",", 
                    "reactorprice"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "2"}], "}"}]}], "]"}], ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"profit", "[", 
                    RowBox[{"vr", ",", "pp", ",", "pr", ",", "reactorprice"}],
                     "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "2"}], "}"}]}], "]"}]}], "]"}], ",", 
                    "\"\< dollars/min\>\"", ",", 
                    RowBox[{"Spacer", "[", "20", "]"}], ",", 
                    "\"\<conversion = \>\"", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{"op", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"conversion", "[", "optimalvolume", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}]}], "]"}], ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"conversion", "[", "vr", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], "}"}],
                    "]"}], ",", "19"}], "]"}], "]"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "0.4"}], ",", "0.4"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "0.04"}], ",", "0.04"}], "}"}]}], "}"}]}], 
              ",", " ", 
              RowBox[{"ImageSize", "\[Rule]", "450"}]}], "]"}], "}"}]}], 
          "}"}], ",", 
         RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"Switch", "[", 
            RowBox[{
            "gt", ",", "1", ",", "profitplot", ",", "2", ",", "concplot"}], 
            "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Text", "@", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{"\"\< profit = \>\"", ",", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{
                  RowBox[{"profit", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"op", ",", "optimalvolume", ",", "vr"}], "]"}], 
                    ",", "pp", ",", "pr", ",", "reactorprice"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"4", ",", "2"}], "}"}]}], "]"}], ",", 
                "\"\<$/min\>\"", ",", 
                RowBox[{"Spacer", "[", "25", "]"}], ",", 
                "\"\<conversion = \>\"", ",", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{
                  RowBox[{"conversion", "[", 
                   RowBox[{"If", "[", 
                    RowBox[{"op", ",", "optimalvolume", ",", "vr"}], "]"}], 
                   "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "}"}], "]"}], 
             ",", "18"}], "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
        "Center"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Column", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Control", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"gt", ",", "1", ",", "\"\<plot type: \>\""}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "\[Rule]", 
            RowBox[{"Style", "[", 
             RowBox[{"\"\<profit\>\"", ",", "Italic"}], "]"}]}], ",", 
           RowBox[{"2", "\[Rule]", 
            RowBox[{"Style", "[", 
             RowBox[{"\"\<concentrations\>\"", ",", "Italic"}], "]"}]}]}], 
          "}"}], ",", "Setter"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Row", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"cs", ",", "1", ",", "\"\<reactor type:\>\""}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "\[Rule]", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<CSTR\>\"", ",", "Italic"}], "]"}]}], ",", 
              RowBox[{"2", "\[Rule]", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<PFR\>\"", ",", "Italic"}], "]"}]}]}], "}"}], ",",
             "Setter"}], "}"}], "]"}], ",", 
         RowBox[{"Spacer", "[", "20", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"op", ",", "False", ",", "\"\<optimize:\>\""}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}]}], "}"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Control", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ag", ",", "1", ",", "\"\<reaction:\>\""}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "\[Rule]", 
            RowBox[{"Style", "[", 
             RowBox[{"\"\<First Order\>\"", ",", " ", "Italic"}], "]"}]}], 
           ",", " ", 
           RowBox[{"2", "\[Rule]", 
            RowBox[{"Style", "[", 
             RowBox[{"\"\<Autocatalytic\>\"", ",", "Italic"}], "]"}]}]}], 
          "}"}], ",", "Setter"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Control", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"vr", ",", "50", ",", "\"\<volume of reactor (L)\>\""}], 
          "}"}], ",", "2", ",", "1000", ",", "1", ",", 
         RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], "]"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"Control", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "vo", ",", "10", ",", 
           "\"\<inlet volumetric flow rate (L/min)\>\""}], "}"}], ",", "1", 
         ",", "20", ",", "1", ",", 
         RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], "]"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"Control", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "cao", ",", "5", ",", "\"\<feed concentration of A (M)\>\""}], 
          "}"}], ",", "0", ",", "5", ",", "1", ",", 
         RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], "]"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"Control", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "cro", ",", "1", ",", "\"\<feed concentration of R (M)\>\""}], 
          "}"}], ",", "0", ",", "5", ",", "1", ",", 
         RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], "]"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"Control", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "pp", ",", "100", ",", "\"\<value of product R ($/mol)\>\""}], 
          "}"}], ",", "20", ",", "200", ",", "1", ",", 
         RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], "]"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"Control", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "pr", ",", "10", ",", "\"\<cost of reactant A ($/mol)\>\""}], "}"}],
          ",", "1", ",", "20", ",", "0.5", ",", 
         RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], "]"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"Control", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "reactorprice", ",", "5", ",", 
           "\"\<cost of reactor ($/L-min)\>\""}], "}"}], ",", "1", ",", "10", 
         ",", "1", ",", 
         RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
       "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.6470931353241653`*^9, 3.647093216607298*^9}, {
   3.647093280161847*^9, 3.6470933009205427`*^9}, {3.647094341088913*^9, 
   3.6470943425614758`*^9}, {3.647094390473442*^9, 3.647094469396934*^9}, {
   3.64709468841343*^9, 3.647094730091607*^9}, {3.6470947726551332`*^9, 
   3.6470947863554583`*^9}, {3.647094831588622*^9, 3.647095056257625*^9}, {
   3.6470957379340143`*^9, 3.6470957459573603`*^9}, {3.647096446005554*^9, 
   3.647096447187475*^9}, {3.6470965190851803`*^9, 3.647096535222887*^9}, 
   3.6470965903411303`*^9, {3.6470966868313437`*^9, 3.647096687566184*^9}, {
   3.6470967497372*^9, 3.647096757912792*^9}, {3.647096807587901*^9, 
   3.6470968138203287`*^9}, {3.6470970097394867`*^9, 3.647097029099818*^9}, {
   3.647097066412653*^9, 3.6470970666650267`*^9}, {3.647097108591034*^9, 
   3.647097135235881*^9}, {3.6470974207052507`*^9, 3.647097424051388*^9}, {
   3.64709746205503*^9, 3.647097463434107*^9}, {3.6470980160706787`*^9, 
   3.647098016564467*^9}, {3.6470980535038233`*^9, 3.647098054501446*^9}, {
   3.6470981948492727`*^9, 3.647098195046276*^9}, {3.647098338986562*^9, 
   3.647098413258604*^9}, {3.647098447373456*^9, 3.647098493437417*^9}, {
   3.647098564309126*^9, 3.647098579357752*^9}, 3.647098760283864*^9, {
   3.647098790461887*^9, 3.647098816518097*^9}, {3.647098960487418*^9, 
   3.647098962582163*^9}, {3.647098998766877*^9, 3.647099007572644*^9}, {
   3.6470992110670147`*^9, 3.647099211712865*^9}, {3.6470992639653397`*^9, 
   3.647099264548585*^9}, {3.6470993154721603`*^9, 3.6470993163290043`*^9}, {
   3.647099501959882*^9, 3.647099527399651*^9}, {3.647099699278049*^9, 
   3.647099703109355*^9}, {3.647099741352768*^9, 3.647099742593553*^9}, {
   3.647099866246531*^9, 3.6471000395348787`*^9}, {3.64710009071511*^9, 
   3.6471001535030212`*^9}, {3.6471002780893307`*^9, 3.647100332378393*^9}, {
   3.6471003877450037`*^9, 3.6471004112367153`*^9}, {3.647100472127646*^9, 
   3.647100530427641*^9}, {3.6471006475673323`*^9, 3.647100657502329*^9}, {
   3.647100987091919*^9, 3.647101023697122*^9}, {3.647101097672841*^9, 
   3.647101129226454*^9}, {3.647101233025091*^9, 3.647101234414733*^9}, {
   3.647101269650249*^9, 3.647101349149867*^9}, {3.647101382960834*^9, 
   3.647101412085698*^9}, {3.647101479166506*^9, 3.64710148086082*^9}, {
   3.647101603418148*^9, 3.647101608432279*^9}, {3.647101800209755*^9, 
   3.6471018007341423`*^9}, {3.6471019135675793`*^9, 3.64710195011058*^9}, {
   3.6471024192459908`*^9, 3.647102484519163*^9}, {3.647102630067556*^9, 
   3.647102635331429*^9}, {3.6471027252515783`*^9, 3.647102734763453*^9}, {
   3.647107183225107*^9, 3.647107184455814*^9}, {3.647107515849848*^9, 
   3.6471075180317183`*^9}, {3.6471745187198687`*^9, 3.647174564855991*^9}, {
   3.647174869402752*^9, 3.647174883373617*^9}, {3.647174922258284*^9, 
   3.647174928657482*^9}, {3.647175061794681*^9, 3.647175098294241*^9}, {
   3.6471751428315897`*^9, 3.6471751433958406`*^9}, {3.647175562884359*^9, 
   3.647175564914074*^9}, {3.647175631209325*^9, 3.647175673262967*^9}, {
   3.647175995528492*^9, 3.647176050280521*^9}, {3.647176091926949*^9, 
   3.647176134557363*^9}, {3.647176180713789*^9, 3.647176184896925*^9}, {
   3.64717625318461*^9, 3.647176387855032*^9}, {3.647176471837433*^9, 
   3.647176472803926*^9}, {3.647176533199522*^9, 3.647176557039444*^9}, {
   3.6471766118886127`*^9, 3.647176662763529*^9}, {3.647177021482458*^9, 
   3.64717702325905*^9}, {3.6471770661355343`*^9, 3.647177066991633*^9}, {
   3.647177282590025*^9, 3.647177290404687*^9}, {3.6471773261408033`*^9, 
   3.6471773332533283`*^9}, {3.647719310091198*^9, 3.647719612278482*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`ag$$ = 1, $CellContext`cao$$ = 
    5, $CellContext`cro$$ = 1, $CellContext`cs$$ = 1, $CellContext`gt$$ = 
    1, $CellContext`op$$ = False, $CellContext`pp$$ = 100, $CellContext`pr$$ =
     10, $CellContext`reactorprice$$ = 5, $CellContext`vo$$ = 
    10, $CellContext`vr$$ = 50, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`gt$$], 1, "plot type: "}, {
      1 -> Style["profit", Italic], 2 -> Style["concentrations", Italic]}}, {{
      
       Hold[$CellContext`cs$$], 1, "reactor type:"}, {
      1 -> Style["CSTR", Italic], 2 -> Style["PFR", Italic]}}, {{
       Hold[$CellContext`op$$], False, "optimize:"}, {True, False}}, {{
       Hold[$CellContext`ag$$], 1, "reaction:"}, {
      1 -> Style["First Order", Italic], 2 -> 
       Style["Autocatalytic", Italic]}}, {{
       Hold[$CellContext`vr$$], 50, "volume of reactor (L)"}, 2, 1000, 1}, {{
       Hold[$CellContext`vo$$], 10, "inlet volumetric flow rate (L/min)"}, 1, 
      20, 1}, {{
       Hold[$CellContext`cao$$], 5, "feed concentration of A (M)"}, 0, 5, 
      1}, {{
       Hold[$CellContext`cro$$], 1, "feed concentration of R (M)"}, 0, 5, 
      1}, {{
       Hold[$CellContext`pp$$], 100, "value of product R ($/mol)"}, 20, 200, 
      1}, {{
       Hold[$CellContext`pr$$], 10, "cost of reactant A ($/mol)"}, 1, 20, 
      0.5}, {{
       Hold[$CellContext`reactorprice$$], 5, "cost of reactor ($/L-min)"}, 1, 
      10, 1}, {
      Hold[
       Column[{
         Manipulate`Place[1], 
         Row[{
           Manipulate`Place[2], 
           Spacer[20], 
           Manipulate`Place[3]}], 
         Manipulate`Place[4], 
         Manipulate`Place[5], 
         Manipulate`Place[6], 
         Manipulate`Place[7], 
         Manipulate`Place[8], 
         Manipulate`Place[9], 
         Manipulate`Place[10], 
         Manipulate`Place[11]}]], Manipulate`Dump`ThisIsNotAControl}}, 
    Typeset`size$$ = {360., {116., 123.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`gt$47127$$ = False, $CellContext`cs$47128$$ = 
    False, $CellContext`op$47129$$ = False, $CellContext`ag$47130$$ = 
    False, $CellContext`vr$47131$$ = 0, $CellContext`vo$47132$$ = 
    0, $CellContext`cao$47133$$ = 0, $CellContext`cro$47134$$ = 
    0, $CellContext`pp$47135$$ = 0, $CellContext`pr$47136$$ = 
    0, $CellContext`reactorprice$47137$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`ag$$ = 1, $CellContext`cao$$ = 
        5, $CellContext`cro$$ = 1, $CellContext`cs$$ = 1, $CellContext`gt$$ = 
        1, $CellContext`op$$ = False, $CellContext`pp$$ = 
        100, $CellContext`pr$$ = 10, $CellContext`reactorprice$$ = 
        5, $CellContext`vo$$ = 10, $CellContext`vr$$ = 50}, 
      "ControllerVariables" :> {
        Hold[$CellContext`gt$$, $CellContext`gt$47127$$, False], 
        Hold[$CellContext`cs$$, $CellContext`cs$47128$$, False], 
        Hold[$CellContext`op$$, $CellContext`op$47129$$, False], 
        Hold[$CellContext`ag$$, $CellContext`ag$47130$$, False], 
        Hold[$CellContext`vr$$, $CellContext`vr$47131$$, 0], 
        Hold[$CellContext`vo$$, $CellContext`vo$47132$$, 0], 
        Hold[$CellContext`cao$$, $CellContext`cao$47133$$, 0], 
        Hold[$CellContext`cro$$, $CellContext`cro$47134$$, 0], 
        Hold[$CellContext`pp$$, $CellContext`pp$47135$$, 0], 
        Hold[$CellContext`pr$$, $CellContext`pr$47136$$, 0], 
        Hold[$CellContext`reactorprice$$, $CellContext`reactorprice$47137$$, 
         0]}, "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`optimalvolume$, $CellContext`conversion$, \
$CellContext`profit$, $CellContext`profitplot$, $CellContext`reactor$, \
$CellContext`k$, $CellContext`Fro$, $CellContext`Fao$, $CellContext`Ca$, \
$CellContext`Cr$, $CellContext`s$, $CellContext`p1$, $CellContext`tao$, \
$CellContext`concA$, $CellContext`concR$, $CellContext`concplot$}, \
$CellContext`k$ = 
         0.1; $CellContext`Fao$ = $CellContext`cao$$ $CellContext`vo$$; \
$CellContext`Fro$ = $CellContext`cro$$ $CellContext`vo$$; $CellContext`Ca$ = \
$CellContext`Fa[$CellContext`z]/$CellContext`vo$$; $CellContext`Cr$ = \
$CellContext`Fr[$CellContext`z]/$CellContext`vo$$; $CellContext`tao$ = \
$CellContext`vr$$/$CellContext`vo$$; $CellContext`s$ = NDSolve[{
            
            If[$CellContext`ag$$ == 1, 
             Derivative[
              1][$CellContext`Fa][$CellContext`z] == (-$CellContext`k$) \
$CellContext`Ca$, 
             Derivative[
              1][$CellContext`Fa][$CellContext`z] == (-$CellContext`k$) \
$CellContext`Ca$ $CellContext`Cr$], 
            
            If[$CellContext`ag$$ == 1, 
             Derivative[
              1][$CellContext`Fr][$CellContext`z] == $CellContext`k$ \
$CellContext`Ca$, 
             Derivative[
              1][$CellContext`Fr][$CellContext`z] == $CellContext`k$ \
$CellContext`Ca$ $CellContext`Cr$], $CellContext`Fa[
             0] == $CellContext`Fao$, $CellContext`Fr[
             0] == $CellContext`Fro$}, {$CellContext`Fa, $CellContext`Fr}, \
{$CellContext`z, 0, 1000}]; $CellContext`conversion$[
           Pattern[$CellContext`z$, 
            Blank[]]] = 
         Which[$CellContext`cs$$ == 2, ($CellContext`Fao$ - Part[
             Evaluate[
              ReplaceAll[
               $CellContext`Fa[$CellContext`z$], $CellContext`s$]], 
             1])/$CellContext`Fao$, 
           
           And[$CellContext`ag$$ == 1, $CellContext`cs$$ == 
            1], $CellContext`k$ ($CellContext`z$/($CellContext`k$ \
$CellContext`z$ + $CellContext`vo$$)), 
           And[$CellContext`ag$$ == 2, $CellContext`cs$$ == 1], 
           
           1 - $CellContext`vo$$/($CellContext`z$ $CellContext`k$ \
$CellContext`cao$$)]; $CellContext`profit$[
           Pattern[$CellContext`z$, 
            Blank[]], 
           Pattern[$CellContext`pp$, 
            Blank[]], 
           Pattern[$CellContext`pr$, 
            Blank[]], 
           Pattern[$CellContext`reactorprice$, 
            Blank[]]] = If[$CellContext`cs$$ == 2, Part[
              Evaluate[
               ReplaceAll[
                $CellContext`Fr[$CellContext`z$], $CellContext`s$]], 
              1] $CellContext`pp$ - $CellContext`Fro$ $CellContext`pp$ - \
$CellContext`Fao$ $CellContext`pr$ - $CellContext`reactorprice$ \
$CellContext`z$, $CellContext`pp$ $CellContext`conversion$[$CellContext`z$] \
$CellContext`Fao$ - $CellContext`Fro$ $CellContext`pp$ - $CellContext`Fao$ \
$CellContext`pr$ - $CellContext`reactorprice$ $CellContext`z$]; \
$CellContext`optimalvolume$ = ReplaceAll[$CellContext`z, 
           Quiet[
            FindRoot[D[
               If[$CellContext`cs$$ == 2, Part[
                   Evaluate[
                    ReplaceAll[
                    $CellContext`Fr[$CellContext`z], $CellContext`s$]], 
                   1] $CellContext`pp$$ - $CellContext`Fro$ $CellContext`pp$$ - \
$CellContext`Fao$ $CellContext`pr$$ - $CellContext`reactorprice$$ \
$CellContext`z, $CellContext`pp$$ $CellContext`conversion$[$CellContext`z] \
$CellContext`Fao$ - $CellContext`Fro$ $CellContext`pp$$ - $CellContext`Fao$ \
$CellContext`pr$$ - $CellContext`reactorprice$$ $CellContext`z], \
$CellContext`z] == 0, {$CellContext`z, 1}]]]; 
        If[$CellContext`op$$, $CellContext`vr$$ = \
$CellContext`optimalvolume$]; $CellContext`concA$[
           Pattern[$CellContext`z$, 
            Blank[]]] = If[$CellContext`cs$$ == 2, Part[
             Evaluate[
              ReplaceAll[
               $CellContext`Fa[$CellContext`z$], $CellContext`s$]], 
             1]/$CellContext`vo$$, $CellContext`cao$$ (
            
            1 - $CellContext`conversion$[$CellContext`z$])]; \
$CellContext`concR$[
           Pattern[$CellContext`z$, 
            Blank[]]] = If[$CellContext`cs$$ == 2, Part[
             Evaluate[
              ReplaceAll[
               $CellContext`Fr[$CellContext`z$], $CellContext`s$]], 
             1]/$CellContext`vo$$, $CellContext`cro$$ + $CellContext`cao$$ \
$CellContext`conversion$[$CellContext`z$]]; $CellContext`concplot$ = Show[
           Plot[{
             $CellContext`concA$[$CellContext`z], 
             $CellContext`concR$[$CellContext`z]}, {$CellContext`z, 
             0, $CellContext`tao$ $CellContext`vo$$}, Frame -> True, 
            LabelStyle -> 14, ImageSize -> Medium, PlotRange -> {0, 10}, 
            FrameLabel -> {
             "reactor volume(L)", 
              "concentration (M)"}]]; $CellContext`profitplot$ = Show[
           Plot[
            $CellContext`profit$[$CellContext`z, $CellContext`pp$$, \
$CellContext`pr$$, $CellContext`reactorprice$$], {$CellContext`z, 0, 1000}, 
            PlotRange -> {-1000, \
$CellContext`profit$[$CellContext`optimalvolume$, $CellContext`pp$$, \
$CellContext`pr$$, $CellContext`reactorprice$$] + 100}, 
            FrameLabel -> {"reactor volume (L)", "profit (dollars/min)"}, 
            Frame -> True, LabelStyle -> 14, ImageSize -> Medium, 
            PlotRangePadding -> None], 
           Graphics[{{
              PointSize[0.02], 
              Point[{
                
                If[$CellContext`op$$, $CellContext`optimalvolume$, \
$CellContext`vr$$], 
                If[$CellContext`op$$, 
                 $CellContext`profit$[$CellContext`optimalvolume$, \
$CellContext`pp$$, $CellContext`pr$$, $CellContext`reactorprice$$], 
                 $CellContext`profit$[$CellContext`vr$$, $CellContext`pp$$, \
$CellContext`pr$$, $CellContext`reactorprice$$]]}]}}]]; $CellContext`reactor$ = 
         Show[
           Graphics[{{Thick, Black, 
              Arrow[{{0.5, 1}, {0.75, 1}}]}, {Thick, Black, 
              If[$CellContext`cs$$ == 1, 
               Line[{{0.75, 1.2}, {0.75, 0.6}, {1.25, 0.6}, {1.25, 1.2}}], 
               Circle[{0.75, 1}, {0.1, 0.15}, {3 (Pi/2), Pi/2}]]}, {
             Thick, Black, 
              If[$CellContext`cs$$ == 1, 
               Line[{{1.2, 1.3}, {1, 0.8}}], 
               Circle[{1.25, 1}, {0.1, 0.15}]]}, {Thick, Black, 
              If[$CellContext`cs$$ == 1, 
               BezierCurve[{{0.8, 0.8}, {0.9, 1}, {1.1, 0.6}, {1.2, 0.8}}], 
               Line[{{0.75, 1.15}, {1.25, 1.15}}]]}, {Thick, Black, 
              If[$CellContext`cs$$ == 1, 
               BezierCurve[{{0.8, 0.8}, {0.9, 0.6}, {1.1, 1}, {1.2, 0.8}}], 
               Line[{{0.75, 0.85}, {1.25, 0.85}}]]}, {Thick, Black, 
              Arrow[{{1.25, 1}, {1.5, 1}}]}, {
              If[$CellContext`ag$$ == 1, 
               Text[
                Style[
                 Row[{"A \[ShortRightArrow] R"}], 16], {1, 1.6}], 
               Text[
                Style[
                 Row[{"A + R \[ShortRightArrow] 2 R"}], 16], {1, 1.6}]]}}, 
            ImageSize -> Small]]; Column[{
           Show[
            
            Switch[$CellContext`gt$$, 1, $CellContext`profitplot$, 
             2, $CellContext`concplot$]], 
           Text[
            Style[
             Row[{" profit = ", 
               NumberForm[
                $CellContext`profit$[
                 
                 If[$CellContext`op$$, $CellContext`optimalvolume$, \
$CellContext`vr$$], $CellContext`pp$$, $CellContext`pr$$, \
$CellContext`reactorprice$$], {4, 2}], "$/min", 
               Spacer[25], "conversion = ", 
               NumberForm[
                $CellContext`conversion$[
                 
                 If[$CellContext`op$$, $CellContext`optimalvolume$, \
$CellContext`vr$$]], {2, 2}]}], 18]]}, Center]], 
      "Specifications" :> {{{$CellContext`gt$$, 1, "plot type: "}, {
         1 -> Style["profit", Italic], 2 -> Style["concentrations", Italic]}, 
         ControlType -> Setter, ControlPlacement -> 
         1}, {{$CellContext`cs$$, 1, "reactor type:"}, {
         1 -> Style["CSTR", Italic], 2 -> Style["PFR", Italic]}, ControlType -> 
         Setter, ControlPlacement -> 
         2}, {{$CellContext`op$$, False, "optimize:"}, {True, False}, 
         ControlPlacement -> 3}, {{$CellContext`ag$$, 1, "reaction:"}, {
         1 -> Style["First Order", Italic], 2 -> 
          Style["Autocatalytic", Italic]}, ControlType -> Setter, 
         ControlPlacement -> 
         4}, {{$CellContext`vr$$, 50, "volume of reactor (L)"}, 2, 1000, 1, 
         Appearance -> "Labeled", ControlPlacement -> 
         5}, {{$CellContext`vo$$, 10, "inlet volumetric flow rate (L/min)"}, 
         1, 20, 1, Appearance -> "Labeled", ControlPlacement -> 
         6}, {{$CellContext`cao$$, 5, "feed concentration of A (M)"}, 0, 5, 1,
          Appearance -> "Labeled", ControlPlacement -> 
         7}, {{$CellContext`cro$$, 1, "feed concentration of R (M)"}, 0, 5, 1,
          Appearance -> "Labeled", ControlPlacement -> 
         8}, {{$CellContext`pp$$, 100, "value of product R ($/mol)"}, 20, 200,
          1, Appearance -> "Labeled", ControlPlacement -> 
         9}, {{$CellContext`pr$$, 10, "cost of reactant A ($/mol)"}, 1, 20, 
         0.5, Appearance -> "Labeled", ControlPlacement -> 
         10}, {{$CellContext`reactorprice$$, 5, "cost of reactor ($/L-min)"}, 
         1, 10, 1, Appearance -> "Labeled", ControlPlacement -> 11}, 
        Column[{
          Manipulate`Place[1], 
          Row[{
            Manipulate`Place[2], 
            Spacer[20], 
            Manipulate`Place[3]}], 
          Manipulate`Place[4], 
          Manipulate`Place[5], 
          Manipulate`Place[6], 
          Manipulate`Place[7], 
          Manipulate`Place[8], 
          Manipulate`Place[9], 
          Manipulate`Place[10], 
          Manipulate`Place[11]}]}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{464., {279., 286.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.6471755516371326`*^9, 3.6471755659137373`*^9}, {
   3.6471756746463423`*^9, 3.647175686396061*^9}, {3.647176027496653*^9, 
   3.647176051506291*^9}, 3.6471761860381536`*^9, 3.647176393552661*^9, {
   3.647176535717061*^9, 3.647176558154684*^9}, 3.647176622514161*^9, 
   3.647176663910612*^9, 3.647176769807926*^9, 3.6471768213506947`*^9, 
   3.64717707119524*^9, 3.647177292741563*^9, 3.647177334500082*^9, 
   3.647719616283711*^9, 3.6477196882218256`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.647175102920327*^9, 3.6471751285613422`*^9}, 
   3.64717559995432*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.647175592890785*^9, 3.647175597346567*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6471751522340307`*^9, 3.647175153226447*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.647175117247822*^9, 3.647175117265415*^9}}]
},
WindowSize->{667, 670},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 7, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 30276, 693, 2732, "Input"],
Cell[30859, 717, 14958, 300, 582, "Output"]
}, Open  ]],
Cell[45832, 1020, 119, 2, 31, "Input"],
Cell[45954, 1024, 92, 1, 31, "Input"],
Cell[46049, 1027, 94, 1, 31, "Input"],
Cell[46146, 1030, 92, 1, 31, "Input"]
}
]
*)

(* End of internal cache information *)
