(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     57697,       1295]
NotebookOptionsPosition[     57376,       1279]
NotebookOutlinePosition[     57718,       1294]
CellTagsIndexPosition[     57675,       1291]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "vr", ",", "k", ",", "vo", ",", "Fao", ",", "Fro", ",", "Ca", ",", "Cr",
        ",", "s", ",", "conversion", ",", "profit", ",", "optimalvolume", ",",
        "concA", ",", "concR", ",", "concplot", ",", "profitplot"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ptv", "\[Equal]", "1"}], ",", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"vr", ":=", 
          RowBox[{"If", "[", 
           RowBox[{"op", ",", "optimalvolume", ",", 
            RowBox[{"vrpt", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"k", "=", "0.1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"vo", "=", "10"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Fao", "=", 
          RowBox[{"cao", "*", "vo"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Fro", "=", 
          RowBox[{"cro", "*", "vo"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Ca", "=", 
          RowBox[{
           RowBox[{"Fa", "[", "z", "]"}], "/", "vo"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Cr", "=", 
          RowBox[{
           RowBox[{"Fr", "[", "z", "]"}], "/", "vo"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"s", "=", 
          RowBox[{"NDSolve", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"ag", "\[Equal]", "1"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Fa", "'"}], "[", "z", "]"}], "\[Equal]", 
                 RowBox[{
                  RowBox[{"-", "k"}], "*", "Ca"}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Fa", "'"}], "[", "z", "]"}], "\[Equal]", 
                 RowBox[{
                  RowBox[{"-", "k"}], "*", "Ca", "*", "Cr"}]}]}], "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"ag", "\[Equal]", "1"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Fr", "'"}], "[", "z", "]"}], "\[Equal]", 
                 RowBox[{"k", "*", "Ca"}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Fr", "'"}], "[", "z", "]"}], "\[Equal]", 
                 RowBox[{"k", "*", "Ca", "*", "Cr"}]}]}], "]"}], ",", 
              RowBox[{
               RowBox[{"Fa", "[", "0", "]"}], "==", "Fao"}], ",", 
              RowBox[{
               RowBox[{"Fr", "[", "0", "]"}], "\[Equal]", "Fro"}]}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"Fa", ",", "Fr"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"z", ",", "0", ",", "1000"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"conversion", "[", "z_", "]"}], "=", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"cs", "\[Equal]", "2"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Fao", "-", 
               RowBox[{
                RowBox[{"Evaluate", "[", 
                 RowBox[{
                  RowBox[{"Fa", "[", "z", "]"}], "/.", "s"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "Fao"}], ",", 
            RowBox[{
             RowBox[{"ag", "\[Equal]", "1"}], "&&", 
             RowBox[{"cs", "\[Equal]", "1"}]}], ",", " ", 
            RowBox[{"k", "*", 
             RowBox[{"z", "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"k", "*", "z"}], "+", "vo"}], ")"}]}]}], ",", 
            RowBox[{
             RowBox[{"ag", "\[Equal]", "2"}], "&&", 
             RowBox[{"cs", "\[Equal]", "1"}]}], ",", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{"vo", "/", 
               RowBox[{"(", 
                RowBox[{"z", "*", "k", "*", "cao"}], ")"}]}], ")"}]}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"profit", "[", "z_", "]"}], "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"cs", "\[Equal]", "2"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Evaluate", "[", 
                RowBox[{
                 RowBox[{"Fr", "[", "z", "]"}], "/.", "s"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "*", "pp"}], "-", 
             RowBox[{"Fro", "*", "pp"}], "-", 
             RowBox[{"Fao", "*", "pr"}], "-", 
             RowBox[{"reactorprice", "*", "z"}]}], ",", 
            RowBox[{
             RowBox[{"pp", "*", 
              RowBox[{"conversion", "[", "z", "]"}], "*", "Fao"}], "-", 
             RowBox[{"Fro", "*", "pp"}], "-", 
             RowBox[{"Fao", "*", "pr"}], "-", 
             RowBox[{"reactorprice", "*", "z"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"profit", "[", "z_", "]"}], "=", 
            RowBox[{"Piecewise", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"None", ",", 
                 RowBox[{"z", "<", "0"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"cs", "\[Equal]", "2"}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{"Fr", "[", "z", "]"}], "/.", "s"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", "pp"}], "-", 
                    RowBox[{"Fro", "*", "pp"}], "-", 
                    RowBox[{"Fao", "*", "pr"}], "-", 
                    RowBox[{"reactorprice", "*", "z"}]}], ",", 
                   RowBox[{
                    RowBox[{"pp", "*", 
                    RowBox[{"conversion", "[", "z", "]"}], "*", "Fao"}], "-", 
                    RowBox[{"Fro", "*", "pp"}], "-", 
                    RowBox[{"Fao", "*", "pr"}], "-", 
                    RowBox[{"reactorprice", "*", "z"}]}]}], "]"}], ",", 
                 RowBox[{"0", "\[LessEqual]", "z", "\[LessEqual]", "1000"}]}],
                 "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"None", ",", 
                 RowBox[{"1000", "<", "z"}]}], "}"}]}], "}"}], "]"}]}], ";"}],
           "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"optimalvolume", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{"conversion", "[", "z", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"z", ",", "1", ",", "1000"}], "}"}]}], "]"}], 
             "\[Equal]", "0"}], ",", "1", ",", 
            RowBox[{"z", "/.", 
             RowBox[{"Quiet", "@", 
              RowBox[{
               RowBox[{"FindMaximum", "[", 
                RowBox[{
                 RowBox[{"profit", "[", "z", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"z", ",", "1", ",", "1", ",", "1000"}], "}"}]}], 
                "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"concA", "[", "z_", "]"}], "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"cs", "\[Equal]", "2"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Evaluate", "[", 
               RowBox[{
                RowBox[{"Fa", "[", "z", "]"}], "/.", "s"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "/", "vo"}], ",", 
            RowBox[{"cao", "*", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"conversion", "[", "z", "]"}]}], ")"}]}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"concR", "[", "z_", "]"}], "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"cs", "\[Equal]", "2"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Evaluate", "[", 
               RowBox[{
                RowBox[{"Fr", "[", "z", "]"}], "/.", "s"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "/", "vo"}], ",", 
            RowBox[{"cro", "+", 
             RowBox[{"cao", "*", 
              RowBox[{"conversion", "[", "z", "]"}]}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"concplot", "=", 
          RowBox[{"Show", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"concA", "[", "z", "]"}], ",", 
                RowBox[{"concR", "[", "z", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"z", ",", "0", ",", "vr"}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Thick", ",", "Black"}], "}"}]}], "}"}]}]}], "]"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<reactant\>\"", ",", "17", ",", "Blue", ",", 
                   RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"0.33", "*", "vr"}], ",", 
                   RowBox[{"concA", "[", 
                    RowBox[{"0.33", "*", "vr"}], "]"}]}], "}"}]}], "]"}], ",",
                "\[IndentingNewLine]", 
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<product\>\"", ",", "17", ",", 
                   RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"0.67", "*", "vr"}], ",", 
                   RowBox[{"concR", "[", 
                    RowBox[{"0.67", "*", "vr"}], "]"}]}], "}"}]}], "]"}]}], 
              "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<reactor volume (L)\>\"", ",", "17"}], "]"}], ",", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<concentration  (mol/L)\>\"", ",", "17"}], 
                "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "0.5"}], ",", "10.5"}], "}"}], ","}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"ImagePadding", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"50", ",", "15"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"45", ",", "10"}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"profitplot", "=", 
          RowBox[{"Show", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"profit", "[", "z", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"z", ",", "0", ",", "1000"}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Thick", ",", 
                 RowBox[{"RGBColor", "[", 
                  RowBox[{"0.", ",", "0.54", ",", "0."}], "]"}]}], "}"}]}]}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"PointSize", "[", "0.03", "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"{", 
                 RowBox[{"vr", ",", 
                  RowBox[{"profit", "[", "vr", "]"}]}], "}"}], "]"}]}], "}"}],
              "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<reactor volume (L)\>\"", ",", "17"}], "]"}], ",", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<profit  ($/min)\>\"", ",", "17"}], "]"}]}], "}"}]
              }], ",", "\[IndentingNewLine]", 
            RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotRangePadding", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"10", ",", "10"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Scaled", "[", "0.01", "]"}], ",", 
                 RowBox[{"Scaled", "[", "0.1", "]"}]}], "}"}]}], "}"}]}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"ImagePadding", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"75", ",", "15"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"45", ",", "10"}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Column", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Show", "[", 
              RowBox[{
               RowBox[{"Switch", "[", 
                RowBox[{
                "gt", ",", "1", ",", "profitplot", ",", "2", ",", 
                 "concplot"}], "]"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"400", ",", "325"}], "}"}]}], ",", 
               RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
               RowBox[{"Frame", "\[Rule]", "True"}], ",", 
               RowBox[{"LabelStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Black", ",", "14"}], "}"}]}], ",", 
               RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Spacer", "[", "10", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Text", "@", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{"\"\<profit = \>\"", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"profit", "[", "vr", "]"}], "<", "0"}], ",", 
                    "\"\<-$\>\"", ",", "\"\<$\>\""}], "]"}], ",", 
                   RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{"Abs", "@", 
                    RowBox[{"profit", "[", "vr", "]"}]}], "]"}], ",", 
                    RowBox[{"DigitBlock", "\[Rule]", "3"}]}], "]"}], ",", 
                   "\"\</min\>\"", ",", 
                   RowBox[{"Spacer", "[", "25", "]"}], ",", 
                   "\"\<conversion = \>\"", ",", 
                   RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"conversion", "[", "vr", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "}"}], "]"}], 
                ",", "18"}], "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
           "Center"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"vr", ":=", 
          RowBox[{"vrpt", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vo", "=", "10"}], ";", "\[IndentingNewLine]", 
         RowBox[{"k", "=", "0.1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Fao", "=", 
          RowBox[{"cao", "*", "vo"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Fro", "=", 
          RowBox[{"cro", "*", "vo"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Ca", "=", 
          RowBox[{
           RowBox[{"Fa", "[", "z", "]"}], "/", "vo"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Cr", "=", 
          RowBox[{
           RowBox[{"Fr", "[", "z", "]"}], "/", "vo"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"s", "=", 
          RowBox[{"NDSolve", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"ag", "\[Equal]", "1"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Fa", "'"}], "[", "z", "]"}], "\[Equal]", 
                 RowBox[{
                  RowBox[{"-", "k"}], "*", "Ca"}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Fa", "'"}], "[", "z", "]"}], "\[Equal]", 
                 RowBox[{
                  RowBox[{"-", "k"}], "*", "Ca", "*", "Cr"}]}]}], "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"ag", "\[Equal]", "1"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Fr", "'"}], "[", "z", "]"}], "\[Equal]", 
                 RowBox[{"k", "*", "Ca"}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Fr", "'"}], "[", "z", "]"}], "\[Equal]", 
                 RowBox[{"k", "*", "Ca", "*", "Cr"}]}]}], "]"}], ",", 
              RowBox[{
               RowBox[{"Fa", "[", "0", "]"}], "==", "Fao"}], ",", 
              RowBox[{
               RowBox[{"Fr", "[", "0", "]"}], "\[Equal]", "Fro"}]}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"Fa", ",", "Fr"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"z", ",", "0", ",", "1000"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"conversion", "[", "z_", "]"}], "=", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"cs", "\[Equal]", "2"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Fao", "-", 
               RowBox[{
                RowBox[{"Evaluate", "[", 
                 RowBox[{
                  RowBox[{"Fa", "[", "z", "]"}], "/.", "s"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "Fao"}], ",", 
            RowBox[{
             RowBox[{"ag", "\[Equal]", "1"}], "&&", 
             RowBox[{"cs", "\[Equal]", "1"}]}], ",", " ", 
            RowBox[{"k", "*", 
             RowBox[{"z", "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"k", "*", "z"}], "+", "vo"}], ")"}]}]}], ",", 
            RowBox[{
             RowBox[{"ag", "\[Equal]", "2"}], "&&", 
             RowBox[{"cs", "\[Equal]", "1"}]}], ",", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{"vo", "/", 
               RowBox[{"(", 
                RowBox[{"z", "*", "k", "*", "cao"}], ")"}]}], ")"}]}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"profit", "[", 
           RowBox[{"z_", ",", "pp_", ",", "pr_", ",", "reactorprice_"}], 
           "]"}], "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"cs", "\[Equal]", "2"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Evaluate", "[", 
                RowBox[{
                 RowBox[{"Fr", "[", "z", "]"}], "/.", "s"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "*", "pp"}], "-", 
             RowBox[{"Fro", "*", "pp"}], "-", 
             RowBox[{"Fao", "*", "pr"}], "-", 
             RowBox[{"reactorprice", "*", "z"}]}], ",", 
            RowBox[{
             RowBox[{"pp", "*", 
              RowBox[{"conversion", "[", "z", "]"}], "*", "Fao"}], "-", 
             RowBox[{"Fro", "*", "pp"}], "-", 
             RowBox[{"Fao", "*", "pr"}], "-", 
             RowBox[{"reactorprice", "*", "z"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"optimalvolume", "=", 
          RowBox[{"z", "/.", 
           RowBox[{"Quiet", "@", 
            RowBox[{"FindRoot", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"D", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"cs", "\[Equal]", "2"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{"Fr", "[", "z", "]"}], "/.", "s"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", "pp"}], "-", 
                    RowBox[{"Fro", "*", "pp"}], "-", 
                    RowBox[{"Fao", "*", "pr"}], "-", 
                    RowBox[{"reactorprice", "*", "z"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"pp", "*", 
                    RowBox[{"conversion", "[", "z", "]"}], "*", "Fao"}], "-", 
                    RowBox[{"Fro", "*", "pp"}], "-", 
                    RowBox[{"Fao", "*", "pr"}], "-", 
                    RowBox[{"reactorprice", "*", "z"}]}]}], "]"}], ",", 
                 "\[IndentingNewLine]", "z"}], "]"}], "\[Equal]", "0"}], ",", 
              RowBox[{"{", 
               RowBox[{"z", ",", "1", ",", "1", ",", "1000"}], "}"}]}], 
             "]"}]}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"op", ",", 
           RowBox[{"vr", "=", "optimalvolume"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"concA", "[", "z_", "]"}], "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"cs", "\[Equal]", "2"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Evaluate", "[", 
               RowBox[{
                RowBox[{"Fa", "[", "z", "]"}], "/.", "s"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "/", "vo"}], ",", 
            RowBox[{"cao", "*", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"conversion", "[", "z", "]"}]}], ")"}]}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"concR", "[", "z_", "]"}], "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"cs", "\[Equal]", "2"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Evaluate", "[", 
               RowBox[{
                RowBox[{"Fr", "[", "z", "]"}], "/.", "s"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "/", "vo"}], ",", 
            RowBox[{"cro", "+", 
             RowBox[{"cao", "*", 
              RowBox[{"conversion", "[", "z", "]"}]}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"concplot", "=", 
          RowBox[{"Show", "[", "\[IndentingNewLine]", 
           RowBox[{"Plot", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"concA", "[", "z", "]"}], ",", 
               RowBox[{"concR", "[", "z", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"z", ",", "0", ",", "vr"}], "}"}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"LabelStyle", "\[Rule]", "14"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "Medium"}], 
             RowBox[{"(*", 
              RowBox[{",", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], "*)"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<reactor volume(L)\>\"", ",", 
                "\"\<concentration (M)\>\""}], "}"}]}]}], "]"}], "]"}]}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"profitplot", "=", 
          RowBox[{"Show", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"profit", "[", 
               RowBox[{"z", ",", "pp", ",", "pr", ",", "reactorprice"}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"z", ",", "0", ",", "1000"}], "}"}], 
              RowBox[{"(*", 
               RowBox[{",", 
                RowBox[{"PlotRange", "\[Rule]", "All"}]}], "*)"}], 
              RowBox[{"(*", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1000"}], ",", 
                 RowBox[{
                  RowBox[{"profit", "[", 
                   RowBox[{
                   "optimalvolume", ",", "pp", ",", "pr", ",", 
                    "reactorprice"}], "]"}], "+", "100"}]}], "}"}], "*)"}], 
              ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                "\"\<reactor volume (L)\>\"", ",", 
                 "\"\<profit (dollars/min)\>\""}], "}"}]}], ",", 
              RowBox[{"Frame", "\[Rule]", "True"}], ",", 
              RowBox[{"LabelStyle", "\[Rule]", "14"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
              RowBox[{"PlotRangePadding", "\[Rule]", "None"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
                RowBox[{"Point", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{"op", ",", "optimalvolume", ",", "vr"}], "]"}], 
                   ",", 
                   RowBox[{"If", "[", 
                    RowBox[{"op", ",", 
                    RowBox[{"profit", "[", 
                    RowBox[{
                    "optimalvolume", ",", "pp", ",", "pr", ",", 
                    "reactorprice"}], "]"}], ",", 
                    RowBox[{"profit", "[", 
                    RowBox[{"vr", ",", "pp", ",", "pr", ",", "reactorprice"}],
                     "]"}]}], "]"}]}], "}"}], "]"}]}], "}"}], 
              "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
           "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Column", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Show", "[", 
              RowBox[{
               RowBox[{"Switch", "[", 
                RowBox[{
                "gt", ",", "1", ",", "profitplot", ",", "2", ",", 
                 "concplot"}], "]"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               RowBox[{"PlotLabel", "\[Rule]", 
                RowBox[{"Style", "[", 
                 RowBox[{"vr", ",", "17", ",", "Black"}], "]"}]}]}], "]"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"Text", "@", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{"\"\< profit = \>\"", ",", 
                   RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"profit", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"op", ",", "optimalvolume", ",", "vr"}], "]"}], 
                    ",", "pp", ",", "pr", ",", "reactorprice"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "2"}], "}"}]}], "]"}], ",", 
                   "\"\<$/min\>\"", ",", 
                   RowBox[{"Spacer", "[", "25", "]"}], ",", 
                   "\"\<conversion = \>\"", ",", 
                   RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"conversion", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{"op", ",", "optimalvolume", ",", "vr"}], "]"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "}"}], "]"}], 
                ",", "18"}], "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
           "Center"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ptv", ",", "1", ",", "\"\<\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "\[Rule]", "\"\<R\>\""}], ",", 
        RowBox[{"2", "\[Rule]", "\"\<G\>\""}]}], "}"}], ",", "Setter"}], 
     "}"}], "]"}], ",", "\[IndentingNewLine]", "Delimiter", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Column", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<select a plot:\>\"", ",", "Bold"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"gt", ",", "1", ",", "\"\<\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "\[Rule]", "\"\<profit\>\""}], ",", 
            RowBox[{"2", "\[Rule]", "\"\<concentration\>\""}]}], "}"}], ",", 
          "RadioButton"}], "}"}], "]"}], ",", 
       RowBox[{"Spacer", "[", "0", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<reactor type:\>\"", ",", "Bold"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"cs", ",", "1", ",", "\"\<\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "\[Rule]", "\"\<CSTR\>\""}], ",", 
            RowBox[{"2", "\[Rule]", "\"\<PFR\>\""}]}], "}"}], ",", 
          "RadioButton"}], "}"}], "]"}], ",", 
       RowBox[{"Spacer", "[", "0", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<reaction:\>\"", ",", "Bold"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ag", ",", "1", ",", "\"\<\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "\[Rule]", "\"\<first order\>\""}], ",", 
            RowBox[{"2", "\[Rule]", "\"\<autocatalytic\>\""}]}], "}"}], ",", 
          "RadioButton"}], "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
     "Left"}], "]"}], ",", "\[IndentingNewLine]", "Delimiter", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Column", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{"\"\<feed concentrations (mol/L)\>\"", ",", "Bold"}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Control", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"cao", ",", "5", ",", "\"\<reactant\>\""}], "}"}], ",", "1",
          ",", "5", ",", "1", ",", 
         RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Control", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"cro", ",", "1", ",", "\"\<product\>\""}], "}"}], ",", "0", 
         ",", "5", ",", "1", ",", 
         RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}], "]"}]}], 
     "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
   "Delimiter", ",", "\[IndentingNewLine]", 
   RowBox[{"PaneSelector", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"1", "\[Rule]", 
        RowBox[{"Column", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<value and cost ($/mol)\>\"", ",", "Bold"}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Control", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"pp", ",", "100", ",", "\"\<product\>\""}], "}"}], ",",
               "20", ",", "200", ",", "1", ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Control", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"pr", ",", "10", ",", "\"\<reactant\>\""}], "}"}], ",",
               "1", ",", "20", ",", "0.5", ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<cost ($/L/min)\>\"", ",", "Bold"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Control", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"reactorprice", ",", "5", ",", "\"\<reactor\>\""}], 
               "}"}], ",", "1", ",", "10", ",", "1", ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}], "]"}], ",", 
           RowBox[{"Spacer", "[", "0", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Control", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"op", ",", "False", ",", "\"\<optimize\>\""}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"2", "\[Rule]", 
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"op", ",", "False", ",", "\"\<optimize\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"Dynamic", "@", "gt"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vrpt", ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", "0"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", "25000"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1000", ",", "10000"}], "}"}], ",", "Locator", ",", 
      RowBox[{"Appearance", "\[Rule]", "None"}]}], "}"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ControlPlacement", "\[Rule]", "Left"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.647796104615498*^9, 3.6477962957424297`*^9}, {
   3.647796347648399*^9, 3.6477963736958885`*^9}, {3.6477964290630555`*^9, 
   3.6477964441369176`*^9}, {3.647796554582235*^9, 3.6477965695790925`*^9}, {
   3.647796726266054*^9, 3.64779673126134*^9}, 3.647799180802446*^9}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`ag$$ = 2, $CellContext`cao$$ = 
    2, $CellContext`cro$$ = 1, $CellContext`cs$$ = 2, $CellContext`gt$$ = 
    1, $CellContext`op$$ = True, $CellContext`pp$$ = 100, $CellContext`pr$$ = 
    10, $CellContext`ptv$$ = 2, $CellContext`reactorprice$$ = 
    5, $CellContext`vrpt$$ = {50, 0}, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`ptv$$], 1, ""}, {1 -> "R", 2 -> "G"}}, {{
       Hold[$CellContext`gt$$], 1, ""}, {
      1 -> "profit", 2 -> "concentration"}}, {{
       Hold[$CellContext`cs$$], 1, ""}, {1 -> "CSTR", 2 -> "PFR"}}, {{
       Hold[$CellContext`ag$$], 1, ""}, {
      1 -> "first order", 2 -> "autocatalytic"}}, {
      Hold[
       Column[{
         Style["select a plot:", Bold], 
         Manipulate`Place[1], 
         Spacer[0], 
         Style["reactor type:", Bold], 
         Manipulate`Place[2], 
         Spacer[0], 
         Style["reaction:", Bold], 
         Manipulate`Place[3]}, Left]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`cao$$], 5, "reactant"}, 1, 5, 1}, {{
       Hold[$CellContext`cro$$], 1, "product"}, 0, 5, 1}, {
      Hold[
       Column[{
         Style["feed concentrations (mol/L)", Bold], 
         Manipulate`Place[4], 
         Manipulate`Place[5]}]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`pp$$], 100, "product"}, 20, 200, 1}, {{
       Hold[$CellContext`pr$$], 10, "reactant"}, 1, 20, 0.5}, {{
       Hold[$CellContext`reactorprice$$], 5, "reactor"}, 1, 10, 1}, {{
       Hold[$CellContext`op$$], False, "optimize"}, {True, False}}, {{
       Hold[$CellContext`op$$], False, "optimize"}, {True, False}}, {
      Hold[
       PaneSelector[{1 -> Column[{
            Style["value and cost ($/mol)", Bold], 
            Manipulate`Place[6], 
            Manipulate`Place[7], 
            Style["cost ($/L/min)", Bold], 
            Manipulate`Place[8], 
            Spacer[0], 
            Manipulate`Place[9]}], 2 -> Manipulate`Place[10]}, 
        Dynamic[$CellContext`gt$$]]], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`vrpt$$], {50, 0}}, {1, -25000}, {1000, 10000}}}, 
    Typeset`size$$ = {382., {128., 135.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`ptv$28098$$ = False, $CellContext`gt$28099$$ = 
    False, $CellContext`cs$28100$$ = False, $CellContext`ag$28101$$ = 
    False, $CellContext`cao$28102$$ = 0, $CellContext`cro$28103$$ = 
    0, $CellContext`pp$28104$$ = 0, $CellContext`pr$28105$$ = 
    0, $CellContext`reactorprice$28106$$ = 0, $CellContext`op$28107$$ = 
    False, $CellContext`vrpt$28108$$ = {0, 0}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`ag$$ = 1, $CellContext`cao$$ = 
        5, $CellContext`cro$$ = 1, $CellContext`cs$$ = 1, $CellContext`gt$$ = 
        1, $CellContext`op$$ = False, $CellContext`pp$$ = 
        100, $CellContext`pr$$ = 10, $CellContext`ptv$$ = 
        1, $CellContext`reactorprice$$ = 5, $CellContext`vrpt$$ = {50, 0}}, 
      "ControllerVariables" :> {
        Hold[$CellContext`ptv$$, $CellContext`ptv$28098$$, False], 
        Hold[$CellContext`gt$$, $CellContext`gt$28099$$, False], 
        Hold[$CellContext`cs$$, $CellContext`cs$28100$$, False], 
        Hold[$CellContext`ag$$, $CellContext`ag$28101$$, False], 
        Hold[$CellContext`cao$$, $CellContext`cao$28102$$, 0], 
        Hold[$CellContext`cro$$, $CellContext`cro$28103$$, 0], 
        Hold[$CellContext`pp$$, $CellContext`pp$28104$$, 0], 
        Hold[$CellContext`pr$$, $CellContext`pr$28105$$, 0], 
        Hold[$CellContext`reactorprice$$, $CellContext`reactorprice$28106$$, 
         0], 
        Hold[$CellContext`op$$, $CellContext`op$28107$$, False], 
        Hold[$CellContext`vrpt$$, $CellContext`vrpt$28108$$, {0, 0}]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`vr$, $CellContext`k$, $CellContext`vo$, \
$CellContext`Fao$, $CellContext`Fro$, $CellContext`Ca$, $CellContext`Cr$, \
$CellContext`s$, $CellContext`conversion$, $CellContext`profit$, \
$CellContext`optimalvolume$, $CellContext`concA$, $CellContext`concR$, \
$CellContext`concplot$, $CellContext`profitplot$}, 
        If[$CellContext`ptv$$ == 
         1, {$CellContext`vr$ := 
           If[$CellContext`op$$, $CellContext`optimalvolume$, 
             Part[$CellContext`vrpt$$, 1]]; $CellContext`k$ = 
           0.1; $CellContext`vo$ = 
           10; $CellContext`Fao$ = $CellContext`cao$$ $CellContext`vo$; \
$CellContext`Fro$ = $CellContext`cro$$ $CellContext`vo$; $CellContext`Ca$ = \
$CellContext`Fa[$CellContext`z]/$CellContext`vo$; $CellContext`Cr$ = \
$CellContext`Fr[$CellContext`z]/$CellContext`vo$; $CellContext`s$ = NDSolve[{
              
              If[$CellContext`ag$$ == 1, 
               Derivative[
                1][$CellContext`Fa][$CellContext`z] == (-$CellContext`k$) \
$CellContext`Ca$, 
               Derivative[
                1][$CellContext`Fa][$CellContext`z] == (-$CellContext`k$) \
$CellContext`Ca$ $CellContext`Cr$], 
              
              If[$CellContext`ag$$ == 1, 
               Derivative[
                1][$CellContext`Fr][$CellContext`z] == $CellContext`k$ \
$CellContext`Ca$, 
               Derivative[
                1][$CellContext`Fr][$CellContext`z] == $CellContext`k$ \
$CellContext`Ca$ $CellContext`Cr$], $CellContext`Fa[
               0] == $CellContext`Fao$, $CellContext`Fr[
               0] == $CellContext`Fro$}, {$CellContext`Fa, $CellContext`Fr}, \
{$CellContext`z, 0, 1000}]; $CellContext`conversion$[
             Pattern[$CellContext`z$, 
              Blank[]]] = 
           Which[$CellContext`cs$$ == 2, ($CellContext`Fao$ - Part[
               Evaluate[
                ReplaceAll[
                 $CellContext`Fa[$CellContext`z$], $CellContext`s$]], 
               1])/$CellContext`Fao$, 
             
             And[$CellContext`ag$$ == 1, $CellContext`cs$$ == 
              1], $CellContext`k$ ($CellContext`z$/($CellContext`k$ \
$CellContext`z$ + $CellContext`vo$)), 
             And[$CellContext`ag$$ == 2, $CellContext`cs$$ == 1], 
             1 - $CellContext`vo$/($CellContext`z$ $CellContext`k$ \
$CellContext`cao$$)]; $CellContext`profit$[
             Pattern[$CellContext`z$, 
              Blank[]]] = If[$CellContext`cs$$ == 2, Part[
                Evaluate[
                 ReplaceAll[
                  $CellContext`Fr[$CellContext`z$], $CellContext`s$]], 
                1] $CellContext`pp$$ - $CellContext`Fro$ $CellContext`pp$$ - \
$CellContext`Fao$ $CellContext`pr$$ - $CellContext`reactorprice$$ \
$CellContext`z$, $CellContext`pp$$ $CellContext`conversion$[$CellContext`z$] \
$CellContext`Fao$ - $CellContext`Fro$ $CellContext`pp$$ - $CellContext`Fao$ \
$CellContext`pr$$ - $CellContext`reactorprice$$ $CellContext`z$]; \
$CellContext`optimalvolume$ = If[Sum[
               $CellContext`conversion$[$CellContext`z], {$CellContext`z, 1, 
                1000}] == 0, 1, 
             ReplaceAll[$CellContext`z, 
              Quiet[
               Part[
                FindMaximum[
                 $CellContext`profit$[$CellContext`z], {$CellContext`z, 1, 1, 
                  1000}], 2]]]]; $CellContext`concA$[
             Pattern[$CellContext`z$, 
              Blank[]]] = If[$CellContext`cs$$ == 2, Part[
               Evaluate[
                ReplaceAll[
                 $CellContext`Fa[$CellContext`z$], $CellContext`s$]], 
               1]/$CellContext`vo$, $CellContext`cao$$ (
              1 - $CellContext`conversion$[$CellContext`z$])]; \
$CellContext`concR$[
             Pattern[$CellContext`z$, 
              Blank[]]] = If[$CellContext`cs$$ == 2, Part[
               Evaluate[
                ReplaceAll[
                 $CellContext`Fr[$CellContext`z$], $CellContext`s$]], 
               1]/$CellContext`vo$, $CellContext`cro$$ + $CellContext`cao$$ \
$CellContext`conversion$[$CellContext`z$]]; $CellContext`concplot$ = Show[
             Plot[{
               $CellContext`concA$[$CellContext`z], 
               $CellContext`concR$[$CellContext`z]}, {$CellContext`z, 
               0, $CellContext`vr$}, 
              PlotStyle -> {{Thick, Blue}, {Thick, Black}}], 
             Graphics[{
               Text[
                Style["reactant", 17, Blue, Background -> White], {
                0.33 $CellContext`vr$, 
                 $CellContext`concA$[0.33 $CellContext`vr$]}], 
               Text[
                Style["product", 17, Background -> White], {
                0.67 $CellContext`vr$, 
                 $CellContext`concR$[0.67 $CellContext`vr$]}]}], FrameLabel -> {
               Style["reactor volume (L)", 17], 
               Style["concentration  (mol/L)", 17]}, PlotRange -> All, 
             ImagePadding -> {{50, 15}, {45, 10}}]; $CellContext`profitplot$ = 
           Show[
             Plot[
              $CellContext`profit$[$CellContext`z], {$CellContext`z, 0, 1000},
               PlotStyle -> {Thick, 
                RGBColor[0., 0.54, 0.]}], 
             Graphics[{
               PointSize[0.03], 
               Point[{$CellContext`vr$, 
                 $CellContext`profit$[$CellContext`vr$]}]}], FrameLabel -> {
               Style["reactor volume (L)", 17], 
               Style["profit  ($/min)", 17]}, PlotRange -> All, 
             PlotRangePadding -> {{10, 10}, {
                Scaled[0.01], 
                Scaled[0.1]}}, ImagePadding -> {{75, 15}, {45, 10}}]; Column[{
             Show[
              
              Switch[$CellContext`gt$$, 1, $CellContext`profitplot$, 
               2, $CellContext`concplot$], ImageSize -> {400, 325}, 
              AspectRatio -> Full, Frame -> True, LabelStyle -> {Black, 14}, 
              Axes -> False], 
             Spacer[10], 
             Text[
              Style[
               Row[{"profit = ", 
                 If[$CellContext`profit$[$CellContext`vr$] < 0, "-$", "$"], 
                 NumberForm[
                  Round[
                   Abs[
                    $CellContext`profit$[$CellContext`vr$]]], DigitBlock -> 
                  3], "/min", 
                 Spacer[25], "conversion = ", 
                 NumberForm[
                  $CellContext`conversion$[$CellContext`vr$], {2, 2}]}], 
               18]]}, Center]}, {$CellContext`vr$ := 
           Part[$CellContext`vrpt$$, 1]; $CellContext`vo$ = 
           10; $CellContext`k$ = 
           0.1; $CellContext`Fao$ = $CellContext`cao$$ $CellContext`vo$; \
$CellContext`Fro$ = $CellContext`cro$$ $CellContext`vo$; $CellContext`Ca$ = \
$CellContext`Fa[$CellContext`z]/$CellContext`vo$; $CellContext`Cr$ = \
$CellContext`Fr[$CellContext`z]/$CellContext`vo$; $CellContext`s$ = NDSolve[{
              
              If[$CellContext`ag$$ == 1, 
               Derivative[
                1][$CellContext`Fa][$CellContext`z] == (-$CellContext`k$) \
$CellContext`Ca$, 
               Derivative[
                1][$CellContext`Fa][$CellContext`z] == (-$CellContext`k$) \
$CellContext`Ca$ $CellContext`Cr$], 
              
              If[$CellContext`ag$$ == 1, 
               Derivative[
                1][$CellContext`Fr][$CellContext`z] == $CellContext`k$ \
$CellContext`Ca$, 
               Derivative[
                1][$CellContext`Fr][$CellContext`z] == $CellContext`k$ \
$CellContext`Ca$ $CellContext`Cr$], $CellContext`Fa[
               0] == $CellContext`Fao$, $CellContext`Fr[
               0] == $CellContext`Fro$}, {$CellContext`Fa, $CellContext`Fr}, \
{$CellContext`z, 0, 1000}]; $CellContext`conversion$[
             Pattern[$CellContext`z$, 
              Blank[]]] = 
           Which[$CellContext`cs$$ == 2, ($CellContext`Fao$ - Part[
               Evaluate[
                ReplaceAll[
                 $CellContext`Fa[$CellContext`z$], $CellContext`s$]], 
               1])/$CellContext`Fao$, 
             
             And[$CellContext`ag$$ == 1, $CellContext`cs$$ == 
              1], $CellContext`k$ ($CellContext`z$/($CellContext`k$ \
$CellContext`z$ + $CellContext`vo$)), 
             And[$CellContext`ag$$ == 2, $CellContext`cs$$ == 1], 
             1 - $CellContext`vo$/($CellContext`z$ $CellContext`k$ \
$CellContext`cao$$)]; $CellContext`profit$[
             Pattern[$CellContext`z$, 
              Blank[]], 
             Pattern[$CellContext`pp$, 
              Blank[]], 
             Pattern[$CellContext`pr$, 
              Blank[]], 
             Pattern[$CellContext`reactorprice$, 
              Blank[]]] = If[$CellContext`cs$$ == 2, Part[
                Evaluate[
                 ReplaceAll[
                  $CellContext`Fr[$CellContext`z$], $CellContext`s$]], 
                1] $CellContext`pp$ - $CellContext`Fro$ $CellContext`pp$ - \
$CellContext`Fao$ $CellContext`pr$ - $CellContext`reactorprice$ \
$CellContext`z$, $CellContext`pp$ $CellContext`conversion$[$CellContext`z$] \
$CellContext`Fao$ - $CellContext`Fro$ $CellContext`pp$ - $CellContext`Fao$ \
$CellContext`pr$ - $CellContext`reactorprice$ $CellContext`z$]; \
$CellContext`optimalvolume$ = ReplaceAll[$CellContext`z, 
             Quiet[
              FindRoot[D[
                 If[$CellContext`cs$$ == 2, Part[
                    Evaluate[
                    ReplaceAll[
                    $CellContext`Fr[$CellContext`z], $CellContext`s$]], 
                    1] $CellContext`pp$$ - $CellContext`Fro$ \
$CellContext`pp$$ - $CellContext`Fao$ $CellContext`pr$$ - \
$CellContext`reactorprice$$ $CellContext`z, $CellContext`pp$$ \
$CellContext`conversion$[$CellContext`z] $CellContext`Fao$ - \
$CellContext`Fro$ $CellContext`pp$$ - $CellContext`Fao$ $CellContext`pr$$ - \
$CellContext`reactorprice$$ $CellContext`z], $CellContext`z] == 
               0, {$CellContext`z, 1, 1, 1000}]]]; 
          If[$CellContext`op$$, $CellContext`vr$ = \
$CellContext`optimalvolume$]; $CellContext`concA$[
             Pattern[$CellContext`z$, 
              Blank[]]] = If[$CellContext`cs$$ == 2, Part[
               Evaluate[
                ReplaceAll[
                 $CellContext`Fa[$CellContext`z$], $CellContext`s$]], 
               1]/$CellContext`vo$, $CellContext`cao$$ (
              1 - $CellContext`conversion$[$CellContext`z$])]; \
$CellContext`concR$[
             Pattern[$CellContext`z$, 
              Blank[]]] = If[$CellContext`cs$$ == 2, Part[
               Evaluate[
                ReplaceAll[
                 $CellContext`Fr[$CellContext`z$], $CellContext`s$]], 
               1]/$CellContext`vo$, $CellContext`cro$$ + $CellContext`cao$$ \
$CellContext`conversion$[$CellContext`z$]]; $CellContext`concplot$ = Show[
             Plot[{
               $CellContext`concA$[$CellContext`z], 
               $CellContext`concR$[$CellContext`z]}, {$CellContext`z, 
               0, $CellContext`vr$}, Frame -> True, LabelStyle -> 14, 
              ImageSize -> Medium, 
              FrameLabel -> {
               "reactor volume(L)", 
                "concentration (M)"}]]; $CellContext`profitplot$ = Show[
             Plot[
              $CellContext`profit$[$CellContext`z, $CellContext`pp$$, \
$CellContext`pr$$, $CellContext`reactorprice$$], {$CellContext`z, 0, 1000}, 
              FrameLabel -> {"reactor volume (L)", "profit (dollars/min)"}, 
              Frame -> True, LabelStyle -> 14, ImageSize -> Medium, 
              PlotRangePadding -> None], 
             Graphics[{{
                PointSize[0.02], 
                Point[{
                  
                  If[$CellContext`op$$, $CellContext`optimalvolume$, \
$CellContext`vr$], 
                  If[$CellContext`op$$, 
                   $CellContext`profit$[$CellContext`optimalvolume$, \
$CellContext`pp$$, $CellContext`pr$$, $CellContext`reactorprice$$], 
                   $CellContext`profit$[$CellContext`vr$, $CellContext`pp$$, \
$CellContext`pr$$, $CellContext`reactorprice$$]]}]}}]]; Column[{
             Show[
              
              Switch[$CellContext`gt$$, 1, $CellContext`profitplot$, 
               2, $CellContext`concplot$], PlotRange -> All, PlotLabel -> 
              Style[$CellContext`vr$, 17, Black]], 
             Text[
              Style[
               Row[{" profit = ", 
                 NumberForm[
                  $CellContext`profit$[
                   
                   If[$CellContext`op$$, $CellContext`optimalvolume$, \
$CellContext`vr$], $CellContext`pp$$, $CellContext`pr$$, \
$CellContext`reactorprice$$], {4, 2}], "$/min", 
                 Spacer[25], "conversion = ", 
                 NumberForm[
                  $CellContext`conversion$[
                   
                   If[$CellContext`op$$, $CellContext`optimalvolume$, \
$CellContext`vr$]], {2, 2}]}], 18]]}, Center]}]], 
      "Specifications" :> {{{$CellContext`ptv$$, 1, ""}, {1 -> "R", 2 -> "G"},
          ControlType -> Setter}, 
        Delimiter, {{$CellContext`gt$$, 1, ""}, {
         1 -> "profit", 2 -> "concentration"}, ControlType -> RadioButton, 
         ControlPlacement -> 1}, {{$CellContext`cs$$, 1, ""}, {
         1 -> "CSTR", 2 -> "PFR"}, ControlType -> RadioButton, 
         ControlPlacement -> 2}, {{$CellContext`ag$$, 1, ""}, {
         1 -> "first order", 2 -> "autocatalytic"}, ControlType -> 
         RadioButton, ControlPlacement -> 3}, 
        Column[{
          Style["select a plot:", Bold], 
          Manipulate`Place[1], 
          Spacer[0], 
          Style["reactor type:", Bold], 
          Manipulate`Place[2], 
          Spacer[0], 
          Style["reaction:", Bold], 
          Manipulate`Place[3]}, Left], 
        Delimiter, {{$CellContext`cao$$, 5, "reactant"}, 1, 5, 1, Appearance -> 
         "Labeled", ImageSize -> Tiny, ControlPlacement -> 
         4}, {{$CellContext`cro$$, 1, "product"}, 0, 5, 1, Appearance -> 
         "Labeled", ImageSize -> Tiny, ControlPlacement -> 5}, 
        Column[{
          Style["feed concentrations (mol/L)", Bold], 
          Manipulate`Place[4], 
          Manipulate`Place[5]}], 
        Delimiter, {{$CellContext`pp$$, 100, "product"}, 20, 200, 1, 
         Appearance -> "Labeled", ImageSize -> Tiny, ControlPlacement -> 
         6}, {{$CellContext`pr$$, 10, "reactant"}, 1, 20, 0.5, Appearance -> 
         "Labeled", ImageSize -> Tiny, ControlPlacement -> 
         7}, {{$CellContext`reactorprice$$, 5, "reactor"}, 1, 10, 1, 
         Appearance -> "Labeled", ImageSize -> Tiny, ControlPlacement -> 
         8}, {{$CellContext`op$$, False, "optimize"}, {True, False}, 
         ControlPlacement -> 9}, {{$CellContext`op$$, False, "optimize"}, {
         True, False}, ControlPlacement -> 10}, 
        PaneSelector[{1 -> Column[{
             Style["value and cost ($/mol)", Bold], 
             Manipulate`Place[6], 
             Manipulate`Place[7], 
             Style["cost ($/L/min)", Bold], 
             Manipulate`Place[8], 
             Spacer[0], 
             Manipulate`Place[9]}], 2 -> Manipulate`Place[10]}, 
         Dynamic[$CellContext`gt$$]], {{$CellContext`vrpt$$, {50, 0}}, {
         1, -25000}, {1000, 10000}, ControlType -> Locator, Appearance -> 
         None}}, "Options" :> {ControlPlacement -> Left}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{620., {207., 214.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.6477962718890657`*^9, 3.647796296396467*^9}, 
   3.6477963773880997`*^9, 3.647796446850073*^9, 3.647796577599551*^9, {
   3.6477967076669908`*^9, 3.6477967327834272`*^9}, 3.6477991824155383`*^9}]
}, Open  ]]
},
WindowSize->{1366, 686},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 7, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 36542, 846, 2652, "Input"],
Cell[37125, 870, 20235, 406, 438, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
