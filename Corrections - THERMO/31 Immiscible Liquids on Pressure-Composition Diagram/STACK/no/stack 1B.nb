(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     90388,       2171]
NotebookOptionsPosition[     89403,       2131]
NotebookOutlinePosition[     89747,       2146]
CellTagsIndexPosition[     89704,       2143]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Code to Get Correct Behavior", "Section",
 CellChangeTimes->{{3.68053021067802*^9, 3.680530227551985*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "T", ",", "Psat", ",", "P", ",", "xp", ",", "Py1", ",", "Py2", ",", 
       "height", ",", "P1", ",", "P2", ",", "stop", ",", "phase", ",", 
       "view1", ",", "view2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T", "=", "124"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Psat", "[", "1", "]"}], "=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"4.72583", "-", 
          RowBox[{"1660.652", "/", 
           RowBox[{"(", 
            RowBox[{"T", "+", "271.5"}], ")"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Psat", "[", "2", "]"}], "=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"5.0768", "-", 
          RowBox[{"1659.793", "/", 
           RowBox[{"(", 
            RowBox[{"T", "+", "227.1"}], ")"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"P", "=", 
       RowBox[{"p", "/.", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Psat", "[", "1", "]"}], "/", "p"}], "\[Equal]", 
           RowBox[{"1", "-", 
            RowBox[{
             RowBox[{"Psat", "[", "2", "]"}], "/", "p"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"p", ",", "0.01"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xp", "=", 
       RowBox[{
        RowBox[{"Psat", "[", "1", "]"}], "/", "P"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Py1", "[", "y_", "]"}], ":=", 
       RowBox[{
        RowBox[{"Psat", "[", "1", "]"}], "/", "y"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Py2", "[", "y_", "]"}], ":=", 
       RowBox[{
        RowBox[{"Psat", "[", "2", "]"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "y"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"height", "=", 
       RowBox[{"6.5", "-", "pistonheight"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"P1", "=", 
       RowBox[{"height", "+", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"P2", "=", "height"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"stop", "[", "loc_", "]"}], ":=", 
       RowBox[{
        RowBox[{"P2", "\[LessEqual]", "loc"}], "\[And]", 
        RowBox[{"P1", ">", "loc"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phase", "=", 
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Py2", "[", "comp", "]"}], ",", 
            RowBox[{"0", "\[LessEqual]", "comp", "\[LessEqual]", "xp"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Py1", "[", "comp", "]"}], ",", 
            RowBox[{"xp", "<", "comp", "\[LessEqual]", "1"}]}], "}"}]}], 
         "}"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"0", "<", "comp", "<", "1"}], ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"step", "\[Equal]", "0"}], "\[Or]", 
               RowBox[{"step", "\[Equal]", "10"}]}], ")"}], "\[And]", 
             RowBox[{"P2", ">", "P"}]}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"location", "=", "P2"}], ",", 
              RowBox[{"step", "=", "0"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"step", "\[Equal]", "0"}], "\[Or]", 
               RowBox[{"step", "\[Equal]", "2"}]}], ")"}], "\[And]", 
             RowBox[{"stop", "[", "P", "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"location", "=", "P"}], ",", 
              RowBox[{"step", "=", "10"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", "*)"}], 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"step", "\[Equal]", "4"}], "\[Or]", 
               RowBox[{"step", "\[Equal]", "10"}]}], ")"}], "\[And]", 
             RowBox[{"stop", "[", "P", "]"}], "\[And]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"phase", "-", "P"}], "]"}], "\[LessEqual]", "0.2"}], 
              ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"location", "=", "P"}], ",", 
              RowBox[{"step", "=", "14"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", "*)"}], 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"step", "\[Equal]", "14"}], ",", 
            RowBox[{"location", "=", "P"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", "*)"}], 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"step", "\[Equal]", "14"}], "\[And]", 
             RowBox[{"P1", "<", "P"}]}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"location", "=", "P1"}], ",", 
              RowBox[{"step", "=", "2"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", "*)"}], 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"step", "\[Equal]", "14"}], "\[And]", 
             RowBox[{"P2", ">", "P"}], "\[And]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"phase", "-", "P"}], "]"}], "\[LessEqual]", "0.2"}], 
              ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"location", "=", "P2"}], ",", 
              RowBox[{"step", "=", "0"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"step", "\[Equal]", "10"}], ",", 
            RowBox[{"location", "=", "P"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"step", "\[Equal]", "10"}], "\[Or]", 
               RowBox[{"step", "\[Equal]", "4"}]}], ")"}], "\[And]", 
             RowBox[{"phase", "\[LessEqual]", "P1", "<", "P"}]}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"location", "=", "P1"}], ",", 
              RowBox[{"step", "=", "2"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"step", "\[Equal]", "2"}], ",", 
            RowBox[{"location", "=", "P1"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"step", "\[Equal]", "2"}], "\[And]", 
             RowBox[{"P1", "<", "phase"}]}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"location", "=", "P1"}], ",", 
              RowBox[{"step", "=", "4"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"step", "\[Equal]", "4"}], ",", 
            RowBox[{"location", "=", "P1"}]}], "]"}]}], "\[IndentingNewLine]",
          "}"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"comp", "\[Equal]", "0"}], "\[Or]", 
         RowBox[{"comp", "\[Equal]", "1"}]}], ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"step", "\[Equal]", "0"}], "\[Or]", 
               RowBox[{"step", "\[Equal]", "1"}], "\[Or]", 
               RowBox[{"step", "\[Equal]", "3"}]}], ")"}], "\[And]", 
             RowBox[{"P2", ">", "P"}]}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"location", "=", "P2"}], ",", 
              RowBox[{"step", "=", "0"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"step", "\[Equal]", "0"}], "\[Or]", 
               RowBox[{"step", "\[Equal]", "11"}], "\[Or]", 
               RowBox[{"step", "\[Equal]", "13"}]}], ")"}], "\[And]", 
             RowBox[{"phase", "<", "P2", "\[LessEqual]", "P"}]}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"location", "=", "P2"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"comp", "\[Equal]", "0"}], ",", 
                RowBox[{"step", "=", "1"}], ",", 
                RowBox[{"step", "=", "3"}]}], "]"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"step", "\[Equal]", "1"}], "\[Or]", 
              RowBox[{"step", "\[Equal]", "3"}]}], ")"}], ",", 
            RowBox[{"location", "=", "P2"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"step", "\[Equal]", "1"}], "\[Or]", 
               RowBox[{"step", "\[Equal]", "3"}], "\[Or]", 
               RowBox[{"step", "\[Equal]", "4"}]}], ")"}], "\[And]", 
             RowBox[{"stop", "[", "phase", "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"location", "=", "phase"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"comp", "\[Equal]", "0"}], ",", 
                RowBox[{"step", "=", "11"}], ",", 
                RowBox[{"step", "=", "13"}]}], "]"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"step", "\[Equal]", "11"}], "\[Or]", 
               RowBox[{"step", "\[Equal]", "13"}]}], ")"}], "\[And]", 
             RowBox[{"P1", "<", "phase"}]}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"location", "=", "P1"}], ",", 
              RowBox[{"step", "=", "4"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"step", "\[Equal]", "4"}], ",", 
            RowBox[{"location", "=", "P1"}]}], "]"}]}], "\[IndentingNewLine]",
          "}"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"view2", "=", 
       RowBox[{"Graphics3D", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Opacity", "@", "0.3"}], ",", "Green", ",", 
             RowBox[{"Cylinder", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", 
                  RowBox[{"5.5", "*", 
                   RowBox[{"Log10", "[", 
                    RowBox[{"1", "+", "pistonheight"}], "]"}]}]}], "}"}]}], 
               "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Opacity", "@", "0.5"}], ",", 
             RowBox[{"Cylinder", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", 
                  RowBox[{"5.5", "*", 
                   RowBox[{"Log10", "[", 
                    RowBox[{"1", "+", "pistonheight"}], "]"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "5.5"}], "}"}]}], "}"}], "]"}]}],
             "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"GrayLevel", "@", "0.3"}], ",", 
             RowBox[{"Cylinder", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", 
                  RowBox[{"5.5", "*", 
                   RowBox[{"Log10", "[", 
                    RowBox[{"1", "+", "pistonheight"}], "]"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", 
                  RowBox[{
                   RowBox[{"5.5", "*", 
                    RowBox[{"Log10", "[", 
                    RowBox[{"1", "+", "pistonheight"}], "]"}]}], "+", 
                   "0.25"}]}], "}"}]}], "}"}], "]"}], ",", 
             RowBox[{"Cylinder", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", 
                   RowBox[{
                    RowBox[{"5.5", "*", 
                    RowBox[{"Log10", "[", 
                    RowBox[{"1", "+", "pistonheight"}], "]"}]}], "+", 
                    "0.25"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "6"}], "}"}]}], "}"}], ",", 
               "0.17"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<log volume\>\"", ",", "17"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"150", ",", "350"}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "0.5"}], ",", "6"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
         RowBox[{"ViewPoint", "\[Rule]", "Front"}], ",", 
         RowBox[{"Lighting", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"\"\<Ambient\>\"", ",", "LightGray"}], "}"}], "}"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"view1", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Piecewise", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Py2", "[", "y", "]"}], ",", 
                RowBox[{"0", "\[LessEqual]", "y", "\[LessEqual]", "xp"}]}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Py1", "[", "y", "]"}], ",", 
                RowBox[{"xp", "<", "y", "\[LessEqual]", "1"}]}], "}"}]}], 
             "}"}], "]"}], ",", "P"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Purple"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "7"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<benzene mole fraction\>\"", ",", "\"\<pressure (bar)\>\""}], 
           "}"}]}], ",", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"17", ",", "Black"}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"500", ",", "350"}], "}"}]}], ",", 
         RowBox[{"PlotRangePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0.02", ",", "None"}], "}"}]}], ",", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"40", ",", "5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Epilog", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Framed", "@", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"Grid", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<step =\>\"", ",", "step"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<location =\>\"", ",", "location"}], "}"}]}], 
                    "}"}], ",", 
                   RowBox[{"Alignment", "\[Rule]", "\"\<=\>\""}]}], "]"}], 
                 ",", "18"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"xp", ",", "1.2"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"step", "\[Equal]", "#1"}], ",", 
                RowBox[{"Text", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<wait...\>\"", ",", "20", ",", "#2"}], "]"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"comp", ",", "location"}], "}"}], ",", 
                  RowBox[{"1.5", "*", "#3"}]}], "]"}]}], "]"}], "&"}], "@@@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"10", ",", "Purple", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"11", ",", "Blue", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"13", ",", "Orange", ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"14", ",", "Magenta", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"Thick", ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "7"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"Py2", "[", "0", "]"}]}], "}"}]}], "}"}], "]"}], 
              ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", "7"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Py1", "[", "1", "]"}]}], "}"}]}], "}"}], "]"}]}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "@", "0.02"}], ",", "Blue", ",", 
              RowBox[{"Point", "[", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"Py2", "[", "0", "]"}]}], "}"}], "]"}], ",", 
              "Orange", ",", 
              RowBox[{"Point", "[", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"Py1", "[", "1", "]"}]}], "}"}], "]"}], ",", 
              "Magenta", ",", 
              RowBox[{"Point", "[", 
               RowBox[{"{", 
                RowBox[{"xp", ",", "P"}], "}"}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PointSize", "@", "0.025"}], ",", 
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{"comp", ",", "location"}], "}"}], "]"}]}], "}"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Grid", "@", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"view1", ",", "view2"}], "}"}], "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"comp", ",", "0.3", ",", "\"\<benzene composition\>\""}], 
           "}"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"step", "\[Equal]", "2"}], "\[Or]", 
              RowBox[{"step", "\[Equal]", "10"}]}], ")"}], ",", "0.01", ",", 
            "0"}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"step", "\[Equal]", "2"}], "\[Or]", 
              RowBox[{"step", "\[Equal]", "10"}]}], ")"}], ",", "0.99", ",", 
            "1"}], "]"}], ",", "0.01", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
          RowBox[{"Enabled", "\[Rule]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"step", "\[Equal]", "1"}], "\[Or]", 
              RowBox[{"step", "\[Equal]", "11"}], "\[Or]", 
              RowBox[{"step", "\[Equal]", "3"}], "\[Or]", 
              RowBox[{"step", "\[Equal]", "13"}]}], ",", "False", ",", 
             "True"}], "]"}]}]}], "}"}], "]"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "pistonheight", ",", "0.1", ",", "\"\<piston height\>\""}], "}"}],
            ",", "0.1", ",", "6.5", ",", "0.01"}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<reset to initial conditions\>\"", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"comp", "=", "0.3"}], ",", 
            RowBox[{"pistonheight", "=", "0.1"}], ",", 
            RowBox[{"location", "=", "0"}], ",", 
            RowBox[{"step", "=", "0"}]}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"location", ",", "0"}], "}"}], ",", "None"}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"step", ",", "0"}], "}"}], ",", "0", ",", "14", ",", 
           "None"}], "}"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.680527433715592*^9, 3.6805274641033297`*^9}, {
  3.680527505982725*^9, 3.6805276539781904`*^9}, {3.6805277055751414`*^9, 
  3.6805278351095505`*^9}, {3.680527871361624*^9, 3.6805278725676928`*^9}, {
  3.680528166599308*^9, 3.6805283455185413`*^9}, {3.6805284880274897`*^9, 
  3.6805285041074095`*^9}, {3.6805285933435135`*^9, 3.680528673243084*^9}, {
  3.68052873105739*^9, 3.6805287614441285`*^9}, {3.680528873299526*^9, 
  3.6805289547781863`*^9}, {3.680529102887658*^9, 3.6805291101720743`*^9}, {
  3.6805291438119984`*^9, 3.6805291816281614`*^9}, {3.6805292123809204`*^9, 
  3.680529638581298*^9}, {3.68052967866059*^9, 3.680529714881662*^9}, {
  3.6805297496126485`*^9, 3.680529788871894*^9}, {3.6805298732607207`*^9, 
  3.680529881904215*^9}, {3.680529948164005*^9, 3.6805300637426157`*^9}, {
  3.680530107331109*^9, 3.68053014337017*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`comp$$ = 0.3, $CellContext`location$$ = 
    6.4, $CellContext`pistonheight$$ = 0.1, $CellContext`step$$ = 0, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`comp$$], 0.3, "benzene composition"}, 
      Dynamic[
       If[
        Or[$CellContext`step$$ == 2, $CellContext`step$$ == 10], 0.01, 0]], 
      Dynamic[
       If[
        Or[$CellContext`step$$ == 2, $CellContext`step$$ == 10], 0.99, 1]], 
      0.01}, {{
       Hold[$CellContext`pistonheight$$], 0.1, "piston height"}, 0.1, 6.5, 
      0.01}, {{
       Hold[$CellContext`location$$], 0}, 0}, {{
       Hold[$CellContext`step$$], 0}, 0, 14}, {
      Hold[
       Grid[{{
          Manipulate`Place[1]}, {
          Manipulate`Place[2], 
          Button[
          "reset to initial conditions", {$CellContext`comp$$ = 
            0.3, $CellContext`pistonheight$$ = 0.1, $CellContext`location$$ = 
            0, $CellContext`step$$ = 0}], 
          Manipulate`Place[3], 
          Manipulate`Place[4]}}]], Manipulate`Dump`ThisIsNotAControl}}, 
    Typeset`size$$ = {659., {171.5, 178.5}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`comp$273620$$ = 0, $CellContext`pistonheight$273621$$ =
     0, $CellContext`step$273622$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`comp$$ = 0.3, $CellContext`location$$ = 
        0, $CellContext`pistonheight$$ = 0.1, $CellContext`step$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`comp$$, $CellContext`comp$273620$$, 0], 
        Hold[$CellContext`pistonheight$$, $CellContext`pistonheight$273621$$, 
         0], 
        Hold[$CellContext`step$$, $CellContext`step$273622$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`T$, $CellContext`Psat$, $CellContext`P$, \
$CellContext`xp$, $CellContext`Py1$, $CellContext`Py2$, $CellContext`height$, \
$CellContext`P1$, $CellContext`P2$, $CellContext`stop$, $CellContext`phase$, \
$CellContext`view1$, $CellContext`view2$}, $CellContext`T$ = 
         124; $CellContext`Psat$[1] = 
         10^(4.72583 - 1660.652/($CellContext`T$ + 
           271.5)); $CellContext`Psat$[2] = 
         10^(5.0768 - 1659.793/($CellContext`T$ + 227.1)); $CellContext`P$ = 
         ReplaceAll[$CellContext`p, 
           
           FindRoot[$CellContext`Psat$[1]/$CellContext`p == 
            1 - $CellContext`Psat$[2]/$CellContext`p, {$CellContext`p, 
             0.01}]]; $CellContext`xp$ = $CellContext`Psat$[
           1]/$CellContext`P$; $CellContext`Py1$[
           Pattern[$CellContext`y$, 
            Blank[]]] := $CellContext`Psat$[
           1]/$CellContext`y$; $CellContext`Py2$[
           Pattern[$CellContext`y$, 
            Blank[]]] := $CellContext`Psat$[2]/(
          1 - $CellContext`y$); $CellContext`height$ = 
         6.5 - $CellContext`pistonheight$$; $CellContext`P1$ = \
$CellContext`height$ + 
          1; $CellContext`P2$ = $CellContext`height$; $CellContext`stop$[
           Pattern[$CellContext`loc$, 
            Blank[]]] := 
         And[$CellContext`P2$ <= $CellContext`loc$, $CellContext`P1$ > \
$CellContext`loc$]; $CellContext`phase$ = Piecewise[{{
             $CellContext`Py2$[$CellContext`comp$$], 
             0 <= $CellContext`comp$$ <= $CellContext`xp$}, {
             $CellContext`Py1$[$CellContext`comp$$], 
             
             Inequality[$CellContext`xp$, Less, $CellContext`comp$$, 
              LessEqual, 1]}}]; If[0 < $CellContext`comp$$ < 1, {
           If[
            And[
             
             Or[$CellContext`step$$ == 0, $CellContext`step$$ == 
              
              10], $CellContext`P2$ > $CellContext`P$], \
{$CellContext`location$$ = $CellContext`P2$, $CellContext`step$$ = 0}], 
           If[
            And[
             Or[$CellContext`step$$ == 0, $CellContext`step$$ == 2], 
             $CellContext`stop$[$CellContext`P$]], {$CellContext`location$$ = \
$CellContext`P$, $CellContext`step$$ = 10}], 
           If[
            And[
             Or[$CellContext`step$$ == 4, $CellContext`step$$ == 10], 
             $CellContext`stop$[$CellContext`P$], 
             Abs[$CellContext`phase$ - $CellContext`P$] <= 
             0.2], {$CellContext`location$$ = $CellContext`P$, \
$CellContext`step$$ = 14}], 
           
           If[$CellContext`step$$ == 
            14, $CellContext`location$$ = $CellContext`P$], 
           If[
            
            And[$CellContext`step$$ == 
             14, $CellContext`P1$ < $CellContext`P$], \
{$CellContext`location$$ = $CellContext`P1$, $CellContext`step$$ = 2}], 
           If[
            
            And[$CellContext`step$$ == 14, $CellContext`P2$ > $CellContext`P$,
              Abs[$CellContext`phase$ - $CellContext`P$] <= 
             0.2], {$CellContext`location$$ = $CellContext`P2$, \
$CellContext`step$$ = 0}], 
           
           If[$CellContext`step$$ == 
            10, $CellContext`location$$ = $CellContext`P$], 
           If[
            And[
             Or[$CellContext`step$$ == 10, $CellContext`step$$ == 4], 
             
             Inequality[$CellContext`phase$, LessEqual, $CellContext`P1$, 
              Less, $CellContext`P$]], {$CellContext`location$$ = \
$CellContext`P1$, $CellContext`step$$ = 2}], 
           
           If[$CellContext`step$$ == 
            2, $CellContext`location$$ = $CellContext`P1$], 
           If[
            
            And[$CellContext`step$$ == 
             2, $CellContext`P1$ < $CellContext`phase$], \
{$CellContext`location$$ = $CellContext`P1$, $CellContext`step$$ = 4}], 
           
           If[$CellContext`step$$ == 
            4, $CellContext`location$$ = $CellContext`P1$]}]; If[
          Or[$CellContext`comp$$ == 0, $CellContext`comp$$ == 1], {
           If[
            And[
             
             Or[$CellContext`step$$ == 0, $CellContext`step$$ == 
              1, $CellContext`step$$ == 
              3], $CellContext`P2$ > $CellContext`P$], \
{$CellContext`location$$ = $CellContext`P2$, $CellContext`step$$ = 0}], 
           If[
            And[
             
             Or[$CellContext`step$$ == 0, $CellContext`step$$ == 
              11, $CellContext`step$$ == 13], 
             
             Inequality[$CellContext`phase$, Less, $CellContext`P2$, 
              LessEqual, $CellContext`P$]], {$CellContext`location$$ = \
$CellContext`P2$, 
             
             If[$CellContext`comp$$ == 0, $CellContext`step$$ = 
              1, $CellContext`step$$ = 3]}], 
           If[
            
            Or[$CellContext`step$$ == 1, $CellContext`step$$ == 
             3], $CellContext`location$$ = $CellContext`P2$], 
           If[
            And[
             
             Or[$CellContext`step$$ == 1, $CellContext`step$$ == 
              3, $CellContext`step$$ == 4], 
             $CellContext`stop$[$CellContext`phase$]], \
{$CellContext`location$$ = $CellContext`phase$, 
             
             If[$CellContext`comp$$ == 0, $CellContext`step$$ = 
              11, $CellContext`step$$ = 13]}], 
           If[
            And[
             
             Or[$CellContext`step$$ == 11, $CellContext`step$$ == 
              13], $CellContext`P1$ < $CellContext`phase$], \
{$CellContext`location$$ = $CellContext`P1$, $CellContext`step$$ = 4}], 
           
           If[$CellContext`step$$ == 
            4, $CellContext`location$$ = $CellContext`P1$]}]; \
$CellContext`view2$ = Graphics3D[{{
             Opacity[0.3], Green, 
             
             Cylinder[{{0, 0, 0}, {
               0, 0, 5.5 Log10[1 + $CellContext`pistonheight$$]}}]}, {
             Opacity[0.5], 
             
             Cylinder[{{0, 0, 5.5 Log10[1 + $CellContext`pistonheight$$]}, {
               0, 0, 5.5}}]}, {
             GrayLevel[0.3], 
             
             Cylinder[{{0, 0, 5.5 Log10[1 + $CellContext`pistonheight$$]}, {
               0, 0, 5.5 Log10[1 + $CellContext`pistonheight$$] + 0.25}}], 
             
             Cylinder[{{
               0, 0, 5.5 Log10[1 + $CellContext`pistonheight$$] + 0.25}, {0, 
               0, 6}}, 0.17]}, 
            Text[
             Style["log volume", 17], {0, -1, 0}, {0, 1}]}, 
           ImageSize -> {150, 350}, 
           PlotRange -> {{-1, 1}, {-1, 1}, {-0.5, 6}}, Boxed -> False, 
           ViewPoint -> Front, 
           Lighting -> {{"Ambient", LightGray}}]; $CellContext`view1$ = Plot[{
            Piecewise[{{
               $CellContext`Py2$[$CellContext`y], 
               0 <= $CellContext`y <= $CellContext`xp$}, {
               $CellContext`Py1$[$CellContext`y], 
               
               Inequality[$CellContext`xp$, Less, $CellContext`y, LessEqual, 
                1]}}], $CellContext`P$}, {$CellContext`y, 0, 1}, 
           PlotStyle -> {{Thick, Black}, {Thick, Purple}}, 
           PlotRange -> {{0, 1}, {0.5, 7}}, Frame -> True, 
           FrameLabel -> {"benzene mole fraction", "pressure (bar)"}, 
           LabelStyle -> {17, Black}, ImageSize -> {500, 350}, 
           PlotRangePadding -> {0.02, None}, 
           ImagePadding -> {{40, 5}, {50, 10}}, Epilog -> {
             Text[
              Framed[
               Style[
                
                Grid[{{"step =", $CellContext`step$$}, {
                  "location =", $CellContext`location$$}}, Alignment -> "="], 
                18]], {$CellContext`xp$, 1.2}], 
             Apply[If[$CellContext`step$$ == #, 
               Text[
                Style[
                "wait...", 
                 20, #2], {$CellContext`comp$$, $CellContext`location$$}, 
                1.5 #3]]& , {{10, Purple, {-1, -1}}, {11, Blue, {-1, 1}}, {
               13, Orange, {1, 1}}, {14, Magenta, {-1, -1}}}, {1}], {Thick, 
              Line[{{0, 7}, {0, 
                 $CellContext`Py2$[0]}}], 
              Line[{{1, 7}, {1, 
                 $CellContext`Py1$[1]}}]}, {
              PointSize[0.02], Blue, 
              Point[{0, 
                $CellContext`Py2$[0]}], Orange, 
              Point[{1, 
                $CellContext`Py1$[1]}], Magenta, 
              Point[{$CellContext`xp$, $CellContext`P$}]}, 
             PointSize[0.025], 
             Point[{$CellContext`comp$$, $CellContext`location$$}]}]; 
        Grid[{{$CellContext`view1$, $CellContext`view2$}}]], 
      "Specifications" :> {{{$CellContext`comp$$, 0.3, "benzene composition"}, 
         Dynamic[
          If[
           Or[$CellContext`step$$ == 2, $CellContext`step$$ == 10], 0.01, 0]], 
         Dynamic[
          If[
           Or[$CellContext`step$$ == 2, $CellContext`step$$ == 10], 0.99, 1]],
          0.01, Appearance -> "Labeled", Enabled -> Dynamic[
           If[
            
            Or[$CellContext`step$$ == 1, $CellContext`step$$ == 
             11, $CellContext`step$$ == 3, $CellContext`step$$ == 13], False, 
            True]], ControlPlacement -> 
         1}, {{$CellContext`pistonheight$$, 0.1, "piston height"}, 0.1, 6.5, 
         0.01, ControlPlacement -> 2}, {{$CellContext`location$$, 0}, 0, 
         ControlType -> None, ControlPlacement -> 
         3}, {{$CellContext`step$$, 0}, 0, 14, ControlType -> None, 
         ControlPlacement -> 4}, 
        Grid[{{
           Manipulate`Place[1]}, {
           Manipulate`Place[2], 
           Button[
           "reset to initial conditions", {$CellContext`comp$$ = 
             0.3, $CellContext`pistonheight$$ = 0.1, $CellContext`location$$ = 
             0, $CellContext`step$$ = 0}], 
           Manipulate`Place[3], 
           Manipulate`Place[4]}}]}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{710., {234., 241.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.680527421236878*^9, {3.6805275622559443`*^9, 3.6805275785258746`*^9}, 
   3.680527665184831*^9, 3.680527714919676*^9, 3.6805279302619925`*^9, {
   3.680528633024783*^9, 3.6805286631875086`*^9}, {3.6805289002520676`*^9, 
   3.6805289261065464`*^9}, 3.6805289579573684`*^9, 3.6805291120571823`*^9, {
   3.680529162691078*^9, 3.6805291821481915`*^9}, {3.6805292418446054`*^9, 
   3.680529270255231*^9}, {3.680529321168143*^9, 3.6805294373567886`*^9}, {
   3.6805296276216707`*^9, 3.6805296424935217`*^9}, 3.680529808195999*^9, 
   3.680529910754865*^9, {3.6805299511261744`*^9, 3.6805299969637957`*^9}, 
   3.6805300316687813`*^9, 3.680530065480715*^9, {3.6805301147945356`*^9, 
   3.6805301438891997`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Get Code Ready for Using ",
 StyleBox["Animate",
  FontSlant->"Italic"],
 " - One Direction"
}], "Section",
 CellChangeTimes->{{3.68053021067802*^9, 3.6805302538834915`*^9}, {
  3.680532350858224*^9, 3.6805323897914515`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "T", ",", "Psat", ",", "P", ",", "xp", ",", "Py1", ",", "Py2", ",", 
       "height", ",", "view1", ",", "view2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T", "=", "124"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Psat", "[", "1", "]"}], "=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"4.72583", "-", 
          RowBox[{"1660.652", "/", 
           RowBox[{"(", 
            RowBox[{"T", "+", "271.5"}], ")"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Psat", "[", "2", "]"}], "=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"5.0768", "-", 
          RowBox[{"1659.793", "/", 
           RowBox[{"(", 
            RowBox[{"T", "+", "227.1"}], ")"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"P", "=", 
       RowBox[{"p", "/.", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Psat", "[", "1", "]"}], "/", "p"}], "\[Equal]", 
           RowBox[{"1", "-", 
            RowBox[{
             RowBox[{"Psat", "[", "2", "]"}], "/", "p"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"p", ",", "0.01"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xp", "=", 
       RowBox[{
        RowBox[{"Psat", "[", "1", "]"}], "/", "P"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Py1", "[", "y_", "]"}], ":=", 
       RowBox[{
        RowBox[{"Psat", "[", "1", "]"}], "/", "y"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Py2", "[", "y_", "]"}], ":=", 
       RowBox[{
        RowBox[{"Psat", "[", "2", "]"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "y"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"height", "=", 
       RowBox[{"6.5", "-", "pistonheight"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"view1", "[", "comp_", "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"P1", ",", "P2", ",", "location"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"P1", "=", 
           RowBox[{"height", "+", "1"}]}], ";", 
          RowBox[{"P2", "=", "height"}], ";", "\[IndentingNewLine]", 
          RowBox[{"location", "=", 
           RowBox[{"Piecewise", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"P2", ",", 
                RowBox[{"P", "<", "P2"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"P", ",", 
                RowBox[{
                 RowBox[{"P", "\[GreaterEqual]", "P2"}], "\[And]", 
                 RowBox[{"P", "\[LessEqual]", "P1"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"P1", ",", 
                RowBox[{"P", ">", "P1"}]}], "}"}]}], "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Show", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Piecewise", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Py2", "[", "y", "]"}], ",", 
                    RowBox[{
                    "0", "\[LessEqual]", "y", "\[LessEqual]", "xp"}]}], "}"}],
                    ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Py1", "[", "y", "]"}], ",", 
                    RowBox[{"xp", "<", "y", "\[LessEqual]", "1"}]}], "}"}]}], 
                  "}"}], "]"}], ",", "P"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "0", ",", "1"}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Thick", ",", "Purple"}], "}"}]}], "}"}]}], ",", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0.5", ",", "7"}], "}"}]}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Frame", "\[Rule]", "True"}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                "\"\<benzene mole fraction\>\"", ",", 
                 "\"\<pressure (bar)\>\""}], "}"}]}], ",", 
              RowBox[{"LabelStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"17", ",", "Black"}], "}"}]}], ",", 
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"500", ",", "350"}], "}"}]}], ",", 
              RowBox[{"PlotRangePadding", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0.02", ",", "None"}], "}"}]}], ",", 
              RowBox[{"ImagePadding", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"40", ",", "5"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Graphics", "@", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Framed", "@", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<P =\>\"", ",", "P"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<P1 =\>\"", ",", "P1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<P2 =\>\"", ",", "P2"}], "}"}]}], "}"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", "\"\<=\>\""}]}], "]"}], 
                    ",", "18"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"xp", ",", "1.5"}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"Thick", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "7"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"Py2", "[", "0", "]"}]}], "}"}]}], "}"}], "]"}], 
                 ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "7"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"Py1", "[", "1", "]"}]}], "}"}]}], "}"}], "]"}]}],
                 "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"PointSize", "@", "0.02"}], ",", "Blue", ",", 
                 RowBox[{"Point", "[", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"Py2", "[", "0", "]"}]}], "}"}], "]"}], ",", 
                 "Orange", ",", 
                 RowBox[{"Point", "[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Py1", "[", "1", "]"}]}], "}"}], "]"}], ",", 
                 "Magenta", ",", 
                 RowBox[{"Point", "[", 
                  RowBox[{"{", 
                   RowBox[{"xp", ",", "P"}], "}"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PointSize", "@", "0.025"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"{", 
                 RowBox[{"comp", ",", "location"}], "}"}], "]"}]}], "}"}]}]}],
            "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"view1", "[", "0.3", "]"}], ",", 
         RowBox[{"view1", "[", "1", "]"}]}], "]"}], "*)"}], 
      RowBox[{"view1", "[", "0.3", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pistonheight", ",", "0.1", ",", "\"\<piston height\>\""}], 
       "}"}], ",", "0.1", ",", "6.5", ",", "0.01"}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.680530274228655*^9, 3.6805302979670124`*^9}, {
   3.680530330515874*^9, 3.6805303381993136`*^9}, {3.680530374946416*^9, 
   3.6805304107874656`*^9}, {3.680530444292382*^9, 3.6805305633853917`*^9}, {
   3.680530603632694*^9, 3.6805308297766285`*^9}, {3.6805308683738365`*^9, 
   3.6805308709319825`*^9}, {3.680530937924814*^9, 3.680530968548566*^9}, {
   3.680530998762294*^9, 3.680530999603342*^9}, {3.680531030143089*^9, 
   3.6805312414451747`*^9}, 3.6805313409078636`*^9, {3.6805314414086123`*^9, 
   3.680531469411214*^9}, {3.680531710233988*^9, 3.680531757526693*^9}, {
   3.6805318916751633`*^9, 3.680531891936178*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`pistonheight$$ = 6.5, Typeset`show$$ = True,
     Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`pistonheight$$], 0.1, "piston height"}, 0.1, 6.5, 
      0.01}}, Typeset`size$$ = {500., {172., 178.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`pistonheight$328862$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`pistonheight$$ = 0.1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`pistonheight$$, $CellContext`pistonheight$328862$$, 
         0]}, "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`T$, $CellContext`Psat$, $CellContext`P$, \
$CellContext`xp$, $CellContext`Py1$, $CellContext`Py2$, $CellContext`height$, \
$CellContext`view1$, $CellContext`view2$}, $CellContext`T$ = 
         124; $CellContext`Psat$[1] = 
         10^(4.72583 - 1660.652/($CellContext`T$ + 
           271.5)); $CellContext`Psat$[2] = 
         10^(5.0768 - 1659.793/($CellContext`T$ + 227.1)); $CellContext`P$ = 
         ReplaceAll[$CellContext`p, 
           
           FindRoot[$CellContext`Psat$[1]/$CellContext`p == 
            1 - $CellContext`Psat$[2]/$CellContext`p, {$CellContext`p, 
             0.01}]]; $CellContext`xp$ = $CellContext`Psat$[
           1]/$CellContext`P$; $CellContext`Py1$[
           Pattern[$CellContext`y$, 
            Blank[]]] := $CellContext`Psat$[
           1]/$CellContext`y$; $CellContext`Py2$[
           Pattern[$CellContext`y$, 
            Blank[]]] := $CellContext`Psat$[2]/(
          1 - $CellContext`y$); $CellContext`height$ = 
         6.5 - $CellContext`pistonheight$$; $CellContext`view1$[
           Pattern[$CellContext`comp$, 
            Blank[]]] := 
         Module[{$CellContext`P1$, $CellContext`P2$, $CellContext`location$}, \
$CellContext`P1$ = $CellContext`height$ + 
             1; $CellContext`P2$ = $CellContext`height$; \
$CellContext`location$ = 
            Piecewise[{{$CellContext`P2$, $CellContext`P$ < \
$CellContext`P2$}, {$CellContext`P$, 
                
                And[$CellContext`P$ >= $CellContext`P2$, $CellContext`P$ <= \
$CellContext`P1$]}, {$CellContext`P1$, $CellContext`P$ > $CellContext`P1$}}]; 
           Show[
             Plot[{
               Piecewise[{{
                  $CellContext`Py2$[$CellContext`y], 
                  0 <= $CellContext`y <= $CellContext`xp$}, {
                  $CellContext`Py1$[$CellContext`y], 
                  
                  Inequality[$CellContext`xp$, Less, $CellContext`y, 
                   LessEqual, 1]}}], $CellContext`P$}, {$CellContext`y, 0, 1},
               PlotStyle -> {{Thick, Black}, {Thick, Purple}}, 
              PlotRange -> {{0, 1}, {0.5, 7}}, Frame -> True, 
              FrameLabel -> {"benzene mole fraction", "pressure (bar)"}, 
              LabelStyle -> {17, Black}, ImageSize -> {500, 350}, 
              PlotRangePadding -> {0.02, None}, 
              ImagePadding -> {{40, 5}, {50, 10}}], 
             Graphics[{
               Text[
                Framed[
                 Style[
                  
                  Grid[{{"P =", $CellContext`P$}, {
                    "P1 =", $CellContext`P1$}, {"P2 =", $CellContext`P2$}}, 
                   Alignment -> "="], 18]], {$CellContext`xp$, 1.5}], {Thick, 
                Line[{{0, 7}, {0, 
                   $CellContext`Py2$[0]}}], 
                Line[{{1, 7}, {1, 
                   $CellContext`Py1$[1]}}]}, {
                PointSize[0.02], Blue, 
                Point[{0, 
                  $CellContext`Py2$[0]}], Orange, 
                Point[{1, 
                  $CellContext`Py1$[1]}], Magenta, 
                Point[{$CellContext`xp$, $CellContext`P$}]}, 
               PointSize[0.025], 
               
               Point[{$CellContext`comp$, $CellContext`location$}]}]]]; \
$CellContext`view1$[0.3]], 
      "Specifications" :> {{{$CellContext`pistonheight$$, 0.1, 
          "piston height"}, 0.1, 6.5, 0.01}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{551., {231., 238.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.680530535592802*^9, 3.680530564026428*^9}, 
   3.680530607830934*^9, 3.680530639456743*^9, {3.6805306749937754`*^9, 
   3.6805307037704215`*^9}, 3.6805308303966637`*^9, 3.680531165354822*^9, 
   3.680531243161273*^9, 3.6805313420229273`*^9, {3.6805314423916683`*^9, 
   3.680531470866297*^9}, 3.6805317175564065`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Get Code Ready for Using ",
 StyleBox["Animate",
  FontSlant->"Italic"],
 " - Two Directions"
}], "Section",
 CellChangeTimes->{{3.68053021067802*^9, 3.6805302538834915`*^9}, {
  3.680532350858224*^9, 3.680532401535123*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "T", ",", "Psat", ",", "P", ",", "xp", ",", "Py1", ",", "Py2", ",", 
       "view1", ",", "view2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T", "=", "124"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Psat", "[", "1", "]"}], "=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"4.72583", "-", 
          RowBox[{"1660.652", "/", 
           RowBox[{"(", 
            RowBox[{"T", "+", "271.5"}], ")"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Psat", "[", "2", "]"}], "=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"5.0768", "-", 
          RowBox[{"1659.793", "/", 
           RowBox[{"(", 
            RowBox[{"T", "+", "227.1"}], ")"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"P", "=", 
       RowBox[{"p", "/.", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Psat", "[", "1", "]"}], "/", "p"}], "\[Equal]", 
           RowBox[{"1", "-", 
            RowBox[{
             RowBox[{"Psat", "[", "2", "]"}], "/", "p"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"p", ",", "0.01"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xp", "=", 
       RowBox[{
        RowBox[{"Psat", "[", "1", "]"}], "/", "P"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Py1", "[", "y_", "]"}], ":=", 
       RowBox[{
        RowBox[{"Psat", "[", "1", "]"}], "/", "y"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Py2", "[", "y_", "]"}], ":=", 
       RowBox[{
        RowBox[{"Psat", "[", "2", "]"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "y"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"view1", "[", "comp_", "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"height", ",", "P1", ",", "P2", ",", "location"}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"height", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"pistonheight", "\[LessEqual]", "6.5"}], ",", 
             RowBox[{"6.5", "-", "pistonheight"}], ",", 
             RowBox[{"pistonheight", "-", "6.5"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"P1", "=", 
           RowBox[{"height", "+", "1"}]}], ";", 
          RowBox[{"P2", "=", "height"}], ";", "\[IndentingNewLine]", 
          RowBox[{"location", "=", 
           RowBox[{"Piecewise", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"P2", ",", 
                RowBox[{"P", "<", "P2"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"P", ",", 
                RowBox[{
                 RowBox[{"P", "\[GreaterEqual]", "P2"}], "\[And]", 
                 RowBox[{"P", "\[LessEqual]", "P1"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"P1", ",", 
                RowBox[{"P", ">", "P1"}]}], "}"}]}], "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Show", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Piecewise", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Py2", "[", "y", "]"}], ",", 
                    RowBox[{
                    "0", "\[LessEqual]", "y", "\[LessEqual]", "xp"}]}], "}"}],
                    ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Py1", "[", "y", "]"}], ",", 
                    RowBox[{"xp", "<", "y", "\[LessEqual]", "1"}]}], "}"}]}], 
                  "}"}], "]"}], ",", "P"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "0", ",", "1"}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Thick", ",", "Purple"}], "}"}]}], "}"}]}], ",", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0.5", ",", "7"}], "}"}]}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Frame", "\[Rule]", "True"}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                "\"\<benzene mole fraction\>\"", ",", 
                 "\"\<pressure (bar)\>\""}], "}"}]}], ",", 
              RowBox[{"LabelStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"17", ",", "Black"}], "}"}]}], ",", 
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"500", ",", "350"}], "}"}]}], ",", 
              RowBox[{"PlotRangePadding", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0.02", ",", "None"}], "}"}]}], ",", 
              RowBox[{"ImagePadding", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"40", ",", "5"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Graphics", "@", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Framed", "@", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<P =\>\"", ",", "P"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<P1 =\>\"", ",", "P1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<P2 =\>\"", ",", "P2"}], "}"}]}], "}"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", "\"\<=\>\""}]}], "]"}], 
                    ",", "18"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"xp", ",", "1.5"}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"Thick", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "7"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"Py2", "[", "0", "]"}]}], "}"}]}], "}"}], "]"}], 
                 ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "7"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"Py1", "[", "1", "]"}]}], "}"}]}], "}"}], "]"}]}],
                 "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"PointSize", "@", "0.02"}], ",", "Blue", ",", 
                 RowBox[{"Point", "[", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"Py2", "[", "0", "]"}]}], "}"}], "]"}], ",", 
                 "Orange", ",", 
                 RowBox[{"Point", "[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Py1", "[", "1", "]"}]}], "}"}], "]"}], ",", 
                 "Magenta", ",", 
                 RowBox[{"Point", "[", 
                  RowBox[{"{", 
                   RowBox[{"xp", ",", "P"}], "}"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PointSize", "@", "0.025"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"{", 
                 RowBox[{"comp", ",", "location"}], "}"}], "]"}]}], "}"}]}]}],
            "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"view1", "[", "0.3", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pistonheight", ",", "0.1", ",", "\"\<piston height\>\""}], 
       "}"}], ",", "0.1", ",", "13", ",", "0.01"}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.6805319050729294`*^9, 3.6805319126943655`*^9}, {
   3.6805319603240895`*^9, 3.6805321663456707`*^9}, 3.680532215211466*^9, {
   3.680532257683895*^9, 3.6805323367594175`*^9}, {3.6805324216192713`*^9, 
   3.6805324217762804`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`pistonheight$$ = 13., Typeset`show$$ = True,
     Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`pistonheight$$], 0.1, "piston height"}, 0.1, 13, 
      0.01}}, Typeset`size$$ = {500., {172., 178.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`pistonheight$376081$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`pistonheight$$ = 0.1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`pistonheight$$, $CellContext`pistonheight$376081$$, 
         0]}, "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`T$, $CellContext`Psat$, $CellContext`P$, \
$CellContext`xp$, $CellContext`Py1$, $CellContext`Py2$, $CellContext`view1$, \
$CellContext`view2$}, $CellContext`T$ = 124; $CellContext`Psat$[1] = 
         10^(4.72583 - 1660.652/($CellContext`T$ + 
           271.5)); $CellContext`Psat$[2] = 
         10^(5.0768 - 1659.793/($CellContext`T$ + 227.1)); $CellContext`P$ = 
         ReplaceAll[$CellContext`p, 
           
           FindRoot[$CellContext`Psat$[1]/$CellContext`p == 
            1 - $CellContext`Psat$[2]/$CellContext`p, {$CellContext`p, 
             0.01}]]; $CellContext`xp$ = $CellContext`Psat$[
           1]/$CellContext`P$; $CellContext`Py1$[
           Pattern[$CellContext`y$, 
            Blank[]]] := $CellContext`Psat$[
           1]/$CellContext`y$; $CellContext`Py2$[
           Pattern[$CellContext`y$, 
            Blank[]]] := $CellContext`Psat$[2]/(
          1 - $CellContext`y$); $CellContext`view1$[
           Pattern[$CellContext`comp$, 
            Blank[]]] := 
         Module[{$CellContext`height$, $CellContext`P1$, $CellContext`P2$, \
$CellContext`location$}, $CellContext`height$ = 
            If[$CellContext`pistonheight$$ <= 6.5, 
              6.5 - $CellContext`pistonheight$$, $CellContext`pistonheight$$ - 
              6.5]; $CellContext`P1$ = $CellContext`height$ + 
             1; $CellContext`P2$ = $CellContext`height$; \
$CellContext`location$ = 
            Piecewise[{{$CellContext`P2$, $CellContext`P$ < \
$CellContext`P2$}, {$CellContext`P$, 
                
                And[$CellContext`P$ >= $CellContext`P2$, $CellContext`P$ <= \
$CellContext`P1$]}, {$CellContext`P1$, $CellContext`P$ > $CellContext`P1$}}]; 
           Show[
             Plot[{
               Piecewise[{{
                  $CellContext`Py2$[$CellContext`y], 
                  0 <= $CellContext`y <= $CellContext`xp$}, {
                  $CellContext`Py1$[$CellContext`y], 
                  
                  Inequality[$CellContext`xp$, Less, $CellContext`y, 
                   LessEqual, 1]}}], $CellContext`P$}, {$CellContext`y, 0, 1},
               PlotStyle -> {{Thick, Black}, {Thick, Purple}}, 
              PlotRange -> {{0, 1}, {0.5, 7}}, Frame -> True, 
              FrameLabel -> {"benzene mole fraction", "pressure (bar)"}, 
              LabelStyle -> {17, Black}, ImageSize -> {500, 350}, 
              PlotRangePadding -> {0.02, None}, 
              ImagePadding -> {{40, 5}, {50, 10}}], 
             Graphics[{
               Text[
                Framed[
                 Style[
                  
                  Grid[{{"P =", $CellContext`P$}, {
                    "P1 =", $CellContext`P1$}, {"P2 =", $CellContext`P2$}}, 
                   Alignment -> "="], 18]], {$CellContext`xp$, 1.5}], {Thick, 
                Line[{{0, 7}, {0, 
                   $CellContext`Py2$[0]}}], 
                Line[{{1, 7}, {1, 
                   $CellContext`Py1$[1]}}]}, {
                PointSize[0.02], Blue, 
                Point[{0, 
                  $CellContext`Py2$[0]}], Orange, 
                Point[{1, 
                  $CellContext`Py1$[1]}], Magenta, 
                Point[{$CellContext`xp$, $CellContext`P$}]}, 
               PointSize[0.025], 
               
               Point[{$CellContext`comp$, $CellContext`location$}]}]]]; \
$CellContext`view1$[0.3]], 
      "Specifications" :> {{{$CellContext`pistonheight$$, 0.1, 
          "piston height"}, 0.1, 13, 0.01}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{551., {218., 225.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.6805320515513077`*^9, 3.6805321680727696`*^9, 
  3.680532215613489*^9, 3.6805322671874385`*^9, 3.6805323131550674`*^9, 
  3.6805324224953213`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Get Code Ready for Using ",
 StyleBox["Animate",
  FontSlant->"Italic"],
 " - Two Directions - Multiple ",
 StyleBox["comp",
  FontSlant->"Italic"]
}], "Section",
 CellChangeTimes->{{3.68053021067802*^9, 3.6805302538834915`*^9}, {
  3.680532350858224*^9, 3.6805323897914515`*^9}, {3.6805324427424793`*^9, 
  3.68053244623968*^9}, {3.6805324800766153`*^9, 3.68053248994518*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "T", ",", "Psat", ",", "P", ",", "xp", ",", "Py1", ",", "Py2", ",", 
       "view1", ",", "view2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T", "=", "124"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Psat", "[", "1", "]"}], "=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"4.72583", "-", 
          RowBox[{"1660.652", "/", 
           RowBox[{"(", 
            RowBox[{"T", "+", "271.5"}], ")"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Psat", "[", "2", "]"}], "=", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"5.0768", "-", 
          RowBox[{"1659.793", "/", 
           RowBox[{"(", 
            RowBox[{"T", "+", "227.1"}], ")"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"P", "=", 
       RowBox[{"p", "/.", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Psat", "[", "1", "]"}], "/", "p"}], "\[Equal]", 
           RowBox[{"1", "-", 
            RowBox[{
             RowBox[{"Psat", "[", "2", "]"}], "/", "p"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"p", ",", "0.01"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xp", "=", 
       RowBox[{
        RowBox[{"Psat", "[", "1", "]"}], "/", "P"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Py1", "[", "y_", "]"}], ":=", 
       RowBox[{
        RowBox[{"Psat", "[", "1", "]"}], "/", "y"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Py2", "[", "y_", "]"}], ":=", 
       RowBox[{
        RowBox[{"Psat", "[", "2", "]"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "y"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"view1", "[", "comp_", "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"height", ",", "P1", ",", "P2", ",", "location"}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"height", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"pistonheight", "\[LessEqual]", "6.5"}], ",", 
             RowBox[{"6.5", "-", "pistonheight"}], ",", 
             RowBox[{"pistonheight", "-", "6.5"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"location", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Piecewise", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"P2", ",", 
                  RowBox[{"#", "<", "P2"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"#", ",", 
                  RowBox[{
                   RowBox[{"#", "\[GreaterEqual]", "P2"}], "\[And]", 
                   RowBox[{"#", "\[LessEqual]", "P1"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"P1", ",", 
                  RowBox[{"#", ">", "P1"}]}], "}"}]}], "}"}], "]"}], "&"}], 
            "@", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"comp", "\[Equal]", "0"}], ",", 
              RowBox[{"Py2", "[", "0", "]"}], ",", 
              RowBox[{"comp", "\[Equal]", "1"}], ",", 
              RowBox[{"Py1", "[", "1", "]"}], ",", 
              RowBox[{"0", "<", "comp", "<", "1"}], ",", "P"}], "]"}]}]}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Show", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Piecewise", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Py2", "[", "y", "]"}], ",", 
                    RowBox[{
                    "0", "\[LessEqual]", "y", "\[LessEqual]", "xp"}]}], "}"}],
                    ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Py1", "[", "y", "]"}], ",", 
                    RowBox[{"xp", "<", "y", "\[LessEqual]", "1"}]}], "}"}]}], 
                  "}"}], "]"}], ",", "P"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "0", ",", "1"}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Thick", ",", "Purple"}], "}"}]}], "}"}]}], ",", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0.5", ",", "7"}], "}"}]}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Frame", "\[Rule]", "True"}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                "\"\<benzene mole fraction\>\"", ",", 
                 "\"\<pressure (bar)\>\""}], "}"}]}], ",", 
              RowBox[{"LabelStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"17", ",", "Black"}], "}"}]}], ",", 
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"500", ",", "350"}], "}"}]}], ",", 
              RowBox[{"PlotRangePadding", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"0.02", ",", "None"}], "}"}]}], ",", 
              RowBox[{"ImagePadding", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"40", ",", "5"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Graphics", "@", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Framed", "@", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<P =\>\"", ",", "P"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<P1 =\>\"", ",", "P1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<P2 =\>\"", ",", "P2"}], "}"}]}], "}"}], ",", 
                    RowBox[{"Alignment", "\[Rule]", "\"\<=\>\""}]}], "]"}], 
                    ",", "18"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"xp", ",", "1.5"}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"Thick", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "7"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"Py2", "[", "0", "]"}]}], "}"}]}], "}"}], "]"}], 
                 ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "7"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"Py1", "[", "1", "]"}]}], "}"}]}], "}"}], "]"}]}],
                 "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"PointSize", "@", "0.02"}], ",", "Blue", ",", 
                 RowBox[{"Point", "[", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"Py2", "[", "0", "]"}]}], "}"}], "]"}], ",", 
                 "Orange", ",", 
                 RowBox[{"Point", "[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Py1", "[", "1", "]"}]}], "}"}], "]"}], ",", 
                 "Magenta", ",", 
                 RowBox[{"Point", "[", 
                  RowBox[{"{", 
                   RowBox[{"xp", ",", "P"}], "}"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PointSize", "@", "0.025"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"{", 
                 RowBox[{"comp", ",", "location"}], "}"}], "]"}]}], "}"}]}]}],
            "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"view2", "=", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Opacity", "@", "0.3"}], ",", "Green", ",", 
               RowBox[{"Cylinder", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"5.5", "*", 
                    RowBox[{"Log10", "[", 
                    RowBox[{"1", "+", "pistonheight"}], "]"}]}]}], "}"}]}], 
                 "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Opacity", "@", "0.5"}], ",", 
               RowBox[{"Cylinder", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"5.5", "*", 
                    RowBox[{"Log10", "[", 
                    RowBox[{"1", "+", "pistonheight"}], "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "5.5"}], "}"}]}], "}"}], 
                "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"GrayLevel", "@", "0.3"}], ",", 
               RowBox[{"Cylinder", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"5.5", "*", 
                    RowBox[{"Log10", "[", 
                    RowBox[{"1", "+", "pistonheight"}], "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"5.5", "*", 
                    RowBox[{"Log10", "[", 
                    RowBox[{"1", "+", "pistonheight"}], "]"}]}], "+", 
                    "0.25"}]}], "}"}]}], "}"}], "]"}], ",", 
               RowBox[{"Cylinder", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"5.5", "*", 
                    RowBox[{"Log10", "[", 
                    RowBox[{"1", "+", "pistonheight"}], "]"}]}], "+", 
                    "0.25"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "6"}], "}"}]}], "}"}], ",", 
                 "0.17"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<log volume\>\"", ",", "17"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"150", ",", "350"}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "0.5"}], ",", "6"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
           RowBox[{"ViewPoint", "\[Rule]", "Front"}], ",", 
           RowBox[{"Lighting", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<Ambient\>\"", ",", "LightGray"}], "}"}], "}"}]}]}],
           "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"view1", "[", "0.3", "]"}], ",", 
        RowBox[{"view1", "[", "1", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pistonheight", ",", "0.1", ",", "\"\<piston height\>\""}], 
       "}"}], ",", "0.1", ",", "13", ",", "0.01"}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.6805325011858225`*^9, 3.6805326255889378`*^9}, {
  3.6805326682213764`*^9, 3.6805326803250685`*^9}, {3.6805327387614107`*^9, 
  3.680532844192441*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`pistonheight$$ = 0.1, Typeset`show$$ = True,
     Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`pistonheight$$], 0.1, "piston height"}, 0.1, 13, 
      0.01}}, Typeset`size$$ = {500., {172., 178.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`pistonheight$410872$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`pistonheight$$ = 0.1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`pistonheight$$, $CellContext`pistonheight$410872$$, 
         0]}, "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`T$, $CellContext`Psat$, $CellContext`P$, \
$CellContext`xp$, $CellContext`Py1$, $CellContext`Py2$, $CellContext`view1$, \
$CellContext`view2$}, $CellContext`T$ = 124; $CellContext`Psat$[1] = 
         10^(4.72583 - 1660.652/($CellContext`T$ + 
           271.5)); $CellContext`Psat$[2] = 
         10^(5.0768 - 1659.793/($CellContext`T$ + 227.1)); $CellContext`P$ = 
         ReplaceAll[$CellContext`p, 
           
           FindRoot[$CellContext`Psat$[1]/$CellContext`p == 
            1 - $CellContext`Psat$[2]/$CellContext`p, {$CellContext`p, 
             0.01}]]; $CellContext`xp$ = $CellContext`Psat$[
           1]/$CellContext`P$; $CellContext`Py1$[
           Pattern[$CellContext`y$, 
            Blank[]]] := $CellContext`Psat$[
           1]/$CellContext`y$; $CellContext`Py2$[
           Pattern[$CellContext`y$, 
            Blank[]]] := $CellContext`Psat$[2]/(
          1 - $CellContext`y$); $CellContext`view1$[
           Pattern[$CellContext`comp$, 
            Blank[]]] := 
         Module[{$CellContext`height$, $CellContext`P1$, $CellContext`P2$, \
$CellContext`location$}, $CellContext`height$ = 
            If[$CellContext`pistonheight$$ <= 6.5, 
              6.5 - $CellContext`pistonheight$$, $CellContext`pistonheight$$ - 
              6.5]; $CellContext`location$ = (
             Piecewise[{{$CellContext`P2$, # < $CellContext`P2$}, {#, 
                
                And[# >= $CellContext`P2$, # <= $CellContext`P1$]}, \
{$CellContext`P1$, # > $CellContext`P1$}}]& )[
              Which[$CellContext`comp$ == 0, 
               $CellContext`Py2$[0], $CellContext`comp$ == 1, 
               $CellContext`Py1$[1], 0 < $CellContext`comp$ < 
               1, $CellContext`P$]]; Show[
             Plot[{
               Piecewise[{{
                  $CellContext`Py2$[$CellContext`y], 
                  0 <= $CellContext`y <= $CellContext`xp$}, {
                  $CellContext`Py1$[$CellContext`y], 
                  
                  Inequality[$CellContext`xp$, Less, $CellContext`y, 
                   LessEqual, 1]}}], $CellContext`P$}, {$CellContext`y, 0, 1},
               PlotStyle -> {{Thick, Black}, {Thick, Purple}}, 
              PlotRange -> {{0, 1}, {0.5, 7}}, Frame -> True, 
              FrameLabel -> {"benzene mole fraction", "pressure (bar)"}, 
              LabelStyle -> {17, Black}, ImageSize -> {500, 350}, 
              PlotRangePadding -> {0.02, None}, 
              ImagePadding -> {{40, 5}, {50, 10}}], 
             Graphics[{
               Text[
                Framed[
                 Style[
                  
                  Grid[{{"P =", $CellContext`P$}, {
                    "P1 =", $CellContext`P1$}, {"P2 =", $CellContext`P2$}}, 
                   Alignment -> "="], 18]], {$CellContext`xp$, 1.5}], {Thick, 
                Line[{{0, 7}, {0, 
                   $CellContext`Py2$[0]}}], 
                Line[{{1, 7}, {1, 
                   $CellContext`Py1$[1]}}]}, {
                PointSize[0.02], Blue, 
                Point[{0, 
                  $CellContext`Py2$[0]}], Orange, 
                Point[{1, 
                  $CellContext`Py1$[1]}], Magenta, 
                Point[{$CellContext`xp$, $CellContext`P$}]}, 
               PointSize[0.025], 
               Point[{$CellContext`comp$, $CellContext`location$}]}]]]; Show[
          $CellContext`view1$[0.3], 
          $CellContext`view1$[1]]], 
      "Specifications" :> {{{$CellContext`pistonheight$$, 0.1, 
          "piston height"}, 0.1, 13, 0.01}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{551., {218., 225.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.680532600902526*^9, 3.6805326337774067`*^9, {3.6805326732686653`*^9, 
   3.6805327053034973`*^9}, 3.6805328452044992`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1366, 686},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (April 11, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 112, 1, 70, "Section"],
Cell[CellGroupData[{
Cell[717, 27, 25215, 627, 1452, "Input"],
Cell[25935, 656, 13252, 289, 492, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[39236, 951, 243, 7, 70, "Section"],
Cell[CellGroupData[{
Cell[39504, 962, 9893, 237, 672, "Input"],
Cell[49400, 1201, 5268, 106, 486, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[54717, 1313, 242, 7, 70, "Section"],
Cell[CellGroupData[{
Cell[54984, 1324, 9488, 230, 652, "Input"],
Cell[64475, 1556, 5192, 105, 460, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[69716, 1667, 395, 10, 70, "Section"],
Cell[CellGroupData[{
Cell[70136, 1681, 14003, 339, 792, "Input"],
Cell[84142, 2022, 5233, 105, 460, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

