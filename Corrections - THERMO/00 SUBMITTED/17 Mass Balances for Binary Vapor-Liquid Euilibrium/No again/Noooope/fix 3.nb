(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     50950,       1282]
NotebookOptionsPosition[     47022,       1160]
NotebookOutlinePosition[     48614,       1210]
CellTagsIndexPosition[     48286,       1198]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Your Title Here", "DemoTitle"],

Cell[CellGroupData[{

Cell["", "InitializationSection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Psat", "[", "1", "]"}], "=", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{"4.83", "-", 
      RowBox[{"1697", "/", 
       RowBox[{"(", 
        RowBox[{"400", "+", "22.1"}], ")"}]}]}], ")"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.675530808375615*^9, 3.675530815158429*^9}},
 CellID->367346216],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Psat", "[", "2", "]"}], "=", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{"4.43", "-", 
      RowBox[{"1754", "/", 
       RowBox[{"(", 
        RowBox[{"400", "+", "0.5"}], ")"}]}]}], ")"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.675530816907632*^9, 3.675530817484833*^9}},
 CellID->199493148],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Px", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{"x", "*", 
     RowBox[{"Psat", "[", "1", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "x"}], ")"}], "*", 
     RowBox[{"Psat", "[", "2", "]"}]}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.675522583061341*^9, 3.675522583624942*^9}, {
   3.675529293390125*^9, 3.6755293177950077`*^9}, {3.6755306806670446`*^9, 
   3.6755306819430485`*^9}, {3.675530791829146*^9, 3.6755307922269535`*^9}, 
   3.6755308236752462`*^9},
 CellID->484088675],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Py", "[", "x_", "]"}], ":=", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      FractionBox["x", 
       RowBox[{"Psat", "[", "1", "]"}]], "+", 
      FractionBox[
       RowBox[{"1", "-", "x"}], 
       RowBox[{"Psat", "[", "2", "]"}]]}], ")"}], 
    RowBox[{"-", "1"}]]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6755293339108405`*^9, 3.6755293448332653`*^9}, {
   3.6755306846216536`*^9, 3.6755306859476557`*^9}, {3.6755307944771676`*^9, 
   3.675530794695568*^9}, 3.6755308275676537`*^9},
 CellID->127795700],

Cell[BoxData[
 RowBox[{
  RowBox[{"diagram", "=", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Px", "[", "x", "]"}], ",", 
       RowBox[{"Py", "[", "x", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"0", ",", "0.65", ",", "0"}], "]"}]}], "}"}]}], "}"}]}], 
     ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<mole fraction A\>\"", ",", "17"}], "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<pressure (kPa)\>\"", ",", "17"}], "]"}]}], "}"}]}], ",", 
     RowBox[{"LabelStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"14", ",", "Black"}], "}"}]}], ",", 
     RowBox[{"Epilog", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"#1", ",", "17", ",", 
             RowBox[{"GrayLevel", "@", "0.5"}]}], "]"}], ",", "#2"}], "]"}], 
         "&"}], "@@@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<liquid\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"0.1", ",", "6"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<vapor\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"0.9", ",", "1.2"}], "}"}]}], "}"}]}], "}"}]}], 
       "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6755226021004477`*^9, 3.6755226118104887`*^9}, {
  3.6755228943847094`*^9, 3.6755229104785404`*^9}, {3.675530851102211*^9, 
  3.675530871697291*^9}},
 CellID->91487072]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ManipulateSection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "P", ",", "nAadd", ",", "nBadd", ",", "nA0", ",", "nB0", ",", "z0", ",",
        "nA", ",", "nB", ",", "z", ",", "zL", ",", "zV", ",", "nL0", ",", 
       "nV0", ",", "nAL0", ",", "nAV0", ",", "nBL0", ",", "nBV0", ",", 
       "total", ",", "fL", ",", "fAL", ",", "fBL", ",", "fV", ",", "fAV", ",",
        "fBV", ",", "LtoVA", ",", "LtoVB", ",", "LtoLA", ",", "LtoLB", ",", 
       "VtoVA", ",", "VtoVB", ",", "VtoLA", ",", "VtoLB", ",", "p1", ",", 
       "p2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"P", "=", "130"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"nAadd", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"aorb", "\[Equal]", "1"}], ",", "addmol", ",", "0"}], 
        "]"}]}], ";", 
      RowBox[{"nBadd", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"aorb", "\[Equal]", "2"}], ",", "addmol", ",", "0"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"nA0", "=", "4"}], ";", 
      RowBox[{"nB0", "=", "6"}], ";", 
      RowBox[{"z0", "=", 
       RowBox[{"nA0", "/", 
        RowBox[{"(", 
         RowBox[{"nA0", "+", "nB0"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"nA", "=", 
       RowBox[{"nA0", "+", "nAadd"}]}], ";", 
      RowBox[{"nB", "=", 
       RowBox[{"nB0", "+", "nBadd"}]}], ";", 
      RowBox[{"z", "=", 
       RowBox[{"nA", "/", 
        RowBox[{"(", 
         RowBox[{"nA", "+", "nB"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"zL", "=", "0.2456"}], ";", 
      RowBox[{"zV", "=", "0.586"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"zL", "<", "z0", "<", "zV"}], ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"nL0", "=", 
           RowBox[{
            FractionBox[
             RowBox[{"zV", "-", "z0"}], 
             RowBox[{"zV", "-", "zL"}]], "*", 
            RowBox[{"(", 
             RowBox[{"nA0", "+", "nB0"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nV0", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              FractionBox["nL0", 
               RowBox[{"nA0", "+", "nB0"}]]}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{"nA0", "+", "nB0"}], ")"}]}]}], ";"}], "}"}]}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"nAL0", "=", 
       RowBox[{"zL", "*", "nL0"}]}], ";", 
      RowBox[{"nAV0", "=", 
       RowBox[{"zV", "*", "nV0"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nBL0", "=", 
       RowBox[{"nL0", "-", "nAL0"}]}], ";", 
      RowBox[{"nBV0", "=", 
       RowBox[{"nV0", "-", "nAV0"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"total", "=", 
       RowBox[{"nA0", "+", "nB0", "+", "nAadd", "+", "nBadd"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"z", "\[LessEqual]", "zL"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"fL", "=", "total"}], ",", 
          RowBox[{"fAL", "=", 
           RowBox[{"z", "*", "fL"}]}], ",", 
          RowBox[{"fBL", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "z"}], ")"}], "*", "fL"}]}], ",", 
          RowBox[{"fV", "=", "0"}], ",", 
          RowBox[{"fAV", "=", "0"}], ",", 
          RowBox[{"fBV", "=", "0"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"nAadd", "\[Equal]", "0"}], "\[And]", 
         RowBox[{"nBadd", "\[Equal]", "0"}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"fL", "=", "nL0"}], ",", 
          RowBox[{"fAL", "=", "nAL0"}], ",", 
          RowBox[{"fBL", "=", "nBL0"}], ",", 
          RowBox[{"fV", "=", "nV0"}], ",", 
          RowBox[{"fAV", "=", "nAV0"}], ",", 
          RowBox[{"fBV", "=", "nBV0"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"z", "\[GreaterEqual]", "zV"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"fV", "=", "total"}], ",", 
          RowBox[{"fAV", "=", 
           RowBox[{"z", "*", "fV"}]}], ",", 
          RowBox[{"fBV", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "z"}], ")"}], "*", "fV"}]}], ",", 
          RowBox[{"fL", "=", "0"}], ",", 
          RowBox[{"fAL", "=", "0"}], ",", 
          RowBox[{"fBL", "=", "0"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"zL", "<", "z", "<", "zV"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"fL", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"zV", "-", "z"}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"zV", "-", "zL"}], ")"}]}], "*", 
            RowBox[{"(", "total", ")"}]}]}], ";", 
          RowBox[{"fAL", "=", 
           RowBox[{"zL", "*", "fL"}]}], ";", 
          RowBox[{"fBL", "=", 
           RowBox[{"fL", "-", "fAL"}]}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"zL", "<", "z", "<", "zV"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"fV", "=", 
           RowBox[{"total", "-", "fL"}]}], ";", 
          RowBox[{"fAV", "=", 
           RowBox[{"zV", "*", "fV"}]}], ";", 
          RowBox[{"fBV", "=", 
           RowBox[{"fV", "-", "fAV"}]}], ";"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", "****)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"z", "\[GreaterEqual]", "zV"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"LtoVA", "=", "nAL0"}], ";", 
          RowBox[{"LtoVB", "=", "nBL0"}], ";", 
          RowBox[{"LtoLA", "=", "0"}], ";", 
          RowBox[{"LtoLB", "=", "0"}], ";", 
          RowBox[{"VtoVA", "=", "nAV0"}], ";", 
          RowBox[{"VtoVB", "=", "nBV0"}], ";", 
          RowBox[{"VtoLA", "=", "0"}], ";", 
          RowBox[{"VtoLB", "=", "0"}], ";"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"z", "\[LessEqual]", "zL"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"LtoVA", "=", "0"}], ";", 
            RowBox[{"LtoVB", "=", "0"}], ";", 
            RowBox[{"LtoLA", "=", "nAL0"}], ";", 
            RowBox[{"LtoLB", "=", "nBL0"}], ";", 
            RowBox[{"VtoVA", "=", "0"}], ";", 
            RowBox[{"VtoVB", "=", "0"}], ";", 
            RowBox[{"VtoLA", "=", "nAV0"}], ";", 
            RowBox[{"VtoLB", "=", "nBV0"}], ";"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"nAadd", ">", "0"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"LtoVA", "=", 
               RowBox[{"fAV", "-", "nAV0", "-", "nAadd"}]}], ";", 
              RowBox[{"LtoVB", "=", 
               RowBox[{"fBV", "-", "nBV0"}]}], ";", 
              RowBox[{"LtoLA", "=", "fAL"}], ";", 
              RowBox[{"LtoLB", "=", "fBL"}], ";", 
              RowBox[{"VtoVA", "=", "0"}], ";", 
              RowBox[{"VtoVB", "=", "0"}], ";", 
              RowBox[{"VtoLA", "=", "0"}], ";", 
              RowBox[{"VtoLB", "=", "0"}], ";"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"LtoVA", "=", "0"}], ";", 
              RowBox[{"LtoVB", "=", "0"}], ";", 
              RowBox[{"LtoLA", "=", "nAL0"}], ";", 
              RowBox[{"LtoLB", "=", "nBL0"}], ";", 
              RowBox[{"VtoVA", "=", "fAV"}], ";", 
              RowBox[{"VtoVB", "=", "fBV"}], ";", 
              RowBox[{"VtoLA", "=", 
               RowBox[{"fAL", "-", "nAL0"}]}], ";", 
              RowBox[{"VtoLB", "=", 
               RowBox[{"fBL", "-", "nBL0", "-", "nBadd"}]}], ";"}], "}"}]}], 
           "]"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"p1", "=", 
       RowBox[{"Show", "[", "diagram", 
        RowBox[{"(*", 
         RowBox[{",", 
          RowBox[{"Graphics", "@", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Thick", ",", "Dashed", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"aorb", "\[Equal]", "1"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"RGBColor", "[", 
                    RowBox[{"0", ",", "0.65", ",", "0"}], "]"}], ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"z", "\[LessEqual]", "zV"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"z0", ",", "P"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"zV", ",", "P"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"zV", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"z", ",", "P"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "0"}], "}"}]}], "}"}], "]"}]}], "]"}]}],
                   "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"Blue", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"z", "\[GreaterEqual]", "zL"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"z0", ",", "P"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"zL", ",", "P"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"zL", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"z", ",", "P"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "0"}], "}"}]}], "}"}], "]"}]}], "]"}]}],
                   "}"}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Thick", ",", 
               RowBox[{"Arrow", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"z0", ",", "P"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"z", ",", "P"}], "}"}]}], "}"}], "]"}]}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"PointSize", "@", "0.02"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"{", 
                 RowBox[{"z0", ",", "P"}], "}"}], "]"}], ",", 
               RowBox[{"PointSize", "@", "0.015"}], ",", 
               RowBox[{"GrayLevel", "@", "0.4"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"{", 
                 RowBox[{"z", ",", "P"}], "}"}], "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "}"}]}]}], "*)"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"p2", "=", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"Switch", "[", 
         RowBox[{"choose", ",", "1", ",", "p1", ",", "2", ",", "p2"}], "]"}], 
        ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"560", ",", "400"}], "}"}]}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"choose", ",", "1", ",", "\"\<\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "\[Rule]", 
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\< P-x-y\>\"", ",", "Italic"}], "]"}], ",", 
                  "\"\< diagram \>\""}], "}"}], "]"}]}], ",", 
              RowBox[{"2", "\[Rule]", "\"\< mole balance \>\""}]}], "}"}], 
            ",", "Setter"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"aorb", ",", "1", ",", "\"\<\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "\[Rule]", "\"\< add A \>\""}], ",", 
              RowBox[{"2", "\[Rule]", "\"\< add B \>\""}]}], "}"}], ",", 
            "Setter"}], "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"addmol", ",", "3", ",", "\"\<moles added\>\""}], "}"}], 
            ",", "0", ",", "10", ",", "0.1", ",", 
            RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], 
          "]"}], ",", "SpanFromLeft"}], "}"}]}], "\[IndentingNewLine]", "}"}],
      ",", 
     RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}], ",", 
   RowBox[{"SaveDefinitions", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6755219451828375`*^9, 3.675522020665634*^9}, {
   3.675522630014143*^9, 3.6755227058973103`*^9}, {3.675522741425729*^9, 
   3.6755228357387486`*^9}, {3.67552286955844*^9, 3.6755230080723815`*^9}, {
   3.675523039353855*^9, 3.675523096822209*^9}, {3.675523131771495*^9, 
   3.675523390847953*^9}, {3.6755237641625295`*^9, 3.6755237780251865`*^9}, {
   3.675528649778821*^9, 3.675528812990486*^9}, {3.6755288578176064`*^9, 
   3.675528869154236*^9}, {3.675528903607709*^9, 3.6755292461487885`*^9}, {
   3.6755294142406454`*^9, 3.6755294150940475`*^9}, {3.6755294533919125`*^9, 
   3.6755294684405766`*^9}, {3.675529510637845*^9, 3.6755295459057226`*^9}, {
   3.675529621071892*^9, 3.6755298115506935`*^9}, {3.6755299016749783`*^9, 
   3.6755299393928576`*^9}, {3.6755299948065395`*^9, 3.675530030121419*^9}, {
   3.675530060404883*^9, 3.6755301492887053`*^9}, {3.6755301967029223`*^9, 
   3.6755302766587834`*^9}, {3.675530307676263*^9, 3.6755305397372804`*^9}, {
   3.6755306905308657`*^9, 3.675530723125987*^9}, 3.6755309150830927`*^9, {
   3.6755309518941135`*^9, 3.6755309607217336`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`addmol$$ = 3, $CellContext`aorb$$ = 
    1, $CellContext`choose$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`choose$$], 1, ""}, {1 -> Row[{
          Style[" P-x-y", Italic], " diagram "}], 2 -> " mole balance "}}, {{
       Hold[$CellContext`aorb$$], 1, ""}, {1 -> " add A ", 2 -> " add B "}}, {{
       Hold[$CellContext`addmol$$], 3, "moles added"}, 0, 10, 0.1}, {
      Hold[
       Grid[{{
          Manipulate`Place[1], 
          Manipulate`Place[2]}, {
          Manipulate`Place[3], SpanFromLeft}}, Alignment -> Left]], 
      Manipulate`Dump`ThisIsNotAControl}}, Typeset`size$$ = {
    560., {197., 203.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`choose$72692$$ = 
    False, $CellContext`aorb$72693$$ = False, $CellContext`addmol$72694$$ = 
    0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`addmol$$ = 3, $CellContext`aorb$$ = 
        1, $CellContext`choose$$ = 1}, "ControllerVariables" :> {
        Hold[$CellContext`choose$$, $CellContext`choose$72692$$, False], 
        Hold[$CellContext`aorb$$, $CellContext`aorb$72693$$, False], 
        Hold[$CellContext`addmol$$, $CellContext`addmol$72694$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`P$, $CellContext`nAadd$, $CellContext`nBadd$, \
$CellContext`nA0$, $CellContext`nB0$, $CellContext`z0$, $CellContext`nA$, \
$CellContext`nB$, $CellContext`z$, $CellContext`zL$, $CellContext`zV$, \
$CellContext`nL0$, $CellContext`nV0$, $CellContext`nAL0$, $CellContext`nAV0$, \
$CellContext`nBL0$, $CellContext`nBV0$, $CellContext`total$, \
$CellContext`fL$, $CellContext`fAL$, $CellContext`fBL$, $CellContext`fV$, \
$CellContext`fAV$, $CellContext`fBV$, $CellContext`LtoVA$, \
$CellContext`LtoVB$, $CellContext`LtoLA$, $CellContext`LtoLB$, \
$CellContext`VtoVA$, $CellContext`VtoVB$, $CellContext`VtoLA$, \
$CellContext`VtoLB$, $CellContext`p1$, $CellContext`p2$}, $CellContext`P$ = 
         130; $CellContext`nAadd$ = 
         If[$CellContext`aorb$$ == 1, $CellContext`addmol$$, 
           0]; $CellContext`nBadd$ = 
         If[$CellContext`aorb$$ == 2, $CellContext`addmol$$, 
           0]; $CellContext`nA0$ = 4; $CellContext`nB0$ = 
         6; $CellContext`z0$ = $CellContext`nA0$/($CellContext`nA0$ + \
$CellContext`nB0$); $CellContext`nA$ = $CellContext`nA0$ + \
$CellContext`nAadd$; $CellContext`nB$ = $CellContext`nB0$ + \
$CellContext`nBadd$; $CellContext`z$ = $CellContext`nA$/($CellContext`nA$ + \
$CellContext`nB$); $CellContext`zL$ = 0.2456; $CellContext`zV$ = 0.586; 
        If[$CellContext`zL$ < $CellContext`z0$ < $CellContext`zV$, \
{$CellContext`nL0$ = (($CellContext`zV$ - $CellContext`z0$)/($CellContext`zV$ - \
$CellContext`zL$)) ($CellContext`nA0$ + $CellContext`nB0$); $CellContext`nV0$ = \
(1 - $CellContext`nL0$/($CellContext`nA0$ + $CellContext`nB0$)) \
($CellContext`nA0$ + $CellContext`nB0$); 
           Null}]; $CellContext`nAL0$ = $CellContext`zL$ $CellContext`nL0$; \
$CellContext`nAV0$ = $CellContext`zV$ $CellContext`nV0$; $CellContext`nBL0$ = \
$CellContext`nL0$ - $CellContext`nAL0$; $CellContext`nBV0$ = \
$CellContext`nV0$ - $CellContext`nAV0$; $CellContext`total$ = \
$CellContext`nA0$ + $CellContext`nB0$ + $CellContext`nAadd$ + \
$CellContext`nBadd$; 
        If[$CellContext`z$ <= $CellContext`zL$, {$CellContext`fL$ = \
$CellContext`total$, $CellContext`fAL$ = $CellContext`z$ $CellContext`fL$, \
$CellContext`fBL$ = (1 - $CellContext`z$) $CellContext`fL$, $CellContext`fV$ = 
           0, $CellContext`fAV$ = 0, $CellContext`fBV$ = 0}]; If[
          
          And[$CellContext`nAadd$ == 0, $CellContext`nBadd$ == 
           0], {$CellContext`fL$ = $CellContext`nL0$, $CellContext`fAL$ = \
$CellContext`nAL0$, $CellContext`fBL$ = $CellContext`nBL0$, $CellContext`fV$ = \
$CellContext`nV0$, $CellContext`fAV$ = $CellContext`nAV0$, $CellContext`fBV$ = \
$CellContext`nBV0$}]; 
        If[$CellContext`z$ >= $CellContext`zV$, {$CellContext`fV$ = \
$CellContext`total$, $CellContext`fAV$ = $CellContext`z$ $CellContext`fV$, \
$CellContext`fBV$ = (1 - $CellContext`z$) $CellContext`fV$, $CellContext`fL$ = 
           0, $CellContext`fAL$ = 0, $CellContext`fBL$ = 0}]; 
        If[$CellContext`zL$ < $CellContext`z$ < $CellContext`zV$, \
{$CellContext`fL$ = (($CellContext`zV$ - $CellContext`z$)/($CellContext`zV$ - \
$CellContext`zL$)) $CellContext`total$; $CellContext`fAL$ = $CellContext`zL$ \
$CellContext`fL$; $CellContext`fBL$ = $CellContext`fL$ - $CellContext`fAL$}]; 
        If[$CellContext`zL$ < $CellContext`z$ < $CellContext`zV$, \
{$CellContext`fV$ = $CellContext`total$ - $CellContext`fL$; $CellContext`fAV$ = \
$CellContext`zV$ $CellContext`fV$; $CellContext`fBV$ = $CellContext`fV$ - \
$CellContext`fAV$; Null}]; 
        If[$CellContext`z$ >= $CellContext`zV$, {$CellContext`LtoVA$ = \
$CellContext`nAL0$; $CellContext`LtoVB$ = $CellContext`nBL0$; \
$CellContext`LtoLA$ = 0; $CellContext`LtoLB$ = 
            0; $CellContext`VtoVA$ = $CellContext`nAV0$; $CellContext`VtoVB$ = \
$CellContext`nBV0$; $CellContext`VtoLA$ = 0; $CellContext`VtoLB$ = 0; Null}, 
          
          If[$CellContext`z$ <= $CellContext`zL$, {$CellContext`LtoVA$ = 
             0; $CellContext`LtoVB$ = 
             0; $CellContext`LtoLA$ = $CellContext`nAL0$; $CellContext`LtoLB$ = \
$CellContext`nBL0$; $CellContext`VtoVA$ = 0; $CellContext`VtoVB$ = 
             0; $CellContext`VtoLA$ = $CellContext`nAV0$; $CellContext`VtoLB$ = \
$CellContext`nBV0$; Null}, 
           
           If[$CellContext`nAadd$ > 
            0, {$CellContext`LtoVA$ = $CellContext`fAV$ - $CellContext`nAV0$ - \
$CellContext`nAadd$; $CellContext`LtoVB$ = $CellContext`fBV$ - \
$CellContext`nBV0$; $CellContext`LtoLA$ = $CellContext`fAL$; \
$CellContext`LtoLB$ = $CellContext`fBL$; $CellContext`VtoVA$ = 
              0; $CellContext`VtoVB$ = 0; $CellContext`VtoLA$ = 
              0; $CellContext`VtoLB$ = 0; 
             Null}, {$CellContext`LtoVA$ = 0; $CellContext`LtoVB$ = 
              0; $CellContext`LtoLA$ = $CellContext`nAL0$; \
$CellContext`LtoLB$ = $CellContext`nBL0$; $CellContext`VtoVA$ = \
$CellContext`fAV$; $CellContext`VtoVB$ = $CellContext`fBV$; \
$CellContext`VtoLA$ = $CellContext`fAL$ - $CellContext`nAL0$; \
$CellContext`VtoLB$ = $CellContext`fBL$ - $CellContext`nBL0$ - \
$CellContext`nBadd$; Null}]]]; $CellContext`p1$ = 
         Show[$CellContext`diagram]; $CellContext`p2$ = Graphics[{}]; Show[
          
          Switch[$CellContext`choose$$, 1, $CellContext`p1$, 
           2, $CellContext`p2$], ImageSize -> {560, 400}]], 
      "Specifications" :> {{{$CellContext`choose$$, 1, ""}, {1 -> Row[{
             Style[" P-x-y", Italic], " diagram "}], 2 -> " mole balance "}, 
         ControlType -> Setter, ControlPlacement -> 
         1}, {{$CellContext`aorb$$, 1, ""}, {1 -> " add A ", 2 -> " add B "}, 
         ControlType -> Setter, ControlPlacement -> 
         2}, {{$CellContext`addmol$$, 3, "moles added"}, 0, 10, 0.1, 
         Appearance -> "Labeled", ControlPlacement -> 3}, 
        Grid[{{
           Manipulate`Place[1], 
           Manipulate`Place[2]}, {
           Manipulate`Place[3], SpanFromLeft}}, Alignment -> Left]}, 
      "Options" :> {}, "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{609., {255., 262.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`diagram = Graphics[{{{{}, {}, {
             Directive[
              Opacity[1.], 
              AbsoluteThickness[1.6], 
              Thickness[Large], 
              RGBColor[0, 0, 1]], 
             Line[CompressedData["
1:eJwVxX081HccAHDOojzlma8akWo9UHnYXNLnYxWV2eKILFRoWRoVycPqJTvl
qchDXBSuaxvmiNIihCEPkfNwr7pwdp4fflxdZxLb/ni/3kYng1z8aTIyMk7/
+f9D/mOvasfd9ih0x+R2zM/BaPGRkwPEEjrj38hEL8+BjlLPjTKyD1h2FifM
5cVgRtfi5BBX2MYdMkrXFMOuTouSW8QPGPF2bE8zMdTeqbdKIiFwD5c5w75i
iIlOuBRPfgHrPyIKP74Ug18IReJIGgTEnnu8ifMOVqYdzJuduw+F+nnh10Il
UNFp7uBgwAXV8hl7o01S8IgRvK5PKIeoObUCeuc8BJVeMM18/ye0qIU+PZqz
AOLk3mZZ2RqwtpJ2lzkuQvPzxpqO3XVwzaYyW9tgCQLCD6ocnWoA4TBjQTK6
DM9XmS8XnW2C4kMrdl5/IYMP2A1L+hta4PvUaBtSKouo8yyfUdwGmf3Kjg5x
NDRtEjxp3NIBgsirHEsvOexGxszvM52wWjGrd8PezzBQ8UxXz44u4LGqlcvJ
Cmzluz9TvcGD2LVMYk+TR4a9h1Ak6oY9s1bnbo/I45e5Ce65Jr0Q1yhpZ1Yq
4OBSavfpK31Ql3RE9lL+Shw+2MHWqedDonsjXSFiFZZkDYS/MnoN9hp9B1i+
isi5Lhe3OeINyBt25U8dUEKJr+fEqUoBHDETyAoMlFFpX6xLqW4/pJtd+6pD
XgWj1IaVhccGwH+n3XmfARVUrt4q0+c0CLtjh6XFZapoe/G7T/ULg0Br2+JK
Y63G7PuJ7PXZQtgWX+MZbq2G3m6W7asch6Bz49OL74rU8FGPf2r1hyEIm9ps
7WSojvS2EtpIxt/gb2EUJYlTx3X7T0lS94mgVXy68N4ndbSytEopHxFBhIW1
V2aABg6Ik16wmcOwNSeqPJingVMWzkxiPgJuV9Slh+w1ceOk6YQsbwQah0yr
LpRqYoNJaFdw9Chwq1mBdzdo4c3uHl8XkzEQrrl5T/eWFlKM2hRawxjo5M+H
BS9q4UM37b30c+NQl/vQpjVIG9ntMTlDGhNQse59dMgbbZQ2HYvUqJuA9SS2
zPCwDg6m1EjUfpqE1F1J8QV1OvjhlQ25qjoFjm/XiGJMdTE4zbg2vGoKIucX
vvDJ00XddmM1kfc0vEs7MXtdRQ8ZPUWLa5em4aynrdetMD0U++QFCgpm4Hhm
wKOcCT2sOc5lqn5DwR33z5OlbgSfdgQ69n9LwY+XXcd63Qk+3rNFvdiZAmtO
Aj4+SrBoLSfbyZ0Cnvif2RAvgiw+qyzxJAXKN3qdxX4EQw/HChXDKfi54abm
9AWCW9HLVuEBBd47abeHUghu5OrL9f1GwTYPOvU8laCxAb/5QSEFHy8HO+Sl
E9RbdHG1L6Ugo61f6pNFUP7JgTPMKgo6fqj0eJtLULjdMkuORwHeDdHncwkK
7s5583ooUPmr8HxFKUG+CteEzadAMDnUklFG8OXk5pKv+ykIoztHulUQrPrV
sCl6nIKSblNBVzXBJzpvE52nKLjy0c/yYS3BMibLxYiiwMk4OzGljmCBr3Z/
7XsKxoMUbQ83EuR0dbGTpRRUZNilb28mmGuXHHB8gQLms0vTqi0Es0uctu/4
RAFDxN0/00rwtqGSZHmZAiOl0Zz2doL/AjnNVsc=
              "]]}, {
             Directive[
              Opacity[1.], 
              AbsoluteThickness[1.6], 
              Thickness[Large], 
              RGBColor[0, 0.65, 0]], 
             Line[CompressedData["
1:eJwVjHk41HkcgMdY5+BBO2Z+JWKVoxzr2p3C51sUkg5HbCFHhGzpEWvK0zrW
0YZIrSWdE7Vy01KRyXiwRcYwzObWMM75NZN7wto/3uf9531encCLbsFEAoHg
vsn/Phw82cWc8rRLJYSldS6LQFB2MnAYswROCkm0siICDRI3sxpzAJ8fQ+L1
JCIwoX1beA/zgP6DgVuurIlgL9ui4hZ2FpzvOJH0iWJg3mVZZWCXwY8d6ZxG
EkNSwo3Y37Hf4L1BmWWolhjOXsax69htmDsdQX/gIAb5286PPoueQCD14IPy
PDHUss0dHbXKwcKmiTY/IwbvpIGPrBs14JOd4RkOX+BiZZTxn/MvoV+ujmV/
7wuIs3rbpKQagWNcGaa7/AXa3rY0dto0wXS/qmeI3zyE0Z2Vf5pthoY4seFA
yzy8VTDfKPm5FVZ1eWK9PQtQxGhe37rzHXjXHMqMuL8ASKPhsXtZO3wo1lRI
V14E49aBuhajTrAPT5YTXFuEHuQu/EvIhigaz8lgYxEiFM9zuGYcMIxIDqXE
LcF7nleDSmY3vNya7liosAzuh7xH+fwecLCbq4K7y2D98IbXQ71eQDtqHwUZ
rsDIek5P6K99MMi4tmft3QqMO3cyNFg8sNd+5Xo8bBUq8obpXTofga13Ovz5
dgkUpklfN7zSD7HVss9O8SSwEHRqOuT1AMj5Fqe23/wKJIcUt0rKEOyT8XYt
DliDONVxpVGfYXDKU/rQZrYOSm92E/pcR+CxjrHvD3IbYBtzbI21OgLhAfyo
2rUNKHiSzviuYBT+jbqkIYklID9Pyw4FlzF44X24v1dGCr3gBue8WRwDdvOE
eW6eFKK1VxAn/vgE2lLnKK/2ENGOgyELOQ58iKF0VaT3EZGVpVV2zQQffonm
HnidKI2GxRn/MJLHodWkitlk/Q2atTiRjJlPQE2roCVIQQbtmjGeluqegIB8
QaJkUAY160VzIhMEYN1U24B4suhmDzfITW8Swm4dDZXvk0O4OzOb2DwJTHn1
fA+BPKryJNvTLk3B/t6LuTd3KyJGR9K9MfVpCB2lmp6jk9BSq89V9aZp0BdG
aI4pKqOR7MYF1QszQPxY4OLUrIIWu/ZhiSqzEM/NZMs6q6LI27pMev0sTCv7
pZLOqiFKh64q328O4orr2Uey1ZE7t+Sr5voc8GMuaMt82oLEZx5FDBQLwUpv
ztk2nYwWcmWsAkqFYLGNTl66RUbLnWFr4+VCyOWYkl/kkdEGmGfiNUJoN5lh
2j4lI6UdrHJioxC24cdoiU1ktHOELzboFoLLaSOb/hUy8vY3oEdLhODUwFKb
Oa+BGv3Lk1WO4NAUgIvi/SjoVWeEy9BRHAJiRmknz1HQ33ZGamUncMi43vG9
eSQFlWgWFrh64fApgHR8PYGC8nn51emBOOjH4dsnCyko+njKqCIdB38zqXF5
nIJ2I19buSIcJCa0wboUKtpVvlW67xkO05hjR1QWFelq8dqKnuOQM98Xa51P
RdSvbh6HKnHQCr6m311KRbJ1TueT63FI8SBMhXOpaNTUMk+6G4c7gq4zmrsw
NHBf5NfNxaG/aSzOywxDPOVyPQZv89ft/jl/L4Y+zBhWHBja7GVspPcdw1D9
U+3WhKnNn4AqGYnFUJ3GYPqJWRxS60tmzyRhqDo5300Hx2Gb0c40QQaGioPI
Q8x5HOJLOwWqDAwVcjiMrCUcCB41b6tKMfRwf1aY/yoORetjkb51GCqocDU1
W8Oh2S6QoMbCUK42aWFjAweOrMvVjg4M/Qe1qouD
              "]]}}}, {}}, {DisplayFunction -> Identity, PlotRangePadding -> {{
             Scaled[0.02], 
             Scaled[0.02]}, {
             Scaled[0.05], 
             Scaled[0.05]}}, PlotRangeClipping -> True, ImagePadding -> All, 
          DisplayFunction -> Identity, AspectRatio -> GoldenRatio^(-1), 
          Axes -> {True, True}, AxesLabel -> {None, None}, 
          AxesOrigin -> {0, 1.2000000000000002`}, DisplayFunction :> Identity,
           Epilog -> {{
             Text[
              Style["liquid", 17, 
               GrayLevel[0.5]], {0.1, 6}], 
             Text[
              Style["vapor", 17, 
               GrayLevel[0.5]], {0.9, 1.2}]}}, 
          Frame -> {{True, True}, {True, True}}, FrameLabel -> {{
             Style["pressure (kPa)", 17], None}, {
             Style["mole fraction A", 17], None}}, 
          FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
          GridLines -> {None, None}, GridLinesStyle -> Directive[
            GrayLevel[0.5, 0.4]], LabelStyle -> {14, 
            GrayLevel[0]}, 
          Method -> {
           "DefaultBoundaryStyle" -> Automatic, "DefaultMeshStyle" -> 
            AbsolutePointSize[6], "ScalingFunctions" -> None}, 
          PlotRange -> {{0, 1}, {1.1232447937509578`, 6.450979678370261}}, 
          PlotRangeClipping -> True, PlotRangePadding -> {{
             Scaled[0.02], 
             Scaled[0.02]}, {
             Scaled[0.02], 
             Scaled[0.02]}}, Ticks -> {Automatic, Automatic}}]}; 
     Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.675522025923645*^9, 3.675522618697317*^9, {3.6755226548905916`*^9, 
   3.6755226767214527`*^9}, 3.6755227083057146`*^9, {3.6755227466715536`*^9, 
   3.6755227954198503`*^9}, 3.675523011590992*^9, 3.6755232145628147`*^9, 
   3.6755232484929004`*^9, 3.675523301291946*^9, 3.675523336802005*^9, {
   3.6755233686879053`*^9, 3.675523377771324*^9}, 3.67552925555861*^9, {
   3.6755293959150057`*^9, 3.6755294161208644`*^9}, 3.675529473733387*^9, {
   3.6755295323932924`*^9, 3.6755295471823254`*^9}, 3.6755295828802056`*^9, 
   3.6755296371485243`*^9, {3.675529685157029*^9, 3.675529713391488*^9}, 
   3.675529790166874*^9, 3.675530596952258*^9, 3.6755307286175976`*^9, 
   3.675530919304208*^9},
 CellID->191869188]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Text", "@", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"Grid", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<L\[Rule]V A\>\"", ",", "LtoVA"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<L\[Rule]V B\>\"", ",", "LtoVB"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<L\[Rule]L A\>\"", ",", "LtoLA"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<L\[Rule]L B\>\"", ",", "LtoLB"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<V\[Rule]V A\>\"", ",", "VtoVA"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<V\[Rule]V B\>\"", ",", "VtoVB"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<V\[Rule]L A\>\"", ",", "VtoLA"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<V\[Rule]L B\>\"", ",", "VtoLB"}], "}"}]}], "}"}], "]"}],
      ",", "18"}], "]"}]}], "*)"}]], "Input",
 CellID->604045723],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"LtoVA", "=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"z", "\[GreaterEqual]", "zV"}], ",", "nAL0", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"z", "\[LessEqual]", "zL"}], ",", "0", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nAadd", ">", "0"}], ",", 
          RowBox[{"fAV", "-", "nAV0", "-", "nAadd"}], ",", "0"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"LtoVB", "=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"z", "\[GreaterEqual]", "zV"}], ",", "nBL0", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"z", "\[LessEqual]", "zL"}], ",", "0", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nAadd", ">", "0"}], ",", 
          RowBox[{"fBV", "-", "nBV0"}], ",", "0"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "]"}]}], ";"}], "*)"}]], "Input",
 CellID->169982316],

Cell[BoxData[{
 RowBox[{
  RowBox[{"zL", "=", "0.2456"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zV", "=", "0.586"}], ";"}]}], "Input",
 CellChangeTimes->{{3.675522764229788*^9, 3.6755227832062273`*^9}},
 CellID->156356362],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"zL", "\[LessEqual]", "z", "\[LessEqual]", "zV"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"zV", ",", "P"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"zL", ",", "P"}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"zV", ",", "P"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"zV", ",", "90"}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"zL", ",", "P"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"zL", ",", "90"}], "}"}]}], "}"}], "]"}]}], "}"}]}], "]"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"z", ">", "zV"}], "\[Or]", 
      RowBox[{"z", "<", "zL"}]}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"z", ",", "P"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "90"}], "}"}]}], "}"}], "]"}]}], "]"}]}], 
  "*)"}]], "Input",
 CellID->216535169]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ManipulateCaptionSection"],

Cell["XXXX", "ManipulateCaption"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ThumbnailSection"],

Cell[BoxData[
 GraphicsBox[
  {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], RectangleBox[{0, 0}], 
   InsetBox[
    StyleBox["\<\"Thumbnail Placeholder\"\>",
     StripOnInput->False,
     FontFamily->"Verdana",
     FontSize->14], {0.5, 0.6}], InsetBox[
    StyleBox["\<\"Replace this with your\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.45}], InsetBox[
    StyleBox["\<\"Manipulate at a particular setting.\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.39}], InsetBox[
    StyleBox["\<\"(Do not use a bitmap.)\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.315}]},
  ImageMargins->0.,
  ImageSize->220]], "Output",
 CellEditDuplicate->False]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SnapshotsSection"],

Cell[BoxData[
 GraphicsBox[
  {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[1]], RectangleBox[{0, 0}], 
   InsetBox[
    StyleBox["\<\"Snapshot Placeholder\"\>",
     StripOnInput->False,
     FontFamily->"Verdana",
     FontSize->14], {0.5, 0.6}], InsetBox[
    StyleBox["\<\"Replace this with your\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.45}], InsetBox[
    StyleBox["\<\"Manipulate at a particular setting.\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.39}], InsetBox[
    StyleBox["\<\"(Do not use a bitmap.)\"\>",
     StripOnInput->False,
     FrontFaceColor->GrayLevel[0.5],
     GraphicsColor->GrayLevel[0.5],
     FontFamily->"Verdana",
     FontSize->10,
     FontColor->GrayLevel[0.5],
     $CellContext`BackFaceColor -> GrayLevel[0.5]], {0.5, 0.315}]},
  ImageMargins->0.,
  ImageSize->220]], "Output",
 CellEditDuplicate->False]
}, Open  ]],

Cell["", "DetailsSection"],

Cell[CellGroupData[{

Cell["", "ControlSuggestionsSection"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Resize Images"]}],
  "\"Click inside an image to reveal its orange resize frame.\\nDrag any of \
the orange resize handles to resize the image.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"ResizeImages"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Rotate and Zoom in 3D"]}],
  RowBox[{
   "\"Drag a 3D graphic to rotate it. Starting the drag near the center \
tumbles\\nthe graphic; starting near a corner turns it parallel to the plane \
of the screen.\\nHold down \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" (or \"", 
    FrameBox[
    "Cmd", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" on Mac) and drag up and down to zoom.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"RotateAndZoomIn3D"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Drag Locators"]}],
  RowBox[{"\"Drag any locator (\"", 
    GraphicsBox[
     LocatorBox[
      Scaled[{0.5, 0.5}]], ImageSize -> 20], 
    "\", etc.) to move it around.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"DragLocators"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Create and Delete Locators"]}],
  RowBox[{"\"Insert a new locator in the graphic by holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key\\nand clicking where you want it to be. Delete a locator by \
clicking it\\nwhile holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" key.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"CreateAndDeleteLocators"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Slider Zoom"]}],
  RowBox[{"\"Hold down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key while moving a slider to make fine adjustments in the slider \
value.\\nHold \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" and/or \"", 
    FrameBox[
    "Shift", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" at the same time as \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" to make ever finer adjustments.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"SliderZoom"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Gamepad Controls"]}],
  "\"Control this Demonstration with a gamepad or other\\nhuman interface \
device connected to your computer.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.35696210375764*^9, 3.3895522232313623`*^9},
 FontFamily->"Verdana",
 CellTags->"GamepadControls"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Automatic Animation"]}],
  RowBox[{"\"Animate a slider in this Demonstration by clicking the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJzzTSzJSM1NLMlMTlRwL0osyMhMLlZwyy8CCjEzMjAwcIKwAgOI/R/IhBKc\n\
/4EAyGAG0f+nTZsGwgysIJIRKsWKLAXGIHFmEpUgLADxWUAkI24jZs+eTaEt\n\
IG+wQKRmzJgBlYf5lhEA30OqWA=="], "Graphics", ImageSize -> {9, 9}, ImageMargins -> 
      0, CellBaseline -> Baseline], BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"button\\nnext to the slider, and then clicking the play button that \
appears.\\nAnimate all controls by selecting \"", 
    StyleBox["Autorun", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"AutomaticAnimation"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Bookmark Animation"]}],
  RowBox[{
   "\"See a prepared animation of this Demonstration by selecting\\n\"", 
    StyleBox["Animate Bookmarks", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"BookmarkAnimation"]
}, Open  ]],

Cell["", "SearchTermsSection"],

Cell["", "RelatedLinksSection"],

Cell[CellGroupData[{

Cell["", "AuthorSection"],

Cell["Contributed by: XXXX", "Author"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{667, 670},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (April 11, 2016)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "Demonstration.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "ResizeImages"->{
  Cell[41251, 999, 312, 8, 70, "ControlSuggestions",
   CellTags->"ResizeImages"]},
 "RotateAndZoomIn3D"->{
  Cell[41566, 1009, 678, 16, 70, "ControlSuggestions",
   CellTags->"RotateAndZoomIn3D"]},
 "DragLocators"->{
  Cell[42247, 1027, 340, 11, 70, "ControlSuggestions",
   CellTags->"DragLocators"]},
 "CreateAndDeleteLocators"->{
  Cell[42590, 1040, 637, 15, 70, "ControlSuggestions",
   CellTags->"CreateAndDeleteLocators"]},
 "SliderZoom"->{
  Cell[43230, 1057, 844, 21, 70, "ControlSuggestions",
   CellTags->"SliderZoom"]},
 "GamepadControls"->{
  Cell[44077, 1080, 369, 9, 70, "ControlSuggestions",
   CellTags->"GamepadControls"]},
 "AutomaticAnimation"->{
  Cell[44449, 1091, 1464, 31, 70, "ControlSuggestions",
   CellTags->"AutomaticAnimation"]},
 "BookmarkAnimation"->{
  Cell[45916, 1124, 908, 21, 70, "ControlSuggestions",
   CellTags->"BookmarkAnimation"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"ResizeImages", 47388, 1171},
 {"RotateAndZoomIn3D", 47496, 1174},
 {"DragLocators", 47606, 1177},
 {"CreateAndDeleteLocators", 47722, 1180},
 {"SliderZoom", 47836, 1183},
 {"GamepadControls", 47942, 1186},
 {"AutomaticAnimation", 48055, 1189},
 {"BookmarkAnimation", 48172, 1192}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 36, 0, 74, "DemoTitle"],
Cell[CellGroupData[{
Cell[641, 26, 33, 0, 287, "InitializationSection"],
Cell[677, 28, 383, 12, 27, "Input",
 InitializationCell->True,
 CellID->367346216],
Cell[1063, 42, 382, 12, 27, "Input",
 InitializationCell->True,
 CellID->199493148],
Cell[1448, 56, 589, 16, 27, "Input",
 InitializationCell->True,
 CellID->484088675],
Cell[2040, 74, 592, 17, 45, "Input",
 InitializationCell->True,
 CellID->127795700],
Cell[2635, 93, 2003, 57, 128, "Input",
 InitializationCell->True,
 CellID->91487072]
}, Open  ]],
Cell[CellGroupData[{
Cell[4675, 155, 29, 0, 234, "ManipulateSection"],
Cell[CellGroupData[{
Cell[4729, 159, 15527, 369, 1899, "Input"],
Cell[20259, 530, 14472, 256, 529, "Output",
 CellID->191869188]
}, Open  ]],
Cell[34746, 789, 959, 25, 88, "Input",
 CellID->604045723],
Cell[35708, 816, 1145, 32, 188, "Input",
 CellID->169982316],
Cell[36856, 850, 236, 6, 48, "Input",
 CellID->156356362],
Cell[37095, 858, 1322, 43, 48, "Input",
 CellID->216535169]
}, Open  ]],
Cell[CellGroupData[{
Cell[38454, 906, 36, 0, 169, "ManipulateCaptionSection"],
Cell[38493, 908, 33, 0, 22, "ManipulateCaption"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38563, 913, 28, 0, 173, "ThumbnailSection"],
Cell[38594, 915, 1242, 34, 230, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39873, 954, 28, 0, 70, "SnapshotsSection"],
Cell[39904, 956, 1241, 34, 70, "Output"]
}, Open  ]],
Cell[41160, 993, 26, 0, 70, "DetailsSection"],
Cell[CellGroupData[{
Cell[41211, 997, 37, 0, 70, "ControlSuggestionsSection"],
Cell[41251, 999, 312, 8, 70, "ControlSuggestions",
 CellTags->"ResizeImages"],
Cell[41566, 1009, 678, 16, 70, "ControlSuggestions",
 CellTags->"RotateAndZoomIn3D"],
Cell[42247, 1027, 340, 11, 70, "ControlSuggestions",
 CellTags->"DragLocators"],
Cell[42590, 1040, 637, 15, 70, "ControlSuggestions",
 CellTags->"CreateAndDeleteLocators"],
Cell[43230, 1057, 844, 21, 70, "ControlSuggestions",
 CellTags->"SliderZoom"],
Cell[44077, 1080, 369, 9, 70, "ControlSuggestions",
 CellTags->"GamepadControls"],
Cell[44449, 1091, 1464, 31, 70, "ControlSuggestions",
 CellTags->"AutomaticAnimation"],
Cell[45916, 1124, 908, 21, 70, "ControlSuggestions",
 CellTags->"BookmarkAnimation"]
}, Open  ]],
Cell[46839, 1148, 30, 0, 70, "SearchTermsSection"],
Cell[46872, 1150, 31, 0, 70, "RelatedLinksSection"],
Cell[CellGroupData[{
Cell[46928, 1154, 25, 0, 70, "AuthorSection"],
Cell[46956, 1156, 38, 0, 70, "Author"]
}, Open  ]]
}, Open  ]]
}
]
*)

